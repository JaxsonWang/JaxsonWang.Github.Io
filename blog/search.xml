<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Vue.js快速上手笔记</title>
      <link href="/vue-js-study-notes.html"/>
      <url>/vue-js-study-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="Vue实例"><a href="#Vue实例" class="headerlink" title="Vue实例"></a>Vue实例</h3><p>Vue.js是一套构建用户界面的<strong>渐进式框架</strong>。与其他重量级框架不同的是，Vue 从根本上采用最小成本、渐进增量的设计。Vue 的核心库只专注于视图层，并且很容易与其他第三方库或现有项目集成。</p><h4 id="创建Vue实例"><a href="#创建Vue实例" class="headerlink" title="创建Vue实例"></a>创建Vue实例</h4><p>创建方法如下：</p><pre><code>var  vm  =  new Vue({//一些选项配置})</code></pre><p>当一个 Vue 实例被创建时，它向 Vue 的响应式系统中加入了其<code>data</code>对象中能找到的所有的属性。当这些属性的值发生改变时，视图将会产生“响应”，即匹配更新为新的值。</p><pre><code>&lt;div  id=&quot;example&quot;&gt;    &lt;p&gt;{ {  hello  }}&lt;/p&gt;    &lt;button  v-on:click=&quot;change&quot;&gt;点一下&lt;/button&gt;&lt;/div&gt;</code></pre><h4 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h4><p>Vue实例被创建时都要经过一系列的初始化过程——例如，需要设置数据监听、编译模板、将实例挂载到 DOM 并在数据变化时更新 DOM 等。这个过程为<strong>生命周期</strong>，封装各个周期函数又称为：<strong>生命周期钩子</strong>，方便在不同周期环境下添加代码。 <a href="https://i.loli.net/2018/09/01/5b8a5aa791317.jpg" target="_blank" rel="noopener"><img src="https://i.loli.net/2018/09/01/5b8a5aa791317.jpg" alt="956663-20171122151938477-407847748.jpg"></a></p><h4 id="模板语法"><a href="#模板语法" class="headerlink" title="模板语法"></a>模板语法</h4><h5 id="插值"><a href="#插值" class="headerlink" title="插值"></a>插值</h5><p><strong>文本：</strong><code>v-once</code>只渲染一次对应数据，改变其值不会再有变化。 <strong>原生HTML：</strong>如果<code>data</code>绑定的数据是html类型数据，请注意使用<code>v-html</code>指令去解析，否则直接输出html数据的文本。 <strong>使用JavaScript表达式：</strong>只能支持简单的表达式</p><h3 id="计算属性和侦听器"><a href="#计算属性和侦听器" class="headerlink" title="计算属性和侦听器"></a>计算属性和侦听器</h3><h4 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h4><p>在模板使用JavaScript表达式只能进行简单的逻辑，如果复杂的逻辑就不行了或者多次引用该逻辑代码岂不是要多写几处？所以对于任何复杂逻辑应当使用计算属性。</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;p&gt;{ { hello }}&lt;/p&gt;    &lt;p&gt;{ { reversedHello }}&lt;/p&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            hello: &quot;Hello World&quot;        },        computed: {            reversedHello: function() {                return this.hello.split(&apos;&apos;).reverse(&apos;&apos;).join(&apos;&apos;);            }        }    });console.log(vm.reversedHello); //dlroW olleHvm.hello = &quot;你好&quot;console.log(vm.reversedHello); //好你&lt;/script&gt;</code></pre><p>你可以像绑定普通属性一样在模板中绑定计算属性。Vue 知道 <code>vm.reversedHello</code> 依赖于 <code>vm.message</code>，因此当 <code>vm.hello</code> 发生改变时，所有依赖 <code>vm.reversedHello</code> 的绑定也会更新。而且最妙的是我们已经以声明的方式创建了这种依赖关系：计算属性的 getter 函数是没有副作用 (side effect) 的，这使它更易于测试和理解。</p><h4 id="计算属性-VS-方法"><a href="#计算属性-VS-方法" class="headerlink" title="计算属性 VS 方法"></a>计算属性 VS 方法</h4><p>同样在表达式中调用方法可以实现相同效果：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;p&gt;{ { hello }}&lt;/p&gt;    &lt;p&gt;{ { reversedHello() }}&lt;/p&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            hello: &quot;Hello World&quot;        },        methods: {            reversedHello: function() {                return this.hello.split(&apos;&apos;).reverse(&apos;&apos;).join(&apos;&apos;);            }        }    })&lt;/script&gt;</code></pre><p>注意上面函数定义是一个方法<code>reversedHello()</code>。俩个方式最终结果是相同的，不同的是<strong><strong>计算属性是基于它们的依赖进行缓存的</strong></strong>，只在相关依赖发生改变时它们才会重新求值。这就意味着只要 <code>message</code> 还没有发生改变，多次访问 <code>reversedHello</code> 计算属性会立即返回之前的计算结果，而不必再次执行函数。 为什么需要缓存？假设我们有一个性能开销比较大的计算属性 <strong>A</strong>，它需要遍历一个巨大的数组并做大量的计算。然后我们可能有其他的计算属性依赖于 <strong>A</strong> 。如果没有缓存，我们将不可避免的多次执行 <strong>A</strong> 的 getter！如果你不希望有缓存，请用方法来替代。</p><h4 id="计算属性-vs-侦听属性"><a href="#计算属性-vs-侦听属性" class="headerlink" title="计算属性 vs 侦听属性"></a>计算属性 vs 侦听属性</h4><p>Vue 提供了一种更通用的方式来观察和响应 Vue 实例上的数据变动：<strong>侦听属性</strong>。当有一些数据需要随着其它数据变动而变动时，很容易滥用 <code>watch</code>。然而，通常更好的做法是使用计算属性而不是命令式的 <code>watch</code> 回调。细想一下这个例子：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    { { fullName }}&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            firstName: &quot;Jaxson&quot;,            lastName: &quot;Wnag&quot;,            fullName: &quot;Jaxson Wang&quot;        },        watch: {            firstName: function(val) {                console.log(&quot;firstName: &quot; + val)                this.fullName = val + &apos; &apos; + this.lastName            },            lastName: function(val) {                console.log(&quot;lastName: &quot; + val);                this.fullName = this.firstName + &apos; &apos; + val            }        }    });    vm.lastName = &quot;Chen&quot;; //控制台输出相关信息&lt;/script&gt;</code></pre><p>上面代码有很多重复：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    { { fullName }}&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            firstName: &quot;Jaxson&quot;,            lastName: &quot;Wnag&quot;        },        computed: {            fullName: function() {                console.log(&quot;Your FirstName: &quot; + this.firstName);                console.log(&quot;Your LastName: &quot; + this.lastName);                return this.firstName + &quot; &quot; + this.lastName            }        }    });&lt;/script&gt;</code></pre><p>这样效果看起来好多了！</p><h4 id="计算属性的setter"><a href="#计算属性的setter" class="headerlink" title="计算属性的setter"></a>计算属性的setter</h4><p>计算属性默认只有getter，需要setter可以提供：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    { { fullName }}&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            firstName: &quot;Jaxson&quot;,            lastName: &quot;Wang&quot;        },        computed: {            fullName: {                // getter                get: function () {                    return this.firstName + &quot; &quot; + this.lastName                },                // setter                set: function (newValue) {                    var names = newValue.split(&apos; &apos;)                    console.log(names);                    this.firstName = names[0]                    this.lastName = names[names.length - 1]                }            }        }    });    vm.fullName = &quot;Jhon Chen&quot;&lt;/script&gt;</code></pre><p>当你执行<code>vm.fullName = &quot;Jhon Chen&quot;</code>时候，setter被调用<code>firstName</code>和<code>lastName</code>也会相应更新。</p><h4 id="侦听器"><a href="#侦听器" class="headerlink" title="侦听器"></a>侦听器</h4><p>虽然计算属性在大多数情况下更合适，但有时也需要一个自定义的侦听器。这就是为什么 Vue 通过 <code>watch</code> 选项提供了一个更通用的方法，来响应数据的变化。当需要在数据变化时执行异步或开销较大的操作时，这个方式是最有用的。</p><pre><code>&lt;div id=&quot;watch-example&quot;&gt;  &lt;p&gt;    Ask a yes/no question:    &lt;input v-model=&quot;question&quot;&gt;  &lt;/p&gt;  &lt;p&gt;{ { answer }}&lt;/p&gt;&lt;/div&gt;&lt;!-- 因为 AJAX 库和通用工具的生态已经相当丰富，Vue 核心代码没有重复 --&gt;&lt;!-- 提供这些功能以保持精简。这也可以让你自由选择自己更熟悉的工具。 --&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/npm/axios@0.12.0/dist/axios.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/npm/lodash@4.13.1/lodash.min.js&quot;&gt;&lt;/script&gt;&lt;script&gt;var watchExampleVM = new Vue({  el: &apos;#watch-example&apos;,  data: {    question: &apos;&apos;,    answer: &apos;I cannot give you an answer until you ask a question!&apos;  },  watch: {    // 如果 `question` 发生改变，这个函数就会运行    question: function (newQuestion, oldQuestion) {      this.answer = &apos;Waiting for you to stop typing...&apos;      this.debouncedGetAnswer()    }  },  created: function () {    // `_.debounce` 是一个通过 Lodash 限制操作频率的函数。    // 在这个例子中，我们希望限制访问 yesno.wtf/api 的频率    // AJAX 请求直到用户输入完毕才会发出。想要了解更多关于    // `_.debounce` 函数 (及其近亲 `_.throttle`) 的知识，    // 请参考：https://lodash.com/docs#debounce    this.debouncedGetAnswer = _.debounce(this.getAnswer, 500)  },  methods: {    getAnswer: function () {      if (this.question.indexOf(&apos;?&apos;) === -1) {        this.answer = &apos;Questions usually contain a question mark. ;-)&apos;        return      }      this.answer = &apos;Thinking...&apos;      var vm = this      axios.get(&apos;https://yesno.wtf/api&apos;)        .then(function (response) {          vm.answer = _.capitalize(response.data.answer)        })        .catch(function (error) {          vm.answer = &apos;Error! Could not reach the API. &apos; + error        })    }  }})&lt;/script&gt;</code></pre><p>在这个示例中，使用 <code>watch</code> 选项允许我们执行异步操作 (访问一个 API)，限制我们执行该操作的频率，并在我们得到最终结果前，设置中间状态。这些都是计算属性无法做到的。</p><h3 id="Class-与-Style-绑定"><a href="#Class-与-Style-绑定" class="headerlink" title="Class 与 Style 绑定"></a>Class 与 Style 绑定</h3><p>操作元素的 class 列表和内联样式是数据绑定的一个常见需求。因为它们都是属性，所以可以用 <code>v-bind</code> 处理它们：只需要通过表达式计算出字符串结果即可。不过，字符串拼接麻烦且易错。因此，在将 <code>v-bind</code> 用于 <code>class</code> 和 <code>style</code> 时，Vue.js 做了专门的增强。表达式结果的类型除了字符串之外，还可以是对象或数组。</p><h4 id="绑定HTML-Class"><a href="#绑定HTML-Class" class="headerlink" title="绑定HTML Class"></a>绑定HTML Class</h4><p>对象语法： 我们可以传给 <code>v-bind:class</code> 一个对象，以动态地切换 class：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;div class=&quot;static&quot; v-bind:class=&quot;{ active: isActive, &apos;text-danger&apos;: hasError }&quot;&gt;我来看看&lt;/div&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            isActive: true,            hasError: false        },    });&lt;/script&gt;</code></pre><p>当然你可以写出返回对象的计算属性：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;div v-bind:class=&quot;classObject&quot;&gt;我来看看&lt;/div&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            isActive: true,            error: null        },        computed: {            classObject: function() {                return {                    active: this.isActive &amp;&amp; !this.error,                        &apos;text-danger&apos;: this.error &amp;&amp; this.error.type === &apos;fatal&apos;                }            }        }    });&lt;/script&gt;</code></pre><p>数组语法： 我们可以把一个数组传给 <code>v-bind:class</code>，以应用一个 class 列表：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;div v-bind:class=&quot;[activeClass,errorClass]&quot;&gt;我来看看&lt;/div&gt;    &lt;div v-bind:class=&quot;[isActive ? activeClass : &apos;&apos;, errorClass]&quot;&gt;我来看看&lt;/div&gt;    &lt;div v-bind:class=&quot;[{ active: isActive }, errorClass]&quot;&gt;我来看看&lt;/div&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            isActive: true,            activeClass: &apos;active&apos;,            errorClass: &apos;text-danger&apos;        }    });&lt;/script&gt;</code></pre><h3 id="绑定内联样式"><a href="#绑定内联样式" class="headerlink" title="绑定内联样式"></a>绑定内联样式</h3><p>对象语法：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;div v-bind:style=&quot;{ color: activeColor, fontSize:fontSize + &apos;px&apos; }&quot;&gt;我来看看&lt;/div&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            activeColor: &apos;red&apos;,            fontSize: 20        }    });&lt;/script&gt;</code></pre><p>或者换一种更加清晰的方法：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;div v-bind:style=&quot;styleObject&quot;&gt;我来看看&lt;/div&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            styleObject: {                color: &apos;red&apos;,                fontSize: &apos;30px&apos;            }        }    });&lt;/script&gt;</code></pre><p>数组语法：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;div v-bind:style=&quot;[baseStyles,overridingStyles]&quot;&gt;我来看看&lt;/div&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            baseStyles: {                color: &apos;red&apos;            },            overridingStyles: {                fontSize: &apos;26px&apos;            }        }    });&lt;/script&gt;</code></pre><p>自动添加前缀：当 v-bind:style 使用需要添加浏览器引擎前缀的 CSS 属性时，如 transform，Vue.js 会自动侦测并添加相应的前缀。 多重值： 为 <code>style</code> 绑定中的属性提供一个包含多个值的数组，常用于提供多个带前缀的值，例如：</p><pre><code>&lt;div :style=&quot;{ display: [&apos;-webkit-box&apos;, &apos;-ms-flexbox&apos;, &apos;flex&apos;] }&quot;&gt;&lt;/div&gt;</code></pre><p>这样写只会渲染数组中最后一个被浏览器支持的值。如果浏览器支持不带浏览器前缀的 flexbox，那么就只会渲染 <code>display: flex</code>。</p><h3 id="条件渲染"><a href="#条件渲染" class="headerlink" title="条件渲染"></a>条件渲染</h3><h4 id="v-if"><a href="#v-if" class="headerlink" title="v-if"></a>v-if</h4><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;h1 v-if=&quot;ok&quot;&gt;Yes&lt;/h1&gt;    &lt;h1 v-else&gt;No&lt;/h1&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            ok: true        }    });&lt;/script&gt;</code></pre><p>在<code>&lt;template&gt;</code>元素上使用<code>v-if</code>条件渲染分组：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;template v-if=&quot;ok&quot;&gt;        &lt;h1&gt;Title&lt;/h1&gt;        &lt;p&gt;Paragraph 1&lt;/p&gt;        &lt;p&gt;Paragraph 2&lt;/p&gt;    &lt;/template&gt;    &lt;template v-else&gt;        &lt;h1&gt;Title No&lt;/h1&gt;        &lt;p&gt;Paragraph 1&lt;/p&gt;        &lt;p&gt;Paragraph 2&lt;/p&gt;    &lt;/template&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            ok: false        }    });&lt;/script&gt;</code></pre><p><code>v-else-if</code>判断：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;div v-if=&quot;type === &apos;A&apos;&quot;&gt;        Type A    &lt;/div&gt;    &lt;div v-else-if=&quot;type === &apos;B&apos;&quot;&gt;        Type B    &lt;/div&gt;    &lt;div v-else&gt;        Type Other    &lt;/div&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            type: &apos;B&apos;        }    });&lt;/script&gt;</code></pre><p>用<code>key</code>管理可复用的元素</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;template v-if=&quot;loginType === &apos;username&apos;&quot;&gt;        &lt;label for=&quot;username&quot;&gt;UserName&lt;/label&gt;        &lt;input id=&quot;username&quot; type=&quot;text&quot; placeholder=&quot;Enter Your UserName&quot; key=&quot;username-input&quot;&gt;        &lt;input v-on:click=&quot;toggle&quot; type=&quot;button&quot; value=&quot;toggle&quot;/&gt;    &lt;/template&gt;    &lt;template v-else&gt;        &lt;label for=&quot;email&quot;&gt;Email&lt;/label&gt;        &lt;input id=&quot;email&quot; type=&quot;text&quot; placeholder=&quot;Enter Your Email Address&quot; key=&quot;email-input&quot;&gt;        &lt;input v-on:click=&quot;toggle&quot; type=&quot;button&quot; value=&quot;toggle&quot;/&gt;    &lt;/template&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            loginType: &apos;username&apos;        },        methods: {            toggle: function() {                if ( this.loginType === &apos;username&apos; )                    this.loginType = &apos;email&apos;                else                    this.loginType = &apos;username&apos;            }        }    });&lt;/script&gt;</code></pre><p><code>v-show</code>： 和<code>v-if</code>使用方法大致一样，不同是<code>v-show</code>的元素始终会被渲染并保留在 DOM 中。<code>v-show</code> 只是简单地切换元素的 CSS 属性 <code>display</code>。</p><blockquote><p>注意，<code>v-show</code> 不支持 <code>&lt;template&gt;</code> 元素，也不支持 <code>v-else</code>。</p></blockquote><p><code>v-if</code> vs <code>v-show</code>： <code>v-if</code> 是“真正”的条件渲染，因为它会确保在切换过程中条件块内的事件监听器和子组件适当地被销毁和重建。 <code>v-if</code> 也是<strong>惰性的</strong>：如果在初始渲染时条件为假，则什么也不做——直到条件第一次变为真时，才会开始渲染条件块。 相比之下，<code>v-show</code> 就简单得多——不管初始条件是什么，元素总是会被渲染，并且只是简单地基于 CSS 进行切换。 一般来说，<code>v-if</code> 有更高的切换开销，而 <code>v-show</code> 有更高的初始渲染开销。因此，如果需要非常频繁地切换，则使用 <code>v-show</code> 较好；如果在运行时条件很少改变，则使用 <code>v-if</code> 较好。</p><h3 id="列表渲染"><a href="#列表渲染" class="headerlink" title="列表渲染"></a>列表渲染</h3><p>使用<code>v-for</code>把一个数组对应为一组元素，<code>v-for</code> 指令需要使用 <code>item in items</code> 形式的特殊语法，<code>items</code> 是源数据数组并且 <code>item</code> 是数组元素迭代的别名：</p><pre><code>&lt;ul id=&quot;example&quot;&gt;    &lt;li v-for=&quot;item in items&quot;&gt;        { { item.message }}    &lt;/li&gt;&lt;/ul&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            items: [                {message: &apos;A&apos;},                {message: &apos;B&apos;},                {message: &apos;C&apos;},                {message: &apos;D&apos;}            ]        }    });&lt;/script&gt;</code></pre><p>在 <code>v-for</code> 块中，拥有对父作用域属性的完全访问权限。<code>v-for</code> 还支持一个可选的第二个参数为当前项的索引：</p><pre><code>&lt;ul id=&quot;example&quot;&gt;    &lt;li v-for=&quot;(item, index) in items&quot;&gt;        第{ { index + 1 }}个 - { { item.message }}    &lt;/li&gt;&lt;/ul&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            items: [                {message: &apos;A&apos;},                {message: &apos;B&apos;},                {message: &apos;C&apos;},                {message: &apos;D&apos;}            ]        }    });&lt;/script&gt;</code></pre><p>你也可以用 <code>of</code> 替代 <code>in</code> 作为分隔符，因为它是最接近 JavaScript 迭代器的语法：</p><pre><code>&lt;div v-for=&quot;item of items&quot;&gt;&lt;/div&gt;</code></pre><p><code>v-for</code>迭代一个对象：</p><pre><code>&lt;ul id=&quot;example&quot;&gt;    &lt;li v-for=&quot;(value, key, index) in object&quot;&gt;        { { index }} - { { key }} : { { value }}    &lt;/li&gt;&lt;/ul&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            object: {                firstName: &apos;Jaxson&apos;,                lastName: &apos;Wang&apos;,                age: 23            }        }    });&lt;/script&gt;</code></pre><h4 id="数组更新检测"><a href="#数组更新检测" class="headerlink" title="数组更新检测"></a>数组更新检测</h4><p>Vue 包含一组观察数组的变异方法，所以它们也将会触发视图更新。这些方法如下：</p><ul><li>push() //可向数组的末尾添加一个或多个元素，并返回新的长度。</li><li>pop() //用于删除并返回数组的最后一个元素。</li><li>shift() //用于把数组的第一个元素从其中删除，并返回第一个元素的值。</li><li>unshift() //可向数组的开头添加一个或更多元素，并返回新的长度。</li><li>splice() //向/从数组中添加/删除项目，然后返回被删除的项目。</li><li>sort() //用于对数组的元素进行排序。</li><li>reverse() //用于颠倒数组中元素的顺序。</li></ul><p>替换数组： 变异方法 (mutation method)，顾名思义，会改变被这些方法调用的原始数组。相比之下，也有非变异 (non-mutating method) 方法，例如：<code>filter()</code>, <code>concat()</code> 和 <code>slice()</code> 。这些不会改变原始数组，但<strong>总是返回一个新数组</strong>。当使用非变异方法时，可以用新数组替换旧数组：</p><pre><code>&lt;ul id=&quot;example&quot;&gt;    &lt;li v-for=&quot;(item, index) in items&quot;&gt;        第{ { index + 1 }}个 - { { item.message }}    &lt;/li&gt;&lt;/ul&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            items: [                {message: &apos;A&apos;},                {message: &apos;B&apos;},                {message: &apos;C&apos;},                {message: &apos;D&apos;}            ]        }    });    vm.items = vm.items.filter(function (item) {        return item.message.replace(/A/,&apos;&apos;)    })&lt;/script&gt;</code></pre><p>Vue 为了使得 DOM 元素得到最大范围的重用而实现了一些智能的、启发式的方法，所以用一个含有相同元素的数组去替换原来的数组是非常高效的操作。 显示过滤/排序结果：想要显示一个数组的过滤或排序副本，而不实际改变或重置原始数据。在这种情况下，可以创建返回过滤或排序数组的计算属性。</p><pre><code>&lt;ul id=&quot;example&quot;&gt;    &lt;li v-for=&quot;item in newItems&quot;&gt;        { { item }}    &lt;/li&gt;&lt;/ul&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            items: [1,2,3,4,5]        },        computed: {            newItems: function() {                return this.items.filter(function(newItem) {                    return newItem % 2 === 0                })            }        }    });&lt;/script&gt;</code></pre><p>同样在不同的环境下<code>method</code>方法实现该方法。 使用<code>v-for</code>取值范围： <code>v-for</code> 也可以取整数。在这种情况下，它将重复多次模板。</p><pre><code>&lt;ul id=&quot;example&quot;&gt;    &lt;li v-for=&quot;item in 15&quot;&gt;        { { item }}    &lt;/li&gt;&lt;/ul&gt;</code></pre><p><code>v-for</code>和<code>v-if</code>：</p><pre><code>&lt;ul id=&quot;example&quot;&gt;    完成任务：    &lt;li v-for=&quot;(todo,key,index) in todos&quot; v-if=&quot;!todo.isComplete&quot;&gt;        { { todo.msg }}    &lt;/li&gt;&lt;/ul&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            todos: [                {msg: &apos;吃饭&apos;, isComplete: false},                {msg: &apos;睡觉&apos;, isComplete: true},                {msg: &apos;打豆豆&apos;, isComplete: false},            ]        }    });&lt;/script&gt;&lt;ul id=&quot;example&quot; v-if=&quot;todos.length&quot;&gt;    &lt;li v-for=&quot;(todo,index) in todos&quot;&gt;        { { todo.msg }}    &lt;/li&gt;&lt;/ul&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            todos: [                {msg: &apos;吃饭&apos;, isComplete: false},                {msg: &apos;睡觉&apos;, isComplete: true},                {msg: &apos;打豆豆&apos;, isComplete: false},            ]        }    });&lt;/script&gt;</code></pre><h3 id="事件处理"><a href="#事件处理" class="headerlink" title="事件处理"></a>事件处理</h3><p>在上面有个例子提到<code>v-on:click</code>事件，这就是简单的点击事件。</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;button v-on:click=&quot;say(&apos;你好&apos;)&quot;&gt;你好&lt;/button&gt;    &lt;button v-on:click=&quot;say(&apos;什么&apos;)&quot;&gt;什么&lt;/button&gt;    &lt;button v-on:click=&quot;warn(&apos;表单没有提交&apos;,$event)&quot;&gt;提交&lt;/button&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        methods: {            say: function (say) {                alert(say)            },            warn: function(message,event) {                if (event) {                    event.preventDefault()                }                alert(message)            }        }    });&lt;/script&gt;</code></pre><p>事件修饰符：在事件处理程序中调用 <code>event.preventDefault()</code> 或 <code>event.stopPropagation()</code> 是非常常见的需求。尽管可以在方法中轻松实现这点，但更好的方式是：方法只有纯粹的数据逻辑，而不是去处理 DOM 事件细节。 为了解决这个问题，Vue.js 为 <code>v-on</code> 提供了<strong>事件修饰符</strong>。之前提过，修饰符是由点开头的指令后缀来表示的。</p><ul><li><code>.stop</code></li><li><code>.prevent</code></li><li><code>.capture</code></li><li><code>.self</code></li><li><code>.once</code></li><li><p><code>.passive</code></p><!-- 阻止单击事件继续传播 --><p><a v-on:click.stop="doThis"></a></p><!-- 提交事件不再重载页面 --><form v-on:submit.prevent="onSubmit"></form><!-- 修饰符可以串联 --><p><a v-on:click.stop.prevent="doThat"></a></p><!-- 只有修饰符 --><form v-on:submit.prevent></form><!-- 添加事件监听器时使用事件捕获模式 --><!-- 即元素自身触发的事件先在此处理，然后才交由内部元素进行处理 --><div v-on:click.capture="doThis">…</div><!-- 只当在 event.target 是当前元素自身时触发处理函数 --><!-- 即事件不是从内部元素触发的 --><div v-on:click.self="doThat">…</div><!-- 点击事件将只会触发一次 --><p><a v-on:click.once="doThis"></a></p><!-- 滚动事件的默认行为 (即滚动行为) 将会立即触发 --><!-- 而不会等待 `onScroll` 完成  --><!-- 这其中包含 `event.preventDefault()` 的情况 --><div v-on:scroll.passive="onScroll">…</div></li></ul><p>按键修饰符： 全部的按键别名：</p><ul><li><code>.enter</code></li><li><code>.tab</code></li><li><code>.delete</code> (捕获“删除”和“退格”键)</li><li><code>.esc</code></li><li><code>.space</code></li><li><code>.up</code></li><li><code>.down</code></li><li><code>.left</code></li><li><p><code>.right</code></p><!-- 只有在 `keyCode` 是 13 时调用 `vm.submit()` --><input v-on:keyup.13="submit"><!-- 同上 --><input v-on:keyup.enter="submit"><!-- 缩写语法 --><input @keyup.enter="submit"></li></ul><h3 id="表单输入绑定"><a href="#表单输入绑定" class="headerlink" title="表单输入绑定"></a>表单输入绑定</h3><p>可以用 <code>v-model</code> 指令在表单 <code>&lt;input&gt;</code>、<code>&lt;textarea&gt;</code> 及 <code>&lt;select&gt;</code> 元素上创建双向数据绑定。它会根据控件类型自动选取正确的方法来更新元素。尽管有些神奇，但 <code>v-model</code>本质上不过是语法糖。它负责监听用户的输入事件以更新数据，并对一些极端场景进行一些特殊处理。</p><blockquote><p><code>v-model</code> 会忽略所有表单元素的 <code>value</code>、<code>checked</code>、<code>selected</code> 特性的初始值而总是将 Vue 实例的数据作为数据来源。你应该通过 JavaScript 在组件的 <code>data</code>选项中声明初始值。 对于需要使用输入法 (如中文、日文、韩文等) 的语言，你会发现 v-model 不会在输入法组合文字过程中得到更新。如果你也想处理这个过程，请使用 input 事件。</p></blockquote><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;input v-model=&quot;msg&quot; placeholder=&quot;随意输入&quot;/&gt;    &lt;p&gt;你输入的是: { {msg}}&lt;/p&gt;    &lt;br/&gt;    &lt;textarea v-model=&quot;textarea&quot; placeholder=&quot;你再输入看看&quot;&gt;&lt;/textarea&gt;    &lt;p&gt;{ { textarea }}&lt;/p&gt;    &lt;br/&gt;    &lt;input type=&quot;checkbox&quot; id=&quot;checkbox&quot; v-model=&quot;checkbox&quot;/&gt;    &lt;label for=&quot;checkbox&quot;&gt;{ { checkbox }}&lt;/label&gt;    &lt;br/&gt;    &lt;input type=&quot;checkbox&quot; id=&quot;jaxson&quot; value=&quot;Jaxson&quot; v-model=&quot;checkedNames&quot; /&gt;    &lt;label for=&quot;jaxson&quot;&gt;Jaxson&lt;/label&gt;    &lt;input type=&quot;checkbox&quot; id=&quot;jhon&quot; value=&quot;Jhon&quot; v-model=&quot;checkedNames&quot; /&gt;    &lt;label for=&quot;jhon&quot;&gt;Jhon&lt;/label&gt;    &lt;input type=&quot;checkbox&quot; id=&quot;aes&quot; value=&quot;Aes&quot; v-model=&quot;checkedNames&quot; /&gt;    &lt;label for=&quot;aes&quot;&gt;Aes&lt;/label&gt;    &lt;span&gt;{ { checkedNames }}&lt;/span&gt;    &lt;br/&gt;    &lt;input type=&quot;radio&quot; id=&quot;one&quot; value=&quot;One&quot; v-model=&quot;picked&quot;&gt;    &lt;label for=&quot;one&quot;&gt;One&lt;/label&gt;    &lt;input type=&quot;radio&quot; id=&quot;two&quot; value=&quot;Two&quot; v-model=&quot;picked&quot;&gt;    &lt;label for=&quot;two&quot;&gt;Two&lt;/label&gt;    &lt;span&gt;Picked: { { picked }}&lt;/span&gt;    &lt;br/&gt;    &lt;select v-model=&quot;selected1&quot;&gt;        &lt;option disabled value=&quot;&quot;&gt;请选择&lt;/option&gt;        &lt;option&gt;A&lt;/option&gt;        &lt;option&gt;B&lt;/option&gt;        &lt;option&gt;C&lt;/option&gt;        &lt;/select&gt;    &lt;span&gt;Selected: { { selected1 }}&lt;/span&gt;    &lt;br/&gt;    &lt;select v-model=&quot;selected2&quot; multiple style=&quot;width: 50px;&quot;&gt;        &lt;option&gt;A&lt;/option&gt;        &lt;option&gt;B&lt;/option&gt;        &lt;option&gt;C&lt;/option&gt;    &lt;/select&gt;    &lt;span&gt;Selected: { { selected2 }}&lt;/span&gt;    &lt;br/&gt;    &lt;select v-model=&quot;selected3&quot;&gt;        &lt;option v-for=&quot;(item,index) in items&quot;&gt;            { { item.text }}        &lt;/option&gt;    &lt;/select&gt;    &lt;span&gt;{ { selected3 }}&lt;/span&gt;    &lt;br/&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var vm = new Vue({        el: &apos;#example&apos;,        data: {            msg: &apos;&apos;,            textarea: &apos;&apos;,            checkbox: false,            checkedNames: [],            picked: &apos;&apos;,            selected1: &apos;A&apos;,            selected2: [],            selected3: &apos;&apos;,            items: [                {text: &apos;One&apos;, value: &apos;A&apos;},                {text: &apos;Two&apos;, value: &apos;B&apos;},                {text: &apos;Three&apos;, value: &apos;C&apos;},            ]        }    });&lt;/script&gt;</code></pre><h3 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h3><p>创建组件实例如下：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;button-counter&gt;&lt;/button-counter&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    // 定义一个名为 button-counter 的新组件    Vue.component(&apos;button-counter&apos;, {    data: function () {        return {            count: 0        }    },    template: &apos;&lt;button v-on:click=&quot;count++&quot;&gt;You clicked me { { count }} times.&lt;/button&gt;&apos;    })    var vm = new Vue({        el: &apos;#example&apos;    });&lt;/script&gt;</code></pre><p>因为组件是可复用的 Vue 实例，所以它们与 <code>new Vue</code> 接收相同的选项，例如 <code>data</code>、<code>computed</code>、<code>watch</code>、<code>methods</code> 以及生命周期钩子等。仅有的例外是像 <code>el</code> 这样根实例特有的选项。 同样可以任意次数使用：</p><pre><code>&lt;div id=&quot;components-demo&quot;&gt;  &lt;button-counter&gt;&lt;/button-counter&gt;  &lt;button-counter&gt;&lt;/button-counter&gt;  &lt;button-counter&gt;&lt;/button-counter&gt;&lt;/div&gt;</code></pre><p>注意当点击按钮时，每个组件都会各自独立维护它的 <code>count</code>。因为你每用一次组件，就会有一个它的新<strong>实例</strong>被创建。</p><h4 id="组件的组织"><a href="#组件的组织" class="headerlink" title="组件的组织"></a>组件的组织</h4><p>为了能在模板中使用，这些组件必须先注册以便 Vue 能够识别。这里有两种组件的注册类型：<strong>全局注册</strong>和<strong>局部注册</strong>。至此，我们的组件都只是通过 <code>Vue.component</code> 全局注册的：</p><pre><code>Vue.component(&apos;my-component-name&apos;, {  // ... options ...})</code></pre><p>全局注册的组件可以用在其被注册之后的任何 (通过 <code>new Vue</code>) 新创建的 Vue 根实例，也包括其组件树中的所有子组件的模板中。</p><h4 id="Prop"><a href="#Prop" class="headerlink" title="Prop"></a>Prop</h4><p>例如在不能向这个组件传递某一篇博文的标题或内容之类的我们想展示的数据的话，它是没有办法使用的。这也正是 prop 的由来。 Prop 是你可以在组件上注册的一些自定义特性。当一个值传递给一个 prop 特性的时候，它就变成了那个组件实例的一个属性。为了给博文组件传递一个标题，可以用一个 <code>props</code> 选项将其包含在该组件可接受的 prop 列表中，一个组件默认可以拥有任意数量的 prop，任何值都可以传递给任何 prop。在上述模板中，你会发现我们能够在组件实例中访问这个值，就像访问 <code>data</code> 中的值一样。 一个 prop 被注册之后，你就可以像这样把数据作为一个自定义特性传递进来：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;blog-post title=&quot;你好&quot;&gt;&lt;/blog-post&gt;    &lt;blog-post title=&quot;世界&quot;&gt;&lt;/blog-post&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    // 定义一个名为 button-counter 的新组件    Vue.component(&apos;blog-post&apos;, {        props: [&apos;title&apos;],        template: &apos;&lt;h3&gt;{ { title }}&lt;/h3&gt;&apos;    })    var vm = new Vue({        el: &apos;#example&apos;    });&lt;/script&gt;</code></pre><p>如果在Api获取数据：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;blog-post        v-for=&quot;(post,index) in posts&quot;        v-bind:title=&quot;post.title&quot;        v-bind:key=&quot;post.id&quot;    &gt;    &lt;/blog-post&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    // 定义一个名为 button-counter 的新组件    Vue.component(&apos;blog-post&apos;, {        props: [&apos;title&apos;],        template: &apos;&lt;h3&gt;{ { title }}&lt;/h3&gt;&apos;    })    var vm = new Vue({        el: &apos;#example&apos;,        data: {            posts: [                {id: 1, title: &quot;如果我是DJ，你会爱我吗？&quot;},                {id: 2, title: &quot;你好世界&quot;},                {id: 3, title: &quot;Hello World&quot;}            ]        }    });&lt;/script&gt;</code></pre><h4 id="单个根元素"><a href="#单个根元素" class="headerlink" title="单个根元素"></a>单个根元素</h4><p>如果组件包含更多的信息，例如：发布日期，发布作者，评论等，写起来可能很复杂。所以改造成接受一个单独的 <code>post</code> prop：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;blog-post        v-for=&quot;(post,index) in posts&quot;        v-bind:key=&quot;post.id&quot;        v-bind:post=&quot;post&quot;    &gt;    &lt;/blog-post&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    // 定义一个名为 button-counter 的新组件    Vue.component(&apos;blog-post&apos;, {        props: [&apos;post&apos;],        template: &apos;\        &lt;div class=&quot;blog-post&quot;&gt;\            &lt;h3&gt;{ { post.title }}&lt;/h3&gt;\            &lt;div v-html=&quot;post.content&quot;&gt;&lt;/div&gt;\        &lt;/div&gt;\        &apos;    })    var vm = new Vue({        el: &apos;#example&apos;,        data: {            posts: [                {id: 1, title: &quot;如果我是DJ，你会爱我吗？&quot;, content: &quot;&lt;p&gt;如果我是DJ，你会爱我吗？&lt;/p&gt;&quot;},                {id: 2, title: &quot;你好世界&quot;, content: &quot;&lt;p&gt;你好世界&lt;/p&gt;&quot;},                {id: 3, title: &quot;Hello World&quot;, content: &quot;&lt;p&gt;Hello World&lt;/p&gt;&quot;}            ]        }    });&lt;/script&gt;</code></pre><p>不论何时为 <code>post</code> 对象添加一个新的属性，它都会自动地在 <code>&lt;blog-post&gt;</code> 内可用。</p><h4 id="通过事件向父级组件发送消息"><a href="#通过事件向父级组件发送消息" class="headerlink" title="通过事件向父级组件发送消息"></a>通过事件向父级组件发送消息</h4><p>如果有些功能需要和父级组件进行沟通，例如需要改变组件的字号大小，背景颜色：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;div :style=&quot;{ fontSize: postFontSize + &apos;em&apos; }&quot;&gt;        &lt;blog-post            v-for=&quot;(post,index) in posts&quot;            v-bind:key=&quot;post.id&quot;            v-bind:post=&quot;post&quot;            v-on:enlarge-text=&quot;postFontSize +=$event&quot;        &gt;        &lt;/blog-post&gt;    &lt;/div&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    // 定义一个名为 button-counter 的新组件    Vue.component(&apos;blog-post&apos;, {        props: [&apos;post&apos;],        template: &apos;\        &lt;div class=&quot;blog-post&quot;&gt;\            &lt;h3&gt;{ { post.title }}&lt;/h3&gt;\            &lt;button v-on:click=&quot;$emit(\&apos;enlarge-text\&apos;,0.1)&quot;&gt;\                放大字体\            &lt;/button&gt;\            &lt;div v-html=&quot;post.content&quot;&gt;&lt;/div&gt;\        &lt;/div&gt;\        &apos;    })    var vm = new Vue({        el: &apos;#example&apos;,        data: {            posts: [                {id: 1, title: &quot;如果我是DJ，你会爱我吗？&quot;, content: &quot;&lt;p&gt;如果我是DJ，你会爱我吗？&lt;/p&gt;&quot;},                {id: 2, title: &quot;你好世界&quot;, content: &quot;&lt;p&gt;你好世界&lt;/p&gt;&quot;},                {id: 3, title: &quot;Hello World&quot;, content: &quot;&lt;p&gt;Hello World&lt;/p&gt;&quot;}            ],            postFontSize: 1        }    });&lt;/script&gt;</code></pre><p>在组件上使用<code>v-model</code> 自定义事件也可以用于创建支持 <code>v-model</code> 的自定义输入组件。记住：</p><pre><code>&lt;input v-model=&quot;searchText&quot;&gt;</code></pre><p>等价于</p><pre><code>&lt;input  v-bind:value=&quot;searchText&quot;  v-on:input=&quot;searchText = $event.target.value&quot;&gt;</code></pre><p>当用在组件上时，<code>v-model</code> 则会这样：</p><pre><code>&lt;custom-input  v-bind:value=&quot;searchText&quot;  v-on:input=&quot;searchText = $event&quot;&gt;&lt;/custom-input&gt;</code></pre><p>为了让它正常工作，这个组件内的 <code>&lt;input&gt;</code> 必须：</p><ul><li>将其 <code>value</code> 特性绑定到一个名叫 <code>value</code> 的 prop 上</li><li>在其 <code>input</code> 事件被触发时，将新的值通过自定义的 <code>input</code> 事件抛出</li></ul><p>写成代码之后是这样的：</p><pre><code>Vue.component(&apos;custom-input&apos;, {  props: [&apos;value&apos;],  template: `    &lt;input      v-bind:value=&quot;value&quot;      v-on:input=&quot;$emit(&apos;input&apos;, $event.target.value)&quot;    &gt;  `})</code></pre><p>现在 <code>v-model</code> 就应该可以在这个组件上完美地工作起来了：</p><pre><code>&lt;custom-input v-model=&quot;searchText&quot;&gt;&lt;/custom-input&gt;</code></pre><h4 id="通过插槽分发内容"><a href="#通过插槽分发内容" class="headerlink" title="通过插槽分发内容"></a>通过插槽分发内容</h4><p>和 HTML 元素一样，我们经常需要向一个组件传递内容，像这样：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;alert-box&gt;        Something bad happened.    &lt;/alert-box&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    // 定义一个名为 button-counter 的新组件    Vue.component(&apos;alert-box&apos;, {        template: &apos;\            &lt;div class=&quot;demo-alert-box&quot;&gt;\                &lt;strong&gt;Error!&lt;/strong&gt;\                &lt;slot&gt;&lt;/slot&gt;\            &lt;/div&gt;\        &apos;    })    var vm = new Vue({        el: &apos;#example&apos;    });&lt;/script&gt;</code></pre><h4 id="动态组件"><a href="#动态组件" class="headerlink" title="动态组件"></a>动态组件</h4><p>有的时候，在不同组件之间进行动态切换是非常有用的，比如在一个多标签的界面里：</p><pre><code>&lt;div id=&quot;example&quot;&gt;    &lt;button        v-for=&quot;tab in tabs&quot;        v-bind:key=&quot;tab&quot;        v-bind:class=&quot;[&apos;tab-button&apos;, { active: currentTab === tab }]&quot;        v-on:click=&quot;currentTab = tab&quot;    &gt;{ { tab }}&lt;/button&gt;    &lt;component        v-bind:is=&quot;currentTabComponent&quot;        class=&quot;tab&quot;    &gt;&lt;/component&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    // 定义一个名为 button-counter 的新组件    Vue.component(&apos;tab-home&apos;, {        template: &apos;&lt;div&gt;Home component&lt;/div&gt;&apos;    })    Vue.component(&apos;tab-posts&apos;, {        template: &apos;&lt;div&gt;Posts component&lt;/div&gt;&apos;    })    Vue.component(&apos;tab-archive&apos;, {        template: &apos;&lt;div&gt;Archive component&lt;/div&gt;&apos;    })    new Vue({    el: &apos;#example&apos;,    data: {        currentTab: &apos;Home&apos;,        tabs: [&apos;Home&apos;, &apos;Posts&apos;, &apos;Archive&apos;]    },    computed: {        currentTabComponent: function () {        return &apos;tab-&apos; + this.currentTab.toLowerCase()        }    }    })&lt;/script&gt;</code></pre><p>有些 HTML 元素，诸如 <code>&lt;ul&gt;</code>、<code>&lt;ol&gt;</code>、<code>&lt;table&gt;</code> 和 <code>&lt;select&gt;</code>，对于哪些元素可以出现在其内部是有严格限制的。而有些元素，诸如 <code>&lt;li&gt;</code>、<code>&lt;tr&gt;</code> 和 <code>&lt;option&gt;</code>，只能出现在其它某些特定的元素内部。 这会导致我们使用这些有约束条件的元素时遇到一些问题。例如：</p><pre><code>&lt;table&gt;  &lt;blog-post-row&gt;&lt;/blog-post-row&gt;&lt;/table&gt;</code></pre><p>这个自定义组件 <code>&lt;blog-post-row&gt;</code> 会被作为无效的内容提升到外部，并导致最终渲染结果出错。幸好这个特殊的 <code>is</code> 特性给了我们一个变通的办法：</p><pre><code>&lt;table&gt;  &lt;tr is=&quot;blog-post-row&quot;&gt;&lt;/tr&gt;&lt;/table&gt;</code></pre><p>需要注意的是<strong>如果我们从以下来源使用模板的话，这条限制是不存在的</strong>：</p><ul><li>字符串 (例如：<code>template: &#39;...&#39;</code>)</li><li>单文件组件 (<code>.vue</code>)</li><li><code>&lt;script type=&quot;text/x-template&quot;&gt;</code></li></ul>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web前端 </tag>
            
            <tag> Vue.js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>魅族16 Plus开箱体验</title>
      <link href="/meizu16-plus-unpacking-note.html"/>
      <url>/meizu16-plus-unpacking-note.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在更换Android设备之前，大概用了接近3年，从手机到个人电脑，包括部分公司设备都是Apple产品，不得不说Apple的确是很好的产品，但有些方面成长实在是太慢，或者说是库克针对自家产品理念太保守了，所以因为很大的原因放弃了Apple产品和服务。虽然不是果黑，至少现在也差不多了。 前几个月就萌发换机的想法，但前几个月国内智能机环境真的很乱，一眼望去，全是异形屏，对我来说这简直恶心至极。 去年用过接近一个月的三星S8,因为系统难用送人，无奈用回iPhone 6S Plus设备，直到最近Vivo和OPPO各自出自己新旗舰，说实话在现在的环境能改变设计都是令人佩服的，毕竟里面包含多少工程师心血以及投入巨大的资金。当然从这一事件看出来OPPO和VIVO这俩兄弟可不是一般的有钱… 那么为什么我没有选择上面俩个品牌呢？从设计感官来说，他们所出旗舰拉伸摄像头很大的程度上是不符合机械美学等，毕竟里面的零件有损耗寿命什么…虽然现在的智能机使用周期很短。另一方面我是真的真的被这俩家搭载的系统恶心到了，这叫什么？高仿iOS系统？连自己风格都没有… 其次考虑小米，小米的设备不谈，就说系统从MIUI V4就开始使用，和它一直走到MIUI 7,陪伴几年最终和它分手了，很大原因我觉得从MIUI V5开始后面三个大版本没有实质性创新功能，并莫名其妙添加无用的东西…以及广告。直到后面推出小米会员去系统广告，表示呵呵了。虽然后面好转很多，但无法改变对它的印象。 至于其它厂商还在省钱折腾刘海机，所以不再考虑。</p><h3 id="开箱"><a href="#开箱" class="headerlink" title="开箱"></a>开箱</h3><p>魅族16是今年比较惊艳的产品，或者说是目前为止最香的手机，在这环境下，完整的全面屏简直是一股清流，虽然魅族16设计中规中矩，依然保持传统的布局，但很多细节上改变是令人愉快的，例如屏占比，后壳美学… 然后拿到了首批机子，所以来一波开箱体验： <img src="https://img.alicdn.com/imgextra/i2/2038135983/TB2pgNiriAnBKNjSZFvXXaTKXXa_!!2038135983.jpg" alt> 嗯，一个POP无线耳机和6G + 128G 黑色魅族16 Plus套餐一共3640元。 让我搞笑的是在盒子后面贴了高通骁龙的Logo： <img src="https://img.alicdn.com/imgextra/i2/2038135983/TB2ziFDrfImBKNjSZFlXXc43FXa_!!2038135983.jpg" alt> 在此之前我不会想到魅族会用上高通骁龙的CPU… 盒子设计一般，谈不上高大上，但至少环保。不像某些机子那么夸张，包了多少层。 <img src="https://img.alicdn.com/imgextra/i3/2038135983/TB2HfdlrfImBKNjSZFlXXc43FXa_!!2038135983.jpg" alt> 第一眼看到是屏下指纹，引导用户指导使用核心功能。 <img src="https://img.alicdn.com/imgextra/i2/2038135983/TB2RvhlrfImBKNjSZFlXXc43FXa_!!2038135983.jpg" alt> 拿出盒子零件大概就这些，没有额外的耳机，不过这个价位的确对得起了。 <img src="https://img.alicdn.com/imgextra/i4/2038135983/TB2lEXBrb3nBKNjSZFMXXaUSFXa_!!2038135983.jpg" alt> <img src="https://img.alicdn.com/imgextra/i1/2038135983/TB2FQe.q9MmBKNjSZTEXXasKpXa_!!2038135983.jpg" alt> <img src="https://img.alicdn.com/imgextra/i4/2038135983/TB2yheKq0knBKNjSZKPXXX6OFXa_!!2038135983.jpg" alt> 魅族16 Plus系统采用的是Flyme 7，虽然没MIUI好看或者功能完善，但很多细节上有自己的特色，功能上也没那么复杂，对于普通用户来说是足够使用了。</p><h3 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h3><p>指纹敏感度还算蛮高的，试了几次基本100%通过。 相机在魅族16上足够用了，不管什么环境下基本通过。图片不放出来了，实在是太大了。 依然保留3.55m的耳机孔，以前的耳机可以继续用下去。 ….</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>自定义调用CodeMirror编辑器</title>
      <link href="/custom-call-codemirror-editor.html"/>
      <url>/custom-call-codemirror-editor.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在制作WP Editor.md插件中，我有个选项是配置JSON数据的表单框，如果直接在Textarea表单显示可能不容易看出来错误问题。所以一直在寻找更好的方法，大概前段时间看到WP更新支持CodeMirror外部调用，搜索相关资料甚是稀缺，相比文档还未完善，那今日花点时间去解决它吧。</p><h3 id="踩坑"><a href="#踩坑" class="headerlink" title="踩坑"></a>踩坑</h3><p>在老早之前有个用户发布帖子<a href="https://a8cdesignflow.wordpress.com/2017/08/21/from-no-code-to-pro-code/" target="_blank" rel="noopener">利用CodeMirror编辑主题或者插件内容</a>得到广大好评以及支持，所以WP官方采纳他的方法。大概在WP 4.9.5版本之后，CodeMirror对外开发的Api逐渐完善，正好利用它完善选项框的显示。 其实引入CodeMirror非常简单，第一就是引入CodeMirror的资源，第二就是加入Textarea Dom ID对象或者jQuery ID对象渲染编辑器即可。 但WP都帮你封装好了，至于CodeMirror配置参数无需关心太多，你只需要引入下面代码即可使用：</p><pre><code>add_action( &apos;admin_enqueue_scripts&apos;, &apos;myCodeMirror&apos; );function myCodeMirror() {    wp_enqueue_script( &apos;code-editor&apos; );    wp_enqueue_style( &apos;code-editor&apos; );    // 编辑器内容类型    $settings = wp_enqueue_code_editor( array( &apos;type&apos; =&gt; &apos;application/json&apos; ) );    // 系统禁用CodeMirror    if ( false === $settings ) {        return;    }    wp_add_inline_script(        &apos;code-editor&apos;,        sprintf(            &apos;jQuery( function() { wp.codeEditor.initialize( &quot;myTextareaID&quot;, %s ); } );&apos;,//myTextareaID为Textarea ID            wp_json_encode( $settings )        )    );    wp_add_inline_script(        &apos;wp-codemirror&apos;,        &apos;window.CodeMirror = wp.CodeMirror;&apos;    );}</code></pre><p>你只需要注意配置内容类型，我这用的是<code>&#39;type&#39; =&gt; &#39;application/json&#39;</code>，更多类型请查看<a href="https://developer.wordpress.org/reference/functions/wp_enqueue_code_editor/" target="_blank" rel="noopener">WordPress开发文档</a>，其次就是注意<code>myTextareaID</code>为Textarea DOM ID对象，具体信息请参考<code>wordpress\wp-admin\js\code-editor.js</code>第265行。</p><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><blockquote><p><a href="https://make.wordpress.org/core/2017/10/22/code-editing-improvements-in-wordpress-4-9/" target="_blank" rel="noopener">Code Editing Improvements in WordPress 4.9</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WordPress </tag>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>搭建第一个Golang Web服务器</title>
      <link href="/build-the-first-golang-web-server.html"/>
      <url>/build-the-first-golang-web-server.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>Go语言里面提供了一个完善的net/http包，通过http包可以很方便的就搭建起来一个可以运行的Web服务。同时使用这个包能很简单地对Web的路由，静态文件，模版，cookie等数据进行设置和操作。</p><h3 id="建立"><a href="#建立" class="headerlink" title="建立"></a>建立</h3><p>http包建立Web服务器</p><pre><code>package mainimport (    &quot;net/http&quot;    &quot;fmt&quot;    &quot;strings&quot;    &quot;log&quot;)func sayhelloName(w http.ResponseWriter, r *http.Request)  {    r.ParseForm() //解析参数，默认是不会解析的    fmt.Println(r.Form) //输出到服务端的打印信息    fmt.Println(&quot;path&quot;, r.URL.Path)    fmt.Println(&quot;Scheme&quot;, r.URL.Scheme)    fmt.Println(r.Form[&quot;url_long&quot;])    for k, v:=range r.Form {        fmt.Println(&quot;key:&quot;, k)        fmt.Println(&quot;val:&quot;, strings.Join(v, &quot;&quot;))    }    fmt.Fprintf(w, &quot;Hello World!&quot;) //写入到w的是输出客户端}func main() {    http.HandleFunc(&quot;/&quot;, sayhelloName) //设置访问路由    err := http.ListenAndServe(&quot;:9090&quot;, nil) //设置端口    if err != nil {        log.Fatal(&quot;ListenAndServe&quot;, err)    }}</code></pre><p>上面这个代码，我们build之后，然后执行web.exe,这个时候其实已经在9090端口监听http链接请求了。 然后访问URL带着参数可以在控制台看到相关信息。</p><h3 id="解析"><a href="#解析" class="headerlink" title="解析"></a>解析</h3><p>以下均是服务器端的几个概念 Request：用户请求的信息，用来解析用户的请求信息，包括post、get、cookie、url等信息 Response：服务器需要反馈给客户端的信息 Conn：用户的每次请求链接 Handler：处理请求和生成返回信息的处理逻辑 通过对http包的分析之后，现在让我们来梳理一下整个的代码执行过程。</p><ul><li><p>首先调用Http.HandleFunc 按顺序做了几件事： 1 调用了DefaultServeMux的HandleFunc 2 调用了DefaultServeMux的Handle 3 往DefaultServeMux的map[string]muxEntry中增加对应的handler和路由规则</p></li><li><p>其次调用http.ListenAndServe(“:9090”, nil) 按顺序做了几件事情： 1 实例化Server 2 调用Server的ListenAndServe() 3 调用net.Listen(“tcp”, addr)监听端口 4 启动一个for循环，在循环体中Accept请求 5 对每个请求实例化一个Conn，并且开启一个goroutine为这个请求进行服务go c.serve() 6 读取每个请求的内容w, err := c.readRequest() 7 判断handler是否为空，如果没有设置handler（这个例子就没有设置handler），handler就设置为DefaultServeMux 8 调用handler的ServeHttp 9 在这个例子中，下面就进入到DefaultServeMux.ServeHttp 10 根据request选择handler，并且进入到这个handler的ServeHTTP</p><pre><code>mux.handler(r).ServeHTTP(w, r)</code></pre></li></ul><pre><code>11 选择handler： A 判断是否有路由能满足这个request（循环遍历ServeMux的muxEntry） B 如果有路由满足，调用这个路由handler的ServeHTTPC 如果没有路由满足，调用NotFoundHandler的ServeHTTP</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Go </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用面向对象编程创建主题​​选项</title>
      <link href="/create-theme-options.html"/>
      <url>/create-theme-options.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>由于新开插件坑，需要选项支持，故写了这篇文章，还是以官网默认主题为主(twentysixteen)。 由于篇幅过长的问题，细节上的不再描述，直接贴上代码分享吧。</p><h3 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h3><p>在主题目录下新建<code>settings</code>文件夹目录，分别新建<code>settings.css</code> <code>settings.js</code> <code>settings.php</code>文件： <code>settings.css</code>：</p><pre><code>/*1. Theme Settings General1.1 Checkbox1.2 Input Field1.3 Image Field*//*************** 1. Theme Settings General ***************/.theme_settings_inner_content {    padding: 30px;    background: #fff;    margin-top: 20px;}.settings_above_meta .save_all {    text-decoration: none;    background: #ddd;    border-radius: 3px;    margin-top: 15px;    text-transform: uppercase;    padding: 8px 10px;    display: inline-block;    color: #4e4a4a;    -webkit-transition: all 200ms ease-in;    transition: all 200ms ease-in;}.settings_above_meta .save_all:hover {    background: #ccc;}.settings_above_meta .save_all:active,.settings_above_meta .save_all:focus {    border: 0;    box-shadow: none;    outline: 0;}.settings_above_meta .spinner {    background: url(spinner.gif) no-repeat;    -webkit-background-size: 20px 20px;    background-size: 20px 20px;    display: inline-block;    visibility: hidden;    float:none;    vertical-align: middle;    opacity: .7;    filter: alpha(opacity=70);    width: 20px;    height: 20px;    margin: -2px 10px 0;}.settings_above_meta .saved_options {    color: #3eb72f;    font-weight: 600;    text-transform: uppercase;}.twentysixteen_options_left {    width: 30%;    margin-left: 30px;    display: inline-block;    vertical-align: top;    margin-bottom: 20px;}.twentysixteen_options_right {    width: 60%;    display: inline-block;    vertical-align: top;    margin-bottom: 20px;}/*****---------- 1.1 Checkbox ----------*****/input[type=&quot;checkbox&quot;].twentysixteen_setting {    display: none;}.checkbox_label{    -webkit-touch-callout: none;    -webkit-user-select: none;    -khtml-user-select: none;    -moz-user-select: none;    -ms-user-select: none;    user-select: none;}.twentysixteen_setting.checkbox {    width: 25px;    height: 25px;    background: #fff;    border: 1px solid #ddd;    border-radius: 3px;    margin-right: 20px;    display: inline-block;    vertical-align: middle;    position: relative;}.twentysixteen_setting.checkbox:before {    content: &apos;✔&apos;;    color: transparent;    position: absolute;    top: 5px;    left: 6px;    font-size: 19px;    line-height: 0.8;    -webkit-transition: all 150ms ease-in;    transition: all 150ms ease-in;}.twentysixteen_setting.checkbox.checked:before {    content: &apos;✔&apos;;    color: #2bb1ef;}/*****---------- 1.2 Input Field ----------*****/.twentysixteen_options_wrapper input[type=&quot;text&quot;] {    background: #fff;    border: 1px solid #ddd;    padding: 3px 10px;    border-radius: 3px;    box-shadow: none;}.twentysixteen_options_wrapper input[type=&quot;text&quot;]:active,.twentysixteen_options_wrapper input[type=&quot;text&quot;]:focus {    border: 1px solid #ddd;    box-shadow: none;    outline: 0;}/*****---------- 1.3 Image Field ----------*****/.twentysixteen_uploaded_image img {    max-width: 30%;    margin-bottom: 20px;}</code></pre><p><code>settings.js</code>：</p><pre><code>jQuery( document ).ready(function( $) {    &quot;use strict&quot;;    $( document )        .on(&apos;click&apos;, &apos;#twentysixteen_settings_save&apos;, settings_save )        .on(&apos;click&apos;, &apos;.checkbox_label&apos;, checkbox_switch );    /********* Checkbox Switch ***********/    function checkbox_switch(e) {        e.preventDefault();        var $this = $(this);        var utter_hide_layout = $this.data(&apos;settings&apos;);        var $hidden_input = $this.prev(&apos;input&apos;);        var $checkbox = $this.find(&apos;.checkbox&apos;);        if ( $checkbox.hasClass(&apos;checked&apos;) ) {            $checkbox.removeClass(&apos;checked&apos;);            $hidden_input.val(&apos;0&apos;);            $( utter_hide_layout ).hide();        } else {            $checkbox.addClass(&apos;checked&apos;);            $hidden_input.val(&apos;1&apos;);            $( utter_hide_layout ).show();        }    }    function settings_save(e) {        e.preventDefault();        var $saved = $(&apos;.settings_above_meta .saved_options&apos;);        var $spinner = $(&apos;.settings_above_meta .spinner&apos;);        var settings_out = {};        settings_out[&apos;settings&apos;] = {};        settings_out[&apos;settings&apos;][&apos;google_api_key&apos;] = $(&apos;.twentysixteen_options_wrapper .google_api_key&apos;).val();        settings_out[&apos;settings&apos;][&apos;google_maps_enable&apos;] = $(&apos;.twentysixteen_options_wrapper .google_maps_enable&apos;).val();        $.ajax({            type: &apos;POST&apos;,            url: ajaxurl,            data: {                &apos;action&apos; : &apos;twentysixteen_settings_save&apos;,                &apos;data&apos; : JSON.stringify( settings_out, null, 2 ),                &apos;twentysixteen_settings_nonce&apos; : $(&apos;#twentysixteen_settings_nonce&apos;).val()            },            success: function(data) {                $saved.text( twentysixteen_settings_object.saved ).delay( 2000 ).fadeOut();            },            beforeSend : function () {                $saved.text(&apos;&apos;).show();                $spinner.css(&apos;visibility&apos;, &apos;visible&apos;);            },            error : function (jqXHR, textStatus, errorThrown) {                $loader.html( jqXHR + &apos; :: &apos; + textStatus + &apos; :: &apos; + errorThrown );            },            complete : function () {                $spinner.css(&apos;visibility&apos;, &apos;hidden&apos;);            }        });    }});</code></pre><p><code>settings.php</code>：</p><pre><code>&lt;?php/** * Theme Settings * * @package    WordPress * @subpackage twentysixteen/inc/theme-settings * @version    1.0.0 * @author     Made by Denis &lt;https://madebydenis.com/&gt; * @license    https://www.gnu.org/licenses/gpl-3.0.txt GNU/GPLv3 * @link       https://twentysixteen.io * @since      1.0.0 */add_filter(&apos;admin_init&apos;, &apos;twentysixteen_theme_settings_capability&apos;);/** * Restrict access to the theme settings page to admins * * @since  1.0.0 * @return void If user is not administrator they won&apos;t see Theme Settings */function twentysixteen_theme_settings_capability() {    if (!current_user_can(&apos;manage_options&apos;)) {        return;    }}add_action(&apos;admin_menu&apos;, &apos;twentysixteen_theme_settings_add_page&apos;);/** * Theme Settings add menu page * * @since  1.0.0 * @return void The resulting page&apos;s hook_suffix */function twentysixteen_theme_settings_add_page() {    add_menu_page(esc_html__(&apos;Theme Settings&apos;, &apos;twentysixteen&apos;), esc_html__(&apos;Theme Settings&apos;, &apos;twentysixteen&apos;), &apos;edit_theme_options&apos;, &apos;twentysixteen_theme_settings&apos;, &apos;twentysixteen_settings_render_page&apos;);}/** * Theme Settings page builder function * * @param  string $title The title of the page. * @param  array $values Array of the setting values from the database. * * @return string         Returned compiled HTML of the page */function twentysixteen_build_settings_html($title, $values = null) {    $out = &apos;&apos;;    $value = 0;    $checked = &apos;&apos;;    $maps_enabled = (isset($values) &amp;&amp; &apos;&apos; !== $values) ? $values-&gt;google_maps_enable : &apos;&apos;;    if (isset($maps_enabled) &amp;&amp; &apos;1&apos; === $maps_enabled) {        $value = 1;        $checked = &apos;checked&apos;;    }    $out .= &apos;&lt;h3&gt;&apos; . esc_html__(&apos;Settings&apos;, &apos;twentysixteen&apos;) . &apos;&lt;/h3&gt;&lt;div class=&quot;twentysixteen_options_wrapper&quot;&gt;&lt;h4&gt;&apos; . esc_html__(&apos;Enable Google Maps&apos;, &apos;twentysixteen&apos;) . &apos;&lt;/h4&gt;&lt;input type=&quot;hidden&quot; class=&quot;twentysixteen_setting google_maps_enable&quot; name=&quot;google_maps_enable&quot; value=&quot;&apos; . $value . &apos;&quot;&gt;&lt;label class=&quot;checkbox_label&quot; for=&quot;google_maps_enable&quot; data-settings=&quot;.twentysixteen_google_maps_api_key&quot;&gt;&lt;span class=&quot;twentysixteen_setting checkbox &apos; . $checked . &apos;&quot;&gt;&lt;/span&gt;&apos; . esc_html__(&apos;Enable google map&apos;, &apos;twentysixteen&apos;) . &apos;&lt;/label&gt;&lt;p class=&quot;info&quot;&gt;&apos; . esc_html__(&apos;Use this if you are not using external plugin to power the Google Maps . &apos;, &apos;twentysixteen&apos;) . &apos;&lt;/p&gt;&lt;/div&gt;&apos;;    if (isset($maps_enabled) &amp;&amp; &apos;1&apos; === $maps_enabled) {        $out .= &apos;&lt;div class=&quot;twentysixteen_options_wrapper twentysixteen_google_maps_api_key show&quot;&gt;&lt;h4&gt;&apos; . esc_html__(&apos;Add Google Maps API key&apos;, &apos;twentysixteen&apos;) . &apos;&lt;/h4&gt;&lt;input type=&quot;text&quot; class=&quot;twentysixteen_setting google_api_key&quot; name=&quot;google_api_key&quot; value=&quot;&apos; . esc_attr($values-&gt;google_api_key) . &apos;&quot; /&gt;&lt;p class=&quot;info&quot;&gt;&apos; . esc_html__(&apos;You need to find your API key? Just click on this link: &apos;, &apos;twentysixteen&apos;) . &apos;&lt;a href=&quot;https://console.developers.google.com/&quot;&gt;&apos; . esc_html__(&apos;Google API keys&apos;, &apos;twentysixteen&apos;) . &apos;&lt;/a&gt;.&lt;/p&gt;&lt;/div&gt;&apos;;    } else {        $out .= &apos;&lt;div class=&quot;twentysixteen_options_wrapper twentysixteen_google_maps_api_key&quot; style=&quot;display:none;&quot;&gt;&lt;h4&gt;&apos; . esc_html__(&apos;Add Google Maps API key&apos;, &apos;twentysixteen&apos;) . &apos;&lt;/h4&gt;&lt;input type=&quot;text&quot; class=&quot;twentysixteen_setting google_api_key&quot; name=&quot;google_api_key&quot; value=&quot;&quot; /&gt;&lt;p class=&quot;info&quot;&gt;&apos; . esc_html__(&apos;You need to find your API key? Just click on this link: &apos;, &apos;twentysixteen&apos;) . &apos;&lt;a href=&quot;https://console.developers.google.com/&quot;&gt;&apos; . esc_html__(&apos;Google API keys&apos;, &apos;twentysixteen&apos;) . &apos;&lt;/a&gt;.&lt;/p&gt;&lt;/div&gt;&apos;;    }    return $out;}/** * Theme Settings page render function * * @return void */function twentysixteen_settings_render_page() {    ?&gt;    &lt;div class=&quot;wrap&quot;&gt;    &lt;h2 class=&quot;page_title&quot;&gt;&lt;?php esc_html_e(&apos;Theme Settings&apos;, &apos;twentysixteen&apos;) ?&gt;&lt;/h2&gt;    &lt;p class=&quot;description&quot;&gt;&lt;?php esc_html_e(&apos;General theme settings&apos;, &apos;twentysixteen&apos;) ?&gt;&lt;/p&gt;    &lt;div class=&quot;settings_above_meta&quot;&gt;        &lt;a href=&quot;#&quot; class=&quot;save_all&quot; id=&quot;twentysixteen_settings_save&quot;&gt;&lt;?php esc_html_e(&apos;Save All&apos;, &apos;twentysixteen&apos;) ?&gt;&lt;/a&gt;        &lt;span class=&quot;spinner&quot;&gt;&lt;/span&gt;&lt;span class=&quot;saved_options&quot;&gt;&lt;/span&gt;    &lt;/div&gt;    &lt;div class=&quot;theme_settings_inner_content&quot;&gt;        &lt;?php        $twentysixteen_settings = get_option(&apos;twentysixteen_settings&apos;, &apos;&apos;);        if (isset($twentysixteen_settings) &amp;&amp; &apos;&apos; !== $twentysixteen_settings) {            foreach ($twentysixteen_settings as $key =&gt; $values) {                echo twentysixteen_build_settings_html(&apos;Settings&apos;, $values); // WPCS: XSS ok.            }        } else {            echo twentysixteen_build_settings_html(&apos;Settings&apos;); // WPCS: XSS ok.        }        wp_nonce_field(&apos;twentysixteen_settings_nonce_action&apos;, &apos;twentysixteen_settings_nonce&apos;); ?&gt;    &lt;/div&gt;    &lt;/div&gt;&lt;?php}add_action(&apos;wp_ajax_twentysixteen_settings_save&apos;, &apos;twentysixteen_settings_save_callback&apos;);/** * Settings save AJAX callback function * * @return void */function twentysixteen_settings_save_callback() {    if (isset($_POST[&apos;data&apos;], $_POST[&apos;twentysixteen_settings_nonce&apos;]) &amp;&amp; wp_verify_nonce(sanitize_key($_POST[&apos;twentysixteen_settings_nonce&apos;]), &apos;twentysixteen_settings_nonce_action&apos;) &amp;&amp; &apos;&apos; !== $_POST[&apos;data&apos;]) { // Input var okay.        $twentysixteen_settings = json_decode(sanitize_text_field(wp_unslash($_POST[&apos;data&apos;]))); // Input var okay.        update_option(&apos;twentysixteen_settings&apos;, $twentysixteen_settings);    }    wp_die();}add_action(&apos;admin_enqueue_scripts&apos;, &apos;twentysixteen_theme_settings_admin_scripts&apos;);/** * Enqueue style and scripts for Theme Settings page * * @since  1.0.0 * * @param  string $hook Page hook suffix where the scripts and styles should be loaded. * * @return void */function twentysixteen_theme_settings_admin_scripts($hook) {    $screen = get_current_screen();    $screen_id = $screen-&gt;id;    if (strpos($screen_id, &apos;page_twentysixteen_theme&apos;) !== false) {        wp_enqueue_style(&apos;twentysixteen_theme_settings_css&apos;, get_template_directory_uri() . &apos;/settings/settings.css&apos;, &apos;&apos;, &apos;1.0.0&apos;);        wp_enqueue_style(&apos;wp-color-picker&apos;);        wp_enqueue_media();        wp_enqueue_script(&apos;twentysixteen_theme_settings_js&apos;, get_template_directory_uri() . &apos;/settings/settings.js&apos;, array(&apos;jquery&apos;, &apos;wp-color-picker&apos;), &apos;1.0.0&apos;, true);        wp_localize_script(            &apos;twentysixteen_theme_settings_js&apos;, &apos;twentysixteen_settings_object&apos;, array(            &apos;saved&apos; =&gt; esc_html__(&apos;Settings Saved&apos;, &apos;twentysixteen&apos;),            &apos;delete&apos; =&gt; esc_html__(&apos;Delete&apos;, &apos;twentysixteen&apos;),            &apos;save&apos; =&gt; esc_html__(&apos;Save&apos;, &apos;twentysixteen&apos;),        ));    }}/** * Builds Settings subpage * * @package    WordPress * @subpackage twentysixteen/inc/theme-settings * @version    1.0.0 * @author     Made by Denis &lt;https://madebydenis.com/&gt; * @license    https://www.gnu.org/licenses/gpl-3.0.txt GNU/GPLv3 * @link       https://twentysixteen.io * @since      1.0.0 */class SettingsSubageBuilder {    /**     * Name of the subpage menu     *     * @var string $subpage_name The name of the subpage.     */    private $subpage_name;    /**     * Array of elements to be used in the HTML render of the settings page     *     * @var string $subpage_name The name of the subpage.     */    private $html_array;    /**     * Initialization of the class     *     * @param  string $subpage_name The name of the settings page, e.g. Header Settings.     * @param  array $html_array    The HTML array details for building the settings page.     */    public function __construct($subpage_name, $html_array) {        $this-&gt;subpage_name = $subpage_name;        $this-&gt;html_array = $html_array;        add_action(&apos;admin_menu&apos;, array($this, &apos;create_submenu_pages&apos;));        add_action(&apos;wp_ajax_twentysixteen_settings_save_action&apos;, array($this, &apos;twentysixteen_all_settings_save&apos;));    }    /**     * Create submenu page for each settings     *     * @return void     */    public function create_submenu_pages() {        $page_hook = &apos;twentysixteen_theme_&apos; . strtolower(str_replace(&apos; &apos;, &apos;_&apos;, $this-&gt;subpage_name));        add_submenu_page(&apos;twentysixteen_theme_settings&apos;, $this-&gt;subpage_name, $this-&gt;subpage_name, &apos;edit_theme_options&apos;, $page_hook, array($this, &apos;twentysixteen_settings_render_subpage&apos;));    }    /**     * Settings control render function     *     * This function takes the single control value, and based on what that control is     * renders the appropriate control.     *     * @param  array $default_value Array of the associated default controls with all the details of the controls.     * @param  array $saved_values  Array of the values from the database.     *     * @return string                  HTML of controls.     */    public function twentysixteen_theme_settings_control_render($default_value, $saved_values) {        $name = (isset($default_value[&apos;name&apos;]) &amp;&amp; &apos;&apos; !== $default_value[&apos;name&apos;]) ? $default_value[&apos;name&apos;] : &apos;&apos;;        $control_type = (isset($default_value[&apos;control_type&apos;]) &amp;&amp; &apos;&apos; !== $default_value[&apos;control_type&apos;]) ? $default_value[&apos;control_type&apos;] : &apos;&apos;;        $description = (isset($default_value[&apos;description&apos;]) &amp;&amp; &apos;&apos; !== $default_value[&apos;description&apos;]) ? &apos;&lt;p class=&quot;description&quot;&gt;&apos; . $default_value[&apos;description&apos;] . &apos;&lt;/p&gt;&apos; : &apos;&apos;;        $control_slug = &apos;twentysixteen_&apos; . str_replace(&apos; &apos;, &apos;_&apos;, strtolower($name));        $control_settings = (isset($saved_values) &amp;&amp; &apos;&apos; !== $saved_values) ? $saved_values : &apos;&apos;;        $value = (isset($control_settings[$control_slug]) &amp;&amp; &apos;&apos; !== $control_settings[$control_slug]) ? $control_settings[$control_slug] : &apos;&apos;;        $out = &apos;&apos;;        switch ($control_type) {            case &apos;input&apos;:                $out .= &apos;&lt;div class=&quot;twentysixteen_options_wrapper&quot;&gt;&lt;div class=&quot;twentysixteen_options_left&quot;&gt;&lt;h4&gt;&apos; . esc_html($name) . &apos;&lt;/h4&gt;&lt;/div&gt;&lt;div class=&quot;twentysixteen_options_right&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;&apos; . esc_attr($control_slug) . &apos;&quot; value=&quot;&apos; . esc_attr($value) . &apos;&quot; class=&quot;twentysixteen_setting&quot;&gt;&apos; . wp_kses_post($description) . &apos;&lt;/div&gt;&lt;/div&gt;&apos;;                break;            case &apos;image&apos;:                $out .= &apos;&lt;div class=&quot;twentysixteen_options_wrapper&quot;&gt;&lt;div class=&quot;twentysixteen_options_left&quot;&gt;&lt;h4&gt;&apos; . esc_html($name) . &apos;&lt;/h4&gt;&lt;/div&gt;&lt;div class=&quot;twentysixteen_options_right&quot;&gt;&lt;div class=&quot;twentysixteen_uploaded_image&quot;&gt;&lt;img src=&quot;&apos; . esc_url($value) . &apos;&quot; /&gt;&lt;/div&gt;&lt;input type=&quot;text&quot; name=&quot;&apos; . esc_attr($control_slug) . &apos;&quot; value=&quot;&apos; . esc_url($value) . &apos;&quot; class=&quot;twentysixteen_setting twentysixteen_image_upload&quot;&gt;&lt;input type=&quot;button&quot; name=&quot;image_upload&quot; value=&quot;&apos; . esc_html__(&apos;Upload Image&apos;, &apos;twentysixteen&apos;) . &apos;&quot; class=&quot;button upload_image_button&quot;&gt;&lt;input type=&quot;button&quot; name=&quot;remove_image_upload&quot; value=&quot;&apos; . esc_html__(&apos;Remove Image&apos;, &apos;twentysixteen&apos;) . &apos;&quot; class=&quot;button remove_image_button&quot;&gt;&apos; . wp_kses_post($description) . &apos;&lt;/div&gt;&lt;/div&gt;&apos;;                break;            case &apos;checkbox&apos;:                $checked = &apos;&apos;;                if (isset($value) &amp;&amp; &apos;1&apos; === $value) {                    $checked = &apos;checked&apos;;                }                $out .= &apos;&lt;div class=&quot;twentysixteen_options_wrapper&quot;&gt;&lt;div class=&quot;twentysixteen_options_left&quot;&gt;&lt;h4&gt;&apos; . esc_html($name) . &apos;&lt;/h4&gt;&lt;/div&gt;&lt;div class=&quot;twentysixteen_options_right&quot;&gt;&lt;input type=&quot;checkbox&quot; name=&quot;&apos; . esc_attr($control_slug) . &apos;&quot; value=&quot;&apos; . esc_attr($value) . &apos;&quot; &apos; . checked($value, 1, false) . &apos; class=&quot;twentysixteen_setting&quot;&gt;&lt;label class=&quot;checkbox_label&quot;&gt;&lt;span class=&quot;twentysixteen_setting checkbox &apos; . $checked . &apos;&quot;&gt;&lt;/span&gt;&apos; . esc_html($name) . &apos;&lt;/label&gt;&apos; . wp_kses_post($description) . &apos;&lt;/div&gt;&lt;/div&gt;&apos;;                break;            case &apos;colorpicker&apos;:                $out .= &apos;&lt;div class=&quot;twentysixteen_options_wrapper&quot;&gt;&lt;div class=&quot;twentysixteen_options_left&quot;&gt;&lt;h4&gt;&apos; . esc_html($name) . &apos;&lt;/h4&gt;&lt;/div&gt;&lt;div class=&quot;twentysixteen_options_right&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;&apos; . esc_html($control_slug) . &apos;&quot; value=&quot;&apos; . esc_attr($value) . &apos;&quot; class=&quot;twentysixteen_setting twentysixteen_color_picker&quot;/&gt;&apos; . wp_kses_post($description) . &apos;&lt;/div&gt;&lt;/div&gt;&apos;;                break;            case &apos;select&apos;:                $out .= &apos;&lt;div class=&quot;twentysixteen_options_wrapper&quot;&gt;&lt;div class=&quot;twentysixteen_options_left&quot;&gt;&lt;h4&gt;&apos; . esc_html($name) . &apos;&lt;/h4&gt;&lt;/div&gt;&lt;div class=&quot;twentysixteen_options_right&quot;&gt;&lt;select class=&quot;twentysixteen_setting&quot; name=&quot;&apos; . esc_html($control_slug) . &apos;&quot;&gt;&lt;option value=&quot;&quot;&gt; -- &lt;/option&gt;&apos;;                if (isset($default_value[&apos;options&apos;]) &amp;&amp; &apos;&apos; !== $default_value[&apos;options&apos;]) {                    foreach ($default_value[&apos;options&apos;] as $option_name =&gt; $option_value) {                        $selected = (isset($value) &amp;&amp; &apos;&apos; !== $value &amp;&amp; $option_name === $value) ? &apos;selected=&quot;selected&quot;&apos; : &apos;&apos;;                        $out .= &apos;&lt;option value=&quot;&apos; . esc_attr($option_name) . &apos;&quot; &apos; . esc_attr($selected) . &apos; &gt;&apos; . esc_html($option_value) . &apos;&lt;/option&gt;&apos;;                    }                }                $out .= &apos;&lt;/select&gt;&apos; . wp_kses_post($description) . &apos;&lt;/div&gt;&lt;/div&gt;&apos;;                break;            default:                break;        }        return $out;    }    /**     * Rendering function for settings subpage     *     * @return void HTML rendered content.     */    public function twentysixteen_settings_render_subpage() {        $settings_array = $this-&gt;html_array;        if (isset($settings_array) &amp;&amp; !empty($settings_array)) {            $set_options = json_decode(json_decode(get_option(&apos;twentysixteen_&apos; . str_replace(&apos; &apos;, &apos;_&apos;, strtolower($this-&gt;subpage_name)), &apos;&apos;))); // Get options from the database.            ?&gt;            &lt;div class=&quot;wrap&quot;&gt;                &lt;h2 class=&quot;page_title&quot;&gt;&lt;?php echo esc_html($this-&gt;subpage_name); ?&gt;&lt;/h2&gt;                &lt;p class=&quot;description&quot;&gt;&lt;?php echo esc_html($settings_array[&apos;description&apos;]); ?&gt;&lt;/p&gt;                &lt;div class=&quot;settings_above_meta&quot;&gt;                    &lt;a href=&quot;#&quot; class=&quot;save_all&quot; id=&quot;twentysixteen_settings_save_subpage&quot;&gt;&lt;?php esc_html_e(&apos;Save All&apos;, &apos;twentysixteen&apos;) ?&gt;&lt;/a&gt;                    &lt;span class=&quot;spinner&quot;&gt;&lt;/span&gt;&lt;span class=&quot;saved_options&quot;&gt;&lt;/span&gt;                &lt;/div&gt;                &lt;ul class=&quot;theme_settings_inner_content&quot;&gt;                    &lt;?php                    if (isset($set_options) &amp;&amp; &apos;&apos; !== $set_options) {                        foreach ((array)$set_options as $options_key =&gt; $options_value) {                            ?&gt;                            &lt;li class=&quot;settings_container &lt;?php echo (&apos;0&apos; === $options_key) ? &apos;show&apos; : &apos;&apos; // WPCS: XSS ok. ?&gt;&quot;&gt;                                &lt;?php                                foreach ($settings_array[&apos;settings_control&apos;] as $control_name =&gt; $default_value) {                                    echo $this-&gt;twentysixteen_theme_settings_control_render($default_value, (array)$options_value); // WPCS: XSS ok.                                }                                wp_nonce_field(&apos;twentysixteen_settings_nonce_action&apos;, &apos;twentysixteen_settings_nonce&apos;);                                ?&gt;                            &lt;/li&gt;                            &lt;?php                        }                    } else {                        ?&gt;                        &lt;li class=&quot;settings_container show&quot;&gt;                            &lt;?php                            foreach ($settings_array[&apos;settings_control&apos;] as $control_name =&gt; $default_value) {                                echo $this-&gt;twentysixteen_theme_settings_control_render($default_value, null); // WPCS: XSS ok.                            }                            wp_nonce_field(&apos;twentysixteen_settings_nonce_action&apos;, &apos;twentysixteen_settings_nonce&apos;);                            ?&gt;                        &lt;/li&gt;                        &lt;?php                    } ?&gt;                &lt;/ul&gt;            &lt;/div&gt;            &lt;?php        } else {            ?&gt;            &lt;div class=&quot;wrap&quot;&gt;                &lt;h2 class=&quot;page_title&quot;&gt;&lt;?php echo esc_html($this-&gt;subpage_name); ?&gt;&lt;/h2&gt;                &lt;p class=&quot;description&quot;&gt;&lt;?php esc_html_e(&apos;The options array seems to be empty. Please fill it up with settings to render the page.&apos;, &apos;twentysixteen&apos;); ?&gt;&lt;/p&gt;            &lt;/div&gt;            &lt;?php        }    }    /**     * Settings save AJAX callback function     *     * @return void     */    public function twentysixteen_all_settings_save() {        if (isset($_POST[&apos;data&apos;], $_POST[&apos;twentysixteen_settings_nonce&apos;]) &amp;&amp; wp_verify_nonce(sanitize_key($_POST[&apos;twentysixteen_settings_nonce&apos;]), &apos;twentysixteen_settings_nonce_action&apos;) &amp;&amp; &apos;&apos; !== $_POST[&apos;data&apos;]) { // Input var okay.            $twentysixteen_settings = wp_json_encode(sanitize_text_field(wp_unslash($_POST[&apos;data&apos;]))); // Input var okay.            $settings_name = &apos;twentysixteen_&apos; . str_replace(&apos; &apos;, &apos;_&apos;, strtolower($this-&gt;subpage_name));            update_option($settings_name, $twentysixteen_settings);        }        wp_die();    }}</code></pre><p>就这样最简单的设置写出来了，可以集成到插件或者设置选项里！</p><h3 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h3><blockquote><p><a href="https://madebydenis.com/creating-theme-options-using-object-oriented-programming-part-1/" target="_blank" rel="noopener">Creating Theme Options using object oriented programming (Part 1)</a> <a href="https://madebydenis.com/creating-theme-options-using-object-oriented-programming-part-2/" target="_blank" rel="noopener">Creating Theme Options using object oriented programming (Part 2)</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WordPress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Boot 构建一个REST Web服务</title>
      <link href="/spring-boot-builds-a-rest-web-service.html"/>
      <url>/spring-boot-builds-a-rest-web-service.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>使用Spring Boot做一个实例，在请求一个地址<code>http://localhost:8080/greeting</code>响应的数据是JSON数据如下：</p><pre><code>{&quot;id&quot;:1,&quot;content&quot;:&quot;Hello, World!&quot;}</code></pre><p>并且URL有一个参数<code>name</code>，例如：<code>http://localhost:8080/greeting?name=User</code>则会动态显示响应返回的数据：</p><pre><code>{&quot;id&quot;:1,&quot;content&quot;:&quot;Hello, User!&quot;}</code></pre><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><h4 id="编写表示类"><a href="#编写表示类" class="headerlink" title="编写表示类"></a>编写表示类</h4><p>复制之前编写的项目，<code>pom.xml</code>依然使用原来。从上面得知<code>id</code>字段是问候语的唯一标识符，并且<code>content</code>是问候语的展示。新建<code>src/main/java/hello/Greeting.java</code>：</p><pre><code>package hello;public class Greeting {    private final long id;    private final String content;    Greeting(long id, String content) {        this.id = id;        this.content = content;    }    public long getId() {        return id;    }    public String getContent() {        return content;    }}</code></pre><blockquote><p>正如你所见，Spring使用Jackson JSON库将Greeting的实例自动转换类型为JSON数据。</p></blockquote><h4 id="编写控制类"><a href="#编写控制类" class="headerlink" title="编写控制类"></a>编写控制类</h4><p>在Spring构建RESTful Web服务的方法中，HTTP请求由控制器处理。这些组件很容易通过@RestController注解来识别，GreetingController下面的处理GET请求/greeting通过返回类的新实例Greeting： 新建<code>src/main/java/hello/GreetingController.java</code>：</p><pre><code>package hello;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestParam;import org.springframework.web.bind.annotation.RestController;import java.util.concurrent.atomic.AtomicLong;@RestControllerpublic class GreetingController {    private static final String template = &quot;Hello, %s!&quot;;    private final AtomicLong counter = new AtomicLong();    @RequestMapping(&quot;/greeting&quot;)    public Greeting greeting(@RequestParam(value = &quot;name&quot;, defaultValue = &quot;World&quot;) String name) {        return new Greeting(counter.incrementAndGet(),String.format(template, name));    }}</code></pre><p>就这简单的代码完成大部分功能：<code>@RequestMapping</code>注解可以确保HTTP请求<code>/greeting</code>映射到<code>greeting()</code>方法。 <code>@RequestParam</code>将请求的参数<code>name</code>绑定到<code>greeting()</code>方法里，如果没有<code>name</code>参数的话，则会使用<code>defaultValue</code>的默认值。 <code>main()</code>方法实现动态值创建并返回一个<code>Greeting</code>带有<code>id</code>和<code>content</code>属性的新对象，并使用模板格式化内容。</p><h4 id="运行程序"><a href="#运行程序" class="headerlink" title="运行程序"></a>运行程序</h4><p>编写程序入口<code>src/main/java/hello/Application.java</code>：</p><pre><code>package hello;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;@SpringBootApplicationpublic class Application {    public static void main(String[] args) {        SpringApplication.run(Application.class, args);    }}</code></pre><p><code>@SpringBootApplication</code>是一个很强大的注解：</p><ul><li><code>@Configuration</code> 将该类标记为bean定义的来源。</li><li><code>@EnableAutoConfiguration</code>的作用启动自动的配置，<code>@EnableAutoConfiguration</code>注解的意思就是<code>Springboot</code>根据你添加的jar包来配置你项目的默认配置，比如根据<code>spring-boot-starter-web</code> ，来判断你的项目是否需要添加了<code>webmvc</code>和<code>tomcat</code>，就会自动的帮你配置web项目中所需要的默认配置。在下面博客会具体分析这个注解，快速入门的demo实际没有用到该注解。</li><li><code>@ComponentScan</code>，扫描当前包及其子包下被<code>@Component</code>，<code>@Controller</code>，<code>@Service</code>，<code>@Repository</code>注解标记的类并纳入到spring容器中进行管理。是以前的<code>&lt;context:component-scan&gt;</code>（以前使用在xml中使用的标签，用来扫描包配置的平行支持）。</li></ul><h4 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h4><p>到此为止实例功能基本可以实现了，访问<a href="http://localhost:8080/greeting" target="_blank" rel="noopener">http://localhost:8080/greeting</a>查看效果如何。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Java Web </tag>
            
            <tag> Spring Boot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Boot 入门</title>
      <link href="/getting-started-with-spring-boot.html"/>
      <url>/getting-started-with-spring-boot.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>记得当初放弃Java主要原因是几个框架整合，花了大半天去编写配置文件，编写任务后运行依然有报错，甚是心累，故转前端开发了。最近周围很多Java朋友说微服务开发很爽，各种简单，自己本地体验下，的确很简单。所以对此抱有很大的学习兴趣。</p><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>Spring Boot是由Pivotal团队提供的全新框架，其设计目的是用来简化新Spring应用的初始搭建以及开发过程。该框架使用了特定的方式来进行配置，从而使开发人员不再需要定义样板化的配置。用我的话来理解，就是Spring Boot其实不是什么新的框架，它默认配置了很多框架的使用方式，就像maven整合了所有的jar包，Spring Boot整合了所有的框架 。</p><h3 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h3><p>IDE：IntelliJ IDEA JDK：1.8.0_172 由于我用的是IDEA编辑器，创建环境可以创建Spring Boot项目，当然你可以从<a href="https://start.spring.io/" target="_blank" rel="noopener">https://start.spring.io/</a>根据自身环境直接<code>Generate Project</code>生成zip文件进行编写。 在IDEA创建Spring Boot操作步骤如下：</p><ul><li>在主界面点击<code>Create New Project</code>后左边列表选择<code>Spring Initalizr</code>选项，右边选项除了JDK安装自身版本其他默认即可。</li><li>点击<code>Next</code>到下一步，编写项目简介请根据实际自身情况编写。没有特需直接默认下一步。</li><li>Dependencies界面直接勾选<code>Web-Web</code>选项即可</li><li>直接<code>Next</code>下一步后IDEA会进行构建依赖jar包，请等待完成。</li><li>运行<code>main</code>方法，打开<a href="http://localhost:8080/" target="_blank" rel="noopener">http://localhost:8080/</a>地址查看效果</li></ul><p><img src="https://i.loli.net/2018/06/12/5b1f52e8ecd4e.png" alt></p><h3 id="文件解析"><a href="#文件解析" class="headerlink" title="文件解析"></a>文件解析</h3><p>如上图所示，项目目录解析：</p><ul><li>pom.xml：Maven构建说明文件。</li><li>DemoApplication.java：一个带有main()方法的类，用于启动应用程序（关键）。</li><li>DemoApplicationTests.java：一个空的Junit测试类，它加载了一个使用Spring Boot字典配置功能的Spring应用程序上下文。</li><li>application.properties：一个空的properties文件，你可以根据需要添加配置属性。</li></ul><h4 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h4><p><strong>Spring Boot父级依赖</strong> 在这儿简单说一下配置标签的意思很大的程度上和<code>Spring MVC</code>工程配置是不太一样的：</p><pre><code>&lt;parent&gt;    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;    &lt;version&gt;2.0.2.RELEASE&lt;/version&gt;    &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;&lt;/parent&gt;</code></pre><p>从<code>parent</code>得知该配置是Spring Boot父级依赖：有了这个，当前的项目就是Spring Boot项目了，spring-boot-starter-parent是一个特殊的starter,它用来提供相关的Maven默认依赖，使用它之后，常用的包依赖可以省去version标签。关于Spring Boot提供了哪些jar包的依赖，可查看[Windows 10]<code>C:\Users\Jaxson[你的用户名]\.m2\repository\org\springframework\boot\spring-boot-dependencies\2.0.2.RELEASE\spring-boot-dependencies-2.0.2.RELEASE.pom</code>文件得知。 所以在原有的配置文件上想升级某个依赖文件版本的话，可以直接<code>pom</code>文件添加指定的配置版本，例如：</p><pre><code>&lt;properties&gt;    &lt;spring-data-releasetrain.version&gt;Fowler-SR2&lt;/spring-data-releasetrain.version&gt;&lt;/properties&gt;</code></pre><p><strong>起步依赖 spring-boot-starter-xx</strong> Spring Boot提供了很多”开箱即用“的依赖模块，都是以<code>spring-boot-starter-xx</code>作为命名的。举个例子来说明一下这个起步依赖的好处，比如组装台式机和品牌机，自己组装的话需要自己去选择不同的零件，最后还要组装起来，期间有可能会遇到零件不匹配的问题。耗时又消力，而品牌机就好一点，买来就能直接用的，后续想换零件也是可以的。相比较之下，后者带来的效果更好点，起步依赖就像这里的品牌机，自动给你封装好了你想要实现的功能的依赖。就比如我们之前要实现web功能，引入了spring-boot-starter-web这个起步依赖。 <strong>Spring Boot Maven插件</strong></p><pre><code>&lt;build&gt;    &lt;plugins&gt;        &lt;plugin&gt;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;        &lt;/plugin&gt;    &lt;/plugins&gt;&lt;/build&gt;</code></pre><ul><li>把项目打包成一个可执行的超级JAR（uber-JAR）,包括把应用程序的所有依赖打入JAR文件内，并为JAR添加一个描述文件，其中的内容能让你用java -jar来运行应用程序。</li><li>搜索public static void main()方法来标记为可运行类。</li></ul><h4 id="应用入口类"><a href="#应用入口类" class="headerlink" title="应用入口类"></a>应用入口类</h4><p><code>DemoApplication</code>是一个启动类，就是一个程序入口，下面添加一个入口类方法简单的演示下：</p><pre><code>package com.example.demo;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@RestController@SpringBootApplicationpublic class DemoApplication {    @RequestMapping(&quot;/&quot;)    public String index() {        return &quot;Hello World&quot;;    }    public static void main(String[] args) {        SpringApplication.run(DemoApplication.class, args);    }}</code></pre><ul><li>@SpringBootApplication是Sprnig Boot项目的核心注解，主要目的是开启自动配置。</li><li>main方法这是一个标准的Java应用的main的方法，主要作用是作为项目启动的入口。</li><li>@RestController注解等价于@Controller+@ResponseBody的结合，使用这个注解的类里面的方法都以json格式输出。</li></ul><p>启动后在浏览器会看到<code>Hello World</code>内容，一个简单的Web的项目就这样搞定。</p><h3 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h3><h4 id="项目目录"><a href="#项目目录" class="headerlink" title="项目目录"></a>项目目录</h4><p>在实际项目中建议使用：</p><pre><code>com  +- example    +- myproject      +- Application.java      |      +- domain      |  +- Customer.java      |  +- CustomerRepository.java      |      +- service      |  +- CustomerService.java      |      +- web      |  +- CustomerController.java      |</code></pre><ul><li>Application.java 建议放到跟目录下面,主要用于做一些框架配置</li><li>domain 目录主要用于实体（Entity）与数据访问层（Repository）</li><li>service逻辑层主要是业务类代码</li><li>web(controller) 负责页面访问控制</li></ul><p>养成一个目录清晰结构习惯是必须的…方便后期的维护性和可读性。</p><h4 id="编写单元测试"><a href="#编写单元测试" class="headerlink" title="编写单元测试"></a>编写单元测试</h4><p>同样测试类编写是很重要的习惯，在本实例编写简单的http请求测试，使用mockmvc进行，利用MockMvcResultHandlers.print()打印出执行结果：</p><pre><code>package com.example.demo;import org.junit.Before;import org.junit.Test;import org.junit.runner.RunWith;import org.springframework.boot.test.context.SpringBootTest;import org.springframework.http.MediaType;import org.springframework.test.context.junit4.SpringRunner;import org.springframework.test.web.servlet.MockMvc;import org.springframework.test.web.servlet.request.MockMvcRequestBuilders;import org.springframework.test.web.servlet.result.MockMvcResultHandlers;import org.springframework.test.web.servlet.result.MockMvcResultMatchers;import org.springframework.test.web.servlet.setup.MockMvcBuilders;@RunWith(SpringRunner.class)@SpringBootTestpublic class DemoApplicationTests {    private MockMvc mvc;    @Before    public void setUp() throws Exception {        mvc = MockMvcBuilders.standaloneSetup(new DemoApplication()).build();    }    @Test    public void contextLoads() throws Exception {        mvc.perform(MockMvcRequestBuilders.get(&quot;/&quot;).accept(MediaType.APPLICATION_JSON))                .andExpect(MockMvcResultMatchers.status().isOk())                .andDo(MockMvcResultHandlers.print())                .andReturn();    }}</code></pre><h4 id="开发环境的调试"><a href="#开发环境的调试" class="headerlink" title="开发环境的调试"></a>开发环境的调试</h4><p>热启动在正常开发项目中已经很常见了吧，虽然平时开发web项目过程中，改动项目启重启总是报错；但springBoot对调试支持很好，修改之后可以实时生效，需要添加以下的配置：</p><pre><code>&lt;dependencies&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;        &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;        &lt;optional&gt;true&lt;/optional&gt;   &lt;/dependency&gt;&lt;/dependencies&gt;&lt;build&gt;    &lt;plugins&gt;        &lt;plugin&gt;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;            &lt;configuration&gt;                &lt;fork&gt;true&lt;/fork&gt;            &lt;/configuration&gt;        &lt;/plugin&gt;   &lt;/plugins&gt;&lt;/build&gt;</code></pre><p>该模块在完整的打包环境下运行的时候会被禁用。如果你使用java -jar启动应用或者用一个特定的classloader启动，它会认为这是一个“生产环境”。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul><li>Spring Boot父级依赖的概念</li><li>起步依赖 spring-boot-starter-xx的概念</li><li>应用入口类的作用</li></ul><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="https://spring.io/guides/gs/spring-boot/" target="_blank" rel="noopener">Building an Application with Spring Boot</a></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Java Web </tag>
            
            <tag> Spring Boot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java基础回顾—集合List、Map和Set</title>
      <link href="/java-basics-collection-list-map-and-set.html"/>
      <url>/java-basics-collection-list-map-and-set.html</url>
      
        <content type="html"><![CDATA[<h3 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h3><p>我们在进行Java程序开发的时候，除了最常用的基础数据类型和String对象外，也经常会用到集合相关类。 集合类存放的都是对象的引用，而非对象本身，出于表达上的便利，我们称集合中的对象就是指集合中对象的引用。 集合类型主要有3种：List、Set、和Map。 它们之间的关系可用下图来表示: <img src="https://i.loli.net/2018/06/11/5b1df81778eaa.png" alt="20180410191542757.png"> <strong>注:Map不是collections的子类，但是它们完全整合在集合中了！</strong></p><h4 id="List"><a href="#List" class="headerlink" title="List"></a>List</h4><blockquote><p>List 接口是继承于 Collection接口并定义 一个允许重复项的有序集合。该接口不但能够对列表的一部分进行处理，还添加了面向位置的操作。</p></blockquote><p>一般来说，我们在单线程中主要使用的List是ArrayList和LinkedList来实现，多线程则是使用Vector或者使用Collections.sychronizedList来装饰一个集合。 这三个的解释如下:</p><ul><li>ArrayList：内部是通过数组实现的，它允许对元素进行快随机访问。当从ArrayList的中间位置插入或者删除元素时，需要对数组进行复制、移动、代价比较高。因此，它适合随机查找和遍历，不适合插入和删除。</li><li>LinkedList: 则是链表结构存储数据的，很适合数据的动态插入和删除，随机访问和遍历速度比较慢。另外，他还提供了List接口中没有定义的方法，专门用于操作表头和表尾元素，可以当作堆栈、队列和双向队列使用。</li><li>Vector: 通过数组实现的，不同的是它支持线程的同步。访问速度ArrayList慢。</li></ul><p>它们的用法如下:</p><pre><code>List list1 = new ArrayList();List list2 = new LinkedList();List list3 = new Vector();List list4=Collections.synchronizedList(new ArrayList())</code></pre><p>在了解了它们的用法之后，我们来看看为什么说使用ArrayList比LinkedList查询快，使用LinkedList比ArrayList新增和删除快! 这里也用以下代码来进行说明，顺便也将Vector进行比较。</p><pre><code>private final static int count=50000;private static ArrayList arrayList = new ArrayList&lt;&gt;();     private static LinkedList linkedList = new LinkedList&lt;&gt;();     private static Vector vector = new Vector&lt;&gt;();  public static void main(String[] args) {    insertList(arrayList);    insertList(linkedList);    insertList(vector);    System.out.println(&quot;--------------------&quot;);    readList(arrayList);    readList(linkedList);    readList(vector);    System.out.println(&quot;--------------------&quot;);    delList(arrayList);    delList(linkedList);    delList(vector);}private  static void insertList(List list){        long start=System.currentTimeMillis();        Object o = new Object();        for(int i=0;i&lt;count;i++){            list.add(0, o);        }    System.out.println(getName(list)+&quot;插入&quot;+count+&quot;条数据，耗时:&quot;+(System.currentTimeMillis()-start)+&quot;ms&quot;); }   private  static void readList(List list){        long start=System.currentTimeMillis();        Object o = new Object();        for(int i = 0 ; i &lt; count ; i++){              list.get(i);          }    System.out.println(getName(list)+&quot;查询&quot;+count+&quot;条数据，耗时:&quot;+(System.currentTimeMillis()-start)+&quot;ms&quot;); }  private  static void delList(List list){        long start=System.currentTimeMillis();        Object o = new Object();        for(int i = 0 ; i &lt; count ; i++){           list.remove(0);           }    System.out.println(getName(list)+&quot;删除&quot;+count+&quot;条数据，耗时:&quot;+(System.currentTimeMillis()-start)+&quot;ms&quot;); }  private static String getName(List list) {         String name = &quot;&quot;;         if(list instanceof ArrayList){             name = &quot;ArrayList&quot;;         }         else if(list instanceof LinkedList){             name = &quot;LinkedList&quot;;         }         else if(list instanceof Vector){             name = &quot;Vector&quot;;         }         return name;     }结果：ArrayList插入50000条数据，耗时:281msLinkedList插入50000条数据，耗时:2msVector插入50000条数据，耗时:274ms--------------------ArrayList查询50000条数据，耗时:1msLinkedList查询50000条数据，耗时:1060msVector查询50000条数据，耗时:2ms--------------------ArrayList删除50000条数据，耗时:143msLinkedList删除50000条数据，耗时:1msVector删除50000条数据，耗时:137ms</code></pre><p>从上述结果中，可以明显看出ArrayList和LinkedList在新增、删除和查询性能上的区别。 在集合中，我们一般用于存储数据。不过有时在有多个集合的时候，我们想将这几个集合做合集、交集、差集和并集的操作。在List中，这些方法已经封装好了，我们无需在进行编写相应的代码，直接拿来使用就行。 代码示例如下:</p><pre><code>/** * 合集 * @param ls1 * @param ls2 * @return */private static List&lt;String&gt; addAll(List&lt;String&gt; ls1,List&lt;String&gt;ls2){    ls1.addAll(ls2);    return ls1;}/** * 交集 （retainAll 会删除 ls1在ls2中没有的元素） * @param ls1 * @param ls2 * @return */private static List&lt;String&gt; retainAll(List&lt;String&gt; ls1,List&lt;String&gt;ls2){    ls1.retainAll(ls2);    return ls1;}/** * 差集 (删除ls2中没有ls1中的元素) * @param ls1 * @param ls2 * @return */private static List&lt;String&gt; removeAll(List&lt;String&gt; ls1,List&lt;String&gt;ls2){    ls1.removeAll(ls2);    return ls1;}/** * 无重复的并集 (ls1和ls2中并集，并无重复) * @param ls1 * @param ls2 * @return */private static List&lt;String&gt; andAll(List&lt;String&gt; ls1,List&lt;String&gt;ls2){    //删除在ls1中出现的元素    ls2.removeAll(ls1);    //将剩余的ls2中的元素添加到ls1中    ls1.addAll(ls2);    return ls1;}</code></pre><p>当然，经常用到的还有对List进行遍历。 List数组遍历主要有这三种方法，普通的for循环，增强for循环(jdk1.5之后出现)，和Iterator(迭代器)。</p><pre><code>List&lt;String&gt; list=new ArrayList&lt;String&gt;();   list.add(&quot;a&quot;);   list.add(&quot;b&quot;);   list.add(&quot;c&quot;);   for(int i=0;i&lt;list.size();i++){       System.out.println(list.get(i));   }   for (String str : list) {         System.out.println(str);   }   Iterator&lt;String&gt; iterator=list.iterator();   while(iterator.hasNext())   {       System.out.println(iterator.next());   }</code></pre><p><strong>说明:</strong> 普通的for循环和增强for循环区别不大，主要区别在于普通的for循环可以获取集合的下标，而增强for循环则不可以。但增强for循环写起来方法，如果不需要获取具体集合的下标，推荐使用增强for循环。至于Iterator(迭代器）这种也是无法获取数据下标，但是该方法可以不用担心在遍历的过程中会集合的长度发生改变。也就是在遍历的时候对集合进行增加和删除。</p><h4 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h4><blockquote><p>Map 接口并不是 Collection 接口的继承。Map提供key到value的映射。一个Map中不能包含相同的key，每个key只能映射一个value。Map接口提供3种集合的视图，Map的内容可以被当作一组key集合，一组value集合，或者一组key-value映射。</p></blockquote><p>Map接口主要由HashMap、TreeMap、LinkedHashMap、Hashtable和ConcurrentHashMap这几个类实现。 它们的解释如下:</p><ul><li>HashMap: HashMap的键是根据HashCode来获取，所以根据键可以很快的获取相应的值。不过它的键对象是不可以重复的，它允许键为Null，但是最多只能有一条记录，不过却是可以允许多条记录的值为Null。因为HashMap是非线程安全的，所以它的效率很高。</li><li>TreeMap:可以将保存的记录根据键进行排序，默认是按键值的升序排序（自然顺序）。也可以指定排序的比较器，当用Iterator遍历TreeMap时，得到的记录是排过序的。它也是不允许key值为空，并且不是线程安全的。</li><li>LinkedHashMap:LinkedHashMap基本和HashMap一致。不过区别在与LinkedHashMap是维护一个双链表，可以将里面的数据按写入 的顺序读出。可以认为LinkedHashMap是HashMap+LinkedList。即它既使用HashMap操作数据结构，又使用LinkedList维护插入元素的先后顺序。它也不是线程安全的。</li><li>Hashtable:Hashtable与HashMap类似，可以说是HashMap的线程安全版。不过它是不允许记录的键或者值为null。因为它支持线程的同步，是线程安全的，所以也导致了Hashtale在效率较低。</li><li>ConcurrentHashMap: ConcurrentHashMap在Java 1.5作为Hashtable的替代选择新引入的。使用锁分段技术技术来保证线程安全的，可以看作是Hashtable的升级版。</li></ul><p>在工作中，我们使用得最多的Map应该是HashMap。不过有时在使用Map的时候，需要进行自然顺序排序。这里我们就可以使用TreeMap，而不必自己实现这个功能。TreeMap的使用和HashMap差不多。不过需要注意的是TreeMap是不允许key为null。 这里简单的介绍下TreeMap的使用。</p><pre><code>Map&lt;String,Object&gt; hashMap=new HashMap&lt;String,Object&gt;();    hashMap.put(&quot;a&quot;, 1);    hashMap.put(&quot;c&quot;, 3);    hashMap.put(&quot;b&quot;, 2);    System.out.println(&quot;HashMap:&quot;+hashMap);    Map&lt;String,Object&gt; treeMap=new TreeMap&lt;String,Object&gt;();    treeMap.put(&quot;a&quot;, 1);    treeMap.put(&quot;c&quot;, 3);    treeMap.put(&quot;b&quot;, 2);    System.out.println(&quot;TreeMap:&quot;+treeMap);结果：HashMap:{b=2, c=3, a=1}TreeMap:{a=1, b=2, c=3}</code></pre><p>上述中可以看出HashMap是无序的，TreeMap是有序的。 在使用Map的时候，也会对Map进行遍历。一般遍历Map的key和value有三种方式: 第一种通过Map.keySet遍历； 第二种通过Map.entrySet使用iterator遍历; 第三种是通过Map.entrySet进行遍历。 使用如下:</p><pre><code>Map&lt;String, String&gt; map = new HashMap&lt;String, String&gt;();for (String key : map.keySet()) {      System.out.println(&quot;key= &quot;+ key + &quot; and value= &quot; + map.get(key));     } Iterator&lt;Map.Entry&lt;String, String&gt;&gt; it = map.entrySet().iterator();   while (it.hasNext()) {      Map.Entry&lt;String, String&gt; entry = it.next();      System.out.println(&quot;key= &quot; + entry.getKey() + &quot; and value= &quot; + entry.getValue());     }     for (Map.Entry&lt;String, String&gt; entry : map.entrySet()) {      System.out.println(&quot;key= &quot; + entry.getKey() + &quot; and value= &quot; + entry.getValue());     }</code></pre><p>如果只想获取Map中value的话，可以使用foreach对Map.values()进行遍历：</p><pre><code>for (String v : map.values()) {     System.out.println(&quot;value= &quot; + v); }</code></pre><p>在上述遍历中，我们最多使用的是第一种Map.keySet，因为写起来比较简单。不过在容量大的时候，推荐使用第三种，效率会更高!</p><h4 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h4><blockquote><p>Set是一种不包含重复的元素的Collection，即任意的两个元素e1和e2都有e1.equals(e2)=false，Set最多有一个null元素。因为Set是一个抽象的接口，所以是不能直接实例化一个set对象。Set s = new Set() 这种写法是错误的。</p></blockquote><p>Set接口主要是由HashSet、TreeSet和LinkedHashSet来实现。 它们简单的使用如下:</p><pre><code>Set hashSet = new HashSet();Set treeSet = new TreeSet();Set linkedSet = new LinkedHashSet();</code></pre><p>因为Set是无法拥有重复元素的，所以也经常用它来去重。例如在一个list集合中有两条相同的数据，想去掉一条，这时便可以使用Set的机制来去重。 代码示例:</p><pre><code>public static void set(){       List&lt;String&gt; list = new ArrayList&lt;String&gt;();       list.add(&quot;Java&quot;);       list.add(&quot;C&quot;);       list.add(&quot;C++&quot;);       list.add(&quot;JavaScript&quot;);       list.add(&quot;Java&quot;);       Set&lt;String&gt; set = new HashSet&lt;String&gt;();       for (int i = 0; i &lt; list.size(); i++) {           String items = list.get(i);           System.out.println(&quot;items:&quot;+items);           if (!set.add(items)) {               System.out.println(&quot;重复的数据: &quot; + items);           }       }       System.out.println(&quot;list:&quot;+list);}结果：items:Javaitems:Citems:C++items:JavaScriptitems:Java重复的数据: Javalist:[Java, C, C++, JavaScript, Java]</code></pre><p><strong>注意:如果是将对象进行去重的话，是需要重写set中的equals和hashcode方法的。</strong></p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>关于集合中List、Map、Set这三个的总结如下:</p><ul><li>List：List和数组类似，可以动态增长，根据实际存储的数据的长度自动增长List的长度。查找元素效率高，插入删除效率低，因为会引起其他元素位置改变 &lt;实现类有ArrayList,LinkedList,Vector&gt;<ul><li>ArrayList：非线程安全，适合随机查找和遍历，不适合插入和删除。</li><li>LinkedList : 非线程安全，适合插入和删除，不适合查找。</li><li>Vector : 线程安全。不过不推荐。</li></ul></li><li>Map：一个key到value的映射的类 。<ul><li>HashMap：非线程安全，键和值都允许有null值存在。</li><li>TreeMap：非线程安全，按自然顺序或自定义顺序遍历键(key)。</li><li>LinkedHashMap：非线程安全，维护一个双链表，可以将里面的数据按写入的顺序读出。写入比HashMap强，新增和删除比HashMap差。</li><li>Hashtable：线程安全，键和值不允许有null值存在。不推荐使用。</li><li>ConcurrentHashMap：线程安全，Hashtable的升级版。推荐多线程使用。</li></ul></li><li>Set：不允许重复的数据 。检索效率低下，删除和插入效率高。<ul><li>HashSet： 非线程安全、无序、数据可为空。</li><li>TreeSet： 非线程安全、有序、数据不可为空。</li><li>LinkedHashSet：非线程安全、无序、数据可为空。写入比HashSet强，新增和删除比HashSet差。</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java基础回顾—封装、继承和多态</title>
      <link href="/java-basics-inheritance-and-polymorphism.html"/>
      <url>/java-basics-inheritance-and-polymorphism.html</url>
      
        <content type="html"><![CDATA[<h3 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h3><blockquote><p>在面向对象程式设计方法中，封装是指一种将抽象性函式接口的实现细节部份包装、隐藏起来的方法。 封装可以被认为是一个保护屏障，防止该类的代码和数据被外部类定义的代码随机访问。要访问该类的代码和数据，必须通过严格的接口控制。</p></blockquote><blockquote><p>封装最主要的功能在于我们能修改自己的实现代码，而不用修改那些调用我们代码的程序片段。适当的封装可以让程式码更容易理解与维护，也加强了程式码的安全性。</p></blockquote><p>简单的来说，就是将Java中的经常用到的代码进行封装起来，形成一个方法。比如，我们常用的实体类，使用<strong>private</strong>修饰变量，用于保护数据;对外提供getter和setter方法,用于调用。这就是一种典型的封装。</p><pre><code>public class packagingTest {    public static void main(String[] args) {        User user=new User();        //这里会报错，因为id和name是私有的，用于保护该数据//        user.id=10;//        user.name=&quot;张三&quot;;        user.setId(1);        user.setName(&quot;张三&quot;);        System.out.println(user.getId());        System.out.println(user.getName());    }}class User{    private int id;    private String name;    public int getId() {        return id;    }    public void setId(int id) {        this.id = id;    }    public String getName() {        return name;    }    public void setName(String name) {        this.name = name;    }}結果：1张三</code></pre><p>优点： - 良好的封装能够减少耦合。 - 类内部的结构可以自由修改。 - 可以对成员变量进行更精确的控制。 - 隐藏信息，实现细节。</p><h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><blockquote><p>继承是java面向对象编程技术的一块基石，因为它允许创建分等级层次的类。 继承就是子类继承父类的特征和行为，使得子类对象（实例）具有父类的实例域和方法，或子类从父类继承方法，使得子类具有父类相同的行为。</p></blockquote><p><strong>继承的特性</strong> - 子类拥有父类非private的属性，方法。 - 子类可以拥有自己的属性和方法，即子类可以对父类进行扩展。 - 子类可以用自己的方式实现父类的方法。 继承主要目的是为了复用代码！简单的来说，就是将重复的代码抽出来，放到父类中，然后在再由子类继承使用，子类也是可以对父类进行扩展的。所以在继承关系中，可以这么理解，父类更通用，子类更具体。 打个比方，在动物世界中，猫和狮子是属于猫科，狗和狼是属于犬科。而它们也都是动物。猫和狮子有个共同的父类猫科，猫和狗有个共同的父类动物。所以它们是符合继承关系的， 只不过它们在行为上有所区别。猫和狗都有吃和睡，不过猫可以爬树，狗不可以。</p><pre><code>public class extendTest {    public static void main(String[] args) {        Cat cat=new Cat();        Dog dog=new Dog();        cat.eat();        cat.sleep(&quot;cat&quot;);        cat.climbTree();        dog.eat(&quot;dog&quot;);        dog.sleep(&quot;dog&quot;);    }}class  Animal{    public void eat(String name){        System.out.println(name+&quot;正在吃东西...&quot;);    }    public void sleep(String name){        System.out.println(name+&quot;正在睡觉...&quot;);    }}class Cat extends Animal{    private String name=&quot;Cat&quot;;    public void eat(){        super.eat(name);        System.out.println(name+&quot;吃完了&quot;);    }    public void sleep(){        this.sleep(name);    }    public void sleep(String name){        System.out.println(name+&quot;刚刚睡觉!&quot;);    }    public void climbTree(){        System.out.println(name+&quot;正在爬树!&quot;);    }}class Dog extends Animal{}结果：Cat正在吃东西...Cat吃完了cat刚刚睡觉!Cat正在爬树!dog正在吃东西...dog正在睡觉...</code></pre><p>代码解析： 在上述代码中，父类Animal实现了eat和sleep的方法，子类Cat和Dog使用了extends 关键字继承了父类Animal。子类Dog继承父类Animal之后什么都没做，而子类Cat不但继承了父类Animal，而且还增加了climbTree 方法，并且也重写了父类的eat和sleep方法。 在子类Cat中，出现了两个关键字:super和this。 这两个关键字的意义如下:</p><ul><li>super关键字：实现对父类成员的访问，用来引用当前对象的父类。</li><li>this关键字：指向自己的引用。 在上述代码中，子类Cat使用super关键字调用了父类Animal的eat方法，使用this关键字调用本类中的sleep方法。</li></ul><p>说到继承，就不得不提这几个东西: final和protected修饰符、构造器、以及向上转型！ 其中final和protected修饰符在这里就简单的描述下：</p><ul><li>final:修饰的类不可以被继承。</li><li>protected:修饰的类仅对同一包内的类和所有子类可见。</li></ul><p><strong>构造器：</strong> 虽然子类可以继承父类的属性和方法(private修饰的除外)，但是还有一样是子类无法继承的，那就是是构造器！对于构造器而言，它只能够被调用，而不能被继承。如果子类想使用父类的构造器，那么只需使用super关键字调用即可。 注:如果父类的构造器被private所修饰，那么是无法被外部调用的，包括子类！ <strong>向上转型：</strong> 将子类转换成父类，在继承关系上面是向上移动的，所以一般称之为向上转型。 之前的个例子中，猫和动物是属于继承关系，那么我们可以把猫当作动物就是向上转型!</p><pre><code>public class extendTest {    public static void main(String[] args) {        Animal animal=new Cat();        animal.eat(&quot;cat&quot;);        animal.sleep(&quot;cat&quot;);    }}class  Animal{    public void eat(String name){        System.out.println(name+&quot;正在吃东西...&quot;);    }    public void sleep(String name){        System.out.println(name+&quot;正在睡觉...&quot;);    }}class Cat extends Animal{private String name=&quot;Cat&quot;;    public void eat(){        super.eat(name);        System.out.println(name+&quot;吃完了&quot;);    }    public void sleep(){        this.sleep(name);    }    public void sleep(String name){        System.out.println(name+&quot;刚刚睡觉!&quot;);    }    public void climbTree(){        System.out.println(name+&quot;正在爬树!&quot;);    }}结果：cat正在吃东西...cat刚刚睡觉!</code></pre><p>上述代码中完成了向上转型，但是在向上转型中是存在着一些缺憾的，那就是属性和方法的丢失。例如上述代码中就丢失了Cat类中的climbTree()方法和name属性。所以<strong>慎用向上转型!</strong> <strong>多重继承：</strong> Java的继承是单继承，但是可以实现多重继承！ 虽然一个子类只能继承一个父类，但是子类的子类也可以子类。 例如C类继承B类，B类继承A类，所以按照关系就是A类是B类的父类，B类是C类的父类。 <strong>继承的缺点：</strong> 虽然继承大大提升了代码的复用性，但是也提高了类之间的耦合性！父类更改，子类就必须更改！因此可以说继承破坏了封装，因为对于父类而言，它的实现细节对与子类来说都是透明的。 所以慎用继承！</p><h3 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h3><p>多态是指事物在运行过程中存在不同的状态。</p><blockquote><p>多态就是指程序中定义的引用变量所指向的具体类型和通过该引用变量发出的方法调用在编程时并不确定，而是在程序运行期间才确定。</p></blockquote><p><strong>使用多态的必要条件</strong> - 要有继承关系; - 子类要重写父类的方法; - 父类引用指向子类对象，也就是向上转型。 <strong>多态使用的简单示例</strong> 在上面的继承讲解中，我们用到了猫和动物这两个之间的关系，这里我们也可以使用这，只需要稍微改下代码，就可以实现多态。</p><pre><code>public class Test {    public static void main(String[] args) {        Animal animal=new Cat();        animal.eat();    }}class  Animal{    private String name=&quot;Animal&quot;;    public void eat(){        System.out.println(name+&quot;正在吃东西...&quot;);        sleep();    }    public void sleep(){        System.out.println(name+&quot;正在睡觉...&quot;);    }}class Cat extends Animal{    private String name=&quot;Cat&quot;;    public void eat(String name){        System.out.println(name+&quot;吃完了&quot;);        sleep();    }    public void sleep(){        System.out.println(name+&quot;正在睡觉&quot;);    }}结果：Animal正在吃东西...Cat正在睡觉</code></pre><p>看到了运行结果之后，如果不熟悉多态的话，是不是感觉有些奇怪呢？ 打印的第一句应该好理解，为什么打印的第二句不是Animal的方法，而是Cat中的方法呢？ 我们知道<strong>多态是指事物在运行过程中存在不同的状态。</strong>而这里，我们用到了继承、重写以及向上转型。 在这里顺便提一下:</p><blockquote><p>在向上转型中，一个父类的引用是可以指向多种子类对象，那么在运行时对于同一个消息是由实际的被引用的对象的类型来决定。</p></blockquote><p>根据上述这段理解，我们再来看刚刚的那个示例。 在Cat类中，重写了父类Animal的sleep方法，并重载了eat方法。重载之后的eat(String name)方法和父类Animal的eat()方法不是同一个方法，因为是会在向上转型丢失的。而Cat子类重写了sleep方法，因此在向上转型的时候是不会丢失的，并且因为指定对对象的引用类型是Cat，所以Animal在调用eat()方法的时候，先是调用本类中eat()方法，然后在调用子类中的sleep()方法！ <strong>结论:</strong></p><blockquote><p>当父类引用指向子类方法时，必须调用那些父类中存在的方法，如果子类中对该方法进行了重写，那么在运行时就会动态调用子类中的方法，这就是多态。</p></blockquote><p><strong>使用多态的优点</strong></p><ul><li>可替换性（substitutability）。多态对已存在代码具有可替换性。例如，多态对圆Circle类工作，对其他任何圆形几何体，如圆环，也同样工作。</li><li>可扩充性（extensibility）。多态对代码具有可扩充性。增加新的子类不影响已存在类的多态性、继承性，以及其他特性的运行和操作。实际上新加子类更容易获得多态功能。例如，在实现了圆锥、半圆锥以及半球体的多态基础上，很容易增添球体类的多态性。</li><li>接口性（interface-ability）。多态是超类通过方法签名，向子类提供了一个共同接口，由子类来完善或者覆盖它而实现的。</li><li>灵活性（flexibility）。它在应用中体现了灵活多样的操作，提高了使用效率。</li><li>简化性（simplicity）。多态简化对应用软件的代码编写和修改过程，尤其在处理大量对象的运算和操作时，这个特点尤为突出和重要。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java基础回顾—修饰符和String</title>
      <link href="/java-basic-modifiers-and-strings.html"/>
      <url>/java-basic-modifiers-and-strings.html</url>
      
        <content type="html"><![CDATA[<h3 id="修饰符"><a href="#修饰符" class="headerlink" title="修饰符"></a>修饰符</h3><p>Java修饰符主要分为俩类：</p><ul><li>访问修饰符：private、default、protected、public</li><li>非访问修饰符：static、final、abstract、synchronized</li></ul><h3 id="访问修饰符权限"><a href="#访问修饰符权限" class="headerlink" title="访问修饰符权限"></a>访问修饰符权限</h3><p>修饰符</p><p>当前类</p><p>同一包类</p><p>子类</p><p>其他包</p><p>public</p><p>Y</p><p>Y</p><p>Y</p><p>Y</p><p>protected</p><p>Y</p><p>Y</p><p>Y</p><p>N</p><p>default</p><p>Y</p><p>Y</p><p>N</p><p>N</p><p>private</p><p>Y</p><p>N</p><p>N</p><p>N</p><h4 id="private"><a href="#private" class="headerlink" title="private"></a>private</h4><p><strong>被private修饰的变量、方法仅限在本类中使用</strong> 所以private是最严的的访问级别，主要用于隐藏类的一些细节实现和保护类的数据。 例如pojo类就是使用private修饰变量，对外提供setter和getter的方法。 还有如果使用private用来修饰构造方法的话，该类是不能实例化的。这种在单例模式中可以经常看到！ 虽然private主要用于修饰变量和方法，不过也可以修饰内部类，只不过是内部类。</p><pre><code>public class Test{    //修饰一个私有变量    private int count=1;    //修饰一个私有方法    private int add(int i,int j){        return i+j;   }    private class Test1{                }}</code></pre><p><strong>private不能修饰外部类</strong>,因为Test类中的变量和方法是私有的，所以其他类无法调用！</p><pre><code>public class Test2 {    public static void main(String[] args) {        Test t=new Test();        //下面的变量和方法是无法获取的        //t.count=2;        //t.add(1,2);    }}</code></pre><h4 id="default"><a href="#default" class="headerlink" title="default"></a>default</h4><p>不使用任何修饰符。类、接口、变量、方法都可以使用。不过仅限在同一包下:</p><pre><code>class Test{     int count=1;     int add(int i,int j){            return i+j;     }    interface Test1{    }}</code></pre><h4 id="protected"><a href="#protected" class="headerlink" title="protected"></a>protected</h4><p>被protected修饰的变量、方法仅仅对同一包内的类和所有子类可见。</p><pre><code>public class Test{    protected int count=1;    protected int add(int i,int j){            return i+j;     }     protected class Test1{     }}</code></pre><p>在同包下可以直接调用，如果不在同包，则需要继承才可以使用:</p><pre><code>public class Test2 extends Test{    public static void main(String[] args) {        Test t=new Test();        t.count=2;        t.add(1,2);    }}</code></pre><p><strong>protected不能修饰外部类</strong></p><h4 id="public"><a href="#public" class="headerlink" title="public"></a>public</h4><p>public:修饰的类、接口、变量、方法对所有类都可以使用。</p><pre><code>public class Test{  public int count=1;  public int add(int i,int j){          return i+j;   }}</code></pre><h3 id="非访问修饰符"><a href="#非访问修饰符" class="headerlink" title="非访问修饰符"></a>非访问修饰符</h3><p>其下有<code>static</code>,<code>final</code>,<code>abstract</code>,<code>synchronized</code>,<code>transient</code>,<code>native</code></p><h4 id="static"><a href="#static" class="headerlink" title="static"></a>static</h4><p><strong>静态变量</strong>： static在修饰类变量的时候，无论该类被实例化了多少次，它的静态变量只有一份拷贝。静态变量也被称为类变量。局部变量是不能被声明为static变量的。 <strong>静态方法</strong>： static在修饰类方法的时候，静态方法是不能使用类的非静态变量。静态方法可以直接通过类名调用，因此静态方法中是不能用<strong>this</strong>和<strong>super</strong>关键字的。</p><pre><code>public class Test{   public  String name=&quot;xuwujing&quot;;   public  static String name2=&quot;xuwujing&quot;;   public  static String getName() {   //这个一句 会报错  因为静态方法是不能使用类的非静态变量   //String reult=name;   //这一句就可以   String reult=name2;   return reult;    }   //main方法是静态方法，可以直接调用本类中的静态方法和静态变量   public static void main(String[] args) {    System.out.println(name2);    System.out.println(getName());   }   //该方法是不静态方法，所以调用本类中的静态方法和静态变量时，   //需要使用classname.variablename和 classname.methodname的方式访问   private void print(){    System.out.println(Test.name2);    System.out.println(Test.getName());    }   }</code></pre><p><strong>static 静态块：</strong> 在JVM类加载机制中，<strong>如果类存在直接的父类并且这个类还没有被初始化，那么就先初始化父类；如果类中存在初始化语句，就依次执行这些初始化语句。</strong> 可能上述的两句话不太好理解，那么这里我们来运行下代码查看其结果，通过结果可能就能更好的理解上述语句的话了。</p><pre><code>class HelloA {    public HelloA() {        System.out.println(&quot;HelloA&quot;);    }    {        System.out.println(&quot;I&apos;m A class&quot;);    }    static {        System.out.println(&quot;static A&quot;);    }}public class HelloB extends HelloA {    public HelloB() {        System.out.println(&quot;HelloB&quot;);    }    {        System.out.println(&quot;I&apos;m B class&quot;);    }    static {        System.out.println(&quot;static B&quot;);    }    public static void main(String[] args) {        new HelloB();    }}结果：static Astatic BI&apos;m A classHelloAI&apos;m B classHelloB</code></pre><p><strong>创建对象时构造器的调用顺序是：</strong> 先初始化静态成员，然后调用父类构造器，再初始化非静态成员，最后调用自身构造器。 那么static修饰符这块的运用可以总结如下:</p><ol><li>静态变量在内存中只有一个拷贝，在类的所有实例中共享。</li><li>在静态方法中不能直接访问实例方法和实例变量，反之可以。</li><li>在静态方法中不能使用this和super关键字。</li><li>静态方法不能被abstract修饰。</li><li>静态方法和静态变量都可以通过类名直接访问。</li><li>当类被加载时，静态代码块只被加载一次。有多个静态变量或块时，按声明顺序加载。</li></ol><h3 id="final"><a href="#final" class="headerlink" title="final"></a>final</h3><p>final :用来修饰类、方法和变量。 final 修饰的类不能够被继承，修饰的方法不能被继承类重新定义，修饰的变量为常量，是不可修改的。 如果上述语句不好理解的话，我们可以通过编写相关代码进行实验。 定义一个final修饰的变量、方法以及类。然后进行相关的测试</p><pre><code>public class Test{       //定义一个final修饰的变量   public  static final String name=&quot;xuwujing&quot;; public static void main(String[] args) {         //这句会报错  因为该变量已经被final修饰了         name=&quot;张三&quot;;     }     //类加上final之后，该类是无法被继承的     final class Test2{     }     //这句会报错，因为Test2是被final修饰的类     class Test3 extends Test2{     }     class Test4{         //定义一个被final修饰的方法          final Date getTime(){             return new Date();         }     }     class Test5 extends Test4{         //这句会报错，因为final方法是不能被子类修改的。         Date getTime(){    return new Date();         }     } }</code></pre><p>故得知：</p><ul><li>final修饰类：表示该类不能被继承；</li><li>final修饰方法：表示方法不能被重写；</li><li>final修饰变量：表示变量只能一次赋值以后值不能被修改（常量）;</li></ul><h4 id="abstract"><a href="#abstract" class="headerlink" title="abstract"></a>abstract</h4><p>abstract ：用来创建抽象类和抽象方法。 修饰类：会使这个类成为一个抽象类，这个类将不能生成对象实例，但可以做为对象变量声明的类型（见后面实例），也就是编译时类型。抽象类就相当于一类的半成品，需要子类继承并覆盖其中的抽象方法。 修饰方法：会使这个方法变成抽象方法，也就是只有声明而没有实现，需要子类继承实现。</p><pre><code>public class AbstractTest{    public static void main(String[] args) {        //这句会报错，因为抽象类不能实例化        // Animal a=new Animal();        //抽象类可以实例化重写该类抽象方法的子类        Animal a = new Dog();        a.show();    }}abstract class Animal{    abstract void show();    public void print(){        System.out.println(&quot;Animal&quot;);    }}//继承抽象类需要实现抽象类的方法class Dog extends Animal{        @Override    void show() {        System.out.println(&quot;This is Dog!&quot;);    }}</code></pre><p>总结: - 抽象类和抽象方法都需要被abstract修饰。抽象方法一定要定义在抽象类中。 - 抽象类不可以创建实例，原因：调用抽象方法没有意义。 - 只有覆盖了抽象类中所有的抽象方法后，其子类才可以实例化。否则该子类还是一个抽象类。 注意： - 抽象类不能用来实例化对象，声明抽象类的唯一目的是为了将来对该类进行扩充。 - 一个类不能同时被 abstract 和 final 修饰。如果一个类包含抽象方法，那么该类一定要声明为抽象类，否则将出现编译错误。 - 抽象方法是一种没有任何实现的方法，该方法的的具体实现由子类提供。 4、抽象方法不能被声明成 final 和 static。 - 任何继承抽象类的子类必须实现父类的所有抽象方法，除非该子类也是抽象类。 - 如果一个类包含若干个抽象方法，那么该类必须声明为抽象类。抽象类可以不包含抽象方法。</p><h4 id="synchronized"><a href="#synchronized" class="headerlink" title="synchronized"></a>synchronized</h4><p>synchronized: 修饰的方法同一时间只能被一个线程访问。在多线程中运用很常见。 synchronized 的解释: synchronized 方法控制对类成员变量的访问：每个类实例对应一把锁，每个 synchronized方法都必须获得调用该方法的类实例的锁方能执行，否则所属线程阻塞，方法一旦执行，就独占该锁，直到从该方法返回时才将锁释放，此后被阻塞的线程方能获得该锁，重新进入可执行状态。这种机制确保了同一时刻对于每一个类实例，其所有声明synchronized 的成员函数中至多只有一个处于可执行状态（因为至多只有一个能够获得该类实例对应的锁），从而有效避免了类成员变量的访问冲突（只要所有可能访问类成员变量的方法均被声明为 synchronized）。 简单的来说，就是使用synchronized 修饰的方法，在多线程进行同时访问的时候，只会让一个线程先进行访问，其它的线程等候，当这个线程访问完了之后，再让下一个进行访问，依次类推。</p><h4 id="transient-和native"><a href="#transient-和native" class="headerlink" title="transient 和native"></a>transient 和native</h4><p>transient:被 transient 修饰的实例变量时，java 虚拟机(JVM)跳过该特定的变量。 native: 被native修饰的方法实际是由另一种语言进行实现的本地方法。例如Java中获取的Long类型的时间戳 ：System.currentTimeMillis(); 实际是由native 修饰的。</p><h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><p>String 类型可能就是我们最常用的的对象了。 首先说明，String并不是基本数据类型，而是一个对象，并且是不可变的对象。查看源码可以String类是被final修饰的，是不可被继承的！</p><blockquote><p>String的在未被初始化的时候为null，表示它还没有被创建，自然也就没有分配空间; 而” “和 new String()不是null，它们是已经被创建，只是值为空而已！并且也分配了内存空间。</p></blockquote><p>String有15种构造方法,有两种是过时的，其中包含<code>char[]</code>,<code>byte[]</code>,<code>int[]</code>,<code>String</code>,<code>StringBuffer</code>,<code>StringBuilder</code>。 我们在创建String对象的的时候，一般是使用 String str=”xxx”，但有时也会用new String()来初始话字符串。 例如:</p><pre><code>String hello=&quot;hello&quot;;String newHello=new String(&quot;hello&quot;);char []cHello ={&apos;h&apos;,&apos;e&apos;,&apos;l&apos;,&apos;l&apos;,&apos;o&apos;};String str=new String(cHello);</code></pre><p><strong>注意:String 类是不可改变的，所以你一旦创建了 String 对象，那它的值就无法改变了。</strong> String常用方法 大概讲述了String的用法之后，这里我们来列举一些String常用的方法: - length ：返回此字符串的长度。 - charAt：返回指定索引处的 char 值。 - compareTo:把这个字符串和另一个对象比较。 - concat：将指定字符串连接到此字符串的结尾。 - split:根据给定正则表达式的匹配拆分此字符串。 - equals:将此字符串与指定的对象比较。 - endsWith:测试此字符串是否以指定的后缀结束。 - startsWith:测试此字符串是否以指定的前缀结束。 - getBytes: 使用平台的默认字符集将此 String 编码为 byte 序列，并将结果存储到一个新的 byte 数组中。 - indexOf:返回指定字符在此字符串中第一次出现处的索引。 - replace：返回一个新的字符串，它是通过用 newChar 替换此字符串中出现的所有 oldChar 得到的。 12:substring：返回一个新的字符串，它是此字符串的一个子字符串。 - ….</p><h4 id="String对象比较"><a href="#String对象比较" class="headerlink" title="String对象比较"></a>String对象比较</h4><p>String作为我们最常用的对象，在面试中估计也会接触不少。一般来说，会考到String的常量池相关问题，主要是使用String进行比较的时候，==和equals这两种方法来判断是否相当。这里收集了一些String经常遇到的问题。</p><pre><code>String s1 = &quot;test&quot;;String s2 = new String(&quot;test&quot;);String s3 = &quot;te&quot;;String s4 = &quot;st&quot;;String s5 = &quot;te&quot; + &quot;st&quot;;String s6 = s3 + s4;String s7 = new String(s1);System.out.println(s1 == s2); System.out.println(s1 == s5); System.out.println(s1 == s6); System.out.println(s7==s1);       System.out.println(s7.equals(s1));結果：falsetruefalsefalsetrue</code></pre><p>解析： - 虽然看起来是一样的，但是新建一个String类的时候会重新分配引用地址，而 == 就是比较引用地址，所以为false。 - 在编译之前就可以确认s5=test， 并且引用地址一样，所以为true; - 字符串常量池的原则 这时 s6 的值是在运行时得到的，它会重新构造字符串对象 所以为false。 - 和第一个一样的，就是换汤不换药，所以为false。 - equals 只比较值相等，不关心它的引用地址。</p><pre><code>String ab=&quot;ab&quot;;String c=&quot;c&quot;;String ab_c=ab+c;String ab_c1=&quot;ab&quot;+&quot;c&quot;;String abc=&quot;abc&quot;;System.out.println(ab_c == abc + &quot; : &quot; + ab_c.equals(abc));System.out.println((ab_c == abc) + &quot; : &quot; + ab_c.equals(abc));System.out.println((ab_c1 == abc) + &quot; : &quot; + ab_c1.equals(abc));结果：falsefalse : truetrue : true</code></pre><p>解析： 到这里，可能就会诧异了，为什么和我想的不一样呢？ 这里其实是有陷阱的，也就是运算符的优先级。 第一个结果就是优先级的问题导致的，它会先计算 abc + “ : “ + ab_c.equals(abc) ，然后再来进行比较，所以为false。同理，下面的也是如此，基本和上面的那个例子差不多，这里就不再概述了。</p><h4 id="String、StringBuffer和StringBuilder"><a href="#String、StringBuffer和StringBuilder" class="headerlink" title="String、StringBuffer和StringBuilder"></a>String、StringBuffer和StringBuilder</h4><ul><li>String: String的特点是一旦赋值，便不能更改其指向的字符对象，如果更改，则会指向一个新的字符对象。</li><li>StringBuffer:StringBuffer对象可以调用其方法动态的进行增加、插入、修改和删 除操作，且不用像数组那样事先指定大小，从而实现多次插入字 符，一次整体取出的效果，因而操作字符串非常灵活方便。并且生成数据之后可以toString转为String，线程安全。</li><li>StringBuilder：它是在单线程环境下使用的，因为它的所有方面都没有被synchronized修饰，因此它的效率也比StringBuffer要高。</li></ul><p>关于字符串拼接方式，在String类中，我们最常用的是 + ,其次是使用StringBuffer或StringBuilder 的append方法，至于String类中的concat几乎很少用到。 一般来说，如果在少量的字符串进行拼接的话，我们会使用+，如果拼接过多的话，单线程使用 StringBuilder ，多线程使用StringBuffer 进行拼接。因为使用String 的 + 在过多的字符串进行拼接的时候会极大的使用内存，因为它在凭借的时候还是使用 append()方法，然后再进行toString转换，如果是少量的时候，是感觉不到差异的，但是在大量拼接的时候就会明显感受得到。</p><pre><code>String str=&quot;Hello World&quot;;String str1=&quot;&quot;;StringBuffer sbr=new StringBuffer(str); StringBuilder sbd=new StringBuilder(str); long start=System.currentTimeMillis();   for(int i=0;i&lt;10000;i++){       str1+=str;   }   System.out.println(&quot;String累加用时:&quot;+(System.currentTimeMillis()-start)+&quot;ms&quot;);   long start2=System.currentTimeMillis();   for(int i=0;i&lt;10000;i++){       sbr.append(str);   }   System.out.println(&quot;StringBuffer累加用时:&quot;+(System.currentTimeMillis()-start2)+&quot;ms&quot;);   long start3=System.currentTimeMillis();   for(int i=0;i&lt;10000;i++){       sbd.append(str);   }   System.out.println(&quot;StringBuilder累加用时:&quot;+(System.currentTimeMillis()-start3)+&quot;ms&quot;);结果：String累加用时:701msStringBuffer累加用时:2msStringBuilder累加用时:0ms</code></pre><p>这里从输出结果中可以看到String 的+拼接方法的耗时了。但是使用 + 实在是方便。所以在这里建议如果字符串拼接次数在10次以下，可以使用+，过多的则用StringBuffer或StringBuilder。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java基础回顾—基本数据类型</title>
      <link href="/java-basic-data-types.html"/>
      <url>/java-basic-data-types.html</url>
      
        <content type="html"><![CDATA[<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><p>基本数据类型主要这几个： <code>byte</code>,<code>short</code>,<code>int</code>,<code>long</code>,<code>float</code>,<code>double</code>,<code>char</code>,<code>boolean</code> 同样分成三大类：</p><ul><li>数值类型：<code>byte</code>,<code>short</code>,<code>int</code>,<code>long</code>,<code>float</code>,<code>double</code></li><li>字符类型：<code>char</code></li><li>布尔类型：<code>boolean</code></li></ul><h4 id="byte"><a href="#byte" class="headerlink" title="byte"></a>byte</h4><ol><li>byte是8位的数据类型，占用1个字节(8bit)，默认值是0，它的取值范围是(-2^7) ~ (2^7-1)，也就是 -128 ~ 127之间，所以最大存储数据量是255;</li><li>byte一般在大型数组中使用，来代替整数，因为byte变量占用的空间只有int的1/4。</li><li>byte使用示例: byte a = 10,byte=-10。在使用byte数据类型的时候需要注意取值范围！</li></ol><h4 id="short"><a href="#short" class="headerlink" title="short"></a>short</h4><ol><li>short是16位的数据类型，占用2个字节，默认值是0，它的取值范围是(-2^15) ~(2^15-1)，也就是 -32768 ~ 32767之间，所以最大数据存储量是65536;</li><li>short虽然是int型变量所占空间的1/2，但是在实际中却很少用到。在大型数组中也可以节省空间。</li><li>short使用示例:short a=100,short b=-200;</li></ol><h4 id="int"><a href="#int" class="headerlink" title="int"></a>int</h4><ol><li>int是32位的数据类型，占用4个字节，默认值是0，它的取值范围是(-2^31) ~(2^31-1)，也就是 -2147483648 ~ 2147483647之间，所以最大数据存储量是2^32-1;</li><li>int是数据类型是整型，是我们在项目中用到最多的数据类型之一;</li><li>int 使用示例:int a=1000,int b=-2000;</li></ol><h4 id="long"><a href="#long" class="headerlink" title="long"></a>long</h4><ol><li>long是64位的数据类型，占用8个字节，默认值是0L，它的取值范围是(-2^63) ~(2^63-1)，也就是 -9223372036854775808 ~ 9223372036854775808之间，所以最大数据存储量是2^64;</li><li>long是数据类型是长整型，是我们在项目中用到最多的数据类型之一。在使用long类型的数据时最好在数值末尾带上大写的L！</li><li>long 使用示例:long a=1000L,long b=-2000L;</li></ol><h4 id="float"><a href="#float" class="headerlink" title="float"></a>float</h4><ol><li>float是32位的数据类型，占用4个字节，默认值是0，它的取值范围是3.4e-45 ~ 1.4e38 之间;</li><li>float是数据类型是单精度，在直接赋值时必须在数字后加上f或F;</li><li>float使用示例:float a=10.25f, float b=-20.35F;</li></ol><h4 id="double"><a href="#double" class="headerlink" title="double"></a>double</h4><ol><li>double是64位的数据类型，占用8个字节，默认值是0，它的取值范围是4.9e-324 ~ 1.8e308 之间;</li><li>double是数据类型是双精度，在直接赋值的时候最好加上D或d;</li><li>double使用示例:double a=10.123d, double b= -10.25644D;</li></ol><h4 id="boolean"><a href="#boolean" class="headerlink" title="boolean"></a>boolean</h4><ol><li>boolean是布尔类型，占用1个字节，只有两个值,false和true，默认值是 false;</li><li>boolean只能用一种标志来记录 true或false，一般和 if 结合使用;</li><li>boolean使用示例: boolean a=true，boolean b=false;</li></ol><h4 id="char"><a href="#char" class="headerlink" title="char"></a>char</h4><ol><li>char是字符类型，占用2个字节，默认值为空，取值范围 为 0~65535，也就是 \u0000 ~ \uffff;</li><li>char数据类型可以储存任何字符;</li><li>char 使用示例: char a=1，char b=’A’;</li></ol><h3 id="数据转换"><a href="#数据转换" class="headerlink" title="数据转换"></a>数据转换</h3><p>数值类型的级别从低到高分别为：byte,char,short(这三个平级)——&gt;int——&gt;float——&gt;long——&gt;double</p><h4 id="自动转换"><a href="#自动转换" class="headerlink" title="自动转换"></a>自动转换</h4><p>其中由低级别转到高级别，是属于自动类型转换，这点是由系统自动转换的。 例如将int类型的数据转为float类型的数据：</p><pre><code>实例：int i=10;float j=i;System.out.println(&quot;i:&quot;+i+&quot;,j:&quot;+j);结果：i:10,j:10.0</code></pre><h4 id="强制转换"><a href="#强制转换" class="headerlink" title="强制转换"></a>强制转换</h4><p>如果由高级别转为低级别，则需要强制转换，也就是强制类型转换。 例如将int类型的数据转换为byte类型的数据：</p><pre><code>实例：int i=127;int j=128;byte bye=(byte)i;byte bye2=(byte)j;System.out.println(&quot;i:&quot;+i+&quot;,bye:&quot;+bye);System.out.println(&quot;j:&quot;+j+&quot;,bye2:&quot;+bye2);结果：i:127,bye:127j:128,bye2:-128</code></pre><blockquote><p>说明:因为 byte 类型是 8 位，最大值为127，所以当 int 强制转换为 byte 类型时，值 128 时候就会导致溢出。所以在进行强制类型转换的时候，要注意取值范围！</p></blockquote><p>在<strong>强制转换</strong>的时候需要注意数据的精确度，否则可能会出现数据精确丢失。 例如 double类型的数据转换为float类型数据。</p><pre><code>实例：double d=10.1111115;float f=(float) d;System.out.println(&quot;f:&quot;+f+&quot;,d:&quot;+d);结果：f:10.111112,d:10.1111115</code></pre><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>如果在不同的数据类型进行计算，例如：</p><ol><li>byte 类型的数据 加 short 类型的数据 = 结果为：int类型;</li><li>short 类型的数据 加 int 类型的数据 = 结果为：int类型;</li><li>int 类型的数据 加 long 类型的数据 = 结果为：long类型;</li></ol><p>这里的不同的数值类型数据进行相加的时候，会自动转换为级别最高的那一个。 那么short 类型的数据加 byte 类型的数据为什么是int类型呢？ 因为在java的世界里，如果比int类型小的类型做运算，java在编译的时候就会将它们统一强转成int类型。</p><blockquote><p>那么这里可以得出结论，在数值类型中，若级别小于int，进行计算的时候，最终的数据类型会自动转换为int，如果高于int，最终数据结果会取其中最高的一个！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MoOx Pjax使用笔记</title>
      <link href="/moox-pjax-use-notes.html"/>
      <url>/moox-pjax-use-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>前段时间在主题添加jQuery.Pjax库，遇到问题太大不得不放弃，可能局限性太大。而且容器不能支持多种方。早上在Github搜索看到<a href="https://github.com/MoOx/pjax" target="_blank" rel="noopener">MoOx/pjax</a>看起来效果不错，集成主题果然很赞。</p><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><blockquote><p>Easily enable fast Ajax navigation on any website (using pushState + xhr)</p></blockquote><p>Pjax是一个独立的JavaScript模块，它使用AJAX<code>（XmlHttpRequest）</code>和<code>pushState()</code>来提供快速浏览体验。 它可以彻底改变标准网站（服务器端生成或静态网站）的用户体验，特別是宽带链接低俗的用户。 Pjax does not rely on other libraries, like jQuery or similar. It is written entirely in vanilla JS. 该库不依赖任何库文件，纯粹是原生JavaScript编写。 Github：<a href="https://github.com/MoOx/pjax" target="_blank" rel="noopener">https://github.com/MoOx/pjax</a> 那么作者对此评价：</p><ul><li>不仅限于一个容器</li><li>完全支持浏览器历史（后退和前进）</li><li>支持键盘浏览</li><li>自动退回到外部页面的标准导航</li><li>自动回退到没有适当DOM树的内部页面的标准导航</li><li>轻松地添加非常酷的CSS转换（动画）</li><li>大约4kb（缩小和缩小）</li></ul><p>更多的内容可以去文档查看。</p><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p>文档有个简单的例子，假如你的页面DOM结构如下：</p><pre><code>&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;  &lt;!-- metas, title, styles, ... --&gt;&lt;/head&gt;&lt;body&gt;  &lt;header class=&quot;my-Header&quot;&gt;&lt;nav&gt;&lt;!-- a .is-active is in there --&gt;&lt;/nav&gt;&lt;/header&gt;  &lt;section class=&quot;my-Content&quot;&gt;    Sha blah &lt;a href=&quot;/blah &quot;&gt;blah&lt;/a&gt;.  &lt;/section&gt;  &lt;aside class=&quot;my-Sidebar&quot;&gt;Sidebar stuff&lt;/aside&gt;  &lt;footer class=&quot;my-Footer&quot;&gt;&lt;/footer&gt;  &lt;script src=&quot;onDomReadystuff.js&quot;&gt;&lt;/script&gt;  &lt;script&gt;&lt;!-- analytics --&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>那么你需要引入该<code>js</code>文件：</p><pre><code>&lt;script src=&quot;https://cdn.jsdelivr.net/npm/pjax@VERSION/pjax.min.js&quot;&gt;&lt;/script&gt;</code></pre><p>并且声明初始化：</p><pre><code>var pjax = new Pjax({ selectors: [&quot;title&quot;, &quot;.my-Header&quot;, &quot;.my-Content&quot;, &quot;.my-Sidebar&quot;] })</code></pre><p><code>selectors</code>选择网站DOM需要加载的地方。里面有个<code>title</code>是网页的标题变换。 就这样完成基本需求了。 所以对<code>jquery.pjax</code>区别在于：</p><ul><li>没有jQuery依赖</li><li>不限于一个容器</li><li>没有服务器端要求</li><li>适用于CommonJS环境（Webpack / Browserify），AMD（RequireJS）甚至全局</li><li>允许使用CSS动画进行页面转换</li><li>可维护性</li></ul><p>Pjax仅适用于支持<code>history.pushState()</code>API的浏览器。 当API不支持时，就算引入该库也不会发生什么。 要查看浏览器是否确实支持Pjax，请使用<code>Pjax.isSupported()</code>。</p><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>根据上面实例最基本的声明是： <strong>new Pjax()</strong> 当你实例化<code>Pjax</code>时候，可以将选项作为对象传递给构造函数：</p><pre><code>var pjax = new Pjax({  elements: &quot;a&quot;, // 默认&quot;a[href], form[action]&quot;  selectors: [&quot;title&quot;, &quot;.my-Header&quot;, &quot;.my-Content&quot;, &quot;.my-Sidebar&quot;]})</code></pre><p>在网页的<code>&quot;.my-Header&quot;, &quot;.my-Content&quot;, &quot;.my-Sidebar&quot;</code>选择器中所有<code>a</code>标签超链接启用pjax加载。 但如果你想在特定的<code>a</code>标签超链接进行pjax加载的话，有俩个方法：</p><ul><li>使用自定义选择器，如<code>a.js-Pjax</code> 或者 <code>.js-Pjax a</code> 例如： <code>javascript var pjax = new Pjax({ elements: &quot;a.js-Pjax&quot; })</code></li><li>重写<code>Pjax.prototype.getElements</code>里面<code>querySelectorAll</code>的<code>elements</code>选项，该函数返回一个<code>NodeList</code>对象 <code>javascript Pjax.prototype.getElements = function() { return document.getElementsByClassName(&quot;.js-Pjax&quot;) } var pjax = new Pjax()</code></li></ul><hr><p><strong>loadUrl(href, [options])</strong> 使用这种方法，手动触发加载URL：</p><pre><code>var pjax = new Pjax()pjax.loadUrl(&quot;/your-url&quot;)pjax.loadUrl(&quot;/your-other-url&quot;, {timeout: 10})</code></pre><hr><p><strong>handleResponse(responseText, request, href)</strong> 此方法采用JavaScript原生响应，处理URL然后调用<code>pjax.loadContent()</code>将其加载到DOM中：</p><pre><code>var pjax = new Pjax();pjax._handleResponse = pjax.handleResponse;pjax.handleResponse = function(responseText, request, href) {  if (request.responseText.match(&quot;&lt;html&quot;)) {    pjax._handleResponse(responseText, request, href);  } else {    // 处理响应  }}</code></pre><ul><li>responseText (string): 原始的响应内容，相当于<code>request.responseText</code></li><li>request (XMLHttpRequest): XHR对象</li><li>href (string): URL传递给<code>loadUrl()</code></li></ul><hr><p><strong>refresh([el])</strong> 使用此方法将Pjax绑定到初始化Pjax时不存在的DOM元素的子元素。 例如：由另一个库或脚本动态插入的内容。如果不带参数调用，Pjax将再次解析整个文档以查找新插入的元素。</p><pre><code>//插入新DOM内容后运行callback或Promisevar newContent = document.querySelector(&quot;.new-content&quot;);pjax.refresh(newContent);</code></pre><hr><p><strong>reload()</strong> 强制页面重载，和<code>window.location.reload()</code>无异。</p><hr><h4 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h4><p><strong>elements (String, default: “a[href], form[action]“)</strong> <strong>selectors (Array, default: [“title”, “.js-Pjax”])</strong> <strong>switches (Object, default: {})</strong> Objects containing callbacks that can be used to switch old elements with new elements. Keys should be one of the defined selectors. Examples:</p><pre><code>var pjax = new Pjax({  selectors: [&quot;title&quot;, &quot;.Navbar&quot;, &quot;.js-Pjax&quot;],  switches: {    // &quot;title&quot;: Pjax.switches.outerHTML // default behavior    &quot;.Navbar&quot;: function(oldEl, newEl, options) {      // here it&apos;s a stupid example since it&apos;s the default behavior too      oldEl.outerHTML = newEl.outerHTML      this.onSwitch()    },    &quot;.js-Pjax&quot;: Pjax.switches.sideBySide  }})</code></pre><p>Callbacks are bound to Pjax instance itself to allow you to reuse it (ex: <code>this.onSwitch()</code>) 更多信息阅读：<a href="https://github.com/MoOx/pjax#switches-object-default-" target="_blank" rel="noopener">文档</a> <strong>history (Boolean, default: true)</strong> 启用使用<code>pushState()</code>。禁用此功能将阻止Pjax更新浏览器历史记录。 <strong>analytics (Function | Boolean, default: a function that pushes _gaq _trackPageview or sends ga pageview</strong> 谷歌统计重载 <strong>cacheBust (Boolean, default: true)</strong> 设置为true时，将时间戳查询字符串段附加到请求的URL来禁止浏览器缓存。 <strong>debug (Boolean, default: false)</strong> 调试模式。 <strong>timeout (Integer, default: 0)</strong> XHR请求的超时时间（以毫秒为单位），设置为0禁用。</p><h4 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h4><ul><li><code>pjax:send</code>: 在Pjax请求开始后触发</li><li><code>pjax:complete</code>: 在Pjax请求完成后触发</li><li><code>pjax:success</code>: 在Pjax请求成功后触发</li><li><code>pjax:error</code>: Pjax请求失败后触发。请求对象将作为一起传递给<code>event.options.request</code></li></ul><p>常见就像页面过渡动画的效果：</p><pre><code>document.addEventListener(&apos;pjax:send&apos;, topbar.show)document.addEventListener(&apos;pjax:complete&apos;, topbar.hide)</code></pre><h3 id="在WordPress主题使用"><a href="#在WordPress主题使用" class="headerlink" title="在WordPress主题使用"></a>在WordPress主题使用</h3><p>其实在<code>WordPress主题</code>中使用并不是太难，主要把设置选项摸索清楚就行了，下面是我的主题配置选项，打开F12查看对应的DOM相信也会明白：</p><pre><code>//参数配置            var pjax = new Pjax({                elements: &apos;a[href]:not([href^=&quot;#&quot;])&apos;, // default is &quot;a[href], form[action]&quot;                cacheBust: false,                debug: false,                selectors: [                    &apos;title&apos;,                    &apos;#header&apos;,                    &apos;#material-main&apos;                ]            });            //在Pjax请求开始后触发            document.addEventListener(&apos;pjax:send&apos;, function () {                $(&apos;body&apos;).append(&apos;&lt;div id=&quot;material-loading-cover&quot; class=&quot;material-loading-dom animated slideInDown&quot;&gt;&lt;svg id=&quot;material-loading&quot; class=&quot;spinner&quot; viewBox=&quot;0 0 66 66&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;circle class=&quot;path&quot; fill=&quot;none&quot; stroke-width=&quot;6&quot; stroke-linecap=&quot;round&quot; cx=&quot;33&quot; cy=&quot;33&quot; r=&quot;30&quot;&gt;&lt;/circle&gt;&lt;/svg&gt;&lt;/div&gt;&apos;);            });            //在Pjax请求完成后触发            document.addEventListener(&apos;pjax:complete&apos;, function () {                $(&apos;body&apos;).attr(&apos;class&apos;,$(&apos;#material-main&apos;).data(&apos;class&apos;));                //重载函数                ...                if (typeof _hmt !== &apos;undefined&apos;) {                    // support 百度统计                    _hmt.push([&apos;_trackPageview&apos;, location.pathname + location.search]);                }                if (typeof ga !== &apos;undefined&apos;) {                    // support google analytics                    ga(&apos;send&apos;, &apos;pageview&apos;, location.pathname + location.search);                }                if (typeof Prism !== &apos;undefined&apos;) {                    //Prism.highlightAll(true,null);                    self.Prism.highlightAll(event);                }                $(&apos;#material-loading-cover&apos;).remove();            });            //在Pjax请求成功后触发            document.addEventListener(&apos;pjax:success&apos;, function() {            });            //Pjax请求失败后触发，请求对象将作为一起传递event.options.request            document.addEventListener(&apos;pjax:error&apos;, function() {                bar(&apos;系统出现问题，请手动刷新一次&apos;,&apos;3000&apos;);            });            //搜索事件处理            $(document).on(&apos;submit&apos;, &apos;.form-group&apos;, function (e) {                e.preventDefault(); // 去除搜索框默认事件                var site = document.location.origin,                    val = $(&apos;.top-nav-search&apos;).val(),                    search = site + &apos;/?s=&apos; + val;                pjax.loadUrl(search);            });``</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WordPress新建Ajax表单</title>
      <link href="/wordpress-new-ajax-form.html"/>
      <url>/wordpress-new-ajax-form.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>之前在一些人网站看到前端显示表单，所以有些好奇就大概的研究下。也就折腾这样不三不四的东西。 大致的效果就在本博客右侧登陆按钮吧，可以体验下~</p><h3 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h3><p>为了更好的去理解过程，所以只在<code>Twenty Sixteen</code>主题测试。首先打开<code>header.php</code>任意地方添加：</p><pre><code>&lt;div class=&quot;top_bar&quot;&gt;                    &lt;div class=&quot;container&quot;&gt;                        &lt;div class=&quot;ajax_login&quot;&gt;                            &lt;form id=&quot;login&quot; action=&quot;login&quot; method=&quot;post&quot;&gt;                                &lt;h1&gt;&lt;?php esc_attr_e(&apos;登录&apos;) ?&gt;&lt;/h1&gt;                                &lt;p class=&quot;status&quot;&gt;&lt;/p&gt;                                &lt;input id=&quot;username&quot; type=&quot;text&quot; name=&quot;username&quot; placeholder=&quot;&lt;?php esc_attr_e(&apos;登录账号&apos;) ?&gt;&quot;&gt;                                &lt;input id=&quot;password&quot; type=&quot;password&quot; name=&quot;password&quot; placeholder=&quot;&lt;?php esc_attr_e(&apos;登录密码&apos;) ?&gt;&quot;&gt;                                &lt;div class=&quot;forgotten_box&quot;&gt;                                    &lt;a class=&quot;lost&quot; href=&quot;&lt;?php echo esc_url(wp_lostpassword_url()); ?&gt;&quot;&gt;&lt;?php esc_attr_e(&apos;忘记密码？&apos;) ?&gt;&lt;/a&gt;                                &lt;/div&gt;                                &lt;input class=&quot;submit_button&quot; type=&quot;submit&quot; value=&quot;登录&quot; name=&quot;submit&quot;&gt;                                &lt;?php wp_nonce_field( &apos;ajax-login-nonce&apos;, &apos;security&apos; ); ?&gt;                            &lt;/form&gt;                            &lt;div class=&quot;ajax_login_overlay&quot;&gt;&lt;/div&gt;                            &lt;?php if (is_user_logged_in()):?&gt;                                &lt;a class=&quot;login_button&quot; href=&quot;&lt;?php echo wp_logout_url( home_url() ); ?&gt;&quot;&gt;&lt;?php esc_attr_e(&apos;登出&apos;) ?&gt;&lt;/a&gt;                            &lt;?php else: ?&gt;                                &lt;a class=&quot;login_button&quot; id=&quot;show_login&quot; href=&quot;#&quot;&gt;&lt;?php esc_attr_e(&apos;登录&apos;) ?&gt;&lt;/a&gt;                            &lt;?php endif; ?&gt;                        &lt;/div&gt;                    &lt;/div&gt;                &lt;/div&gt;</code></pre><p>添加样式：</p><pre><code>/*------------------------ AJAX login -------------------------*/.top_bar{    text-align: right;    font-family: Montserrat, &quot;Helvetica Neue&quot;, sans-serif;}.top_bar .ajax_login{    display: inline-block;    margin-right: 10px;}.top_bar .ajax_login_overlay{    position: fixed;    top: 0;    left: 0;    width: 100%;    height: 100%;    background: rgb(0,0,0);    background: rgba(0,0,0,0.5);    display: none;    cursor: default;    z-index: 101;    transform: translateZ(1px);}#login{    display: none;    background-color: #FFFFFF;    position: fixed;    top: 50%;    margin-top: -117px;    z-index: 999;    left: 50%;    margin-left: -200px;    cursor: default;    padding: 0 0 20px 0;}#login h1{    color: #fff;    background: #1a1a1a;    font-weight: 700;    text-transform: uppercase;    font-size: 15px;    padding: 8px 20px;    text-align: left;    margin-bottom: 25px;}#login p.status{    display: none;    padding: 0 20px;    margin-bottom: 12px;}#login input#username,#login input#password{    margin: 10px 20px;    width: 400px;    display: block;    background: #f7f7f7;    background-image: -webkit-linear-gradient(rgba(255, 255, 255, 0), rgba(255, 255, 255, 0));    border: 1px solid #d1d1d1;    font-family: Montserrat, &quot;Helvetica Neue&quot;, sans-serif;}#login .forgotten_box{    display: inline-block;    padding: 3px 20px 0 20px;}#login .forgotten_box .lost{    display: block;    padding: 5px;    padding-left: 0;    margin-bottom: 0;    -webkit-transition: all 180ms ease-in;    -moz-transition: all 180ms ease-in;    -o-transition: all 180ms ease-in;    transition: all 180ms ease-in;}#login input.submit_button{    padding: 15px;    margin-right: 20px;    float: right;    cursor: pointer;    -webkit-transition: all 180ms ease-in;    -moz-transition: all 180ms ease-in;    -o-transition: all 180ms ease-in;    transition: all 180ms ease-in;}.top_bar .ajax_login .login_overlay{    height: 100%;    width: 100%;    background-color: #F6F6F6;    opacity: 0.9;    position: fixed;    z-index: 998;}.top_bar .ajax_login .login_button{    display: inline-block;    color:  #0c0f0b;    font-size: 12px;    font-weight: 700;    line-height: 30px;    -webkit-transition: all 180ms ease-in;    -moz-transition: all 180ms ease-in;    -o-transition: all 180ms ease-in;    transition: all 180ms ease-in;}.top_bar .ajax_login .login_button:hover{    color: #d84949;}</code></pre><p>添加登录逻辑代码，在你的<code>function.php</code>添加以下代码：</p><pre><code>/********* AJAX登录 ***********/function ajax_login_init(){    wp_enqueue_script(&apos;ajax-login-script&apos;, get_template_directory_uri() . &apos;/js/ajax-login-script.js&apos;, array(&apos;jquery&apos;),&apos;&apos;,true );    wp_localize_script( &apos;ajax-login-script&apos;, &apos;ajax_login_object&apos;, array(        &apos;ajaxurl&apos; =&gt; admin_url( &apos;admin-ajax.php&apos; ),        &apos;redirecturl&apos; =&gt; home_url(),        &apos;loadingmessage&apos; =&gt; esc_html__(&apos;正在登录中...&apos;)    ));    //用户无权在AJAX中运行ajax_login（）    add_action( &apos;wp_ajax_nopriv_ajaxlogin&apos;, &apos;ajax_login&apos; );}//仅在用户未登录时才执行操作if (!is_user_logged_in()) {    add_action(&apos;init&apos;, &apos;ajax_login_init&apos;);}if (!function_exists(&apos;ajax_login&apos;)) {    function ajax_login(){        //首先检查nonce，如果失败，函数将会中断        check_ajax_referer( &apos;ajax-login-nonce&apos;, &apos;security&apos; );        //检查Nonce，获取POST数据并签署用户        $info = array();        $info[&apos;user_login&apos;] = $_POST[&apos;username&apos;];        $info[&apos;user_password&apos;] = $_POST[&apos;password&apos;];        $info[&apos;remember&apos;] = true;        $user_signon = wp_signon( $info, false );        if ( is_wp_error($user_signon) ){            echo json_encode(array(&apos;loggedin&apos;=&gt;false, &apos;message&apos;=&gt; esc_html__(&apos;用户账号或者密码错误&apos;)));        } else {            echo json_encode(array(&apos;loggedin&apos;=&gt;true, &apos;message&apos;=&gt; esc_html__(&apos;登录成功，跳转中...&apos;)));        }        wp_die();    }}</code></pre><p>根据上面的代码，在主题的目录下新建<code>/js/ajax-login-script.js</code>文件：</p><pre><code>jQuery(document).ready(function($) {    &quot;use strict&quot;;    //单击时显示登录对话框    $(&apos;a#show_login&apos;).on(&apos;click&apos;, function(e){        $(&apos;.ajax_login_overlay&apos;).fadeIn(500);        $(&apos;form#login&apos;).fadeIn(500);        e.preventDefault();    });    $(&apos;.ajax_login_overlay&apos;).on(&apos;click&apos;, function(e){        $(&apos;form#login&apos;).fadeOut(500);        $(&apos;.ajax_login_overlay&apos;).fadeOut(500);        $(&apos;form#register_form&apos;).hide();        $(&apos;.ajax_login .status&apos;).html(&apos;&apos;);        $(&apos;#registration-error-message&apos;).html(&apos;&apos;);        $(&apos;form#login&apos;).hide();        $(&apos;form#register_form .field input&apos;).val(&apos;&apos;);    });    //在表单提交中执行AJAX登录    $(&apos;form#login&apos;).on(&apos;submit&apos;, function(e){        $(&apos;form#login p.status&apos;).show().text(ajax_login_object.loadingmessage);        $.ajax({            type: &apos;POST&apos;,            dataType: &apos;json&apos;,            url: ajax_login_object.ajaxurl,            data: {                &apos;action&apos;: &apos;ajaxlogin&apos;, //调用wp_ajax_nopriv_ajax登录                &apos;username&apos;: $(&apos;form#login #username&apos;).val(),                &apos;password&apos;: $(&apos;form#login #password&apos;).val(),                &apos;security&apos;: $(&apos;form#login #security&apos;).val() },            success: function(data){                $(&apos;form#login p.status&apos;).text(data.message);                if (data.loggedin === true){                    document.location.href = ajax_login_object.redirecturl;                }            }        });        e.preventDefault();    });});</code></pre><p>以上步骤满足基本需求了。 <img src="https://i.loli.net/2018/06/01/5b1145e5d8168.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WordPress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>后来的我们</title>
      <link href="/later-we.html"/>
      <url>/later-we.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>后来的我们，现在怎么样了？</p></blockquote><p>下午和女朋友出去逛街直到晚上回来，就想要写这一篇文章。至于《后来》这首歌使我想起来一部电影《后来的我们》，虽然没看过，但里面的情节也能猜到七七八八分吧。可能说这首歌不合适现在状况，相信未来的几年后感觉就不一样了。</p><h3 id="你教会让我如何面对现实"><a href="#你教会让我如何面对现实" class="headerlink" title="你教会让我如何面对现实"></a>你教会让我如何面对现实</h3><blockquote><p>难以想象的是，现在的我们为彼此改变的很多。</p></blockquote><p>我是理想主义者，在家庭环境中是独生子的存在，再加上职业坏境导致于我这几年一直抱着理想，抱着对未来的期望以及规划，虽然在社会上磨练很多，却没有遇到能让我产生危机感，就成了所谓的理想主义。而你是现实主义者，俩人的碰撞就如水火一番，往往最后的结果很悲惨。 但你说得没有错，这个社会很现实，同样你也会变得现实，再加上你的家庭环境，使你更加现实，一眼看穿我所谓的所谓理想，带来更严重的后果。无论我再怎么反驳，心里也慢慢接受你说的建议。为此我迷失了自己好几天，最后想清楚：两者皆可理智，理想主义者偏向远方，对世事怀揣美好想象，现实者更为看事更为透彻刻骨，分析好坏得失，权衡利弊优劣，在爱情面前也一样，但只要不为过，一切都没有问题，过了头便成了偏执，理想或现实者，都不是一个不变的状态，迟早会遇见彼此，变成彼此，那时，理智，在爱情面前将不堪一击。 但很高兴的是，我依然没有被你的现实打败，因为我永远不会成为现实的人，或许成为现实的我，对我们的未来来说，会有更大的危机，就像我们的父母一样，一辈子碌碌无为，至少我在这俩者之间找到平衡点。 所以在最关键的时刻里，我想明白了，人是要变通的，不能一昧固执下去，否则失去的更多。还好及时留住你，同样你也留住我，所以感谢你让我如何去面对现实。 对此，未来的生活我不得不警惕，作为一个男人，不能再抱着所谓的白日梦，适当的放弃，会有更好的结果，无论怎么样，恳请相信我，我会努力提高我们未来的生活水平、物质水平以及精神水平。</p><h3 id="你教会让我如何去爱人"><a href="#你教会让我如何去爱人" class="headerlink" title="你教会让我如何去爱人"></a>你教会让我如何去爱人</h3><blockquote><p>说实话，摆在一年前，我不会想到我学会爱一个人。很简单，我是一个很自私的人，只爱自己。</p></blockquote><p>之前谈的几年的恋爱，分手原因还是在于我，很简单，是我太自私。很大的程度上是我没有站在她的角度去思考，所以每一次的争吵导致于一颗心慢慢死去。 很显然我为什么现在才得知呢，因为我的天性就是自私，明知道最后的结果，还是如此自私，但你有一个优点：敢说敢做。指责得让我无地自容，最后放弃了争吵，深夜不断的去思考自己问题，想明白了发现自己问题很大，如果再不去改掉自己的自私，恐怕真的要失去你了。分分合合中我终于改掉自己的自私。 有时候你会问我：“你爱我吗？” 如果这个问题当面问我的话，我可能答不出来，因为感情的事情不是天天挂在嘴上的事，所以我现在给你一个答案。</p><blockquote><p>爱，或许时而激情时而平淡，因为这俩者你永远不会厌倦。</p></blockquote><p>当你爱一个人的时候，往往会把自己想得很差，导致于爱情出现了自卑。是的，有时候我对你有点自卑，因为某些方面你比我好多了，觉得我不配你，所以之前一次分手，对我来说既是轻松也是难过的，因为你可以选择更好的对象，无论是方面的条件，我只是希望你能过得好，甚至于想过，这辈子单身就得了吧。难过是因为不想放弃你，失去了我一整天心里慌慌的，什么东西都没有，很想找什么东西填满我的心，当天晚上失眠了，饭也吃不下去，或许这个感觉就是爱你吧？ 或许爱你太平淡，是因为怕你太激情会让你着累。 <strong>我是那个可以承受一生平凡和普通，换来一直专一爱你的人。</strong></p><h3 id="后来的我们"><a href="#后来的我们" class="headerlink" title="后来的我们"></a>后来的我们</h3><p>和你相处时间不长，但在我的记忆中，似乎走了俩三年的感觉。如今的我们，对比之前的我们，改变的太多了，为了彼此，失去了自我，为了在一起，我们学会很多东西。希望未来的某一天，我们会以全新的自我去面对！</p><blockquote><p>后来 终于在眼泪中明白 有些人 一旦错过就不在 永远不会再重来</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>EMD Vol 1805</title>
      <link href="/emd-vol-1805.html"/>
      <url>/emd-vol-1805.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>上一次的月记是1月份，还是春节前写的月记，直到现在才终于动手写。 我在想是不是自己变懒了？还是自己太忙了？或者逃避写这类文章？我想都不是，对我来说写作是随心的事情，并不是有规矩的去写，这样下来文章质量太差了。</p><h3 id="琐事"><a href="#琐事" class="headerlink" title="琐事"></a>琐事</h3><p>细想几个月，也没感觉自己忙些什么，之前的日子一直在上班，晚上回来继续折腾喜欢的东西，大概这样的日子过了几个月，又放弃了。因为太枯燥，想改变一些节奏，一个宅男改来改去还能变成阳光少年吗？天真，死肥宅就是死肥宅，哪来的男神啊，少年啊，老实做死肥宅就行了。 从四月底辞职一直在家没事干，除了网上接点私包做，其它我都在折腾WP插件，然后学习Golang知识，发现golang挺有趣的，多少有兴趣看下去，不知道快速掌握，但绝不可以放弃…</p><h3 id="心事"><a href="#心事" class="headerlink" title="心事"></a>心事</h3><p>最近貌似又成了瞎几把想的哲学神经病，人呢就是这样，闲下来没事做就瞎想，所以一般都是没事找事做，不能让自己闲下来。但有个例外，你连事情都不想做了，脑子里的东西无法受控，不断的骚扰你并且尝试控制你的思维？那么这时候差不多是你崩溃的时间段，例如现在的我，脑子的思维很混乱，就行鸡蛋里的盘古一样，迷迷糊糊的，分不清天地任何事物。所以还是找个事情把自己忙下去吧。 这段时间家里还算可以，没啥事，就是大家都很忙，忙到我以为这个世界，这片宇宙之下只剩下我了，我就像叶片漂浮在这边浩瀚的大海上，为不知名的东西或者精神奋。 骚年加油！</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>NginxFastCGI cache for WordPress</title>
      <link href="/nginxfastcgi-cache-for-wordpress.html"/>
      <url>/nginxfastcgi-cache-for-wordpress.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>FastCGI缓存是一个为动态请求而构建的缓存系统，这个缓存系统最棒的地方在于它不依赖任何外部的PHP-MySQL应用程序或插件来快速提供你的内容。 您甚至不需要依赖代理缓存解决方案（如Varnish），因为FastCGI缓存由Nginx内核托管并提供服务，而无需与其他应用或系统守护进程进行任何外部交互。 今天尝试在博客添加该功能。之前<a href="https://iiong.com/nginx-fastcgi_cache-acceleration-of-wordpress.html" target="_blank" rel="noopener">利用Nginx fastcgi_cache缓存对WordPress博客进行加速</a> 写过类似，不过配置文件有些变化，而且打算放弃插件支持，直接在配置文件添加相关规则触发条件。</p><h3 id="安装ngx-cache-purge"><a href="#安装ngx-cache-purge" class="headerlink" title="安装ngx_cache_purge"></a>安装ngx_cache_purge</h3><pre><code>nginx -V 2&gt;&amp;1 | grep -o ngx_cache_purge #没有任何反馈就是没有安装cd /root/oneinstack/srcwget http://labs.frickle.com/files/ngx_cache_purge-2.3.tar.gztar xzf ngx_cache_purge-2.3.tar.gztar xzf nginx-1.14.0.tar.gzcd nginx-1.14.0nginx -V #查看nginx编译参数，最后加上--add-module=../ngx_cache_purge-2.3make clean./configure --prefix=/usr/local/nginx --user=www --group=www --with-http_stub_status_module --with-http_v2_module --with-http_ssl_module --with-ipv6 --with-http_gzip_static_module --with-http_realip_module --with-http_flv_module --with-openssl=../openssl-1.0.2h --with-pcre=../pcre-8.39 --with-pcre-jit --with-ld-opt=&apos;-ljemalloc&apos; --add-module=../ngx_cache_purge-2.3make  #编译mv /usr/local/nginx/sbin/nginx{,_`date +%F`}  #备份nginxcp objs/nginx /usr/local/nginx/sbinnginx -V 2&gt;&amp;1 | grep -o ngx_cache_purge # 显示ngx_cache_purge表示已经安装成功</code></pre><p>这里不做再多描述。</p><h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p>之前使用的是<code>Nginx Helper</code>插件配合清理缓存，今天尝试抛弃该插件： 在你的域名配置文件头部添加：</p><pre><code>fastcgi_cache_path /var/run/nginx-cache levels=1:2 keys_zone=WORDPRESS:100m inactive=60m;fastcgi_cache_key &quot;$scheme$request_method$host$request_uri&quot;;fastcgi_cache_use_stale error timeout invalid_header http_500;fastcgi_ignore_headers Cache-Control Expires Set-Cookie;server {    listen   80;    root /usr/share/nginx/html;    index index.php index.html index.htm;    server_name example.com;    set $skip_cache 0;    # post访问不缓存    if ($request_method = POST) {        set $skip_cache 1;    }    # 动态查询不缓存    if ($query_string != &quot;&quot;) {        set $skip_cache 1;    }    # 后台等特定页面不缓存    if ($request_uri ~* &quot;/wp-admin/|/xmlrpc.php|wp-.*.php|/feed/|index.php|sitemap(_index)?.xml&quot;) {        set $skip_cache 1;    }    # 对登录用户、评论过的用户不展示缓存    if ($http_cookie ~* &quot;comment_author|wordpress_[a-f0-9]+|wp-postpass|wordpress_no_cache|wordpress_logged_in&quot;) {        set $skip_cache 1;    }    location ~ \.php$ {        try_files $uri =404;        include /etc/nginx/fastcgi_params;.        fastcgi_read_timeout 360s;        fastcgi_buffer_size 128k;        fastcgi_buffers 4 256k;        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;        # Use the upstream for php5-fpm that we defined in nginx.conf        fastcgi_pass php;        fastcgi_index index.php;        # 新增规则        fastcgi_cache_bypass $skip_cache;        fastcgi_no_cache $skip_cache;        fastcgi_cache WORDPRESS;        fastcgi_cache_valid  60m;        add_header X-FastCGI-Cache &quot;$upstream_cache_status From $host&quot;;    }}</code></pre><p>故我的完整的配置如下：</p><pre><code>fastcgi_cache_path /var/run/nginx-cache levels=1:2 keys_zone=WORDPRESS:100m inactive=60m;fastcgi_cache_key &quot;$scheme$request_method$host$request_uri&quot;;fastcgi_cache_use_stale error timeout invalid_header http_500;fastcgi_ignore_headers Cache-Control Expires Set-Cookie;server {  listen 80;  listen 443 ssl http2;  ssl_certificate /usr/local/nginx/conf/ssl/iiong.com.crt;  ssl_certificate_key /usr/local/nginx/conf/ssl/iiong.com.key;  ssl_protocols TLSv1 TLSv1.1 TLSv1.2;  ssl_ciphers EECDH+CHACHA20:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5;  ssl_prefer_server_ciphers on;  ssl_session_timeout 10m;  ssl_session_cache builtin:1000 shared:SSL:10m;  ssl_buffer_size 1400;  add_header Strict-Transport-Security max-age=15768000;  ssl_stapling on;  ssl_stapling_verify on;  server_name iiong.com www.iiong.com;  access_log /data/wwwlogs/iiong.com_nginx.log combined;  index index.html index.htm index.php;  root /data/wwwroot/iiong.com;  if ($ssl_protocol = &quot;&quot;) { return 301 https://$host$request_uri; }  if ($host != iiong.com) {  return 301 $scheme://iiong.com$request_uri;  }  include /usr/local/nginx/conf/rewrite/wordpress.conf;  include /usr/local/nginx/conf/rewrite/pagespeed.conf;  rewrite ^/sitemap-xml$ /sitemap.php last;  set $skip_cache 0;  # post访问不缓存  if ($request_method = POST) {    set $skip_cache 1;  }  # 动态查询不缓存  if ($query_string != &quot;&quot;) {    set $skip_cache 1;  }   # 后台等特定页面不缓存  if ($request_uri ~* &quot;/wp-admin/|/xmlrpc.php|wp-.*.php|/feed/|index.php|sitemap(_index)?.xml&quot;) {    set $skip_cache 1;  }  # 对登录用户、评论过的用户不展示缓存  if ($http_cookie ~* &quot;comment_author|wordpress_[a-f0-9]+|wp-postpass|wordpress_no_cache|wordpress_logged_in&quot;) {    set $skip_cache 1;  }  location ~ .*\.(wma|wmv|asf|mp3|mmf|zip|rar|jpg|gif|png|swf|flv|mp4)$ {    valid_referers none blocked *.iiong.com iiong.com www.iiong.com;    if ($invalid_referer) {        rewrite ^/ http://www.linuxeye.com/403.html;        return 403;    }  }  location ~ [^/]\.php(/|$) {    try_files $uri =404;    fastcgi_pass unix:/dev/shm/php-cgi.sock;    fastcgi_index index.php;    include fastcgi.conf;    #新增的缓存规则    fastcgi_cache_bypass $skip_cache;    fastcgi_no_cache $skip_cache;    fastcgi_cache WORDPRESS;    fastcgi_cache_valid 60m;    add_header X-FastCGI-Cache &quot;$upstream_cache_status From $host&quot;;  }  location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|flv|mp4|ico)$ {    expires 30d;    access_log off;  }  location ~ .*\.(js|css)?$ {    expires 7d;    access_log off;  }  location ~ /\.ht {    deny all;  }}</code></pre><p>重启服务器<code>service nginx restart</code> 然后在访客模式（退出登录）查看网页的响应头是否有<code>X-FastCGI-Cache</code>字段，如果有则成功了。 <img src="https://i.loli.net/2018/05/20/5b00ebb4c1ba8.png" alt="QQ截图20180520112846.png"></p><h3 id="WP优化"><a href="#WP优化" class="headerlink" title="WP优化"></a>WP优化</h3><p>将下面代码放在你想放的地方，不过建议像插件一样集成，新建php文件存放在<code>wp-content/plugins</code>文件夹即可：</p><pre><code>&lt;?php/** * Plugin Name: NGINX FastCGI缓存清理 * Version: 1.0 * Description: 刷新NGINX FastCGI缓存 * Author: 淮城一只猫 * Author URI: https://iiong.com * Plugin URI: https://iiong.com */if ( ! defined( &apos;NGINX_CACHE_PATH&apos; ) ) {    define( &apos;NGINX_CACHE_PATH&apos;, &apos;/var/run/nginx-cache&apos; );}final class NGINX_FastCGI_cache_purge {    public static $instance = null;    private function __construct() {        add_action( &apos;edit_post&apos;, [ $this, &apos;purge_cache&apos; ] );    }    /**     * Creates or returns an instance of this class.     *     * @return A single instance of this class.     */    public static function init() {        if ( self::$instance === null ) {            self::$instance = new self;        }        return self::$instance;    }    /**     * Purge a page from the NGINX FastCGI cache.     *     * @param int $post_id WP_Post ID.     */    public function purge_cache( $post_id ) {        if ( &apos;publish&apos; !== get_post_status( $post_id ) ) {            return;        }        $public_post_types = get_post_types([ &apos;public&apos; =&gt; true ]);        $post_type = get_post_type( $post_id );        if ( ! in_array( $post_type, $public_post_types ) ) {            return;        }        $url = get_permalink( $post_id );        if ( ! $url ) {            return;        }        $path = $this-&gt;get_cache_path( $url );        if ( $path ) {            $this-&gt;flush_cache( $path );        }    }    /**     * Get the path to the cached file from the URL.     *     * @param string $url URL to parse.     *     * @return string path to the cached page.     */    protected function get_cache_path( $url ) {        if ( ! $url ) {            return false;        }        $url = parse_url( $url );        $hash = md5( $url[&apos;scheme&apos;] . &apos;GET&apos; . $url[&apos;host&apos;] . $url[&apos;path&apos;] );        $path = trailingslashit( NGINX_CACHE_PATH );        return $path . substr( $hash, -1 ) . &apos;/&apos; . substr( $hash, -3, 2 ) . &apos;/&apos; . $hash;    }    /**     * Flush the cache from the path to the cached file.     *      * @param string $path Path to the cached file to flush.     *      * @return bool True on success or false.     */    protected function flush_cache( $path ) {        if ( file_exists( $path ) ) {            return unlink( $path );        }        return false;    }}NGINX_FastCGI_cache_purge::init();</code></pre><p>然后启用即可，该插件作用就是你更新文章刷新下缓存即可。</p><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><blockquote><p><a href="https://www.ehowstuff.com/setup-wordpress-nginx-with-fastcgi-caching-in-centos-7/" target="_blank" rel="noopener">https://www.ehowstuff.com/setup-wordpress-nginx-with-fastcgi-caching-in-centos-7/</a> <a href="https://medium.com/@Alibaba_Cloud/wordpress-caching-solutions-part-2-configuring-nginx-fastcgi-static-page-caching-and-final-load-3d101dfea5ea" target="_blank" rel="noopener">https://medium.com/@Alibaba_Cloud/wordpress-caching-solutions-part-2-configuring-nginx-fastcgi-static-page-caching-and-final-load-3d101dfea5ea</a> <a href="https://gist.github.com/richardsweeney/736465dddce8398357a9" target="_blank" rel="noopener">https://gist.github.com/richardsweeney/736465dddce8398357a9</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
            <tag> WordPress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在Linux环境添加ngx_pagespeed模块支持</title>
      <link href="/add-ngx-pagespeed-module-support-in-linux-environment.html"/>
      <url>/add-ngx-pagespeed-module-support-in-linux-environment.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><blockquote><p>ngx_pagespeed或叫pagespeed，是一个Nginx模块，旨在通过减少资源的大小自动优化您的网站，从而缩短客户浏览器加载它的时间。</p></blockquote><p>之前在<a href="https://iiong.com/install-ngx_pagespeed-notes.html" target="_blank" rel="noopener">使用ngx_pagespeed优化博客</a>写过，因为配置文件改了，所以重开文章算了。 ngx_pagespeed模块的主要功能大致有： - 图像优化：剥离元数据、动态调整，重新压缩 - CSS和JavaScript压缩、合并、级联、内联 - 小资源内联 - 推迟图像和JavaScript加载 - 对HTML重写、压缩空格、去除注释等 - 提升缓存周期 - 优化缓存 - 最小化round-trip次数 - 最小化请求开销 - 最小化负载大小 - 优化浏览器渲染 - 移动方面的优化 - …. 总结这么多优点是应该要体验下~具体用处实例可以查看文档：<a href="https://www.ngxpagespeed.com/ngx_pagespeed_example/" target="_blank" rel="noopener">https://www.ngxpagespeed.com/ngx_pagespeed_example/</a></p><h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><p>我的是Centos 7系统，使用的是<a href="//oneinstack.com">Oneinstack</a>环境，具体不作详述。</p><pre><code>yum update #确保组件最新yum install gcc-c ++ pcre-devel zlib-devel make unzip libuuid-devel #安装环境之前需要安装这些组件cd oneinstack/src/ #定位目录tar xzf nginx-1.14.0.tar.gz #解压Nginx源码，准备平滑升级wget https://github.com/pagespeed/ngx_pagespeed/archive/master.zip #下载最新版ngx_pagespeed源码 https://github.com/apache/incubator-pagespeed-mod/releasesunzip master.zip #解压mv incubator-pagespeed-ngx-master/ ngx_pagespeed #重命名文件夹rm master.zip #删除ngx_pagespeed源码cd ngx_pagespeed #进入ngx_pagespeed源码组件wget https://dl.google.com/dl/page-speed/psol/1.13.35.2-x64.tar.gz #下载PSOL包：https://dl.google.com/dl/page-speed/psol/[PageSpeed版本]-x[系统位数].tar.gztar -xzvf 1.13.35.2-x64.tar.gz &amp;&amp; rm 1.13.35.2-x64.tar.gz #解压删除组件./scripts/pagespeed_libraries_generator.sh &gt; /usr/local/nginx/conf/pagespeed_libraries.conf #在/usr/local/nginx/conf/目录下生成pagespeed_libraries.conf配置文件cd ../nginx-1.14.0/ #返回Nginx源码目录nginx -V #查询编译参数./configure --prefix=/usr/local/nginx --user=www --group=www --with-http_stub_status_module --with-http_v2_module --with-http_ssl_module --with-http_gzip_static_module --with-http_realip_module --with-http_flv_module --with-http_mp4_module --with-openssl=../openssl-1.0.2o --with-pcre=../pcre-8.42 --with-pcre-jit --with-ld-opt=-ljemalloc --add-module=../ngx_pagespeed #编译</code></pre><p>主要后面添加<code>--add-module=../ngx_pagespeed</code>的ngx_pagespeed编译参数。 这儿我遇到报错，如下：</p><pre><code>build_from_source=falsechecking for psol ... not found./configure: error: module ngx_pagespeed requires the pagespeed optimization library.Look in /root/oneinstack/src/nginx-1.14.0/objs/autoconf.err for more details.</code></pre><p>根据<a href="https://www.modpagespeed.com/doc/build_ngx_pagespeed_from_source" target="_blank" rel="noopener">https://www.modpagespeed.com/doc/build_ngx_pagespeed_from_source</a> 看了下应该是环境不完整：</p><pre><code>yum install gcc-c ++ pcre-devel zlib-devel make unzip libuuid-devel</code></pre><p>然后再执行上面操作通过了。 执行<code>make</code>进行编译，当你看到：</p><pre><code>-ljemalloc -ldl -lpthread -lcrypt ../ngx_pagespeed/psol/lib/Release/linux/x64/pagespeed_automatic.a -lstdc++ -lrt -pthread -lm -luuid ../pcre-8.42/.libs/libpcre.a ../openssl-1.0.2o/.openssl/lib/libssl.a ../openssl-1.0.2o/.openssl/lib/libcrypto.a -ldl -lpthread -lz \-Wl,-Esed -e &quot;s|%%PREFIX%%|/usr/local/nginx|&quot; \    -e &quot;s|%%PID_PATH%%|/usr/local/nginx/logs/nginx.pid|&quot; \    -e &quot;s|%%CONF_PATH%%|/usr/local/nginx/conf/nginx.conf|&quot; \    -e &quot;s|%%ERROR_LOG_PATH%%|/usr/local/nginx/logs/error.log|&quot; \    &lt; man/nginx.8 &gt; objs/nginx.8make[1]: Leaving directory `/root/oneinstack/src/nginx-1.14.0&apos;</code></pre><p>则编译成功，我们需要安装它：</p><pre><code>mv /usr/local/nginx/sbin/nginx{,_`date +%F`}  #备份nginxcp objs/nginx /usr/local/nginx/sbinnginx -V 2&gt;&amp;1 | grep -o ngx_pagespeed # 显示ngx_pagespeed表示已经安装成功</code></pre><h3 id="配置环境"><a href="#配置环境" class="headerlink" title="配置环境"></a>配置环境</h3><p>新建个<code>pagespeed.conf</code>文件存放<code>/usr/local/nginx/conf/rewrite</code>:</p><pre><code>pagespeed on;# memcached优化,如果没有memcached优化请删去pagespeed MemcachedThreads 1;pagespeed MemcachedServers &quot;localhost:11211&quot;;# 重置 http Vary 头pagespeed RespectVary on;# html字符转小写pagespeed LowercaseHtmlNames on;# 压缩带 Cache-Control: no-transform 标记的资源#pagespeed DisableRewriteOnNoTransform off;# 相对URLpagespeed PreserveUrlRelativity on;pagespeed XHeaderValue &quot;Powered By JaxsonWang&quot;;# 开启 httpspagespeed FetchHttps enable;# 配置服务器缓存位置和自动清除触发条件（空间大小、时限）pagespeed FileCachePath &quot;/var/ngx_pagespeed/&quot;;pagespeed FileCacheSizeKb 2048000;pagespeed FileCacheCleanIntervalMs 43200000;pagespeed FileCacheInodeLimit 500000;# 过滤规则# pagespeed RewriteLevel PassThrough;pagespeed RewriteLevel OptimizeForBandwidth;# 过滤WordPress的/wp-admin/目录(可选配置，可参考使用)pagespeed Disallow &quot;*/wp-admin/*&quot;;pagespeed Disallow &quot;*/wp-login.php*&quot;;# 过滤typecho的/admin/目录(可选配置，可参考使用)# pagespeed Disallow &quot;*/admin/*&quot;;# 移除不必要的url前缀，开启可能会导致某些自动加载功能失效#pagespeed EnableFilters trim_urls;# 移除 html 空白pagespeed EnableFilters collapse_whitespace;# 移除 html 注释pagespeed EnableFilters remove_comments;# DNS 预加载pagespeed EnableFilters insert_dns_prefetch;# 压缩CSSpagespeed EnableFilters rewrite_css;# 合并CSSpagespeed EnableFilters combine_css;# 重写CSS，优化加载渲染页面的CSS规则pagespeed EnableFilters prioritize_critical_css;# google字体直接写入html 目的是减少浏览器请求和DNS查询# pagespeed EnableFilters inline_google_font_css;# 压缩jspagespeed EnableFilters rewrite_javascript;# 合并jspagespeed EnableFilters combine_javascript;# 优化内嵌样式属性pagespeed EnableFilters rewrite_style_attributes;# 压缩图片pagespeed EnableFilters rewrite_images;# 不加载显示区域以外的图片pagespeed LazyloadImagesAfterOnload off;# 图片预加载pagespeed EnableFilters inline_preview_images;# 图片自适应重置pagespeed EnableFilters resize_images;# 移动端图片自适应重置pagespeed EnableFilters resize_mobile_images;# 图片延迟加载pagespeed EnableFilters lazyload_images;# 雪碧图片，图标很多的时候很有用#pagespeed EnableFilters sprite_images;# 扩展缓存 改善页面资源的可缓存性pagespeed EnableFilters extend_cache;# 风险指数高，不建议开启# pagespeed EnableFilters local_storage_cache;# 不能删location ~ &quot;\.pagespeed\.([a-z]\.)?[a-z]{2}\.[^.]{10}\.[^.]+&quot; {     add_header &quot;&quot; &quot;&quot;; }location ~ &quot;^/ngx_pagespeed_static/&quot; {}location ~ &quot;^/ngx_pagespeed_beacon$&quot; {}location /ngx_pagespeed_statistics {     allow 127.0.0.1;     deny all; }location /ngx_pagespeed_global_statistics {    allow 127.0.0.1;    deny all;}location /ngx_pagespeed_message {     allow 127.0.0.1;    deny all; }location ~ ^/pagespeed_global_admin {    allow 127.0.0.1;    deny all;}pagespeed StatisticsPath /ngx_pagespeed_statistics;pagespeed MessagesPath /ngx_pagespeed_message;pagespeed ConsolePath /pagespeed_console;pagespeed AdminPath /pagespeed_admin;# 控制台 可通过 http://domain.com/ngx_pagespeed_admin 来查看控制台pagespeed Statistics on;pagespeed StatisticsLogging on;# log目录pagespeed LogDir /data/wwwlogs/pagespeed;location /pagespeed_console {    allow 127.0.0.1;    deny all;}pagespeed AdminPath /ngx_pagespeed_admin;location ~ ^/pagespeed_admin {    allow 127.0.0.1;    deny all;}# 日志限制pagespeed StatisticsLoggingIntervalMs 60000;pagespeed StatisticsLoggingMaxFileSizeKb 1024;</code></pre><p>然后在你的域名配置加入：</p><pre><code>include /usr/local/nginx/conf/rewrite/pagespeed.conf;service nginx restart</code></pre><p>重启服务器即可。</p><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>清理缓存：<a href="https://www.modpagespeed.com/doc/system#flush_cache_legacy" target="_blank" rel="noopener">https://www.modpagespeed.com/doc/system#flush_cache_legacy</a></p><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><blockquote><p><a href="https://blog.stackpath.com/nginx-performance-tips-google-pagespeed" target="_blank" rel="noopener">https://blog.stackpath.com/nginx-performance-tips-google-pagespeed</a> <a href="https://www.wpoven.com/tutorials/server/how-to-setup-modpagespeed-with-nginx-varnish-and-php-fpm" target="_blank" rel="noopener">https://www.wpoven.com/tutorials/server/how-to-setup-modpagespeed-with-nginx-varnish-and-php-fpm</a> <a href="https://www.ngxpagespeed.com/ngx\_pagespeed\_example/" target="_blank" rel="noopener">https://www.ngxpagespeed.com/ngx\_pagespeed\_example/</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
            <tag> WordPress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WP自定义网页字体</title>
      <link href="/wordpress-custom-web-font.html"/>
      <url>/wordpress-custom-web-font.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>今天在群里和一个朋友讨论网页字体美化的方案，因为跨平台原因，总是找不到合适的中文字体渲染方案。 再此之前我研究过类似的，那时候直接从ttf字体文件提取汉字常用字的web font，加载到网页会出现大量的空白网页等待时间，故总结：</p><ul><li>字体过大</li><li>Web字体文件下载太慢，宽带不足</li><li><code>font-family</code>没有适当配置好</li></ul><h3 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h3><p>总结上面几点，主要还是做个异步加载，就是在加载中web font期间渲染的是系统自带的字体。Google搜索下的确有一个方案：<a href="https://github.com/typekit/webfontloader" target="_blank" rel="noopener">Web Font Loader</a> 既然有这个库很好办，所以我们需要准备什么？</p><ul><li><a href="https://raw.githubusercontent.com/JaxsonWang/Chinese_5039/master/chinese_5039.txt" target="_blank" rel="noopener">汉字常用字体</a></li><li><a href="https://github.com/typekit/webfontloader" target="_blank" rel="noopener">WebFontLoader</a></li><li>下载字体提取工具<a href="http://ecomfe.github.io/fontmin/#app" target="_blank" rel="noopener">FontMin</a></li><li>心仪字体，格式为ttf（建议重命名为英文）</li></ul><p>打开FontMin工具，将<code>汉字常用字体</code>的内容复制进去，再将字体拖进去点击<code>生成</code>，大概一分钟后自动打开个文件夹，里面包含Web ont字体： <img src="https://i.loli.net/2018/05/17/5afd968a27820.png" alt="QQ截图20180517224831.png"></p><h3 id="石锤教材"><a href="#石锤教材" class="headerlink" title="石锤教材"></a>石锤教材</h3><p>得到字体后下面基本简单了，简单的来说就是这样：</p><pre><code>&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;meta charset=&quot;utf-8&quot;/&gt;    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;    &lt;title&gt;Page Title&lt;/title&gt;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;    &lt;link href=&quot;hyxb.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;    &lt;style type=&quot;text/css&quot; rel=&quot;stylesheet&quot;&gt;        .aaa {            font-family: &quot;hyxb&quot;;/*hyxb是你的字体声明（一般是你命名的字体文件名）*/        }    &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=&quot;aaa&quot;&gt;    捌扒叭吧笆八疤巴拔跋靶    把耙壩坝    汹雄熊休修羞朽嗅銹锈秀袖繡    绣墟戌需虛虚噓嘘須须徐許许蓄酗敘    叙旭序畜恤絮婿緒绪續续軒轩喧    宣懸悬旋玄選选癬癣眩絢绚靴薛    學学穴雪血勳勋熏循旬詢询尋寻    馴驯巡殉汛訓训訊讯遜逊迅壓压    押鴉鸦鴨鸭呀丫芽牙蚜崖衙涯    雅啞哑亞亚訝讶焉咽閹阉煙烟淹鹽&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>根据上面得知引入生成的<code>css文件</code>，然后声明字体类型就行了。 既然得到字体后，个人不建议放在小宽带的服务器里面，绝大部分提取的字体基本上兆，建议存放对象存储里，例如七牛云、又拍云等。 你只需要把<code>css（带xxxxx-embed的不需要上传）</code>、<code>eot</code>、<code>svg</code>、<code>ttf</code>、<code>woff</code>上传到对象存储中即可。 那么在WordPress如何使用？ 根据<a href="https://github.com/typekit/webfontloader" target="_blank" rel="noopener">webfontloader</a>教程得知配置：</p><pre><code>&lt;script type=&quot;text/javascript&quot; src=&quot;https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot;&gt;    WebFont.load({        custom: {            families: [&apos;hyxb&apos;],            urls: [&apos;//cdn.com/fonts/hyxb/hyxb.css&apos;] //这里引入你上传到对象存储的css文件        }    });&lt;/script&gt;</code></pre><p>把上面的脚本放在<code>footer.php</code>的<code>&lt;/body&gt;</code>前面，注意，是前面，不是后面即可，放在页脚主要加速网页加载。 然后在你的css文件（同样在wp设置-额外的css里填写内容也可以），添加代码：</p><pre><code>html.wf-active body {    font-family: &apos;你的字体声明（一般是你命名的字体文件名）&apos;, sans-serif;}</code></pre><p>基本上字体美化就可以了，至于其他的需要你自己慢慢调整了。</p><h3 id="交流"><a href="#交流" class="headerlink" title="交流"></a>交流</h3><p>如果你使用有任何问题，请加群交流： <a href="//shang.qq.com/wpa/qunwpa?idkey=e13bebbae29710b57eb4707b78b59c0e63e8e060279ae0ac600ddd9c8fbeef45">添加QQ群</a> 当然了，群里有编译好的字体，拿来即用！</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WordPress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WordPress评论检验</title>
      <link href="/wordpress-review-check.html"/>
      <url>/wordpress-review-check.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>由于之前使用的是修改评论框的id，各种问题，暂时放弃了，直接弄类似滑动解锁的东西。大概也不难，就俩段代码。但不清楚是否能放住辣鸡评论，先看着再说，实在不行再改回去吧。</p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>将下列代码存放到<code>function.php</code>即可。</p><pre><code>/** * 创建字段 * @param $fields * * @return mixed */function custom_fields( $fields ) {    // Multilingual strings    $req = get_option( &apos;require_name_email&apos; );    $aria_req = ( $req ? &quot; aria-required=&apos;true&apos;&quot; : &apos;&apos; );    $url = &apos;https://baidu.com&apos;;    $read_and_accept = __( &apos;我同意该协议：&apos; );    $fields[ &apos;policy&apos; ] =        &apos;&lt;p class=&quot;comment-form-policy&quot;&gt;&apos;.        &apos;&lt;label for=&quot;policy&quot;&gt;                &lt;input name=&quot;policy&quot; value=&quot;policy-key&quot; class=&quot;comment-form-policy__input&quot; type=&quot;checkbox&quot; style=&quot;width:auto&quot;&apos; . $aria_req . &apos;&gt;                &apos; . $read_and_accept . &apos;                &lt;a href=&quot;&apos; . esc_url( $url ) . &apos;&quot; target=&quot;_blanck&quot; class=&quot;comment-form-policy__see-more-link&quot;&gt;&apos; . __(&apos;xxxx隐私协议&apos;) . &apos;&lt;/a&gt;                &lt;span class=&quot;comment-form-policy__required required&quot;&gt;*&lt;/span&gt;            &lt;/label&gt;        &lt;/p&gt;&apos;;    return $fields;}add_filter(&apos;comment_form_default_fields&apos;, &apos;custom_fields&apos;);/** * 添检查评论元数据是否已填充 * @param $policydata * * @return mixed */function verify_policy_check( $policydata ) {    if ( ! isset( $_POST[&apos;policy&apos;] ) &amp;&amp; ! is_user_logged_in() )        wp_die( __( &apos;错误：你必须同意xxxx隐私协议才能进行下一步操作！&apos; ) . &apos;&lt;p&gt;&lt;a href=&quot;javascript:history.back()&quot;&gt;&apos; . __(&apos;« 返回&apos;) . &apos;&lt;/a&gt;&lt;/p&gt;&apos;);    return $policydata;}add_filter( &apos;preprocess_comment&apos;, &apos;verify_policy_check&apos; );</code></pre><p>大概这样就基本实现需求了。 效果图： <img src="https://i.loli.net/2018/05/17/5afd4386d9939.png" alt="QQ截图20180517165438.png"></p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WordPress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Go数据类型</title>
      <link href="/go-data-type.html"/>
      <url>/go-data-type.html</url>
      
        <content type="html"><![CDATA[<h3 id="定义变量"><a href="#定义变量" class="headerlink" title="定义变量"></a>定义变量</h3><p>使用var关键字是Go最基本的定义变量方式，与C语言不同的是Go把变量类型放在变量名后面：</p><pre><code>//定义一个名称为“variableName”，类型为&quot;type&quot;的变量var variableName type</code></pre><p>定义多个变量:</p><pre><code>//定义三个类型都是“type”的变量var vname1, vname2, vname3 type</code></pre><p>定义变量并初始化值:</p><pre><code>//初始化“variableName”的变量为“value”值，类型是“type”var variableName type = value</code></pre><p>同时初始化多个变量:</p><pre><code>/*    定义三个类型都是&quot;type&quot;的变量,并且分别初始化为相应的值    vname1为v1，vname2为v2，vname3为v3*/var vname1, vname2, vname3 type= v1, v2, v3</code></pre><p>有一种写法可以让它变得简单一点。我们可以直接忽略类型声明，那么上面的代码变成这样了：</p><pre><code>/*    定义三个变量，它们分别初始化为相应的值    vname1为v1，vname2为v2，vname3为v3    然后Go会根据其相应值的类型来帮你初始化它们*/var vname1, vname2, vname3 = v1, v2, v3</code></pre><p>当然你可以更简单去声明：</p><pre><code>/*    定义三个变量，它们分别初始化为相应的值    vname1为v1，vname2为v2，vname3为v3    编译器会根据初始化的值自动推导出相应的类型*/vname1, vname2, vname3 := v1, v2, v3</code></pre><p><code>:=</code>这个符号直接取代了<code>var</code>和<code>type</code>,这种形式叫做简短声明。不过它有一个限制，那就是它只能用在函数内部；在函数外部使用则会无法编译通过，所以一般用<code>var</code>方式来定义全局变量。 <code>_</code>（下划线）是个特殊的变量名，任何赋予它的值都会被丢弃。在这个例子中，我们将值<code>35</code>赋予<code>b</code>，并同时丢弃<code>34</code>：</p><pre><code>_, b := 34, 35</code></pre><p>Go对于已声明但未使用的变量会在编译阶段报错，比如下面的代码就会产生一个错误：声明了<code>i</code>但未使用。</p><pre><code>package mainfunc main() {    var i int}</code></pre><h3 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h3><p>所谓常量，也就是在程序编译阶段就确定下来的值，而程序在运行时无法改变该值。在Go程序中，常量可定义为数值、布尔值或字符串等类型。 它的语法如下：</p><pre><code>const constantName = value//如果需要，也可以明确指定常量的类型：const Pi float32 = 3.1415926</code></pre><p>下面是一些常量声明的例子：</p><pre><code>const Pi = 3.1415926const i = 10000const MaxThread = 10const prefix = &quot;astaxie_&quot;</code></pre><p>Go 常量和一般程序语言不同的是，可以指定相当多的小数位数(例如200位)， 若指定給float32自动缩短为32bit，指定给float64自动缩短为64bit，详情参考<a href="http://golang.org/ref/spec#Constants" target="_blank" rel="noopener">链接</a></p><h2 id="内置基础类型"><a href="#内置基础类型" class="headerlink" title="内置基础类型"></a>内置基础类型</h2><h3 id="Boolean"><a href="#Boolean" class="headerlink" title="Boolean"></a>Boolean</h3><p>在Go中，布尔值的类型为<code>bool</code>，值是<code>true</code>或<code>false</code>，默认为<code>false</code>。</p><pre><code>//示例代码var isActive bool  // 全局变量声明var enabled, disabled = true, false  // 忽略类型的声明func test() {    var available bool  // 一般声明    valid := false      // 简短声明    available = true    // 赋值操作}</code></pre><h3 id="数值类型"><a href="#数值类型" class="headerlink" title="数值类型"></a>数值类型</h3><p>整数类型有无符号和带符号两种。Go同时支持<code>int</code>和<code>uint</code>，这两种类型的长度相同，但具体长度取决于不同编译器的实现。Go里面也有直接定义好位数的类型：<code>rune</code>, <code>int8</code>, <code>int16</code>, <code>int32</code>, <code>int64</code>和<code>byte</code>, <code>uint8</code>, <code>uint16</code>, <code>uint32</code>, <code>uint64</code>。其中<code>rune</code>是<code>int32</code>的别称，<code>byte</code>是<code>uint8</code>的别称。</p><blockquote><p>需要注意的一点是，这些类型的变量之间不允许互相赋值或操作，不然会在编译时引起编译器报错。 如下的代码会产生错误：invalid operation: a + b (mismatched types int8 and int32)</p><blockquote><p>var a int8 var b int32 c:=a + b</p></blockquote><p>另外，尽管int的长度是32 bit, 但int 与 int32并不可以互用。</p></blockquote><p>浮点数的类型有<code>float32</code>和<code>float64</code>两种（没有<code>float</code>类型），默认是<code>float64</code>。 这就是全部吗？No！Go还支持复数。它的默认类型是<code>complex128</code>（64位实数+64位虚数）。如果需要小一些的，也有<code>complex64</code>(32位实数+32位虚数)。复数的形式为<code>RE + IMi</code>，其中<code>RE</code>是实数部分，<code>IM</code>是虚数部分，而最后的<code>i</code>是虚数单位。下面是一个使用复数的例子：</p><pre><code>var c complex64 = 5+5i//output: (5+5i)fmt.Printf(&quot;Value is: %v&quot;, c)</code></pre><h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><p>我们在上一节中讲过，Go中的字符串都是采用<code>UTF-8</code>字符集编码。字符串是用一对双引号（<code>&quot;&quot;</code>）或反引号（<code>`</code> <code>）括起来定义，它的类型是</code>string`。</p><pre><code>//示例代码var frenchHello string  // 声明变量为字符串的一般方法var emptyString string = &quot;&quot;  // 声明了一个字符串变量，初始化为空字符串func test() {    no, yes, maybe := &quot;no&quot;, &quot;yes&quot;, &quot;maybe&quot;  // 简短声明，同时声明多个变量    japaneseHello := &quot;Konichiwa&quot;  // 同上    frenchHello = &quot;Bonjour&quot;  // 常规赋值}</code></pre><p>在Go中字符串是不可变的，例如下面的代码编译时会报错：cannot assign to s[0]</p><pre><code>var s string = &quot;hello&quot;s[0] = &apos;c&apos;</code></pre><p>但如果真的想要修改怎么办呢？下面的代码可以实现：</p><pre><code>s := &quot;hello&quot;c := []byte(s)  // 将字符串 s 转换为 []byte 类型c[0] = &apos;c&apos;s2 := string(c)  // 再转换回 string 类型fmt.Printf(&quot;%s\n&quot;, s2)</code></pre><p>Go中可以使用<code>+</code>操作符来连接两个字符串：</p><pre><code>s := &quot;hello,&quot;m := &quot; world&quot;a := s + mfmt.Printf(&quot;%s\n&quot;, a)</code></pre><p>修改字符串也可写为：</p><pre><code>s := &quot;hello&quot;s = &quot;c&quot; + s[1:] // 字符串虽不能更改，但可进行切片操作fmt.Printf(&quot;%s\n&quot;, s)</code></pre><p>如果要声明一个多行的字符串怎么办？可以通过<code></code> `来声明：</p><pre><code>m := `hello    world`</code></pre><p><code></code> ` 括起的字符串为Raw字符串，即字符串在代码中的形式就是打印时的形式，它没有字符转义，换行也将原样输出。例如本例中会输出：</p><pre><code>hello    world</code></pre><h3 id="错误类型"><a href="#错误类型" class="headerlink" title="错误类型"></a>错误类型</h3><p>Go内置有一个<code>error</code>类型，专门用来处理错误信息，Go的<code>package</code>里面还专门有一个包<code>errors</code>来处理错误：</p><pre><code>err := errors.New(&quot;emit macho dwarf: elf header corrupted&quot;)if err != nil {    fmt.Print(err)}</code></pre><h3 id="Go数据底层的存储"><a href="#Go数据底层的存储" class="headerlink" title="Go数据底层的存储"></a>Go数据底层的存储</h3><p>下面这张图来源于<a href="http://research.swtch.com/" target="_blank" rel="noopener">Russ Cox Blog</a>中一篇介绍<a href="http://research.swtch.com/godata" target="_blank" rel="noopener">Go数据结构</a>的文章，大家可以看到这些基础类型底层都是分配了一块内存，然后存储了相应的值。 <img src="https://i.loli.net/2018/05/03/5aeab58bd02bf.png" alt="basic.png"></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Go </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Webpack快速配置编写HTML基础环境</title>
      <link href="/write-html-basic-environment-using-webpack-quick-configuration.html"/>
      <url>/write-html-basic-environment-using-webpack-quick-configuration.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>由于项目需要构建个webpack打包坏境： 目前用到技术栈：<code>Pug + SASS + Webpack + browser</code> JavaScript使用ES6编写编译ES5即可。 <code>package.json</code>直接写入：</p><pre><code>{  &quot;name&quot;: &quot;My_Project&quot;,  &quot;version&quot;: &quot;0.0.1&quot;,  &quot;scripts&quot;: {    &quot;serve&quot;: &quot;webpack-dev-server&quot;,    &quot;build&quot;: &quot;webpack --config webpack.config.prod.babel.js&quot;  },  &quot;dependencies&quot;: {},  &quot;devDependencies&quot;: {    &quot;autoprefixer&quot;: &quot;^8.3.0&quot;,    &quot;babel-core&quot;: &quot;^6.26.0&quot;,    &quot;babel-preset-es2015&quot;: &quot;^6.24.1&quot;,    &quot;browser-sync&quot;: &quot;^2.23.6&quot;,    &quot;browser-sync-webpack-plugin&quot;: &quot;^2.2.2&quot;,    &quot;css-loader&quot;: &quot;^0.28.11&quot;,    &quot;csso-loader&quot;: &quot;^0.3.1&quot;,    &quot;extract-text-webpack-plugin&quot;: &quot;^4.0.0-beta.0&quot;,    &quot;html-loader&quot;: &quot;^0.5.5&quot;,    &quot;node-sass&quot;: &quot;^4.8.3&quot;,    &quot;postcss-loader&quot;: &quot;^2.1.4&quot;,    &quot;pug&quot;: &quot;^2.0.3&quot;,    &quot;pug-html-loader&quot;: &quot;^1.1.5&quot;,    &quot;pug-loader&quot;: &quot;^2.4.0&quot;,    &quot;sanitize.css&quot;: &quot;^5.0.0&quot;,    &quot;sass-loader&quot;: &quot;^7.0.1&quot;,    &quot;webpack&quot;: &quot;4.6.0&quot;,    &quot;webpack-cli&quot;: &quot;^2.0.14&quot;,    &quot;webpack-dev-server&quot;: &quot;3.1.3&quot;  }}</code></pre><p>新建<code>webpack.config.babel.js</code>：</p><pre><code>import webpack from &apos;webpack&apos;import path from &apos;path&apos;import autoprefixer from &apos;autoprefixer&apos;import ExtractTextPlugin from &apos;extract-text-webpack-plugin&apos;import BrowserSyncPlugin from &apos;browser-sync-webpack-plugin&apos;let extractStyles = new ExtractTextPlugin(&apos;[name].css&apos;)let extractHtml = new ExtractTextPlugin(&apos;[name].html&apos;)let config = {  mode: &apos;development&apos;,  entry: {    index: [      path.resolve(__dirname, &apos;templates/index.pug&apos;)    ],    post: [      path.resolve(__dirname, &apos;templates/post.pug&apos;)    ],        &apos;css/application&apos;: [      path.resolve(__dirname, &apos;assets/styles/application.scss&apos;)    ]  },  output: {    path: path.resolve(__dirname, &apos;build&apos;),    filename: &apos;[name].js&apos;  },  module: {    rules: [      {        test: /\.pug$/,        use: extractHtml.extract({          use: [&apos;html-loader&apos;, &apos;pug-html-loader?pretty&amp;exports=false&apos;]        })      },      {        test: /\.scss$/,        use: extractStyles.extract({          use: [            {              loader: &apos;css-loader&apos;            },            {              loader: &apos;postcss-loader&apos;,              options: {                plugins: [                  autoprefixer({                    browsers: [                      &apos;last 2 version&apos;,                      &apos;Explorer &gt;= 10&apos;,                      &apos;Android &gt;= 4&apos;                    ]                  })                ]              }            },            {              loader: &apos;sass-loader&apos;,              options: {                includePaths: [                  path.resolve(__dirname, &apos;node_modules/sanitize.css/&apos;)                ]              }            }          ]        })      }    ]  },  plugins: [    extractStyles,    extractHtml,    new BrowserSyncPlugin(      {        host: &apos;localhost&apos;,        port: 3000,        proxy: &apos;http://localhost:8081/&apos;      },      {        reload: true      }    )  ]}export default config</code></pre><p>新建<code>webpack.config.prod.babel.js</code>:</p><pre><code>import webpack from &apos;webpack&apos;import path from &apos;path&apos;import autoprefixer from &apos;autoprefixer&apos;import ExtractTextPlugin from &apos;extract-text-webpack-plugin&apos;let extractStyles = new ExtractTextPlugin(&apos;[name].css&apos;)let extractHtml = new ExtractTextPlugin(&apos;[name].html&apos;)let config = {  mode: &apos;production&apos;,  entry: {    index: [      path.resolve(__dirname, &apos;templates/index.pug&apos;)    ],    post: [      path.resolve(__dirname, &apos;templates/post.pug&apos;)    ],        &apos;css/application&apos;: [      path.resolve(__dirname, &apos;assets/styles/application.scss&apos;)    ]  },  output: {    path: path.resolve(__dirname, &apos;dist&apos;),    filename: &apos;[name].js&apos;  },  module: {    rules: [      {        test: /\.pug$/,        use: extractHtml.extract({          use: [&apos;html-loader&apos;, &apos;pug-html-loader?pretty&amp;exports=false&apos;]        })      },      {        test: /\.scss$/,        use: extractStyles.extract({          use: [            {              loader: &apos;css-loader&apos;            },            {              loader: &apos;csso-loader?-restructure&apos;            },            {              loader: &apos;postcss-loader&apos;,              options: {                plugins: [                  autoprefixer({                    browsers: [                      &apos;last 2 version&apos;,                      &apos;Explorer &gt;= 10&apos;,                      &apos;Android &gt;= 4&apos;                    ]                  })                ]              }            },            {              loader: &apos;sass-loader&apos;,              options: {                includePaths: [                  path.resolve(__dirname, &apos;node_modules/sanitize.css/&apos;)                ]              }            }          ]        })      }    ]  },  plugins: [    extractStyles,    extractHtml  ]}export default config</code></pre><h3 id="集成Font-Awesome"><a href="#集成Font-Awesome" class="headerlink" title="集成Font Awesome"></a>集成Font Awesome</h3><p>在这儿遇到坑，记录下来： 首先安装npm包：</p><pre><code>npm install file-loader --save-dev</code></pre><p>引入<code>font-awesome</code>的<code>scss</code>文件 然后在<code>webpack.config.js</code>添加：</p><pre><code>module.exports = {    ...    module: {      rules: [       // other loaders       ...       {         test: /.(ttf|otf|eot|svg|woff(2)?)(\?[a-z0-9]+)?$/,         use: [{           loader: &apos;file-loader&apos;,           options: {             name: &apos;[name].[ext]&apos;,             outputPath: &apos;fonts/&apos;,    // where the fonts will go             publicPath: &apos;../&apos;       // override the default path           }         }]       },     ] // -rules    } // -module} // -module.exports</code></pre><p>这样就可以用了。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WebPack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Go命令</title>
      <link href="/go-command-notes.html"/>
      <url>/go-command-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>从终端写入<code>go</code>会输出下列信息：</p><pre><code>C:\Users\Jaxson&gt;goGo is a tool for managing Go source code.Usage:        go command [arguments]The commands are:        build       compile packages and dependencies        clean       remove object files and cached files        doc         show documentation for package or symbol        env         print Go environment information        bug         start a bug report        fix         update packages to use new APIs        fmt         gofmt (reformat) package sources        generate    generate Go files by processing source        get         download and install packages and dependencies        install     compile and install packages and dependencies        list        list packages        run         compile and run Go program        test        test packages        tool        run specified go tool        version     print Go version        vet         report likely mistakes in packagesUse &quot;go help [command]&quot; for more information about a command.Additional help topics:        c           calling between Go and C        buildmode   build modes        cache       build and test caching        filetype    file types        gopath      GOPATH environment variable        environment environment variables        importpath  import path syntax        packages    package lists        testflag    testing flags        testfunc    testing functionsUse &quot;go help [topic]&quot; for more information about that topic.</code></pre><p>不管怎么样首先都需要去了解它们的用处。</p><h3 id="go-build"><a href="#go-build" class="headerlink" title="go build"></a>go build</h3><p>这个命令主要用于编译代码。在包的编译过程中，若有必要，会同时编译与之相关联的包。</p><ul><li><p>如果是普通包，当你执行<code>go build</code>之后，它不会产生任何文件。如果你需要在<code>$GOPATH/pkg</code>下生成相应的文件，那就得执行<code>go install</code>。</p></li><li><p>如果是<code>main</code>包，当你执行<code>go build</code>之后，它就会在当前目录下生成一个可执行文件。如果你需要在<code>$GOPATH/bin</code>下生成相应的文件，需要执行<code>go install</code>，或者使用<code>go build -o 路径/a.exe</code>。</p></li><li><p>如果某个项目文件夹下有多个文件，而你只想编译某个文件，就可在<code>go build</code>之后加上文件名，例如<code>go build a.go</code>；<code>go build</code>命令默认会编译当前目录下的所有go文件。</p></li><li><p>你也可以指定编译输出的文件名。我们可以指定<code>go build -o astaxie.exe</code>，默认情况是你的package名(非main包)，或者是第一个源文件的文件名(main包)。 （注：实际上，package名在<a href="https://golang.org/ref/spec" target="_blank" rel="noopener">Go语言规范</a>中指代码中“package”后使用的名称，此名称可以与文件夹名不同。默认生成的可执行文件名是文件夹名。）</p></li><li><p>go build会忽略目录下以“_”或“.”开头的go文件。</p></li><li><p>如果你的源代码针对不同的操作系统需要不同的处理，那么你可以根据不同的操作系统后缀来命名文件。例如有一个读取数组的程序，它对于不同的操作系统可能有如下几个源文件： array_linux.go array_darwin.go array_windows.go array_freebsd.go <code>go build</code>的时候会选择性地编译以系统名结尾的文件（Linux、Darwin、Windows、Freebsd）。例如Linux系统下面编译只会选择array_linux.go文件，其它系统命名后缀文件全部忽略。</p></li></ul><p>参数的介绍</p><ul><li><code>-o</code> 指定输出的文件名，可以带上路径，例如 <code>go build -o a/b/c</code></li><li><code>-i</code> 安装相应的包，编译+<code>go install</code></li><li><code>-a</code> 更新全部已经是最新的包的，但是对标准包不适用</li><li><code>-n</code> 把需要执行的编译命令打印出来，但是不执行，这样就可以很容易的知道底层是如何运行的</li><li><code>-p n</code> 指定可以并行可运行的编译数目，默认是CPU数目</li><li><code>-race</code> 开启编译的时候自动检测数据竞争的情况，目前只支持64位的机器</li><li><code>-v</code> 打印出来我们正在编译的包名</li><li><code>-work</code> 打印出来编译时候的临时文件夹名称，并且如果已经存在的话就不要删除</li><li><code>-x</code> 打印出来执行的命令，其实就是和<code>-n</code>的结果类似，只是这个会执行</li><li><code>-ccflags &#39;arg list&#39;</code> 传递参数给5c, 6c, 8c 调用</li><li><code>-compiler name</code> 指定相应的编译器，gccgo还是gc</li><li><code>-gccgoflags &#39;arg list&#39;</code> 传递参数给gccgo编译连接调用</li><li><code>-gcflags &#39;arg list&#39;</code> 传递参数给5g, 6g, 8g 调用</li><li><code>-installsuffix suffix</code> 为了和默认的安装包区别开来，采用这个前缀来重新安装那些依赖的包，<code>-race</code>的时候默认已经是<code>-installsuffix race</code>,大家可以通过<code>-n</code>命令来验证</li><li><code>-ldflags &#39;flag list&#39;</code> 传递参数给5l, 6l, 8l 调用</li><li><code>-tags &#39;tag list&#39;</code> 设置在编译的时候可以适配的那些tag，详细的tag限制参考里面的 <a href="http://golang.org/pkg/go/build/" target="_blank" rel="noopener">Build Constraints</a></li></ul><h3 id="go-clean"><a href="#go-clean" class="headerlink" title="go clean"></a>go clean</h3><p>这个命令是用来移除当前源码包和关联源码包里面编译生成的文件。这些文件包括</p><pre><code>_obj/            旧的object目录，由Makefiles遗留_test/           旧的test目录，由Makefiles遗留_testmain.go     旧的gotest文件，由Makefiles遗留test.out         旧的test记录，由Makefiles遗留build.out        旧的test记录，由Makefiles遗留*.[568ao]        object文件，由Makefiles遗留DIR(.exe)        由go build产生DIR.test(.exe)   由go test -c产生MAINFILE(.exe)   由go build MAINFILE.go产生*.so             由 SWIG 产生</code></pre><p>我一般都是利用这个命令清除编译文件，然后github递交源码，在本机测试的时候这些编译文件都是和系统相关的，但是对于源码管理来说没必要。</p><pre><code>$ go clean -i -ncd /Users/astaxie/develop/gopath/src/mathapprm -f mathapp mathapp.exe mathapp.test mathapp.test.exe app app.exerm -f /Users/astaxie/develop/gopath/bin/mathapp</code></pre><p>参数介绍</p><ul><li><code>-i</code> 清除关联的安装的包和可运行文件，也就是通过go install安装的文件</li><li><code>-n</code> 把需要执行的清除命令打印出来，但是不执行，这样就可以很容易的知道底层是如何运行的</li><li><code>-r</code> 循环的清除在import中引入的包</li><li><code>-x</code> 打印出来执行的详细命令，其实就是<code>-n</code>打印的执行版本</li></ul><h3 id="go-fmt"><a href="#go-fmt" class="headerlink" title="go fmt"></a>go fmt</h3><p>有过C/C++经验的读者会知道,一些人经常为代码采取K&amp;R风格还是ANSI风格而争论不休。在go中，代码则有标准的风格。由于之前已经有的一些习惯或其它的原因我们常将代码写成ANSI风格或者其它更合适自己的格式，这将为人们在阅读别人的代码时添加不必要的负担，所以go强制了代码格式（比如左大括号必须放在行尾），不按照此格式的代码将不能编译通过，为了减少浪费在排版上的时间，go工具集中提供了一个<code>go fmt</code>命令 它可以帮你格式化你写好的代码文件，使你写代码的时候不需要关心格式，你只需要在写完之后执行<code>go fmt &lt;文件名&gt;.go</code>，你的代码就被修改成了标准格式，但是我平常很少用到这个命令，因为开发工具里面一般都带了保存时候自动格式化功能，这个功能其实在底层就是调用了<code>go fmt</code>。接下来的一节我将讲述两个工具，这两个工具都自带了保存文件时自动化<code>go fmt</code>功能。 使用go fmt命令，其实是调用了gofmt，而且需要参数-w，否则格式化结果不会写入文件。gofmt -w -l src，可以格式化整个项目。 所以go fmt是gofmt的上层一个包装的命令，我们想要更多的个性化的格式化可以参考 <a href="http://golang.org/cmd/gofmt/" target="_blank" rel="noopener">gofmt</a> gofmt的参数介绍</p><ul><li><code>-l</code> 显示那些需要格式化的文件</li><li><code>-w</code> 把改写后的内容直接写入到文件中，而不是作为结果打印到标准输出。</li><li><code>-r</code> 添加形如“a[b:len(a)] -&gt; a[b:]”的重写规则，方便我们做批量替换</li><li><code>-s</code> 简化文件中的代码</li><li><code>-d</code> 显示格式化前后的diff而不是写入文件，默认是false</li><li><code>-e</code> 打印所有的语法错误到标准输出。如果不使用此标记，则只会打印不同行的前10个错误。</li><li><code>-cpuprofile</code> 支持调试模式，写入相应的cpufile到指定的文件</li></ul><h3 id="go-get"><a href="#go-get" class="headerlink" title="go get"></a>go get</h3><p>这个命令是用来动态获取远程代码包的，目前支持的有BitBucket、GitHub、Google Code和Launchpad。这个命令在内部实际上分成了两步操作：第一步是下载源码包，第二步是执行<code>go install</code>。下载源码包的go工具会自动根据不同的域名调用不同的源码工具，对应关系如下：</p><pre><code>BitBucket (Mercurial Git)GitHub (Git)Google Code Project Hosting (Git, Mercurial, Subversion)Launchpad (Bazaar)</code></pre><p>所以为了<code>go get</code> 能正常工作，你必须确保安装了合适的源码管理工具，并同时把这些命令加入你的PATH中。其实<code>go get</code>支持自定义域名的功能，具体参见<code>go help remote</code>。 参数介绍：</p><ul><li><code>-d</code> 只下载不安装</li><li><code>-f</code> 只有在你包含了<code>-u</code>参数的时候才有效，不让<code>-u</code>去验证import中的每一个都已经获取了，这对于本地fork的包特别有用</li><li><code>-fix</code> 在获取源码之后先运行fix，然后再去做其他的事情</li><li><code>-t</code> 同时也下载需要为运行测试所需要的包</li><li><code>-u</code> 强制使用网络去更新包和它的依赖包</li><li><code>-v</code> 显示执行的命令</li></ul><h3 id="go-install"><a href="#go-install" class="headerlink" title="go install"></a>go install</h3><p>这个命令在内部实际上分成了两步操作：第一步是生成结果文件(可执行文件或者.a包)，第二步会把编译好的结果移到<code>$GOPATH/pkg</code>或者<code>$GOPATH/bin</code>。 参数支持<code>go build</code>的编译参数。大家只要记住一个参数<code>-v</code>就好了，这个随时随地的可以查看底层的执行信息。</p><h3 id="go-test"><a href="#go-test" class="headerlink" title="go test"></a>go test</h3><p>执行这个命令，会自动读取源码目录下面名为<code>*_test.go</code>的文件，生成并运行测试用的可执行文件。输出的信息类似</p><pre><code>ok   archive/tar   0.011sFAIL archive/zip   0.022sok   compress/gzip 0.033s...</code></pre><p>默认的情况下，不需要任何的参数，它会自动把你源码包下面所有test文件测试完毕，当然你也可以带上参数，详情请参考<code>go help testflag</code> 这里我介绍几个我们常用的参数：</p><ul><li><code>-bench regexp</code> 执行相应的benchmarks，例如 <code>-bench=.</code></li><li><code>-cover</code> 开启测试覆盖率</li><li><code>-run regexp</code> 只运行regexp匹配的函数，例如 <code>-run=Array</code> 那么就执行包含有Array开头的函数</li><li><code>-v</code> 显示测试的详细命令</li></ul><h3 id="go-tool"><a href="#go-tool" class="headerlink" title="go tool"></a>go tool</h3><p><code>go tool</code>下面下载聚集了很多命令，这里我们只介绍两个，fix和vet</p><ul><li><code>go tool fix .</code> 用来修复以前老版本的代码到新版本，例如go1之前老版本的代码转化到go1,例如API的变化</li><li><code>go tool vet directory|files</code> 用来分析当前目录的代码是否都是正确的代码,例如是不是调用fmt.Printf里面的参数不正确，例如函数里面提前return了然后出现了无用代码之类的。</li></ul><h3 id="go-generate"><a href="#go-generate" class="headerlink" title="go generate"></a>go generate</h3><p>这个命令是从Go1.4开始才设计的，用于在编译前自动化生成某类代码。<code>go generate</code>和<code>go build</code>是完全不一样的命令，通过分析源码中特殊的注释，然后执行相应的命令。这些命令都是很明确的，没有任何的依赖在里面。而且大家在用这个之前心里面一定要有一个理念，这个<code>go generate</code>是给你用的，不是给使用你这个包的人用的，是方便你来生成一些代码的。 这里我们来举一个简单的例子，例如我们经常会使用<code>yacc</code>来生成代码，那么我们常用这样的命令：</p><pre><code>go tool yacc -o gopher.go -p parser gopher.y</code></pre><p>-o 指定了输出的文件名， -p指定了package的名称，这是一个单独的命令，如果我们想让<code>go generate</code>来触发这个命令，那么就可以在当然目录的任意一个<code>xxx.go</code>文件里面的任意位置增加一行如下的注释：</p><pre><code>//go:generate go tool yacc -o gopher.go -p parser gopher.y</code></pre><p>这里我们注意了，<code>//go:generate</code>是没有任何空格的，这其实就是一个固定的格式，在扫描源码文件的时候就是根据这个来判断的。 所以我们可以通过如下的命令来生成，编译，测试。如果<code>gopher.y</code>文件有修改，那么就重新执行<code>go generate</code>重新生成文件就好。</p><pre><code>$ go generate$ go build$ go test</code></pre><h3 id="godoc"><a href="#godoc" class="headerlink" title="godoc"></a>godoc</h3><p>在Go1.2版本之前还支持<code>go doc</code>命令，但是之后全部移到了godoc这个命令下，需要这样安装<code>go get golang.org/x/tools/cmd/godoc</code> 很多人说go不需要任何的第三方文档，例如chm手册之类的（其实我已经做了一个了，<a href="https://github.com/astaxie/godoc" target="_blank" rel="noopener">chm手册</a>），因为它内部就有一个很强大的文档工具。 如何查看相应package的文档呢？ 例如builtin包，那么执行<code>godoc builtin</code> 如果是http包，那么执行<code>godoc net/http</code> 查看某一个包里面的函数，那么执行<code>godoc fmt Printf</code> 也可以查看相应的代码，执行<code>godoc -src fmt Printf</code> 通过命令在命令行执行 godoc -http=:端口号 比如<code>godoc -http=:8080</code>。然后在浏览器中打开<code>127.0.0.1:8080</code>，你将会看到一个golang.org的本地copy版本，通过它你可以查询pkg文档等其它内容。如果你设置了GOPATH，在pkg分类下，不但会列出标准包的文档，还会列出你本地<code>GOPATH</code>中所有项目的相关文档，这对于经常被墙的用户来说是一个不错的选择。</p><h3 id="其它命令"><a href="#其它命令" class="headerlink" title="其它命令"></a>其它命令</h3><p>go还提供了其它很多的工具，例如下面的这些工具</p><pre><code>go version 查看go当前的版本go env 查看当前go的环境变量go list 列出当前全部安装的packagego run 编译并运行Go程序</code></pre><p>以上这些工具还有很多参数没有一一介绍，用户可以使用<code>go help 命令</code>获取更详细的帮助信息。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Go基本安装</title>
      <link href="/golang-basic-installation.html"/>
      <url>/golang-basic-installation.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>之前一直对Go语言抱着很大的兴趣，趁现在有时间从头好好学习遍。</p><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>官网对Go解释是：”Go is an open source programming language that makes it easy to build simple, reliable, and efficient software.”，那么翻译中文是：“Go是一种开源编程语言，可以轻松构建简单，可靠且高效的软件。” 似乎这句话很大众话，好像没啥感觉，那么来个更详细的解释： Go是一种新的语言，一种并发的、带垃圾回收的、快速编译的语言。它具有以下特点：</p><ul><li>它可以在一台计算机上用几秒钟的时间编译一个大型的Go程序。</li><li>Go为软件构造提供了一种模型，它使依赖分析更加容易，且避免了大部分C风格include文件与库的开头。</li><li>Go是静态类型的语言，它的类型系统没有层级。因此用户不需要在定义类型之间的关系上花费时间，这样感觉起来比典型的面向对象语言更轻量级。</li><li>Go完全是垃圾回收型的语言，并为并发执行与通信提供了基本的支持。</li><li>按照其设计，Go打算为多核机器上系统软件的构造提供一种方法。</li></ul><p>Go是一种编译型语言，它结合了解释型语言的游刃有余，动态类型语言的开发效率，以及静态类型的安全性。它也打算成为现代的，支持网络与多核计算的语言。要满足这些目标，需要解决一些语言上的问题：一个富有表达能力但轻量级的类型系统，并发与垃圾回收机制，严格的依赖规范等等。这些无法通过库或工具解决好，因此Go也就应运而生了。 如果你需要了解更多的关于Go的基本信息可以去<a href="https://zh.wikipedia.org/wiki/Go" target="_blank" rel="noopener">维基百科</a>查看信息，本文不再做更多描述。 Go官方网站：<a href="https://golang.org" target="_blank" rel="noopener">https://golang.org</a> Go官网文档：<a href="https://golang.org/doc" target="_blank" rel="noopener">https://golang.org/doc</a> 既然想去了解，那么上面俩个地址不得不去访问了解下。</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>使用Go很简单，你只需要安装它的编译器就可以使用了： 首先你需要到<a href="https://golang.org/dl/" target="_blank" rel="noopener">下载地址</a>下载你所用的系统安装包，点击安装即可。</p><h5 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h5><p>如果是<code>zip</code>解压的需要配置下环境变量，此过程不再描述。如果是<code>msi</code>安装包他会自动配置你的环境编辑，检验你的是否正常使用只需要你打开<code>cmd</code>或者<code>powershell</code>输入：</p><pre><code>PS C:\Users\Jaxson&gt; go versiongo version go1.10.2 windows/amd64</code></pre><p>返回该系统版本信息则正常！</p><h5 id="Unix"><a href="#Unix" class="headerlink" title="Unix"></a>Unix</h5><p>从官网下载<code>zip</code>压缩包解压到<code>/usr/local/go</code>即可：</p><pre><code>tar -C /usr/local -xzf go$VERSION.$OS-$ARCH.tar.gz</code></pre><p>添加/usr/local/go/bin到PATH环境变量：</p><pre><code>export PATH=$PATH:/usr/local/go/bin</code></pre><blockquote><p>有些命名需要root权限，请根据情况添加<code>sudo</code>执行</p></blockquote><h5 id="GOPATH设置"><a href="#GOPATH设置" class="headerlink" title="GOPATH设置"></a>GOPATH设置</h5><p>仅仅安装好了是不够的我们还需要配置一些东西：<code>GOPATH</code> Go从1.1版本到1.7必须设置这个变量，而且不能和Go的安装目录一样，这个目录用来存放Go源码，Go的可运行文件，以及相应的编译之后的包文件。所以这个目录下面有三个子目录：src、bin、pkg 从go 1.8开始，GOPATH环境变量现在有一个默认值，如果它没有被设置。 它在Unix上默认为<code>$HOME/go</code>,在Windows上默认为<code>%USERPROFILE%/go</code>。 如果你的是Unix环境需要：</p><pre><code>export GOPATH=/home/apple/GoWork</code></pre><p>那么Windows你需要新建一个环境变量名称叫做GOPATH：</p><pre><code>GOPATH=F:\GoWork</code></pre><p>GOPATH允许多个目录，当有多个目录时，请注意分隔符，多个目录的时候Windows是分号，Linux系统是冒号，当有多个GOPATH时，默认会将go get的内容放在第一个目录下。 以上 $GOPATH 目录约定有三个子目录：</p><ul><li>src 存放源代码（比如：.go .c .h .s等）</li><li>pkg 编译后生成的文件（比如：.a）</li><li>bin 编译后生成的可执行文件（为了方便，可以把此目录加入到 $PATH 变量中，如果有多个gopath，那么使用<code>${GOPATH//://bin:}/bin</code>添加所有的bin目录）</li></ul><h3 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h3><p>当你配置好了，我们进行下一步的构建一个简单的实例去检查是否正常。 在你的上文的<code>GOPATH</code>新建个<code>src/hello/hello.go</code>文件，内容如下：</p><pre><code>package mainimport &quot;fmt&quot;func main() {    fmt.Printf(&quot;hello, world\n&quot;)}</code></pre><p>然后使用终端进入该文件夹，并且构建编译：</p><pre><code>C:\&gt; cd %USERPROFILE%\go\src\helloC:\Users\Gopher\go\src\hello&gt; go build</code></pre><p>当你看到该目录下有个<code>hello.exe</code>可执行文件。继续在终端执行：</p><pre><code>C:\Users\Gopher\go\src\hello&gt; hellohello, world</code></pre><p>则会输出<code>hello world</code>。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Go </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Wp StackEdit：或许这是你想要的编辑器</title>
      <link href="/wordpress-plugins-wp-stackedit.html"/>
      <url>/wordpress-plugins-wp-stackedit.html</url>
      
        <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><blockquote><p>Unrivalled writing experience 无与伦比的写作体验</p></blockquote><p><a href="https://i.loli.net/2018/04/14/5ad0dfeed57bd.png" target="_blank" rel="noopener"><img src="https://i.loli.net/2018/04/14/5ad0dfeed57bd.png" alt="stackedit-demo.png"></a> 这是一个WordPress平台上Markdown编辑器插件，它的特点很轻便，功能更易用！  当你下载的时候，你会惊奇的发现压缩包很小，<code>100kb</code>不到的插件可以完美体验出写作的快感吗？我很负责的告诉你：能！</p><h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><h6 id="强大的Markdown编辑器"><a href="#强大的Markdown编辑器" class="headerlink" title="强大的Markdown编辑器"></a>强大的Markdown编辑器</h6><p>StackEdit的markdown语法突出显示是独一无二的，它会帮助你从最初文本格式最终渲染成丰富的文章格式！</p><h6 id="WYSIWYG控件"><a href="#WYSIWYG控件" class="headerlink" title="WYSIWYG控件"></a>WYSIWYG控件</h6><p>StackEditt提供了非常方便的格式化按钮和快捷键，这归功于PageDown，并且灵感来自Stack Overflow站点wysiwyg样式。</p><h6 id="智能布局"><a href="#智能布局" class="headerlink" title="智能布局"></a>智能布局</h6><p>无论是写作，审阅，评论…StackEdit的布局随时为你展示！</p><h6 id="实时滚动预览"><a href="#实时滚动预览" class="headerlink" title="实时滚动预览"></a>实时滚动预览</h6><p>StackEdit的滚动同步功能可以精确地绑定编辑器面板和预览面板的滚动条，以确保在写入时始终关注输出。（奥，绝对不会再是Wp-Editor.md那个糟糕的体验！）</p><h3 id="扩展支持"><a href="#扩展支持" class="headerlink" title="扩展支持"></a>扩展支持</h3><p><strong>该扩展支持功能暂未实现，请耐心等我的开发</strong></p><h6 id="来自Github风格的Markdown语法"><a href="#来自Github风格的Markdown语法" class="headerlink" title="来自Github风格的Markdown语法"></a>来自Github风格的Markdown语法</h6><p>StackEdit支持不同风格的markdown语法，例如Markdown Extra, GFM 和 CommonMark。当然你可以随时禁用或者启用它们。</p><h6 id="LaTeX科学公式体验"><a href="#LaTeX科学公式体验" class="headerlink" title="LaTeX科学公式体验"></a>LaTeX科学公式体验</h6><p>你喜欢科学公式吗？它和StackEdit带来更美妙的体验！</p><h6 id="UML图标"><a href="#UML图标" class="headerlink" title="UML图标"></a>UML图标</h6><p>StackEdit能够使用简单的语法编写序列图和流程图。</p><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>目前还在测试中，如果你需要体验的话可以加QQ群：<a href="http://shang.qq.com/wpa/qunwpa?idkey=d68582245ccb7ac1c01499d0c5863624d56ee214f7816b0eedfbe3a12915e530" target="_blank" rel="noopener">猫窝</a> 如果你不想添加，你可以从这里<a href="http://iiong.com/WP-StackEdit-v0.4-test.zip" target="_blank" rel="noopener">下载</a>插件体验，但版本更新比较慢。 等插件稳定后我会提交到WordPress 插件库。</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>本地Web环境支持SSL</title>
      <link href="/local-web-environment-supports-ssl.html"/>
      <url>/local-web-environment-supports-ssl.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在开发一个项目中，发现Chrome浏览器给我扔一个错误：</p><pre><code>Uncaught (in promise) SecurityError: Only secure origins are allowed (see: https://goo.gl/Y0ZkNV).</code></pre><p>大致翻译下是<code>只允许安全的来源</code>，看来非ssl协议是不给加载前端资源的。 无奈只好想办法去支持了。</p><h3 id="生成证书"><a href="#生成证书" class="headerlink" title="生成证书"></a>生成证书</h3><p>我安装的是<code>WinNMP</code>一键环境包：<code>Nginx + MariaDB + Redis + PHP</code>环境。 首先生成证书，我用的是子系统去生产的。当然你可以安装<a href="http://slproweb.com/products/Win32OpenSSL.html" target="_blank" rel="noopener">openssl</a>进行安装</p><ol><li><p>使用openssl生成密钥privkey.pem：</p><p>openssl genrsa -des3 -out server.key 2048</p></li></ol><ol start="2"><li><p>使用密钥生成证书server.pem：</p><p>openssl req -new -key server.key -out server.csr</p></li></ol><p>以下是控制台信息：</p><pre><code>PS C:\Users\Jaxson\Desktop&gt; openssl req -new -key server.key -out server.csrEnter pass phrase for server.key:You are about to be asked to enter information that will be incorporatedinto your certificate request.What you are about to enter is what is called a Distinguished Name or a DN.There are quite a few fields but you can leave some blankFor some fields there will be a default value,If you enter &apos;.&apos;, the field will be left blank.-----Country Name (2 letter code) [AU]:CNState or Province Name (full name) [Some-State]:JaxsonWangLocality Name (eg, city) []:HuaiAnOrganization Name (eg, company) [Internet Widgits Pty Ltd]:Jaxson ITOrganizational Unit Name (eg, section) []:Jaxson ITCommon Name (e.g. server FQDN or YOUR name) []:localhostEmail Address []:wangjin@boxrom.comPlease enter the following &apos;extra&apos; attributesto be sent with your certificate requestA challenge password []:extraAn optional company name []:localhost</code></pre><ol start="3"><li><p>而这个密码会带来一个副作用，那就是在每次Nginx启动Web服务器时，都会要求输入密码，这显然非常不方便，所以为们删除这个密码:</p><p>openssl rsa -in server.key -out server_no_passwd.key</p></li></ol><ol start="4"><li><p>生成证书：</p><p>openssl x509 -req -days 365 -in server.csr -signkey server_no_passwd.key -out server.crt</p></li></ol><p>得到的证书就是一个可以使用的ssl证书了</p><h3 id="配置nginx"><a href="#配置nginx" class="headerlink" title="配置nginx"></a>配置nginx</h3><pre><code>server {        listen       443;        #填写和证书上一直的域名        server_name  www.test.com;        ssl on;        ssl_certificate server.crt;        ssl_certificate_key server_no_passwd.key;        ssl_session_timeout 5m;        ssl_prefer_server_ciphers on;        location / {            root   html;            index  index.html index.htm;        }    }</code></pre><p>重启Nginx服务器即可。</p><h3 id="信任证书"><a href="#信任证书" class="headerlink" title="信任证书"></a>信任证书</h3><p>重启后打开地址发现不安全提示： <img src="https://i.loli.net/2018/04/05/5ac5ecba76a6f.png" alt> 这时候需要去信任证书。</p><ol><li><p>F12打开控制器到<code>Security</code>窗口导出证书，选项<code>PKCS #7, single certificate</code>即可： <img src="https://i.loli.net/2018/04/05/5ac5eeab88f92.png" alt="2.png"></p></li><li><p>系统安装导出的证书，安装选择如图： <img src="https://i.loli.net/2018/04/05/5ac5f041ca001.png" alt="5.png"></p></li></ol><p>导入信任需要<code>受信任的根证书颁发机构</code> 这样IE和斯巴达以及火狐浏览器可以访问ssl协议了</p><h3 id="Chrome配置"><a href="#Chrome配置" class="headerlink" title="Chrome配置"></a>Chrome配置</h3><p>很无奈在Chrome测试失败，只好下个工具：<a href="https://github.com/Fishdrowned/ssl" target="_blank" rel="noopener">自签泛域名证书</a> 然后还是不管用，Chrome很蛋疼，暂时没有办法去解决，只好拿别的浏览器去测试~</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SSL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>23</title>
      <link href="/twenty-three.html"/>
      <url>/twenty-three.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://i.loli.net/2018/04/06/5ac64a359f38c.jpg" alt="IMG_0026.JPG"></p><blockquote><p>世间好物不坚牢，彩云易散琉璃脆。</p></blockquote><p>如果今天不是我的生日，那该多好呀！或许未来的今天，至少哀悼今天的一切。 过完23年生日，相对于今日，却如此悲痛，一度以为，这仅仅是个玩笑，扶着发昏的头脑，却不知何如去做。 时间是个神奇的东西，你越是不在意，它总是溜溜的过。一眨眼又到清明节，所谓清明雨纷纷，也无法磨灭心中火热。 从22岁到23岁，依然成熟了不少，毕竟一直在进步，希望未来的日子里永远保持住今日的脚步。 同样在深夜，面对显示屏，心里默念：王瑾，祝你生日快乐。今日所发生的一切，希望使你更加强大。 傻孩子，这个坑，无非比去年大一些，勇敢的去面对吧！ <a href="https://iiong.com/twenty-two.html" target="_blank" rel="noopener">22</a></p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>前端RSA加密数据</title>
      <link href="/rsa-encrypted-data-notes.html"/>
      <url>/rsa-encrypted-data-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>由于业务需求，做好系统安全性，所以在登录密码数据费了心。 我使用的RSA非对称加密，意思前端使用公钥来加密数据，然后把数据发送到服务器，服务器获取到的数据再使用私钥来解密这个数据。</p><h3 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h3><p>前端需要<a href="https://github.com/travist/jsencrypt" target="_blank" rel="noopener">jsencrypt</a>库，下载引入即可。 该库的<a href="http://travistidwell.com/jsencrypt/demo/index.html" target="_blank" rel="noopener">http://travistidwell.com/jsencrypt/demo/index.html</a> 如果不会获取公钥私钥可以在demo复制粘贴即可。 当然你可以手动生成(需要安装<code>openssl</code>支持)：</p><pre><code>openssl genrsa -out rsa_1024_priv.pem 1024 // 生成1024位私钥openssl rsa -pubout -in rsa_1024_priv.pem -out rsa_1024_pub.pem // 生成对应公钥</code></pre><p>实例如下：</p><pre><code>&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;    &lt;title&gt;JavaScript RSA Encryption&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;label for=&quot;privkey&quot;&gt;私钥&lt;/label&gt;&lt;br/&gt;&lt;textarea id=&quot;privkey&quot; rows=&quot;15&quot; cols=&quot;65&quot;&gt;-----BEGIN RSA PRIVATE KEY-----MIICXQIBAAKBgQDlOJu6TyygqxfWT7eLtGDwajtNFOb9I5XRb6khyfD1Yt3YiCgQWMNW649887VGJiGr/L5i2osbl8C9+WJTeucF+S76xFxdU6jE0NQ+Z+zEdhUTooNRaY5nZiu5PgDB0ED/ZKBUSLKL7eibMxZtMlUDHjm4gwQco1KRMDSmXSMkDwIDAQABAoGAfY9LpnuWK5Bs50UVep5c93SJdUi82u7yMx4iHFMc/Z2hfenfYEzu+57fI4fvxTQ//5DbzRR/XKb8ulNv6+CHyPF31xk7YOBfkGI8qjLoq06V+FyBfDSwL8KbLyeHm7KUZnLNQbk8yGLzB3iYKkRHlmUanQGaNMIJziWOkN+N9dECQQD0ONYRNZeuM8zd8XJTSdcIX4a3gy3GGCJxOzv16XHxD03GW6UNLmfPwenKu+cdrQeaqEixrCejXdAFz/7+BSMpAkEA8EaSOeP5Xr3ZrbiKzi6TGMwHMvC7HdJxaBJbVRfApFrE0/mPwmP5rN7QwjrMY+0+AbXcm8mRQyQ1+IGEembsdwJBAN6az8Rv7QnD/YBvi52POIlRSSIMV7SwWvSK4WSMnGb1ZBbhgdg57DXaspcwHsFV7hByQ5BvMtIduHcT14ECfcECQATeaTgjFnqE/lQ22Rk0eGaYO80cc643BXVGafNfd9fcvwBMnk0iGX0XRsOozVt5AzilpsLBYuApa66NcVHJpCECQQDTjI2AQhFc1yRnCU/YgDnSpJVm1nASoRUnU8Jfm3Ozuku7JUXcVpt08DFSceCEX9unCuMcT72rAQlLpdZir876-----END RSA PRIVATE KEY-----&lt;/textarea&gt;&lt;br/&gt;&lt;label for=&quot;pubkey&quot;&gt;公钥&lt;/label&gt;&lt;br/&gt;&lt;textarea id=&quot;pubkey&quot; rows=&quot;15&quot; cols=&quot;65&quot;&gt;-----BEGIN PUBLIC KEY-----MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDlOJu6TyygqxfWT7eLtGDwajtNFOb9I5XRb6khyfD1Yt3YiCgQWMNW649887VGJiGr/L5i2osbl8C9+WJTeucF+S76xFxdU6jE0NQ+Z+zEdhUTooNRaY5nZiu5PgDB0ED/ZKBUSLKL7eibMxZtMlUDHjm4gwQco1KRMDSmXSMkDwIDAQAB-----END PUBLIC KEY-----&lt;/textarea&gt;&lt;br/&gt;&lt;label for=&quot;input&quot;&gt;文本:&lt;/label&gt;&lt;br/&gt;&lt;textarea id=&quot;input&quot; name=&quot;input&quot; type=&quot;text&quot; rows=4 cols=70&gt;This is a test!&lt;/textarea&gt;&lt;br/&gt;&lt;input id=&quot;testme&quot; type=&quot;button&quot; value=&quot;运行&quot;/&gt;&lt;br/&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;assets/vendors/jquery/dist/jquery.min.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;assets/jsencrypt/jsencrypt.min.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot;&gt;    $(function () {        $(&apos;#testme&apos;).click(function () {            //使用公钥加密            var encrypt = new JSEncrypt(),                input = $(&apos;#input&apos;);            encrypt.setPublicKey($(&apos;#pubkey&apos;).val());            var encrypted = encrypt.encrypt(input.val());            console.log( &quot;加密的数据：&quot; + encrypted );            //使用私钥解密            var decrypt = new JSEncrypt();            decrypt.setPrivateKey($(&apos;#privkey&apos;).val());            var uncrypted = decrypt.decrypt(encrypted);            console.log( &quot;解密的数据：&quot; + uncrypted );            //检验            if (uncrypted === input.val()) {                alert(&apos;成功&apos;);            }            else {                alert(&apos;失败&apos;);            }        });    });&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><h3 id="PHP实例"><a href="#PHP实例" class="headerlink" title="PHP实例"></a>PHP实例</h3><pre><code>&lt;?phpfunction uncrypted( $data ) {    //定义私钥    $private_key = &apos;-----BEGIN RSA PRIVATE KEY-----MIICXQIBAAKBgQDlOJu6TyygqxfWT7eLtGDwajtNFOb9I5XRb6khyfD1Yt3YiCgQWMNW649887VGJiGr/L5i2osbl8C9+WJTeucF+S76xFxdU6jE0NQ+Z+zEdhUTooNRaY5nZiu5PgDB0ED/ZKBUSLKL7eibMxZtMlUDHjm4gwQco1KRMDSmXSMkDwIDAQABAoGAfY9LpnuWK5Bs50UVep5c93SJdUi82u7yMx4iHFMc/Z2hfenfYEzu+57fI4fvxTQ//5DbzRR/XKb8ulNv6+CHyPF31xk7YOBfkGI8qjLoq06V+FyBfDSwL8KbLyeHm7KUZnLNQbk8yGLzB3iYKkRHlmUanQGaNMIJziWOkN+N9dECQQD0ONYRNZeuM8zd8XJTSdcIX4a3gy3GGCJxOzv16XHxD03GW6UNLmfPwenKu+cdrQeaqEixrCejXdAFz/7+BSMpAkEA8EaSOeP5Xr3ZrbiKzi6TGMwHMvC7HdJxaBJbVRfApFrE0/mPwmP5rN7QwjrMY+0+AbXcm8mRQyQ1+IGEembsdwJBAN6az8Rv7QnD/YBvi52POIlRSSIMV7SwWvSK4WSMnGb1ZBbhgdg57DXaspcwHsFV7hByQ5BvMtIduHcT14ECfcECQATeaTgjFnqE/lQ22Rk0eGaYO80cc643BXVGafNfd9fcvwBMnk0iGX0XRsOozVt5AzilpsLBYuApa66NcVHJpCECQQDTjI2AQhFc1yRnCU/YgDnSpJVm1nASoRUnU8Jfm3Ozuku7JUXcVpt08DFSceCEX9unCuMcT72rAQlLpdZir876-----END RSA PRIVATE KEY-----&apos;;    if ( ! $privateKey = openssl_pkey_get_private( $private_key ) ) {        return false;    }    // decrypt    $decrypted = &apos;&apos;;    if ( ! openssl_private_decrypt( base64_decode( $data ), $decrypted, $privateKey ) ) {        return false;    }    // free the private key    openssl_free_key( $privateKey );    return $decrypted;}echo uncrypted(&apos;Q0mgwQyuoJh3aczzQ3bVe3fDDpzLE522cXLHlI7FGCcC3Z86Zhl63IbaFe+R5pCykpsm5hmiek+k/6WGh0JhbHWNiCLDYn67uFObbpct+3rVrsVykPuEWu4aeXE2NPb+qW/1cL7KM8j9oLvbQXsf5vhh18eUH6ygIcWBAqhLIy8=&apos;);</code></pre><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>大体步骤就是这样的，对于私钥和公钥，特别是私钥要存储好，别让人获取到。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Web前端 </tag>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Axios.js上手和动态Axios配置</title>
      <link href="/axios-js-get-started-and-dynamic-axios-configuration.html"/>
      <url>/axios-js-get-started-and-dynamic-axios-configuration.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>由于项目需要用到Axios.js库，就搜索相关资料了解下。看起来还不错~ 之前在某社区日刊推荐看到的，今天可算了解下这个库强大之处。</p><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>Axios 是一个基于 promise 的 HTTP 库，可以用在浏览器和 node.js 中。</p><ul><li>从浏览器中创建 XMLHttpRequests</li><li>从 node.js 创建 http 请求</li><li>支持 Promise API</li><li>拦截请求和响应</li><li>转换请求数据和响应数据</li><li>取消请求</li><li>自动转换 JSON 数据</li><li>客户端支持防御 XSRF</li></ul><p>引入方式：</p><pre><code>npm install axiosbower install axios&lt;script src=&quot;https://unpkg.com/axios/dist/axios.min.js&quot;&gt;&lt;/script&gt;</code></pre><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p>执行<code>get</code>请求：</p><pre><code>// 为给定 ID 的 user 创建请求axios.get(&apos;/user?ID=12345&apos;)  .then(function (response) {    console.log(response);  })  .catch(function (error) {    console.log(error);  });// 可选地，上面的请求可以这样做axios.get(&apos;/user&apos;, {    params: {      ID: 12345    }  })  .then(function (response) {    console.log(response);  })  .catch(function (error) {    console.log(error);  });// `async`决定异步或者同步async function getUser() {  try {    const response = await axios.get(&apos;/user?ID=12345&apos;);    console.log(response);  } catch (error) {    console.error(error);  }}</code></pre><blockquote><p>async / await是ECMAScript 2017的一部分，在Internet Explorer和老版本版浏览器中不支持，因此请谨慎使用。</p></blockquote><p>执行<code>POST</code>请求：</p><pre><code>axios.post(&apos;/user&apos;, {    firstName: &apos;Fred&apos;,    lastName: &apos;Flintstone&apos;  })  .then(function (response) {    console.log(response);  })  .catch(function (error) {    console.log(error);  });</code></pre><p>执行多个并发请求：</p><pre><code>function getUserAccount() {  return axios.get(&apos;/user/12345&apos;);}function getUserPermissions() {  return axios.get(&apos;/user/12345/permissions&apos;);}axios.all([getUserAccount(), getUserPermissions()])  .then(axios.spread(function (acct, perms) {    // 俩个请求已完成  }));</code></pre><h3 id="动态Axios配置"><a href="#动态Axios配置" class="headerlink" title="动态Axios配置"></a>动态Axios配置</h3><p>创建文件，Vue项目初始化之后，在src目录下再创建一个util工具文件夹，一般就是用来存放一些封装的函数方法，现在让我们在util文件目录下创建一个http.js文件，封装axios方法。 常规版本：</p><pre><code>import axios from &apos;axios&apos; //引用axiosimport {Promise} from &apos;es6-promise&apos;   //引入Promise// axios 配置axios.defaults.timeout = 5000;  //设置超时时间axios.defaults.baseURL = &apos;http://localhost:4000/api/v1/&apos;; //这是调用数据接口// http request 拦截器（所有发送的请求都要从这儿过一次），通过这个，我们就可以把token传到后台，我这里是使用sessionStorage来存储token等权限信息和用户信息，若要使用cookie可以自己封装一个函数并import便可使用axios.interceptors.request.use(    config =&gt; {        const token = sessionStorage.getItem(&quot;token&quot;); //获取存储在本地的token        config.data = JSON.stringify(config.data);        config.headers = {            &apos;Content-Type&apos;:&apos;application/json&apos; //设置跨域头部,虽然很多浏览器默认都是使用json传数据，但咱要考虑IE浏览器。        };        if (token) {            config.headers.Authorization = &quot;Token &quot; + token; //携带权限参数        }        return config;    },    err =&gt; {        return Promise.reject(err);    });// http response 拦截器（所有接收到的请求都要从这儿过一次）axios.interceptors.response.use(    response =&gt; {//response.status===401是我和后台约定的权限丢失或者权限不够返回的状态码，这个可以自己和后台约定，约定返回某个自定义字段也是可以的        if(response.status == 401) {            router.push({ //push后面是一个参数对象，可以携带很多参数，具体可以去vue-router上查看，例如query字段表示携带的参数                path: &apos;/login&apos;             })        }        return response;    },    error =&gt; {        return Promise.reject(error.response.data)    });export default axios;/** * fetch 请求方法 * @param url * @param params * @returns {Promise} */export function fetch(url, params = {}) {    return new Promise((resolve, reject) =&gt; {        axios.get(url, {            params: params        })        .then(response =&gt; {            resolve(response.data);        })        .catch(err =&gt; {            reject(err)        })    })}/** * post 请求方法 * @param url * @param data * @returns {Promise} */export function post(url, data = {}) {    return new Promise((resolve, reject) =&gt; {        axios.post(url, data)            .then(response =&gt; {                resolve(response.data);            }, err =&gt; {                reject(err);            })    })}/** * patch 方法封装 * @param url * @param data * @returns {Promise} */export function patch(url, data = {}) {    return new Promise((resolve, reject) =&gt; {        axios.patch(url, data)            .then(response =&gt; {                resolve(response.data);            }, err =&gt; {                reject(err);            })    })}/** * put 方法封装 * @param url * @param data * @returns {Promise} */export function put(url, data = {}) {    return new Promise((resolve, reject) =&gt; {        axios.put(url, data)            .then(response =&gt; {                resolve(response.data);            }, err =&gt; {                reject(err);            })    })}</code></pre><p>由于axios的拦截器不是必要的，不是每个项目都需要，而且headers里面的Content-Type和Authorization不止一种，这时就需要使用另一种方法，动态版（util/http.js）：</p><pre><code>import axios from &apos;axios&apos; //引用axiosimport {Promise} from &apos;es6-promise&apos;   //引入Promise// axios 配置和拦截器都不用了，这里我使用了一个动态配置数据请求地址，在App.vue中，代码在下面，这个也不是必须的。//^_^下面都设置一个默认的头部，使用的时候可以传入数据覆盖^_^,例如使用fetch(GET)方法时，没有请求数据，但是请求头有变化，则应写成 fetch(&quot;地址&quot;, {}, {&quot;这里写头部的内容&quot;})   记住没数据用一个空对象占位置/** * fetch 请求方法 * @param url * @param params * @returns {Promise} */export function fetch(url, params = {}, headers = {    &apos;Content-Type&apos;: &apos;application/json&apos;, //设置跨域头部    &quot;Authorization&quot;: &apos;JWT &apos; + sessionStorage.getItem(&quot;authToken&quot;)}) {    return new Promise((resolve, reject) =&gt; {        axios.get(url, {            params: params,            headers: headers        })        .then(response =&gt; {            resolve(response.data);        })        .catch(err =&gt; {            reject(err.response)        })    })}/** * post 请求方法 * @param url * @param data * @returns {Promise} */export function post(url, data = {}, config = {    &quot;headers&quot;: {        &apos;Content-Type&apos;: &apos;application/json&apos;, //设置跨域头部        &quot;Authorization&quot;: &apos;JWT &apos; + sessionStorage.getItem(&quot;authToken&quot;)    }}) {    return new Promise((resolve, reject) =&gt; {        axios.post(url, data, config)            .then(response =&gt; {                resolve(response.data);            }, err =&gt; {                reject(err.response);            })    })}/** * patch 方法封装 * @param url * @param data * @returns {Promise} */export function patch(url, data = {}, config = {    &quot;headers&quot;: {        &apos;Content-Type&apos;: &apos;application/json&apos;, //设置跨域头部        &quot;Authorization&quot;: &apos;JWT &apos; + sessionStorage.getItem(&quot;authToken&quot;)    }}) {    return new Promise((resolve, reject) =&gt; {        axios.patch(url, data, config)            .then(response =&gt; {                resolve(response.data);            }, err =&gt; {                reject(err.response);            })    })}/** * put 方法封装 * @param url * @param data * @returns {Promise} */export function put(url, data = {}, config = {    &quot;headers&quot;: {        &apos;Content-Type&apos;: &apos;application/json&apos;, //设置跨域头部        &quot;Authorization&quot;: &apos;JWT &apos; + sessionStorage.getItem(&quot;authToken&quot;)    }}) {    return new Promise((resolve, reject) =&gt; {        axios.put(url, data, config)            .then(response =&gt; {                resolve(response.data);            }, err =&gt; {                reject(err.response);            })    })}</code></pre><p>App.vue(这是在src目录下的程序入口文件):</p><pre><code>&lt;template&gt;  &lt;div id=&quot;app&quot;&gt;    &lt;router-view/&gt;  &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import axios from &apos;axios&apos;;let protocol = window.location.protocol; //协议let host = window.location.host; //主机let reg = /^localhost+/;if(reg.test(host)) {  //若本地项目调试使用  axios.defaults.baseURL = &apos;http://xx.xx.xx.xx:xxxx/api/&apos;;} else {  //动态请求地址  axios.defaults.baseURL = protocol + &quot;//&quot; + host + &quot;/api/&quot;;}axios.defaults.timeout = 30000;export default {  name: &apos;app&apos;,  axios   //这里记得导出，若请求地址永久固定一个，则就按照`普通版`配置一个baserURL就可以了}&lt;/script&gt;&lt;style lang=&quot;scss&quot;&gt;  //这里我使用的是scss@import &apos;~@/style/style&apos;&lt;/style&gt;</code></pre><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>在使用动态版时，为什么称为动态呢，是因为访问地址和请求地址是同一个地址可端口号，例如我通过<a href="http://www.xxxx.com(%E9%BB%98%E8%AE%A4%E7%AB%AF%E5%8F%A380" target="_blank" rel="noopener">http://www.xxxx.com(默认端口80)访问项目，那么我的baseURL会自动的变为http//:www.xxxx.com:80/api/，这么做的原因是当某一天项目迁移或者http改为https时，不用你再去更改请求地址，程序自动就完成了。</a>%E8%AE%BF%E9%97%AE%E9%A1%B9%E7%9B%AE%EF%BC%8C%E9%82%A3%E4%B9%88%E6%88%91%E7%9A%84baseURL%E4%BC%9A%E8%87%AA%E5%8A%A8%E7%9A%84%E5%8F%98%E4%B8%BAhttp//:<a href="http://www.xxxx.com:80/api/%EF%BC%8C%E8%BF%99%E4%B9%88%E5%81%9A%E7%9A%84%E5%8E%9F%E5%9B%A0%E6%98%AF%E5%BD%93%E6%9F%90%E4%B8%80%E5%A4%A9%E9%A1%B9%E7%9B%AE%E8%BF%81%E7%A7%BB%E6%88%96%E8%80%85http%E6%94%B9%E4%B8%BAhttps%E6%97%B6%EF%BC%8C%E4%B8%8D%E7%94%A8%E4%BD%A0%E5%86%8D%E5%8E%BB%E6%9B%B4%E6%94%B9%E8%AF%B7%E6%B1%82%E5%9C%B0%E5%9D%80%EF%BC%8C%E7%A8%8B%E5%BA%8F%E8%87%AA%E5%8A%A8%E5%B0%B1%E5%AE%8C%E6%88%90%E4%BA%86%E3%80%82" target="_blank" rel="noopener">www.xxxx.com:80/api/%EF%BC%8C%E8%BF%99%E4%B9%88%E5%81%9A%E7%9A%84%E5%8E%9F%E5%9B%A0%E6%98%AF%E5%BD%93%E6%9F%90%E4%B8%80%E5%A4%A9%E9%A1%B9%E7%9B%AE%E8%BF%81%E7%A7%BB%E6%88%96%E8%80%85http%E6%94%B9%E4%B8%BAhttps%E6%97%B6%EF%BC%8C%E4%B8%8D%E7%94%A8%E4%BD%A0%E5%86%8D%E5%8E%BB%E6%9B%B4%E6%94%B9%E8%AF%B7%E6%B1%82%E5%9C%B0%E5%9D%80%EF%BC%8C%E7%A8%8B%E5%BA%8F%E8%87%AA%E5%8A%A8%E5%B0%B1%E5%AE%8C%E6%88%90%E4%BA%86%E3%80%82</a>) 假如数据请求地址配置不正确，如果你配置了<code>baseURL</code>，那么你封装的函数在使用时仅需传入基于baseURL的请求地址，例如传入<code>login/</code>那么请求地址会自动变为<a href="http://www.xxxx.com:80/api/login/%EF%BC%8C%E8%8B%A5%E6%9C%AA%E9%85%8D%E7%BD%AE%EF%BC%8C%E9%82%A3%E4%B9%88%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E4%BC%A0%E5%85%A5%E6%95%B4%E4%B8%AA%E8%AF%B7%E6%B1%82%E5%9C%B0%E5%9D%80" target="_blank" rel="noopener">http://www.xxxx.com:80/api/login/，若未配置，那么可以直接传入整个请求地址</a> 在使用动态版时，由于没有使用拦截器，所以下面封装的函数在返回错误的时候需要写成<code>err.response.data</code>来获取返回的数据，但我写的是<code>err.response</code>，因为这样可以拿到(status)状态码等信息，若不需要判断返回的状态码，则改为<code>err.response.data</code>便可</p><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="https://github.com/axios/axios" target="_blank" rel="noopener">Axios Github</a></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Node.JS </tag>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CodeIgniter简单上手</title>
      <link href="/codeigniter-notes.html"/>
      <url>/codeigniter-notes.html</url>
      
        <content type="html"><![CDATA[<p>由于开发一套系统需要，经过朋友推荐<code>CodeIgniter</code> php框架，所以有了这次简单的快速上手教程。 官网地址：<a href="https://www.codeigniter.com" target="_blank" rel="noopener">https://www.codeigniter.com</a> 中文官网：<a href="https://codeigniter.org.cn" target="_blank" rel="noopener">https://codeigniter.org.cn</a> 中文文档：<a href="https://codeigniter.org.cn/user_guide" target="_blank" rel="noopener">https://codeigniter.org.cn/user_guide</a></p><h3 id="加载静态内容"><a href="#加载静态内容" class="headerlink" title="加载静态内容"></a>加载静态内容</h3><p>新建一个<strong>控制器</strong>来处理静态页面，控制器就是一个简单的类，它是整个 Web 应用程序的 “粘合剂” 。 例如，当访问下面这个 URL 时: <a href="http://example.com/news/latest/10" target="_blank" rel="noopener">http://example.com/news/latest/10</a> 通过这个 URL 就可以推测出来，有一个叫做 “news” 的控制器，被调用的方法为 “latest” ， 这个方法的作用应该是查询 10 条新闻条目并显示在页面上。在 MVC 模式里，会经常看到下面 格式的 URL ： <a href="http://example.com/%5Bcontroller-class%5D/%5Bcontroller-method%5D/%5Barguments%5D" target="_blank" rel="noopener">http://example.com/[controller-class]/[controller-method]/[arguments]</a> 新建一个文件 application/controllers/Pages.php：</p><pre><code>&lt;?phpclass Pages extends CI_Controller {    public function view($page = &apos;home&apos;)    {    }}</code></pre><p>创建了一个 Pages 类，有一个方法 view 并可接受一个 $page 参数。 Pages 类继承自 CI_Controller 类，这意味着它可以访问 CI_Controller 类（ system/core/Controller.php ）中定义的方法和变量。 新建页头文件 application/views/templates/header.php 并添加以下代码：</p><pre><code>&lt;html&gt;    &lt;head&gt;        &lt;title&gt;CodeIgniter Tutorial&lt;/title&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;h1&gt;&lt;?php echo $title; ?&gt;&lt;/h1&gt;</code></pre><p>再新建个页脚文件 application/views/templates/footer.php ，然后添加以下代码：</p><pre><code>        &lt;em&gt;&amp;copy; 2017&lt;/em&gt;    &lt;/body&gt;&lt;/html&gt;</code></pre><h3 id="在控制器中添加逻辑"><a href="#在控制器中添加逻辑" class="headerlink" title="在控制器中添加逻辑"></a>在控制器中添加逻辑</h3><p>刚刚新建了一个控制器，里面有一个 view() 方法，这个方法接受一个参数 用于指定要加载的页面，静态页面模板位于 application/views/pages/ 目录。 在该目录中，再新建两个文件 home.php 和 about.php ，在每个文件里随便 写点东西然后保存它们。 为了加载这些页面，需要先检查下请求的页面是否存在：</p><pre><code>public function view($page = &apos;home&apos;){  if ( ! file_exists(APPPATH.&apos;views/pages/&apos;.$page.&apos;.php&apos;))    {        // Whoops, we don&apos;t have a page for that!        show_404();    }    $data[&apos;title&apos;] = ucfirst($page); // Capitalize the first letter    $this-&gt;load-&gt;view(&apos;templates/header&apos;, $data);    $this-&gt;load-&gt;view(&apos;pages/&apos;.$page, $data);    $this-&gt;load-&gt;view(&apos;templates/footer&apos;, $data);}</code></pre><p>当请求的页面存在，将包括页面和页脚一起被加载并显示给用户，如果不存在， 会显示一个 “404 Page not found” 错误。 第一行检查页面是否存在，file_exists() 是个原生的 PHP 函数，用于检查某个 文件是否存在，show_404() 是个 CodeIgniter 内置的函数，用来显示一个默认的 错误页面。 在页头文件中，$title 变量用来自定义页面的标题，它是在这个方法中赋值的， 但是注意的是并不是直接赋值给 title 变量，而是赋值给一个 $data 数组的 title 元素。 最后要做的是按顺序加载所需的视图，view() 方法的第二个参数用于向视图传递参数， $data 数组中的每一项将被赋值给一个变量，这个变量的名字就是数组的键值。 所以控制器中 $data[‘title’] 的值，就等于视图中的 $title 的值。</p><h3 id="创建数据模型"><a href="#创建数据模型" class="headerlink" title="创建数据模型"></a>创建数据模型</h3><p>数据库的查询操作应该放在模型里，而不是写在控制器里，这样可以很方便的重用它。 模型正是用于从数据库或者其他存储中获取、新增、更新数据的地方。 打开 application/models/ 目录，新建一个文件 News_model.php ，然后写入下面的代码：</p><pre><code>&lt;?phpclass News_model extends CI_Model {    public function __construct()    {        $this-&gt;load-&gt;database();    }}</code></pre><p>在查询数据库之前，要先创建一个数据库表。连接的数据库，运行下面的 SQL 语句（MySQL），并添加一些测试数据：</p><pre><code>CREATE TABLE news (    id int(11) NOT NULL AUTO_INCREMENT,    title varchar(128) NOT NULL,    slug varchar(128) NOT NULL,    text text NOT NULL,    PRIMARY KEY (id),    KEY slug (slug));NSERT INTO `news` (`id`, `title`, `slug`, `text`) VALUES(1, &apos;好世界&apos;, &apos;you&apos;, &apos;这是内容这是内容这是内容这是内容这是内容这是内容这是内容这是内容这是内容这是内容这是内容这是内容这是内容这是内容这是内容&apos;),(2, &apos;Hello World&apos;, &apos;me&apos;, &apos;This is content.This is content.This is content.This is content.This is content.This is content.This is content.This is content.This is content.This is content.This is content.This is content.This is content.This is content.&apos;);</code></pre><p>通过这个代码，可以执行两种不同的查询，一种是获取所有的新闻条目，另一种 是根据它的 slug 来获取新闻条目。应该注意到，$slug 变量在执行查询之前 并没有做检查， 查询构造器 会自动帮检查的。</p><h3 id="显示新闻"><a href="#显示新闻" class="headerlink" title="显示新闻"></a>显示新闻</h3><p>查询已经写好了，接下来需要将模型绑定到视图上，向用户显示新闻条目了。 这可以在之前写的 Pages 控制器里来做，但为了更清楚的阐述，定义了一个新的 News 控制器，创建在 application/controllers/News.php 文件中：</p><pre><code>&lt;?phpclass News extends CI_Controller {    public function __construct()    {        parent::__construct();        $this-&gt;load-&gt;model(&apos;news_model&apos;);        $this-&gt;load-&gt;helper(&apos;url_helper&apos;);    }    public function index()    {        $data[&apos;news&apos;] = $this-&gt;news_model-&gt;get_news();    }    public function view($slug = NULL)    {        $data[&apos;news_item&apos;] = $this-&gt;news_model-&gt;get_news($slug);    }}</code></pre><p>首先是 __construct() 方法，它调用父类（CI_Controller）中的构造函数，并加载模型。这样模型就可以 在这个控制器的其他方法中使用了。另外它还加载了 URL 辅助函数 ， 因为在后面的视图中会用到它。 其次，有两个方法用来显示新闻条目，一个显示所有的，另一个显示特定的。 可以看到第二个方法中调用模型方法时传入了 $slug 参数，模型根据这个 slug 返回特定的新闻条目。 现在，通过模型，控制器已经获取到数据了，但还没有显示。下一步要做的就是， 将数据传递给视图：</p><pre><code>public function index(){    $data[&apos;news&apos;] = $this-&gt;news_model-&gt;get_news();    $data[&apos;title&apos;] = &apos;News archive&apos;;    $this-&gt;load-&gt;view(&apos;templates/header&apos;, $data);    $this-&gt;load-&gt;view(&apos;news/index&apos;, $data);    $this-&gt;load-&gt;view(&apos;templates/footer&apos;);}</code></pre><p>上面的代码从模型中获取所有的新闻条目，并赋值给一个变量，另外页面的标题赋值给了 $data[‘title’] 元素，然后所有的数据被传递给视图。现在需要创建一个视图文件来 显示新闻条目了，新建 application/views/news/index.php 文件并添加如下代码：</p><pre><code>&lt;h2&gt;&lt;?php echo $title; ?&gt;&lt;/h2&gt;&lt;?php foreach ($news as $news_item): ?&gt;    &lt;h3&gt;&lt;?php echo $news_item[&apos;title&apos;]; ?&gt;&lt;/h3&gt;    &lt;div class=&quot;main&quot;&gt;        &lt;?php echo $news_item[&apos;text&apos;]; ?&gt;    &lt;/div&gt;    &lt;p&gt;&lt;a href=&quot;&lt;?php echo site_url(&apos;news/view/&apos;.$news_item[&apos;slug&apos;]); ?&gt;&quot;&gt;View article&lt;/a&gt;&lt;/p&gt;&lt;?php endforeach; ?&gt;</code></pre><p>新闻的列表页就做好了，但是还缺了显示特定新闻条目的页面，之前创建的模型可以很容易的 实现该功能，只需要向控制器中添加一些代码，然后再新建一个视图就可以了。回到 News 控制器，使用下面的代码替换掉 view() 方法：</p><pre><code>public function view($slug = NULL){    $data[&apos;news_item&apos;] = $this-&gt;news_model-&gt;get_news($slug);    if (empty($data[&apos;news_item&apos;]))    {        show_404();    }    $data[&apos;title&apos;] = $data[&apos;news_item&apos;][&apos;title&apos;];    $this-&gt;load-&gt;view(&apos;templates/header&apos;, $data);    $this-&gt;load-&gt;view(&apos;news/view&apos;, $data);    $this-&gt;load-&gt;view(&apos;templates/footer&apos;);}</code></pre><p>并没有直接调用 get_news() 方法，而是传入了一个 $slug 参数， 所以它会返回相应的新闻条目。最后剩下的事是创建视图文件 application/views/news/view.php 并添加如下代码：</p><pre><code>&lt;?phpecho &apos;&lt;h2&gt;&apos;.$news_item[&apos;title&apos;].&apos;&lt;/h2&gt;&apos;;echo $news_item[&apos;text&apos;];</code></pre><h3 id="创建新闻条目"><a href="#创建新闻条目" class="headerlink" title="创建新闻条目"></a>创建新闻条目</h3><p>为了向数据库中写入数据，需要先创建一个表单用来填写要存储的信息，这意味着 的表单里需要包含两项：一项代表标题，另一项代表内容。可以在模型中通过代码 从标题中提取出 slug。在文件 application/views/news/create.php 中创建一个新视图：</p><pre><code>&lt;h2&gt;&lt;?php echo $title; ?&gt;&lt;/h2&gt;&lt;?php echo validation_errors(); ?&gt;&lt;?php echo form_open(&apos;news/create&apos;); ?&gt;    &lt;label for=&quot;title&quot;&gt;Title&lt;/label&gt;    &lt;input type=&quot;input&quot; name=&quot;title&quot; /&gt;&lt;br /&gt;    &lt;label for=&quot;text&quot;&gt;Text&lt;/label&gt;    &lt;textarea name=&quot;text&quot;&gt;&lt;/textarea&gt;&lt;br /&gt;    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Create news item&quot; /&gt;&lt;/form&gt;</code></pre><p>这里有两个地方可能还不熟悉：form_open() 函数 以及 validation_errors() 函数。 第一个函数是由 表单辅助函数 提供的，用于生成 form 元素，并添加一些额外的功能，如添加一个隐藏的 CSRF 保护字段 , 第二个函数用于显示表单验证的错误信息。 回到的 News 控制器，将要在这里做两件事：检查表单是否被提交，以及提交的数据是否能通过验证规则。 可以使用 表单验证类 来做到这一点。</p><pre><code>public function create()    {        $this-&gt;load-&gt;helper(&apos;form&apos;);        $this-&gt;load-&gt;library(&apos;form_validation&apos;);        $data[&apos;title&apos;] = &apos;Create a news item&apos;;        $this-&gt;form_validation-&gt;set_rules(&apos;title&apos;, &apos;Title&apos;, &apos;required&apos;);        $this-&gt;form_validation-&gt;set_rules(&apos;text&apos;, &apos;Text&apos;, &apos;required&apos;);        if ($this-&gt;form_validation-&gt;run() === FALSE)        {            $this-&gt;load-&gt;view(&apos;templates/header&apos;, $data);            $this-&gt;load-&gt;view(&apos;news/create&apos;);            $this-&gt;load-&gt;view(&apos;templates/footer&apos;);        }        else        {            $this-&gt;news_model-&gt;set_news();            $this-&gt;load-&gt;view(&apos;news/success&apos;);        }    }</code></pre><p>上面的代码添加了不少功能，前几行代码加载了 表单辅助函数 和 表单验证类。然后，设置了表单验证规则， set_rules() 方法有三个参数：表单中字段的名称，错误信息中使用的名称，以及验证规则。在这个例子中， 规则为 title 和 text 字段是必填的。 接下来，可以看到一个判断条件检查表单验证是否成功通过，如果没有通过，将显示出表单， 如果通过了验证，则会调用模型。然后，加载视图显示出成功信息。新建一个视图文件 application/views/news/success.php 并写上成功的信息：</p><pre><code>&lt;?phpecho &quot;成功&quot;;</code></pre><p>写一个方法将数据保存到数据库中，将会使用 输入类 获取用户提交的数据， 并使用 查询构造器类 向数据库中插入数据。打开之前创建的模型文件，添加以下代码：</p><pre><code>public function set_news(){    $this-&gt;load-&gt;helper(&apos;url&apos;);    $slug = url_title($this-&gt;input-&gt;post(&apos;title&apos;), &apos;dash&apos;, TRUE);    $data = array(        &apos;title&apos; =&gt; $this-&gt;input-&gt;post(&apos;title&apos;),        &apos;slug&apos; =&gt; $slug,        &apos;text&apos; =&gt; $this-&gt;input-&gt;post(&apos;text&apos;)    );    return $this-&gt;db-&gt;insert(&apos;news&apos;, $data);}</code></pre><p>新加的这个方法用于向数据库插入数据，第三行有一个新方法 url_title() ， 这个方法由 URL 辅助函数 提供，用于将字符串 中的所有空格替换成连接符（-），并将所有字符转换为小写。 这样其实就生成了一个 slug ，可以很好的用于创建 URI 。 然后继续准备将要被插入到数据库中的记录，将其赋值给 $data 数组， 数组中的每一项都对应之前创建的数据库表中的一列，这里应该看到又出现了一个新方法， 来自 输入类 的 post() 方法，这个方法可以对数据进行过滤， 防止其他人的恶意攻击。输入类默认已经加载了。最后，将 $data 数组插入到的数据库中。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2017年总结以及新年计划</title>
      <link href="/2017-summed-and-2018-plan.html"/>
      <url>/2017-summed-and-2018-plan.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>新的一年这样过来了，对我来说，只是一眨眼时间罢了！ 2017年太安稳了，以至于以为才过了半年。</p><h3 id="生活和工作"><a href="#生活和工作" class="headerlink" title="生活和工作"></a>生活和工作</h3><p>无论是生活还是工作，都是太安稳，没有大城市的快节奏。我想在淮安这么个小城市，我习惯了，也开始喜欢这个节奏，对于之前的苏州或者北京亦上海大城市，我都不喜欢了。 这一年下来，光工作我已经跳槽就四家了，说到底，我喜欢相对比较有情怀的公司和讲信用的公司。目前所在的公司各方面都不错，以后以后安安稳稳在这儿上班吧！ 因为安稳我放弃了很多自我学习的机会，平时休息时间基本不是出去玩就是在家泡剧，很少去学习东西。希望今年多少要改善这样的情况。 从去年夏天谈了一段感情，至今为止也小半年了，我知道很短，甚至没走过更多的考验，无论前面有多大的坎坷，我想和她手把手走下去。因为，爱一个人不容易，希望能够保持自己的本心，我相信现在如此浮夸的世界会有真爱的。 计划是今年买车的，看来因为对象无法决定购买房子居住地，所以只能到明年再说了。既然买不了房，那么车子就要今年买，从来没来过得计划买个便宜的，以后成为老司机再说～ 回顾头来，2017年我拥有俩段感情，一个是失败的自恋，一个是人生唯一拥有的爱情，这俩段感情间距很短，但是我2017年最精彩的时刻！ 附去年计划 <a href="https://iiong.com/2016-summed-and-2017-plan.html" target="_blank" rel="noopener">2016年总结和新年计划</a> 一路看下来，也就俩个坑没填，23333。</p><h3 id="计划"><a href="#计划" class="headerlink" title="计划"></a>计划</h3><ul><li>购买一部车(15w左右)</li><li>好好维护感情</li><li>稳当上班，好好工作</li><li>调节身体</li><li>编写开源浏览器编辑器JavaScript库</li><li>学习PHP</li><li>深度学习Node.js</li></ul><blockquote><p>今年尽量少挖点坑…</p></blockquote><h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><p>新的一年来了，骚年你还记得去年的本心吗？如果记得请继续保持！ 新年快乐！</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>WordPress Material主题说明</title>
      <link href="/wordpress-material-instructions.html"/>
      <url>/wordpress-material-instructions.html</url>
      
        <content type="html"><![CDATA[<h3 id="主题简介"><a href="#主题简介" class="headerlink" title="主题简介"></a>主题简介</h3><p>WordPress Material是一款现代化响应式个人博客展示付费主题，能在PC、Pad、Phone等设备完整展示博客信息，同时具备强大的现代化设计美感——Google Material design</p><h3 id="主题适用"><a href="#主题适用" class="headerlink" title="主题适用"></a>主题适用</h3><p>文艺兼程序员人群，轻新闻资讯平台站点，代码展示站点等</p><h3 id="主题框架"><a href="#主题框架" class="headerlink" title="主题框架"></a>主题框架</h3><p>WordPress Material使用多种开源框架： 前端资源： <a href="https://cdn.rawgit.com/FezVrasta/bootstrap-material-design/gh-pages-v3/index.html" target="_blank" rel="noopener">BootStrap Material Design</a>（响应式框架） <a href="https://github.com/FortAwesome/Font-Awesome" target="_blank" rel="noopener">Font Awesome</a>（字体矢量图标） <a href="http://prismjs.com" target="_blank" rel="noopener">PrismJS</a>（语法高亮） <a href="https://github.com/samthor/rippleJS" target="_blank" rel="noopener">RippleJS</a>（Material Design组件） <a href="https://github.com/FezVrasta/snackbarjs" target="_blank" rel="noopener">SnackbarJS</a>（Material Design组件） 主题选项框架： <a href="https://github.com/aristath/kirki" target="_blank" rel="noopener">Customizer</a>（精简版）<a href="https://github.com/aristath/kirki" target="_blank" rel="noopener"></a></p><h3 id="主题展示"><a href="#主题展示" class="headerlink" title="主题展示"></a>主题展示</h3><p>布局参考：<a href="http://demos.creative-tim.com/material-kit-pro/presentation.html" target="_blank" rel="noopener">点击跳转</a> <a href="https://picabstract-preview-ftn.weiyun.com:8443/ftn_pic_abs_v2/4110b8647f2e50095bb49208472095d50659c2892c64bb43aa7dcf2db2c43708c014b907c43279ecc24e24491f98fc16?pictype=scale&amp;from=30013&amp;fname=1.png&amp;size=750" target="_blank" rel="noopener">点击查看</a> <a href="https://picabstract-preview-ftn.weiyun.com:8443/ftn_pic_abs_v2/e7538b40ee3480a00b82bedc1d7e4f4245706d3236b502162c8137a156128033dbbf1e5d1013f87101dc561e07d9d2dc?pictype=scale&amp;from=30013&amp;fname=2.png&amp;size=750" target="_blank" rel="noopener">点击查看</a> <a href="https://picabstract-preview-ftn.weiyun.com:8443/ftn_pic_abs_v2/a2c680c93566b04f88d7abea57a6bb960430eb22cd9768681fb34f1025bf2ee11507ee728dc926ef4851640f9e952248?pictype=scale&amp;from=30013&amp;fname=3.png&amp;size=750" target="_blank" rel="noopener">点击查看</a> 更多展示可以到本站查看！ 后台设置展示页： <a href="https://picabstract-preview-ftn.weiyun.com:8443/ftn_pic_abs_v2/184f5bd89145839d4c26bc7207a6123c0dcab837a55b93d8517da092d6f5661838333fa37e447c43df0b9ae153cc9241?pictype=scale&amp;from=30013&amp;fname=QQ%E6%88%AA%E5%9B%BE20180204225413.png&amp;size=750" target="_blank" rel="noopener">点击查看</a></p><h3 id="主题使用"><a href="#主题使用" class="headerlink" title="主题使用"></a>主题使用</h3><h3 id="主题获取"><a href="#主题获取" class="headerlink" title="主题获取"></a>主题获取</h3><p>即日起主题原价129元售价103元，有意者请添加QQ1466469024购买。 活动到18.02.22结束，价格修改为299元！ <strong>即日起价格为159元人民币</strong> 获取地址：<a href="http://url.cn/5LwHvxI" target="_blank" rel="noopener">http://url.cn/5LwHvxI</a></p><h3 id="主题清单"><a href="#主题清单" class="headerlink" title="主题清单"></a>主题清单</h3><p>Material主题一份 激活密匙一份 主题生命周期售后</p><h3 id="其他说明"><a href="#其他说明" class="headerlink" title="其他说明"></a>其他说明</h3><p>购买主题后二年内保持更新，保证一星期小更新一次，一个月更新大功能一次。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WordPress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EMD Vol 1801</title>
      <link href="/emd-vol-1801.html"/>
      <url>/emd-vol-1801.html</url>
      
        <content type="html"><![CDATA[<h3 id="2018-01-30"><a href="#2018-01-30" class="headerlink" title="2018.01.30"></a>2018.01.30</h3><p>临时补个文章，节奏太快，没赶上月记的节奏。</p><h3 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h3><p>现在目前上的公司，逐渐稳定下来，谈不上轻松也谈不上繁忙，只是有些很奇怪的感觉。 偶尔打开某些朋友的QQ群，说实话很羡慕他们在大城市奋斗，年轻人是应该磨练一番，虽然来到淮安小城市俩年了，并非毫无改变，至少现在的确比一年前的我厉害多了。 说到工作，这俩个月在公司编写代码，发现有些设计强迫，看来还是改变自己的某些编码习惯，否则后期只能给自己挖坑填不上了。</p><h3 id="家事"><a href="#家事" class="headerlink" title="家事"></a>家事</h3><p>家里倒是安逸多了，现在还是一个人住在外面，习惯了一个人。双休有的时候想打电话给家里，无奈忙了会又忘了，到深夜才想起却不能再打，怕打扰人休息。 有次家里打电话询问买房的事情，问的是选择买房地点，家里的意思是在远在苏州购买房子，说白了家里人大部分人包括亲戚都在苏州，也差不多户口迁走了吧。意思以后搬过去相互好关注，所以这是一回事，那么另外一回事就是女朋友的原因了，说到底她才是关键点… 讲心里话我还是乐意留在苏州的，无论是经济，环境，教育等各个方面完全完爆淮安，毕竟人往高处走。其实我也想给自己和未来（孩子）创建更大的提升空间，有时候发现呆在淮安有些东西限制得很死，例如资料传播等… 看来房子的事情还得留到明年再说咯，今年就算是决定下来，一时买不了。</p><h3 id="感情"><a href="#感情" class="headerlink" title="感情"></a>感情</h3><p>和女朋友谈了210天了，没想到时间过得很快，大概在11月份之前，我们基本三天一小吵，五天一大吵，现在想想没分简直是奇迹，难道是磨合期么？挺过来也不容易的。大概11月开始，应该是我对她态度有所改变，或许是我太生硬了。曾经有个朋友说过，哄女朋友是一个男人必备技能，在此之前我不会去哄，所以各种惹女朋友生气…</p><blockquote><p>情侣吵架最容易陷入对错争论，最后因为什么吵不重要，谁先认错才重要。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>探索两种优雅的表单验证</title>
      <link href="/explore-two-elegant-forms-validation.html"/>
      <url>/explore-two-elegant-forms-validation.html</url>
      
        <content type="html"><![CDATA[<p>在一个Web项目中，注册，登录，修改用户信息，下订单等功能的实现都离不开提交表单。这篇文章就阐述了如何编写相对看着舒服的表单验证代码。 假设我们正在编写一个注册的页面，在点击注册按钮之前，有如下几条校验逻辑。 所有选项不能为空 用户名长度不能少于6位 密码长度不能少于6位 手机号码必须符合格式 邮箱地址必须符合格式 注：为简单起见，以下例子以传统的浏览器表单验证，Ajax异步请求不做探讨，浏览器端验证原理图： <img src="https://iiong.com/wp-content/uploads/2018/01/17ecba5c31d55133de614ba4478a76c7_0060lm7Tly1fnt538pl1zj30dz063dfy1.jpg" alt></p><h3 id="简要说明："><a href="#简要说明：" class="headerlink" title="简要说明："></a>简要说明：</h3><p>这里我们前端只做浏览器端的校验。很多工具可以在表单检验过后、浏览器发送请求前截取表单数据，攻击者可以修改请求中的数据，从而绕过 JavaScript，将恶意数据注入服务器，这样会增加XSS（全称 Cross Site Scripting）攻击的机率。对于一般的网站，都不赞成采用浏览器端的表单验证方法。浏览器端和服务器端双重验证方法在浏览器端验证方法基础上增加服务器端的验证，其原理如图所示，该方法增加服务器端的验证，弥补了传统浏览器端验证的缺点。若表单输入不符合要求，浏览器端的 Javascript 验证能很快地给出响应，而服务器端的验证则可以防止恶意用户绕过 Javascript 验证，保证最终数据的准确性。 HTML代码：</p><pre><code>&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;meta charset=&quot;utf-8&quot;&gt;    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;    &lt;title&gt;探索几种表单验证最佳实践方式&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;form action=&quot;http://xxx.com/register&quot; id=&quot;registerForm&quot; method=&quot;post&quot;&gt;        &lt;div class=&quot;form-group&quot;&gt;            &lt;label for=&quot;user&quot;&gt;请输入用户名:&lt;/label&gt;            &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;user&quot; name=&quot;userName&quot;&gt;        &lt;/div&gt;        &lt;div class=&quot;form-group&quot;&gt;            &lt;label for=&quot;pwd&quot;&gt;请输入密码:&lt;/label&gt;            &lt;input type=&quot;password&quot; class=&quot;form-control&quot; id=&quot;pwd&quot; name=&quot;passWord&quot;&gt;        &lt;/div&gt;        &lt;div class=&quot;form-group&quot;&gt;            &lt;label for=&quot;phone&quot;&gt;请输入手机号码:&lt;/label&gt;            &lt;input type=&quot;tel&quot; class=&quot;form-control&quot; id=&quot;phone&quot; name=&quot;phoneNumber&quot;&gt;        &lt;/div&gt;        &lt;div class=&quot;form-group&quot;&gt;            &lt;label for=&quot;email&quot;&gt;请输入邮箱:&lt;/label&gt;            &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;email&quot; name=&quot;emailAddress&quot;&gt;        &lt;/div&gt;        &lt;button type=&quot;button&quot; class=&quot;btn btn-default&quot;&gt;Submit&lt;/button&gt;    &lt;/form&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>JavaScript代码：</p><pre><code>let registerForm = document.querySelector(&apos;#registerForm&apos;)  registerForm.addEventListener(&apos;submit&apos;, function() {      if (registerForm.userName.value === &apos;&apos;) {          alert(&apos;用户名不能为空！&apos;)          return false      }      if (registerForm.userName.length &lt; 6) {          alert(&apos;用户名长度不能少于6位！&apos;)          return false      }      if (registerForm.passWord.value === &apos;&apos;) {          alert(&apos;密码不能为空！&apos;)          return false      }      if (registerForm.passWord.value.length &lt; 6) {          alert(&apos;密码长度不能少于6位！&apos;)          return false      }      if (registerForm.phoneNumber.value === &apos;&apos;) {          alert(&apos;手机号码不能为空！&apos;)          return false      }      if (!/^1(3|5|7|8|9)[0-9]{9}$/.test(registerForm.phoneNumber.value)) {          alert(&apos;手机号码格式不正确！&apos;)          return false      }      if (registerForm.emailAddress.value === &apos;&apos;) {          alert(&apos;邮箱地址不能为空！&apos;)          return false      }      if (!/^\w+([+-.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*      $/.test(registerForm.emailAddress.value)) {          alert(&apos;邮箱地址格式不正确！&apos;)          return false      }  }, false)</code></pre><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>这样编写代码，的确能够完成业务的需求，能够完成表单的验证，但是存在很多问题，比如： <code>registerForm.addEventListener</code>绑定的函数比较庞大，包含了很多的if-else语句，看着都恶心，这些语句需要覆盖所有的校验规则。 <code>registerForm.addEventListener</code>绑定的函数缺乏弹性，如果增加了一种新的校验规则，或者想要把密码的长度校验从6改成8，我们都必须深入<code>registerForm.addEventListener</code>绑定的函数的内部实现，这是违反了开放-封闭原则的。 算法的复用性差，如果程序中增加了另一个表单，这个表单也需要进行一些类似的校验，那我们很可能将这些校验逻辑复制得漫天遍野。 所谓办法总比问题多，办法是有的，比如马上要讲解的使用 策略模式 使表单验证更优雅更完美，我相信很多人很抵触设计模式，一听设计模式就觉得很遥远，觉得自己在工作中很少用到设计模式，那么你就错了，特别是JavaScript这种灵活的语言，有的时候你已经在你的代码中使用了设计模式，只是你不知道而已。更多关于设计模式的东西，以后会陆续写博客描述，这里只希望大家抛弃设计模式神秘的感觉，通俗的讲，它无非就是完成一件事情通用的办法而已。</p><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>回到正题，假如我们不想使用过多的 if - else 语句，那么我们心中比较理想的代码编写方式是什么呢？我们能不能像编写配置一样的去做表单验证呢？再来一个”一键验证“的功能，是不是很爽？答案是肯定的，所以我们心中理想的编写代码的方式如下：</p><pre><code>// 获取表单form元素let registerForm = document.querySelector(&apos;#registerForm&apos;)// 创建表单校验实例let validator = new Validator();// 编写校验配置validator.add(registerForm.userName, &apos;isNonEmpty&apos;, &apos;用户名不能为空&apos;)validator.add(registerForm.userName, &apos;minLength:6&apos;, &apos;用户名长度不能小于6&apos;)// 开始校验，并接收错误信息let errorMsg = validator.start()// 如果有错误信息输出，说明校验未通过if(errorMsg){    alert(errorMsg)    return false//阻止表单提交}</code></pre><p>怎么样？感受感受，是不是看上去优雅多了？好了，有了这些思路，我们就可以向目标迈进了，下一步就要了解了解什么事策略模式了。</p><h3 id="策略模式"><a href="#策略模式" class="headerlink" title="策略模式"></a>策略模式</h3><p>策略模式，单纯的看它的名字”策略“，指的是做事情的方法，比如我们想到某个地方旅游，你可以有几种策略供选择： 1、飞机，嗖嗖嗖直接就到了，节省时间。 2、火车，可以选择高铁出行，专为飞机恐惧症者提供。 3、徒步，不失为一个锻炼身体的选择。 4、other method…… 在程序设计中，我们也经常遇到类似的情况，要实现一种方案有多种方案可以选择，比如，一个压缩文件的程序，即可选择zip算法，也可以选择gzip算法。 所以，做一件事你会有很多方法，也就是所谓的策略，而我们今天要讲的策略模式也就是这个意思，它的核心思想是，将做什么和谁去做相分离。所以，一个完整的策略模式要有两个类，一个是策略类，一个是环境类(主要类)，环境类接收请求，但不处理请求，它会把请求委托给策略类，让策略类去处理，而策略类的扩展是很容易的，这样，使得我们的代码易于扩展。 在表单验证的例子中，各种验证的方法组成了策略类，比如：判断是否为空的方法(如：isNonEmpty)，判断最小长度的方法(如：minLength)，判断是否为手机号的方法(isMoblie)等等，他们组成了策略类，供给环境类去委托请求。下面，我们就来实战一下。</p><h3 id="用策略模式重构表单校验"><a href="#用策略模式重构表单校验" class="headerlink" title="用策略模式重构表单校验"></a>用策略模式重构表单校验</h3><p>策略模式的组成 抽象策略角色：策略类，通常由一个接口或者抽象类实现。 具体策略角色：包装了相关的算法和行为。 环境角色：持有一个策略类的引用，最终给客户端用的。 4.1具体策略角色——编写策略类 策略类很简单，它是由一组验证方法组成的对象，即策略对象，重构表单校验的代码，很显然第一步我们要把这些校验逻辑都封装成策略对象：</p><pre><code>/*策略对象*/const strategies = {        isNonEmpty(value, errorMsg) {            return value === &apos;&apos; ?                errorMsg : void 0        },        minLength(value, length, errorMsg) {            return value.length &lt; length ?                errorMsg : void 0        },        isMoblie(value, errorMsg) {            return !/^1(3|5|7|8|9)[0-9]{9}$/.test(value) ?                errorMsg : void 0        },        isEmail(value, errorMsg) {            return !/^\w+([+-.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(value) ?                errorMsg : void 0        }    }</code></pre><h3 id="抽象策略角色——编写Validator类"><a href="#抽象策略角色——编写Validator类" class="headerlink" title="抽象策略角色——编写Validator类"></a>抽象策略角色——编写Validator类</h3><p>根据我们的思考，我们使用add方法添加验证配置，如下：</p><pre><code>validator.add(registerForm.userName, &apos;isNonEmpty&apos;, &apos;用户名不能为空&apos;)validator.add(registerForm.userName, &apos;minLength:6&apos;, &apos;用户名长度不能小于6&apos;)</code></pre><p>add方法接受三个参数，第一个参数是表单字段，第二个参数是策略对象中策略方法的名字，第三个参数是验证未通过的错误信息。 然后使用 start 方法开始验证，若验证未通过，返回验证错误信息，如下：</p><pre><code>let errorMsg = validator.start()</code></pre><p>另外，再解释一下下面这句代码： add方法第一个参数我们说过了，是要验证的表单元素，第二个参数是一个字符串，使用 冒号(:) 分割，前面是策略方法名称，后面是传给这个方法的参数，第三个参数仍然是错误信息。 但是这种参数配置还是有问题，我们的要求是多种校验规则，比如用户名既不能为空，又要满足用户名长度不小于6，并不是单一的，上面的为什么要写两次，这种看着就不舒服，这时候我就需要对配置参数做一点小小的改动，我们用数组来传递多个校验规则：</p><pre><code>validator.add(registerForm.userName, [{        strategy: &apos;isNonEmpty&apos;,        errorMsg: &apos;用户名不能为空！&apos;    }, {        strategy: &apos;minLength:6&apos;,        errorMsg: &apos;用户名长度不能小于6位！&apos;    }])</code></pre><p>最后是Validator类的实现：</p><pre><code>/*Validator类*/class Validator {    constructor() {        this.cache = [] //保存校验规则    }    add(dom, rules) {        for (let rule of rules) {            let strategyAry = rule.strategy.split(&apos;:&apos;) //例如[&apos;minLength&apos;,6]            let errorMsg = rule.errorMsg //&apos;用户名不能为空&apos;            this.cache.push(() =&gt; {                let strategy = strategyAry.shift() //用户挑选的strategy                strategyAry.unshift(dom.value) //把input的value添加进参数列表                strategyAry.push(errorMsg) //把errorMsg添加进参数列表，[dom.value,6,errorMsg]                return strategies[strategy].apply(dom, strategyAry)            })        }    }    start() {        for (let validatorFunc of this.cache) {            let errorMsg = validatorFunc()//开始校验，并取得校验后的返回信息            if (errorMsg) {//r如果有确切返回值，说明校验没有通过                return errorMsg            }        }    }}</code></pre><h3 id="环境角色——客户端调用代码"><a href="#环境角色——客户端调用代码" class="headerlink" title="环境角色——客户端调用代码"></a>环境角色——客户端调用代码</h3><p>使用策略模式重构代码以后，我们仅仅通过‘配置’的方式就可以完成一个表单的校验，这些校验规则也可以复用在程序的任何地方，还能作为插件的形式，方便地被移植到其他项目中。</p><pre><code>/*客户端调用代码*/let registerForm = document.querySelector(&apos;#registerForm&apos;)const validatorFunc = () =&gt; {    let validator = new Validator()    validator.add(registerForm.userName, [{        strategy: &apos;isNonEmpty&apos;,        errorMsg: &apos;用户名不能为空！&apos;    }, {        strategy: &apos;minLength:6&apos;,        errorMsg: &apos;用户名长度不能小于6位！&apos;    }])    validator.add(registerForm.passWord, [{        strategy: &apos;isNonEmpty&apos;,        errorMsg: &apos;密码不能为空！&apos;    }, {        strategy: &apos;minLength:&apos;,        errorMsg: &apos;密码长度不能小于6位！&apos;    }])    validator.add(registerForm.phoneNumber, [{        strategy: &apos;isNonEmpty&apos;,        errorMsg: &apos;手机号码不能为空！&apos;    }, {        strategy: &apos;isMoblie&apos;,        errorMsg: &apos;手机号码格式不正确！&apos;    }])    validator.add(registerForm.emailAddress, [{        strategy: &apos;isNonEmpty&apos;,        errorMsg: &apos;邮箱地址不能为空！&apos;    }, {        strategy: &apos;isEmail&apos;,        errorMsg: &apos;邮箱地址格式不正确！&apos;    }])    let errorMsg = validator.start()    return errorMsg}registerForm.addEventListener(&apos;submit&apos;, function() {    let errorMsg = validatorFunc()    if (errorMsg) {        alert(errorMsg)        return false    }}, false)</code></pre><p>在修改某个校验规则的时候，只需要编写或者改写少量的代码。比如我们想要将用户名输入框的校验规则改成用户名不能少于4个字符。可以看到，这时候的修改是毫不费力的。代码如下：</p><pre><code>validator.add(registerForm.userName, [{        strategy: &apos;isNonEmpty&apos;,        errorMsg: &apos;用户名不能为空！&apos;    }, {        strategy: &apos;minLength:4&apos;,        errorMsg: &apos;用户名长度不能小于4位！&apos;    }])</code></pre><h3 id="策略模式的优缺点"><a href="#策略模式的优缺点" class="headerlink" title="策略模式的优缺点"></a>策略模式的优缺点</h3><p>策略模式利用组合、委托和多态等技术思想，可以有效的避免多种条件选择语句； 策略模式提供了对开放-封闭原则的完美支持，将算法封装在独立的strategy中，使得它易于切换，易于理解，易于拓展； 策略模式中的算法也可以复用在系统的其它地方，从而避免了许多重复的复制黏贴的工作； 在策略模式利用组合和委托来让Context拥有执行算法的能力，这也是继承一种更轻便的替代方案。 当然，策略模式也有一些缺点，但掌握了策略模式，这些缺点并不严重。 编写难度加大，代码量变多了，这是最直观的一个缺点，也算不上缺点，毕竟不能完全以代码多少来衡量优劣。 首先，使用策略模式会在程序中增加许多策略类或者策略对象，但实际上这比把它们负责的逻辑堆砌在Context中要好。 其次，要使用策略模式，必须了解所有的strategy，必须了解各个strategy之间的不同点，这样才能选择一个合适的strategy。比如，我们要选择一种合适的旅游出行路线，必须先了解选择飞机、火车、自行车等方案的细节。此时strategy要向客户暴露它的所有实现，这是违反最少知识原则的。</p><h3 id="策略模式的意义"><a href="#策略模式的意义" class="headerlink" title="策略模式的意义"></a>策略模式的意义</h3><p>策略模式使开发人员能够开发出由许多可替换的部分组成的软件，并且各个部分之间是弱连接的关系。 弱连接的特性使软件具有更强的可扩展性，易于维护；更重要的是，它大大提高了软件的可重用性。</p><h2 id="关于ES6d的Proxy对象"><a href="#关于ES6d的Proxy对象" class="headerlink" title="关于ES6d的Proxy对象"></a>关于ES6d的Proxy对象</h2><p>策略模式固然可行，但是包装的有点多了，而且不便于书写，代码书写量增加了不少，也就是有一定门槛，那有没有更好的实现方式呢？我们能不能通过一层代理，在设置属性时候就去拦截它呢？这就是今天要讲到的ES6的Proxy对象。</p><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>Proxy 用于修改某些操作的默认行为，等同于在语言层面做出修改，所以属于一种“元编程”（meta programming），即对编程语言进行编程。 Proxy 可以理解成，在目标对象之前架设一层“拦截”，外界对该对象的访问，都必须先通过这层拦截，因此提供了一种机制，可以对外界的访问进行过滤和改写。Proxy 这个词的原意是代理，用在这里表示由它来“代理”某些操作，可以译为“代理器”。</p><pre><code>let obj = new Proxy({}, {  get (target, key, receiver) {    console.log(`getting ${key}!`)    return Reflect.get(target, key, receiver)  },  set (target, key, value, receiver) {    console.log(`setting ${key}!`)    return Reflect.set(target, key, value, receiver)  }})</code></pre><p>上面代码对一个空对象架设了一层拦截，重定义了属性的读取（get）和设置（set）行为。这里暂时先不解释具体的语法，只看运行结果。对设置了拦截行为的对象obj，去读写它的属性，就会得到下面的结果。</p><pre><code>obj.count = 1//  setting count!++obj.count//  getting count!//  setting count!//  2</code></pre><p>上面代码说明，Proxy 实际上重载（overload）了点运算符，即用自己的定义覆盖了语言的原始定义。 ES6 原生提供 Proxy 构造函数，用来生成 Proxy 实例。</p><pre><code>let proxy = new Proxy(target, handler);</code></pre><p>Proxy 对象的所有用法，都是上面这种形式，不同的只是handler参数的写法。其中，new Proxy()表示生成一个Proxy实例，target参数表示所要拦截的目标对象，handler参数也是一个对象，用来定制拦截行为。 下面是另一个拦截读取属性行为的例子。</p><pre><code>var proxy = new Proxy({}, {  get: function(target, property) {    return 35;  }});proxy.time // 35proxy.name // 35proxy.title // 35</code></pre><p>上面代码中，作为构造函数，Proxy接受两个参数。第一个参数是所要代理的目标对象（上例是一个空对象），即如果没有Proxy的介入，操作原来要访问的就是这个对象；第二个参数是一个配置对象，对于每一个被代理的操作，需要提供一个对应的处理函数，该函数将拦截对应的操作。比如，上面代码中，配置对象有一个get方法，用来拦截对目标对象属性的访问请求。get方法的两个参数分别是目标对象和所要访问的属性。可以看到，由于拦截函数总是返回35，所以访问任何属性都得到35。 注意，要使得Proxy起作用，必须针对Proxy实例（上例是proxy对象）进行操作，而不是针对目标对象（上例是空对象）进行操作。</p><h3 id="利用Proxy重构表单验证"><a href="#利用Proxy重构表单验证" class="headerlink" title="利用Proxy重构表单验证"></a>利用Proxy重构表单验证</h3><p>利用proxy拦截不符合要求的数据</p><pre><code>function validator(target, validator, errorMsg) {    return new Proxy(target, {        _validator: validator,        set(target, key, value, proxy) {            let errMsg = errorMsg            if (value == &apos;&apos;) {                alert(`${errMsg[key]}不能为空！`)                return target[key] = false            }            let va = this._validator[key]            if (!!va(value)) {                return Reflect.set(target, key, value, proxy)            } else {                alert(`${errMsg[key]}格式不正确`)                return target[key] = false            }        }    })}</code></pre><p>负责校验的逻辑代码</p><pre><code>const validators = {        name(value) {            return value.length &gt; 6        },        passwd(value) {            return value.length &gt; 6        },        moblie(value) {            return /^1(3|5|7|8|9)[0-9]{9}$/.test(value)        },        email(value) {            return /^\w+([+-.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(value)        }    }</code></pre><p>客户端调用代码</p><pre><code>const errorMsg = { name: &apos;用户名&apos;, passwd: &apos;密码&apos;, moblie: &apos;手机号码&apos;, email: &apos;邮箱地址&apos; }const vali = validator({}, validators, errorMsg)let registerForm = document.querySelector(&apos;#registerForm&apos;)registerForm.addEventListener(&apos;submit&apos;, function() {        let validatorNext = function*() {            yield vali.name = registerForm.userName.value            yield vali.passwd = registerForm.passWord.value            yield vali.moblie = registerForm.phoneNumber.value            yield vali.email = registerForm.emailAddress.value        }        let validator = validatorNext()        validator.next();        !vali.name || validator.next(); //上一步的校验通过才执行下一步        !vali.passwd || validator.next();        !vali.moblie || validator.next();    }, false)</code></pre><p>优点：条件和对象本身完全隔离开,后续代码的维护,代码整洁度,以及代码健壮性和复用性变得非常强。 缺点：兼容性不好，有babel怕啥，粗糙版，很多细节其实还可以优化，这里只提供一种思路。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WordPress TinyMCE编辑器自定义按钮</title>
      <link href="/wordpress-tinymce-editor-customize-button.html"/>
      <url>/wordpress-tinymce-editor-customize-button.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>这几天我在折腾主题发现，还是感觉WordPress自带的编辑器好用，于是放弃原来的Markdown编辑写作了。所以现在遇到输入代码的一堆麻烦，我可不想慢慢手动敲打源代码，真的累死。你可能说用短代码不就可以了吗？但是对我来说好好一篇文章插入短代码真的很丑，假如不解析的话。如果TinyMCE编辑器支持一键输入最好了，于是搜索相关的资料的确搜到一些可操作的方式。</p><h3 id="折腾"><a href="#折腾" class="headerlink" title="折腾"></a>折腾</h3><p>不管怎么样我们需要一步一步来，想让WP编辑器注入按钮的支持，然后在按钮添加相关组件支持。 首先我们先要新建一个JS文件，名叫<code>expand.js</code>打开编文件复制：</p><pre><code>(function (window, $) {    &apos;use strict&apos;;    /**     * Custom Trim function     * @returns {string}     */    String.prototype.trim = function () {        return this.replace(/^\s+|\s+$/g, &apos;&apos;);    };    tinymce.PluginManager.add(&apos;note_assist_button&apos;, function (editor, url) {        editor.addButton(&apos;note_assist_button&apos;, {            title: &apos;重要内容展示&apos;,            text: &apos;&apos;,            type: false,            icon: &apos;file-empty-icon&apos;,            onclick: function () {                editor.windowManager.open({                    title: &apos;内容展示&apos;,                    width: 550,                    height: 450,                    body: [                        {                            type: &apos;listbox&apos;,                            name: &apos;typebox&apos;,                            label: &apos;等级类型* :&apos;,                            values: [                                { text: &apos;红色&apos;, value: &apos;warning&apos; },                                { text: &apos;黄色&apos;, value: &apos;note&apos; },                                { text: &apos;蓝色&apos;, value: &apos;good&apos; }                            ],                            value: { text: &apos;红色&apos;, value: &apos;warning&apos; }                        },                        {                            type: &apos;textbox&apos;,                            name: &apos;postfield&apos;,                            label: &apos;展示内容*:&apos;,                            multiline: true,                            minHeight: 250,                            value: &apos;&apos;,                            onclick: function (e) {                                $(e.target).css(&apos;border-color&apos;, &apos;&apos;);                            }                        }                    ],                    onsubmit: function (e) {                        console.log(e);                        var code = e.data.postfield.trim();                        //内容不得为空                        if (code === &apos;&apos;) {                            var windowId = this._id;                            var inputs = $(&apos;#&apos; + windowId + &apos;-body&apos;).find(&apos;.mce-formitem textarea&apos;);                            $(inputs.get(0)).css(&apos;border-color&apos;, &apos;red&apos;).focus();                            return false;                        }                        var typebox = e.data.typebox;                        //注入内容                        code = code.replace(/&lt;/g, &apos;&lt;&apos;).replace(/&gt;/g, &apos;&gt;&apos;);                        editor.insertContent(&apos;&lt;div class=&quot;&apos;+ typebox +&apos;&quot;&gt;&lt;p&gt;&apos;+ code +&apos;&lt;/p&gt;&lt;/div&gt;&apos;);                    }                });            }        });    });})(window, jQuery);</code></pre><p>上面写的是基本的按钮事件，功能展示如下。</p><p><strong>提醒：</strong>绝大部分参考文件<code>wordpress\wp-includes\js\tinymce\plugins</code>文件夹中，遇到有问题可以去这里看看</p><p>下面引入JS文件，我们在function.php加入以下代码：</p><pre><code>/**编辑器扩展 * @param $plugin_array * @return mixed */function add_tinymce_plugin_expand($plugin_array){    $plugin_array[&apos;note_assist_button&apos;] = get_template_directory_uri() . &apos;/pathto/expand.js&apos;;    return $plugin_array;}function register_tinymce_button_expand($buttons) {    array_push($buttons, &quot;note_assist_button&quot;);    return $buttons;}function add_admin_inline_style_expand($hook) {    ?&gt;    &lt;style type=&quot;text/css&quot;&gt;.mce-i-file-empty-icon:before {            content: &apos;\f119&apos;;            font: 400 20px/1 dashicons;            padding: 0;            vertical-align: top;            -webkit-font-smoothing: antialiased;            -moz-osx-font-smoothing: grayscale;        } &lt;/style&gt;    &lt;?php}add_filter(&quot;mce_external_plugins&quot;, &quot;add_tinymce_plugin_expand&quot;);add_filter(&apos;mce_buttons&apos;, &quot;register_tinymce_button_expand&quot;);add_action(&apos;admin_print_styles&apos;, &quot;add_admin_inline_style_expand&quot;, 99);</code></pre><p>直接hook即可。</p><p><strong>提醒：</strong>我这里遇到图标的问题，不想引入第三方图片可以引入WP自带的：<a href="https://developer.wordpress.org/resource/dashicons" target="_blank" rel="noopener">https://developer.wordpress.org/resource/dashicons</a></p><p>所以这样基本上的问题解决掉了。 参考链接：</p><blockquote><p><a href="https://codex.wordpress.org/Plugin_API/Filter_Reference/mce_external_plugins" target="_blank" rel="noopener">https://codex.wordpress.org/Plugin_API/Filter_Reference/mce_external_plugins</a> <a href="https://codex.wordpress.org/TinyMCE_Custom_Buttons" target="_blank" rel="noopener">https://codex.wordpress.org/TinyMCE_Custom_Buttons</a> <a href="https://www.tinymce.com/docs/api" target="_blank" rel="noopener">https://www.tinymce.com/docs/api</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WordPress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS工具脚本</title>
      <link href="/ios-tool-scripts.html"/>
      <url>/ios-tool-scripts.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h3><p>在Cydia没有匹配之前，折腾的人永远是最伟大的。 此脚本方便懒人，小白等用户折腾。目前来看我就加入俩个小功能，以后慢慢完善吧！ 支持的功能： 0. 注销系统 1. 一键更换字体</p><h3 id="说明"><a href="#说明" class="headerlink" title="说明:"></a>说明:</h3><p>请把脚本文件ifont.sh放入用户区（/var/mobile/Media），连上终端输入：</p><pre><code>cd /var/mobile/Media &amp;&amp; chmod 644 ifont.sh &amp;&amp; sh ifont.sh</code></pre><p>根据提示执行操作即可。 一键更换字体：请把你所要换的字体放入用户区（/var/mobile/Media），且字体重命名为PingFang.ttc   脚本下载地址：<a href="https://iiong.com/ifont.sh" target="_blank" rel="noopener">https://iiong.com/ifont.sh</a></p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>网页内容复制粘贴</title>
      <link href="/page-content-copy-and-paste.html"/>
      <url>/page-content-copy-and-paste.html</url>
      
        <content type="html"><![CDATA[<h3 id="网页内容复制粘贴-三种方案-兼容多种浏览器"><a href="#网页内容复制粘贴-三种方案-兼容多种浏览器" class="headerlink" title="网页内容复制粘贴(三种方案 兼容多种浏览器)"></a><a href="#网页内容复制粘贴三种方案-兼容多种浏览器"></a>网页内容复制粘贴(三种方案 兼容多种浏览器)</h3><p>对网页上的内容实现复制粘贴的功能 痛点：需要支持多种不同的浏览器 主要有IE，Firefox</p><ul><li>IE浏览器下的解决方案：<code>window.clipboardData.setData(&quot;Text&quot;, text);</code></li><li>通用浏览器的解决方案：选中元素之后执行：<code>document.execCommand(&#39;copy&#39;)</code></li><li>Firefox下的解决方案两种折中的方案</li><li>监听<code>hover</code>事件 当鼠标移动至需要复制的文本上时 用户按下ctrl+c 实现复制</li><li><code>window.prompt(&quot;Copy to clipboard: Ctrl+C, Enter&quot;, text);</code>弹出框内容为选中的文案，用户按下ctrl+c 实现复制</li></ul><p>整合之后的代码为：</p><pre><code>function copyToClipboard(text) {  if (window.clipboardData) { // Internet Explorer    window.clipboardData.setData(&quot;Text&quot;, text);  } else {    var textArea = document.createElement(&quot;textarea&quot;);    textArea.style.background = &apos;transparent&apos;;    textArea.value = text;    document.body.appendChild(textArea);    textArea.select();    try {      if (!document.execCommand(&apos;copy&apos;)) {        copyToClipboardMozilla(text);      } else {        showInfo(&quot;提示&quot;, &quot;复制成功&quot;)      }    } catch (err) {      console.log(&apos;Oops, unable to copy&apos;);    }      document.body.removeChild(textArea);  }}function copyToClipboardMozilla(text) {  window.prompt(&quot;Copy to clipboard: Ctrl+C, Enter&quot;, text);}$(&quot;.copy&quot;).on(&quot;mouseenter&quot;, function () {  $(this).css(&quot;background-color&quot;, &quot;#c8c9c8&quot;);  $(this).focus();  var textArea = document.createElement(&quot;textarea&quot;);  textArea.style.background = &apos;transparent&apos;;  textArea.id = &quot;copyContent&quot;;  textArea.value = $(this).text();  document.body.appendChild(textArea);  textArea.select(); })$(&quot;.copy&quot;).on(&quot;mouseleave&quot;, function () {  $(this).css(&quot;background-color&quot;, &quot;&quot;);document.body.removeChild(document.getElementById(&quot;copyContent&quot;)); })</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>EMD Vol 1712</title>
      <link href="/emd-vol-1712.html"/>
      <url>/emd-vol-1712.html</url>
      
        <content type="html"><![CDATA[<h3 id="2017-12-17"><a href="#2017-12-17" class="headerlink" title="2017.12.17"></a>2017.12.17</h3><p>说实话，中间一下子断了三个月文章没来得及去写，不是我太懒，是发生的事情实在是让我难以消化。说改变人生轨迹也不过分，从十月份开始，一件接着一件事情发生，现在可盼到头了。现在静下心来再看，发现现在和三个月前比起来，变化太多。</p><h3 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h3><p>说实话，今年跳槽太多了，一年下来，我整整跳了五家公司 ，真不知道自己怎么想的😂，其实我在第二家上得好好的…后面好几家都不满意，现在在职的公司比我之前上的公司好多了，无论是公司的价值观以及同事的价值观，对于现在绝大掉入铜臭味的公司们来比，实在是好多了。 记得刚入公司，工头和我聊天聊到出路，其实他的问题我老早想过。人不能做一辈子敲代码程序员，需要在必要的时间段内转型，不同的年龄段里，年轻人都会比你更有优势（廉价的劳动力）。说实话，对于这个话题很遥远，因为我还年轻，需要去吸收更多的技能，永远不知道下一步去做什么。但相信自己未来不会平凡的，加油！当然有时间去学习管理层知识以及系统架构师知识。</p><h3 id="家事"><a href="#家事" class="headerlink" title="家事"></a>家事</h3><p>这三个月发生的事情还是家里比较多，真的没想到我也会这一天，这直接影响到我的感情关系。这一刻，真不知道自己要说什么，再怎么说也没什么用。和亲生母亲断绝关系后，对自己也发生一些看法，<strong>我很无情，</strong>我是<strong>无情无义</strong>的人，连亲生母亲不考虑任何感情，后果直接断绝，不是无情是什么？从某些方面来讲，同样我是心软的人，在我的直观里，这俩样是冲突的。但仔细想想又不是，《这个杀手不太冷》的男主角就是一个例子，对于杀手来讲，对人心软是一个不明智的行为，导致最后死亡，所以某些上面来讲又不能共存。对我来说，这已经无解了，如果还有选择的话，我还是做出这样的选择，因为我从骨子里外就是一个无情的人。 不过发生这几件事情，前一段时间发现我和父亲关系好太多了，可能面对未来又有了一些期盼…</p><h3 id="感情"><a href="#感情" class="headerlink" title="感情"></a>感情</h3><p>和女朋友谈了快半年了，回想过去，不容乐观。就提一件小事情，有次说了我有记账的习惯，她居然不理解为什么要记账，我真的无法形容那时候的心情。说到底就是俩个人三观不同。那么三观是什么？</p><blockquote><p>人生观：你想要成为什么样的人？人生观不同，形同路人。她无法理解你的追求，你不能理解她的理想；她不懂你的苦痛，你不懂她的快乐。彼此孤独，互相漠视。</p></blockquote><blockquote><p>价值观：你觉得什么最重要？价值观不同，家庭之船失去航向。特别是在在重大抉择面前，你们无法理解、难以调和，互相觉得对方是傻X。</p></blockquote><blockquote><p>世界观：世界是一个什么样子？世界观不同，处理外界关系的方法不同。世界观在很大程度决定了人生观与价值观。</p></blockquote><p>不要一谈到三观就觉得离生活很远，三观决定了一个人的认知、情绪、选择、步伐等所有生活中的大小事情。而且，越是重要的事，越是各自坚持、难以调和。三观不同，两人的认知、情绪、选择、步伐根本不在一个频道律动。交流起来如同鸡同鸭讲，都觉得对方不可理喻。这样的人，连好朋友都不能做，怎么可以做夫妻？即便是因为颜值或其他走到一起，时间长了，边际效用递减，各自的本性就会露出来。 既然这样了，还有什么办法去解决呢？我也不知道。百度搜索『三观不同』后面的联想搜索真的很吓人，至少我现在没法接受那种结果。 “渺渺时空，茫茫人海，与君相遇，莫失莫忘！”</p><h3 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h3><p>2018年要来了，这一篇是2017年最后一篇月记，花了俩个小时去认认真真的写。静下心来，听者轻音乐，去写一些东西，也是蛮不错的选择。 这一篇文章我是用富文本去写，并没有尝试用markdown去写，突然感觉富文本也是挺舒服的。 最后半个月，好好去准备下送走2017年吧！</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>小程序踩坑之setData蜜汁报错</title>
      <link href="/setdata-error-of-mini-programs.html"/>
      <url>/setdata-error-of-mini-programs.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>最近小程序在绑定数据中返回dom，发现一个问题：</p><pre><code>thirdScriptErrorCannot read property &apos;setData&apos; of undefined;at pages/index/index page changText functionTypeError: Cannot read property &apos;setData&apos; of undefined</code></pre><h3 id="解决过程"><a href="#解决过程" class="headerlink" title="解决过程"></a>解决过程</h3><p>在js文件写的是(es6)：</p><pre><code>changText: () =&gt; {  // console.log(_this);  this.setData({    motto: &quot;dad&quot;  })}</code></pre><p>但是es5写法是正常的：</p><pre><code>changText: (function () {  console.log(this);  this.setData({    motto: &quot;dad&quot;  });}),</code></pre><p>为什么es5正确显示而es6却不行呢？</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>对此抱着疑问的态度搜集相关的资料，了解到es6箭头函数的一些坑：</p><blockquote><p>箭头函数表达式的语法比函数表达式更短，并且不绑定自己的this，arguments，super或 new.target。这些函数表达式最适合用于非方法函数，并且它们不能用作构造函数。</p></blockquote><p>这段文字来自MDN Web Doc介绍箭头函数一段文字。 更多的知识可以去查看它的文档：<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions" target="_blank" rel="noopener">MDN Web Doc</a> 其实说白了es6的箭头函数和es5 function函数看起来差不多，只是写法简化了，其实是不一样的，function声明的函数和箭头函数的作用域不同，这是一个不小心坑的地方。 所以对于这个结果，还是换回es5的function函数去写最好了。 <strong>箭头函数和function的区别：</strong></p><ul><li>箭头函数体内的this对象，就是定义时所在的对象，而不是使用时所在的对象</li><li>箭头函数不可以当作构造函数，也就是说，不可以使用new命令，否则会抛出一个错误</li><li>箭头函数不可以使用arguments对象，该对象在函数体内不存在。如果要用，可以用Rest参数代替</li><li>不可以使用yield命令，因此箭头函数不能用作Generator函数。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小程序 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Meow Editor: 一个轻量级的Markdown WP插件</title>
      <link href="/wordpress-plugins-wp-meow-editor-html.html"/>
      <url>/wordpress-plugins-wp-meow-editor-html.html</url>
      
        <content type="html"><![CDATA[<h3 id="你好，世界"><a href="#你好，世界" class="headerlink" title="你好，世界"></a>你好，世界</h3><p>本插件已开源：<a href="https://github.com/JaxsonWang/Meow-Editor" target="_blank" rel="noopener">https://github.com/JaxsonWang/Meow-Editor</a> 对于WP-Editor.md，此插件轻便多了。 目前插件还需完善：</p><ul><li>语法高亮</li><li>列表</li><li>设置个性化</li><li>其他…</li></ul><p>有什么意见请在博客下面反馈，或者Github提issue也可以。</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WordPress </tag>
            
            <tag> Markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ghost Ver 1.x安装笔记</title>
      <link href="/ghost-ver-1-x-installation-notes.html"/>
      <url>/ghost-ver-1-x-installation-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>看到Ghost博客更新到1.x版本，就体验下了吧，中间也填了不少坑…</p><h3 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h3><p><a href="https://iiong.com/centos-install-ghost-blog-1.html" target="_blank" rel="noopener">Centos环境安装Ghost Blog（上）</a> <a href="https://iiong.com/centos-install-ghost-blog-2.html" target="_blank" rel="noopener">Centos环境安装Ghost Blog（下）</a> 以上俩篇文章Ghost版本是0.x，有兴趣的朋友可以读一读。 相对于现在的版本，有什么区别？ 体验一把下来，主要是Ghost弄了个脚手架，可以一键式安装Ghost博客，有兴趣的朋友可以读下<a href="https://docs.ghost.org/v1.0.0/docs/ghost-cli" target="_blank" rel="noopener">官方文档</a>。 官方文档需要准备的环境是：</p><ul><li>Ubuntu 16.04</li><li>MySQL</li><li>Nginx (minimum of 1.9.5 for SSL)</li><li>Systemd</li><li>Node v6 installed via NodeSource</li></ul><p>不过我测试的主机系统是腾讯云的Centos 7.2，安装下来也没问题。建议和官方环境一样即可。 Nginx、MySQL这类可以选择一键安装包完成，我用的是<a href="https://Oneinstack.com" target="_blank" rel="noopener">Oneinstack</a>，这个我就不多说了，下面主要是Node.js安装和安装依赖的问题。</p><h4 id="安装Node-js"><a href="#安装Node-js" class="headerlink" title="安装Node.js"></a>安装Node.js</h4><p>如果安装官方文档来加入安装Node.js源，因为不可描述的原因，你会发现安装得很慢。所以这儿我推荐大家直接在仓库源安装吧：</p><pre><code>apt-get install -y nodejs #Ubuntuyum install -y nodejs #Centos</code></pre><p>不过在安装之前你得需要查看Node.js版本是否符合官方的版本(V6)：</p><pre><code>apt-get info nodejs #Ubuntuyum info nodejs #Centos</code></pre><p>我的返回结果：</p><pre><code>Loaded plugins: fastestmirror, langpacksLoading mirror speeds from cached hostfileAvailable PackagesName        : nodejsArch        : x86_64Epoch       : 1Version     : 6.11.3Release     : 1.el7Size        : 4.6 MRepo        : epel/7/x86_64Summary     : JavaScript runtimeURL         : http://nodejs.org/License     : MIT and ASL 2.0 and ISC and BSDDescription : Node.js is a platform built on Chrome&apos;s JavaScript runtime            : for easily building fast, scalable network applications.            : Node.js uses an event-driven, non-blocking I/O model that            : makes it lightweight and efficient, perfect for data-intensive            : real-time applications that run across distributed devices.</code></pre><p>看到其中的<code>Version : 6.11.3</code>符合条件就行了。否则你需要按照下面的步骤来做。 官方文档说的是载入Node.js源：</p><pre><code>curl -sL https://deb.nodesource.com/setup_6.x | sudo -E bash </code></pre><p>然后刷新源安装Node.js:</p><pre><code>apt-get update #Ubuntuapt-get install -y nodejs #Ubuntuyum update #Centosyum install -y nodejs #Centos</code></pre><p>这样Node.js环境安装好了。</p><h4 id="替换国内npm环境"><a href="#替换国内npm环境" class="headerlink" title="替换国内npm环境"></a>替换国内npm环境</h4><p>请参考 <a href="https://iiong.com/npm-replacement-source.html" target="_blank" rel="noopener">npm更换源</a>，本文不在讲述。</p><h3 id="安装Ghost"><a href="#安装Ghost" class="headerlink" title="安装Ghost"></a>安装Ghost</h3><h4 id="安装Ghost脚手架："><a href="#安装Ghost脚手架：" class="headerlink" title="安装Ghost脚手架："></a>安装Ghost脚手架：</h4><pre><code>npm i -g ghost-cli</code></pre><h4 id="安装Ghost博客环境"><a href="#安装Ghost博客环境" class="headerlink" title="安装Ghost博客环境"></a>安装Ghost博客环境</h4><p>我们需要创建个存放Ghost博客目录，例如我的放在<code>/data/wwwroot/iiong.com</code>：</p><pre><code>mkdir -p /data/wwwroot/iiong.comcd /data/wwwroot/iiong.comghost install</code></pre><p>期间会有提示安装数据库，根据自己的情况输入即可： <img src="https://files.readme.io/7d09283-cli-install-config.png" alt></p><h4 id="Nginx配置"><a href="#Nginx配置" class="headerlink" title="Nginx配置"></a>Nginx配置</h4><p>下面我们该说说Nginx配置了，这儿我放个配置文件，你只需要把相关信息修改下即可：</p><pre><code>upstream ghost_upstream {    server unix:/dev/shm/socket.sock;    keepalive 64;}proxy_cache_path /data/wwwroot/example.com/cache levels=1:2 keys_zone=STATIC:100m inactive=24h max_size=512m;  server {  listen 80;  listen 443 ssl http2;  ssl_certificate /usr/local/nginx/conf/ssl/example.com.crt;  ssl_certificate_key /usr/local/nginx/conf/ssl/example.com.key;  ssl_protocols TLSv1 TLSv1.1 TLSv1.2;  ssl_ciphers EECDH+CHACHA20:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5;  ssl_prefer_server_ciphers on;  ssl_session_timeout 10m;  ssl_session_cache builtin:1000 shared:SSL:10m;  ssl_buffer_size 1400;  add_header Strict-Transport-Security max-age=15768000;  ssl_stapling on;  ssl_stapling_verify on;  server_name example.com www.example.com;  access_log /data/wwwlogs/example.com_nginx.log combined;#  index index.html index.htm index.php;#  root /data/wwwroot/example.com;  if ($ssl_protocol = &quot;&quot;) { return 301 https://$host$request_uri; }  if ($host != example.com) {  return 301 $scheme://example.com$request_uri;  }#  error_page 404 /404.html;#  error_page 502 /502.html;  location / {    proxy_cache STATIC;    proxy_cache_valid 200 60m;    proxy_cache_valid 404 1m;    proxy_ignore_headers X-Accel-Expires Expires Cache-Control;    proxy_ignore_headers Set-Cookie;    proxy_pass http://ghost_upstream;    proxy_redirect default;    proxy_set_header Host $http_host;    proxy_set_header X-Real-IP $remote_addr;    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;    proxy_set_header X-Forward-For $proxy_add_x_forwarded_for;    proxy_set_header X-Forward-IP $remote_addr;    proxy_set_header X-Forwarded-Proto $scheme;    client_max_body_size     10m;    client_body_buffer_size  512k;    proxy_connect_timeout    5;    proxy_read_timeout       60;    proxy_send_timeout       5;    proxy_buffer_size        16k;    proxy_buffers            4 64k;    proxy_busy_buffers_size  128k;    proxy_hide_header Set-Cookie;    proxy_hide_header    X-Powered-By;    expires 10m;    rewrite ^/(.*)\.html /$1/ permanent; #将WordPress重定向博文连接    rewrite &quot;\d{4}/\d{2}/\d{2}/(.*)$&quot; /$1 permanent; #将WordPress/YYYY/MM/DD日期链接重定向博客首页  }  location ~ ^/(?:ghost|signout) {    proxy_set_header   X-Real-IP $remote_addr;    proxy_set_header   Host      $http_host;    proxy_set_header X-NginX-Proxy true;    proxy_pass http://ghost_upstream;    add_header Cache-Control &quot;no-cache, private, no-store, must-revalidate, max-stale=0, post-check=0, pre-check=0&quot;;    proxy_set_header X-Forwarded-Proto https;    proxy_redirect off;  }  location = /favicon.ico {     alias /data/wwwroot/example.com/versions/1.16.0/core/server/public/favicon.ico;  }  location = /robots.txt {     alias /data/wwwroot/example.com/versions/1.16.0/core/server/public/robots.txt;  }  location ~ .*\.(wma|wmv|asf|mp3|mmf|zip|rar|jpg|gif|png|swf|flv|mp4)$ {    valid_referers none blocked *.example.com example.com www.example.com;    if ($invalid_referer) {        rewrite ^/ http://www.linuxeye.com/403.html;        return 403;    }  }  location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|flv|mp4|ico)$ {    expires 30d;    access_log off;  }#  location ~ .*\.(js|css)?$ {#    expires 7d;#    access_log off;#  }  location ~ /\.ht {    deny all;  }}</code></pre><h4 id="Ghost配置文件："><a href="#Ghost配置文件：" class="headerlink" title="Ghost配置文件："></a>Ghost配置文件：</h4><pre><code>{  &quot;url&quot;: &quot;https://iiong.com&quot;,  &quot;server&quot;: {    &quot;socket&quot;: {      &quot;path&quot;: &quot;/dev/shm/socket.sock&quot;,      &quot;permissions&quot;: &quot;0666&quot;    }  },  &quot;database&quot;: {    &quot;client&quot;: &quot;mysql&quot;,    &quot;connection&quot;: {      &quot;host&quot;: &quot;127.0.0.1&quot;,      &quot;user&quot;: &quot;数据库用户&quot;,      &quot;password&quot;: &quot;数据库密码&quot;,      &quot;database&quot;: &quot;数据库名&quot;    }  },  &quot;mail&quot;: {    &quot;transport&quot;: &quot;SMTP&quot;,    &quot;options&quot;: {      &quot;service&quot;: &quot;qq&quot;,      &quot;auth&quot;: {        &quot;user&quot;: &quot;用户名&quot;,        &quot;pass&quot;: &quot;密码&quot;      }    }  },  &quot;privacy&quot;: false,  &quot;useMinFiles&quot;: true,  &quot;logging&quot;: {    &quot;transports&quot;: [      &quot;file&quot;,      &quot;stdout&quot;    ]  },  &quot;process&quot;: &quot;systemd&quot;,  &quot;paths&quot;: {    &quot;contentPath&quot;: &quot;/data/wwwroot/iiong.com/content&quot;  },  &quot;caching&quot;: {    &quot;frontend&quot;: {      &quot;maxAge&quot;: 0    },    &quot;301&quot;: {      &quot;maxAge&quot;: 31536000    },    &quot;customRedirects&quot;: {      &quot;maxAge&quot;: 31536000    },    &quot;favicon&quot;: {      &quot;maxAge&quot;: 86400    },    &quot;sitemap&quot;: {      &quot;maxAge&quot;: 3600    },    &quot;robotstxt&quot;: {      &quot;maxAge&quot;: 3600000    }  }}</code></pre><h3 id="完结"><a href="#完结" class="headerlink" title="完结"></a>完结</h3><p>从目前来看，基本没什么问题了，中间踩了不少坑，不过都填好了。 虽然中间体验了几天，但是多少太简单了，还是用回WordPress博客平台。</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ghost </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EMD Vol 1709</title>
      <link href="/emd-vol-1709.html"/>
      <url>/emd-vol-1709.html</url>
      
        <content type="html"><![CDATA[<h3 id="2017-09-26"><a href="#2017-09-26" class="headerlink" title="2017.09.26"></a>2017.09.26</h3><p>这段时间发生东西实在是太多太多，以至于八月份的月记都没来得及去写。</p><h3 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h3><p>很高兴又辞去一份工作，可能对你们来说就是工作不稳定吧。其实对我来说，辞去或许是最好的退路。</p><blockquote><p>岁月疾驶，每一次想到你，回荡在耳边的，总归是首很慢的歌。</p></blockquote><p>工作辞去了后，目前在家瞎溜达，不过找到一份还算是满意的工作，虽然还没去面试。</p><h3 id="感情"><a href="#感情" class="headerlink" title="感情"></a>感情</h3><p>很意外收获一份感情，原来上天总是在不经意的时候给予。</p><p>故事好像就是这么开始的。</p><p>在我生命里遇到过很多形形色色的人。</p><p>而你，你是离我最近的一个故事，最意外的邂逅。</p><p>希望这故事在我的有生之年一直讲下去。</p><p>当然我会另开一篇去讲猫先生（我）和鱼小姐的故事。</p><h3 id="家庭"><a href="#家庭" class="headerlink" title="家庭"></a>家庭</h3><p>哇，好炸裂。</p><p>我和母亲彻底断开了，到现在为止，虽然心理波动不大，但是多少有点难受的感觉，除了十几年的母亲，今天终于发现彻底变了。</p><p>家庭的环境导致一系列的恶化，我知道站在这个队伍是错误的，但我没办法去改变，错了就错了，仅仅在维护自己一方的利益罢了。</p><p>或许，我永远在母亲那一方说的“不孝子”吧？</p><p>还好我的性格自由自在。不管也罢，天下任我闯！</p><h3 id="人生三观"><a href="#人生三观" class="headerlink" title="人生三观"></a>人生三观</h3><p>今晚和女朋友谈到所谓的三观，最后莫名其妙的不开心了。</p><p>对于情侣的三观冲突就相当于：</p><p>我吸的是二氧化碳，吐的也是二氧化碳，而她需要空气！</p><p>这也算是在磨合之一，努力去同步的她节点。</p><p>其实吧对我来说学会倾听就好，不用去反驳或者诉说一些事。因为这个世界永远和你冲突的地方。</p><p>我一直以为我这个人很少人会去理解，既然有人接受我了，我也需要改掉一些固执的老毛病。</p><p>对于人生观和世界观自己觉得分的蛮清楚的。但是价值观，对我来说很迷糊：</p><p><strong>可能我的性格不甘平庸，不想碌碌无为走过一生</strong></p><p>那么<strong>平庸</strong>以及<strong>无为</strong>是怎么定义：</p><p>自从打心底问，平庸和无为是相近的意思，想要，却不争取，就会慢慢的平庸，量变产生质变，慢慢的，就变得不想要了，然后开始自嘲说被社会磨平了棱角。</p><p>或许，绝大部分人的一生就是过来吧。很遗憾的是，我好像也陷入这个恶性循环了。</p><p>但是这个世上也有一类人：<strong>最怕一生平庸无为，还安慰自己平淡可贵</strong>，对他们来说价值观会是<strong>自己平淡可贵</strong>吧？</p><p>人生在世，总要找到生命的价值。不要碌碌无为还觉得心安理得，一无所有还追求岁月静好。你想要的安稳，可能是在否定生活，就怕你懒，还把懒当时尚。</p><p>有为，不一定得是功成名就、飞黄腾达，而是随愿随心，凡事皆可成就。</p><p>有人的地方就有江湖，有的江湖浮躁繁华，有的江湖悠然淳朴，虽各不相同，但也各有烦恼和惊喜。选择什么样的江湖，你得问自己，记得选个没人的地方，用右手摸着左胸。</p><p>最怕你一生碌碌无为，还安慰自己平淡可贵。有时候，一些话说得太多，别把自己都骗了。</p><p>相信一段时间后的我，是不一样的烟花！</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>列表动画简单制作</title>
      <link href="/css3-lists-animation.html"/>
      <url>/css3-lists-animation.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>闲来无事，本来在项目中添加动画展示，免得太生硬。百度看了下动画的项目，感觉太大了，为一个小小的功能就需要这么多动画库。</p><p>正好前几天学了点动画展示功能，便手撕代码看看。</p><h3 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h3><p>首先弄个列表，这个没啥好说的：</p><pre><code>&lt;div class=&quot;main-container&quot;&gt;  &lt;div class=&quot;container&quot;&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;    &lt;div class=&quot;animation-element slide-left&quot;&gt;      &lt;div class=&quot;list&quot;&gt;      &lt;/div&gt;    &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;</code></pre><h3 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h3><p>css主要用到CSS3的动画属性，具体可以到网上查看他们的属性。</p><pre><code>.main-container {  background: #fff;  max-width: 1000px;  margin: 25px auto 25px auto;  position: relative;}.container {  position: relative;  padding: 25px;}.list {  width: 100%;  height: 200px;  text-align: center;  background-color: #eee;  margin: 20px 0;}.animation-element {  opacity: 0;  position: relative;}.animation-element.slide-left {  opacity: 0;  -moz-transition: all 500ms linear;  -webkit-transition: all 500ms linear;  -o-transition: all 500ms linear;  transition: all 500ms linear;  -moz-transform: translate3d(-100px, 0px, 0px);  -webkit-transform: translate3d(-100px, 0px, 0px);  -o-transform: translate(-100px, 0px);  -ms-transform: translate(-100px, 0px);  transform: translate3d(-100px, 0px, 0px);}.animation-element.slide-left.in-view {  opacity: 1;  -moz-transform: translate3d(0px, 0px, 0px);  -webkit-transform: translate3d(0px, 0px, 0px);  -o-transform: translate(0px, 0px);  -ms-transform: translate(0px, 0px);  transform: translate3d(0px, 0px, 0px);}</code></pre><h3 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h3><p>js这块主要是切换class属性以及监听滚动条事件来重载动画。</p><pre><code>$(document).ready(function() {  //确定窗口动画  var animation_elements = $.find(&apos;.animation-element&apos;);  var web_window = $(window);  //查看动画容器  function check_if_in_view() {    //获取当前窗口信息    var window_height = web_window.height();    var window_top_position = web_window.scrollTop();    var window_bottom_position = (window_top_position + window_height);    //迭代元素查看否在动画容器中    $.each(animation_elements, function() {      //获取元素信息      var element = $(this);      var element_height = $(element).outerHeight();      var element_top_position = $(element).offset().top;      var element_bottom_position = (element_top_position + element_height);      //检查这个当前容器是否可见      if ((element_bottom_position &gt;= window_top_position) &amp;&amp; (element_top_position &lt;= window_bottom_position)) {        element.addClass(&apos;in-view&apos;);      } else {        element.removeClass(&apos;in-view&apos;);      }    });  }  //滚动检测  $(window).on(&apos;scroll resize&apos;, function() {    check_if_in_view()  });  //初始化加载  $(window).trigger(&apos;scroll&apos;);});</code></pre><h3 id="展示"><a href="#展示" class="headerlink" title="展示"></a>展示</h3><p>具体展示可以看看：</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> JavaScript </tag>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP获取随机Web颜色</title>
      <link href="/php-gets-random-site-colors.html"/>
      <url>/php-gets-random-site-colors.html</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>今天在做一个功能需求的时候，发现有个地方需要获取随机颜色。</p><p>在Web页面中，颜色并不能瞎用，所以采取<a href="http://www.bootcss.com/p/websafecolors/" target="_blank" rel="noopener">Web安全颜色</a></p><h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><p>获取随机安全色:这里使用16进制来表示颜色，例如白色的#FFFFFF，黑色的#000000，Web安全色主要由00，33，66，99，CC，FF组成，因此，总的颜色总数就是6*6=216种，先产出所有可能的情况(216种)，放于数组中，然后再生成一个1-216的随机数，最后使用array[random]的形式随机返回一个数组成员，就算成功了。下面贴出代码：</p><pre><code>/** * 随机生成Web安全色 * @return mixed|string */function getRandomSafeColor() {    $base = array(&apos;00&apos;,&apos;33&apos;,&apos;66&apos;,&apos;99&apos;,&apos;CC&apos;,&apos;FF&apos;);//基础色    $len = count($base);//基础色长度    $random = mt_rand(1,216);//获取1-216之间的随机数    $res = &apos;&apos;;    $bg[] = &apos;&apos;;    for($r = 0; $r &lt; $len; $r++){        for($g = 0; $g &lt; $len; $g++){            for($b = 0; $b &lt; $len; $b++){                $bg[] = &apos;#&apos;.$base[$r].$base[$g].$base[$b];            }        };    };    for($i=0;$i&lt;count($bg);$i++){        $res =  $bg[$random];    }    return $res;}</code></pre><h3 id="JavaSript"><a href="#JavaSript" class="headerlink" title="JavaSript"></a>JavaSript</h3><p>对于JS版本去获取一个随机颜色相对简单点：</p><pre><code>function getRandomColor() {    return &apos;#&apos;+(&apos;00000&apos;+(Math.random()*0x1000000&lt;&lt;0).toString(16)).slice(-6); }</code></pre><p>这样就可以获取到一个随机颜色。</p><p>如果是Web安全色根据PHP版本得知如下：</p><pre><code>function getRandomSafeColor() {    var base = [&apos;00&apos;,&apos;33&apos;,&apos;66&apos;,&apos;99&apos;,&apos;CC&apos;,&apos;FF&apos;];     //基础色代码    var len = base.length;                          //基础色长度    var bg = new Array();                           //返回的结果    var random = Math.ceil(Math.random()*215+1);    //获取1-216之间的随机数    var res;    for(var r = 0; r &lt; len; r++){          for(var g = 0; g &lt; len; g++){              for(var b = 0; b &lt; len; b++){                   bg.push(&apos;#&apos;+base[r].toString()+base[g].toString()+base[b].toString());            }          };      };    for(var i=0;i&lt;bg.length;i++){        res =  bg[random];    }    return res;}</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WordPress防御垃圾评论</title>
      <link href="/wordpress-spam-comment.html"/>
      <url>/wordpress-spam-comment.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>有时候早上起来一看WordPress后台，发现一堆评论，美滋滋的想着很热闹嘛，结果一看，全是垃圾评论。这对于博主以及访客来讲，这是一个很差的体验。</p><h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><p>那么，对于国内WordPress垃圾评论解决方法有很多： 第一个就是用WordPress默认自带的防垃圾评论<a href="https://akismet.com/" target="_blank" rel="noopener">Akismet</a>,说实话这个插件的确是首选，效果很好，但使用过程中发现它写入很多数据库，并且占用很大的机器资源，导致网站日渐卡顿，这不行，不存在的，所以这个不考虑。 第二个是滑动或者是解锁评论的插件，说实话这个比起上面或者是下面那几个方法好多了，也没说好说的。 第三个就是验证码插件，所谓的验证码插件就是大家见到的输入验证码才能进入下一步操作，在用户体验上面来说，这是最差的体验，比起其他方法要动的地方多得多，故不考虑。 第四个方法就是现在绝大部分网站所用到的<a href="https://wordpress.org/plugins/some-chinese-please/" target="_blank" rel="noopener">Some Chinese Please!</a>他的简介是这样说的：<code>这是为用为中文写作的朋友准备的一款防御spam插件。&lt;br&gt;&lt;/br&gt; 它可以有效地拦截内容中不带有中文字的comment和trackback(pingback)，不写入数据库中，可有效地减小spam对blog服务器的无谓使用。</code> 从简介来看对于国内的环境的确很完美，但唯一的区别就是歪果仁如果想评论的话…可能会炸的。 对于以上总结这么多的，要么自增一个选项，要么修改评论机制，都不是合适我的胃口。</p><h3 id="方案"><a href="#方案" class="headerlink" title="方案"></a>方案</h3><blockquote><p>2018.05.19已更新</p></blockquote><p>新建PHP文件，并且引入</p><pre><code>&lt;?phpif ( ! defined( &apos;ABSPATH&apos; ) ) { // prevent full path disclosure    exit;}$spicy_send_spam_comment_to_admin = false; // 开启则会将垃圾评论发到管理员邮箱$spicy_log_spam_comment = false; // 开启则会记录log文件than rejected spam comments will be logged to wp-content/plugins/anti-spam/log/anti-spam-2015-11.log$spicy_allow_trackbacks = false; // i开启则会允许使用trackbacks$spicy_settings = array(    &apos;send_spam_comment_to_admin&apos; =&gt; $spicy_send_spam_comment_to_admin,    &apos;allow_trackbacks&apos; =&gt; $spicy_allow_trackbacks,    &apos;admin_email&apos; =&gt; get_option(&apos;admin_email&apos;),    &apos;log_spam_comment&apos; =&gt; $spicy_log_spam_comment);/** * 仅为具有评论表单的页面加载脚本 修改脚本地址 */function spicy_enqueue_script() {    global $withcomments; // WP所有页面上显示评论    if ((is_singular() || $withcomments) &amp;&amp; comments_open()) { //         wp_enqueue_script(&apos;anti-spam-script&apos;, get_template_directory_uri() .&apos;/assets/javascript/spam.min.js&apos;, null, MATERIAL_VERSION, true);    }}add_action(&apos;wp_enqueue_scripts&apos;, &apos;spicy_enqueue_script&apos;);function spicy_form_part() {    global $spicy_settings;    $rn = &quot;\r\n&quot;; // .chr(13).chr(10)    if ( ! is_user_logged_in()) { // add anti-spam fields only for not logged in users        echo &apos;&lt;p class=&quot;antispam-group antispam-group-q&quot; style=&quot;clear: both;&quot;&gt;            &lt;label&gt;Current ye@r &lt;span class=&quot;required&quot;&gt;*&lt;/span&gt;&lt;/label&gt;            &lt;input type=&quot;hidden&quot; name=&quot;antspm-a&quot; class=&quot;antispam-control antispam-control-a&quot; value=&quot;&apos;.date(&apos;Y&apos;).&apos;&quot; /&gt;            &lt;input type=&quot;text&quot; name=&quot;antspm-q&quot; class=&quot;antispam-control antispam-control-q&quot; value=&quot;&apos;.MATERIAL_VERSION.&apos;&quot; autocomplete=&quot;off&quot; /&gt;        &lt;/p&gt;&apos;.$rn; // question (hidden with js)        echo &apos;      &lt;p class=&quot;antispam-group antispam-group-e&quot; style=&quot;display: none;&quot;&gt;            &lt;label&gt;Leave this field empty&lt;/label&gt;            &lt;input type=&quot;text&quot; name=&quot;antspm-e-email-url-website&quot; class=&quot;antispam-control antispam-control-e&quot; value=&quot;&quot; autocomplete=&quot;off&quot; /&gt;        &lt;/p&gt;&apos;.$rn; // empty field (hidden with css); trap for spammers because many bots will try to put email or url here    }}add_action(&apos;comment_form&apos;, &apos;spicy_form_part&apos;); // add anti-spam inputs to the comment formfunction spicy_check_comment($commentdata) {    global $spicy_settings;    $rn = &quot;\r\n&quot;; // .chr(13).chr(10)    extract($commentdata);    $spicy_pre_error_message = &apos;&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;javascript:window.history.back()&quot;&gt;Go back&lt;/a&gt;&lt;/strong&gt; and try again.&lt;/p&gt;&apos;;    $spicy_error_message = &apos;&apos;;    if (($spicy_settings[&apos;send_spam_comment_to_admin&apos;]) || ($spicy_settings[&apos;log_spam_comment&apos;])) { // if sending email to admin is enabled or loging        $post = get_post($comment-&gt;comment_post_ID);        $spicy_message_spam_info  = &apos;Spam for post: &quot;&apos;.$post-&gt;post_title.&apos;&quot;&apos; . $rn;        $spicy_message_spam_info .= get_permalink($comment-&gt;comment_post_ID) . $rn.$rn;        $spicy_message_spam_info .= &apos;IP: &apos; . $_SERVER[&apos;REMOTE_ADDR&apos;] . $rn;        $spicy_message_spam_info .= &apos;User agent: &apos; . $_SERVER[&apos;HTTP_USER_AGENT&apos;] . $rn;        $spicy_message_spam_info .= &apos;Referer: &apos; . $_SERVER[&apos;HTTP_REFERER&apos;] . $rn.$rn;        $spicy_message_spam_info .= &apos;Comment data:&apos;.$rn; // lets see what comment data spammers try to submit        foreach ($commentdata as $key =&gt; $value) {            $spicy_message_spam_info .= &apos;$commentdata[&apos;.$key. &apos;] = &apos;.$value.$rn;        }        $spicy_message_spam_info .= $rn.$rn;        $spicy_message_spam_info .= &apos;Post vars:&apos;.$rn; // lets see what post vars spammers try to submit        foreach ($_POST as $key =&gt; $value) {            $spicy_message_spam_info .= &apos;$_POST[&apos;.$key. &apos;] = &apos;.$value.$rn;        }        $spicy_message_spam_info .= $rn.$rn;        $spicy_message_spam_info .= &apos;Cookie vars:&apos;.$rn; // lets see what cookie vars spammers try to submit        foreach ($_COOKIE as $key =&gt; $value) {            $spicy_message_spam_info .= &apos;$_COOKIE[&apos;.$key. &apos;] = &apos;.$value.$rn;        }        $spicy_message_spam_info .= $rn.$rn;        $spicy_message_append = &apos;-----------------------------&apos;.$rn;        $spicy_message_append .= &apos;This is spam comment rejected by Anti-spam plugin - wordpress.org/plugins/anti-spam/&apos; . $rn;        $spicy_message_append .= &apos;You may edit &quot;anti-spam.php&quot; file and disable this notification.&apos; . $rn;        $spicy_message_append .= &apos;You should find &quot;$spicy_send_spam_comment_to_admin&quot; and make it equal to &quot;false&quot;.&apos; . $rn;    }    if ( ! is_user_logged_in() &amp;&amp; $comment_type != &apos;pingback&apos; &amp;&amp; $comment_type != &apos;trackback&apos;) { // logged in user is not a spammer        $spam_flag = false;        $antspm_q = &apos;&apos;;        if (isset($_POST[&apos;antspm-q&apos;])) {            $antspm_q = trim($_POST[&apos;antspm-q&apos;]);        }        $antspm_d = &apos;&apos;;        if (isset($_POST[&apos;antspm-d&apos;])) {            $antspm_d = trim($_POST[&apos;antspm-d&apos;]);        }        $antspm_e = &apos;&apos;;        if (isset($_POST[&apos;antspm-e-email-url-website&apos;])) {            $antspm_e = trim($_POST[&apos;antspm-e-email-url-website&apos;]);        }        if ( $antspm_q != date(&apos;Y&apos;) ) { // year-answer is wrong - it is spam            if ( $antspm_d != date(&apos;Y&apos;) ) { // extra js-only check: there is no js added input - it is spam                $spam_flag = true;                if (empty($antspm_q)) { // empty answer - it is spam                    $spicy_error_message .= &apos;Error: empty answer. [&apos;.esc_attr( $antspm_q ).&apos;]&lt;br&gt; &apos;.$rn;                } else {                    $spicy_error_message .= &apos;Error: answer is wrong. [&apos;.esc_attr( $antspm_q ).&apos;]&lt;br&gt; &apos;.$rn;                }            }        }        if ( ! empty($antspm_e)) { // trap field is not empty - it is spam            $spam_flag = true;            $spicy_error_message .= &apos;Error: field should be empty. [&apos;.esc_attr( $antspm_e ).&apos;]&lt;br&gt; &apos;.$rn;        }        if ($spam_flag) { // it is spam            $spicy_error_message .= &apos;&lt;strong&gt;Comment was blocked because it is spam.&lt;/strong&gt;&lt;br&gt; &apos;;            if ($spicy_settings[&apos;send_spam_comment_to_admin&apos;]) {                $spicy_subject = &apos;Spam comment on site [&apos;.get_bloginfo(&apos;name&apos;).&apos;]&apos;; // email subject                $spicy_message = &apos;&apos;;                $spicy_message .= $spicy_error_message . $rn.$rn;                $spicy_message .= $spicy_message_spam_info; // spam comment, post, cookie and other data                $spicy_message .= $spicy_message_append;                @wp_mail($spicy_settings[&apos;admin_email&apos;], $spicy_subject, $spicy_message); // send spam comment to admin email            }            if ($spicy_settings[&apos;log_spam_comment&apos;]) {                $spicy_message = $rn.$rn.&apos;========== ========== ==========&apos;.$rn.$rn;                $spicy_message .= $spicy_error_message . $rn.$rn;                $spicy_message .= $spicy_message_spam_info; // spam comment, post, cookie and other data            }            wp_die( $spicy_pre_error_message . $spicy_error_message ); // die - do not send comment and show errors        }    }    if ( ! $spicy_settings[&apos;allow_trackbacks&apos;]) { // if trackbacks are blocked (pingbacks are alowed)        if ($comment_type == &apos;trackback&apos;) { // if trackbacks ( || $comment_type == &apos;pingback&apos;)            $spicy_error_message .= &apos;Error: trackbacks are disabled.&lt;br&gt; &apos;;            if ($spicy_settings[&apos;send_spam_comment_to_admin&apos;]) { // if sending email to admin is enabled                $spicy_subject = &apos;Spam trackback on site [&apos;.get_bloginfo(&apos;name&apos;).&apos;]&apos;; // email subject                $spicy_message = &apos;&apos;;                $spicy_message .= $spicy_error_message . $rn.$rn;                $spicy_message .= $spicy_message_spam_info; // spam comment, post, cookie and other data                $spicy_message .= $spicy_message_append;                @wp_mail($spicy_settings[&apos;admin_email&apos;], $spicy_subject, $spicy_message); // send trackback comment to admin email            }            wp_die($spicy_pre_error_message . $spicy_error_message); // die - do not send trackback        }    }    return $commentdata; // if comment does not looks like spam}if ( ! is_admin()) {    add_filter(&apos;preprocess_comment&apos;, &apos;spicy_check_comment&apos;, 1);}</code></pre><p><code>spam.js</code>填写：</p><pre><code>(function () {    function a() {        var d, b, g, f = &quot;&quot;, e = new Date().getFullYear(), h;        g = document.querySelectorAll(&quot;.antispam-group&quot;);        b = g.length;        for (d = 0; d &lt; b; d++) {            g[d].style.display = &quot;none&quot;        }        g = document.querySelectorAll(&quot;.antispam-control-a&quot;);        if ((g) &amp;&amp; (g.length &gt; 0)) {            f = g[0].value        }        g = document.querySelectorAll(&quot;.antispam-control-q&quot;);        b = g.length;        for (d = 0; d &lt; b; d++) {            g[d].value = f        }        g = document.querySelectorAll(&quot;.antispam-control-e&quot;);        b = g.length;        for (d = 0; d &lt; b; d++) {            g[d].value = &quot;&quot;        }        h = document.createElement(&quot;input&quot;);        h.setAttribute(&quot;type&quot;, &quot;hidden&quot;);        h.setAttribute(&quot;name&quot;, &quot;antspm-d&quot;);        h.setAttribute(&quot;class&quot;, &quot;antispam-control antispam-control-d&quot;);        h.setAttribute(&quot;value&quot;, e);        g = document.querySelectorAll(&quot;form&quot;);        b = g.length;        for (d = 0; d &lt; b; d++) {            if ((g[d].id === &quot;comments&quot;) || (g[d].id === &quot;respond&quot;) || (g[d].id === &quot;commentform&quot;)) {                var c = g[d].className.indexOf(&quot;anti-spam-form-processed&quot;);                if (c === -1) {                    g[d].appendChild(h);                    g[d].className = g[d].className + &quot; anti-spam-form-processed&quot;                }            }        }    }    if (document.addEventListener) {        document.addEventListener(&quot;DOMContentLoaded&quot;, a, false)    }    setTimeout(function () {        a()    }, 1000)})();</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WordPress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>人渣的自白</title>
      <link href="/the-scumbag.html"/>
      <url>/the-scumbag.html</url>
      
        <content type="html"><![CDATA[<p>终于得到自由的我，却变得更寂寞了。</p><p>从听到那两个字以后已经过了三个月，想当初听到那两个字往后的几天还抱持著希望，在地狱的边缘翻滚垂死挣扎。可能你会觉得我以「地狱」这个词彙来形容这种任谁都会经历过的事情有点夸张，可在我的心裡，这的确是个彷彿受尽地狱之火灼烫的伤心事。</p><p>起初的感觉是不著实的，以为只要像以往一样哄一下就能雨过天晴，没想到事情不像我想像般简单，我第一次看见极为理性的她。听到她确切回覆的那一刻，我的心是崩溃的，有生以来第一次嚎啕大哭得连站立的力气也没有，有生以来没有经历过比这更痛心入骨的事了，那种有如灵魂被撕裂的痛楚。</p><p>那天之后的数日后，我写了一封信，然后拜託朋友拿给她，然后再从朋友口中听到她冷淡的回应后，我继续徘徊于地狱之中。那以后的校园生活每天都很苦闷，坐在这块回忆之地，每一秒都有她的残影让我的脑袋感觉快要窒息，回忆也夹杂著碎片于我心中来回穿梭开割，那时常常感到受不了了，便拿起背包向老师随便编个藉口便转身回家。只是回到家后也没有变得比较舒畅，那个时间家裡不会有人，自己一个人思绪会变得更加繁乱，满满的脑袋只有她的背影，都是在担忧她往后的生活，担忧她的心会倾向哪个男人。我是一个懦弱的人，时常缅怀过去。记得曾经有一次我提起的分手，封锁了她的通讯软件好让她难找到我，没料到她致电来向我嚎天啕地，问我是不是真的要分手，其中还大呼了一句︰「我想死。」可惜当时的我还不了解当一个人说出这句话时心裡是有多痛。</p><p>嗯，当时的我还不了解，但这句话到现在也经常以她的声线在我脑袋中迴响。</p><p>那时躺在家裡经常萌生轻生的念头，因为我实在是找不到人生的意义，也向朋友坦言过有这种想法，结果当然是惹来一段训骂了。不过说实话，口中嚷嚷著想死丶想死的人，几乎十个有九个都没有真去寻死的。况且前面说过了，我是一个懦弱的人，即使有足够的决心也缺乏足够的勇气，这就是为什麽我还生存至今。至今这种想法也依然在我脑海中盘旋不散，我也常常奢望要是来一埸意外能夺去我的性命就好了。</p><p>青春期的时候看少女漫画比较多，那时常常认为要是自己将来能谈恋爱誓必会像各位男主角一样，像王子一样爱著像公主的她吧。可惜事与愿违，我成为了一个与自己理想完全相反的男人，一个不折不扣的人渣，人渣的程度就不在这裡详述了，你们只需要知道我是一个人渣就对了。那时躺在家中，经常回忆起以往的点点滴滴，不过大多都是回忆起自己的种种恶行。以后的日子裡后悔与遗憾充斥著我血管全身，想著想著不禁眼泛泪光，每天浸淫于感伤之中。</p><p>两个月后，因为不经意在社交网站看到她与友人的合照，因而触目崩心，整天于感伤中渡过。那一天，我再次不断回首过往，思念之情有如水从杯子大量满泻，就算没有倒满也会像啤酒一样冒泡溢出，势不可挡。</p><p>当天中午蓦然想起之前看电影时令我印象很深的一句话︰「人啊！正因为活著，才能相见。」那时的我恍然大悟，细思自己还在避忌什麽？是因为害怕连「朋友」的身份也失去吗？其实自己心底裡一早已知晓，哪能做回什麽朋友。倘若一个男人能与一个曾与自己热恋过丶同床过的女人再会，并且心裡毫无半点龌龊杂念去与其成为朋友，那种人要不就是情埸浪子丶要不就是专业的伪善者。我两者都不是，因此我知道自己只有两个选择，破镜重圆再次成为恋人或是……成为永远的陌生人。</p><p>当晚我行动了，在大概十一点左右致电给她，之后我有如被一下重击打落十八层地狱。</p><p>也许你们会觉得失恋这种事是大多数人的人生都必会经历的事，为何我能如此夸大其辞，说得好像真有如地狱之火，明明自己都没有下过地狱。嗯……，这个问题我这三个月也在不断反覆思考，到底是为什麽呢？于是我在大脑内经过一番斟酌后，为自己总括出一种可能性，也是我自己认为是最为接近答案的诠释。</p><p>上面提及过，我从年少时已经有一种要成为「旷世好男人」的理想，怎料在这段感情裡我所成为的角色却与当初的理想北辕适楚。最不堪的是，我是在这段感情完结后才意识到自己过往所做的事有多恶劣，以前以为谈恋爱就是没有隐瞒，要将自己真实的想法向伴侣表露无遗，即使知道对方听到后会感到痛心也在所不惜，从不掩饰自己伤人的锋芒，将人性的骨感折射得淋漓尽致。后知后觉的我在往后的日子裡不断地对以前的憾事追忆，心裡愈来愈难以忍受那种「理想的自己」与「真实的自己」对比之下所产生的强烈冲击感，心裡一直坚持的崇高道德观被猛烈衝撞丶想要弥补过错却没有赎罪的机会，油然而生一种强烈的自我厌恶感。这种自我厌恶感这三个月来不断缠绕著我，难以控制地不断回忆起自己怎麽一手蹂躏一个女生丶怎麽一手摧毁一段爱情。</p><p>以前她将爱慕的目光灌注于我身上，我却无时无刻觊觎著大叠的钞票。直到有刻她将目光移开，我才醒悟出哪个是最重要。若要在这段感情裡数算她的缺点的话，我几乎连一个都数不出来，都是我的错。</p><p>翌日的我完全走不出那晚的阴霾，心裡堆叠了一层又一层的伤感，伏在床上看著窗口，多次想一跃而下结束这种痛苦煎熬。无奈我终究是胆怯头颅著地爆开的痛楚，所以最后还是静静的拿起手机，轻敲玻璃屏，将心事告诉朋友Ｂ。</p><p>我与朋友Ｂ自幼便相识，他跟我同是懦弱的人，虽说同是懦弱的人，但在本质上却有著决定性的差异。朋友Ｂ从外到内都是一个散发著柔弱气息的男人，以前的他总是摆出一副弱者的容貌，所以一直受到爱人的欺侮。他曾屡次付出过努力与真心，却始终换不来一刻的忠诚，是个被命运捉弄的男人。而我，则是一个在欺侮爱人过后良心发现，再把自己搁置一旁自怨自艾的废物罢了。</p><p>我把那晚的事简略地以简讯告诉朋友Ｂ，不能详述的原因是因为当时的我在电话中语无伦次，大概连自己都不清楚自己在说什麽。按下发送键后把电话放下，静静地等待朋友Ｂ的回覆，心中猜测著他会怎样谴责我过份的衝动。过了几分钟旁边传来「叮！」的一声，从屏幕上显示了四个细小的汉字在朋友Ｂ的名字底下。</p><p>「你很勇敢。」</p><p>我顿时感动得泪如雨下，本应做好了被斥责的心理准备，没想过寄回来的是如此感人心脾的一句说话。朋友Ｂ坦言自己没有这种勇气，亦指对她而言，我这回确实是狂妄之举。但对于他而言，我在硬撑著一个残酷的事实。我相信朋友Ｂ所用的「勇敢」这个词彙，无论是出于何种因素，都绝对是褒义的，想必是对我这种狂妄之举致上的一个最高敬意。</p><p>在一切刚开始时，实在有幸友人们听闻后都远赴赶来陪著我，我十分感激有幸能认识这一群朋友。只是在我大放悲声的期间，好像有一个朋友受不了我那丢人的容貌，在旁讪笑了一声，我是听得见的，印象也很深刻。这位朋友(以下称为朋友Ｗ)从来不缺乏异性朋友，对他而言，爱情不会是件重要的事，来就让它来，去就让它去，不会感到特别开心，也不会感到特别伤心，是个潇洒的浪子。可是我也从中感觉到他是个空虚之人，生活上丰衣足食丶社交圈子也颇为广阔，但内心是空虚的丶是不充实的。像他这样的人，大概从来没有试过真正的爱上一个人吧。</p><p>当初的我会每天都向友人们诉苦，刚开始时还好，友人都对我投以怜悯的目光，但到了后来，我所吐的苦水似乎会使人变得烦躁。他们觉得对我是对牛弹琴，我也一样。久而久之，我开始意识到不能再去相信什麽感同身受丶什麽切肤之痛，针不插到别人身上，哪有人会愿意与你感同身受去尝试理解你的痛。</p><p>想当初朋友Ｂ为情所困时我也是一样，多次怂恿他分手。口裡讲的是不忍心看著他一再受到伤害，但心裡想的却只是不屑他当时女朋友的行为，从而利用朋友Ｂ当时的文弱去发洩对他女朋友的不悦，却忽略了朋友Ｂ自身的感受。毕竟那时候我还得意洋洋地牵著她，那时朋友Ｂ的感受对我来说根本不痛不痒。此刻我才明白，原来当别人来向自己诉苦时大可不必说任何话，因为没有人会了解当事人的感受，也不要胡乱猜测事情的发展，因为猜错了只会使自己背负沉重的责任感，就像我对朋友Ｂ一样。到现在我也常常认为要是当时没有说那种话就好了，因为比起现在，朋友Ｂ为情所困的容貌可能会更来得好看。</p><p>前阵子友人们常忍受不住我那落寞的眼神，纷纷建议我到夜店或是妓馆，好让我藉著接触其他异性来将她忘记，以毒攻毒。乍听之下我显然是有点心动的，毕竟自问除了心理方面自己也算是个健全的男儿。但过了不久这种心动便烟飞云散，只因我察觉到自己是个拥有高尚爱情道德观的人，说白了大概也就是个古板之人吧。我无法忍受女人紧贴著不相熟的男人，一脸千娇百媚地扭动著身体露出荡妇般的媚态；我无法忍受自己心裡记挂著一个女人，又去与其他女人享受鱼水之欢。只得肉体激烈的碰撞，却没有灵魂交叠的感觉，这种性事大概也只会徒添空虚吧。我发誓这绝对不是在自命清高，充其量只是一种超乎常人的贪婪而已。</p><p>在她刚离开不久后，我满脑子都淨是想著要改变自己，想要变得成熟丶想要得到得更多肯定丶想要再次得到她的肯定。</p><p>当初朋友Ｗ与我都感到生活极为空虚，因此常想要一起埋首苦干成就一番壮举，可惜缺乏相关的知识，因此而停步不前，最后不了了之。最近朋友Ｗ的生活变得比以前充实了，我多少有些嫉妒，单纯对他充实的生活感到嫉妒。朋友Ｗ也常常邀约我参加各色各样的热闹活动，好像总是想要把我从孤独中拯救出来，对此我十分感谢他的用心。只是最近我察觉到，自己并不适合那样的生活。就像不能把淡水鱼丢进大海，比起热闹的街区与朋友间的七嘴八舌，我似乎更嚮往宁静的环境与适当的孤独。</p><p>环观三个月后的彼此，想必她在事业及生活上已有一定程度的成功了吧。而我却只是一介书生，整天浑浑噩噩摊坐于课室却没有汲取到半点有用的知识，至今仍是踌躇不前，一无是处。我感觉自己是个输家丶是个失败者。</p><p>就在最近，我又不经意从社交网站看到她分享的帖子，从内容中隐约能发现，我最不希望发生的事情发生了。我感伤万分，有时真希望她能把心一横，把我从她的社交网站删除，删除我那连讚好都不能按的挂名朋友关系。</p><p>最初，我是不希望她得到幸福的，儘管自己曾二度在信中祝她过得幸福。我曾写过两封信，其中一封如上面所说已交予她手，至于另一封长信到底有没有顺利的交予到她手中到现在也不得而知，我也不想去知。最初我多希望她能被外面的哪个坏男人伤害，然后哭丧著脸回到我的怀裡。只是后来每当我再有这种恶毒的想法，一些她曾对我说过的话便会浮现于脑海丶迴响于耳边。</p><p>「你永远都是这麽自私！」</p><p>「要是真有丧尸末世的到来，你大概会是像尸杀列车裡面的容锡那种人吧！」</p><p>每当忆起这些对话，我就对怀著这种恶毒想法的自己感到极为羞耻，无论再怎麽的想去改变，到头来自己还是一个有己无人的家伙。我试著去祝福她，却始终不能，我没法做到无私地诚心诚意祝她幸福。因此我只希望她不再受到伤害，我认为她已经被我伤得够多了。</p><p>夏目漱石曾经写过这麽一句话：「无论我如何爱慕她，对方若将爱的眼神灌注在别人身上，我不愿意和这样的女人在一起。」</p><p>我对拥有这种潇洒爱情观的夏目漱石感到羡慕不已，不过这种情况大概仅囿限于还没开始交往的暧昧男女吧。我极为痛苦，只因我是个迟钝的人渣，我清醒地看著自己沉沦在一段不会有结果的爱恋。若问及此刻我的爱慕到底有多深，我可以以性命担保现在这个世上没人能比我更爱她。纵使我知道我与她已不再合衬丶纵使我知道她已结交新欢丶纵使我知道自己已再没能力拥抱幸福。</p><p>这是一个放荡的年代，年轻一辈总是喜欢在刚开始交往时对伴侣告诫一句：「我希望你不要想得太长远，我只希望我们能享受当下的时光。」这句话具有强烈的自我保护意识，同时也具有浓烈的矛盾感，他们害怕爱情带来的伤痛，却又想要以身试险窥探爱情的甜果。我说不出这种不负责任的话，我也不会有任何动力去维繫一段扮家家酒的爱情，亦因此我常被友人嘲讽是个不入世的自闭者。</p><p>记得过往朋友Ｂ曾在喝酒时说过这麽一句话：「人与人，果然还是应该保持距离。」当时懵懂的我对这句话不明所以。事后才发现恋爱时所有的山盟海誓都只是一堆不切实际的纸上谈兵，充其量只是一种被美化的诈骗技巧，最终都将化为乌有。儘管在许诺时有多真诚，若在最后察觉到自身的无能，便会跌进苦痛的深渊，久久不能自己。人与人若太过亲近，就只会互相伤害而已。</p><p>前阵子与友人聊天时，他莫名大呼了一句：「好想谈恋爱！」当下听到这句话的我不禁从心裡予以一阵暗嘲。本来无一物，何处惹尘埃。人生来就是孤独的个体，即使没有恋爱滋润也能自在地生活，为何总是贪婪得去渴求爱情这种既虚幻又痛苦的事。</p><p>「若能避开猛烈的狂喜，自然也不会有悲痛的来袭。」节录自太宰治的一句说话。</p><p>我很喜欢这句话，理性且富有感情。假若有一天我能放下这段感情，我不敢再渴求这样的情感，我不愿被人伤害，也不愿再伤害别人。也许是我太过懦弱，我没有勇气再跌进痛苦的漩涡，没有勇气再到地狱徘徊一趟。为了避免结束，我选择避免开始。因此我希望上天能对我宽容一点，不要让我与她在这细小狭窄的香港再次碰见，好让彼此永远消失于对方的世界。</p><p>也许有天我会忘记她的声音丶会忘记她的长相，甚至连与她的回忆也一併抛诸脑后。不过没关系，这就是为什麽我会留下这篇文章。我不愿让自己忘记这种痛苦的感觉，每当想起这种痛苦，我就会想起她，想起自己所作的恶行。</p><p>我是一个人渣，这是我内心的独白，同时也是我最真实的声音，请容我在此将其命名为─《人渣的自白》。</p><p>仅以此文，记载我丑陋的人性，同时纪念有那麽一个人曾经点缀过我的青春。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>修复Android ROM的Google网络定位</title>
      <link href="/fix-the-google-network-targeting-for-android-rom.html"/>
      <url>/fix-the-google-network-targeting-for-android-rom.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>一些定制、第三方 ROM 在安装了 Google 框架后，仍然无法使用其网络定位功能。我在网上搜索了许多资料，整理如下。<br>本文假设你的设备已经 Root，并已经安装了 Google 框架。我测试用的 ROM 为一加氢 OS。</p><h4 id="一、准备工具"><a href="#一、准备工具" class="headerlink" title="一、准备工具"></a>一、准备工具</h4><p>需要准备的工具有 <code>zip</code>、<code>unzip</code>、<code>apktool</code>、<code>adb</code>、<code>zipalign</code>，以及一个好使的文本编辑器。</p><h4 id="二、提取需要的资源"><a href="#二、提取需要的资源" class="headerlink" title="二、提取需要的资源"></a>二、提取需要的资源</h4><p>取出 ROM 中的 framework-res.apk，并反编译得到需要修改的文件：</p><pre><code>adb pull /system/framework/framework-res.apkapktool if framework-res.apkapktool d framework-res.apk</code></pre><h4 id="三、修改文件"><a href="#三、修改文件" class="headerlink" title="三、修改文件"></a>三、修改文件</h4><p>修改位置提供商相关设置，使用 Google 提供网络定位。<br>1、修改 <code>framework-res/res/values/arrays.xml</code>，找到 <code>config_locationProviderPackageNames</code> 的位置，确保 Google 在列表中。如我的 ROM 默认只有 <code>com.android.location.fused</code> 和 <code>com.amap.android.location</code> 两项，这时应当加入 <code>com.google.android.gms</code>，使得最终结果类似这样：</p><pre><code>&lt;string-array name=&quot;config_locationProviderPackageNames&quot;&gt;    &lt;item&gt;com.google.android.gms&lt;/item&gt;    &lt;item&gt;com.android.location.fused&lt;/item&gt;    &lt;item&gt;com.amap.android.location&lt;/item&gt;&lt;/string-array&gt;</code></pre><p>2、修改 <code>framework-res/res/values/bools.xml</code>，启用 <code>config_enableNetworkLocationOverlay</code> 和 <code>config_enableFusedLocationOverlay</code>。如果原来的值是 <code>false</code>，把它们改成 <code>true</code>：</p><pre><code>&lt;bool name=&quot;config_enableNetworkLocationOverlay&quot;&gt;true&lt;/bool&gt;&lt;bool name=&quot;config_enableFusedLocationOverlay&quot;&gt;true&lt;/bool&gt;</code></pre><p>3、修改 <code>framework-res/res/values/strings.xml</code>，设置 <code>config_networkLocationProviderPackageName</code> 为 <code>com.google.android.gms</code>。</p><pre><code>&lt;string name=&quot;config_networkLocationProviderPackageName&quot;&gt;com.google.android.gms&lt;/string&gt;</code></pre><p>（我一并修改了 <code>config_fusedLocationProviderPackageName</code> 为 <code>com.android.location.fused</code>，虽然可能是不必要的）<br>四、应用修改<br>1、重新编译，并从结果中提取出需要的部分：</p><pre><code>apktool b framework-resunzip -j framework-res/dist/framework-res.apk resources.arsc -d ./</code></pre><p>2、将提取出的文件替换到原来的 framework-res.apk 中：</p><pre><code>cp framework-res.apk framework-res-modified.apkzip -0 framework-res-modified.apk resources.arsc</code></pre><p>3、对资源进行 4 字节对齐处理：</p><pre><code>zipalign 4 framework-res-modified.apk framework-res-aligned.apk</code></pre><p>4、将修改后的 ROM 和更新脚本上传到手机：<br>这个更新脚本是我自己写的，主要处理了权限问题：</p><p><code>install-framework-res.sh</code>:</p><pre><code>#!/bin/shmount -o remount,rw /systemmv &quot;$1&quot; /system/framework-res.apkchmod 644 /system/framework-res.apkchown root:root /system/framework-res.apkmv /system/framework-res.apk /system/framework/framework-res.apk</code></pre><p>和修改后的 framework-res-aligned.apk 一起上传到手机：</p><pre><code>adb push framework-res-aligned.apk install-framework-res.sh /sdcard/</code></pre><p>5、运行脚本，替换 apk 文件：</p><pre><code>adb shell</code></pre><p>如果此时得到了 <code>$</code> 命令符，请先获得 <code>root</code>：</p><pre><code>su</code></pre><p>然后运行脚本：</p><pre><code>sh /sdcard/install-framework-res.sh /sdcard/framework-res-aligned.apk</code></pre><p>6、重启到 <code>Recovery</code>，清空 <code>Cache &amp; Dalvik Cache</code>，再次重启回到系统。<br>至此，你的手机应该重新拥有了网络定位功能，赶快打开一个除地图以外的需要定位的 App （比如 Ingress）测试吧！</p><h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><p><a href="https://www.wuxiancheng.com/repair-hongmi-google-maps-network-location.html" target="_blank" rel="noopener">https://www.wuxiancheng.com/repair-hongmi-google-maps-network-location.html</a><br><a href="http://en.miui.com/thread-70357-1-1.html" target="_blank" rel="noopener">http://en.miui.com/thread-70357-1-1.html</a></p><blockquote><p>本文转自：<a href="https://blog.felixc.at/2016/09/fix-google-gms-network-location-on-your-android-rom/" target="_blank" rel="noopener">https://blog.felixc.at/2016/09/fix-google-gms-network-location-on-your-android-rom/</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EMD Vol 1707</title>
      <link href="/emd-vol-1707.html"/>
      <url>/emd-vol-1707.html</url>
      
        <content type="html"><![CDATA[<h3 id="2017-07-18"><a href="#2017-07-18" class="headerlink" title="2017.07.18"></a>2017.07.18</h3><p>原本以为，这个月依然是毫无波澜的过去，下一秒总是充满惊喜，总是被打个促手不及。</p><h3 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h3><p>很高兴这个月终于忙起来了，来看我也不是要咸鱼下去，公司有个项目需要三个月内去搞定，评估下问题不大，虽说现在很忙，但好歹有个目标去做，每天过得很充实。特别是这段时间，时间根本无法掌控，一不经意丢失了好多时间，当然越来越喜欢这样的工作日子，希望能够长期保持下去吧。</p><p>上面可能说到喜欢，或许麻痹自己吧，因为人一旦闲着就会胡思乱想…也不知道自己什么时候开始胡思乱想，有时候无法控制自己，果然害人害已。虽说现在工作很忙，但是毫无压力，之前在外地工作，毕竟在异地，时时刻刻需要保持战斗，生怕下一刻被人淘汰下去，可以说现在所谓的<code>危机意识</code>就是这么来的吧。</p><p>本来再过半个月看看，如果还是和前面一样，考虑跳槽新环境。然而计划总赶不上变化，随遇而安吧。</p><p>今年打算学点管理层的知识了，考虑从上游争取机会了，漫漫长路，不有点成就简直对不起来一趟世界！</p><h3 id="生活"><a href="#生活" class="headerlink" title="生活"></a>生活</h3><p>之前有个朋友拉我去健身，赶上所谓的健身活动，果断去办理一张健身卡，只要下班有空就慢慢健身吧，一是加强锻炼身体，二是在私人空间里希望过得更充实，三是扩展人脉。虽然现在谈恋爱不怎么去，不过最近稳定下来，考虑重回健身房吧。好像最近天好像挺热的，黄色警告都出来，为了避免中暑，嗯，所以打算不去了，秋季再说吧。</p><p>其次就是家中的事，虽然最近和父母不怎么联系，但一直从爷爷奶奶得知消息，父亲已经和阿姨拿到结婚证，说真的，当时得到消息，只是稍微惊讶了下，想到当时正好去年和母亲离婚的时间段…唉，真没想到有时候，人真的好无情，几十年的感情竟无法抵过新欢。也是，毕竟当初父母在一起勉强的，以至于后期生活一直处于俩人不友好的状况，我也就是唯一让他们维持走下去的理由吧？现在独立了，俩人自然离了~</p><p>有时候，还是蛮羡慕别人的完整的家庭，还好童年的记忆中，家庭一直是完整的，这不幸中的万幸吧。说到上面的感情的事，也明白感情的事千万不能勉强，否则害人害已。</p><h3 id="感情"><a href="#感情" class="headerlink" title="感情"></a>感情</h3><p>这个月初谈了恋爱，本来今年没有这个打算，总感觉自己没有准备好感情付出，再加上一直暗恋一个人，觉得再去接受另外一个人，真的好难，好在暗恋要放弃，要不然也不会做下此决定。当真正的面对新感情的时候，我犹豫了很久，因为感情付出太多，得不到回报最终受伤的是自己。所以我还是选择赌一把。之后感情发展连自己控制不了，干脆由它吧。和她相处的时候，感觉到喜欢我比我喜欢她多得多，希望未来的日子相处的好好的。</p><p>或者恋爱中的人是自私的，连我如此，不过还是放开吧，那感觉也不好受…</p><blockquote><p>正正经经去谈场恋爱吧！</p></blockquote><hr><p>到目前为止，我已经不知道喜欢是什么感觉，之前遇到所谓感觉，综合来讲并不是所谓的<code>喜欢</code>的感觉，准确的是<code>欣赏</code>吧？有些人的出现就像流星一样，耀眼又短暂从我的生活一划而过，总有一天，我永远不会再记住你，也不会再留念。即便我的性格极端，也是如此！</p><blockquote><p>有些人出现在你的生命里教会你一些事情然后彻底的消失，就如同从你的全世界路过，致我曾爱过的人儿。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>MUI 请求的页面无法打开 viewgroup</title>
      <link href="/mui-request-page-can-not-open-viewgroup.html"/>
      <url>/mui-request-page-can-not-open-viewgroup.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>今天在做多个<code>webview</code>实例中就发现一直报<code>viewgroup无法打开</code>的错误，对比官方的demo没感觉哪里儿错了。</p><p>本来这个坑很早就挖到了，无奈那时候直接换一个方法，想着这次彻底解决了吧。</p><h3 id="方案"><a href="#方案" class="headerlink" title="方案"></a>方案</h3><p>官方实例中对于<code>new webviewGroup</code>信息太少，以至于这么重要的参数遗忘…坑啊。</p><p>这个参数其实本页面的id，这个id在哪里设置的呢，上一个页面打开此页面时咯。</p><p>方法一、改成此页面的id即可。</p><p>方法二、获取当前页面的id，赋值给他就行了。</p><p>实例：</p><pre><code>mui.plusReady(function() {    var currentId = plus.webview.currentWebview().id;    var group = new webviewGroup(currentId, {        items: [{            id: &quot;open-supervision-tap1&quot;,            url: &quot;open-supervision-tap1.html&quot;,            extras: {}        }, {            id: &quot;open-supervision-tap2&quot;,            url: &quot;open-supervision-tap2.html&quot;,            extras: {}        }, {            id: &quot;open-supervision-tap3&quot;,            url: &quot;open-supervision-tap3.html&quot;,            extras: {}        }, {            id: &quot;open-supervision-tap4&quot;,            url: &quot;open-supervision-tap4.html&quot;,            extras: {}        }, {            id: &quot;open-supervision-tap5&quot;,            url: &quot;open-supervision-tap5.html&quot;,            extras: {}        }, {            id: &quot;open-supervision-tap6&quot;,            url: &quot;open-supervision-tap6.html&quot;,            extras: {}        }, {            id: &quot;open-supervision-tap7&quot;,            url: &quot;open-supervision-tap7.html&quot;,            extras: {}        }],        onChange: function(obj) {            var c = document.querySelector(&quot;.mui-control-item.mui-active&quot;);            if(c) {                c.classList.remove(&quot;mui-active&quot;);            }            document.querySelector(&quot;.mui-scroll .mui-control-item:nth-child(&quot; + (parseInt(obj.index) + 1) + &quot;)&quot;).classList.add(&quot;mui-active&quot;);        }    });    mui(&quot;.mui-scroll&quot;).on(&quot;tap&quot;, &quot;.mui-control-item&quot;, function(e) {        var wid = this.getAttribute(&quot;data-wid&quot;);        group.switchTab(wid);    });});</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MUI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL数据引擎InnoDB和MyISAM互相转换</title>
      <link href="/mysql-data-engine-innodb-and-myisam-conversion.html"/>
      <url>/mysql-data-engine-innodb-and-myisam-conversion.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>最近发现博客某些页面数据加载特别慢，一开始以为是数据库缓存导致的，即时去掉数据库缓存也不行，毫无效果，搜索相关资料，目前可能确定是数据库引擎有关。</p><p>关于这俩个引擎，可以百度搜索下资料了解下，虽然<code>InnoDB</code>比<code>MyISAM</code>更为先进，也带来很多改进，但是对系统资源占用明显增加，对于个人博客来说，<code>InnoDB</code>是不合适的，还是得换回<code>MyISAM</code>。</p><p>下面讲解将从<code>InnoDB</code>切换到<code>MyISAM</code>：</p><p>打开终端输入：</p><pre><code>#登录，回车输入密码mysql -uroot -p#显示数据库MariaDB [iiong]&gt; show databases;#例如本人wordpress数据库为iiongMariaDB [iiong]&gt; USE iiong;Database changed#查询数据表MariaDB [iiong]&gt; show tables;+-----------------------+| Tables_in_iiong       |+-----------------------+| wj_commentmeta        || wj_comments           || wj_links              || wj_options            || wj_postmeta           || wj_posts              || wj_term_relationships || wj_term_taxonomy      || wj_termmeta           || wj_terms              || wj_usermeta           || wj_users              |+-----------------------+12 rows in set (0.00 sec)#转换引擎(table_name为上面查询的数据表名)ALTER TABLE table_name ENGINE=MYISAM;</code></pre><p>转换完毕后，可以把InnoDB引擎关闭并将<code>MyISAM</code>设为今后<code>MySQL</code>的默认引擎，编辑<code>/etc/my.cnf</code>文件，在<code>[mysqld]</code>修改如下：</p><pre><code>default_storage_engine = MYISAMinnodb=OFF#default_storage_engine = InnoDB#innodb_file_per_table = 1#innodb_open_files = 500#innodb_buffer_pool_size = 128M#innodb_write_io_threads = 4#innodb_read_io_threads = 4#innodb_thread_concurrency = 0#innodb_purge_threads = 1#innodb_flush_log_at_trx_commit = 2#innodb_log_buffer_size = 2M#innodb_log_file_size = 32M#innodb_log_files_in_group = 3#innodb_max_dirty_pages_pct = 90#innodb_lock_wait_timeout = 120</code></pre><p>保存后重启<code>mysqld</code>服务即可。</p><p>效果可以到<code>phpMyAdmin</code>表类型可以看到。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
            <tag> MariaDB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSM02.编写基础配置文件</title>
      <link href="/write-the-underlying-configuration-file.html"/>
      <url>/write-the-underlying-configuration-file.html</url>
      
        <content type="html"><![CDATA[<p><a href="https://iiong.com/ssm01-build-maven-development-environment.html" target="_blank" rel="noopener">SSM01.搭建Maven开发环境</a></p><h3 id="数据库配置"><a href="#数据库配置" class="headerlink" title="数据库配置"></a>数据库配置</h3><p>在<code>resources</code>文件夹下新建个<code>jdbc.properties</code>文件：</p><pre><code>jdbc.driverClassName=com.mysql.jdbc.Driverjdbc.url=jdbc:mysql://127.0.0.1:3306/ssm?useUnicode=true&amp;characterEncoding=utf8jdbc.username=rootjdbc.password=</code></pre><p>新建数据库叫<code>ssm</code>，在执行SQL语句窗口执行：</p><pre><code>CREATE TABLE `users`(    `user_id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT &apos;用户ID&apos;,    `name` VARCHAR(100) NOT NULL COMMENT &apos;用户姓名&apos;,    `age` INT(11) NOT NULL COMMENT &apos;用户年龄&apos;,    `email` VARCHAR(200) NOT NULL COMMENT &apos;电子邮箱&apos;,    PRIMARY KEY(`user_id`)) ENGINE = InnoDB AUTO_INCREMENT = 1 DEFAULT CHARSET = utf8 COMMENT = &apos;用户表&apos;</code></pre><p>表结构如下：</p><pre><code>+---------+--------------+------+-----+---------+----------------+| Field   | Type         | Null | Key | Default | Extra          |+---------+--------------+------+-----+---------+----------------+| users_id | bigint(20)   | NO   | PRI | NULL    | auto_increment || name    | varchar(100) | NO   |     | NULL    |                || gender  | varchar(100) | NO   |     | NULL    |                || email   | varchar(200) | NO   |     | NULL    |                |+---------+--------------+------+-----+---------+----------------+</code></pre><h3 id="添加mybatis配置文件"><a href="#添加mybatis配置文件" class="headerlink" title="添加mybatis配置文件"></a>添加mybatis配置文件</h3><p>在<code>resources</code>目录下新建文件：<code>mybatis-config.xml</code>:</p><ul><li>使用自增主键</li><li>使用列别名</li><li><p>开启驼峰命名转换 create_time -&gt; createTime</p><p>&lt;?xml version=”1.0” encoding=”UTF-8” ?&gt;</p><configuration><br><!-- 配置全局属性 --><br>   <settings><br><!-- 使用jdbc的getGeneratedKeys获取数据库自增主键值 --><br>       <setting name="useGeneratedKeys" value="true"><br><!-- 使用列别名替换列名 默认:true --><br>       <setting name="useColumnLabel" value="true"><br><!-- 开启驼峰命名转换:Table{create_time} -> Entity{createTime} --><br>       <setting name="mapUnderscoreToCamelCase" value="true"><br>   </setting></setting></setting></settings><br></configuration></li></ul><h3 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h3><p>先在<code>resources</code>文件夹新建个<code>spring</code>文件夹，由于Spring需要配置很多，分为三个配置文件：</p><ul><li>spring-dao.xml</li><li>spring-service.xml</li><li>spring-web.xml</li></ul><p>配置内容如下：</p><ul><li>读入数据库连接相关参数（可选）</li><li>配置数据连接池</li><li>配置连接属性，可以不读配置项文件直接在这里写死</li><li>配置c3p0，只配了几个常用的</li><li>配置SqlSessionFactory对象（mybatis）</li><li>扫描dao层接口，动态实现dao接口，也就是说不需要daoImpl，sql和参数都写在xml文件上</li></ul><blockquote><p>idea编辑器可以在右键项目有个<code>add framework support</code>选项可以添加相关的框架配置文件。<br><code>spring-dao.xml</code>内容如下：</p></blockquote><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;       xmlns:p=&quot;http://www.springframework.org/schema/p&quot;       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans    http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;    &lt;!-- 配置整合mybatis过程 --&gt;    &lt;!-- 1. 引入数据库配置文件 --&gt;    &lt;bean id=&quot;propertyConfigurer&quot;          class=&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;&gt;        &lt;property name=&quot;locations&quot;&gt;            &lt;list&gt;                &lt;!--oracle数据库配置文件--&gt;                &lt;value&gt;classpath:jdbc.properties&lt;/value&gt;            &lt;/list&gt;        &lt;/property&gt;    &lt;/bean&gt;    &lt;!-- 2.数据库连接池 --&gt;    &lt;bean id=&quot;dataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot;          init-method=&quot;init&quot; destroy-method=&quot;close&quot;&gt;        &lt;property name=&quot;driverClassName&quot; value=&quot;${jdbc.driverClassName}&quot;/&gt;        &lt;property name=&quot;url&quot; value=&quot;${jdbc.url}&quot;/&gt;        &lt;property name=&quot;username&quot; value=&quot;${jdbc.username}&quot;/&gt;        &lt;property name=&quot;password&quot; value=&quot;${jdbc.password}&quot;/&gt;        &lt;!-- 配置初始化大小、最小、最大 --&gt;        &lt;property name=&quot;initialSize&quot; value=&quot;1&quot;/&gt;        &lt;property name=&quot;minIdle&quot; value=&quot;1&quot;/&gt;        &lt;property name=&quot;maxActive&quot; value=&quot;10&quot;/&gt;        &lt;!-- 配置获取连接等待超时的时间 --&gt;        &lt;property name=&quot;maxWait&quot; value=&quot;10000&quot;/&gt;        &lt;!-- 配置间隔多久才进行一次检测，检测需要关闭的空闲连接，单位是毫秒 --&gt;        &lt;property name=&quot;timeBetweenEvictionRunsMillis&quot; value=&quot;60000&quot;/&gt;        &lt;!-- 配置一个连接在池中最小生存的时间，单位是毫秒 --&gt;        &lt;property name=&quot;minEvictableIdleTimeMillis&quot; value=&quot;300000&quot;/&gt;        &lt;property name=&quot;testWhileIdle&quot; value=&quot;true&quot;/&gt;        &lt;!-- 这里建议配置为TRUE，防止取到的连接不可用 --&gt;        &lt;property name=&quot;testOnBorrow&quot; value=&quot;true&quot;/&gt;        &lt;property name=&quot;testOnReturn&quot; value=&quot;false&quot;/&gt;        &lt;!-- 打开PSCache，并且指定每个连接上PSCache的大小 --&gt;        &lt;property name=&quot;poolPreparedStatements&quot; value=&quot;true&quot;/&gt;        &lt;property name=&quot;maxPoolPreparedStatementPerConnectionSize&quot; value=&quot;20&quot;/&gt;        &lt;!-- 这里配置提交方式，默认就是TRUE，可以不用配置 --&gt;        &lt;property name=&quot;defaultAutoCommit&quot; value=&quot;true&quot;/&gt;        &lt;!-- 验证连接有效与否的SQL，不同的数据配置不同 --&gt;        &lt;property name=&quot;validationQuery&quot; value=&quot;select 1 &quot;/&gt;        &lt;property name=&quot;filters&quot; value=&quot;stat&quot;/&gt;        &lt;property name=&quot;proxyFilters&quot;&gt;            &lt;list&gt;                &lt;ref bean=&quot;logFilter&quot;/&gt;            &lt;/list&gt;        &lt;/property&gt;    &lt;/bean&gt;    &lt;bean id=&quot;logFilter&quot; class=&quot;com.alibaba.druid.filter.logging.Slf4jLogFilter&quot;&gt;        &lt;property name=&quot;statementExecutableSqlLogEnable&quot; value=&quot;false&quot;/&gt;    &lt;/bean&gt;    &lt;bean id=&quot;transactionManager&quot;          class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt;    &lt;/bean&gt;    &lt;!-- 3. 配置SqlSessionFactory对象 --&gt;    &lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;        &lt;!-- 注入数据库连接池 --&gt;        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt;        &lt;!-- 配置MyBaties全局配置文件:mybatis-config.xml --&gt;        &lt;property name=&quot;configLocation&quot; value=&quot;classpath:mybatis-config.xml&quot;/&gt;    &lt;/bean&gt;    &lt;!-- 4. 配置扫描Dao接口包，动态实现Dao接口，注入到spring容器中 --&gt;    &lt;bean class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt;        &lt;!-- 注入sqlSessionFactory --&gt;        &lt;property name=&quot;sqlSessionFactoryBeanName&quot; value=&quot;sqlSessionFactory&quot;/&gt;    &lt;/bean&gt;&lt;/beans&gt;</code></pre><p><code>spring-service.xml</code>内容如下：</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;      xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;      xmlns:context=&quot;http://www.springframework.org/schema/context&quot;      xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;      xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans   http://www.springframework.org/schema/beans/spring-beans.xsd   http://www.springframework.org/schema/context   http://www.springframework.org/schema/context/spring-context.xsd   http://www.springframework.org/schema/tx   http://www.springframework.org/schema/tx/spring-tx.xsd&quot;&gt;&lt;!-- 配置事务管理器 --&gt;   &lt;bean id=&quot;transactionManager&quot;         class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;&lt;!-- 注入数据库连接池 --&gt;       &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;   &lt;/bean&gt;&lt;!-- 配置基于注解的声明式事务 --&gt;   &lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot; /&gt;&lt;/beans&gt;</code></pre><p><code>spring-web.xml</code>内容如下：</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;      xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;      xmlns:context=&quot;http://www.springframework.org/schema/context&quot;      xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;      xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans   http://www.springframework.org/schema/beans/spring-beans.xsd   http://www.springframework.org/schema/context   http://www.springframework.org/schema/context/spring-context.xsd   http://www.springframework.org/schema/mvc   http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd&quot;&gt;&lt;!-- 配置SpringMVC --&gt;&lt;!-- 1.开启SpringMVC注解模式 --&gt;&lt;!-- 简化配置：       (1)自动注册DefaultAnootationHandlerMapping,AnotationMethodHandlerAdapter       (2)提供一些列：数据绑定，数字和日期的format @NumberFormat, @DateTimeFormat, xml,json默认读写支持   --&gt;   &lt;mvc:annotation-driven /&gt;&lt;!-- 2.静态资源默认servlet配置       (1)加入对静态资源的处理：js,gif,png       (2)允许使用&quot;/&quot;做整体映射    --&gt;   &lt;mvc:default-servlet-handler/&gt;&lt;!-- 3.配置jsp 显示ViewResolver --&gt;   &lt;bean class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;       &lt;property name=&quot;viewClass&quot; value=&quot;org.springframework.web.servlet.view.JstlView&quot; /&gt;       &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/jsp/&quot; /&gt;       &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot; /&gt;   &lt;/bean&gt;&lt;/beans&gt;</code></pre><h3 id="配置web-xml"><a href="#配置web-xml" class="headerlink" title="配置web.xml"></a>配置web.xml</h3><p>在<code>main/webapp/WEB-INF/web.xml</code>内容如下：</p><pre><code>&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee                     http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot; version=&quot;3.1&quot; metadata-complete=&quot;true&quot;&gt;&lt;!-- 配置DispatcherServlet --&gt; &lt;servlet&gt;   &lt;servlet-name&gt;seckill-dispatcher&lt;/servlet-name&gt;   &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;&lt;!-- 配置springMVC需要加载的配置文件       spring-dao.xml,spring-service.xml,spring-web.xml       Mybatis - &gt; spring -&gt; springmvc    --&gt;   &lt;init-param&gt;     &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;     &lt;param-value&gt;classpath:spring/spring-*.xml&lt;/param-value&gt;   &lt;/init-param&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt;   &lt;servlet-name&gt;seckill-dispatcher&lt;/servlet-name&gt;   &lt;!-- 默认匹配所有的请求 --&gt;   &lt;url-pattern&gt;/&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; &lt;!--http://IP:PROT/druid 访问监控页面--&gt; &lt;!--http://localhost:8080/druid--&gt; &lt;servlet&gt;   &lt;servlet-name&gt;DruidStatView&lt;/servlet-name&gt;   &lt;servlet-class&gt;com.alibaba.druid.support.http.StatViewServlet&lt;/servlet-class&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt;   &lt;servlet-name&gt;DruidStatView&lt;/servlet-name&gt;   &lt;url-pattern&gt;/druid/*&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; &lt;filter&gt;   &lt;filter-name&gt;druidWebStatFilter&lt;/filter-name&gt;   &lt;filter-class&gt;com.alibaba.druid.support.http.WebStatFilter&lt;/filter-class&gt;   &lt;init-param&gt;     &lt;param-name&gt;exclusions&lt;/param-name&gt;     &lt;param-value&gt;/public/*,*.js,*.css,/druid*,*.jsp,*.swf&lt;/param-value&gt;   &lt;/init-param&gt;   &lt;init-param&gt;     &lt;param-name&gt;principalSessionName&lt;/param-name&gt;     &lt;param-value&gt;sessionInfo&lt;/param-value&gt;   &lt;/init-param&gt;   &lt;init-param&gt;     &lt;param-name&gt;profileEnable&lt;/param-name&gt;     &lt;param-value&gt;true&lt;/param-value&gt;   &lt;/init-param&gt; &lt;/filter&gt; &lt;filter-mapping&gt;   &lt;filter-name&gt;druidWebStatFilter&lt;/filter-name&gt;   &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt;&lt;/web-app&gt;</code></pre><h3 id="配置logback"><a href="#配置logback" class="headerlink" title="配置logback"></a>配置logback</h3><p>在<code>resources</code>文件夹新建<code>logback.xml</code>，内容如下：</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;configuration debug=&quot;true&quot;&gt;  &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;    &lt;!-- encoders are by default assigned the type ch.qos.logback.classic.encoder.PatternLayoutEncoder --&gt;    &lt;encoder&gt;      &lt;pattern&gt;%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n&lt;/pattern&gt;    &lt;/encoder&gt;  &lt;/appender&gt;  &lt;root level=&quot;debug&quot;&gt;    &lt;appender-ref ref=&quot;STDOUT&quot; /&gt;  &lt;/root&gt;&lt;/configuration&gt;</code></pre><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="https://start.spring.io/" target="_blank" rel="noopener">Spring</a><br><a href="http://www.yiibai.com/springjdbc/" target="_blank" rel="noopener">易百教程</a><br><a href="https://logback.qos.ch/documentation.html" target="_blank" rel="noopener">logback Docments</a></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Java Web </tag>
            
            <tag> SSM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSM01.搭建Maven开发环境</title>
      <link href="/ssm01-build-maven-development-environment.html"/>
      <url>/ssm01-build-maven-development-environment.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>这俩年我发现SSM好像挺火了，尝试下几个Demo，发现SSM简直就是黄金搭配。本来一直停留在<code>SSH(Struts2 + Spring + Hibernate)</code>够好了，发现<code>SSM(SringMVC + Spring + Mybatis)</code>开发更简洁…</p><p>目前项目再加个<code>Maven</code>项目管理工具，有这个对项目管理Jar包更方便，相信用过前端的<code>Node.js</code>的<code>npm</code>再去用它发现很相似。</p><ol><li>SpringMVC：它用于web层，相当于controller（等价于传统的servlet和struts的action），用来处理用户请求。</li><li>Spring：与我们平时开发接触最多的估计就是IOC容器，它可以装载bean（也就是我们java中的类，当然也包括service dao里面的），有了这个机制，我们就不用在每次使用这个类的时候为它初始化，很少看到关键字new。另外spring的aop，事务管理等等都是我们经常用到的。</li><li>MyBatis：第一，它能自由控制sql，这会让有数据库经验的人编写的代码能搞提升数据库访问的效率。第二，它可以使用xml的方式来组织管理我们的sql，因为一般程序出错很多情况下是sql出错，别人接手代码后能快速找到出错地方，甚至可以优化原来写的sql。</li></ol><h3 id="配置环境"><a href="#配置环境" class="headerlink" title="配置环境"></a>配置环境</h3><p>先去<a href="http://maven.apache.org/download.cgi" target="_blank" rel="noopener">http://maven.apache.org/</a>官网下载Maven，<code>Binary tar.gz archive</code>或者<code>Binary zip archive</code>都行，下载放在对应的磁盘或者目录下。然后根据自己所需环境加入系统环境变量，这个需要自己配置了。配置好后打开终端输入命令：</p><pre><code>➜  ~ mvn -vApache Maven 3.5.0 (ff8f5e7444045639af65f6095c62210b5713f426; 2017-04-04T03:39:06+08:00)Maven home: /usr/local/Cellar/maven/3.5.0/libexecJava version: 1.8.0_131, vendor: Oracle CorporationJava home: /Library/Java/JavaVirtualMachines/jdk1.8.0_131.jdk/Contents/Home/jreDefault locale: zh_CN, platform encoding: UTF-8OS name: &quot;mac os x&quot;, version: &quot;10.12.5&quot;, arch: &quot;x86_64&quot;, family: &quot;mac&quot;➜  ~ </code></pre><p>反馈相关jdk环境以及maven版本号即正确安装完成！</p><blockquote><p>Maven 3.3+ require JDK 1.7 or above to execute. Maven 3.3+ 需要JDK1.7以上的版本支持。</p></blockquote><h3 id="小技巧"><a href="#小技巧" class="headerlink" title="小技巧"></a>小技巧</h3><p>我对Mevan也不是太会玩，感觉和前端的<code>node.js</code>中<code>npm</code>包管理工具差不多…由于Maven下载依赖包环境的服务器在国外Apache服务器上，很慢。有如下解决：</p><p>国内稍微好点就阿里了，暂时这样吧，以后再更新。</p><p>阿里镜像：<a href="http://maven.aliyun.com/nexus/content/groups/public/" target="_blank" rel="noopener">http://maven.aliyun.com/nexus/content/groups/public/</a></p><p>配置镜像有俩个办法：</p><p>*. 修改Maven安装包下面的<code>conf/settings.xm</code>文件，打开寻找下面的关键词：</p><pre><code>&lt;mirrors&gt;   &lt;!-- mirror    | Specifies a repository mirror site to use instead of a given repository. The repository that    | this mirror serves has an ID that matches the mirrorOf element of this mirror. IDs are used    | for inheritance and direct lookup purposes, and must be unique across the set of mirrors.    |   &lt;mirror&gt;     &lt;id&gt;mirrorId&lt;/id&gt;     &lt;mirrorOf&gt;repositoryId&lt;/mirrorOf&gt;     &lt;name&gt;Human Readable Name for this Mirror.&lt;/name&gt;     &lt;url&gt;http://my.repository.com/repo/path&lt;/url&gt;   &lt;/mirror&gt;    --&gt; &lt;/mirrors&gt;</code></pre><p>修改成：</p><pre><code>&lt;mirrors&gt;   &lt;mirror&gt;     &lt;id&gt;nexus-public-snapshots&lt;/id&gt;     &lt;mirrorOf&gt;public-snapshots&lt;/mirrorOf&gt;     &lt;name&gt;Aliyun Maven&lt;/name&gt;    &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt;   &lt;/mirror&gt; &lt;/mirrors&gt;</code></pre><p>保存文件即可。</p><p>*. 还有个在当前用户目录 的 <code>.m2</code> 目录下的 setting.xml 文件，内容和上面一样：</p><pre><code>&lt;mirrors&gt;   &lt;mirror&gt;     &lt;id&gt;nexus-public-snapshots&lt;/id&gt;     &lt;mirrorOf&gt;public-snapshots&lt;/mirrorOf&gt;     &lt;name&gt;Aliyun Maven&lt;/name&gt;    &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt;   &lt;/mirror&gt; &lt;/mirrors&gt;</code></pre><h3 id="目录结构规范"><a href="#目录结构规范" class="headerlink" title="目录结构规范"></a>目录结构规范</h3><p>目录结构需要遵循maven的目录规范：</p><p>文件名</p><p>作用</p><p>src</p><p>根目录</p><p>main</p><p>主要目录，可以放java代码和一些资源文件</p><p>java</p><p>存放我们的java代码，这个文件夹要使用Build Path -&gt; Use as Source Folder，这样看包结构会方便很多，新建的包就相当于在这里新建文件夹</p><p>resources</p><p>存放资源文件，如各种的spring，mybatis，log配置文件</p><p>mapper</p><p>存放dao中每个方法对应的sql，在这里配置，无需写daoImpl</p><p>spring</p><p>这里当然是存放spring相关的配置文件，有dao service web三层</p><p>sql</p><p>存放SQL存储文件</p><p>webapp</p><p>用来存放我们前端的静态资源，如jsp js css</p><p>resources</p><p>这里的资源是指项目的静态资源，如js css images等</p><p>WEB-INF</p><p>很重要的一个目录，外部浏览器无法访问，只有羡慕内部才能访问，可以把jsp放在这里，另外就是web.xml了</p><p>test</p><p>这里是测试分支</p><p>java</p><p>测试java代码，应遵循包名相同的原则，这个文件夹同样要使用Build Path -&gt; Use as Source Folder，这样看包结构会方便很多</p><p>resources</p><p>### 配置Maven依赖</p><p>打开<code>pom.xml</code>文件，加入项目所需的依赖jar包，在<code>project</code>标签内填入：</p><pre><code>&lt;dependencies&gt;    &lt;!-- 单元测试 --&gt;    &lt;dependency&gt;        &lt;groupId&gt;junit&lt;/groupId&gt;        &lt;artifactId&gt;junit&lt;/artifactId&gt;        &lt;version&gt;4.11&lt;/version&gt;    &lt;/dependency&gt;    &lt;!-- 1.日志 --&gt;    &lt;!-- 实现slf4j接口并整合 --&gt;    &lt;dependency&gt;        &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;        &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;        &lt;version&gt;1.1.1&lt;/version&gt;    &lt;/dependency&gt;    &lt;!-- 2.数据库 --&gt;    &lt;dependency&gt;        &lt;groupId&gt;mysql&lt;/groupId&gt;        &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;        &lt;version&gt;5.1.37&lt;/version&gt;        &lt;scope&gt;runtime&lt;/scope&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;c3p0&lt;/groupId&gt;        &lt;artifactId&gt;c3p0&lt;/artifactId&gt;        &lt;version&gt;0.9.1.2&lt;/version&gt;    &lt;/dependency&gt;    &lt;!-- DAO: MyBatis --&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.mybatis&lt;/groupId&gt;        &lt;artifactId&gt;mybatis&lt;/artifactId&gt;        &lt;version&gt;3.3.0&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.mybatis&lt;/groupId&gt;        &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;        &lt;version&gt;1.2.3&lt;/version&gt;    &lt;/dependency&gt;    &lt;!-- 3.Servlet web --&gt;    &lt;dependency&gt;        &lt;groupId&gt;taglibs&lt;/groupId&gt;        &lt;artifactId&gt;standard&lt;/artifactId&gt;        &lt;version&gt;1.1.2&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;jstl&lt;/groupId&gt;        &lt;artifactId&gt;jstl&lt;/artifactId&gt;        &lt;version&gt;1.2&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;        &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;        &lt;version&gt;2.5.4&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;javax.servlet&lt;/groupId&gt;        &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;        &lt;version&gt;3.1.0&lt;/version&gt;    &lt;/dependency&gt;    &lt;!-- 4.Spring --&gt;    &lt;!-- 1)Spring核心 --&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.springframework&lt;/groupId&gt;        &lt;artifactId&gt;spring-core&lt;/artifactId&gt;        &lt;version&gt;4.1.7.RELEASE&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.springframework&lt;/groupId&gt;        &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;        &lt;version&gt;4.1.7.RELEASE&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.springframework&lt;/groupId&gt;        &lt;artifactId&gt;spring-context&lt;/artifactId&gt;        &lt;version&gt;4.1.7.RELEASE&lt;/version&gt;    &lt;/dependency&gt;    &lt;!-- 2)Spring DAO层 --&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.springframework&lt;/groupId&gt;        &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;        &lt;version&gt;4.1.7.RELEASE&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.springframework&lt;/groupId&gt;        &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;        &lt;version&gt;4.1.7.RELEASE&lt;/version&gt;    &lt;/dependency&gt;    &lt;!-- 3)Spring web --&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.springframework&lt;/groupId&gt;        &lt;artifactId&gt;spring-web&lt;/artifactId&gt;        &lt;version&gt;4.1.7.RELEASE&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.springframework&lt;/groupId&gt;        &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;        &lt;version&gt;4.1.7.RELEASE&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.springframework&lt;/groupId&gt;        &lt;artifactId&gt;spring-test&lt;/artifactId&gt;        &lt;version&gt;4.1.7.RELEASE&lt;/version&gt;    &lt;/dependency&gt;&lt;/dependencies&gt;&lt;build&gt;    &lt;finalName&gt;Learn_SSM&lt;/finalName&gt;    &lt;plugins&gt;        &lt;plugin&gt;            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;            &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;            &lt;configuration&gt;                &lt;source&gt;1.8&lt;/source&gt;                &lt;target&gt;1.8&lt;/target&gt;            &lt;/configuration&gt;        &lt;/plugin&gt;    &lt;/plugins&gt;&lt;/build&gt;</code></pre><p>ide会自然下载相关依赖文件到本地。</p><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="http://maven.apache.org/" target="_blank" rel="noopener">Apache</a><br><a href="http://www.yiibai.com/maven/" target="_blank" rel="noopener">易百教程</a></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Java Web </tag>
            
            <tag> SSM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>让Nginx支持BoringSSL</title>
      <link href="/nginx-support-boringssl.html"/>
      <url>/nginx-support-boringssl.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>因为OpenSSL之前爆发大漏洞，以至于现在的OpenSSL安全协议变得不安全。所以Google开辟了一个OpenSSL的分支，主要是为了更方便地进行自己的项目的开发，其中包含了谷歌自己定制的多个补丁。BoringSSL 是 Google 从 OpenSSL 拉出来的一个独立发展的分支，目前跟 OpenSSL 相比已经有很多不同之处了。</p><p><a href="https://boringssl.googlesource.com/boringssl/" target="_blank" rel="noopener">BoringSSL项目</a></p><h3 id="详细配置"><a href="#详细配置" class="headerlink" title="详细配置"></a>详细配置</h3><p>首先获取Nginx和BoringSSL的源码，而Nginx是从1.7.4版本支持BoringSSL。</p><pre><code>wget http://nginx.org/download/nginx-1.12.1.tar.gztar xzf nginx-1.12.1.tar.gzgit clone https://boringssl.googlesource.com/boringssl</code></pre><h3 id="安装编译环境："><a href="#安装编译环境：" class="headerlink" title="安装编译环境："></a>安装编译环境：</h3><pre><code># 安装编译 BoringSSL 所需的 Golangyum install golang# 忽略编译过程中的 Warning（不加这个，编到一半会因为 Warning 太多无法继续）export CFLAGS=&quot;-Wno-error&quot;</code></pre><h3 id="编译BoringSSL："><a href="#编译BoringSSL：" class="headerlink" title="编译BoringSSL："></a>编译BoringSSL：</h3><pre><code># 进入 BoringSSL 源码根目录cd boringssl# 创建 build 目录并编译，完成后回到 BoringSSL 源码根目录mkdir build &amp;&amp; cd build &amp;&amp; cmake ../ &amp;&amp; make &amp;&amp; cd ../# 创建 .openssl 目录，并将库文件和编译后的文件放进去mkdir -p .openssl/lib &amp;&amp; cd .openssl &amp;&amp; ln -s ../include . &amp;&amp; cd ../cp build/crypto/libcrypto.a build/ssl/libssl.a .openssl/libcd ../</code></pre><h3 id="平滑编译Nginx："><a href="#平滑编译Nginx：" class="headerlink" title="平滑编译Nginx："></a>平滑编译Nginx：</h3><pre><code># 进入 Nginx 源码根目录cd nginx-1.12.0# 指定使用 BoringSSL 作为 SSL 库，记得查询编译参数查询编译参数(nginx -V)./configure --with-openssl=../boringssl --with-http_v2_module --with-http_ssl_module# 修改时间，避免 Nginx 再次编译 BoringSSLtouch ../boringssl/.openssl/include/openssl/ssl.h#编译make#备份nginxmv /usr/local/nginx/sbin/nginx{,_`date +%F`}cp objs/nginx /usr/local/nginx/sbin# 显示boringssl表示已经安装成功nginx -V 2&gt;&amp;1 | grep -o boringssl</code></pre><h3 id="对称内容加密"><a href="#对称内容加密" class="headerlink" title="对称内容加密"></a>对称内容加密</h3><p>BoringSSL 支持了一种名为「等价加密算法组（Equal preference cipher groups）」的配置（详情），正好可以满足我们这个需求。</p><p>基于 BoringSSL 编译 Nginx 之后，可以像下面这样配置 <code>ssl_ciphers</code>：</p><pre><code>ssl_ciphers [ECDHE-ECDSA-AES128-GCM-SHA256|ECDHE-ECDSA-CHACHA20-POLY1305]:[ECDHE-RSA-AES128-GCM-SHA256|ECDHE-RSA-CHACHA20-POLY1305]:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:AES128-GCM-SHA256:AES256-GCM-SHA384:DES-CBC3-SHA;</code></pre><p>方括号之中的配置就是「等价加密算法组」，用竖线隔开的两种算法，会被自动应用于最合适的场景（支持 AES-NI 优先使用 AES-GCM，否则优先使用 ChaCha20）。最后的 <code>DES-CBC3-SHA</code> 是为了支持 Windows XP 上的 IE8 而加上去的。</p><p>基本上也就这样。</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
            <tag> 优化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>原生 JS+CSS 实现 Material Design 点击效果</title>
      <link href="/native-js-css-to-achieve-material-design-click-effect.html"/>
      <url>/native-js-css-to-achieve-material-design-click-effect.html</url>
      
        <content type="html"><![CDATA[<h3 id="原生-JS-CSS-实现-Material-Design-点击效果"><a href="#原生-JS-CSS-实现-Material-Design-点击效果" class="headerlink" title="原生 JS+CSS 实现 Material Design 点击效果"></a>原生 JS+CSS 实现 Material Design 点击效果</h3><p>需要实现类似的效果。</p><pre><code> &lt;div class=&quot;md-div demo-div&quot;&gt;&lt;/div&gt; &lt;button class=&quot;md-button&quot;&gt;文字&lt;/button&gt; &lt;div class=&quot;md-yuan yuan&quot;&gt;&lt;/div&gt;var ripple_utill = {        isEmptyObject: function(obj) {            for (let i in obj) { return false }            return true        },        hasClass: function(ele, className) {            return ele.className.match(new RegExp(&apos;(\\s|^)&apos; + className + &apos;(\\s|$)&apos;));        },        addClass: function(ele, className) {            if (!this.hasClass(ele, className)) { ele.className += &quot; &quot; + className; }            console.log(&apos;--addClass--&apos;)        },        removeClass: function(ele, className) {            if (this.hasClass(ele, className)) {                var reg = new RegExp(&apos;(\\s|^)&apos; + className + &apos;(\\s|$)&apos;);                ele.className = ele.className.replace(reg, &apos;&apos;);            }        },        /**         * @param {Element} ele         * @param {Int} noRM 不需要删除的子元素 index         */        removeAllChild: function(ele, noRM) {            let childrenList = ele.children;            for (let i = childrenList.length - 1; i &gt;= 0; i--) {                if (noRM === i) { continue }                ele.removeChild(childrenList[i]);            }        },        browserSupportEvent: function(eventName) {            return eventName in window;        }    }    /**     * 接收参数     * cName: &apos;md-button&apos;      * color： ‘#fff’     * r： 12 r默认是自动计算，有传入时使用自定义值;     * time： 1000      * rippleMultiple: true  是否出现多个水波纹     * MaxNum：3 最多出现多少个水波纹     * center: true 水波纹出现的位置     */Circular.prototype = {    r: 20,    cName: &apos;md-button&apos;,    color: &apos;rgba(0, 0, 0, 0.3)&apos;,    time: &apos;0.5s&apos;,    MaxNum: 5,    animationCName: &apos;ripple-animate&apos;,    wrapperCName: &apos;md-wrapper&apos;,    center: false,    zIndex: null,}function Circular() {    this.x = 0;    this.y = 0;    this.setX = function(newValue) {        this.x = newValue;    };    this.setY = function(newValue) {        this.y = newValue    };    this.createRipple = function(tagName = &apos;span&apos;) {        let span = document.createElement(tagName)        ripple_utill.addClass(span, &apos;md-ripple&apos;)        span.style.width = 2 * this.r + &apos;px&apos;;        span.style.height = 2 * this.r + &apos;px&apos;;        span.style.backgroundColor = this.color;        span.style.animationDuration = this.time;        return span    }}class Ripple {    constructor(obj) {        this.CIRCULAR = new Circular();        this.mouseFLAG = false; //是否可以移除        this.animateFLAG = false; //是否可以移除, 只有集齐两个flag才能移除        this.buttonList = null;        this.init(obj);        /*this.documentAddListener()*/        this.buttonAddClickEvent();    }    init(obj) {        if (!ripple_utill.isEmptyObject(obj)) {            this.CIRCULAR.cName = obj.cName || this.CIRCULAR.cName            this.CIRCULAR.center = obj.center || this.CIRCULAR.center            this.CIRCULAR.r = obj.r || this.computedR()            this.CIRCULAR.color = obj.color || this.CIRCULAR.color            this.CIRCULAR.time = obj.time || this.CIRCULAR.time            this.CIRCULAR.MaxNum = obj.MaxNum || this.CIRCULAR.MaxNum            this.CIRCULAR.zIndex = obj.zIndex || this.CIRCULAR.zIndex        }    };    //为所有按钮添加监听，添加span    buttonAddClickEvent() {        //创建button下的 span        this.buttonList = document.getElementsByClassName(this.CIRCULAR.cName);        for (let i = 0; i &lt; this.buttonList.length; i++) {            //let circular = new Circular()            //将所有按钮设置为相对定位            this.buttonList[i].style.position = &apos;relative&apos;            let wrapper = this.createRippleWrapper(this.CIRCULAR)            this.buttonList[i].appendChild(wrapper)                //添加点击监听，创建span            this.buttonList[i].addEventListener(&apos;click&apos;, (event) =&gt; {                    this.mouseFLAG = false;                    this.animateFLAG = false;                    this.reppleClick(event, this.buttonList[i], this.CIRCULAR, this.createRippleChildNode(wrapper));                })                //添加鼠标移出 监听。设置span为可移除状态            this.buttonList[i].addEventListener(&apos;mouseleave&apos;, (event) =&gt; {                this.mouseFLAG = true;                this.removeRipple(wrapper)            })        }    };    documentAddListener() {        document.addEventListener(&apos;touchstart&apos;, (touch) =&gt; {            let flag = ripple_utill.hasClass(touch.target, this.CIRCULAR.cName);            console.log(flag)        })    }    createRippleWrapper(circular) {        //在button下创建一个div作为wrapper，默认有一个span.        let div = document.createElement(&apos;div&apos;)        if (circular.zIndex != null) {            div.style.zIndex = circular.zIndex;        }        ripple_utill.addClass(div, this.CIRCULAR.wrapperCName)        let span = circular.createRipple(&apos;span&apos;)        span.addEventListener(&apos;animationend&apos;, (event) =&gt; {            this.animateFLAG = true;            ripple_utill.removeClass(span, this.CIRCULAR.animationCName);        })        div.appendChild(span);        return div;    };    createRippleChildNode(wrapper) {        //创建wrapper子节点span时，判断wrapper下是否有span空闲(动画停止)，空闲则重用，所有都没有则新建span。        let childrenList = wrapper.children;        for (let i = 0; i &lt; childrenList.length; i++) {            let flag = ripple_utill.hasClass(childrenList[i], this.CIRCULAR.animationCName)            if (flag == null) { //动画已经停止了                ripple_utill.addClass(childrenList[i], &apos;md-ripple&apos;)                return childrenList[i];            } else if (flag != null &amp;&amp; i === childrenList.length - 1 &amp;&amp; this.CIRCULAR.MaxNum &gt; childrenList.length) { //最后一个span &amp;&amp; 动画没有停止&amp;&amp; 没有超过最多个数                let span = this.CIRCULAR.createRipple(&apos;span&apos;);                span.addEventListener(&apos;animationend&apos;, (event) =&gt; {                    this.animateFLAG = true;                    //新建的span在动画结束后，如果全部span空闲，并且鼠标移出。则新建的span从wrapper中移除                    ripple_utill.removeClass(span, this.CIRCULAR.animationCName);                    this.removeRipple(wrapper);                })                wrapper.appendChild(span);                return span;            }        }        return childrenList[0];    };    /**     *      * @param {Element} wrapper      */    freeElementCount(wrapper) {        let count = 0;        let childrenList = wrapper.children;        for (let i = 0; i &lt; childrenList.length; i++) {            let flag = ripple_utill.hasClass(childrenList[i], this.CIRCULAR.animationCName)            if (flag == null) { //动画已经停止了                count++;            }        }        return count;    };    /**     * 鼠标点击时，设置span的位置     * @param {} event      * @param {Button} button      * @param {Circular} circular      * @param {Element} ripple      */    reppleClick(event, button, circular, ripple) {        this.computedCircleCenter(event, button);        //当span与原来的位置相同时，不改变位置        if (circular.x + &apos;px&apos; === ripple.style.left &amp;&amp; ripple.style.top === circular.y + &apos;px&apos;) {            console.log(&apos;点击位置相同&apos;);        } else {            ripple.style.left = circular.x + &apos;px&apos;;            ripple.style.top = circular.y + &apos;px&apos;;        }        ripple_utill.addClass(ripple, this.CIRCULAR.animationCName);    };    /**     * 计算并设置圆心的位置     * @param {Event} event      * @param {Button} button      */    computedCircleCenter(event, button) {        let positionX = 0        let positionY = 0;        if (this.CIRCULAR.center) {            /**按钮的中心位置  x= width/2  y= height/2 **/            let relativeX = button.offsetWidth / 2;            let relativeY = button.offsetHeight / 2;            positionX = relativeX - this.CIRCULAR.r;            positionY = relativeY - this.CIRCULAR.r;        } else {            /**点击的坐标相对与按钮的位置 = 点击的位置 - 获取按钮的位置              * x = 按钮x轴位置 - R             */            let relativeX = event.clientX - button.offsetLeft;            let relativeY = event.clientY - button.offsetTop;            positionX = relativeX - this.CIRCULAR.r;            positionY = relativeY - this.CIRCULAR.r;        }        //对数字取整        this.CIRCULAR.setX(parseInt(positionX));        this.CIRCULAR.setY(parseInt(positionY));    };    //计算半径    computedR() {        let button = document.getElementsByClassName(this.CIRCULAR.cName)[0];        let MaxR = button.clientHeight &gt; button.clientWidth ? button.clientHeight : button.clientWidth;        if (this.CIRCULAR.center) {            return Math.ceil(MaxR / 5 / 2)        }        return Math.ceil(MaxR / 5);    };    /**     * 移除span：     * pc端：当鼠标移出button并且动画停止时，移除创建的span。     * 移动端：点击button以外的地方并且动画停止时，移除span。     */    removeRipple(wrapper) {        //如果可以移除span        if (this.mouseFLAG &amp;&amp; this.animateFLAG) {            let count = this.freeElementCount(wrapper);            if (count === wrapper.children.length) {                ripple_utill.removeAllChild(wrapper, 0);            }        }    }}new Ripple({        cName: &apos;md-div&apos;,        /* r: 20,*/        time: &apos;0.5s&apos;,        color: &apos;rgba(0,0,0,0.1)&apos;,        MaxNum: 5    })    new Ripple({        cName: &apos;md-button&apos;,        r: 16,        color: &apos;rgba(0,0,0,0.1)&apos;,        time: &apos;0.5s&apos;,        MaxNum: 5    })    new Ripple({        cName: &apos;md-yuan&apos;,        color: &apos;rgba(0,0,0,0.1)&apos;,        time: &apos;0.5s&apos;,        MaxNum: 3,        center: true,        zIndex: 2    }).demo-div {        display: block;        position: relative;        margin: 0 auto;        width: 50%;        height: 100px;        border: 1px solid #000;        overflow: hidden;    }    button {        margin: 10px 10px;        position: relative;        background: white;        border: 1px solid #eee;        width: 80px;        height: 40px;        padding: 0;        overflow: hidden;    }    .yuan {        display: block;        position: relative;        width: 30px;        height: 30px;        margin: 10px 10px;        border-radius: 50%;        background-color: blueviolet;        overflow: hidden;    }    button:hover {        background-color: rgba(0, 0, 0, 0.1)    }    @keyframes ripple {    0% {        opacity: 1;    }    99% {        opacity: 1;    }    100% {        opacity: 0;        transform: scale(5);    }}/*决定水波纹的动画*/.ripple-animate {    animation: ripple 0.65s linear;    animation-fill-mode: forwards;    border-radius: 50%;}/*决定水波纹的位置*/.md-wrapper {    display: block;    width: 100%;    height: 100%;    position: absolute;    top: 0;    left: 0;    overflow: hidden;}.md-ripple {    position: absolute;    left: 0;    top: 0;    display: inline-block;    height: 20px;    width: 20px;    opacity: 0;    border-radius: 50%;}</code></pre><hr><h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h1><p>使用JavaScript制作 水波纹 特效。使用了animation 所以需要至少ie10。<br>master分支使用了es6语法，需浏览器支持es6. dev分支是es5语法。</p><h2 id="Import-using-script-tag"><a href="#Import-using-script-tag" class="headerlink" title="Import using script tag"></a>Import using script tag</h2><pre><code>&lt;link rel=&quot;stylesheet&quot; href=&quot;./ripple.css&quot; charset=&quot;utf-8&quot;&gt;&lt;script src=&quot;./ripple.js&quot;&gt;&lt;/script&gt;</code></pre><h1 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h1><p>可选参数</p><p>Option</p><p>Description</p><p>cName</p><p>element的className，默认为 “md-button”</p><p>r</p><p>水波纹最小半径，不传此参数则为自动计算</p><p>color</p><p>水波纹颜色 默认为：rgba(0, 0, 0, 0.3)</p><p>time</p><p>animation的时间 默认为：0.5s</p><p>MaxNum</p><p>水波纹的最大数量 默认为：5</p><p>center</p><p>水波纹的圆心。默认为：false</p><p>zIndex</p><p>设置z-index 默认为：null,当水波纹被覆盖时，可以使用此参数</p><p># Usage</p><pre><code>&lt;button class=&quot;md-button&quot;&gt;文字&lt;/button&gt;&lt;!--button得position将被设置为relative--&gt;new Ripple({        cName: &apos;md-button&apos;,        color: &apos;red&apos;,        time: &apos;0.5s&apos;,        MaxNum: 5    })</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> JavaScript </tag>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript监听粘贴事件</title>
      <link href="/javascript-paste-notes.html"/>
      <url>/javascript-paste-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>这几天研究下JavaScript中的<code>paste</code>事件，有了一些以下的参考笔记。</p><h3 id="事件对象"><a href="#事件对象" class="headerlink" title="事件对象"></a>事件对象</h3><pre><code>pasteEle.addEventListener(&quot;paste&quot;, function (e){    if ( !(e.clipboardData &amp;&amp; e.clipboardData.items) ) {        return;    }});</code></pre><p>粘贴事件提供了一个<code>clipboardData</code>的属性，如果该属性有<code>items</code>属性，那么就可以查看<code>items</code>中是否有图片类型的数据了。<code>Chrome</code>有该属性。</p><h3 id="clipboardData"><a href="#clipboardData" class="headerlink" title="clipboardData"></a>clipboardData</h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/ClipboardEvent/clipboardData" target="_blank" rel="noopener">MDN文档详解</a></p><p>介绍一下<code>clipboardData</code>对象，它实际上是一个<code>DataTransfer</code>类型的对象，<code>DataTransfer</code> 是拖动产生的一个对象，但实际上粘贴事件也是它。</p><p><code>clipboardData</code>的属性介绍：</p><p>属性</p><p>类型</p><p>说明</p><p>dropEffect</p><p>String</p><p>默认是None</p><p>effectAllowed</p><p>String</p><p>默认是uninitialized</p><p>files</p><p>FileList</p><p>粘贴操作为空List</p><p>items</p><p>DataTransferItemList</p><p>剪切板中的各项数据</p><p>types</p><p>Array</p><p>剪切板中的数据类型 该属性在Safari下比较混乱</p><p>### items</p><p><code>items</code>是一个<code>DataTransferItemList</code>对象，自然里面都是<code>DataTransferItem</code>类型的数据了。</p><p>属性</p><p>说明</p><p>kind</p><p>一般为string或者file</p><p>type</p><p>具体的数据类型，例如具体是哪种类型字符串或者哪种类型的文件，即MIME-Type</p><p>方法</p><p>参数</p><p>说明</p><p>getAsFile</p><p>空</p><p>如果kind是file，可以用该方法获取到文件</p><p>getAsString</p><p>回调函数</p><p>如果kind是string，可以用该方法获取到字符串，字符串需要用回调函数得到，回调函数的第一个参数就是剪切板中的字符串</p><p>### types</p><p>值</p><p>说明</p><p>text/plain</p><p>普通字符串</p><p>text/html</p><p>带样式的HTML</p><p>Files</p><p>文件(例如剪切板中的数据)</p><p>### 示例代码</p><pre><code>&lt;html lang=&quot;zh-CN&quot;&gt;   &lt;meta charset=&quot;UTF-8&quot;&gt;   &lt;title&gt;监听粘贴事件&lt;/title&gt;   &lt;style&gt;       textarea {           width: 100%;           height: 100px;       }   &lt;/style&gt;&lt;p&gt;选择一个图像，按Ctrl+C『Mac：Command+C』进行复制，转到编辑器按Ctrl+V『Mac：Command+V』即可粘贴。&lt;/p&gt;&lt;textarea&gt;&lt;/textarea&gt;&lt;div id=&quot;out&quot;&gt;&lt;/div&gt;&lt;script src=&quot;https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot;&gt;   //监听图像粘贴事件   $(document).on(&apos;paste&apos;, function (event) {       event = event.originalEvent;       var cbd = window.clipboardData || event.clipboardData; //兼容ie||chrome       var ua = window.navigator.userAgent;       if (!(event.clipboardData &amp;&amp; event.clipboardData.items)) {           return;       }       if (cbd.items &amp;&amp; cbd.items.length === 2 &amp;&amp; cbd.items[0].kind === &quot;string&quot; &amp;&amp; cbd.items[1].kind === &quot;file&quot; &amp;&amp;           cbd.types &amp;&amp; cbd.types.length === 2 &amp;&amp; cbd.types[0] === &quot;text/plain&quot; &amp;&amp; cbd.types[1] === &quot;Files&quot; &amp;&amp;           ua.match(/Macintosh/i) &amp;&amp; Number(ua.match(/Chrome\/(\d{2})/i)[1]) &lt; 49) {           return;       }       var itemLength = cbd.items.length;       if (itemLength === 0) {           return;       }       if (itemLength === 1 &amp;&amp; cbd.items[0].kind === &apos;string&apos;) {           return;       }       if ((itemLength === 1 &amp;&amp; cbd.items[0].kind === &apos;file&apos;)) {           var item = cbd.items[0];           var blob = item.getAsFile();           if (blob.size === 0) {               return;           }           //封装FileReader对象           function readBlobAsDataURL(blob, callback) {               var reader = new FileReader();               reader.onload = function (e) {                   callback(e.target.result);               };               reader.readAsDataURL(blob);           }           //传参           readBlobAsDataURL(blob, function (dataurl) {              // console.log(dataurl);               document.getElementById(&quot;out&quot;).innerHTML = &quot;&lt;img src=&quot; + dataurl + &quot; /&gt;&quot;;           });       }   })&lt;/script&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP下载远程图片</title>
      <link href="/php-download-remote-images.html"/>
      <url>/php-download-remote-images.html</url>
      
        <content type="html"><![CDATA[<p>在使用 PHP 做简单的爬虫的时候，我们经常会遇到需要下载远程图片的需求，所以下面来简单实现这个需求。</p><h3 id="1-使用-curl"><a href="#1-使用-curl" class="headerlink" title="1.使用 curl"></a>1.使用 curl</h3><p>比如我们有下面这两张图片：</p><pre><code>$images = [    &apos;https://dn-laravist.qbox.me/2015-09-22_00-17-06j.png&apos;,    &apos;https://dn-laravist.qbox.me/2015-09-23_00-58-03j.png&apos;];</code></pre><p>第一步，我们可以直接来使用最简单的代码实现：</p><pre><code>function download($url, $path = &apos;images/&apos;){    $ch = curl_init();    curl_setopt($ch, CURLOPT_URL, $url);    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30);    $file = curl_exec($ch);    curl_close($ch);    $filename = pathinfo($url, PATHINFO_BASENAME);    $resource = fopen($path . $filename, &apos;a&apos;);    fwrite($resource, $file);    fclose($resource);}</code></pre><p>那在下载远程图片的时候就可以这样：</p><pre><code>foreach ( $images as $url ) {    download($url);}</code></pre><h3 id="2-封装一个类"><a href="#2-封装一个类" class="headerlink" title="2.封装一个类"></a>2.封装一个类</h3><p>缕清思路之后，我们可以将这个基本的功能封装到一个类中：</p><pre><code>class Spider {    public function downloadImage($url, $path = &apos;images/&apos;)    {        $ch = curl_init();        curl_setopt($ch, CURLOPT_URL, $url);        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);        curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30);        $file = curl_exec($ch);        curl_close($ch);        $filename = pathinfo($url, PATHINFO_BASENAME);        $resource = fopen($path . $filename, &apos;a&apos;);        fwrite($resource, $file);        fclose($resource);    }}</code></pre><p>在者，我们还可以这样稍微优化一下：</p><pre><code>public function downloadImage($url, $path=&apos;images/&apos;)    {        $ch = curl_init();        curl_setopt($ch, CURLOPT_URL, $url);        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);        curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30);        $file = curl_exec($ch);        curl_close($ch);        $this-&gt;saveAsImage($url, $file, $path);    }    private function saveAsImage($url, $file, $path)    {        $filename = pathinfo($url, PATHINFO_BASENAME);        $resource = fopen($path . $filename, &apos;a&apos;);        fwrite($resource, $file);        fclose($resource);    }</code></pre><p>封装成类之后，我们可以这样调用代码来下载图片：</p><pre><code>$spider = new Spider();foreach ( $images as $url ) {    $spider-&gt;downloadImage($url);}</code></pre><p><strong>这样，对付基本的远程图片下载就OK了。</strong></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端跨域请求解决方案汇总</title>
      <link href="/cross-domain-resolution.html"/>
      <url>/cross-domain-resolution.html</url>
      
        <content type="html"><![CDATA[<p>同源策略限制从一个源加载的文档或脚本如何与来自另一个源的资源进行交互。这是一个用于隔离潜在恶意文件的关键的安全机制。但是有时候跨域请求资源是合理的需求，本文尝试从多篇文章中汇总至今存在的所有跨域请求解决方案。</p><h3 id="跨域请求"><a href="#跨域请求" class="headerlink" title="跨域请求"></a>跨域请求</h3><p>首先需要了解的是同源和跨源的概念。对于相同源，其定义为：如果协议、端口（如果指定了一个）和主机对于两个页面是相同的，则两个页面具有相同的源。只要三者之一任意一点有不同，那么就为不同源。当一个资源从与该资源本身所在的服务器的域或端口不同的域或不同的端口请求一个资源时，资源会发起一个跨域 HTTP 请求。而有关跨域请求受到限制的原因可以参考如下 MDN 文档片段：</p><blockquote><p>跨域不一定是浏览器限制了发起跨站请求，而也可能是跨站请求可以正常发起，但是返回结果被浏览器拦截了。最好的例子是 CSRF 跨站攻击原理，请求是发送到了后端服务器无论是否跨域！注意：有些浏览器不允许从 HTTPS 的域跨域访问 HTTP，比如 Chrome 和 Firefox，这些浏览器在请求还未发出的时候就会拦截请求，这是一个特例。</p></blockquote><h3 id="解决方法汇总"><a href="#解决方法汇总" class="headerlink" title="解决方法汇总"></a>解决方法汇总</h3><p>以下我们由简及深介绍各种存在的跨域请求解决方案，包括 <code>document.domain, location.hash, window.name, window.postMessage, JSONP, WebSocket, CORS</code>。</p><h4 id="document-domain"><a href="#document-domain" class="headerlink" title="document.domain"></a>document.domain</h4><p><code>document.domain</code> 的作用是用来获取/设置当前文档的原始域部分，例如：</p><pre><code>// 对于文档 www.example.xxx/good.htmldocument.domain=&quot;www.example.xxx&quot;// 对于URI http://developer.mozilla.org/en/docs/DOM document.domain=&quot;developer.mozilla.org&quot;</code></pre><blockquote><p>如果当前文档的域无法识别，那么 domain 属性会返回 null。</p><p>在根域范围内，Mozilla允许你把domain属性的值设置为它的上一级域。例如，在 developer.mozilla.org 域内，可以把domain设置为 “mozilla.org” 但不能设置为 “mozilla.com” 或者”org”。</p></blockquote><p>因此，若两个源所用协议、端口一致，主域相同而二级域名不同的话，可以借鉴该方法解决跨域请求。</p><p>比如若我们在 页面执行以下语句：</p><pre><code>document.domain = &quot;github.io&quot;</code></pre><p>那么之后页面对 <code>github.io</code> 发起请求时页面则会成功通过对 <code>github.io</code> 的同源检测。比较直接的一个操作是，当我们在 <code>a.github.io</code> 页面中利用 iframe 去加载 <code>github.io</code> 时，通过如上的赋值后，我们可以在 <code>a.github.io</code> 页面中去操作 iframe 里的内容。</p><p>我们同时考虑另一种情况：存在两个子域名 <code>a.github.io</code> 以及 <code>b.github.io</code>， 其中前者域名下网页 a.html 通过 iframe 引入了后者域名下的 b.html，此时在 a.html 中是无法直接操作 b.html 的内容的。</p><p>同样利用 <code>document.domain</code>，我们在两个页面中均加入</p><pre><code>document.domain=&apos;github.io&apos;</code></pre><p>这样在以上的 a.html 中就可以操作通过 iframe 引入的 b.html 了。</p><p><strong>document.domain</strong> 的优点在于解决了主语相同的跨域请求，但是其缺点也是很明显的：比如一个站点受到攻击后，另一个站点会因此引起安全漏洞；若一个页面中引入多个 iframe，想要操作所有的 iframe 则需要设置相同的 domain。</p><h4 id="location-hash"><a href="#location-hash" class="headerlink" title="location.hash"></a>location.hash</h4><p><code>location.hash</code> 是一个可读可写的字符串，该字符串是 URL 的锚部分（从 # 号开始的部分）。例如：</p><pre><code>// 对于页面 http://example.com:1234/test.htm#part2location.hash = &quot;#part2&quot;</code></pre><p>同时，由于我们知道改变 hash 并不会导致页面刷新，所以可以利用 hash 在不同源间传递数据。</p><p>假设 <code>github.io</code> 域名下 a.html 和 <code>shaonian.eu</code> 域名下 b.html 存在跨域请求，那么利用 location.hash 的一个解决方案如下：</p><ul><li>a.html 页面中创建一个隐藏的 iframe， src 指向 b.html，其中 src 中可以通过 hash 传入参数给 b.html</li><li>b.html 页面在处理完传入的 hash 后通过修改 a.html 的 hash 值达到将数据传送给 a.html 的目的</li><li>a.html 页面添加一个定时器，每隔一定时间判断自身的 location.hash 是否变化，以此响应处理</li></ul><p>以上步骤中需要注意第二点：如何在 iframe 页面中修改 父亲页面的 hash 值。由于在 IE 和 Chrome 下，两个不同域的页面是不允许 <code>parent.location.hash</code> 这样赋值的，所以对于这种情况，我们需要在父亲页面域名下添加另一个页面来实现跨域请求，具体如下：</p><ul><li>假设 a.html 中 iframe 引入了 b.html, 数据需要在这两个页面之间传递，且 c.html 是一个与 a.html 同源的页面</li><li>a.html 通过 iframe 将数据通过 hash 传给 b.html</li><li>b.html 通过 iframe 将数据通过 hash 传给 c.html</li><li>c.html 通过 <code>parent.parent.location.hash</code> 设置 a.html 的 hash 达到传递数据的目的</li></ul><p><strong>location.bash</strong> 方法的优点在于可以解决域名完全不同的跨域请求，并且可以实现双向通讯；而缺点则包括以下几点：</p><ul><li>利用这种方法传递的数据量受到 url 大小的限制，传递数据类型有限</li><li>由于数据直接暴露在 url 中则存在安全问题</li><li>若浏览器不支持 <code>onhashchange</code> 事件，则需要通过轮训来获知 url 的变化</li><li>有些浏览器会在 hash 变化时产生历史记录，因此可能影响用户体验</li></ul><h4 id="window-name"><a href="#window-name" class="headerlink" title="window.name"></a>window.name</h4><p>该属性用于获取/设置窗口的名称。其特征在于：一个窗口的生命周期内，窗口载入的所有页面共享该值，且都具有对该属性的读写权限。这意味着如果不修改该值，那么在不同页面加载之后该值也不会变，且其支持长达 2MB 的存储量。</p><p>利用该特性我们可以将跨域请求用如下步骤解决：</p><ul><li>在 a.github.io/a.html 中创建 iframe 指向 b.github.io/b.html (页面会将自身的 window.name 附在 iframe 上)</li><li>给 a.github.io/a.html 添加监听 iframe 的 onload 事件，在该事件中将 iframe 的 src 设置为本地域的代理文件（代理文件和a.html处于同一域下，可以相互通信），同时可以传出 iframe 的 name 值</li><li>获取数据后销毁 iframe，释放内存，同时也保证了安全</li></ul><p><strong>window.name</strong> 的优势在于巧妙地绕过了浏览器的跨域访问限制，但同时它又是安全操作。</p><h4 id="window-postMessage"><a href="#window-postMessage" class="headerlink" title="window.postMessage"></a>window.postMessage</h4><p>HTML5 为了解决这个问题，引入了一个全新的 API：跨文档通信 API（Cross-document messaging）。这个 API 为 window 对象新增了一个 window.postMessage 方法，允许跨窗口通信，不论这两个窗口是否同源。</p><p>API 的详细使用方法请见 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage" target="_blank" rel="noopener">MDN</a>。</p><h4 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h4><p>JSONP, 全称 JSON with Padding，是使用 AJAX 实现的请求不同源的跨域。其基本原理：网页通过添加一个 “ 元素，向服务器请求 JSON 数据，这种做法不受同源政策限制；服务器收到请求后，将数据放在一个指定名字的回调函数里传回来。</p><p>以下为一个例子，由于 test.js 返回的内容直接作为代码运行，所以只要 a.html 中定义了 <code>callback</code> 函数, 它就会立即被调用。</p><pre><code>// 当前页面 a.com/a.html&lt;script type=&quot;text/javascript&quot;&gt;//回调函数function callback(data) {    alert(data.message);}&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;http://b.com/test.js&quot;&gt;&lt;/script&gt;// test.js// 调用callback函数，并以json数据形式作为阐述传递，完成回调callback({message:&quot;success&quot;}); </code></pre><p>为了保证 script 的灵活，我们可以通过 JavaScript 动态创建 script 标签，并通过 HTTP 参数向服务器传入回调函数名，案例如下所示：</p><pre><code>&lt;script type=&quot;text/javascript&quot;&gt;    // 添加&lt;script&gt;标签的方法    function addScriptTag(src){        var script = document.createElement(&apos;script&apos;);        script.setAttribute(&quot;type&quot;,&quot;text/javascript&quot;);        script.src = src;        document.body.appendChild(script);    }    window.onload = function(){        // 搜索apple，将自定义的回调函数名result传入callback参数中        addScriptTag(&quot;http://ajax.googleapis.com/ajax/services/search/web?v=1.0&amp;q=apple&amp;callback=result&quot;);    }    // 自定义的回调函数result    function result(data) {        // 我们就简单的获取apple搜索结果的第一条记录中url数据        alert(data.responseData.results[0].unescapedUrl);    }&lt;/script&gt;</code></pre><p>jQuery 有相应的 JSONP 的实现方法，见 <a href="http://api.jquery.com/jquery.getjson/" target="_blank" rel="noopener">API</a>。</p><p><strong>JSONP</strong>的优点在于简单适用，老式浏览器全部支持，服务器改造小。不需要XMLHttpRequest或ActiveX的支持；但缺点是只支持 GET 请求。</p><h4 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h4><p>WebSocket 协议不实行同源政策，只要服务器支持，就可以通过它进行跨源通信。</p><h4 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h4><blockquote><p>CORS是一个W3C标准，全称是”跨域资源共享”（Cross-origin resource sharing）。它允许浏览器向跨源服务器，发出XMLHttpRequest请求，从而克服了AJAX只能同源使用的限制。</p></blockquote><p>跨域资源共享（ CORS ）机制允许 Web 应用服务器进行跨域访问控制，从而使跨域数据传输得以安全进行。其需要服务端和客户端同时支持。</p><blockquote><p>跨域资源共享标准（ cross-origin sharing standard ）允许在下列场景中使用跨域 HTTP 请求：</p><p>由 XMLHttpRequest 或 Fetch 发起的跨域 HTTP 请求</p><p>Web 字体 (CSS 中通过 @font-face 使用跨域字体资源), 因此，网站就可以发布 TrueType 字体资源，并只允许已授权网站进行跨站调用</p><p>WebGL 贴图</p><p>使用 drawImage 将 Images/video 画面绘制到 canvas</p><p>样式表（使用 CSSOM）</p><p>Scripts (未处理的异常)</p></blockquote><p>CORS 存在以下三种主要场景，分别是<strong>简单请求，预检请求和附带身份凭证的请求</strong>。</p><ul><li><p><strong>简单请求</strong>：若只使用 GET, HEAD 或者 POST 请求，且除 CORS 安全的首部字段集合外，无人为设置该集合之外的其他首部字段，同时 Content-Type 值属于下列之一，那么该请求则可以被视为简单请求：</p><p>application/x-www-form-urlencoded<br>multipart/form-data<br>text/plain</p></li></ul><p>此情况下，若服务端返回的 <code>Access-Control-Allow-Origin: *</code> ，则表明该资源可以被任意外域访问。若要指定仅允许来自某些域的访问，需要将 <code>*</code> 设定为该域，例如：</p><pre><code>Access-Control-Allow-Origin: http://foo.example</code></pre><ul><li><strong>预检请求</strong>：与前述简单请求不同，该要求必须首先使用 OPTIONS 方法发起一个预检请求到服务器，以获知服务器是否允许该实际请求。当请求满足以下三个条件任意之一时，<br>即应首先发送预检请求：</li></ul><ol><li>使用了 PUT, DELETE, CONNECT, OPTIONS, TRACE, PATCH 中任一的 HTTP 方法</li><li>人为设置了对 CORS 安全的首部字段集合之外的其他首部字段</li><li><p>Content-Type 的值不属于下列之一</p><p>application/x-www-form-urlencoded<br>multipart/form-data<br>text/plain</p></li></ol><p>预检请求完成之后（通过 OPTIONS 方法实现），才发送实际请求。一个示范 HTTP 请求如下所示：</p><pre><code>var invocation = new XMLHttpRequest();var url = &apos;http://bar.other/resources/post-here/&apos;;var body = &apos;&lt;?xml version=&quot;1.0&quot;?&gt;&lt;person&gt;&lt;name&gt;Arun&lt;/name&gt;&lt;/person&gt;&apos;;function callOtherDomain(){  if(invocation)    {      invocation.open(&apos;POST&apos;, url, true);      invocation.setRequestHeader(&apos;X-PINGOTHER&apos;, &apos;pingpong&apos;);      invocation.setRequestHeader(&apos;Content-Type&apos;, &apos;application/xml&apos;);      invocation.onreadystatechange = handler;      invocation.send(body);     }}</code></pre><ul><li><strong>附带身份凭证的请求</strong>：这种方式的特点在于能够在跨域请求时向服务器发送凭证请求，例如 Cookies (withCredentials 标志设置为 true)。</li></ul><p>一般而言，对于跨域 XMLHttpRequest 或 Fetch 请求，浏览器不会发送身份凭证信息。如果要发送凭证信息，需要设置 XMLHttpRequest 的某个特殊标志位。但是需要注意的是，如果服务器端的响应中未携带 <code>Access-Control-Allow-Credentials: true</code>，浏览器将不会把响应内容返回给请求的发送者。</p><blockquote><p>附带身份凭证的请求与通配符</p><p>对于附带身份凭证的请求，服务器不得设置 Access-Control-Allow-Origin 的值为“*”。</p><p>这是因为请求的首部中携带了 Cookie 信息，如果 Access-Control-Allow-Origin 的值为“*”，请求将会失败。而将 Access-Control-Allow-Origin 的值设置为 <a href="http://foo.example" target="_blank" rel="noopener">http://foo.example</a>，则请求将成功执行。</p><p>另外，响应首部中也携带了 Set-Cookie 字段，尝试对 Cookie 进行修改。如果操作失败，将会抛出异常。</p></blockquote><p>MDN 引例如下：</p><pre><code>var invocation = new XMLHttpRequest();var url = &apos;http://bar.other/resources/credentialed-content/&apos;;function callOtherDomain(){  if(invocation) {    invocation.open(&apos;GET&apos;, url, true);    invocation.withCredentials = true;    invocation.onreadystatechange = handler;    invocation.send();  }}</code></pre><p>其实由上我们知道，<strong>CORS</strong> 的优点也非常明显：CORS支持所有类型的HTTP请求，是跨域HTTP请求的根本解决方案。</p><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul><li><a href="https://github.com/wengjq/Blog/issues/2" target="_blank" rel="noopener">https://github.com/wengjq/Blog/issues/2</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS</a></li><li><a href="http://www.cnblogs.com/zichi/p/4620656.html" target="_blank" rel="noopener">http://www.cnblogs.com/zichi/p/4620656.html</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web前端 </tag>
            
            <tag> 跨域 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS点击链接触发的颜色块</title>
      <link href="/ios-click-the-color-block-that-triggered-the-link.html"/>
      <url>/ios-click-the-color-block-that-triggered-the-link.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在做手机页面的时候碰到了这样一个问题：手指点击某一个链接的时候触发了一个半透明的颜色块。</p><p>但是淘宝和京东的手机端没有类似出现这样的情况，所以应该是有这么一个禁止触发的属性，因为在 a 链接触发的所以，所以审查元素找到 a 链接的状态，但是发现他们的 a 链接是没有设置任何的，但是在根属性发现这么一个属性 -webkit-tap-highlight-color:rgba(0,0,0,0) 于是百度了一下，于是找到了关于webkit私有属性的一些知识，原来确实是有可以覆盖这个行为的属性。</p><h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h3><p>属性名:</p><p><strong>-webkit-tap-highlight-color</strong></p><p>属性值:</p><p>color color是指css3带Alpha的color</p><p>初始值:</p><p>inherit</p><p>应用于:</p><p>a链接的标签，或者带有javascript可点击的元素</p><p><strong>官方解释如下：</strong></p><p>描述：假如指定，那么这个值遵循Alpha值，假如不指定，那么调用默认的Alpha值，假如设置alpha的值为0，点击元素禁用高亮，假如设置alpha为1，那么点击元素的时候将会不可见。</p><blockquote><p>支持系统： iOS 1.1.1 以上</p></blockquote><p>支持等级： Apple extension—Safari on iOS only【仅仅针对IOS中的Safari】</p><p>说明：刚刚也提到了color是需要用css3的color，也就是RGBa颜色值，具体请前往MDN，rgba(x,x,x,x) 前面三个值分别代表RGB，后面一个值代表alpha，数值从0~1浮动，0为全透明，1为不透明。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EMD Vol 1706</title>
      <link href="/emd-vol-1706.html"/>
      <url>/emd-vol-1706.html</url>
      
        <content type="html"><![CDATA[<h3 id="2017-06-18"><a href="#2017-06-18" class="headerlink" title="2017.06.18"></a>2017.06.18</h3><p>漫漫一月，终于结束了，对我而言，恍如一年。</p><p>之所以这样是因为这个月发生很多事情，有些东西需要去接受。</p><h3 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h3><p>很高兴这个月初转正了，和实习一样，除了肩上担子更重以外，事实上一点儿不重，依然每天咸鱼中，不过也不会浪费这段时间，每天给自己学点新知识，所以打算深入学习ES6和JS高级知识这一块。</p><p>还是老样子，白天上班晚上回来泡剧。直到五月底发现，我的生活完全变了样。</p><p>去年春节左右几个月，是我比较放松的，无论是心态还是状态，每天该上班的上班，该玩的玩，和朋友扯扯淡，就这样一天过来了，记忆中的每一天都过得很充沛。</p><p>然而自从来城南后，工作不忙，导致心态松懈，所以定制了一系列的计划，至于计划就不公布了…主要不该浪费时间了，给自己找点事情做。</p><h3 id="生活"><a href="#生活" class="headerlink" title="生活"></a>生活</h3><p>从现在开始，生活态度得该改改了，原由从失恋后，再去正眼看待自己，发现自己依然保留几年前的那种生活态度：游戏人生、吊儿郎当。</p><p>所以决定在精神面貌改变自己，从正装穿起，标准的休闲黑裤，衬衫，黑皮鞋。尝试一个星期，自我感觉还不错，至少面对镜子中自己，发现更加自信，看起来稳重多了。</p><p>其次是态度，这个只能慢慢改吧，相信经过一段时间后，会变得不一样！</p><h3 id="感情"><a href="#感情" class="headerlink" title="感情"></a>感情</h3><p>这个月让我改变这么多，做出决定还是感情的原因。</p><p>我喜欢一个人，说一见钟情也不为过之，很可惜最后选择放弃，感情的事究竟不能勉强。</p><p>但是感情又不能说放下就放下，无法想象那段时间怎么是过来的。看视频莫名其妙哭出来，周围的人以为是笑哭。人呐，就是这么坚强，相信我，现在的我一点儿不悲伤。</p><p>至少，我现在已经失去喜欢一个人的能力。</p><p>至少，我学会不再逃避，和如何去爱自己。</p><p>至少，我再也不会自私自利。</p><p>至少，没有失去所有，因为我们还是朋友。</p><blockquote><p>酷的像风，野的像狗，不招人爱倒也自由。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>JavaWeb快速开发</title>
      <link href="/javaweb-rapid-development.html"/>
      <url>/javaweb-rapid-development.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>使用Spring-Boot快速搭建一个Web应用，并且采用Mybatis作为的ORM框架。为了提升性能，将Redis作为Mybatis的二级缓存。为了测试的代码，编写了单元测试，并且用H2内存数据库来生成的测试数据。</p><h2 id="Spring-Boot"><a href="#Spring-Boot" class="headerlink" title="Spring-Boot"></a>Spring-Boot</h2><h3 id="新建项目"><a href="#新建项目" class="headerlink" title="新建项目"></a>新建项目</h3><p>通过Intellij的Spring Initializer，新建一个Spring-Boot工程变得十分简单。首先在Intellij中选择New一个Projec，然后在选择依赖的界面，勾选Web、Mybatis、Redis、Mysql、H2：</p><p><img src="https://res.i95.me/wp-content/uploads/2017/06/idea-spring-boot.png" alt></p><p>Spring Initializer已经帮自动生成了一个启动类——<code>SpringBootMybatisWithRedisApplication</code>。该类的代码十分简单：</p><pre><code>package com.iiong;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;@SpringBootApplicationpublic class DemoApplication {    public static void main(String[] args) {        SpringApplication.run(DemoApplication.class, args);    }}</code></pre><p>@SpringBootApplication注解表示启用Spring Boot的自动配置特性。好了，至此的项目骨架已经搭建成功，感兴趣的读者可以通过Intellij启动看看效果。</p><h3 id="新建API接口"><a href="#新建API接口" class="headerlink" title="新建API接口"></a>新建API接口</h3><p>接下来，要编写Web API。假设的Web工程负责处理商家的产品（Product）。需要提供根据product id返回product信息的get接口和更新product信息的put接口。首先定义Product类，该类包括产品id，产品名称name以及价格price：</p><pre><code>public class Product implements Serializable {    private static final long serialVersionUID = 1435515995276255188L;    private long id;    private String name;    private long price;    // getters setters}</code></pre><p>然后需要定义Controller类。由于Spring Boot内部使用Spring MVC作为它的Web组件，所以可以通过注解的方式快速开发的接口类：</p><pre><code>@RestController@RequestMapping(&quot;/product&quot;)public class ProductController {    @GetMapping(&quot;/{id}&quot;)    public Product getProductInfo(            @PathVariable(&quot;id&quot;)                    Long productId) {        // TODO        return null;    }    @PutMapping(&quot;/{id}&quot;)    public Product updateProductInfo(            @PathVariable(&quot;id&quot;)                    Long productId,            @RequestBody                    Product newProduct) {        // TODO        return null;    }}</code></pre><p>简单介绍一下上述代码中所用到的注解的作用：</p><ul><li><code>@RestController</code>：表示该类为Controller，并且提供Rest接口，即所有接口的值以Json格式返回。该注解其实是<code>@Controller</code>和<code>@ResponseBody</code>的组合注解，便于开发Rest API。</li><li><code>@RequestMapping</code>、<code>@GetMapping</code>、<code>@PutMapping</code>：表示接口的URL地址。标注在类上的<code>@RequestMapping</code>注解表示该类下的所有接口的URL都以<code>/product</code>开头。<code>@GetMapping</code>表示这是一个Get HTTP接口，<code>@PutMapping</code>表示这是一个Put HTTP接口。</li><li><code>@PathVariable</code>、<code>@RequestBody</code>：表示参数的映射关系。假设有个Get请求访问的是<code>/product/123</code>，那么该请求会由<code>getProductInfo</code>方法处理，其中URL里的123会被映射到productId中。同理，如果是Put请求的话，请求的body会被映射到<code>newProduct</code>对象中。</li></ul><p>这里只定义了接口，实际的处理逻辑还未完成，因为product的信息都存在数据库中。接下来将在项目中集成mybatis，并且与数据库做交互。</p><h2 id="集成Mybatis"><a href="#集成Mybatis" class="headerlink" title="集成Mybatis"></a>集成Mybatis</h2><h3 id="配置数据源"><a href="#配置数据源" class="headerlink" title="配置数据源"></a>配置数据源</h3><p>首先需要在配置文件中配置的数据源。采用mysql作为的数据库。这里采用yaml作为配置文件的格式。在resources目录下新建application.yml文件：</p><pre><code>spring:  # 数据库配置  datasource:    url: jdbc:mysql://{your_host}/{your_db}    username: {your_username}    password: {your_password}    driver-class-name: org.gjt.mm.mysql.Driver</code></pre><p>由于Spring Boot拥有自动配置的特性，不用新建一个DataSource的配置类，Sping Boot会自动加载配置文件并且根据配置文件的信息建立数据库的连接池，十分便捷。由于Spring Boot拥有自动配置的特性，不用新建一个DataSource的配置类，Sping Boot会自动加载配置文件并且根据配置文件的信息建立数据库的连接池，十分便捷。</p><blockquote><p>推荐大家采用yaml作为配置文件的格式。xml显得冗长，properties没有层级结构，yaml刚好弥补了这两者的缺点。这也是Spring Boot默认就支持yaml格式的原因。</p></blockquote><h3 id="配置Mybatis"><a href="#配置Mybatis" class="headerlink" title="配置Mybatis"></a>配置Mybatis</h3><p>已经通过Spring Initializer在pom.xml中引入了<code>mybatis-spring-boot-starte</code>库，该库会自动帮初始化mybatis。首先在application.yml中填写mybatis的相关配置：</p><pre><code># mybatis配置mybatis:  # 配置映射类所在包名  type-aliases-package: com.wooyoo.learning.dao.domain  # 配置mapper xml文件所在路径，这里是一个数组  mapper-locations:    - mappers/ProductMapper.xml</code></pre><p>然后，再在代码中定义<code>ProductMapper</code>类：</p><pre><code>@Mapperpublic interface ProductMapper {    Product select(            @Param(&quot;id&quot;)                    long id);    void update(Product product);}</code></pre><p>这里，只要加上了@Mapper注解，Spring Boot在初始化mybatis时会自动加载该mapper类。这里，只要加上了<code>@Mapper</code>注解，Spring Boot在初始化mybatis时会自动加载该mapper类。</p><blockquote><p>Spring Boot之所以这么流行，最大的原因是它自动配置的特性。开发者只需要关注组件的配置（比如数据库的连接信息），而无需关心如何初始化各个组件，这使得可以集中精力专注于业务的实现，简化开发流程。Spring Boot之所以这么流行，最大的原因是它自动配置的特性。开发者只需要关注组件的配置（比如数据库的连接信息），而无需关心如何初始化各个组件，这使得可以集中精力专注于业务的实现，简化开发流程。</p></blockquote><h3 id="访问数据库"><a href="#访问数据库" class="headerlink" title="访问数据库"></a>访问数据库</h3><p>完成了Mybatis的配置之后，就可以在的接口中访问数据库了。在<code>ProductController</code>下通过<code>@Autowired</code>引入mapper类，并且调用对应的方法实现对product的查询和更新操作，这里以查询接口为例：</p><pre><code>@RestController@RequestMapping(&quot;/product&quot;)public class ProductController {    @Autowired    private ProductMapper productMapper;    @GetMapping(&quot;/{id}&quot;)    public Product getProductInfo(            @PathVariable(&quot;id&quot;)                    Long productId) {        return productMapper.select(productId);    }    // 避免篇幅过长，省略updateProductInfo的代码}</code></pre><p>然后在你的mysql中插入几条product的信息，就可以运行该项目看看是否能够查询成功了。</p><p>至此，已经成功地在项目中集成了Mybatis，增添了与数据库交互的能力。但是这还不够，一个现代化的Web项目，肯定会上缓存加速的数据库查询。接下来，将介绍如何科学地将Redis集成到Mybatis的二级缓存中，实现数据库查询的自动缓存。</p><h2 id="集成Redis"><a href="#集成Redis" class="headerlink" title="集成Redis"></a>集成Redis</h2><h3 id="配置Redis"><a href="#配置Redis" class="headerlink" title="配置Redis"></a>配置Redis</h3><p>同访问数据库一样，需要配置Redis的连接信息。在application.yml文件中增加如下配置：</p><pre><code>spring:  redis:    # redis数据库索引（默认为0），使用索引为3的数据库，避免和其他数据库冲突    database: 3    # redis服务器地址（默认为localhost）    host: localhost    # redis端口（默认为6379）    port: 6379    # redis访问密码（默认为空）    password:    # redis连接超时时间（单位为毫秒）    timeout: 0    # redis连接池配置    pool:      # 最大可用连接数（默认为8，负数表示无限）      max-active: 8      # 最大空闲连接数（默认为8，负数表示无限）      max-idle: 8      # 最小空闲连接数（默认为0，该值只有为正数才有作用）      min-idle: 0      # 从连接池中获取连接最大等待时间（默认为-1，单位为毫秒，负数表示无限）      max-wait: -1</code></pre><p>上述列出的都为常用配置，读者可以通过注释信息了解每个配置项的具体作用。由于在pom.xml中已经引入了<code>spring-boot-starter-data-redis</code>库，所以Spring Boot会帮自动加载Redis的连接，具体的配置类<code>org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration</code>。通过该配置类，可以发现底层默认使用Jedis库，并且提供了开箱即用的<code>redisTemplate</code>和<code>stringTemplate</code>。</p><h3 id="将Redis作为二级缓存"><a href="#将Redis作为二级缓存" class="headerlink" title="将Redis作为二级缓存"></a>将Redis作为二级缓存</h3><p>Mybatis的二级缓存原理本文不再赘述，读者只要知道，Mybatis的二级缓存可以自动地对数据库的查询做缓存，并且可以在更新数据时同时自动地更新缓存。</p><p>实现Mybatis的二级缓存很简单，只需要新建一个类实现<code>org.apache.ibatis.cache.Cache</code>接口即可。</p><p>该接口共有以下五个方法：</p><ul><li><code>String getId()</code>：mybatis缓存操作对象的标识符。一个mapper对应一个mybatis的缓存操作对象。</li><li><code>void putObject(Object key, Object value)</code>：将查询结果塞入缓存。</li><li><code>Object getObject(Object key)</code>：从缓存中获取被缓存的查询结果。</li><li><code>Object removeObject(Object key)</code>：从缓存中删除对应的key、value。只有在回滚时触发。一般也可以不用实现，具体使用方式请参考：<code>org.apache.ibatis.cache.decorators.TransactionalCache</code>。</li><li><code>void clear()</code>：发生更新时，清除缓存。</li><li><code>int getSize()</code>：可选实现。返回缓存的数量。</li><li><code>ReadWriteLock getReadWriteLock()</code>：可选实现。用于实现原子性的缓存操作。</li></ul><p>接下来，新建<code>RedisCache</code>类，实现<code>Cache</code>接口：</p><pre><code>public class RedisCache implements Cache {    private static final Logger logger = LoggerFactory.getLogger(RedisCache.class);    private final ReadWriteLock readWriteLock = new ReentrantReadWriteLock();    private final String id; // cache instance id    private RedisTemplate redisTemplate;    private static final long EXPIRE_TIME_IN_MINUTES = 30; // redis过期时间    public RedisCache(String id) {        if (id == null) {            throw new IllegalArgumentException(&quot;Cache instances require an ID&quot;);        }        this.id = id;    }    @Override    public String getId() {        return id;    }    /**     * Put query result to redis     *     * @param key     * @param value     */    @Override    @SuppressWarnings(&quot;unchecked&quot;)    public void putObject(Object key, Object value) {        RedisTemplate redisTemplate = getRedisTemplate();        ValueOperations opsForValue = redisTemplate.opsForValue();        opsForValue.set(key, value, EXPIRE_TIME_IN_MINUTES, TimeUnit.MINUTES);        logger.debug(&quot;Put query result to redis&quot;);    }    /**     * Get cached query result from redis     *     * @param key     * @return     */    @Override    public Object getObject(Object key) {        RedisTemplate redisTemplate = getRedisTemplate();        ValueOperations opsForValue = redisTemplate.opsForValue();        logger.debug(&quot;Get cached query result from redis&quot;);        return opsForValue.get(key);    }    /**     * Remove cached query result from redis     *     * @param key     * @return     */    @Override    @SuppressWarnings(&quot;unchecked&quot;)    public Object removeObject(Object key) {        RedisTemplate redisTemplate = getRedisTemplate();        redisTemplate.delete(key);        logger.debug(&quot;Remove cached query result from redis&quot;);        return null;    }    /**     * Clears this cache instance     */    @Override    public void clear() {        RedisTemplate redisTemplate = getRedisTemplate();        redisTemplate.execute((RedisCallback) connection -&gt; {            connection.flushDb();            return null;        });        logger.debug(&quot;Clear all the cached query result from redis&quot;);    }    @Override    public int getSize() {        return 0;    }    @Override    public ReadWriteLock getReadWriteLock() {        return readWriteLock;    }    private RedisTemplate getRedisTemplate() {        if (redisTemplate == null) {            redisTemplate = ApplicationContextHolder.getBean(&quot;redisTemplate&quot;);        }        return redisTemplate;    }}</code></pre><p>讲解一下上述代码中一些<strong>关键点</strong>：</p><ol><li>自己实现的二级缓存，必须要有一个带id的构造函数，否则会报错。</li><li>使用Spring封装的<code>redisTemplate</code>来操作Redis。<strong>网上所有介绍redis做二级缓存的文章都是直接用jedis库，但是这样不够Spring Style，而且，<code>redisTemplate</code>封装了底层的实现，未来如果不用jedis了，可以直接更换底层的库，而不用修改上层的代码。更方便的是，使用<code>redisTemplate</code>，不用关心redis连接的释放问题，否则新手很容易忘记释放连接而导致应用卡死。</strong></li><li>需要注意的是，这里不能通过autowire的方式引用<code>redisTemplate</code>，因为<code>RedisCache</code>并不是Spring容器里的bean。所以需要手动地去调用容器的<code>getBean</code>方法来拿到这个bean。</li><li>采用的redis序列化方式是默认的jdk序列化。所以数据库的查询对象（比如Product类）需要实现<code>Serializable</code>接口。</li></ol><p>这样，就实现了一个优雅的、科学的并且具有Spring Style的Redis缓存类。</p><h3 id="开启二级缓存"><a href="#开启二级缓存" class="headerlink" title="开启二级缓存"></a>开启二级缓存</h3><p>接下来，需要在<code>ProductMapper.xml</code>中开启二级缓存：</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;mapper namespace=&quot;com.wooyoo.learning.dao.mapper.ProductMapper&quot;&gt;    &lt;!-- 开启基于redis的二级缓存 --&gt;    &lt;cache type=&quot;com.wooyoo.learning.util.RedisCache&quot;/&gt;    &lt;select id=&quot;select&quot; resultType=&quot;Product&quot;&gt;        SELECT * FROM products WHERE id = #{id} LIMIT 1    &lt;/select&gt;    &lt;update id=&quot;update&quot; parameterType=&quot;Product&quot; flushCache=&quot;true&quot;&gt;        UPDATE products SET name = #{name}, price = #{price} WHERE id = #{id} LIMIT 1    &lt;/update&gt;&lt;/mapper&gt;&lt;cache type=&quot;com.wooyoo.learning.util.RedisCache&quot;/&gt;</code></pre><p>表示开启基于redis的二级缓存，并且在update语句中，设置<code>flushCache</code>为<code>true</code>，这样在更新product信息时，能够自动失效缓存（本质上调用的是clear方法）。</p><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><h3 id="配置H2内存数据库"><a href="#配置H2内存数据库" class="headerlink" title="配置H2内存数据库"></a>配置H2内存数据库</h3><p>至此已经完成了所有代码的开发，接下来需要书写单元测试代码来测试代码的质量。刚才开发的过程中采用的是mysql数据库，而一般在测试时经常采用的是内存数据库。这里使用H2作为测试场景中使用的数据库。</p><p>要使用H2也很简单，只需要跟使用mysql时配置一下即可。在application.yml文件中：</p><pre><code>---spring:  profiles: test  # 数据库配置  datasource:    url: jdbc:h2:mem:test    username: root    password: 123456    driver-class-name: org.h2.Driver    schema: classpath:schema.sql    data: classpath:data.sql</code></pre><p>为了避免和默认的配置冲突，用<code>---</code>另起一段，并且用<code>profiles: test</code>表明这是test环境下的配置。然后只要在的测试类中加上<code>@ActiveProfiles(profiles = &quot;test&quot;)</code>注解来启用test环境下的配置，这样就能一键从mysql数据库切换到h2数据库。</p><p>在上述配置中，schema.sql用于存放的建表语句，data.sql用于存放insert的数据。这样当测试时，h2就会读取这两个文件，初始化所需要的表结构以及数据，然后在测试结束时销毁，不会对的mysql数据库产生任何影响。这就是内存数据库的好处。另外，别忘了在pom.xml中将h2的依赖的scope设置为test。</p><blockquote><p>使用Spring Boot就是这么简单，无需修改任何代码，轻松完成数据库在不同环境下的切换。</p></blockquote><h3 id="编写测试代码"><a href="#编写测试代码" class="headerlink" title="编写测试代码"></a>编写测试代码</h3><p>因为是通过Spring Initializer初始化的项目，所以已经有了一个测试类——<code>SpringBootMybatisWithRedisApplicationTests</code>。</p><p>Spring Boot提供了一些方便进行Web接口测试的工具类，比如<code>TestRestTemplate</code>。然后在配置文件中将log等级调成DEBUG，方便观察调试日志。具体的测试代码如下：</p><pre><code>@RunWith(SpringRunner.class)@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)@ActiveProfiles(profiles = &quot;test&quot;)public class SpringBootMybatisWithRedisApplicationTests {    @LocalServerPort    private int port;    @Autowired    private TestRestTemplate restTemplate;    @Test    public void test() {        long productId = 1;        Product product = restTemplate.getForObject(&quot;http://localhost:&quot; + port + &quot;/product/&quot; + productId, Product.class);        assertThat(product.getPrice()).isEqualTo(200);        Product newProduct = new Product();        long newPrice = new Random().nextLong();        newProduct.setName(&quot;new name&quot;);        newProduct.setPrice(newPrice);        restTemplate.put(&quot;http://localhost:&quot; + port + &quot;/product/&quot; + productId, newProduct);        Product testProduct = restTemplate.getForObject(&quot;http://localhost:&quot; + port + &quot;/product/&quot; + productId, Product.class);        assertThat(testProduct.getPrice()).isEqualTo(newPrice);    }}</code></pre><p>在上述测试代码中：</p><ol><li>首先调用get接口，通过assert语句判断是否得到了预期的对象。此时该product对象会存入redis中。</li><li>然后调用put接口更新该product对象，此时redis缓存会失效。</li><li>最后再次调用get接口，判断是否获取到了新的product对象。如果获取到老的对象，说明缓存失效的代码执行失败，代码存在错误，反之则说明代码是OK的。</li></ol><blockquote><p>书写单元测试是一个良好的编程习惯。虽然会占用你一定的时间，但是当你日后需要做一些重构工作时，你就会感激过去写过单元测试的自己。</p></blockquote><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="http://www.baeldung.com/spring-data-redis-tutorial" target="_blank" rel="noopener">http://www.baeldung.com/spring-data-redis-tutorial</a><br><a href="http://chrisbaileydeveloper.com/projects/spring-boot-redis-heroku-demo/" target="_blank" rel="noopener">http://chrisbaileydeveloper.com/projects/spring-boot-redis-heroku-demo/</a><br><a href="http://docs.spring.io/spring-data/redis/docs/1.6.2.RELEASE/reference/html/" target="_blank" rel="noopener">http://docs.spring.io/spring-data/redis/docs/1.6.2.RELEASE/reference/html/</a><br><a href="http://blog.didispace.com/springbootredis/" target="_blank" rel="noopener">http://blog.didispace.com/springbootredis/</a></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Java Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac命令行SVN笔记</title>
      <link href="/mac-svn-notes.html"/>
      <url>/mac-svn-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>本来在Mac随便找个SVN客户端凑合用得了，发现下了俩个愣是没看懂，无奈就用了命令行，发现比想象中简单多了…</p><h3 id="将文件checkout到本地目录"><a href="#将文件checkout到本地目录" class="headerlink" title="将文件checkout到本地目录"></a>将文件checkout到本地目录</h3><pre><code>svn checkout path（path是服务器上的目录）例如：svn checkout svn://192.168.1.1/pro/domain简写：svn co</code></pre><h3 id="往版本库中添加新的文件"><a href="#往版本库中添加新的文件" class="headerlink" title="往版本库中添加新的文件"></a>往版本库中添加新的文件</h3><pre><code>svn add file例如：svn add test.php(添加test.php)svn add *.php(添加当前目录下所有的php文件)</code></pre><h3 id="将改动的文件提交到版本库"><a href="#将改动的文件提交到版本库" class="headerlink" title="将改动的文件提交到版本库"></a>将改动的文件提交到版本库</h3><pre><code>svn commit -m &quot;LogMessage&quot; [-N] [--no-unlock] PATH(如果选择了保持锁，就使用--no-unlock开关)例如：svn commit -m &quot;add test file for my test&quot; test.php简写：svn ci</code></pre><h3 id="加锁-解锁"><a href="#加锁-解锁" class="headerlink" title="加锁/解锁"></a>加锁/解锁</h3><pre><code>svn lock -m &quot;LockMessage&quot; [--force] PATH例如：svn lock -m &quot;lock test file&quot; test.phpsvn unlock PATH</code></pre><h3 id="更新到某个版本"><a href="#更新到某个版本" class="headerlink" title="更新到某个版本"></a>更新到某个版本</h3><pre><code>svn update -r m path例如：svn update如果后面没有目录，默认将当前目录以及子目录下的所有文件都更新到最新版本。svn update -r 200 test.php(将版本库中的文件test.php还原到版本200)svn update test.php(更新，于版本库同步。如果在提交的时候提示过期的话，是因为冲突，需要先update，修改文件，然后清除svn resolved，最后再提交commit)简写：svn up</code></pre><h3 id="查看文件或者目录状态"><a href="#查看文件或者目录状态" class="headerlink" title="查看文件或者目录状态"></a>查看文件或者目录状态</h3><pre><code>1）svn status path（目录下的文件和子目录的状态，正常状态不显示）[?：不在svn的控制中；M：内容被修改；C：发生冲突；A：预定加入到版本库；K：被锁定]2）svn status -v path(显示文件和子目录状态)第一列保持相同，第二列显示工作版本号，第三和第四列显示最后一次修改的版本号和修改人。注：svn status、svn diff和 svn revert这三条命令在没有网络的情况下也可以执行的，原因是svn在本地的.svn中保留了本地版本的原始拷贝。简写：svn st</code></pre><h3 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h3><pre><code>svn delete path -m &quot;delete test fle&quot;例如：svn delete svn://192.168.1.1/pro/domain/test.php -m &quot;delete test file&quot;或者直接svn delete test.php 然后再svn ci -m &apos;delete test file‘，推荐使用这种简写：svn (del, remove, rm)</code></pre><h3 id="查看日志"><a href="#查看日志" class="headerlink" title="查看日志"></a>查看日志</h3><pre><code>svn log path例如：svn log test.php 显示这个文件的所有修改记录，及其版本号的变化</code></pre><h3 id="查看文件详细信息"><a href="#查看文件详细信息" class="headerlink" title="查看文件详细信息"></a>查看文件详细信息</h3><pre><code>svn info path例如：svn info test.php</code></pre><h3 id="比较差异"><a href="#比较差异" class="headerlink" title="比较差异"></a>比较差异</h3><pre><code>svn diff path(将修改的文件与基础版本比较)例如：svn diff test.phpsvn diff -r m:n path(对版本m和版本n比较差异)例如：svn diff -r 200:201 test.php简写：svn di</code></pre><h3 id="将两个版本之间的差异合并到当前文件"><a href="#将两个版本之间的差异合并到当前文件" class="headerlink" title="将两个版本之间的差异合并到当前文件"></a>将两个版本之间的差异合并到当前文件</h3><pre><code>svn merge -r m:n path例如：svn merge -r 200:205 test.php（将版本200与205之间的差异合并到当前文件，但是一般都会产生冲突，需要处理一下）</code></pre><h3 id="SVN-帮助"><a href="#SVN-帮助" class="headerlink" title="SVN 帮助"></a>SVN 帮助</h3><pre><code>svn helpsvn help ci</code></pre><h3 id="版本库下的文件和目录列表"><a href="#版本库下的文件和目录列表" class="headerlink" title="版本库下的文件和目录列表"></a>版本库下的文件和目录列表</h3><pre><code>svn list path显示path目录下的所有属于版本库的文件和目录简写：svn ls</code></pre><h3 id="创建纳入版本控制下的新目录"><a href="#创建纳入版本控制下的新目录" class="headerlink" title="创建纳入版本控制下的新目录"></a>创建纳入版本控制下的新目录</h3><pre><code>&lt;br&gt;&lt;/br&gt;svn mkdir: 创建纳入版本控制下的新目录。用法: 1、mkdir PATH...2、mkdir URL...创建版本控制的目录。1、每一个以工作副本 PATH 指定的目录，都会创建在本地端，并且加入新增调度，以待下一次的提交。2、每个以URL指定的目录，都会透过立即提交于仓库中创建。在这两个情况下，所有的中间目录都必须事先存在。</code></pre><h3 id="恢复本地修改"><a href="#恢复本地修改" class="headerlink" title="恢复本地修改"></a>恢复本地修改</h3><pre><code>svn revert: 恢复原始未改变的工作副本文件 (恢复大部份的本地修改)。revert:用法: revert PATH...注意: 本子命令不会存取网络，并且会解除冲突的状况。但是它不会恢复被删除的目录</code></pre><h3 id="代码库URL变更"><a href="#代码库URL变更" class="headerlink" title="代码库URL变更"></a>代码库URL变更</h3><pre><code>svn switch (sw): 更新工作副本至不同的URL。用法: 1、switch URL [PATH]2、switch --relocate FROM TO [PATH...]1、更新你的工作副本，映射到一个新的URL，其行为跟“svn update”很像，也会将服务器上文件与本地文件合并。这是将工作副本对应到同一仓库中某个分支或者标记的方法。2、改写工作副本的URL元数据，以反映单纯的URL上的改变。当仓库的根URL变动 (比如方案名或是主机名称变动)，但是工作副本仍旧对映到同一仓库的同一目录时使用这个命令更新工作副本与仓库的对应关系。</code></pre><h3 id="解决冲突"><a href="#解决冲突" class="headerlink" title="解决冲突"></a>解决冲突</h3><pre><code>svn resolved: 移除工作副本的目录或文件的“冲突”状态。用法: resolved PATH...注意: 本子命令不会依语法来解决冲突或是移除冲突标记；它只是移除冲突的相关文件，然后让 PATH 可以再次提交。</code></pre><h3 id="输出指定文件或URL的内容。"><a href="#输出指定文件或URL的内容。" class="headerlink" title="输出指定文件或URL的内容。"></a>输出指定文件或URL的内容。</h3><pre><code>svn cat 目标[@版本]...如果指定了版本，将从指定的版本开始查找。svn cat -r PREV filename &gt; filename (PREV 是上一版本,也可以写具体版本号,这样输出结果是可以提交的)</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SVN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java集合框架综述</title>
      <link href="/java-collections-framework-notes.html"/>
      <url>/java-collections-framework-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="集合框架（collections-framework）"><a href="#集合框架（collections-framework）" class="headerlink" title="集合框架（collections framework）"></a>集合框架（collections framework）</h3><p>首先要明确，集合代表了一组对象（和数组一样，但数组长度不能变，而集合能）。Java中的集合框架定义了一套规范，用来表示、操作集合，使具体操作与实现细节解耦。</p><p>其实说白了，可以把一个集合看成一个微型数据库，操作不外乎“增删改查”四种操作，我们在学习使用一个具体的集合类时，需要把这四个操作的时空复杂度弄清楚了，基本上就可以说掌握这个类了。</p><h3 id="设计理念"><a href="#设计理念" class="headerlink" title="设计理念"></a>设计理念</h3><p>主要理念用一句话概括就是：提供一套“小而美”的API。API需要对程序员友好，增加新功能时能让程序员们快速上手。<br>为了保证核心接口足够小，最顶层的接口（也就是Collection与Map接口）并不会区分该集合是否可变（mutability）,是否可更改（modifiability）,是否可改变大小（resizability）这些细微的差别。相反，一些操作是可选的，在实现时抛出UnsupportedOperationException即可表示集合不支持该操作。集合的实现者必须在文档中声明那些操作是不支持的。</p><p>为了保证最顶层的核心接口足够小，它们只能包含下面情况下的方法：</p><p>基本操作，像之前说的“增删改查”<br>There is a compelling performance reason why an important implementation would want to override it.<br>此外，所有的集合类都必须能提供友好的交互操作，这包括没有继承Collection类的数组对象。因此，框架提供一套方法，让集合类与数组可以相互转化，并且可以把Map看作成集合。主要理念用一句话概括就是：提供一套“小而美”的API。API需要对程序员友好，增加新功能时能让程序员们快速上手。<br>为了保证核心接口足够小，最顶层的接口（也就是Collection与Map接口）并不会区分该集合是否可变（mutability）,是否可更改（modifiability）,是否可改变大小（resizability）这些细微的差别。相反，一些操作是可选的，在实现时抛出<code>UnsupportedOperationException</code>即可表示集合不支持该操作。集合的实现者必须在文档中声明那些操作是不支持的。</p><p>为了保证最顶层的核心接口足够小，它们只能包含下面情况下的方法：</p><ol><li>基本操作，像之前说的“增删改查”</li><li>There is a compelling performance reason why an important implementation would want to override it.</li></ol><p>此外，所有的集合类都必须能提供友好的交互操作，这包括没有继承<code>Collection</code>类的数组对象。因此，框架提供一套方法，让集合类与数组可以相互转化，并且可以把<code>Map</code>看作成集合。</p><h3 id="两大基类Collection与Map"><a href="#两大基类Collection与Map" class="headerlink" title="两大基类Collection与Map"></a>两大基类Collection与Map</h3><p>在集合框架的类继承体系中，最顶层有两个接口：</p><p>Collection表示一组纯数据<br>Map表示一组key-value对<br>一般继承自Collection或Map的集合类，会提供两个“标准”的构造函数：</p><p>没有参数的构造函数，创建一个空的集合类<br>有一个类型与基类（Collection或Map）相同的构造函数，创建一个与给定参数具有相同元素的新集合类<br>因为接口中不能包含构造函数，所以上面这两个构造函数的约定并不是强制性的，但是在目前的集合框架中，所有继承自Collection或Map的子类都遵循这一约定。</p><p>Collection在集合框架的类继承体系中，最顶层有两个接口：</p><ul><li><code>Collection</code>表示一组纯数据</li><li><code>Map</code>表示一组key-value对</li></ul><p>一般继承自<code>Collection</code>或<code>Map</code>的集合类，会提供两个“标准”的构造函数：</p><ul><li>没有参数的构造函数，创建一个空的集合类</li><li>有一个类型与基类（<code>Collection</code>或<code>Map</code>）相同的构造函数，创建一个与给定参数具有相同元素的新集合类</li></ul><p>因为接口中不能包含构造函数，所以上面这两个构造函数的约定并不是强制性的，但是在目前的集合框架中，所有继承自<code>Collection</code>或<code>Map</code>的子类都遵循这一约定。</p><h5 id="Collection"><a href="#Collection" class="headerlink" title="Collection"></a>Collection</h5><p><img src="https://img.alicdn.com/imgextra/i4/581166664/TB21HYoeVXXXXaLXXXXXXXXXXXX_!!581166664.jpeg" alt="java-collection-hierarchyjava-collection-hierarchy"></p><p>如上图所示，Collection类主要有三个接口：</p><p>Set表示不允许有重复元素的集合（A collection that contains no duplicate elements）<br>List表示允许有重复元素的集合（An ordered collection (also known as a sequence)）<br>Queue JDK1.5新增，与上面两个集合类主要是的区分在于Queue主要用于存储数据，而不是处理数据。（A collection designed for holding elements prior to processing.）如上图所示，<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Collection.html" target="_blank" rel="noopener">Collection</a>类主要有三个接口：</p><ul><li><code>Set</code>表示不允许有重复元素的集合（A collection that contains no duplicate elements）</li><li><code>List</code>表示允许有重复元素的集合（An ordered collection (also known as a sequence)）</li><li><code>Queue</code> JDK1.5新增，与上面两个集合类主要是的区分在于<code>Queue</code>主要用于存储数据，而不是处理数据。（A collection designed for holding elements prior to processing.）</li></ul><h5 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h5><p><img src="https://img.alicdn.com/imgextra/i4/581166664/TB2JzW7eVXXXXbRXpXXXXXXXXXX_!!581166664.jpg" alt="MapClassHierarchyMapClassHierarchy"></p><p>Map并不是一个真正意义上的集合（are not true collections），但是这个接口提供了三种“集合视角”（collection views ），使得可以像操作集合一样操作它们，具体如下：</p><p>把map的内容看作key的集合（map’s contents to be viewed as a set of keys）<br>把map的内容看作value的集合（map’s contents to be viewed as a collection of values）<br>把map的内容看作key-value映射的集合（map’s contents to be viewed as a set of key-value mappings）<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Map.html" target="_blank" rel="noopener">Map</a>并不是一个真正意义上的集合（are not true collections），但是这个接口提供了三种“集合视角”（collection views ），使得可以像操作集合一样操作它们，具体如下：</p><ul><li>把map的内容看作key的集合（map’s contents to be viewed as a set of keys）</li><li>把map的内容看作value的集合（map’s contents to be viewed as a collection of values）</li><li>把map的内容看作key-value映射的集合（map’s contents to be viewed as a set of key-value mappings）</li></ul><h3 id="集合的实现（Collection-Implementations）"><a href="#集合的实现（Collection-Implementations）" class="headerlink" title="集合的实现（Collection Implementations）"></a>集合的实现（Collection Implementations）</h3><p>实现集合接口的类一般遵循+的命名方式，通用的集合实现类如下表：</p><p>Interface Hash Table Resizable Array Balanced Tree Linked List Hash Table + Linked List<br>Set HashSet TreeSet LinkedHashSet<br>List ArrayList LinkedList<br>Deque ArrayDeque LinkedList<br>Map HashMap TreeMap LinkedHashMap实现集合接口的类一般遵循<code>+</code>的命名方式，通用的集合实现类如下表：</p><p>Interface</p><p>Hash Table</p><p>Resizable Array</p><p>Balanced Tree</p><p>Linked List</p><p>Hash Table + Linked List</p><p>Set</p><p>HashSet</p><p>TreeSet</p><p>LinkedHashSet</p><p>List</p><p>ArrayList</p><p>LinkedList</p><p>Deque</p><p>ArrayDeque</p><p>LinkedList</p><p>Map</p><p>HashMap</p><p>TreeMap</p><p>LinkedHashMap</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML5拖放实例</title>
      <link href="/html5-draganddrop-notes.html"/>
      <url>/html5-draganddrop-notes.html</url>
      
        <content type="html"><![CDATA[<p>参考：<a href="https://www.w3schools.com/html/html5_draganddrop.asp" target="_blank" rel="noopener">w3schools</a></p><p>拖放是一种常见的特性，即抓取对象以后拖到另一个位置。<br>在 HTML5 中，拖放是标准的一部分，任何元素都能够拖放。</p><h3 id="设置元素为可拖放"><a href="#设置元素为可拖放" class="headerlink" title="设置元素为可拖放"></a>设置元素为可拖放</h3><pre><code>&lt;div draggable=&quot;true&quot;&gt;&lt;/div&gt;</code></pre><h3 id="设置ondragstart-和并保存数据"><a href="#设置ondragstart-和并保存数据" class="headerlink" title="设置ondragstart 和并保存数据"></a>设置ondragstart 和并保存数据</h3><p>ondragstart 属性调用了一个函数，drag(event,this)，它规定了被拖动的数据。dataTransfer.setData() 方法设置被拖数据的数据类型和值,在这个例子中，数据类型是 “text/html”，值是可拖动元素的innerHTML</p><pre><code>function drag(ev,divdom){    srcdiv=divdom;   ev.dataTransfer.setData(&quot;text/html&quot;,divdom.innerHTML); }</code></pre><h3 id="放到何处-–-ondragover"><a href="#放到何处-–-ondragover" class="headerlink" title="放到何处 – ondragover"></a>放到何处 – ondragover</h3><p><code>ondragover</code>事件规定在何处放置被拖动的数据。<br>默认地，无法将数据/元素放置到其他元素中。如果需要设置允许放置，我们必须阻止对元素的默认处理方式。<br>这要通过调用 <code>ondragover</code> 事件的 <code>event.preventDefault()</code> 方法：</p><pre><code>event.preventDefault()</code></pre><h3 id="进行放置-–-ondrop"><a href="#进行放置-–-ondrop" class="headerlink" title="进行放置 – ondrop"></a>进行放置 – ondrop</h3><p>当放置被拖数据时，会发生 drop 事件。<br>在上面的例子中，ondrop 属性调用了一个函数，drop(event)：</p><pre><code>function drop(ev,divdom){    ev.preventDefault();    if(srcdiv != divdom){         srcdiv.innerHTML = divdom.innerHTML;       divdom.innerHTML=ev.dataTransfer.getData(&quot;text/html&quot;);    }}</code></pre><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Node.js添加Session会话支持</title>
      <link href="/nodejs-session-notes.html"/>
      <url>/nodejs-session-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>该填去年挖得坑了。</p><p>项目中的Web程序框架我用的是<code>Express</code>，下面基本以<code>Express</code>为主。</p><h3 id="环境初始化"><a href="#环境初始化" class="headerlink" title="环境初始化"></a>环境初始化</h3><p>需要安装下面俩个依赖包支持：</p><pre><code>npm install --save express-session session-file-store</code></pre><h3 id="session配置"><a href="#session配置" class="headerlink" title="session配置"></a>session配置</h3><blockquote><p>app.js</p></blockquote><pre><code>var express = require(&apos;express&apos;);var session = require(&apos;express-session&apos;);var FileStore = require(&apos;session-file-store&apos;)(session);var app = express();var identityKey = &apos;iiong&apos;;//设置sessionapp.use(session({   name: identityKey,   store: new FileStore(), //本地存储session（文本文件，也可以选择其他store，比如redis的）   saveUninitialized: false, //是否自动保存未初始化的会话，建议false   resave: false, //是否每次都重新保存会话，建议false   secret: &apos;1234567890&apos;, //用来对session id相关的cookie进行签名，建议使用 128 个字符的随机字符串   cookie: {       maxAge: 60 * 1000  //有效期，单位是毫秒,实例会话有效期1分钟   }}));</code></pre><p>上面是session的基础配置，也没得好说的，该注释的我都已经注释了。</p><h3 id="登录、登出接口实现"><a href="#登录、登出接口实现" class="headerlink" title="登录、登出接口实现"></a>登录、登出接口实现</h3><blockquote><p>login.js：</p></blockquote><pre><code>var express = require(&apos;express&apos;);var router = express.Router();// 实现与MySQL交互var mysql = require(&apos;mysql&apos;);var config = require(&apos;../model/config&apos;);// 使用连接池，提升性能var pool = mysql.createPool(config.mysql);/* GET login page. */router.get(&apos;/&apos;, function (req, res, next) {   res.render(&apos;login&apos;, {title: &apos;login&apos;});});router.post(&apos;/userLogin&apos;, function (req, res, next) {   var username = req.body.username;//获取前台请求的参数   var password = req.body.password;   var sess = req.session;   pool.getConnection(function (err, connection) {       //先判断该账号是否存在       var $sql = &quot;select * from users where username=?&quot;;       connection.query($sql, [username], function (err, result) {           var resultJson = result;           console.log(resultJson.length);           if (resultJson.length === 0) {               result = {                   code: 300,                   msg: &apos;该账号不存在&apos;               };               res.json(result);               connection.release();           } else {  //账号存在，可以登录，进行密码判断               var $sql1 = &quot;select password from users where username=?&quot;;               connection.query($sql1, [username], function (err, result) {                   var temp = result[0].password;  //取得数据库查询字段值                   if (temp === password) {                       result = {                           code: 200,                           msg: &apos;密码正确&apos;                       };                       sess.username = [username];//存入session中                   } else {                       result = {                           code: 400,                           msg: &apos;密码错误&apos;                       };                   }                   res.json(result); // 以json形式，把操作结果返回给前台页面                   connection.release();// 释放连接               });           }       });   });});module.exports = router;doctype htmlhtml head   title   link(rel=&apos;stylesheet&apos;, href=&apos;/stylesheets/style.css&apos;)   link(rel=&apos;stylesheet&apos;, href=&apos;/bootstrap-3.3.7-dist/css/bootstrap.min.css&apos;)   script(src=&apos;/javascripts/jquery-3.1.1.min.js&apos;)   script(src=&apos;/bootstrap-3.3.7-dist/js/bootstrap.min.js&apos;) body(style=&apos;background: #dcd9da&apos;)   // h1= title   .container     .row       .col-md-4.col-md-offset-4         .panel.panel-default(style=&apos;margin-top: 100px&apos;)           .panel-heading(style=&apos;background: #0d6aad&apos;)             h4(align=&apos;center&apos;, style=&apos;color: #ffffff;&apos;)               | express-jade-bootstrap-mysql-demo           .panel-body(style=&apos;background: #e0e1ea&apos;)             .form-group               .input-group                 span.input-group-addon 账号                 input#username.form-control(type=&apos;text&apos;, placeholder=&apos;请输入账号&apos;)             .form-group               .input-group                 span.input-group-addon 密码                 input#password.form-control(type=&apos;password&apos;, placeholder=&apos;请输入密码&apos;)             .form-group               .col-lg-offset-7                 | 没有账号？                 a(href=&apos;/register&apos;) 注册             .form-group               button#login.btn.btn-success.btn-block(type=&apos;button&apos;)                 | 登录             #popup.alert.alert-warning               a#close.close(href=&apos;#&apos;) ×               div(align=&apos;center&apos;)                 strong#popup-content(style=&apos;color: #b12e30;&apos;)   script(type=&apos;text/javascript&apos;).     $(document).ready(function () {       var username = $(&quot;#username&quot;);       var password = $(&quot;#password&quot;);       var login = $(&quot;#login&quot;);       var popup = $(&quot;#popup&quot;);       var popupContent = $(&quot;#popup-content&quot;);       var close = $(&quot;#close&quot;);       popup.hide();       close.click(function () {         popup.hide();       });       login.click(function () {         if (username.val() == &quot;&quot; || password.val() == &quot;&quot;) {           popup.show();           popupContent.html(&quot;账号或密码不能为空！&quot;);         } else {           $.ajax({                     url: &quot;/login/userLogin&quot;,                     data: {                       username: $(&quot;#username&quot;).val(),                       password: $(&quot;#password&quot;).val()                     },                     type: &quot;POST&quot;,                     timeout: 36000,                     dataType: &quot;text&quot;,                     success: function (data, textStatus) {                       console.log(data);                       var dataJson = eval(&quot;(&quot; + data + &quot;)&quot;);                       if (dataJson.code == 200) {                         alert(&quot;登录成功&quot;);                         window.location.href = &quot;/&quot;;                       } else if (dataJson.code == 300) {                         popup.show();                         popupContent.html(&quot;账号不存在，请重新输入！&quot;);                       } else if (dataJson.code == 400) {                         popup.show();                         popupContent.html(&quot;密码有误，请重新输入！&quot;);                       } else {                         popup.show();                         popupContent.html(&quot;登录出错！&quot;);                       }                     },                     error: function (XMLHttpRequest, textStatus, errorThrown) {                       alert(&quot;error:&quot; + textStatus);                     }                   }           );         }       })       ;     })     ;</code></pre><blockquote><p>logout.js</p></blockquote><pre><code>var express = require(&apos;express&apos;);var router = express.Router();var identityKey = &apos;iiong&apos;;/* GET logout page. */router.get(&apos;/&apos;, function (req, res, next) {   req.session.destroy(function (err) {       if(err){           res.json({ret_code: 2, ret_msg: &apos;退出登录失败&apos;});           return;       }       // req.session.loginUser = null;       res.clearCookie(identityKey);       res.redirect(&apos;/&apos;);   })});module.exports = router;</code></pre><blockquote><p>logout.jade:</p></blockquote><pre><code>doctype htmlhtml head   title= title   link(rel=&apos;stylesheet&apos;, href=&apos;/stylesheets/style.css&apos;) body   block contentscript(type=&apos;text/javascript&apos;).   console.log(&quot;此页面是登录后主页&quot;);</code></pre><blockquote><p>index.js</p></blockquote><pre><code>var express = require(&apos;express&apos;);var router = express.Router();// 实现与MySQL交互var mysql = require(&apos;mysql&apos;);var config = require(&apos;../model/config&apos;);// 使用连接池，提升性能var pool = mysql.createPool(config.mysql);/* GET home page. */router.get(&apos;/&apos;, function (req, res, next) {   var sess = req.session;   var loginUser = sess.username;   var isLogined = !!isLogined;   res.render(&apos;index&apos;, {       title: &apos;Express&apos;,       isLogined: isLogined,       name: loginUser || &apos;游客&apos;   });});module.exports = router;</code></pre><blockquote><p>index.jade:</p></blockquote><pre><code>doctype htmlhtml head   title= title   link(rel=&apos;stylesheet&apos;, href=&apos;/stylesheets/style.css&apos;) bodyscript(type=&apos;text/javascript&apos;).   console.log(&quot;此页面是登录后主页&quot;);block content h1= title p Welcome to #{title} if isLogined == isLogined   h3 #{name}   a(href=&quot;logout&quot;)#logout 注销</code></pre><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><p><a href="https://github.com/expressjs/session" target="_blank" rel="noopener">Github</a></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.JS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>放弃吧</title>
      <link href="/520.html"/>
      <url>/520.html</url>
      
        <content type="html"><![CDATA[<p>又是一夜未眠，哭完人果然好多了，是的，这次我是真的放弃了，心累。</p><p>有时候，发现自己好傻，为什么会这样？</p><hr><p>你可能觉得难过，不是，你应该觉得难过。</p><p>因为无论你对我怎么好，我都不领情。</p><p>我不是看不到，我只是装作看不到。</p><p>我根本不想看到。</p><p>你觉得自己很喜欢我，</p><p>甚至觉得再没有一个人可以像你那么喜欢我。</p><p>你用尽全力对我好。</p><p>把我看得比自己还重要。</p><p>有什么事情第一个就想到我。</p><p>联系不到我的时候，你担心我担心得快疯了。</p><p>然而你有没有想过，这并不在你的责任范围。</p><p>而且很有可能我是在躲着你。</p><p>我受不了你对我那么好。</p><p>不要一直发短信给我。</p><p>不要一直找我。</p><p>你也许只是想找我说说话，你觉得那很正常，不算苛求 。</p><p>但是我并不这么想。</p><p>记住，你的想法不代表我的想法。</p><p>你是真的不求回报的在喜欢我吗？</p><p>你扪心自问一下，你确定不用我回报什么吗？</p><p>那为什么你会难过。</p><p>若是真的一无所求，你又怎么会觉得难过呢。</p><p>所以，别觉得你那么爱我是伟大的。</p><p>我不会因为你可怜而喜欢你。</p><p>你说道理你都懂，只是做不好。</p><p>不是你做不好，是你不想做。</p><p>你不是怕忘记我，你是怕我忘了你吧 。</p><p>别说什么我离不开你的。</p><p>其实分明就是你离不开我。</p><p>我若是离不开你，我就不会不要你 。</p><p>不懂事的人是你。</p><p>难道你没看出来吗。</p><p>喜欢我不是你的错。</p><p>想关心我不是你的错。</p><p>控制不住自己不是你的错。</p><p>但是那是你的方式。</p><p>我不一定就能接受你这种所谓无私的爱。</p><p>那么就请你默默的。</p><p>别试图让我知道。</p><p>就算你会难过，甚至难过的流泪。</p><p>都请你默默的。</p><p>就算是逼自己也好。</p><p>一定要忍着，不要再来打扰我的生活。</p><p>所以，傻孩子。</p><p>你无法轻易忘记放弃。是因为你付出过。</p><p>付出了，就会像柱子一样扎根在心。</p><p>不要去刻意逃避，刻意忘记。那只会让你更痛苦。</p><p>绕开这个柱子，寻找未来的幸福生活吧。</p><p>那里，有你的理想。</p><p>傻孩子。</p><p>开始新的习惯吧。</p><p>习惯，早上不再给我人工闹铃。</p><p>习惯，每天一个人生活。</p><p>习惯，一个人过生日。一个人行走。</p><p>习惯，走过熟悉的路。面对熟悉的景。</p><p>你逃不掉。逃不掉的。</p><p>那么，就勇敢面对现实。</p><p>现实是，我已离开。</p><p>一切画上了句点。</p><p>傻孩子。</p><p>勇敢看着镜子中的自己吧。</p><p>这个悲伤软弱满面憔悴的自己。</p><p>这也是你，成长中的你。</p><p>这个你，正在逐渐死去。</p><p>新的你，即将重生。</p><p>找寻你的路，你的未来。</p><p>你知道的，所有的浩劫，都是成长的祭典。</p><p>做最好的自己。即使一个人。</p><p>傻孩子。</p><p>好好，尽情发泄吧。</p><p>剥开自己的心。用文字，用声音，用所有能发泄的方式。</p><p>发泄完了。就要振作。</p><p>看吧。你失去的。其实微不足道。</p><p>还有那么多人关心着你，以不同的方式。</p><p>所以，你并不孤独</p><p>正是这样的失去。让你看清现在所拥有的爱情。</p><p>生活褪去了曾有的颜色。暂时宁静。</p><p>别沉沦在这片宁静里。那会毁掉你。</p><p>你要明白，虽然残忍，但这个决定，足够正确。</p><p>现在的生活，不是你想要的。</p><p>为了你的理想，你必须学会适时放弃。</p><p>给对方最好的关怀，就是，变得更好。</p><p>更强大。</p><p>更幸福。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>EMD Vol 1705</title>
      <link href="/emd-vol-1705.html"/>
      <url>/emd-vol-1705.html</url>
      
        <content type="html"><![CDATA[<h3 id="2017-05-20"><a href="#2017-05-20" class="headerlink" title="2017.05.20"></a>2017.05.20</h3><p>嗯，今天是虐狗的日子，然而对我来说好像没啥用。</p><p>不扯了，总结下这个月过得咋样，总体来说，这个月感觉像是过了一年，很慢。</p><h3 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h3><p>工作还好，挺安逸的，就是有点安逸过头了，以前在外面天天忙得要死，突然回归这样的生活，有点不习惯，想去适应却无法适应，可能和我性格有关吧。之前一直在想，人不折腾，就这么躺着，有什么意义？每个人都有都有自己的生活方式？嗯，扯远了…</p><p>公司分配的任务也不多，就俩个项目做成WeApp即可，本来是打算Node.js随便一个Web框架去完成，然后想想算了，因为项目的维护性和安全性，还是采用HTML5App技术去完成吧。然后…然后就没然后了，一边咸鱼一边做吧…唯一不满意就是工资太低太低…哎，毕竟三线城市吧，劳动力的确廉价了点。</p><p>虽然现在呆在的公司，特别是管理层，实在是受不了各种缺点了，但作为前端的我，也影响不到我，先呆着再说。前段时间考虑在试用期结束后直接跳槽去上海或南京，很遗憾的事，因为某些事放弃这个想法。</p><h3 id="生活"><a href="#生活" class="headerlink" title="生活"></a>生活</h3><p>这个月发生的事情，有点让我懵逼，准确的说让我很郁闷啊，写到这儿也不多写了。</p><p>前段时间有个演讲，很高兴的是，自己又进步了，希望自己永远这样保持下去。然后生活很稳定，每天该咋就咋的…</p><p>还有感情的事，我也很困扰…随遇而安吧，虽然是这么说，实际上并不是这样了，鬼知道自己想这么多干什么。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript图片处理(改)</title>
      <link href="/javascript-make-images-pro.html"/>
      <url>/javascript-make-images-pro.html</url>
      
        <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>公司做的项目需要，找了以前的代码，发现有些问题，花了点时间把代码优化了下。</p><p>公司业务如下：用户上传图片，显示缩略图，传给后台图片数据即可。</p><p>所以结合以前做过的思路如下：</p><p>设置一个div，这个div负责渲染图片，然后div覆盖file类的input标签，负责上传图片。图片上传采用<code>base64</code>方式，目前也就这个比较流行点。</p><p>参考以前的文章<br>[in_post ids=436]</p><p>看了以前做的代码，都啥玩意儿…于是花了点时间优化下。</p><h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><pre><code>&lt;!--图片上传--&gt;&lt;div class=&quot;mui-input-row upload_images&quot;&gt;   &lt;p&gt;点击加号，添加图片;点击已添加图片，实现图片的删除&lt;/p&gt;   &lt;div class=&quot;upload_images_main&quot;&gt;       &lt;div id=&quot;images_1&quot; class=&quot;upload_img&quot;&gt;           &lt;span&gt;上传图片&lt;/span&gt;           &lt;input id=&quot;input_img_1&quot; type=&quot;file&quot; /&gt;       &lt;/div&gt;       &lt;div id=&quot;images_2&quot; class=&quot;upload_img&quot;&gt;           &lt;span&gt;上传图片&lt;/span&gt;           &lt;input id=&quot;input_img_2&quot; type=&quot;file&quot; /&gt;       &lt;/div&gt;       &lt;div id=&quot;images_3&quot; class=&quot;upload_img&quot;&gt;           &lt;span&gt;上传图片&lt;/span&gt;           &lt;input id=&quot;input_img_3&quot; type=&quot;file&quot; /&gt;       &lt;/div&gt;       &lt;div id=&quot;images_4&quot; class=&quot;upload_img&quot;&gt;           &lt;span&gt;上传图片&lt;/span&gt;           &lt;input id=&quot;input_img_4&quot; type=&quot;file&quot; /&gt;       &lt;/div&gt;       &lt;div id=&quot;images_5&quot; class=&quot;upload_img&quot;&gt;           &lt;span&gt;上传图片&lt;/span&gt;           &lt;input id=&quot;input_img_5&quot; type=&quot;file&quot; /&gt;       &lt;/div&gt;   &lt;/div&gt;&lt;/div&gt;/*图片上传*/.upload_images {   height: inherit!important;}.upload_images_main {   height: 250px;   width: 100%;   display: flex;   flex-flow: wrap;   margin-bottom: 30px;}.upload_img {   width: 30.3333%;   height: 50%;   background: #eee;   border: 1px dashed rgba(0,0,0,0.5);   margin-left: 10px;   margin-top: 10px;}.upload_img input {   width: 100%;   height: 100%;}.upload_img input[type=&quot;file&quot;] {   opacity: 0;}.upload_img span {   position: absolute;   text-align: center;   height: 40%;   line-height: 125px;   width: 30%;}</code></pre><p>样式采用的弹性盒子模型，挺好用的…</p><pre><code>/*input 1*/document.getElementById(&quot;input_img_1&quot;).addEventListener(&quot;change&quot;,upload_1,false);function upload_1(e) {    var files = this.files;    //console.log(files);    var img = new Image();    var reader = new FileReader();    var fileSize = files[0].size;    var fileType = files[0].type;    // 1024字节 = 1千字节 1024千字节 = 1兆字节    var fileSizeMax = (1024 * 1024) * 5;    if( (fileType !== &quot;image/jpg&quot;) &amp;&amp; (fileType !== &quot;image/png&quot;) &amp;&amp; (fileType !== &quot;image/gif&quot;)&amp;&amp;(fileType !== &quot;image/bmp&quot;) &amp;&amp; (fileType !== &quot;image/jpeg&quot;) &amp;&amp; (fileType !== &quot;image/gif&quot;) ) {        mui.alert(&quot;请上传标准图片格式文件&quot;,&quot;照片上传&quot;);        return;    } if (fileSize &gt; fileSizeMax) {        mui.alert(&quot;图片过大，请重新选择&quot;,&quot;照片上传&quot;);        return;    } else {        lrz(files[0]).then(function (rst) {            //console.log(&quot;图片压缩详细输出信息：&quot; + rst);            //console.log(&quot;图片压缩后Base64输出：&quot; + rst.base64);            reader.readAsDataURL(files[0]);            reader.onload=function(e){                /*未压缩*/                //imgSrc = img.src;                //console.log(&quot;用户上传图片：&quot; + imgSrc);                img.src=this.result;                /*已压缩*/                imgSrc = rst.base64;                //console.log(&quot;用户上传图片（已压缩）：&quot; + imgSrc);                //console.log(&quot;用户上传图片：&quot; + rst.origin.name);                /*截取字符串*/                var imgIndex = imgSrc.lastIndexOf(&quot;,&quot;);                var imgBase64 = imgSrc.substring(imgIndex + 1);                //console.log(&quot;截取后字符串：&quot; + imgBase64);                img.style.width = &apos;100%&apos;;                img.style.height = &apos;100%&apos;;                document.getElementById(&quot;images_1&quot;).innerHTML = &quot;&quot;;                document.getElementById(&quot;images_1&quot;).appendChild(img);            }        });    }    console.log(&quot;本地上传文件：&quot;+files[0].name+&quot;上传成功&quot;);}//删除图片var isImage_1 = document.getElementById(&quot;images_1&quot;);isImage_1.addEventListener(&apos;click&apos;,function () { //使用click避免出现在移动端再次点击input的事件    if (isImage_1.childNodes.length === 1) {        isImage_1.childNodes[0].remove();        isImage_1.innerHTML = &apos;&lt;span&gt;上传图片&lt;/span&gt;&lt;input id=&quot;input_img_1&quot; type=&quot;file&quot;&gt;&apos;;        document.getElementById(&quot;input_img_1&quot;).addEventListener(&quot;change&quot;,upload_1,false);    }});</code></pre><p>实例有个压缩图片的过程，Demo在<a href="https://github.com/think2011/localResizeIMG" target="_blank" rel="noopener">Github</a>上，使用还不错，但是兼容性还存在一定的问题，后期再考虑吧。</p><p>本来五个按钮做个for循环去遍历，考虑到性能就没去做，干脆换个id粘贴复制就行了，按钮也不多…</p><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>font-family的折腾笔记</title>
      <link href="/font-family-notes.html"/>
      <url>/font-family-notes.html</url>
      
        <content type="html"><![CDATA[<p>如何优雅的选择<code>font-family</code>？</p><p>『根据每个平台不同字体的品质和产品本身的需求，尽可能精细地指定 font-family fallback 顺序，避免落入浏览器和操作系统的默认配置，这是一种「优雅」的流派。』</p><p>绝大部分中文字体里都包含英文字母和数字，不进行英文字体声明是没有问题的，但是大多数中文字体中的英文和数字的部分都不是特别漂亮，所以建议也对英文字体进行声明。由于英文字体中大多不包含中文，我们可以先进行英文字体的声明，这样不会影响到中文字体的选择，因此优先使用最优秀的英文字体，中文字体声明则紧随其次，其次再考虑不同平台的字体兼容。</p><p>以下字体经过一些文章参考总结，目前用在博客，字体渲染还不错。</p><pre><code>.font {    font-family:    -apple-system,            /* Safari on MacOS X and iOS */    BlinkMacSystemFont,       /* Chrome on MacOS X */    /*English First*/    &quot;Helvetica Neue&quot;,         /* Old OSX Capitan */    &quot;Segoe UI&quot;,               /* Windows and Windows Phone */    &quot;Roboto&quot;,                 /* Android and newer Chrome OS */    &quot;Oxygen&quot;,                 /* Linux KDE Desktop */    &quot;Ubuntu&quot;,                 /* Linux Ubuntu System */    &quot;Cantarell&quot;,              /* Linux GNOME Desktop */    &quot;Fira Sans&quot;,              /* Firefox OS */    &quot;Droid Sans&quot;,             /* Android */    /*Chinese Fallback*/    &quot;PingFang SC&quot;,            /* OSX ^10.11 &amp; iOS ^9  苹方丽黑 */    &quot;Hiragino Sans GB&quot;,       /* OSX ^10.6            冬青黑体 */    &quot;STHeiti&quot;,                /* OSX &lt;10.6  &amp; iOS &lt;9  华文黑体 */    &quot;Microsoft YaHei&quot;,        /* Win                  微软雅黑 */    &quot;Microsoft JhengHei&quot;,     /* Win                  微软正黑 */    &quot;Source Han Sans SC&quot;,     /* Android 5.0^         思源黑体 */    &quot;Noto Sans CJK SC&quot;,       /* Android 5.0^         思源黑体 */    &quot;Source Han Sans CN&quot;,     /* Android 5.0^         思源黑体 */    &quot;Noto Sans SC&quot;,           /* Android 5.0^         思源黑体 */    &quot;Source Han Sans TC&quot;,     /* Android 5.0^         思源黑体 */    &quot;Noto Sans CJK TC&quot;,       /* Android 5.0^         思源黑体 */    &quot;WenQuanYi Micro Hei&quot;,    /* Linux             文泉驿微米黑 */    SimSun,                   /* Win old              中易宋体 */    sans-serif;               /* System Fallback              */}</code></pre><p>min：</p><pre><code>font-family: -apple-system,BlinkMacSystemFont,&quot;Helvetica Neue&quot;,&quot;Segoe UI&quot;,Roboto,Oxygen,Ubuntu,Cantarell,&quot;Fira Sans&quot;,&quot;Droid Sans&quot;,&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,STHeiti,&quot;Microsoft YaHei&quot;,&quot;Microsoft JhengHei&quot;,&quot;Source Han Sans SC&quot;,&quot;Noto Sans CJK SC&quot;,&quot;Source Han Sans CN&quot;,&quot;Noto Sans SC&quot;,&quot;Source Han Sans TC&quot;,&quot;Noto Sans CJK TC&quot;,&quot;WenQuanYi Micro Hei&quot;,SimSun,sans-serif</code></pre><p>以上字体实例可以在我的博客：<a href="https://iiong.com" target="_blank" rel="noopener">淮城一只猫</a></p><p>参考：<br><a href="http://zenozeng.github.io/fonts.css/" target="_blank" rel="noopener">Fonts.css — 跨平台中文字体解决方案</a><br><a href="https://www.smashingmagazine.com/2015/11/using-system-ui-fonts-practical-guide/" target="_blank" rel="noopener">Using UI System Fonts In Web Design: A Quick Practical Guide</a><br><a href="https://webkit.org/blog/3709/using-the-system-font-in-web-content/" target="_blank" rel="noopener">Using the System Font in Web Content</a></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>移动端滚动穿透摸索之路</title>
      <link href="/fuck-the-scroll-bar-problem.html"/>
      <url>/fuck-the-scroll-bar-problem.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在移动端设置<code>fixed</code>属性可以解决滚动问题，但是在某些特地的情况下，例如有遮罩层或者弹窗的情况下，依然发现可以滚动背景下的内容！</p><h3 id="overflow-hidden"><a href="#overflow-hidden" class="headerlink" title="overflow: hidden"></a>overflow: hidden</h3><pre><code>body {    overflow: hidden;    height: 100%;}</code></pre><p>这样可以解决滚动条的问题，但是有俩个缺点：</p><ul><li>由于<code>body</code>被禁用滚动，弹窗的页面滚动条位置会丢失，可以用js去还原</li><li>页面的背景有滚动效果</li></ul><h3 id="touchmove-preventDefault"><a href="#touchmove-preventDefault" class="headerlink" title="touchmove + preventDefault"></a>touchmove + preventDefault</h3><pre><code>document.addEventListener(&apos;touchmove&apos;, function(e) {  e.preventDefault();}, false);</code></pre><p>这个js是我之前一直在用的方法，但是也发现一个很大的问题：</p><ul><li>比如你弹出的窗口，里面包含大量的内容需要滚动，然而你会发现无法滚动，js把它阻止滚动了</li></ul><h3 id="最终解决"><a href="#最终解决" class="headerlink" title="最终解决"></a>最终解决</h3><p>首先css添加：</p><pre><code>body.iiong {    position: fixed;    width: 100%;}</code></pre><p>只单独写这个话，弹窗内容的滚动条依然丢失。</p><p>所以还得添加js去还原滚动条：</p><pre><code>/**  * ModalHelper helpers resolve the modal scrolling issue on mobile devices  * https://github.com/twbs/bootstrap/issues/15852  * requires document.scrollingElement polyfill https://github.com/yangg/scrolling-element  */var ModalHelper = (function(bodyCls) {  var scrollTop;  return {    afterOpen: function() {      scrollTop = document.scrollingElement.scrollTop;      document.body.classList.add(bodyCls);      document.body.style.top = -scrollTop + &apos;px&apos;;    },    beforeClose: function() {      document.body.classList.remove(bodyCls);      // scrollTop lost after set position:fixed, restore it back.      document.scrollingElement.scrollTop = scrollTop;    }  };})(&apos;iiong&apos;);</code></pre><p>所以以上说到的缺点，都得到解决了。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> JavaScript </tag>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>最近</title>
      <link href="/recently-planned-notes.html"/>
      <url>/recently-planned-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>导致做出这样的选择，因为一个朋友的建议。</p><p>“你应该出去走走了！”</p><p>虽说以前很宅，最近俩年改变太多，性格也比以前活跃太多，但是对于自己并不满意。</p><p>朋友的话让我反省很多，或许一个人旅途能够改变我，所以很突兀，做了一个决定：</p><ul><li>抛开今年百分之七十的计划，留到未来再说！</li><li>争取每个月有个满意的旅游，方式不限。</li><li>三年内完成自己最后的蜕变。</li></ul><hr><h3 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h3><p>以前的我，各种缺点继承一身，各种负面情绪以及消极生活态度。</p><p>真正让我改变在我转行IT行业，短短的半年让我改变得太多，对我开始第一次变化，带来的精神面貌焕然一新，自信的笑容，积极的态度，坚强的肩膀，永不放弃的精神，一切都充满正能量。</p><p>但因为没有及时管理自我负面情绪，最终不可避免沾染中度抑郁症。白天和正常人无异，一到晚上就好似黑暗笼罩着我，压抑无法呼吸，各种消极情绪滋生，有好几次面对阳台想着，一跳就结束了，每次有这个念头就不停的压抑。想想很可笑，因为自己有个自带‘永远不会对生活失去热情’的光环，所以再次改变我。第二次的改变让我学会去隐藏心中最黑暗的的东西。</p><p>综合俩次的改变，成就现在的我。似乎没有问题了？不，前几天因某件事不开心撸了一夜代码，在此之后突然发现自己生活好像都安排好了，体内深处的灵魂变得麻木不仁，失去鲜艳的生活乐趣。觉得有必要一次改变自己，下面接近三年我想在旅途中度过！至于第三次能改变自己，一切看造化吧。</p><p>相信第三次的蜕变，迎来全新的自我！</p><blockquote><p>让你的改变，打动你在乎的人！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>MyEclipse-2017-ci-4 破解教程</title>
      <link href="/myeclipse-2017-ci-4-creak.html"/>
      <url>/myeclipse-2017-ci-4-creak.html</url>
      
        <content type="html"><![CDATA[<h3 id="准备工具"><a href="#准备工具" class="headerlink" title="准备工具"></a>准备工具</h3><p>myeclipse-2017-ci-4-offline-installer-windows.exe</p><p>myeclise-2017-CI-4破解文件(算号器)</p><p>下载地址：</p><p>链接: <a href="https://pan.baidu.com/s/1jIkgO1g" target="_blank" rel="noopener">https://pan.baidu.com/s/1jIkgO1g</a><br>密码: qrku</p><h3 id="破解教程"><a href="#破解教程" class="headerlink" title="破解教程"></a>破解教程</h3><ul><li>安装<code>myeclipse-2017-ci-4-offline-installer-windows.exe</code>，安装好后别打开MyEclipse程序，否则有网络验证导致破解失败。</li><li>解压<code>MyEclipse-2017-CI-4破解文件.zip</code>，打开里面的<code>crack.bat</code>文件，弹出一个窗口，然后进行如下操作：<br><img src="https://res.i95.me/wp-content/uploads/2017/04/201704290747-1.png" alt></li><li>把补丁包（patch）里的plugins中的文件复制到MyEclipse的plugins文件夹中，覆盖原文件。</li><li>破解完成，打开myeclipse就可以用了</li></ul>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> MyEclipse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DWR中的session error问题解决</title>
      <link href="/dwr-session-error-notes.html"/>
      <url>/dwr-session-error-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>今天帮妹子搞毕设的时候，运行程序，登录账号是报<code>session error</code>这个错误。 查看后台控制信息，有个报错：</p><pre><code>严重: A request has been denied as a potential CSRF attack.</code></pre><p>然后百度搜索相关资料，得知报错是因为跨域？!我不知道这个说发对不对… 具体是请求被拒绝因为可能存在csrf(cross-site request forgeries,跨站请求伪造)攻击. 也就是说页面URL可能被跨站了的服务所调用.</p><h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><p>解决方案也很好解决了，在web.xml配置文件中dwr的配置中，修改如下：</p><pre><code>&lt;servlet-name&gt;dwr-invoker&lt;/servlet-name&gt;&lt;servlet-class&gt;org.directwebremoting.servlet.DwrServlet&lt;/servlet-class&gt;&lt;init-param&gt;  &lt;param-name&gt;debug&lt;/param-name&gt;  &lt;param-value&gt;true&lt;/param-value&gt;&lt;/init-param&gt;&lt;!-- 新加corssDomainSessionSecurity参数 --&gt;　　   &lt;init-param&gt;　　　　　　　　&lt;param-name&gt;crossDomainSessionSecurity&lt;/param-name&gt;　　　　　　　　&lt;param-value&gt;false&lt;/param-value&gt;　　　　  &lt;/init-param&gt;</code></pre><p>加入<code>crossDomainSessionSecurity</code>这个配置选项..这个参数是在dwr版本2.0才有的.默认值为true,也就是禁止其他域发送请求<code>crossDomainSessionSecurity</code>:设置成false能够从其他域进行请求.注意这样做会在安全性上有一些危险。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Node.js使用MySQL数据库</title>
      <link href="/nodejs-use-mysql-notes.html"/>
      <url>/nodejs-use-mysql-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>感觉还不错。</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><pre><code>&lt;code class=&quot;bash&quot;&gt;npm install mysql</code></pre><h3 id="增删改查"><a href="#增删改查" class="headerlink" title="增删改查"></a>增删改查</h3><p>SQL文件：</p><pre><code>&lt;code class=&quot;sql&quot;&gt;/* Navicat MySQL Data Transfer Source Server : 127.0.0.1 Source Server Version : 50621 Source Host : localhost Source Database : RUNOOB Target Server Version : 50621 File Encoding : utf-8 Date: 05/18/2016 11:44:07 AM*/SET NAMES utf8;SET FOREIGN_KEY_CHECKS = 0;-- ------------------------------ Table structure for `websites`-- ----------------------------DROP TABLE IF EXISTS `websites`;CREATE TABLE `websites` (  `id` int(11) NOT NULL AUTO_INCREMENT,  `name` char(20) NOT NULL DEFAULT &apos;&apos; COMMENT &apos;站点名称&apos;,  `url` varchar(255) NOT NULL DEFAULT &apos;&apos;,  `alexa` int(11) NOT NULL DEFAULT &apos;0&apos; COMMENT &apos;Alexa 排名&apos;,  `country` char(10) NOT NULL DEFAULT &apos;&apos; COMMENT &apos;国家&apos;,  PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8;-- ------------------------------ Records of `websites`-- ----------------------------BEGIN;INSERT INTO `websites` VALUES (&apos;1&apos;, &apos;Google&apos;, &apos;https://www.google.cm/&apos;, &apos;1&apos;, &apos;USA&apos;), (&apos;2&apos;, &apos;淘宝&apos;, &apos;https://www.taobao.com/&apos;, &apos;13&apos;, &apos;CN&apos;), (&apos;3&apos;, &apos;菜鸟教程&apos;, &apos;http://www.runoob.com/&apos;, &apos;4689&apos;, &apos;CN&apos;), (&apos;4&apos;, &apos;微博&apos;, &apos;http://weibo.com/&apos;, &apos;20&apos;, &apos;CN&apos;), (&apos;5&apos;, &apos;Facebook&apos;, &apos;https://www.facebook.com/&apos;, &apos;3&apos;, &apos;USA&apos;);COMMIT;SET FOREIGN_KEY_CHECKS = 1;</code></pre><blockquote><p>链接数据库实例</p></blockquote><pre><code>&lt;code class=&quot;javascript&quot;&gt;/** * Created by Jaxson on 2017/4/27. */const mysql = require(&apos;mysql&apos;);const connection = mysql.createConnection({    host : &apos;localhost&apos;,    user : &apos;root&apos;,    password : &apos;&apos;,    database : &apos;node&apos;});//链接数据库connection.connect((err,data) =&gt; {    if (err) {        console.log(&quot;数据库链接失败&quot;);    }});/** * @param {Object} error 回调查询错位信息 * @param {Object} results 回调查询结果 * @param {Object} fields 回调字段信息 */connection.query(&apos;SELECT 1 + 1 AS solution&apos;, function (error, results, fields) {    if (error) throw error;    console.log(&apos;The solution is: &apos;, results[0].solution);});connection.end();</code></pre><blockquote><p>增</p></blockquote><pre><code>&lt;code class=&quot;javascript&quot;&gt;/** * Created by Jaxson on 2017/4/27. */const mysql = require(&apos;mysql&apos;);const connection = mysql.createConnection({    host : &apos;localhost&apos;,    user : &apos;root&apos;,    password : &apos;&apos;,    database : &apos;node&apos;});//链接数据库connection.connect((err,data) =&gt; {    if (err) {        console.log(&quot;数据库链接失败&quot;);    }});const addSql = &apos;INSERT INTO websites(Id,name,url,alexa,country) VALUES(0,?,?,?,?)&apos;;const addSqlParams = [&apos;淮城一只猫&apos;, &apos;https://iiong.com&apos;,&apos;100000000&apos;, &apos;CN&apos;];/** * @param {Object} error 回调查询错位信息 * @param {Object} results 回调查询结果 * @param {Object} fields 回调字段信息 */connection.query(addSql,addSqlParams,(error,results,fields) =&gt; {    if (error) {        console.error(err);    }    console.log(&apos;====================&apos;);    console.log(&apos;INSERT ID:&apos;,results);    console.log(&apos;====================&apos;);});connection.end();</code></pre><blockquote><p>改</p></blockquote><pre><code>&lt;code class=&quot;javascript&quot;&gt;/** * Created by Jaxson on 2017/4/27. */const mysql = require(&apos;mysql&apos;);const connection = mysql.createConnection({    host : &apos;localhost&apos;,    user : &apos;root&apos;,    password : &apos;&apos;,    database : &apos;node&apos;});//链接数据库connection.connect((err,data) =&gt; {    if (err) {        console.log(&quot;数据库链接失败&quot;);    }});const updateSql = &apos;UPDATE websites SET name = ?,url = ? WHERE Id = ?&apos;;const updateSqlParams = [&apos;王瑾的博客&apos;, &apos;https://boxrom.com&apos;,6];/** * @param {Object} error 回调查询错位信息 * @param {Object} results 回调查询结果 * @param {Object} fields 回调字段信息 */connection.query(updateSql,updateSqlParams,(error,results,fields) =&gt; {    if (error) {        console.error(err);    }    console.log(&apos;====================&apos;);    console.log(&apos;UPDATE affectedRows&apos;,results.affectedRows);    console.log(&apos;====================&apos;);});connection.end();</code></pre><blockquote><p>查</p></blockquote><pre><code>&lt;code class=&quot;javascript&quot;&gt;/** * Created by Jaxson on 2017/4/27. */const mysql = require(&apos;mysql&apos;);const connection = mysql.createConnection({    host : &apos;localhost&apos;,    user : &apos;root&apos;,    password : &apos;&apos;,    database : &apos;node&apos;});//链接数据库connection.connect((err,data) =&gt; {    if (err) {        console.log(&quot;数据库链接失败&quot;);    }});const sql = &apos;SELECT * FROM websites&apos;; //查询websites表中的所有数据/** * @param {Object} error 回调查询错位信息 * @param {Object} results 回调查询结果 * @param {Object} fields 回调字段信息 */connection.query(sql,(error,results,fields) =&gt; {    if (error) {        console.error(err);    }    console.log(&apos;====================&apos;);    console.log(results);    console.log(&apos;====================&apos;);});connection.end();</code></pre><blockquote><p>删</p></blockquote><pre><code>&lt;code class=&quot;javascript&quot;&gt;/** * Created by Jaxson on 2017/4/27. */const mysql = require(&apos;mysql&apos;);const connection = mysql.createConnection({    host : &apos;localhost&apos;,    user : &apos;root&apos;,    password : &apos;&apos;,    database : &apos;node&apos;});//链接数据库connection.connect((err,data) =&gt; {    if (err) {        console.log(&quot;数据库链接失败&quot;);    }});const delSql = &apos;DELETE FROM websites where id=6&apos;;/** * @param {Object} error 回调查询错位信息 * @param {Object} results 回调查询结果 * @param {Object} fields 回调字段信息 */connection.query(delSql,(error,results,fields) =&gt; {    if (error) {        console.error(err);    }    console.log(&apos;====================&apos;);    console.log(&apos;DELETE affectedRows&apos;,results.affectedRows);    console.log(&apos;====================&apos;);});connection.end();</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.JS </tag>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>安装升级npm依赖</title>
      <link href="/npm-install-upgrade-dependencies.html"/>
      <url>/npm-install-upgrade-dependencies.html</url>
      
        <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>npm-check 能够自动检索npm包版本，并且提供交互操作界面：<br>有以下功能：<br>1、告诉你那些依赖已经过时；<br>2、在你决定升级时，给你提供依赖包的文档；<br>3、提示某个依赖没有被你使用；<br>4、支持全局安装模块，-g；<br>5、交互式升级介面，减少输入和输入错误的情况，-u；</p><p>安装方法：</p><pre><code>&lt;code class=&quot;bash&quot;&gt;npm install -g npm-check</code></pre><p>使用方法：</p><h4 id="更新全局依赖"><a href="#更新全局依赖" class="headerlink" title="更新全局依赖"></a>更新全局依赖</h4><pre><code>&lt;code class=&quot;bash&quot;&gt;npm-check -gu</code></pre><h4 id="更新当前项目依赖"><a href="#更新当前项目依赖" class="headerlink" title="更新当前项目依赖"></a>更新当前项目依赖</h4><pre><code>&lt;code class=&quot;bash&quot;&gt;npm-check -u</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.JS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EMD Vol 1704</title>
      <link href="/emd-vol-1704.html"/>
      <url>/emd-vol-1704.html</url>
      
        <content type="html"><![CDATA[<h3 id="2017-04-19"><a href="#2017-04-19" class="headerlink" title="2017.04.19"></a>2017.04.19</h3><p>你好，四月；你好，春天。</p><p>这个月就这样马马虎虎的过来了。</p><h3 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h3><p>由于上家公司老板老是拖欠工资，无奈辞掉工作跳槽了。</p><p>虽说辞职了，但是至少有一个月半的工资是拿不到，主要是劳动合同没有给我，无法证明在原来的公司上过班，估计申请劳动仲裁有点小困难啊。工资这么多没要到，除了心疼还能咋办？当做买个教训吧！</p><p>辞职在家一段时间后，去了四家公司，月底很荣幸进入相对理想的公司。</p><p>目前在这家公司工作环境不错，至于做的项目压力也不大。至于宿舍就住在公司提供的宿舍，嗯，50块钱一个月的那种，和大学宿舍差不多，还是可以的。</p><h3 id="生活"><a href="#生活" class="headerlink" title="生活"></a>生活</h3><p>因为上班的生活环境换到了城南，一下子又回到那种莫名失落的心态，好似城南一直影响我的心情。具体也说不清，曾经也想过为何会有这样的情况，或许大学缘故，对我来说并不完美。</p><blockquote><p>“每个人都有不同的生活方式”。</p></blockquote><p>当然，我需要更好的心态，去面对更好的生活。</p><p>其次就是家里的事，有段时间回去，突然听到关于老爸谈个对象的事，当时真的很震惊，没想到说的好快…</p><p>然后阿姨加我微信，聊过一会儿，目前感觉还不错，已经接受这个事实了。</p><p>至于亲妈，我已经主动和解了，虽然冷战几个月，毕竟还是亲妈。出门在外这么长时间了，很怀念老妈做的饭菜，以后还能吃到几次？</p><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>春天来了，不过这阵子的天气很反常，天气热得跟夏天似的，感觉就像冬天过完直接跳入夏天。不过这几天还算是正常，气温稍微降下了点。</p><p>春天都来了，我想我的春天也差不多快了吧。</p><p>进入公司一段时间，发现越来越喜欢上某个妹纸，经过一段时间接触，感觉还不错，所以准备来个实际行动了。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>SCP命令使用</title>
      <link href="/scp-notes.html"/>
      <url>/scp-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>scp是secure copy的简写，用于在Linux下进行远程拷贝文件的命令，和它类似的命令有cp，不过cp只是在本机进行拷贝不能跨服务器，而且scp传输是加密的。当你服务器硬盘变为只读 read only system时，用scp可以帮你把文件移出来。</p><h3 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h3><pre><code>&lt;code class=&quot;bash&quot;&gt;meow:monitor Jaxson$ scp -helpscp: illegal option -- husage: scp [-12346BCpqrv] [-c cipher] [-F ssh_config] [-i identity_file]           [-l limit] [-o ssh_option] [-P port] [-S program]           [[user@]host1:]file1 ... [[user@]host2:]file2</code></pre><blockquote><p>详解</p></blockquote><h5 id="命令格式："><a href="#命令格式：" class="headerlink" title="命令格式："></a>命令格式：</h5><p><code>scp [参数] [原路径] [目标路径]</code></p><h4 id="命令参数："><a href="#命令参数：" class="headerlink" title="命令参数："></a>命令参数：</h4><pre><code>&lt;code class=&quot;bash&quot;&gt;-1 强制scp命令使用协议ssh1-2 强制scp命令使用协议ssh2-4 强制scp命令只使用IPv4寻址-6 强制scp命令只使用IPv6寻址-B 使用批处理模式（传输过程中不询问传输口令或短语）-C 允许压缩。（将-C标志传递给ssh，从而打开压缩功能）-p 留原文件的修改时间，访问时间和访问权限。-q 不显示传输进度条。-r 递归复制整个目录。-v 详细方式显示输出。scp和ssh(1)会显示出整个过程的调试信息。这些信息用于调试连接，验证和配置问题。-c cipher 以cipher将数据传输进行加密，这个选项将直接传递给ssh。-F ssh_config 指定一个替代的ssh配置文件，此参数直接传递给ssh。-i identity_file 从指定文件中读取传输时使用的密钥文件，此参数直接传递给ssh。-l limit 限定用户所能使用的带宽，以Kbit/s为单位。-o ssh_option 如果习惯于使用ssh_config(5)中的参数传递方式，-P port 注意是大写的P, port是指定数据传输用到的端口号-S program 指定加密传输时所使用的程序。此程序必须能够理解ssh(1)的选项。</code></pre><h3 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h3><h5 id="从本地服务器复制到远程服务器"><a href="#从本地服务器复制到远程服务器" class="headerlink" title="从本地服务器复制到远程服务器"></a>从本地服务器复制到远程服务器</h5><p>复制文件:</p><pre><code>&lt;code class=&quot;bash&quot;&gt;$scp local_file remote_username@remote_ip:remote_folder$scp local_file remote_username@remote_ip:remote_file$scp local_file remote_ip:remote_folder$scp local_file remote_ip:remote_file</code></pre><p><strong>指定了用户名，命令执行后需要输入用户密码；如果不指定用户名，命令执行后需要输入用户名和密码；</strong></p><p>复制目录:</p><pre><code>&lt;code class=&quot;bash&quot;&gt;$scp -r local_folder remote_username@remote_ip:remote_folder$scp -r local_folder remote_ip:remote_folder</code></pre><p>第1个指定了用户名，命令执行后需要输入用户密码； 第2个没有指定用户名，命令执行后需要输入用户名和密码；</p><blockquote><p>从远程复制到本地的scp命令与上面的命令一样，只要将从本地复制到远程的命令后面2个参数互换顺序就行了。</p></blockquote><h3 id="使用示例"><a href="#使用示例" class="headerlink" title="使用示例"></a>使用示例</h3><p>实例1：从远处复制文件到本地目录</p><pre><code>&lt;code class=&quot;bash&quot;&gt;$scp root@10.6.159.147:/opt/soft/demo.tar /opt/soft/</code></pre><p>说明： 从10.6.159.147机器上的/opt/soft/的目录中下载demo.tar 文件到本地/opt/soft/目录中</p><p>实例2：从远处复制到本地</p><pre><code>&lt;code class=&quot;bash&quot;&gt;$scp -r root@10.6.159.147:/opt/soft/test /opt/soft/</code></pre><p>说明： 从10.6.159.147机器上的/opt/soft/中下载test目录到本地的/opt/soft/目录来。</p><p>实例3：上传本地文件到远程机器指定目录</p><pre><code>&lt;code class=&quot;bash&quot;&gt;$scp /opt/soft/demo.tar root@10.6.159.147:/opt/soft/scptest</code></pre><p>说明： 复制本地opt/soft/目录下的文件demo.tar 到远程机器10.6.159.147的opt/soft/scptest目录</p><p>实例4：上传本地目录到远程机器指定目录</p><pre><code>&lt;code class=&quot;bash&quot;&gt;$scp -r /opt/soft/test root@10.6.159.147:/opt/soft/scptest</code></pre><p>说明： 上传本地目录 /opt/soft/test到远程机器10.6.159.147上/opt/soft/scptest的目录中</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Mac </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>22</title>
      <link href="/twenty-two.html"/>
      <url>/twenty-two.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>永远年轻，永远热泪盈眶！</p></blockquote><p>依然如前的春日早晨，依然如前的清明时节雨纷纷——世界对我没有不同，但今天我对世界有特别，只因我的生日。</p><p>随着年龄的增长，对自己的生日越来越淡漠了，可今天似乎不一样，突然格外关注，心里祈祷今天如平常过去，不想打乱也不敢打乱，唯一能做到的，只能悄悄腐朽自己。</p><p>今天，一年中唯一属于自己的节日，空间，博客留言，甚至邮件里都送来满满的祝福，对我来说，心里暖暖的！虽说大部分来自朋友们的祝福，但依然有点失落，不说也罢！</p><p>抚摸胸脯，仰望星空，心里默念：王瑾，祝你生日快乐！</p><p>不悲过去，不贪未来，心系当下，由此安详！</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>在前端将image转成base64编码</title>
      <link href="/image-into-encoding.html"/>
      <url>/image-into-encoding.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>业务需要，需要把图片转换成base64数据。 要实现这个功能，要使用canvas来做，Canvas里面提供了一个toDataURL的接口，可以用这个接口获得图片的base64 所以思路是：</p><ul><li>获得canvas对象</li><li>加载图片到canvas对象里面</li><li>从canvas对象中获取base64数据</li></ul><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><pre><code>&lt;html lang=&quot;zh-CN&quot;&gt;  &lt;meta charset=&quot;UTF-8&quot;&gt;  &lt;title&gt;Document&lt;/title&gt;&lt;script type=&quot;text/javascript&quot;&gt;    function getBase64Image(img) {      var canvas = document.createElement(&quot;canvas&quot;);      canvas.width = img.width;      canvas.height = img.height;      var ctx = canvas.getContext(&quot;2d&quot;);      ctx.drawImage(img, 0, 0, img.width, img.height);      var dataURL = canvas.toDataURL(&quot;image/png&quot;);      return dataURL      // return dataURL.replace(&quot;data:image/png;base64,&quot;, &quot;&quot;);    }    function main() {      var img = document.createElement(&apos;img&apos;);      img.src = &apos;./images/yeoman.png&apos;;      img.onload =function() {        var data = getBase64Image(img);        console.log(data);//控制台输出      }      document.body.appendChild(img);    }    main()  &lt;/script&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Web前端 </tag>
            
            <tag> HTML5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Android] Nova启动器 解锁完整功能版</title>
      <link href="/android-nova-launcher-pro.html"/>
      <url>/android-nova-launcher-pro.html</url>
      
        <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>Nova Launcher是一款第三方高性能，可自定义控制桌面。</p><p>Google Play地址：<a href="https://play.google.com/store/apps/details?id=com.teslacoilsw.launcher&amp;hl=zh-CN" target="_blank" rel="noopener">https://play.google.com/store/apps/details?id=com.teslacoilsw.launcher&amp;hl=zh-CN</a></p><p>The highly customizable, performance driven, home screen<br>Accept no substitutes! Nova Launcher is the top launcher for modern Android, embracing full Material Design throughout.</p><p>Nova Launcher replaces your home screen with one you control and can customize. Change icons, layouts, animations and more.</p><p>For my money, Nova Launcher is the best of the AOSP-style launchers available in Android. –Android Police<br>Nova Launcher has some very capable hands behind it –Phandroid<br>Our favorite is Nova Launcher, which strikes a great perfect balance between incredible performance and high customizability without getting too gimmicky and difficult to use –Lifehacker<br>Chock full of features you won’t find in the stock launcher, and comes highly recommended –Android Central</p><p>• Icon Themes – Find thousands of icon themes for Nova Launcher on the Play Store<br>• Subgrid positioning – Much greater control than standard launchers, Nova Launcher allows you to snap icons or widgets half way through the desktop grid cells<br>• Color controls – for labels, folders, unread badges, drawer tabs and backgrounds<br>• Customize App Drawer – Custom tabs, Vertical or Horizontal scrolling, Custom effects<br>• Improved Widget Drawer – Widgets grouped by app makes it much faster to use<br>• Infinite scroll – Never far from your favorite page, loop through the desktop or drawer continuously<br>• Backup/Restore – Sophisticated backup/restore system allowing you to backup your desktop layout and launcher settings<br>• Scrollable Dock – Create multiple docks and scroll between them<br>• Widgets in dock – Place any widget in your dock, such as a 4×1 music player widget<br>• Import Layout – No need to rebuild your desktop from scratch, Nova Launcher can import from most popular launchers. Including the one that came with your phone.<br>• Fast – Nova Launcher is highly optimized to do it’s work quickly and quietly, keeping the animations smooth and letting you use your phone as fast as you can move your fingers.</p><p>Nova Launcher Prime<br>Unlock the following extras by purchasing Nova Launcher Prime<br>• Gestures – Swipe, pinch, double tap and more on the home screen to open your favorite apps<br>• Unread Counts – Never miss a message. Unread count badges for Hangouts, SMS, Gmail and more using the TeslaUnread plugin<br>• Custom Drawer Groups – Create new tabs or folders in the app drawer<br>• Hide Apps – Keep a clean app drawer by hiding never used apps<br>• Icon Swipes – Set custom actions for swiping on app shortcuts or folders<br>• More scroll effects – Such as Wipe, Accordion, and Throw</p><h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>解锁限制功能，未增删相关功能。</p><h3 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h3><blockquote><p>最新版 Version 5.1 beta 5</p></blockquote><p>百度网盘： <a href="http://pan.baidu.com/s/1c2ekCgS" target="_blank" rel="noopener">点击下载</a></p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Android] 绿色守护 修正专业版</title>
      <link href="/android-greenify-pro.html"/>
      <url>/android-greenify-pro.html</url>
      
        <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>再也不用嫉妒朋友的iPhone手机，即使安装大量应用，也不会变得迟缓和耗电。有了『绿色守护』，你的Android设备也能永葆第一天拥有它时的爽滑持久！</p><p>『知乎』上用户认同度最高的Android省电软件：<a href="http://www.zhihu.com/question/21007772" target="_blank" rel="noopener">http://www.zhihu.com/question/21007772</a></p><p>『绿色守护』帮助你甄别那些对系统全局性能和耗电量有不良影响的应用程序，并通过独特的『绿色化』技术，阻止它们消耗您的电池电量，占用您的宝贵内存。经过『绿色化』工艺处理的应用，在您没有主动启动它们的时候，无法『偷偷』运行，而在您正常启动它们时仍然拥有完整的功能和体验，正如iPhone应用那样！</p><p>重要说明：『绿色化』一个应用，意味着您确确实实希望这个应用在不启动的时候休眠，也就是说它的所有后台功能在休眠期间都不再工作。这些后台功能（机制）包括但不限于：</p><ul><li>后台服务</li><li>广播接收器。它们响应设备所发生的全局性事件，例如网络连接状态变化、电源改变、短信监听等。</li><li>定时器。它们在特定的时间或以一定的时间间隔运行。</li><li>小工具更新。小工具可以正常显示，但在休眠期间不会有任何更新变化，因为更新小工具需要让应用以后台方式运行。</li><li>推送消息。应用的实时消息推送也将失效，因为Android下的推送消息将会在后台激活应用，而不是像iOS那样只显示消息给用户。（注：捐赠版中的一项试验性特性可让GCM推送唤醒绿色化的应用）</li></ul><p>请勿『绿色化』闹钟、即时通讯、启动器类的应用，除非你不常使用它们，也不再依赖其后台功能（比如定时任务、消息推送等）。请务必确认经过『绿色化』处理的应用没有丧失任何您认为重要的后台机制。</p><p>作为一个最低要求，『绿色守护』自己须启动一个后台『清洁工』服务，才能在您使用过绿色化的应用后将其重新置于休眠状态。这个后台服务在设计和实现都以『超轻量化』为首要目标，它的平均内存消耗仅有5M左右，CPU及电量消耗近乎为零，完全可以放心的忽略它的存在。</p><h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>开启捐赠版支持，无需解锁器</p><p>此版本没有精简语言包，会丢失字符串，故没有精简语言包！</p><h3 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h3><blockquote><p>最新版 Version 3.2.2.b.357</p></blockquote><h4 id="五月之前不再更新，作者开发捐赠版功能"><a href="#五月之前不再更新，作者开发捐赠版功能" class="headerlink" title="五月之前不再更新，作者开发捐赠版功能"></a>五月之前不再更新，作者开发捐赠版功能</h4><p>百度网盘： <a href="http://pan.baidu.com/s/1c1JlV9I" target="_blank" rel="noopener">点击下载</a></p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Android] SD女佣 英简繁 精简优化 专业版</title>
      <link href="/sd-maid-pro.html"/>
      <url>/sd-maid-pro.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>好久没折腾Android的作品了，今天在家闲得无聊折腾了下。</p><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>SD Maid 将帮助您保持设备的干净整洁！<br>它提供了一个管理应用程序和文件的工具集。</p><p>没有完美的人，同样没有完美的 Android。<br>应用程序被卸载后，有时会留下不需要的数据。<br>系统经常会生成您并不需要的日志、崩溃报告以及调试文件。<br>无用的文件、不明所以的目录，无时无刻不在占用您的存储空间。<br>但是这就到此为止了…… 让 SD Maid 来帮你！</p><p>SD Maids 工具包括:<br>– 资源管理器: 一个正式的文件管理器。<br>– 搜索工具箱: 通过名称或内容帮助您查找文件。<br>– 应用控制器: 允许您管理安装的用户和系统应用程序。<br>– 冗余搜寻器: 删除已卸载的应用程序的数据。<br>– 系统清理器: 删除已知不需要的文件。 您可以通过选择不同的筛选器或创建您自己筛选器来调整结果。<br>– 占用分析器: 概述您的存储正在使用的情况。<br>– 数据库: 优化了数据库大小和性能。<br>– 上次更改时间: 可以告诉您哪些文件在选择的时间期内被改动过。</p><p><strong>SD Maid 是非常强大的工具；使用它需要您自行承担风险。</strong></p><h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>破解开启专业版支持，所以无需解锁器支持；</p><p>另外精简其它国家语言支持，仅保留英简繁语言支持。</p><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><blockquote><p>最新版 Version 4.6.5</p></blockquote><p>长期更新</p><p>百度网盘：<a href="http://pan.baidu.com/s/1dE3AOIP" target="_blank" rel="noopener">点击下载</a></p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端面试</title>
      <link href="/front-end-face-1.html"/>
      <url>/front-end-face-1.html</url>
      
        <content type="html"><![CDATA[<p><strong>前端开发知识点：</strong></p><pre><code>&lt;code class=&quot;html&quot;&gt;HTML&amp;CSS：对Web标准的理解、浏览器内核差异、兼容性、hack、CSS基本功：布局、盒子模型、选择器优先级、HTML5、CSS3、FlexboxJavaScript：    数据类型、运算、对象、Function、继承、闭包、作用域、原型链、事件、RegExp、JSON、Ajax、    DOM、BOM、内存泄漏、跨域、异步装载、模板引擎、前端MVC、路由、模块化、Canvas、ECMAScript Nodejs其他：    移动端、响应式、自动化构建、HTTP、离线存储、WEB安全、优化、重构、团队协作、可维护、易用性、SEO、UED、架构、职业生涯、快速学习能力</code></pre><p>作为一名前端工程师，<strong>无论工作年头长短都应该掌握的知识点</strong>：</p><pre><code>&lt;code class=&quot;html&quot;&gt;1、DOM结构 —— 两个节点之间可能存在哪些关系以及如何在节点之间任意移动。2、DOM操作 —— 如何添加、移除、移动、复制、创建和查找节点等。3、事件 —— 如何使用事件，以及IE和标准DOM事件模型之间存在的差别。4、XMLHttpRequest —— 这是什么、怎样完整地执行一次GET请求、怎样检测错误。5、严格模式与混杂模式 —— 如何触发这两种模式，区分它们有何意义。6、盒模型 —— 外边距、内边距和边框之间的关系，及IE8以下版本的浏览器中的盒模型7、块级元素与行内元素 —— 怎么用CSS控制它们、以及如何合理的使用它们8、浮动元素 —— 怎么使用它们、它们有什么问题以及怎么解决这些问题。9、HTML与XHTML —— 二者有什么区别，你觉得应该使用哪一个并说出理由。10、JSON —— 作用、用途、设计结构。</code></pre><h3 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h3><ul><li><p>Doctype作用？标准模式与兼容模式各有什么区别?</p><p><code class="html">（1）、&lt;!DOCTYPE&gt;声明位于位于HTML文档中的第一行，处于  标签之前。告知浏览器的解析器用什么文档标准解析这个文档。DOCTYPE不存在或格式不正确会导致文档以兼容模式呈现。</code></p><p>（2）、标准模式的排版 和JS运作模式都是以该浏览器支持的最高标准运行。在兼容模式中，页面以宽松的向后兼容的方式显示,模拟老式浏览器的行为以防止站点无法工作。</p></li></ul><ul><li><p>HTML5 为什么只需要写 ？</p><p><code class="html">HTML5 不基于 SGML，因此不需要对DTD进行引用，但是需要doctype来规范浏览器的行为（让浏览器按照它们应该的方式来运行）；</code></p><p>而HTML4.01基于SGML,所以需要对DTD进行引用，才能告知浏览器文档所使用的文档类型。</p></li></ul><ul><li><p>行内元素有哪些？块级元素有哪些？ 空(void)元素有那些？</p><p><code class="html">首先：CSS规范规定，每个元素都有display属性，确定该元素的类型，每个元素都有默认的display值，如div的display默认值为“block”，则为“块级”元素；span默认display属性值为“inline”，是“行内”元素。<br>（1）行内元素有：a b span img input select strong（强调的语气）<br>（2）块级元素有：div ul ol li dl dt dd h1 h2 h3 h4…p<br>（3）常见的空元素：<br><br> <hr> <img> <input> <link> <meta><br>鲜为人知的是：<br><area> <base> <col> <command> <embed> <keygen> <param> <source> <track> <wbr><br>不同浏览器（版本）、HTML4（5）、CSS2等实际略有差异<br>参考: <a href="http://stackoverflow.com/questions/6867254/browsers-default-css-for-html-elements" target="_blank" rel="noopener">http://stackoverflow.com/questions/6867254/browsers-default-css-for-html-elements</a></code></p></li></ul><ul><li><p>页面导入样式时，使用link和@import有什么区别？</p><p><code class="html">（1）link属于XHTML标签，除了加载CSS外，还能用于定义RSS, 定义rel连接属性等作用；而@import是CSS提供的，只能用于加载CSS;<br>（2）页面被加载的时，link会同时被加载，而@import引用的CSS会等到页面被加载完再加载;<br>（3）import是CSS2.1 提出的，只在IE5以上才能被识别，而link是XHTML标签，无兼容问题;</code></p></li></ul><ul><li><p>介绍一下你对浏览器内核的理解？</p><p><code class="html">主要分成两部分：渲染引擎(layout engineer或Rendering Engine)和JS引擎。<br>渲染引擎：负责取得网页的内容（HTML、XML、图像等等）、整理讯息（例如加入CSS等），以及计算网页的显示方式，然后会输出至显示器或打印机。浏览器的内核的不同对于网页的语法解释会有不同，所以渲染的效果也不相同。所有网页浏览器、电子邮件客户端以及其它需要编辑、显示网络内容的应用程序都需要内核。<br>JS引擎则：解析和执行javascript来实现网页的动态效果。<br>最开始渲染引擎和JS引擎并没有区分的很明确，后来JS引擎越来越独立，内核就倾向于只指渲染引擎。</code></p></li></ul><ul><li><p>常见的浏览器内核有哪些？</p><p><code class="html">Trident内核：IE,MaxThon,TT,The World,360,搜狗浏览器等。[又称MSHTML]<br>Gecko内核：Netscape6及以上版本，FF,MozillaSuite/SeaMonkey等<br>Presto内核：Opera7及以上。      [Opera内核原为：Presto，现为：Blink;]<br>Webkit内核：Safari,Chrome等。   [ Chrome的：Blink（WebKit的分支）]</code></p></li></ul><ul><li><p>html5有哪些新特性、移除了那些元素？如何处理HTML5新标签的浏览器兼容问题？如何区分 HTML 和 HTML5？</p><p><code class="html">* HTML5 现在已经不是 SGML 的子集，主要是关于图像，位置，存储，多任务等功能的增加。</code></p><pre><code>绘画 canvas;用于媒介回放的 video 和 audio 元素;本地离线存储 localStorage 长期存储数据，浏览器关闭后数据不丢失;sessionStorage 的数据在浏览器关闭后自动删除;语意化更好的内容元素，比如 article、footer、header、nav、section;表单控件，calendar、date、time、email、url、search;新的技术webworker, websocket, Geolocation;</code></pre><p>   移除的元素：</p><pre><code>纯表现的元素：basefont，big，center，font, s，strike，tt，u;对可用性产生负面影响的元素：frame，frameset，noframes；</code></pre><ul><li><p>支持HTML5新标签：</p><pre><code>IE8/IE7/IE6支持通过document.createElement方法产生的标签，可以利用这一特性让这些浏览器支持HTML5新标签，浏览器支持新标签后，还需要添加标签默认的样式。当然也可以直接使用成熟的框架、比如html5shim;&lt;!--[if lt IE 9]&gt;   &lt;script&gt; src=&quot;http://html5shim.googlecode.com/svn/trunk/html5.js&quot;&lt;/script&gt;&lt;![endif]--&gt;</code></pre><ul><li>如何区分HTML5： DOCTYPE声明\新增的结构元素\功能元素</li></ul></li></ul></li></ul><ul><li><p>简述一下你对HTML语义化的理解？</p><p><code class="html">用正确的标签做正确的事情。<br>html语义化让页面的内容结构化，结构更清晰，便于对浏览器、搜索引擎解析;<br>即使在没有样式CSS情况下也以一种文档格式显示，并且是容易阅读的;<br>搜索引擎的爬虫也依赖于HTML标记来确定上下文和各个关键字的权重，利于SEO;<br>使阅读源代码的人对网站更容易将网站分块，便于阅读维护理解。</code></p></li></ul><ul><li><p>HTML5的离线储存怎么使用，工作原理能不能解释一下？</p><p><code class="html">在用户没有与因特网连接时，可以正常访问站点或应用，在用户与因特网连接时，更新用户机器上的缓存文件。<br>原理：HTML5的离线存储是基于一个新建的.appcache文件的缓存机制(不是存储技术)，通过这个文件上的解析清单离线存储资源，这些资源就会像cookie一样被存储了下来。之后当网络在处于离线状态下时，浏览器会通过被离线存储的数据进行页面展示。</code></p><p>如何使用：<br>1、页面头部像下面一样加入一个manifest的属性；<br>2、在cache.manifest文件的编写离线存储的资源；</p><pre><code>CACHE MANIFEST#v0.11CACHE:js/app.jscss/style.cssNETWORK:resourse/logo.pngFALLBACK:/ /offline.html</code></pre><p>3、在离线状态时，操作window.applicationCache进行需求实现。</p></li></ul><ul><li><p>浏览器是怎么对HTML5的离线储存资源进行管理和加载的呢？</p><p><code class="html">在线的情况下，浏览器发现html头部有manifest属性，它会请求manifest文件，如果是第一次访问app，那么浏览器就会根据manifest文件的内容下载相应的资源并且进行离线存储。如果已经访问过app并且资源已经离线存储了，那么浏览器就会使用离线的资源加载页面，然后浏览器会对比新的manifest文件与旧的manifest文件，如果文件没有发生改变，就不做任何操作，如果文件改变了，那么就会重新下载文件中的资源并进行离线存储。<br>离线的情况下，浏览器就直接使用离线存储的资源。</code></p></li></ul><ul><li><p>请描述一下 cookies，sessionStorage 和 localStorage 的区别？</p><p><code class="html">cookie是网站为了标示用户身份而储存在用户本地终端（Client Side）上的数据（通常经过加密）。<br>cookie数据始终在同源的http请求中携带（即使不需要），记会在浏览器和服务器间来回传递。<br>sessionStorage和localStorage不会自动把数据发给服务器，仅在本地保存。</code></p><p>存储大小：<br>cookie数据大小不能超过4k。<br>sessionStorage和localStorage 虽然也有存储大小的限制，但比cookie大得多，可以达到5M或更大。</p><p>有期时间：<br>localStorage    存储持久数据，浏览器关闭后数据不丢失除非主动删除数据；<br>sessionStorage  数据在当前浏览器窗口关闭后自动删除。<br>cookie          设置的cookie过期时间之前一直有效，即使窗口或浏览器关闭</p></li></ul><ul><li><p>iframe有那些缺点？</p><p><code class="html"><em>iframe会阻塞主页面的Onload事件；</em>搜索引擎的检索程序无法解读这种页面，不利于SEO;</code></p><p>*iframe和主页面共享连接池，而浏览器对相同域的连接有限制，所以会影响页面的并行加载。</p><p>使用iframe之前需要考虑这两个缺点。如果需要使用iframe，最好是通过javascript<br>动态给iframe添加src属性值，这样可以绕开以上两个问题。</p></li></ul><ul><li><p>Label的作用是什么？是怎么用的？</p><p><code class="html">label标签来定义表单控制间的关系,当用户选择该标签时，浏览器会自动将焦点转到和标签相关的表单控件上。</code></p><label for="Name">Number:</label><br><input type="“text“name="Name"" id="Name"><br><br><label>Date:<input type="text" name="B"></label></li></ul><ul><li><p>HTML5的form如何关闭自动完成功能？</p><p><code class="html">给不想要提示的 form 或某个 input 设置为 autocomplete=off。</code></p></li></ul><ul><li><p>如何实现浏览器内多个标签页之间的通信? (阿里)</p><p><code class="html">WebSocket、SharedWorker；<br>也可以调用localstorge、cookies等本地存储方式；</code></p><p>localstorge另一个浏览上下文里被添加、修改或删除时，它都会触发一个事件，<br>我们通过监听事件，控制它的值来进行页面信息通信；<br>注意quirks：Safari 在无痕模式下设置localstorge值时会抛出 QuotaExceededError 的异常；</p></li></ul><ul><li><p>webSocket如何兼容低浏览器？(阿里)</p><p><code class="html">Adobe Flash Socket 、<br>ActiveX HTMLFile (IE) 、<br>基于 multipart 编码发送 XHR 、<br>基于长轮询的 XHR</code></p></li></ul><ul><li><p>页面可见性（Page Visibility API） 可以有哪些用途？</p><p><code class="html">通过 visibilityState 的值检测页面当前是否可见，以及打开网页的时间等;<br>在页面被切换到其他后台进程的时候，自动暂停音乐或视频的播放；</code></p></li></ul><ul><li><p>如何在页面上实现一个圆形的可点击区域？</p><p><code class="html">1、map+area或者svg<br>2、border-radius<br>3、纯js实现 需要求一个点在不在圆上简单算法、获取鼠标坐标等等</code></p></li></ul><ul><li><p>实现不使用 border 画出1px高的线，在不同浏览器的标准模式与怪异模式下都能保持一致的效果。</p><p><code class="html"><div style="height:1px;overflow:hidden;background:red"></div></code></p></li></ul><ul><li><p>网页验证码是干嘛的，是为了解决什么安全问题。</p><p><code class="html">区分用户是计算机还是人的公共全自动程序。可以防止恶意破解密码、刷票、论坛灌水；<br>有效防止黑客对某一个特定注册用户用特定程序暴力破解方式进行不断的登陆尝试。</code></p></li></ul><ul><li><p>title与h1的区别、b与strong的区别、i与em的区别？</p><p><code class="html">title属性没有明确意义只表示是个标题，H1则表示层次明确的标题，对页面信息的抓取也有很大的影响；</code></p><p>strong是标明重点内容，有语气加强的含义，使用阅读设备阅读网络时：<strong>会重读，而<b>是展示强调内容。</b></strong></p><p>i内容展示为斜体，em表示强调的文本；</p><p>Physical Style Elements – 自然样式标签<br>b, i, u, s, pre<br>Semantic Style Elements – 语义样式标签<br>strong, em, ins, del, code<br>应该准确使用语义样式标签, 但不能滥用, 如果不能确定时首选使用自然样式标签。</p></li></ul><h3 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h3><ul><li><p>介绍一下标准的CSS的盒子模型？低版本IE的盒子模型有什么不同的？</p><p><code class="css">（1）有两种， IE 盒子模型、W3C 盒子模型；<br>（2）盒模型： 内容(content)、填充(padding)、边界(margin)、 边框(border)；<br>（3）区  别： IE的content部分把 border 和 padding计算了进去;</code></p></li></ul><ul><li><p>CSS选择符有哪些？哪些属性可以继承？</p><p><code class="css">*   1.id选择器（ # myid）</code></p><pre><code>2.类选择器（.myclassname）3.标签选择器（div, h1, p）4.相邻选择器（h1 + p）5.子选择器（ul &gt; li）6.后代选择器（li a）7.通配符选择器（ * ）8.属性选择器（a[rel = &quot;external&quot;]）9.伪类选择器（a:hover, li:nth-child）</code></pre><ul><li><p>可继承的样式： font-size font-family color, UL LI DL DD DT;</p></li><li><p>不可继承的样式：border padding margin width height ;</p></li></ul></li></ul><ul><li><p>CSS优先级算法如何计算？</p><p><code class="css">*   优先级就近原则，同权重情况下样式定义最近者为准;</code></p><ul><li>载入样式以最后载入的定位为准;</li></ul><p>优先级为:</p><pre><code>同权重: 内联样式表（标签内部）&gt; 嵌入样式表（当前文件中）&gt; 外部样式表（外部文件中）。!important &gt;  id &gt; class &gt; tagimportant 比 内联优先级高</code></pre></li></ul><ul><li><p>CSS3新增伪类有那些？</p><p><code class="css">举例：<br>p:first-of-type    选择属于其父元素的首个 <p> 元素的每个 </p><p> 元素。<br>p:last-of-type    选择属于其父元素的最后 </p><p> 元素的每个 </p><p> 元素。<br>p:only-of-type    选择属于其父元素唯一的 </p><p> 元素的每个 </p><p> 元素。<br>p:only-child        选择属于其父元素的唯一子元素的每个 </p><p> 元素。<br>p:nth-child(2)    选择属于其父元素的第二个子元素的每个 </p><p> 元素。</p><p>:after            在元素之前添加内容,也可以用来做清除浮动。<br>:before            在元素之后添加内容<br>:enabled<br>:disabled         控制表单控件的禁用状态。<br>:checked        单选框或复选框被选中。</p></code></p></li></ul><ul><li><p>如何居中div？ - 水平居中：给div设置一个宽度，然后添加margin:0 auto属性 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    `div&#123;  </span><br><span class="line">    width:200px;  </span><br><span class="line">    margin:0 auto;  </span><br><span class="line">    &#125;`</span><br><span class="line"></span><br><span class="line">```````````````````````````````</span><br></pre></td></tr></table></figure></p><ul><li>让绝对定位的div居中 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">    &lt;code class=&quot;css&quot;&gt;div &#123;</span><br><span class="line">        position: absolute;</span><br><span class="line">        width: 300px;</span><br><span class="line">        height: 300px;</span><br><span class="line">        margin: auto;</span><br><span class="line">        top: 0;</span><br><span class="line">        left: 0;</span><br><span class="line">        bottom: 0;</span><br><span class="line">        right: 0;</span><br><span class="line">        background-color: pink;    /* 方便看效果 */</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   水平垂直居中一 ```  </span><br><span class="line">    `确定容器的宽高 宽500 高 300 的层  </span><br><span class="line">    设置层的外边距`</span><br><span class="line"></span><br><span class="line">``````````````````````````````</span><br></pre></td></tr></table></figure></li></ul></li></ul><p>div {<br>position: relative; /<em> 相对定位或绝对定位均可 <em>/<br>width:500px;<br>height:300px;<br>top: 50%;<br>left: 50%;<br>margin: -150px 0 0 -250px; /</em> 外边距为自身宽高的一半 <em>/<br>background-color: pink; /</em> 方便看效果 </em>/<br>}</p><pre><code>- 水平垂直居中二 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">    &lt;code class=&quot;css&quot;&gt;未知容器的宽高，利用 `transform` 属性</span><br><span class="line">    </span><br><span class="line">    div &#123;</span><br><span class="line">        position: absolute;        /* 相对定位或绝对定位均可 */</span><br><span class="line">        width:500px;</span><br><span class="line">        height:300px;</span><br><span class="line">        top: 50%;</span><br><span class="line">        left: 50%;</span><br><span class="line">        transform: translate(-50%, -50%);</span><br><span class="line">        background-color: pink;         /* 方便看效果 */</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   水平垂直居中三 ```  </span><br><span class="line">    `利用 flex 布局  </span><br><span class="line">    实际使用时应考虑兼容性`</span><br><span class="line"></span><br><span class="line">`````````````````````````````</span><br></pre></td></tr></table></figure></code></pre><p>.container {<br>display: flex;<br>align-items: center; /<em> 垂直居中 <em>/<br>justify-content: center; /</em> 水平居中 <em>/<br>}<br>.container div {<br>width: 100px;<br>height: 100px;<br>background-color: pink; /</em> 方便看效果 </em>/<br>}</p><pre><code>- display有哪些值？说明他们的作用。</code></pre><p><code>block 块类型。默认宽度为父元素宽度，可设置宽高，换行显示。  none 缺省值。象行内元素类型一样显示。  inline 行内元素类型。默认宽度为内容宽度，不可设置宽高，同行显示。  inline-block 默认宽度为内容宽度，可以设置宽高，同行显示。  list-item 象块类型元素一样显示，并添加样式列表标记。  table 此元素会作为块级表格来显示。  inherit 规定应该从父元素继承 display 属性的值。</code></p> <figure class="highlight plain"><figcaption><span>position的值relative和absolute定位原点是？</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`absolute  </span><br><span class="line">生成绝对定位的元素，相对于值不为 static的第一个父元素进行定位。  </span><br><span class="line">fixed （老IE不支持）  </span><br><span class="line">生成绝对定位的元素，相对于浏览器窗口进行定位。  </span><br><span class="line">relative  </span><br><span class="line">生成相对定位的元素，相对于其正常位置进行定位。  </span><br><span class="line">static  </span><br><span class="line">默认值。没有定位，元素出现在正常的流中（忽略 top, bottom, left, right z-index 声明）。  </span><br><span class="line">inherit  </span><br><span class="line">规定从父元素继承 position 属性的值。`</span><br><span class="line"></span><br><span class="line"> ``````````````````````````````- CSS3有哪些新特性？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`新增各种CSS选择器 （: not(.input)：所有 class 不是“input”的节点）  </span><br><span class="line">圆角 （border-radius:8px）  </span><br><span class="line">多列布局 （multi-column layout）  </span><br><span class="line">阴影和反射 （Shadow\Reflect）  </span><br><span class="line">文字特效 （text-shadow、）  </span><br><span class="line">文字渲染 （Text-decoration）  </span><br><span class="line">线性渐变 （gradient）  </span><br><span class="line">旋转 （transform）  </span><br><span class="line">缩放,定位,倾斜,动画,多背景  </span><br><span class="line">例如:transform:\scale(0.85,0.90)\ translate(0px,-30px)\ skew(-9deg,0deg)\Animation:`</span><br><span class="line"></span><br><span class="line"> `````````````````````````````- 请解释一下CSS3的Flexbox（弹性盒布局模型）,以及适用场景？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`一个用于页面布局的全新CSS3功能，Flexbox可以把列表放在同一个方向（从上到下排列，从左到右），并让列表能延伸到占用可用的空间。  </span><br><span class="line">较为复杂的布局还可以通过嵌套一个伸缩容器（flex container）来实现。  </span><br><span class="line">采用Flex布局的元素，称为Flex容器（flex container），简称&quot;容器&quot;。  </span><br><span class="line">它的所有子元素自动成为容器成员，称为Flex项目（flex item），简称&quot;项目&quot;。  </span><br><span class="line">常规布局是基于块和内联流方向，而Flex布局是基于flex-flow流可以很方便的用来做局中，能对不同屏幕大小自适应。  </span><br><span class="line">在布局上有了比以前更加灵活的空间。`</span><br><span class="line"></span><br><span class="line">````````````````````````````</span><br><span class="line"></span><br><span class="line">具体：[http://www.w3cplus.com/css3/flexbox-basics.html](http://www.w3cplus.com/css3/flexbox-basics.html)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    - 用纯CSS创建一个三角形的原理是什么？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`把上、左、右三条边隐藏掉（颜色设为 transparent）`</span><br><span class="line"></span><br><span class="line">```````````````````````````</span><br><span class="line"></span><br><span class="line">demo &#123;</span><br><span class="line">======</span><br><span class="line"></span><br><span class="line">    width: 0;</span><br><span class="line">    height: 0;</span><br><span class="line">    border-width: 20px;</span><br><span class="line">    border-style: solid;</span><br><span class="line">    border-color: transparent transparent red transparent;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    - 一个满屏 品 字布局 如何设计?</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`简单的方式：  </span><br><span class="line">上面的div宽100%，  </span><br><span class="line">下面的两个div分别宽50%，  </span><br><span class="line">然后用float或者inline使其不换行即可`</span><br><span class="line"></span><br><span class="line"> ``````````````````````````- css多列等高如何实现？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`利用padding-bottom|margin-bottom正负值相抵；  </span><br><span class="line">设置父容器设置超出隐藏（overflow:hidden），这样子父容器的高度就还是它里面的列没有设定padding-bottom时的高度，  </span><br><span class="line">当它里面的任 一列高度增加了，则父容器的高度被撑到里面最高那列的高度，  </span><br><span class="line">其他比这列矮的列会用它们的padding-bottom补偿这部分高度差。`</span><br><span class="line"></span><br><span class="line"> `````````````````````````- 经常遇到的浏览器的兼容性有哪些？原因，解决方法是什么，常用hack的技巧 ？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`* png24位的图片在iE6浏览器上出现背景，解决方案是做成PNG8.`</span><br><span class="line"></span><br><span class="line">````````````````````````</span><br><span class="line"></span><br><span class="line">*   浏览器默认的margin和padding不同。解决方案是加一个全局的*&#123;margin:0;padding:0;&#125;来统一。</span><br><span class="line">    </span><br><span class="line">*   IE6双边距bug:块属性标签float后，又有横行的margin情况下，在ie6显示margin比设置的大。</span><br><span class="line">    </span><br><span class="line">    浮动ie产生的双倍距离 #box&#123; float:left; width:10px; margin:0 0 0 100px;&#125;</span><br><span class="line">    </span><br><span class="line">    这种情况之下IE会产生20px的距离，解决方案是在float的标签样式控制中加入 ——_display:inline;将其转化为行内属性。(_这个符号只有ie6会识别)</span><br><span class="line">    </span><br><span class="line">    渐进识别的方式，从总体中逐渐排除局部。</span><br><span class="line">    </span><br><span class="line">    首先，巧妙的使用“\9”这一标记，将IE游览器从所有情况中分离出来。  </span><br><span class="line">    接着，再次使用“+”将IE8和IE7、IE6分离开来，这样IE8已经独立识别。</span><br><span class="line">    </span><br><span class="line">    css  </span><br><span class="line">    .bb&#123;  </span><br><span class="line">    background-color:red;/_所有识别_/  </span><br><span class="line">    background-color:#00deff\9; /_IE6、7、8识别_/  </span><br><span class="line">    +background-color:#a200ff;/_IE6、7识别_/  </span><br><span class="line">    _background-color:#1e0bd1;/_IE6识别_/  </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">*   IE下,可以使用获取常规属性的方法来获取自定义属性,  </span><br><span class="line">    也可以使用getAttribute()获取自定义属性;  </span><br><span class="line">    Firefox下,只能使用getAttribute()获取自定义属性。  </span><br><span class="line">    解决方法:统一通过getAttribute()获取自定义属性。</span><br><span class="line">    </span><br><span class="line">*   IE下,even对象有x,y属性,但是没有pageX,pageY属性;  </span><br><span class="line">    Firefox下,event对象有pageX,pageY属性,但是没有x,y属性。</span><br><span class="line">    </span><br><span class="line">*   解决方法：（条件注释）缺点是在IE浏览器下可能会增加额外的HTTP请求数。</span><br><span class="line">    </span><br><span class="line">*   Chrome 中文界面下默认会将小于 12px 的文本强制按照 12px 显示,  </span><br><span class="line">    可通过加入 CSS 属性 -webkit-text-size-adjust: none; 解决。</span><br><span class="line">    </span><br><span class="line">    超链接访问过后hover样式就不出现了 被点击访问过的超链接样式不在具有hover和active了解决方法是改变CSS属性的排列顺序:  </span><br><span class="line">    L-V-H-A : a:link &#123;&#125; a:visited &#123;&#125; a:hover &#123;&#125; a:active &#123;&#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    - li与li之间有看不见的空白间隔是什么原因引起的？有什么解决办法？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`行框的排列会受到中间空白（回车\空格）等的影响，因为空格也属于字符,这些空白也会被应用样式，占据空间，所以会有间隔，把字符大小设为0，就没有空格了。`</span><br><span class="line"></span><br><span class="line"> ```````````````````````- 为什么要初始化CSS样式。</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`- 因为浏览器的兼容问题，不同浏览器对有些标签的默认值是不同的，如果没对CSS初始化往往会出现浏览器之间的页面显示差异。`</span><br><span class="line"></span><br><span class="line">``````````````````````</span><br><span class="line"></span><br><span class="line">*   当然，初始化样式会对SEO有一定的影响，但鱼和熊掌不可兼得，但力求影响最小的情况下初始化。</span><br><span class="line">    </span><br><span class="line">    最简单的初始化方法： * &#123;padding: 0; margin: 0;&#125; （强烈不建议）</span><br><span class="line">    </span><br><span class="line">    淘宝的样式初始化代码：  </span><br><span class="line">    body, h1, h2, h3, h4, h5, h6, hr, p, blockquote, dl, dt, dd, ul, ol, li, pre, form, fieldset, legend, button, input, textarea, th, td &#123; margin:0; padding:0; &#125;  </span><br><span class="line">    body, button, input, select, textarea &#123; font:12px/1.5tahoma, arial, \5b8b\4f53; &#125;  </span><br><span class="line">    h1, h2, h3, h4, h5, h6&#123; font-size:100%; &#125;  </span><br><span class="line">    address, cite, dfn, em, var &#123; font-style:normal; &#125;  </span><br><span class="line">    code, kbd, pre, samp &#123; font-family:couriernew, courier, monospace; &#125;  </span><br><span class="line">    small&#123; font-size:12px; &#125;  </span><br><span class="line">    ul, ol &#123; list-style:none; &#125;  </span><br><span class="line">    a &#123; text-decoration:none; &#125;  </span><br><span class="line">    a:hover &#123; text-decoration:underline; &#125;  </span><br><span class="line">    sup &#123; vertical-align:text-top; &#125;  </span><br><span class="line">    sub&#123; vertical-align:text-bottom; &#125;  </span><br><span class="line">    legend &#123; color:#000; &#125;  </span><br><span class="line">    fieldset, img &#123; border:0; &#125;  </span><br><span class="line">    button, input, select, textarea &#123; font-size:100%; &#125;  </span><br><span class="line">    table &#123; border-collapse:collapse; border-spacing:0; &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    - absolute的containing block(容器块)计算方式跟正常流有什么不同？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`无论属于哪种，都要先找到其祖先元素中最近的 position 值不为 static 的元素，然后再判断：  </span><br><span class="line">1、若此元素为 inline 元素，则 containing block 为能够包含这个元素生成的第一个和最后一个 inline box 的 padding box (除 margin, border 外的区域) 的最小矩形；  </span><br><span class="line">2、否则,则由这个祖先元素的 padding box 构成。  </span><br><span class="line">如果都找不到，则为 initial containing block。`</span><br><span class="line"></span><br><span class="line">`````````````````````</span><br><span class="line"></span><br><span class="line">    补充：</span><br><span class="line">    1. static(默认的)/relative：简单说就是它的父元素的内容框（即去掉padding的部分）</span><br><span class="line">    2. absolute: 向上找最近的定位为absolute/relative的元素</span><br><span class="line">    3. fixed: 它的containing block一律为根元素(html/body)，根元素也是initial containing block</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    - CSS里的visibility属性有个collapse属性值是干嘛用的？在不同浏览器下以后什么区别？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`对于普通元素visibility:collapse;会将元素完全隐藏,不占据页面布局空间,与display:none;表现相同. 如果目标元素为table,visibility:collapse;将table隐藏,但是会占据页面布局空间. 仅在Firefox下起作用,IE会显示元素,Chrome会将元素隐藏,但是占据空间.`</span><br><span class="line"></span><br><span class="line"> ````````````````````- position跟display、margin collapse、overflow、float这些特性相互叠加后会怎么样？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`如果元素的display为none,那么元素不被渲染,position,float不起作用,如果元素拥有position:absolute;或者position:fixed;属性那么元素将为绝对定位,float不起作用.如果元素float属性不是none,元素会脱离文档流,根据float属性值来显示.有浮动,绝对定位,inline-block属性的元素,margin不会和垂直方向上的其他元素margin折叠.`</span><br><span class="line"></span><br><span class="line"> ```````````````````- 对BFC规范(块级格式化上下文：block formatting context)的理解？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`（W3C CSS 2.1 规范中的一个概念,它是一个独立容器，决定了元素如何对其内容进行定位,以及与其他元素的关系和相互作用。）  </span><br><span class="line">一个页面是由很多个 Box 组成的,元素的类型和 display 属性,决定了这个 Box 的类型。  </span><br><span class="line">不同类型的 Box,会参与不同的 Formatting Context（决定如何渲染文档的容器）,因此Box内的元素会以不同的方式渲染,也就是说BFC内部的元素和外部的元素不会互相影响。`</span><br><span class="line"></span><br><span class="line"> ``````````````````- css定义的权重</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`以下是权重的规则：标签的权重为1，class的权重为10，id的权重为100，以下例子是演示各种定义的权重值：  </span><br><span class="line">/_权重为1_/  </span><br><span class="line">div&#123;  </span><br><span class="line">&#125;  </span><br><span class="line">/_权重为10_/  </span><br><span class="line">.class1&#123;  </span><br><span class="line">&#125;  </span><br><span class="line">/_权重为100_/`</span><br><span class="line"></span><br><span class="line">`````````````````</span><br><span class="line"></span><br><span class="line">id1&#123;</span><br><span class="line">====</span><br><span class="line"></span><br><span class="line">&#125;  </span><br><span class="line">/_权重为100+1=101_/</span><br><span class="line"></span><br><span class="line">id1 div&#123;</span><br><span class="line">========</span><br><span class="line"></span><br><span class="line">&#125;  </span><br><span class="line">/_权重为10+1=11_/  </span><br><span class="line">.class1 div&#123;  </span><br><span class="line">&#125;  </span><br><span class="line">/_权重为10+10+1=21_/  </span><br><span class="line">.class1 .class2 div&#123;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">如果权重相同，则最后定义的样式会起作用，但是应该避免这种情况出现</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    - 请解释一下为什么需要清除浮动？清除浮动的方式</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`清除浮动是为了清除使用浮动元素产生的影响。浮动的元素，高度会塌陷，而高度的塌陷使我们页面后面的布局不能正常显示。`</span><br><span class="line"></span><br><span class="line">````````````````</span><br><span class="line"></span><br><span class="line">1、父级div定义height；  </span><br><span class="line">2、父级div 也一起浮动；  </span><br><span class="line">3、常规的使用一个class；  </span><br><span class="line">.clearfix:before, .clearfix:after &#123;  </span><br><span class="line">content: &quot; &quot;;  </span><br><span class="line">display: table;  </span><br><span class="line">&#125;  </span><br><span class="line">.clearfix:after &#123;  </span><br><span class="line">clear: both;  </span><br><span class="line">&#125;  </span><br><span class="line">.clearfix &#123;  </span><br><span class="line">*zoom: 1;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">4、SASS编译的时候，浮动元素的父级div定义伪类:after  </span><br><span class="line">&amp;:after,&amp;:before&#123;  </span><br><span class="line">content: &quot; &quot;;  </span><br><span class="line">visibility: hidden;  </span><br><span class="line">display: block;  </span><br><span class="line">height: 0;  </span><br><span class="line">clear: both;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">解析原理：</span><br><span class="line"></span><br><span class="line">1.  display:block 使生成的元素以块级元素显示,占满剩余空间;</span><br><span class="line">2.  height:0 避免生成内容破坏原有布局的高度。</span><br><span class="line">3.  visibility:hidden 使生成的内容不可见，并允许可能被生成内容盖住的内容可以进行点击和交互;  </span><br><span class="line">    4）通过 content:&quot;.&quot;生成内容作为最后一个元素，至于content里面是点还是其他都是可以的，例如oocss里面就有经典的 content:&quot;.&quot;,有些版本可能content 里面内容为空,一丝冰凉是不推荐这样做的,firefox直到7.0 content:&quot;&quot; 仍然会产生额外的空隙；  </span><br><span class="line">    5）zoom：1 触发IE hasLayout。</span><br><span class="line"></span><br><span class="line">通过分析发现，除了clear：both用来闭合浮动的，其他代码无非都是为了隐藏掉content生成的内容，这也就是其他版本的闭合浮动为什么会有font-size：0，line-height：0。</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    - 什么是外边距合并？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`外边距合并指的是，当两个垂直外边距相遇时，它们将形成一个外边距。  </span><br><span class="line">合并后的外边距的高度等于两个发生合并的外边距的高度中的较大者。  </span><br><span class="line">w3school介绍网址： [http://www.w3school.com.cn/css/css_margin_collapsing.asp](http://www.w3school.com.cn/css/css_margin_collapsing.asp)`</span><br><span class="line"></span><br><span class="line"> ```````````````- zoom:1的清除浮动原理?</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`清除浮动，触发hasLayout；  </span><br><span class="line">Zoom属性是IE浏览器的专有属性，它可以设置或检索对象的缩放比例。解决ie下比较奇葩的bug。  </span><br><span class="line">譬如外边距（margin）的重叠，浮动清除，触发ie的haslayout属性等。`</span><br><span class="line"></span><br><span class="line">``````````````</span><br><span class="line"></span><br><span class="line">来龙去脉大概如下：  </span><br><span class="line">当设置了zoom的值之后，所设置的元素就会就会扩大或者缩小，高度宽度就会重新计算了，这里一旦改变zoom值时其实也会发生重新渲染，运用这个原理，也就解决了ie下子元素浮动时候父元素不随着自动扩大的问题。</span><br><span class="line"></span><br><span class="line">Zoom属是IE浏览器的专有属性，火狐和老版本的webkit核心的浏览器都不支持这个属性。然而，zoom现在已经被逐步标准化，出现在 CSS 3.0 规范草案中。</span><br><span class="line"></span><br><span class="line">目前非ie由于不支持这个属性，它们又是通过什么属性来实现元素的缩放呢？  </span><br><span class="line">可以通过css3里面的动画属性scale进行缩放。</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    - 移动端的布局用过媒体查询吗？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`假设你现在正用一台显示设备来阅读这篇文章，同时你也想把它投影到屏幕上，或者打印出来， 而显示设备、屏幕投影和打印等这些媒介都有自己的特点，CSS就是为文档提供在不同媒介上展示的适配方法`</span><br><span class="line"></span><br><span class="line">`````````````</span><br><span class="line"></span><br><span class="line">当媒体查询为真时，相关的样式表或样式规则会按照正常的级联规被应用。 当媒体查询返回假， 标签上带有媒体查询的样式表 仍将被下载 （只不过不会被应用）。</span><br><span class="line"></span><br><span class="line">包含了一个媒体类型和至少一个使用 宽度、高度和颜色等媒体属性来限制样式表范围的表达式。 CSS3加入的媒体查询使得无需修改内容便可以使样式应用于某些特定的设备范围。</span><br><span class="line"></span><br><span class="line">@media (min-width: 700px) and (orientation: landscape) &#123; .sidebar &#123; display: none; &#125; &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    - 使用 CSS 预处理器吗？喜欢那个？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`SASS (SASS、LESS没有本质区别，只因为团队前端都是用的SASS)`</span><br><span class="line"></span><br><span class="line"> ````````````- CSS优化、提高性能的方法有哪些？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`关键选择器（key selector）。选择器的最后面的部分为关键选择器（即用来匹配目标元素的部分）；  </span><br><span class="line">如果规则拥有 ID 选择器作为其关键选择器，则不要为规则增加标签。过滤掉无关的规则（这样样式系统就不会浪费时间去匹配它们了）；  </span><br><span class="line">提取项目的通用公有样式，增强可复用性，按模块编写组件；增强项目的协同开发性、可维护性和可扩展性;  </span><br><span class="line">使用预处理工具或构建工具（gulp对css进行语法检查、自动补前缀、打包压缩、自动优雅降级）；`</span><br><span class="line"></span><br><span class="line"> ```````````- 浏览器是怎样解析CSS选择器的？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`样式系统从关键选择器开始匹配，然后左移查找规则选择器的祖先元素。  </span><br><span class="line">只要选择器的子树一直在工作，样式系统就会持续左移，直到和规则匹配，或者是因为不匹配而放弃该规则。`</span><br><span class="line"></span><br><span class="line"> ``````````- margin和padding分别适合什么场景使用？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`margin是用来隔开元素与元素的间距；padding是用来隔开元素与内容的间隔。  </span><br><span class="line">margin用于布局分开元素使元素与元素互不相干；  </span><br><span class="line">padding用于元素与内容之间的间隔，让内容（文字）与（包裹）元素之间有一段`</span><br><span class="line"></span><br><span class="line"> `````````- ::before 和 :after中双冒号和单冒号 有什么区别？解释一下这2个伪元素的作用。</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`单冒号(:)用于CSS3伪类，双冒号(::)用于CSS3伪元素。（伪元素由双冒号和伪元素名称组成）  </span><br><span class="line">双冒号是在当前规范中引入的，用于区分伪类和伪元素。不过浏览器需要同时支持旧的已经存在的伪元素写法，  </span><br><span class="line">比如:first-line、:first-letter、:before、:after等，  </span><br><span class="line">而新的在CSS3中引入的伪元素则不允许再支持旧的单冒号的写法。`</span><br><span class="line"></span><br><span class="line">````````</span><br><span class="line"></span><br><span class="line">想让插入的内容出现在其它内容前，使用::before，否者，使用::after；  </span><br><span class="line">在代码顺序上，::after生成的内容也比::before生成的内容靠后。  </span><br><span class="line">如果按堆栈视角，::after生成的内容会在::before生成的内容之上</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    - 如何修改chrome记住密码后自动填充表单的黄色背景 ？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`input:-webkit-autofill, textarea:-webkit-autofill, select:-webkit-autofill &#123;  </span><br><span class="line">background-color: rgb(250, 255, 189); /* #FAFFBD; */  </span><br><span class="line">background-image: none;  </span><br><span class="line">color: rgb(0, 0, 0);  </span><br><span class="line">&#125;`</span><br><span class="line"></span><br><span class="line"> ```````- 设置元素浮动后，该元素的display值是多少？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`自动变成了 display:block`</span><br><span class="line"></span><br><span class="line"> ``````- 怎么让Chrome支持小于12px 的文字？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`1、用图片：如果是内容固定不变情况下，使用将小于12px文字内容切出做图片，这样不影响兼容也不影响美观。  </span><br><span class="line">2、使用12px及12px以上字体大小：为了兼容各大主流浏览器，建议设计美工图时候设置大于或等于12px的字体大小，如果是接单的这个时候就需要给客户讲解小于12px浏览器不兼容等事宜。  </span><br><span class="line">3、继续使用小于12px字体大小样式设置：如果不考虑chrome可以不用考虑兼容，同时在设置小于12px对象设置-webkit-text-size-adjust:none，做到最大兼容考虑。  </span><br><span class="line">4、使用12px以上字体：为了兼容、为了代码更简单 从新考虑权重下兼容性。`</span><br><span class="line"></span><br><span class="line"> `````- 让页面里的字体变清晰，变细用CSS怎么做？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`-webkit-font-smoothing: antialiased;`</span><br><span class="line"></span><br><span class="line"> ````- font-style属性可以让它赋值为“oblique” oblique是什么意思？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`倾斜的字体样式`</span><br><span class="line"></span><br><span class="line"> ``- position:fixed;在android下无效怎么处理？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`fixed的元素是相对整个页面固定位置的，你在屏幕上滑动只是在移动这个所谓的viewport，  </span><br><span class="line">原来的网页还好好的在那，fixed的内容也没有变过位置，  </span><br><span class="line">所以说并不是iOS不支持fixed，只是fixed的元素不是相对手机屏幕固定的。`</span><br><span class="line"></span><br><span class="line"> ` ```</span><br><span class="line"></span><br><span class="line">*   如果需要手动写动画，你认为最小时间间隔是多久，为什么？（阿里）</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;css&quot;&gt;多数显示器默认频率是60Hz，即1秒刷新60次，所以理论上最小间隔为1/60＊1000ms ＝ 16.7ms</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   display:inline-block 什么时候会显示间隙？(携程)</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;css&quot;&gt;移除空格、使用margin负值、使用font-size:0、letter-spacing、word-spacing</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   什么是Cookie 隔离？（或者说：请求资源的时候不要让它带cookie怎么做）</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;css&quot;&gt;如果静态文件都放在主域名下，那静态文件请求的时候都带有的cookie的数据提交给server的，非常浪费流量，</span><br><span class="line">    所以不如隔离开。</span><br><span class="line">    </span><br><span class="line">    因为cookie有域的限制，因此不能跨域提交请求，故使用非主要域名的时候，请求头中就不会带有cookie数据，</span><br><span class="line">    这样可以降低请求头的大小，降低请求时间，从而达到降低整体请求延时的目的。</span><br><span class="line">    </span><br><span class="line">    同时这种方式不会将cookie传入Web Server，也减少了Web Server对cookie的处理分析环节，</span><br><span class="line">    提高了webserver的http请求的解析速度。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   什么是CSS 预处理器 / 后处理器？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;css&quot;&gt;- 预处理器例如：LESS、Sass、Stylus，用来预编译Sass或less，增强了css代码的复用性，</span><br><span class="line">    还有层级、mixin、变量、循环、函数等，具有很方便的UI组件模块化开发能力，极大的提高工作效率。</span><br><span class="line">    </span><br><span class="line">    - 后处理器例如：PostCSS，通常被视为在完成的样式表中根据CSS规范处理CSS，让其更有效；目前最常做的</span><br><span class="line">    是给CSS属性添加浏览器私有前缀，实现跨浏览器兼容性的问题。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">### JavaScript</span><br><span class="line"></span><br><span class="line">*   介绍js的基本数据类型。</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;Undefined、Null、Boolean、Number、String、</span><br><span class="line">    ECMAScript 2015 新增:Symbol(创建后独一无二且不可变的数据类型 )</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   介绍js有哪些内置对象？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;Object 是 JavaScript 中所有对象的父对象</span><br><span class="line">    </span><br><span class="line">    数据封装类对象：Object、Array、Boolean、Number 和 String</span><br><span class="line">    其他对象：Function、Arguments、Math、Date、RegExp、Error</span><br><span class="line">    </span><br><span class="line">    参考：http://www.ibm.com/developerworks/cn/web/wa-objectsinjs-v1b/index.html</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   说几条写JavaScript的基本规范？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;1.不要在同一行声明多个变量。</span><br><span class="line">    2.请使用 ===/!==来比较true/false或者数值</span><br><span class="line">    3.使用对象字面量替代new Array这种形式</span><br><span class="line">    4.不要使用全局函数。</span><br><span class="line">    5.Switch语句必须带有default分支</span><br><span class="line">    6.函数不应该有时候有返回值，有时候没有返回值。</span><br><span class="line">    7.For循环必须使用大括号</span><br><span class="line">    8.If语句必须使用大括号</span><br><span class="line">    9.for-in循环中的变量 应该使用var关键字明确限定作用域，从而避免作用域污染。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   JavaScript原型，原型链 ? 有什么特点？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;每个对象都会在其内部初始化一个属性，就是prototype(原型)，当我们访问一个对象的属性时，</span><br><span class="line">    如果这个对象内部不存在这个属性，那么他就会去prototype里找这个属性，这个prototype又会有自己的prototype，</span><br><span class="line">    于是就这样一直找下去，也就是我们平时所说的原型链的概念。</span><br><span class="line">    关系：instance.constructor.prototype = instance.__proto__</span><br><span class="line">    </span><br><span class="line">    特点：</span><br><span class="line">    JavaScript对象是通过引用来传递的，我们创建的每个新对象实体中并没有一份属于自己的原型副本。当我们修改原型时，与之相关的对象也会继承这一改变。</span><br><span class="line">    </span><br><span class="line">    当我们需要一个属性的时，Javascript引擎会先看当前对象中是否有这个属性， 如果没有的话，</span><br><span class="line">    就会查找他的Prototype对象是否有这个属性，如此递推下去，一直检索到 Object 内建对象。</span><br><span class="line">    </span><br><span class="line">    function Func()&#123;&#125;</span><br><span class="line">    Func.prototype.name = &quot;Sean&quot;;</span><br><span class="line">    Func.prototype.getInfo = function() &#123;</span><br><span class="line">        return this.name;</span><br><span class="line">    &#125;</span><br><span class="line">    var person = new Func();//现在可以参考var person = Object.create(oldObject);</span><br><span class="line">    console.log(person.getInfo());//它拥有了Func的属性和方法</span><br><span class="line">    //&quot;Sean&quot;</span><br><span class="line">    console.log(Func.prototype);</span><br><span class="line">    // Func &#123; name=&quot;Sean&quot;, getInfo=function()&#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   JavaScript有几种类型的值？，你能画一下他们的内存图吗？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;栈：原始数据类型（Undefined，Null，Boolean，Number、String）</span><br><span class="line">    堆：引用数据类型（对象、数组和函数）</span><br><span class="line">    </span><br><span class="line">    两种类型的区别是：存储位置不同；</span><br><span class="line">    原始数据类型直接存储在栈(stack)中的简单数据段，占据空间小、大小固定，属于被频繁使用数据，所以放入栈中存储；</span><br><span class="line">    引用数据类型存储在堆(heap)中的对象,占据空间大、大小不固定。如果存储在栈中，将会影响程序运行的性能；引用数据类型在栈中存储了指针，该指针指向堆中该实体的起始地址。当解释器寻找引用值时，会首先检索其在栈中的地址，取得地址后从堆中获得实体</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   如何将字符串转化为数字，例如’12.3b’?</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;* parseFloat(&apos;12.3b&apos;);</span><br><span class="line">    * 正则表达式，&apos;12.3b&apos;.match(/(\d)+(\.)?(\d)+/g)[0] * 1, 但是这个不太靠谱，提供一种思路而已。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   如何将浮点数点左边的数每三位添加一个逗号，如12000000.11转化为『12,000,000.11』?</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;function commafy(num)&#123;</span><br><span class="line">        return num &amp;&amp; num</span><br><span class="line">        .toString()</span><br><span class="line">        .replace(/(\d)(?=(\d&#123;3&#125;)+\.)/g, function($1, $2)&#123;</span><br><span class="line">            return $2 + &apos;,&apos;;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   如何实现数组的随机排序？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;方法一：</span><br><span class="line">    var arr = [1,2,3,4,5,6,7,8,9,10];</span><br><span class="line">    function randSort1(arr)&#123;</span><br><span class="line">        for(var i = 0,len = arr.length;i &lt; len; i++ )&#123;</span><br><span class="line">            var rand = parseInt(Math.random()*len);</span><br><span class="line">            var temp = arr[rand]; arr[rand] = arr[i]; arr[i] = temp;</span><br><span class="line">        &#125; return arr;</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(randSort1(arr));</span><br><span class="line">    </span><br><span class="line">    方法二：</span><br><span class="line">    var arr = [1,2,3,4,5,6,7,8,9,10];</span><br><span class="line">    function randSort2(arr)&#123;</span><br><span class="line">        var mixedArray = [];</span><br><span class="line">        while(arr.length &gt; 0)&#123;</span><br><span class="line">            var randomIndex = parseInt(Math.random()*arr.length);</span><br><span class="line">            mixedArray.push(arr[randomIndex]);</span><br><span class="line">            arr.splice(randomIndex, 1);</span><br><span class="line">        &#125;</span><br><span class="line">        return mixedArray;</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(randSort2(arr));</span><br><span class="line">    </span><br><span class="line">    方法三：</span><br><span class="line">    var arr = [1,2,3,4,5,6,7,8,9,10];</span><br><span class="line">    arr.sort(function()&#123;</span><br><span class="line">        return Math.random() - 0.5;</span><br><span class="line">    &#125;)</span><br><span class="line">    console.log(arr);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   Javascript如何实现继承？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;1、构造继承</span><br><span class="line">    2、原型继承</span><br><span class="line">    3、实例继承</span><br><span class="line">    4、拷贝继承</span><br><span class="line">    </span><br><span class="line">    原型prototype机制或apply和call方法去实现较简单，建议使用构造函数与原型混合方式。</span><br><span class="line">    </span><br><span class="line">    function Parent()&#123;</span><br><span class="line">        this.name = &apos;wang&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function Child()&#123;</span><br><span class="line">        this.age = 28;</span><br><span class="line">    &#125;</span><br><span class="line">    Child.prototype = new Parent();//继承了Parent，通过原型</span><br><span class="line">    </span><br><span class="line">    var demo = new Child();</span><br><span class="line">    alert(demo.age);</span><br><span class="line">    alert(demo.name);//得到被继承的属性</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   JavaScript继承的几种实现方式？</span><br><span class="line"></span><br><span class="line">参考：[构造函数的继承](http://www.ruanyifeng.com/blog/2010/05/object-oriented_javascript_inheritance.html)，[非构造函数的继承](http://www.ruanyifeng.com/blog/2010/05/object-oriented_javascript_inheritance_continued.html)；</span><br><span class="line"></span><br><span class="line">*   javascript创建对象的几种方式？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;javascript创建对象简单的说,无非就是使用内置对象或各种自定义对象，当然还可以用JSON；但写法有很多种，也能混合使用。</span><br><span class="line">    </span><br><span class="line">    1、对象字面量的方式</span><br><span class="line">    person=&#123;firstname:&quot;Mark&quot;,lastname:&quot;Yun&quot;,age:25,eyecolor:&quot;black&quot;&#125;;</span><br><span class="line">    </span><br><span class="line">    2、用function来模拟无参的构造函数</span><br><span class="line">    function Person()&#123;&#125;</span><br><span class="line">    var person=new Person();//定义一个function，如果使用new&quot;实例化&quot;,该function可以看作是一个Class</span><br><span class="line">    person.name=&quot;Mark&quot;;</span><br><span class="line">    person.age=&quot;25&quot;;</span><br><span class="line">    person.work=function()&#123;</span><br><span class="line">        alert(person.name+&quot; hello...&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    person.work();</span><br><span class="line">    </span><br><span class="line">    3、用function来模拟参构造函数来实现（用this关键字定义构造的上下文属性）</span><br><span class="line">    function Pet(name,age,hobby)&#123;</span><br><span class="line">        this.name=name;//this作用域：当前对象</span><br><span class="line">        this.age=age;</span><br><span class="line">        this.hobby=hobby;</span><br><span class="line">        this.eat=function()&#123;</span><br><span class="line">            alert(&quot;我叫&quot;+this.name+&quot;,我喜欢&quot;+this.hobby+&quot;,是个程序员&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    var maidou =new Pet(&quot;麦兜&quot;,25,&quot;coding&quot;);//实例化、创建对象</span><br><span class="line">    maidou.eat();//调用eat方法</span><br><span class="line">    </span><br><span class="line">    4、用工厂方式来创建（内置对象）</span><br><span class="line">    var wcDog =new Object();</span><br><span class="line">    wcDog.name=&quot;旺财&quot;;</span><br><span class="line">    wcDog.age=3;</span><br><span class="line">    wcDog.work=function()&#123;</span><br><span class="line">        alert(&quot;我是&quot;+wcDog.name+&quot;,汪汪汪......&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    wcDog.work();</span><br><span class="line">    </span><br><span class="line">    5、用原型方式来创建</span><br><span class="line">    function Dog()&#123;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    Dog.prototype.name=&quot;旺财&quot;;</span><br><span class="line">    Dog.prototype.eat=function()&#123;</span><br><span class="line">        alert(this.name+&quot;是个吃货&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    var wangcai =new Dog();</span><br><span class="line">    wangcai.eat();</span><br><span class="line">    </span><br><span class="line">    6、用混合方式来创建</span><br><span class="line">    function Car(name,price)&#123;</span><br><span class="line">        this.name=name;</span><br><span class="line">        this.price=price;</span><br><span class="line">    &#125;</span><br><span class="line">    Car.prototype.sell=function()&#123;</span><br><span class="line">        alert(&quot;我是&quot;+this.name+&quot;，我现在卖&quot;+this.price+&quot;万元&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    var camry =new Car(&quot;凯美瑞&quot;,27);</span><br><span class="line">    camry.sell();</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   Javascript作用链域?</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;全局函数无法查看局部函数的内部细节，但局部函数可以查看其上层的函数细节，直至全局细节。</span><br><span class="line">    当需要从局部函数查找某一属性或方法时，如果当前作用域没有找到，就会上溯到上层作用域查找，</span><br><span class="line">    直至全局函数，这种组织形式就是作用域链。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   eval是做什么的？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;它的功能是把对应的字符串解析成JS代码并运行；</span><br><span class="line">    应该避免使用eval，不安全，非常耗性能（2次，一次解析成js语句，一次执行）。</span><br><span class="line">    由JSON字符串转换为JSON对象的时候可以用eval，var obj =eval(&apos;(&apos;+ str +&apos;)&apos;);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   什么是window对象? 什么是document对象?</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;window对象是指浏览器打开的窗口。</span><br><span class="line">    document对象是Documentd对象（HTML 文档对象）的一个只读引用，window对象的一个属性。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   null，undefined 的区别？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;null         表示一个对象是“没有值”的值，也就是值为“空”；</span><br><span class="line">    undefined     表示一个变量声明了没有初始化(赋值)；</span><br><span class="line">    </span><br><span class="line">    undefined不是一个有效的JSON，而null是；</span><br><span class="line">    undefined的类型(typeof)是undefined；</span><br><span class="line">    null的类型(typeof)是object；</span><br><span class="line">    </span><br><span class="line">    Javascript将未赋值的变量默认值设为undefined；</span><br><span class="line">    Javascript从来不会将变量设为null。它是用来让程序员表明某个用var声明的变量时没有值的。</span><br><span class="line">    </span><br><span class="line">    typeof undefined</span><br><span class="line">    //&quot;undefined&quot;</span><br><span class="line">    undefined :是一个表示&quot;无&quot;的原始值或者说表示&quot;缺少值&quot;，就是此处应该有一个值，但是还没有定义。当尝试读取时会返回 undefined；</span><br><span class="line">    例如变量被声明了，但没有赋值时，就等于undefined</span><br><span class="line">    </span><br><span class="line">    typeof null</span><br><span class="line">    //&quot;object&quot;</span><br><span class="line">    null : 是一个对象(空对象, 没有任何属性和方法)；</span><br><span class="line">    例如作为函数的参数，表示该函数的参数不是对象；</span><br><span class="line">    </span><br><span class="line">    注意：</span><br><span class="line">    在验证null时，一定要使用　=== ，因为 == 无法分别 null 和　undefined</span><br><span class="line">    null == undefined // true</span><br><span class="line">    null === undefined // false</span><br><span class="line">    </span><br><span class="line">    再来一个例子：</span><br><span class="line">    null</span><br><span class="line">    Q：有张三这个人么？</span><br><span class="line">    A：有！</span><br><span class="line">    Q：张三有房子么？</span><br><span class="line">    A：没有！</span><br><span class="line">    </span><br><span class="line">    undefined</span><br><span class="line">    Q：有张三这个人么？</span><br><span class="line">    A：有！</span><br><span class="line">    Q: 张三有多少岁？</span><br><span class="line">    A: 不知道（没有被告诉）</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   写一个通用的事件侦听器函数。</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;// event(事件)工具集，来源：github.com/markyun</span><br><span class="line">    markyun.Event = &#123;</span><br><span class="line">        // 页面加载完成后</span><br><span class="line">        readyEvent: function (fn) &#123;</span><br><span class="line">            if (fn == null) &#123;</span><br><span class="line">                fn = document;</span><br><span class="line">            &#125;</span><br><span class="line">            var oldonload = window.onload;</span><br><span class="line">            if (typeof window.onload != &apos;function&apos;) &#123;</span><br><span class="line">                window.onload = fn;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                window.onload = function () &#123;</span><br><span class="line">                    oldonload();</span><br><span class="line">                    fn();</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">    // 视能力分别使用dom0||dom2||IE方式 来绑定事件</span><br><span class="line">    // 参数： 操作的元素,事件名称 ,事件处理程序</span><br><span class="line">        addEvent: function (element, type, handler) &#123;</span><br><span class="line">            if (element.addEventListener) &#123;</span><br><span class="line">                //事件类型、需要执行的函数、是否捕捉</span><br><span class="line">                element.addEventListener(type, handler, false);</span><br><span class="line">            &#125; else if (element.attachEvent) &#123;</span><br><span class="line">                element.attachEvent(&apos;on&apos; + type, function () &#123;</span><br><span class="line">                    handler.call(element);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                element[&apos;on&apos; + type] = handler;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        // 移除事件</span><br><span class="line">        removeEvent: function (element, type, handler) &#123;</span><br><span class="line">            if (element.removeEventListener) &#123;</span><br><span class="line">                element.removeEventListener(type, handler, false);</span><br><span class="line">            &#125; else if (element.datachEvent) &#123;</span><br><span class="line">                element.detachEvent(&apos;on&apos; + type, handler);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                element[&apos;on&apos; + type] = null;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        // 阻止事件 (主要是事件冒泡，因为IE不支持事件捕获)</span><br><span class="line">        stopPropagation: function (ev) &#123;</span><br><span class="line">            if (ev.stopPropagation) &#123;</span><br><span class="line">                ev.stopPropagation();</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                ev.cancelBubble = true;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        // 取消事件的默认行为</span><br><span class="line">        preventDefault: function (event) &#123;</span><br><span class="line">            if (event.preventDefault) &#123;</span><br><span class="line">                event.preventDefault();</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                event.returnValue = false;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        // 获取事件目标</span><br><span class="line">        getTarget: function (event) &#123;</span><br><span class="line">            return event.target || event.srcElement;</span><br><span class="line">        &#125;,</span><br><span class="line">        // 获取event对象的引用，取到事件的所有信息，确保随时能使用event；</span><br><span class="line">        getEvent: function (e) &#123;</span><br><span class="line">            var ev = e || window.event;</span><br><span class="line">            if (!ev) &#123;</span><br><span class="line">                var c = this.getEvent.caller;</span><br><span class="line">                while (c) &#123;</span><br><span class="line">                    ev = c.arguments[0];</span><br><span class="line">                    if (ev &amp;&amp; Event == ev.constructor) &#123;</span><br><span class="line">                        break;</span><br><span class="line">                    &#125;</span><br><span class="line">                    c = c.caller;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            return ev;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   [“1”, “2”, “3”].map(parseInt) 答案是多少？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;parseInt() 函数能解析一个字符串，并返回一个整数，需要两个参数 (val, radix)，</span><br><span class="line">    其中 radix 表示要解析的数字的基数。【该值介于 2 ~ 36 之间，并且字符串中的数字不能大于radix才能正确返回数字结果值】;</span><br><span class="line">    但此处 map 传了 3 个 (element, index, array),我们重写parseInt函数测试一下是否符合上面的规则。</span><br><span class="line">    </span><br><span class="line">    function parseInt(str, radix) &#123;</span><br><span class="line">        return str+&apos;-&apos;+radix;</span><br><span class="line">    &#125;;</span><br><span class="line">    var a=[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;];</span><br><span class="line">    a.map(parseInt);  // [&quot;1-0&quot;, &quot;2-1&quot;, &quot;3-2&quot;] 不能大于radix</span><br><span class="line">    </span><br><span class="line">    因为二进制里面，没有数字3,导致出现超范围的radix赋值和不合法的进制解析，才会返回NaN</span><br><span class="line">    所以[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;].map(parseInt) 答案也就是：[1, NaN, NaN]</span><br><span class="line">    </span><br><span class="line">    详细解析：http://blog.csdn.net/justjavac/article/details/19473199</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   事件是？IE与火狐的事件机制有什么区别？ 如何阻止冒泡？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;1. 我们在网页中的某个操作（有的操作对应多个事件）。例如：当我们点击一个按钮就会产生一个事件。是可以被 JavaScript 侦测到的行为。</span><br><span class="line">    2. 事件处理机制：IE是事件冒泡、Firefox同时支持两种事件模型，也就是：捕获型事件和冒泡型事件；</span><br><span class="line">    3. ev.stopPropagation();（旧ie的方法 ev.cancelBubble = true;）</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   什么是闭包（closure），为什么要用它？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;闭包是指有权访问另一个函数作用域中变量的函数，创建闭包的最常见的方式就是在一个函数内创建另一个函数，通过另一个函数访问这个函数的局部变量,利用闭包可以突破作用链域，将函数内部的变量和方法传递到外部。</span><br><span class="line">    </span><br><span class="line">    闭包的特性：</span><br><span class="line">    </span><br><span class="line">    1.函数内再嵌套函数</span><br><span class="line">    2.内部函数可以引用外层的参数和变量</span><br><span class="line">    3.参数和变量不会被垃圾回收机制回收</span><br><span class="line">    </span><br><span class="line">    //li节点的onclick事件都能正确的弹出当前被点击的li索引</span><br><span class="line">    &lt;ul id=&quot;testUL&quot;&gt;</span><br><span class="line">        &lt;li&gt; index = 0&lt;/li&gt;</span><br><span class="line">        &lt;li&gt; index = 1&lt;/li&gt;</span><br><span class="line">        &lt;li&gt; index = 2&lt;/li&gt;</span><br><span class="line">        &lt;li&gt; index = 3&lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">        var nodes = document.getElementsByTagName(&quot;li&quot;);</span><br><span class="line">        for(i = 0;i&lt;nodes.length;i+= 1)&#123;</span><br><span class="line">            nodes[i].onclick = (function(i)&#123;</span><br><span class="line">                return function() &#123;</span><br><span class="line">                    console.log(i);</span><br><span class="line">                &#125; //不用闭包的话，值每次都是4</span><br><span class="line">            &#125;</span><br><span class="line">        )(i);</span><br><span class="line">    &#125;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">    </span><br><span class="line">    执行say667()后,say667()闭包内部变量会存在,而闭包内部函数的内部变量不会存在</span><br><span class="line">    使得Javascript的垃圾回收机制GC不会收回say667()所占用的资源</span><br><span class="line">    因为say667()的内部函数的执行需要依赖say667()中的变量</span><br><span class="line">    这是对闭包作用的非常直白的描述</span><br><span class="line">    </span><br><span class="line">    function say667() &#123;</span><br><span class="line">        // Local variable that ends up within closure</span><br><span class="line">        var num = 666;</span><br><span class="line">        var sayAlert = function() &#123;</span><br><span class="line">            alert(num);</span><br><span class="line">        &#125;</span><br><span class="line">        num++;</span><br><span class="line">        return sayAlert;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    var sayAlert = say667();</span><br><span class="line">    sayAlert()//执行结果应该弹出的667</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   javascript 代码中的”use strict”;是什么意思 ? 使用它区别是什么？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;use strict是一种ECMAscript 5 添加的（严格）运行模式,这种模式使得 Javascript 在更严格的条件下运行,</span><br><span class="line">    </span><br><span class="line">    使JS编码更加规范化的模式,消除Javascript语法的一些不合理、不严谨之处，减少一些怪异行为。</span><br><span class="line">    默认支持的糟糕特性都会被禁用，比如不能用with，也不能在意外的情况下给全局变量赋值;</span><br><span class="line">    全局变量的显示声明,函数必须声明在顶层，不允许在非函数代码块内声明函数,arguments.callee也不允许使用；</span><br><span class="line">    消除代码运行的一些不安全之处，保证代码运行的安全,限制函数中的arguments修改，严格模式下的eval函数的行为和非严格模式的也不相同;</span><br><span class="line">    </span><br><span class="line">    提高编译器效率，增加运行速度；</span><br><span class="line">    为未来新版本的Javascript标准化做铺垫。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   如何判断一个对象是否属于某个类？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;使用instanceof</span><br><span class="line">    if(a instanceof Person)&#123;</span><br><span class="line">        alert(&apos;yes&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   new操作符具体干了什么呢?</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;1、创建一个空对象，并且 this 变量引用该对象，同时还继承了该函数的原型。</span><br><span class="line">    2、属性和方法被加入到 this 引用的对象中。</span><br><span class="line">    3、新创建的对象由 this 所引用，并且最后隐式的返回 this 。</span><br><span class="line">    </span><br><span class="line">    var obj  = &#123;&#125;;</span><br><span class="line">    obj.__proto__ = Base.prototype;</span><br><span class="line">    Base.call(obj);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   Javascript中，有一个函数，执行时对象查找时，永远不会去查找原型，这个函数是？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;hasOwnProperty</span><br><span class="line">    </span><br><span class="line">    javaScript中hasOwnProperty函数方法是返回一个布尔值，指出一个对象是否具有指定名称的属性。此方法无法检查该对象的原型链中是否具有该属性；该属性必须是对象本身的一个成员。</span><br><span class="line">    使用方法：</span><br><span class="line">    object.hasOwnProperty(proName)</span><br><span class="line">    其中参数object是必选项。一个对象的实例。</span><br><span class="line">    proName是必选项。一个属性名称的字符串值。</span><br><span class="line">    </span><br><span class="line">    如果 object 具有指定名称的属性，那么JavaScript中hasOwnProperty函数方法返回 true，反之则返回 false。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   JSON 的了解？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;JSON(JavaScript Object Notation) 是一种轻量级的数据交换格式。</span><br><span class="line">    它是基于JavaScript的一个子集。数据格式简单, 易于读写, 占用带宽小</span><br><span class="line">    如：&#123;&quot;age&quot;:&quot;12&quot;, &quot;name&quot;:&quot;back&quot;&#125;</span><br><span class="line">    </span><br><span class="line">    JSON字符串转换为JSON对象:</span><br><span class="line">    var obj =eval(&apos;(&apos;+ str +&apos;)&apos;);</span><br><span class="line">    var obj = str.parseJSON();</span><br><span class="line">    var obj = JSON.parse(str);</span><br><span class="line">    </span><br><span class="line">    JSON对象转换为JSON字符串：</span><br><span class="line">    var last=obj.toJSONString();</span><br><span class="line">    var last=JSON.stringify(obj);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   js延迟加载的方式有哪些？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;defer和async、动态创建DOM方式（用得最多）、按需异步载入js</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   Ajax 是什么? 如何创建一个Ajax？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;ajax的全称：Asynchronous Javascript And XML。</span><br><span class="line">    异步传输+js+xml。</span><br><span class="line">    所谓异步，在这里简单地解释就是：向服务器发送请求的时候，我们不必等待结果，而是可以同时做其他的事情，等到有了结果它自己会根据设定进行后续操作，与此同时，页面是不会发生整页刷新的，提高了用户体验。</span><br><span class="line">    </span><br><span class="line">    (1)创建XMLHttpRequest对象,也就是创建一个异步调用对象</span><br><span class="line">    (2)创建一个新的HTTP请求,并指定该HTTP请求的方法、URL及验证信息</span><br><span class="line">    (3)设置响应HTTP请求状态变化的函数</span><br><span class="line">    (4)发送HTTP请求</span><br><span class="line">    (5)获取异步调用返回的数据</span><br><span class="line">    (6)使用JavaScript和DOM实现局部刷新</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   Ajax 解决浏览器缓存问题？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;1、在ajax发送请求前加上 anyAjaxObj.setRequestHeader(&quot;If-Modified-Since&quot;,&quot;0&quot;)。</span><br><span class="line">    </span><br><span class="line">    2、在ajax发送请求前加上 anyAjaxObj.setRequestHeader(&quot;Cache-Control&quot;,&quot;no-cache&quot;)。</span><br><span class="line">    </span><br><span class="line">    3、在URL后面加上一个随机数： &quot;fresh=&quot; + Math.random();。</span><br><span class="line">    </span><br><span class="line">    4、在URL后面加上时间搓：&quot;nowtime=&quot; + new Date().getTime();。</span><br><span class="line">    </span><br><span class="line">    5、如果是使用jQuery，直接这样就可以了 $.ajaxSetup(&#123;cache:false&#125;)。这样页面的所有ajax都会执行这条语句就是不需要保存缓存记录。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   同步和异步的区别?</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;同步的概念应该是来自于OS中关于同步的概念:不同进程为协同完成某项工作而在先后次序上调整(通过阻塞,唤醒等方式).同步强调的是顺序性.谁先谁后.异步则不存在这种顺序性.</span><br><span class="line">    </span><br><span class="line">    同步：浏览器访问服务器请求，用户看得到页面刷新，重新发请求,等请求完，页面刷新，新内容出现，用户看到新内容,进行下一步操作。</span><br><span class="line">    </span><br><span class="line">    异步：浏览器访问服务器请求，用户正常操作，浏览器后端进行请求。等请求完，页面不刷新，新内容也会出现，用户看到新内容。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   如何解决跨域问题?</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;jsonp、 iframe、window.name、window.postMessage、服务器上设置代理页面</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   模块化开发怎么做？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;立即执行函数,不暴露私有成员</span><br><span class="line">    var module1 = (function()&#123;</span><br><span class="line">        var _count = 0;</span><br><span class="line">        var m1 = function()&#123;</span><br><span class="line">            //...</span><br><span class="line">        &#125;;</span><br><span class="line">        var m2 = function()&#123;</span><br><span class="line">        //...</span><br><span class="line">        &#125;;</span><br><span class="line">        return &#123;</span><br><span class="line">            m1 : m1,</span><br><span class="line">            m2 : m2</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)();</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   AMD（Modules/Asynchronous-Definition）、CMD（Common Module Definition）规范区别？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;&lt;br&gt;&lt;/br&gt;AMD 规范在这里：https://github.com/amdjs/amdjs-api/wiki/AMD</span><br><span class="line">    </span><br><span class="line">    CMD 规范在这里：https://github.com/seajs/seajs/issues/242</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    Asynchronous Module Definition，异步模块定义，所有的模块将被异步加载，模块加载不影响后面语句运行。所有依赖某些模块的语句均放置在回调函数中。</span><br><span class="line">    </span><br><span class="line">    区别：</span><br><span class="line">    1. 对于依赖的模块，AMD 是提前执行，CMD 是延迟执行。不过 RequireJS 从 2.0 开始，也改成可以延迟执行（根据写法不同，处理方式不同）。CMD 推崇 as lazy as possible.</span><br><span class="line">    2. CMD 推崇依赖就近，AMD 推崇依赖前置。看代码：</span><br><span class="line">    </span><br><span class="line">    // CMD</span><br><span class="line">    define(function(require, exports, module) &#123;</span><br><span class="line">        var a = require(&apos;./a&apos;)</span><br><span class="line">        a.doSomething()</span><br><span class="line">        // 此处略去 100 行</span><br><span class="line">        var b = require(&apos;./b&apos;) // 依赖可以就近书写</span><br><span class="line">        b.doSomething()</span><br><span class="line">        // ...</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    // AMD 默认推荐</span><br><span class="line">    define([&apos;./a&apos;, &apos;./b&apos;], function(a, b) &#123; // 依赖必须一开始就写好</span><br><span class="line">        a.doSomething()</span><br><span class="line">        // 此处略去 100 行</span><br><span class="line">        b.doSomething()</span><br><span class="line">        // ...</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   requireJS的核心原理是什么？（如何动态加载的？如何避免多次加载的？如何 缓存的？）</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;参考：http://annn.me/how-to-realize-cmd-loader/</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   异步加载JS的方式有哪些？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;(1) defer，只支持IE</span><br><span class="line">    </span><br><span class="line">    (2) async：</span><br><span class="line">    </span><br><span class="line">    (3) 创建script，插入到DOM中，加载完毕后callBack</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   documen.write和 innerHTML的区别</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;document.write只能重绘整个页面</span><br><span class="line">    </span><br><span class="line">    innerHTML可以重绘页面的一部分</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   DOM操作——怎样添加、移除、移动、复制、创建和查找节点?</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;（1）创建新节点</span><br><span class="line">    createDocumentFragment()    //创建一个DOM片段</span><br><span class="line">    createElement()   //创建一个具体的元素</span><br><span class="line">    createTextNode()   //创建一个文本节点</span><br><span class="line">    （2）添加、移除、替换、插入</span><br><span class="line">    appendChild()</span><br><span class="line">    removeChild()</span><br><span class="line">    replaceChild()</span><br><span class="line">    insertBefore() //在已有的子节点前插入一个新的子节点</span><br><span class="line">    （3）查找</span><br><span class="line">    getElementsByTagName()    //通过标签名称</span><br><span class="line">    getElementsByName()    //通过元素的Name属性的值(IE容错能力较强，会得到一个数组，其中包括id等于name值的)</span><br><span class="line">    getElementById()    //通过元素Id，唯一性</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   .call() 和 .apply() 的区别？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;例子中用 add 来替换 sub，add.call(sub,3,1) == add(3,1) ，所以运行结果为：alert(4);</span><br><span class="line">    </span><br><span class="line">    注意：js 中的函数其实是对象，函数名是对 Function 对象的引用。</span><br><span class="line">    </span><br><span class="line">    function add(a,b) &#123;</span><br><span class="line">        alert(a+b);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function sub(a,b)&#123;</span><br><span class="line">        alert(a-b);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    add.call(sub,3,1);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   jquery.extend 与 jquery.fn.extend的区别？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;* jquery.extend 为jquery类添加类方法，可以理解为添加静态方法</span><br><span class="line">    * jquery.fn.extend:</span><br><span class="line">    源码中jquery.fn = jquery.prototype，所以对jquery.fn的扩展，就是为jquery类添加成员函数</span><br><span class="line">    使用：</span><br><span class="line">    jquery.extend扩展，需要通过jquery类来调用，而jquery.fn.extend扩展，所有jquery实例都可以直接调用。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   Jquery与jQuery UI 有啥区别？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;*jQuery是一个js库，主要提供的功能是选择器，属性修改和事件绑定等等。</span><br><span class="line">    </span><br><span class="line">    *jQuery UI则是在jQuery的基础上，利用jQuery的扩展性，设计的插件。</span><br><span class="line">    提供了一些常用的界面元素，诸如对话框、拖动行为、改变大小行为等等</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   jquery 中如何将数组转化为json字符串，然后再转化回来？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;jQuery中没有提供这个功能，所以你需要先编写两个jQuery的扩展：</span><br><span class="line">    $.fn.stringifyArray = function(array) &#123;</span><br><span class="line">        return JSON.stringify(array)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    $.fn.parseArray = function(array) &#123;</span><br><span class="line">        return JSON.parse(array)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    然后调用：</span><br><span class="line">    $(&quot;&quot;).stringifyArray(array)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   针对 jQuery 的优化方法？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;*基于Class的选择性的性能相对于Id选择器开销很大，因为需遍历所有DOM元素。</span><br><span class="line">    </span><br><span class="line">    *频繁操作的DOM，先缓存起来再操作。用Jquery的链式调用更好。</span><br><span class="line">    比如：var str=$(&quot;a&quot;).attr(&quot;href&quot;);</span><br><span class="line">    </span><br><span class="line">    *for (var i = size; i &lt; arr.length; i++) &#123;&#125;</span><br><span class="line">    for 循环每一次循环都查找了数组 (arr) 的.length 属性，在开始循环的时候设置一个变量来存储这个数字，可以让循环跑得更快：</span><br><span class="line">    for (var i = size, length = arr.length; i &lt; length; i++) &#123;&#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   如何判断当前脚本运行在浏览器还是node环境中？（阿里）</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;this === window ? &apos;browser&apos; : &apos;node&apos;;</span><br><span class="line">    </span><br><span class="line">    通过判断Global对象是否为window，如果不为window，当前脚本没有运行在浏览器中</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   jQuery 的 slideUp动画 ，如果目标元素是被外部事件驱动, 当鼠标快速地连续触发外部元素事件, 动画会滞后的反复执行，该如何处理呢?</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;jquery stop(): 如：$(&quot;#div&quot;).stop().animate(&#123;width:&quot;100px&quot;&#125;,100);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   那些操作会造成内存泄漏？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;内存泄漏指任何对象在您不再拥有或需要它之后仍然存在。</span><br><span class="line">    垃圾回收器定期扫描对象，并计算引用了每个对象的其他对象的数量。如果一个对象的引用数量为 0（没有其他对象引用过该对象），或对该对象的惟一引用是循环的，那么该对象的内存即可回收。</span><br><span class="line">    </span><br><span class="line">    setTimeout 的第一个参数使用字符串而非函数的话，会引发内存泄漏。</span><br><span class="line">    闭包、控制台日志、循环（在两个对象彼此引用且彼此保留时，就会产生一个循环）</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   JQuery一个对象可以同时绑定多个事件，这是如何实现的？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;* 多个事件同一个函数：</span><br><span class="line">    $(&quot;div&quot;).on(&quot;click mouseover&quot;, function()&#123;&#125;);</span><br><span class="line">    * 多个事件不同函数</span><br><span class="line">    $(&quot;div&quot;).on(&#123;</span><br><span class="line">        click: function()&#123;&#125;,</span><br><span class="line">        mouseover: function()&#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   知道什么是webkit么? 知道怎么用浏览器的各种工具来调试和debug代码么?</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;Chrome,Safari浏览器内核。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   用js实现千位分隔符?(来源：[前端农民工](http://div.io/topic/744)，提示：正则+replace)</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;参考：http://www.tuicool.com/articles/ArQZfui</span><br><span class="line">    function commafy(num) &#123;</span><br><span class="line">        return num &amp;&amp; num</span><br><span class="line">        .toString()</span><br><span class="line">        .replace(/(\d)(?=(\d&#123;3&#125;)+\.)/g, function($0, $1) &#123;</span><br><span class="line">            return $1 + &quot;,&quot;;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(commafy(1234567.90)); //1,234,567.90</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   检测浏览器版本版本有哪些方式？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;功能检测、userAgent特征检测</span><br><span class="line">    比如：navigator.userAgent</span><br><span class="line">    //&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/537.36</span><br><span class="line">    (KHTML, like Gecko) Chrome/41.0.2272.101 Safari/537.36&quot;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   What is a Polyfill?</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;polyfill 是“在旧版浏览器上复制标准 API 的 JavaScript 补充”,可以动态地加载 JavaScript 代码或库，在不支持这些标准 API 的浏览器中模拟它们。</span><br><span class="line">    例如，geolocation（地理位置）polyfill 可以在 navigator 对象上添加全局的 geolocation 对象，还能添加 getCurrentPosition 函数以及“坐标”回调对象，</span><br><span class="line">    所有这些都是 W3C 地理位置 API 定义的对象和函数。因为 polyfill 模拟标准 API，所以能够以一种面向所有浏览器未来的方式针对这些 API 进行开发，</span><br><span class="line">    一旦对这些 API 的支持变成绝对大多数，则可以方便地去掉 polyfill，无需做任何额外工作。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   做的项目中，有没有用过或自己实现一些 polyfill 方案（兼容性处理方案）？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;比如： html5shiv、Geolocation、Placeholder</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   使用JS实现获取文件扩展名？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;function getFileExtension(filename) &#123;</span><br><span class="line">        return filename.slice((filename.lastIndexOf(&quot;.&quot;) - 1 &gt;&gt;&gt; 0) + 2);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    String.lastIndexOf() 方法返回指定值（本例中的&apos;.&apos;）在调用该方法的字符串中最后出现的位置，如果没找到则返回 -1。</span><br><span class="line">    对于&apos;filename&apos;和&apos;.hiddenfile&apos;，lastIndexOf的返回值分别为0和-1无符号右移操作符(»&gt;) 将-1转换为4294967295，将-2转换为4294967294，这个方法可以保证边缘情况时文件名不变。</span><br><span class="line">    String.prototype.slice() 从上面计算的索引处提取文件的扩展名。如果索引比文件名的长度大，结果为&quot;&quot;。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">#### ECMAScript6 相关</span><br><span class="line"></span><br><span class="line">*   Object.is() 与原来的比较操作符“ ===”、“ ==”的区别？</span><br><span class="line"></span><br><span class="line">    &lt;code class=&quot;javascript&quot;&gt;两等号判等，会在比较时进行类型转换；</span><br><span class="line">    三等号判等(判断严格)，比较时不进行隐式类型转换,（类型不同则会返回false）；</span><br><span class="line">    </span><br><span class="line">    Object.is 在三等号判等的基础上特别处理了 NaN 、-0 和 +0 ，保证 -0 和 +0 不再相同，但 Object.is(NaN, NaN) 会返回 true.</span><br><span class="line">    </span><br><span class="line">    Object.is 应被认为有其特殊的用途，而不能用它认为它比其它的相等对比更宽松或严格。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">### 其他问题</span><br><span class="line"></span><br><span class="line">*   页面重构怎么操作？</span><br><span class="line"></span><br><span class="line">     网站重构：在不改变外部行为的前提下，简化结构、添加可读性，而在网站前端保持一致的行为。</span><br><span class="line">     也就是说是在不改变UI的情况下，对网站进行优化，在扩展的同时保持一致的UI。</span><br><span class="line">    </span><br><span class="line">     对于传统的网站来说重构通常是：</span><br><span class="line">    </span><br><span class="line">     表格(table)布局改为DIV+CSS</span><br><span class="line">     使网站前端兼容于现代浏览器(针对于不合规范的CSS、如对IE6有效的)</span><br><span class="line">     对于移动平台的优化</span><br><span class="line">     针对于SEO进行优化</span><br><span class="line">     深层次的网站重构应该考虑的方面</span><br><span class="line">    </span><br><span class="line">     减少代码间的耦合</span><br><span class="line">     让代码保持弹性</span><br><span class="line">     严格按规范编写代码</span><br><span class="line">     设计可扩展的API</span><br><span class="line">     代替旧有的框架、语言(如VB)</span><br><span class="line">     增强用户体验</span><br><span class="line">     通常来说对于速度的优化也包含在重构中</span><br><span class="line">    </span><br><span class="line">     压缩JS、CSS、image等前端资源(通常是由服务器来解决)</span><br><span class="line">     程序的性能优化(如数据读写)</span><br><span class="line">     采用CDN来加速资源加载</span><br><span class="line">     对于JS DOM的优化</span><br><span class="line">     HTTP服务器的文件缓存</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   列举IE与其他浏览器不一样的特性？</span><br><span class="line"></span><br><span class="line">    1、事件不同之处：</span><br><span class="line">    触发事件的元素被认为是目标（target）。而在 IE 中，目标包含在 event 对象的 srcElement 属性；</span><br><span class="line">    获取字符代码、如果按键代表一个字符（shift、ctrl、alt除外），IE 的 keyCode 会返回字符代码（Unicode），DOM 中按键的代码和字符是分离的，要获取字符代码，需要使用 charCode 属性；</span><br><span class="line">    阻止某个事件的默认行为，IE 中阻止某个事件的默认行为，必须将 returnValue 属性设置为 false，Mozilla 中，需要调用 preventDefault() 方法；</span><br><span class="line">    停止事件冒泡，IE 中阻止事件进一步冒泡，需要设置 cancelBubble 为 true，Mozzilla 中，需要调用 stopPropagation()；</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   99%的网站都需要被重构是那本书上写的？</span><br><span class="line"></span><br><span class="line">    网站重构：应用web标准进行设计（第2版）</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   什么叫优雅降级和渐进增强？</span><br><span class="line"></span><br><span class="line">    优雅降级：Web站点在所有新式浏览器中都能正常工作，如果用户使用的是老式浏览器，则代码会针对旧版本的IE进行降级处理了,使之在旧式浏览器上以某种形式降级体验却不至于完全不能用。</span><br><span class="line">    如：border-shadow</span><br><span class="line">    </span><br><span class="line">    渐进增强：从被所有浏览器支持的基本功能开始，逐步地添加那些只有新版本浏览器才支持的功能,向页面增加不影响基础浏览器的额外样式和功能的。当浏览器支持时，它们会自动地呈现出来并发挥作用。</span><br><span class="line">    如：默认使用flash上传，但如果浏览器支持 HTML5 的文件上传功能，则使用HTML5实现更好的体验；</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   是否了解公钥加密和私钥加密。</span><br><span class="line"></span><br><span class="line">    一般情况下是指私钥用于对数据进行签名，公钥用于对签名进行验证;</span><br><span class="line">    HTTP网站在浏览器端用公钥加密敏感数据，然后在服务器端再用私钥解密。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   WEB应用从服务器主动推送Data到客户端有那些方式？</span><br><span class="line"></span><br><span class="line">    html5提供的Websocket</span><br><span class="line">    不可见的iframe</span><br><span class="line">    WebSocket通过Flash</span><br><span class="line">    XHR长时间连接</span><br><span class="line">    XHR Multipart Streaming</span><br><span class="line">    &lt;script&gt;标签的长时间连接(可跨域)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   对Node的优点和缺点提出了自己的看法？</span><br><span class="line"></span><br><span class="line">    *（优点）因为Node是基于事件驱动和无阻塞的，所以非常适合处理并发请求，</span><br><span class="line">    因此构建在Node上的代理服务器相比其他技术实现（如Ruby）的服务器表现要好得多。</span><br><span class="line">    此外，与Node代理服务器交互的客户端代码是由javascript语言编写的，</span><br><span class="line">    因此客户端和服务器端都用同一种语言编写，这是非常美妙的事情。</span><br><span class="line">    </span><br><span class="line">    *（缺点）Node是一个相对新的开源项目，所以不太稳定，它总是一直在变，</span><br><span class="line">    而且缺少足够多的第三方库支持。看起来，就像是Ruby/Rails当年的样子。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   你有用过哪些前端性能优化的方法？</span><br><span class="line"></span><br><span class="line">    （1） 减少http请求次数：CSS Sprites, JS、CSS源码压缩、图片大小控制合适；网页Gzip，CDN托管，data缓存 ，图片服务器。</span><br><span class="line">    （2） 前端模板 JS+数据，减少由于HTML标签导致的带宽浪费，前端用变量保存AJAX请求结果，每次操作本地变量，不用请求，减少请求次数</span><br><span class="line">    （3） 用innerHTML代替DOM操作，减少DOM操作次数，优化javascript性能。</span><br><span class="line">    （4） 当需要设置的样式很多时设置className而不是直接操作style。</span><br><span class="line">    （5） 少用全局变量、缓存DOM节点查找的结果。减少IO读取操作。</span><br><span class="line">    （6） 避免使用CSS Expression（css表达式)又称Dynamic properties(动态属性)。</span><br><span class="line">    （7） 图片预加载，将样式表放在顶部，将脚本放在底部  加上时间戳。</span><br><span class="line">    （8） 避免在页面的主体布局中使用table，table要等其中的内容完全下载之后才会显示出来，显示比div+css布局慢。</span><br><span class="line">    </span><br><span class="line">    对普通的网站有一个统一的思路，就是尽量向前端优化、减少数据库操作、减少磁盘IO。向前端优化指的是，在不影响功能和体验的情况下，能在浏览器执行的不要在服务端执行，能在缓存服务器上直接返回的不要到应用服务器，程序能直接取得的结果不要到外部取得，本机内能取得的数据不要到远程取，内存能取到的不要到磁盘取，缓存中有的不要去数据库查询。减少数据库操作指减少更新次数、缓存结果减少查询次数、将数据库执行的操作尽可能的让你的程序完成（例如join查询），减少磁盘IO指尽量不使用文件系统作为缓存、减少读写文件次数等。程序优化永远要优化慢的部分，换语言是无法“优化”的。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   http状态码有那些？分别代表是什么意思？</span><br><span class="line"></span><br><span class="line">    简单版</span><br><span class="line">    [</span><br><span class="line">        100  Continue    继续，一般在发送post请求时，已发送了http header之后服务端将返回此信息，表示确认，之后发送具体参数信息</span><br><span class="line">        200  OK         正常返回信息</span><br><span class="line">        201  Created      请求成功并且服务器创建了新的资源</span><br><span class="line">        202  Accepted     服务器已接受请求，但尚未处理</span><br><span class="line">        301  Moved Permanently  请求的网页已永久移动到新位置。</span><br><span class="line">        302 Found          临时性重定向。</span><br><span class="line">        303 See Other      临时性重定向，且总是使用 GET 请求新的 URI。</span><br><span class="line">        304  Not Modified 自从上次请求后，请求的网页未修改过。</span><br><span class="line">    </span><br><span class="line">        400 Bad Request  服务器无法理解请求的格式，客户端不应当尝试再次使用相同的内容发起请求。</span><br><span class="line">        401 Unauthorized 请求未授权。</span><br><span class="line">        403 Forbidden      禁止访问。</span><br><span class="line">        404 Not Found      找不到如何与 URI 相匹配的资源。</span><br><span class="line">    </span><br><span class="line">        500 Internal Server Error  最常见的服务器端错误。</span><br><span class="line">        503 Service Unavailable 服务器端暂时无法处理请求（可能是过载或维护）。</span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line">    完整版</span><br><span class="line">    1**(信息类)：表示接收到请求并且继续处理</span><br><span class="line">    100——客户必须继续发出请求</span><br><span class="line">    101——客户要求服务器根据请求转换HTTP协议版本</span><br><span class="line">    </span><br><span class="line">    2**(响应成功)：表示动作被成功接收、理解和接受</span><br><span class="line">    200——表明该请求被成功地完成，所请求的资源发送回客户端</span><br><span class="line">    201——提示知道新文件的URL</span><br><span class="line">    202——接受和处理、但处理未完成</span><br><span class="line">    203——返回信息不确定或不完整</span><br><span class="line">    204——请求收到，但返回信息为空</span><br><span class="line">    205——服务器完成了请求，用户代理必须复位当前已经浏览过的文件</span><br><span class="line">    206——服务器已经完成了部分用户的GET请求</span><br><span class="line">    </span><br><span class="line">    3**(重定向类)：为了完成指定的动作，必须接受进一步处理</span><br><span class="line">    300——请求的资源可在多处得到</span><br><span class="line">    301——本网页被永久性转移到另一个URL</span><br><span class="line">    302——请求的网页被转移到一个新的地址，但客户访问仍继续通过原始URL地址，重定向，新的URL会在response中的Location中返回，浏览器将会使用新的URL发出新的Request。</span><br><span class="line">    303——建议客户访问其他URL或访问方式</span><br><span class="line">    304——自从上次请求后，请求的网页未修改过，服务器返回此响应时，不会返回网页内容，代表上次的文档已经被缓存了，还可以继续使用</span><br><span class="line">    305——请求的资源必须从服务器指定的地址得到</span><br><span class="line">    306——前一版本HTTP中使用的代码，现行版本中不再使用</span><br><span class="line">    307——申明请求的资源临时性删除</span><br><span class="line">    </span><br><span class="line">    4**(客户端错误类)：请求包含错误语法或不能正确执行</span><br><span class="line">    400——客户端请求有语法错误，不能被服务器所理解</span><br><span class="line">    401——请求未经授权，这个状态代码必须和WWW-Authenticate报头域一起使用</span><br><span class="line">    HTTP 401.1 - 未授权：登录失败</span><br><span class="line">    HTTP 401.2 - 未授权：服务器配置问题导致登录失败</span><br><span class="line">    HTTP 401.3 - ACL 禁止访问资源</span><br><span class="line">    HTTP 401.4 - 未授权：授权被筛选器拒绝</span><br><span class="line">    HTTP 401.5 - 未授权：ISAPI 或 CGI 授权失败</span><br><span class="line">    402——保留有效ChargeTo头响应</span><br><span class="line">    403——禁止访问，服务器收到请求，但是拒绝提供服务</span><br><span class="line">    HTTP 403.1 禁止访问：禁止可执行访问</span><br><span class="line">    HTTP 403.2 - 禁止访问：禁止读访问</span><br><span class="line">    HTTP 403.3 - 禁止访问：禁止写访问</span><br><span class="line">    HTTP 403.4 - 禁止访问：要求 SSL</span><br><span class="line">    HTTP 403.5 - 禁止访问：要求 SSL 128</span><br><span class="line">    HTTP 403.6 - 禁止访问：IP 地址被拒绝</span><br><span class="line">    HTTP 403.7 - 禁止访问：要求客户证书</span><br><span class="line">    HTTP 403.8 - 禁止访问：禁止站点访问</span><br><span class="line">    HTTP 403.9 - 禁止访问：连接的用户过多</span><br><span class="line">    HTTP 403.10 - 禁止访问：配置无效</span><br><span class="line">    HTTP 403.11 - 禁止访问：密码更改</span><br><span class="line">    HTTP 403.12 - 禁止访问：映射器拒绝访问</span><br><span class="line">    HTTP 403.13 - 禁止访问：客户证书已被吊销</span><br><span class="line">    HTTP 403.15 - 禁止访问：客户访问许可过多</span><br><span class="line">    HTTP 403.16 - 禁止访问：客户证书不可信或者无效</span><br><span class="line">    HTTP 403.17 - 禁止访问：客户证书已经到期或者尚未生效</span><br><span class="line">    404——一个404错误表明可连接服务器，但服务器无法取得所请求的网页，请求资源不存在。eg：输入了错误的URL</span><br><span class="line">    405——用户在Request-Line字段定义的方法不允许</span><br><span class="line">    406——根据用户发送的Accept拖，请求资源不可访问</span><br><span class="line">    407——类似401，用户必须首先在代理服务器上得到授权</span><br><span class="line">    408——客户端没有在用户指定的饿时间内完成请求</span><br><span class="line">    409——对当前资源状态，请求不能完成</span><br><span class="line">    410——服务器上不再有此资源且无进一步的参考地址</span><br><span class="line">    411——服务器拒绝用户定义的Content-Length属性请求</span><br><span class="line">    412——一个或多个请求头字段在当前请求中错误</span><br><span class="line">    413——请求的资源大于服务器允许的大小</span><br><span class="line">    414——请求的资源URL长于服务器允许的长度</span><br><span class="line">    415——请求资源不支持请求项目格式</span><br><span class="line">    416——请求中包含Range请求头字段，在当前请求资源范围内没有range指示值，请求也不包含If-Range请求头字段</span><br><span class="line">    417——服务器不满足请求Expect头字段指定的期望值，如果是代理服务器，可能是下一级服务器不能满足请求长。</span><br><span class="line">    </span><br><span class="line">    5**(服务端错误类)：服务器不能正确执行一个正确的请求</span><br><span class="line">    HTTP 500 - 服务器遇到错误，无法完成请求</span><br><span class="line">    HTTP 500.100 - 内部服务器错误 - ASP 错误</span><br><span class="line">    HTTP 500-11 服务器关闭</span><br><span class="line">    HTTP 500-12 应用程序重新启动</span><br><span class="line">    HTTP 500-13 - 服务器太忙</span><br><span class="line">    HTTP 500-14 - 应用程序无效</span><br><span class="line">    HTTP 500-15 - 不允许请求 global.asa</span><br><span class="line">    Error 501 - 未实现</span><br><span class="line">    HTTP 502 - 网关错误</span><br><span class="line">    HTTP 503：由于超载或停机维护，服务器目前无法使用，一段时间后可能恢复正常</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   一个页面从输入 URL 到页面加载显示完成，这个过程中都发生了什么？（流程说的越详细越好）</span><br><span class="line"></span><br><span class="line">    注：这题胜在区分度高，知识点覆盖广，再不懂的人，也能答出几句，</span><br><span class="line">    而高手可以根据自己擅长的领域自由发挥，从URL规范、HTTP协议、DNS、CDN、数据库查询、</span><br><span class="line">    到浏览器流式解析、CSS规则构建、layout、paint、onload/domready、JS执行、JS API绑定等等；</span><br><span class="line">    </span><br><span class="line">    详细版：</span><br><span class="line">    1、浏览器会开启一个线程来处理这个请求，对 URL 分析判断如果是 http 协议就按照 Web 方式来处理;</span><br><span class="line">    2、调用浏览器内核中的对应方法，比如 WebView 中的 loadUrl 方法;</span><br><span class="line">    3、通过DNS解析获取网址的IP地址，设置 UA 等信息发出第二个GET请求;</span><br><span class="line">    4、进行HTTP协议会话，客户端发送报头(请求报头);</span><br><span class="line">    5、进入到web服务器上的 Web Server，如 Apache、Tomcat、Node.JS 等服务器;</span><br><span class="line">    6、进入部署好的后端应用，如 PHP、Java、JavaScript、Python 等，找到对应的请求处理;</span><br><span class="line">    7、处理结束回馈报头，此处如果浏览器访问过，缓存上有对应资源，会与服务器最后修改时间对比，一致则返回304;</span><br><span class="line">    8、浏览器开始下载html文档(响应报头，状态码200)，同时使用缓存;</span><br><span class="line">    9、文档树建立，根据标记请求所需指定MIME类型的文件（比如css、js）,同时设置了cookie;</span><br><span class="line">    10、页面开始渲染DOM，JS根据DOM API操作DOM,执行事件绑定等，页面显示完成。</span><br><span class="line">    </span><br><span class="line">    简洁版：</span><br><span class="line">    浏览器根据请求的URL交给DNS域名解析，找到真实IP，向服务器发起请求；</span><br><span class="line">    服务器交给后台处理完成后返回数据，浏览器接收文件（HTML、JS、CSS、图象等）；</span><br><span class="line">    浏览器对加载到的资源（HTML、JS、CSS等）进行语法解析，建立相应的内部数据结构（如HTML的DOM）；</span><br><span class="line">    载入解析到的资源文件，渲染页面，完成。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   你用的得心应手用的熟练地编辑器&amp;开发环境是什么样子？</span><br><span class="line"></span><br><span class="line">    Sublime Text 3 + 相关插件编写前端代码</span><br><span class="line">    Google chrome 、Mozilla Firefox浏览器 +firebug 兼容测试和预览页面UI、动画效果和交互功能</span><br><span class="line">    Node.js+Gulp</span><br><span class="line">    git 用于版本控制和Code Review</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   对前端工程师这个职位是怎么样理解的？它的前景会怎么样？</span><br><span class="line"></span><br><span class="line">    前端是最贴近用户的程序员，比后端、数据库、产品经理、运营、安全都近。</span><br><span class="line">    1、实现界面交互</span><br><span class="line">    2、提升用户体验</span><br><span class="line">    3、有了Node.js，前端可以实现服务端的一些事情</span><br><span class="line">    </span><br><span class="line">    前端是最贴近用户的程序员，前端的能力就是能让产品从 90分进化到 100 分，甚至更好，</span><br><span class="line">    </span><br><span class="line">    参与项目，快速高质量完成实现效果图，精确到1px；</span><br><span class="line">    与团队成员，UI设计，产品经理的沟通；</span><br><span class="line">    做好的页面结构，页面重构和用户体验；</span><br><span class="line">    处理hack，兼容、写出优美的代码格式；</span><br><span class="line">    针对服务器的优化、拥抱最新前端技术。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   你对加班的看法？</span><br><span class="line"></span><br><span class="line">    加班就像借钱，原则应当是------救急不救穷</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   平时如何管理你的项目？</span><br><span class="line"></span><br><span class="line">    先期团队必须确定好全局样式（globe.css），编码模式(utf-8) 等；</span><br><span class="line">    编写习惯必须一致（例如都是采用继承式的写法，单样式都写成一行）；</span><br><span class="line">    标注样式编写人，各模块都及时标注（标注关键样式调用的地方）；</span><br><span class="line">    页面进行标注（例如 页面 模块 开始和结束）；</span><br><span class="line">    CSS跟HTML 分文件夹并行存放，命名都得统一（例如style.css）；</span><br><span class="line">    JS 分文件夹存放 命名以该JS功能为准的英文翻译。</span><br><span class="line">    图片采用整合的 images.png png8 格式文件使用 尽量整合在一起使用方便将来的管理</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   说说最近最流行的一些东西吧？常去哪些网站？</span><br><span class="line"></span><br><span class="line">    ES6\WebAssembly\Node\MVVM\Web Components\React\React Native\Webpack 组件化</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*   移动端（Android IOS）怎么做好用户体验?</span><br><span class="line"></span><br><span class="line">    清晰的视觉纵线、</span><br><span class="line">    信息的分组、极致的减法、</span><br><span class="line">    利用选择代替输入、</span><br><span class="line">    标签及文字的排布方式、</span><br><span class="line">    依靠明文确认密码、</span><br><span class="line">    合理的键盘利用、</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">### 前端学习网站推荐</span><br><span class="line"></span><br><span class="line">    1. 极客标签：     http://www.gbtags.com/</span><br><span class="line">    2. 码农周刊：     http://weekly.manong.io/issues/</span><br><span class="line">    3. 前端周刊：     http://www.feweekly.com/issues</span><br><span class="line">    4. 慕课网：       http://www.imooc.com/</span><br><span class="line">    5. div.io：         http://div.io</span><br><span class="line">    6. Hacker News： https://news.ycombinator.com/news</span><br><span class="line">    7. InfoQ：       http://www.infoq.com/</span><br><span class="line">    8. w3cplus：     http://www.w3cplus.com/</span><br><span class="line">    9. Stack Overflow： http://stackoverflow.com/</span><br><span class="line">    10. w3school：    http://www.w3school.com.cn/</span><br><span class="line">    11. mozilla：     https://developer.mozilla.org/zh-CN/docs/Web/JavaScript</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">### 文档推荐</span><br><span class="line"></span><br><span class="line">1.  [jQuery 基本原理](http://docs.huihoo.com/jquery/jquery-fundamentals/zh-cn/index.html &quot;jQuery 基本原理&quot;)</span><br><span class="line">2.  [JavaScript 秘密花园](http://bonsaiden.github.io/JavaScript-Garden/zh/)</span><br><span class="line">3.  [CSS参考手册](http://css.doyoe.com/)</span><br><span class="line">4.  [JavaScript 标准参考教程](http://javascript.ruanyifeng.com/)</span><br><span class="line">5.  [ECMAScript 6入门](http://es6.ruanyifeng.com/)` `` ```` ````` `````` ``````` ```````` ````````` `````````` ``````````` ```````````` ````````````` `````````````` ``````````````` ```````````````` ````````````````` `````````````````` ``````````````````` ```````````````````` ````````````````````` `````````````````````` ``````````````````````` ```````````````````````` ````````````````````````` `````````````````````````` ``````````````````````````` ```````````````````````````` ````````````````````````````` `````````````````````````````` ``````````````````````````````` ```````````````````````````````` ````````````````````````````````` ```</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web前端 </tag>
            
            <tag> 面试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EMD Vol 1703</title>
      <link href="/emd-vol-1703.html"/>
      <url>/emd-vol-1703.html</url>
      
        <content type="html"><![CDATA[<h3 id="2017-02-22"><a href="#2017-02-22" class="headerlink" title="2017.02.22"></a>2017.02.22</h3><p>这个月发生的事情有点多…</p><h3 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h3><p>这个月对我来说，变动最大的还是工作吧。原有的工作已经辞了，种种原因对之前的那家公司很不满意。</p><p>辞掉家里人也没说什么，第二天投了几家城南中意的公司，到目前为止面试了三家。</p><p>第一家公司看起来很小…似乎人就那么点。面试也很简单，无非就问Ajax获取数据和Ajax异步，之后又问了数据库查询的问题，似乎想让我做全栈工程师…主要是不提供住宿，这点我就不想过去了。</p><p>第二家是网络营销外包公司，面试也没问啥技术问题…公司有人认识我上一任公司同事，知道我技术过关了，直接谈公司业务什么的，差不多半个小时结束。目前来看这家公司算是满意了，就是地方偏僻得不像话，过去走了半天就没几个人。</p><p>第三家，啥也不想说，直接PASS，面试中踩到雷了…果然不能粗心大意…</p><p>不过，又来个面试电话，mdzz，表示面试上瘾了。暂时没决定去哪家，不过去第二家可能性比较大。</p><h3 id="生活"><a href="#生活" class="headerlink" title="生活"></a>生活</h3><p>大概昨天，我做了拔甲手术。大概得甲沟炎差不多三年来了，一开始也不知道这玩意儿叫甲沟炎，大概从去年开始，很严重了。就TM别人踩我一脚，一声惨嚎，吓死别人…之后发现拇指周围皮肤发紫发黑，百度才知道是甲沟炎，一直忙着没时间去拔掉。</p><p>趁着在家时间去医院拔了，直接麻醉了，玩了半个小时手机，医生说拔完了，表示当时懵逼了，心想这麻醉效果这么强…</p><p>然后医生把指甲那给我看，真的把我惊呆了，长得好深，起码三厘米在肉里，问题这不是关键，关键头部居然是尖锐的！！！我说平时走路走着走着疼得要死！拔完差不多松了一口气。以后再也不用担心了。</p><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>手中的iPhone，又TMD无服务了，99%就是基带虚焊问题，太难受了，上次修好差不多有俩个月，又坏了！好烦躁，现在主力机子转Android了，体验下Android 7.0，流畅的不像话…决定还是回归Android阵营。</p><p>前几天又看到Android O预览版相关新闻，很惊叹Android发展变化实在是太快，从Android 4.0开始，每个大版本的升级，就是一个里程碑啊！</p><p>附手机桌面首页</p><p><img src="https://res.i95.me/wp-content/uploads/2017/03/20170323068-1.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>npm更换源</title>
      <link href="/npm-replacement-source.html"/>
      <url>/npm-replacement-source.html</url>
      
        <content type="html"><![CDATA[<h3 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h3><p>由于源地址被墙，故需要更换地址。</p><p>(1)通过 config 配置指向国内镜像源</p><pre><code>npm config set registry http://registry.cnpmjs.org //配置指向源npm info express  //下载安装第三方包</code></pre><p>(2)通过 npm 命令指定下载源</p><pre><code>npm --registry http://registry.cnpmjs.org info express</code></pre><p>(3)在配置文件 ~/.npmrc 文件写入源地址</p><pre><code>nano ~/.npmrc   //打开配置文件registry =https://registry.npm.taobao.org   //写入配置文件</code></pre><p>推荐使用最后一种方法,一劳永逸,前面2钟方法都是临时改变包下载源。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.JS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac Terminal中使用Sublime Text3设置快捷键</title>
      <link href="/use-the-sublime-text3-to-set-up-shortcuts-in-mac-terminal.html"/>
      <url>/use-the-sublime-text3-to-set-up-shortcuts-in-mac-terminal.html</url>
      
        <content type="html"><![CDATA[<p>Sublime Text 本身提供了命令行工具, 只需要在 Terminal 中输入以下内容就行了</p><pre><code>&lt;code class=&quot;bash&quot;&gt;sudo ln -s /Applications/Sublime\ Text.app/Contents/SharedSupport/bin/subl /usr/bin/subl</code></pre><p>如果你的 Sublime Text 安装位置不是默认的，请自行修改命令中的这一段</p><p>成功以后就可以直接在 Terminal 中输入 subl xxx 来用 Sublime Text 打开文件了，十分的方便。</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mac </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用ngx_pagespeed优化博客</title>
      <link href="/install-ngx-pagespeed-notes.html"/>
      <url>/install-ngx-pagespeed-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>闲来无事，就随便折腾了，让博客支持<code>ngx_pagespeed</code>模块。 <code>ngx_pagespeed</code>是可以对网页进行加速，压缩图片、压缩合并CSS和JS，对网页加速效果明显。</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><pre><code>wget https://github.com/pagespeed/ngx_pagespeed/archive/latest-beta.tar.gzwget http://nginx.org/download/nginx-1.10.3.tar.gztar xzf latest-beta.tar.gztar xzf nginx-1.10.3.tar.gzcd ngx_pagespeed-latest-beta/wget https://dl.google.com/dl/page-speed/psol/1.12.34.2-x64.tar.gztar xzf 1.12.34.2-x64.tar.gzrm -rf 1.12.34.2-x64.tar.gz./scripts/pagespeed_libraries_generator.sh &gt; /usr/local/nginx/conf/pagespeed_libraries.confcd ../nginx-1.10.3//usr/local/nginx/sbin/nginx -V</code></pre><p>查询编译参数，重新编译：</p><pre><code>./configure --prefix=/usr/local/nginx --user=www --group=www --with-http_stub_status_module --with-http_v2_module --with-http_ssl_module --with-http_gzip_static_module --with-http_realip_module --with-http_flv_module --with-http_mp4_module --with-openssl=../openssl-1.0.2j --with-pcre=../pcre-8.39 --with-pcre-jit --with-ld-opt=-ljemalloc --add-module=../ngx_cache_purge-2.3 --add-module=../ngx_pagespeed-latest-beta</code></pre><p>主要添加<code>--add-module=../ngx_pagespeed-latest-beta</code></p><pre><code>make #编译mv /usr/local/nginx/sbin/nginx{,_`date +%F`}  #备份nginxcp objs/nginx /usr/local/nginx/sbinnginx -V 2&gt;&amp;1 | grep -o ngx_pagespeed # 显示ngx_pagespeed表示已经安装成功</code></pre><h3 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h3><p>将下面复制重命名为<code>pagespeed.conf</code>放到你的虚拟配置文件下</p><pre><code># on 启用，off 关闭pagespeed on;# memcached优化,如果没有memcached优化请删去pagespeed MemcachedThreads 1;pagespeed MemcachedServers &quot;localhost:11211&quot;;# 重置 http Vary 头pagespeed RespectVary on;# html字符转小写pagespeed LowercaseHtmlNames on;# 压缩带 Cache-Control: no-transform 标记的资源#pagespeed DisableRewriteOnNoTransform off;# 相对URL#pagespeed PreserveUrlRelativity on;pagespeed XHeaderValue &quot;Powered By JaxsonWang&quot;;# 开启 https#pagespeed FetchHttps enable;# 配置服务器缓存位置和自动清除触发条件（空间大小、时限）pagespeed FileCachePath &quot;/var/ngx_pagespeed/&quot;;pagespeed FileCacheSizeKb 2048000;pagespeed FileCacheCleanIntervalMs 43200000;pagespeed FileCacheInodeLimit 500000;# 过滤规则pagespeed RewriteLevel PassThrough;# 过滤WordPress的/wp-admin/目录(可选配置，可参考使用)pagespeed Disallow &quot;*/wp-admin/*&quot;;pagespeed Disallow &quot;*/wp-login.php*&quot;;# 过滤typecho的/admin/目录(可选配置，可参考使用)pagespeed Disallow &quot;*/admin/*&quot;;# 移除不必要的url前缀，开启可能会导致某些自动加载功能失效#pagespeed EnableFilters trim_urls;# 移除 html 空白pagespeed EnableFilters collapse_whitespace;# 移除 html 注释pagespeed EnableFilters remove_comments;# DNS 预加载pagespeed EnableFilters insert_dns_prefetch;# 压缩CSSpagespeed EnableFilters rewrite_css;# 合并CSSpagespeed EnableFilters combine_css;# 重写CSS，优化加载渲染页面的CSS规则pagespeed EnableFilters prioritize_critical_css;# google字体直接写入html 目的是减少浏览器请求和DNS查询pagespeed EnableFilters inline_google_font_css;# 压缩jspagespeed EnableFilters rewrite_javascript;# 合并jspagespeed EnableFilters combine_javascript;# 优化内嵌样式属性#pagespeed EnableFilters rewrite_style_attributes;# 压缩图片#pagespeed EnableFilters rewrite_images;# 不加载显示区域以外的图片pagespeed LazyloadImagesAfterOnload off;# 图片预加载pagespeed EnableFilters inline_preview_images;# 移动端图片自适应重置pagespeed EnableFilters resize_mobile_images;# 图片延迟加载pagespeed EnableFilters lazyload_images;# 雪碧图片，图标很多的时候很有用#pagespeed EnableFilters sprite_images;# 扩展缓存 改善页面资源的可缓存性pagespeed EnableFilters extend_cache;# 不能删location ~ &quot;\.pagespeed\.([a-z]\.)?[a-z]{2}\.[^.]{10}\.[^.]+&quot; { add_header &quot;&quot; &quot;&quot;; }location ~ &quot;^/ngx_pagespeed_static/&quot; { }location ~ &quot;^/ngx_pagespeed_beacon$&quot; { }location /ngx_pagespeed_statistics { allow 127.0.0.1; deny all; }location /ngx_pagespeed_message { allow 127.0.0.1; deny all; }</code></pre><p>最后重启下你的Nginx服务</p><pre><code>service nginx restart</code></pre><hr><p>有些朋友编译会出现<code>psol not fond</code>，就算也有也会报错，建议删除psol依赖包，直接编译，后面会提示你需要安装psol依赖包的版本以及安装平台</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac Chrome非官方插件去除验证</title>
      <link href="/mac-chrome-unofficial-plugin-removal-verification.html"/>
      <url>/mac-chrome-unofficial-plugin-removal-verification.html</url>
      
        <content type="html"><![CDATA[<p>Mac相对而言，比Windows简单多了。</p><p>上一篇文章：<a href="https://iiong.com/windows-chrome-unofficial-plugin-removal-verification.html" target="_blank" rel="noopener">Windows Chrome去除非官方插件验证</a></p><p>Mac先下载下面但描述文件：</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;plist version=&quot;1.0&quot;&gt;&lt;dict&gt;    &lt;key&gt;PayloadContent&lt;/key&gt;    &lt;array&gt;        &lt;dict&gt;            &lt;key&gt;PayloadContent&lt;/key&gt;            &lt;dict&gt;                &lt;key&gt;com.google.Chrome&lt;/key&gt;                &lt;dict&gt;                    &lt;key&gt;Forced&lt;/key&gt;                    &lt;array&gt;                        &lt;dict&gt;                            &lt;key&gt;mcx_preference_settings&lt;/key&gt;                            &lt;dict&gt;                                &lt;key&gt;ExtensionInstallWhitelist&lt;/key&gt;                                &lt;array&gt;                                    &lt;string&gt;value01&lt;/string&gt;                                    &lt;string&gt;value02&lt;/string&gt;                                    &lt;string&gt;value03&lt;/string&gt;                                &lt;/array&gt;                            &lt;/dict&gt;                        &lt;/dict&gt;                    &lt;/array&gt;                &lt;/dict&gt;            &lt;/dict&gt;            &lt;key&gt;PayloadEnabled&lt;/key&gt;            &lt;true/&gt;            &lt;key&gt;PayloadIdentifier&lt;/key&gt;            &lt;string&gt;MCXToProfile.7e2bec75-299e-44ff-b405-628007abffff.alacarte.customsettings.bdac4880-d25f-4cdd-8472-05473f005e7e&lt;/string&gt;            &lt;key&gt;PayloadType&lt;/key&gt;            &lt;string&gt;com.apple.ManagedClient.preferences&lt;/string&gt;            &lt;key&gt;PayloadUUID&lt;/key&gt;            &lt;string&gt;bdac4880-d25f-4cdd-8472-05473f005e7e&lt;/string&gt;            &lt;key&gt;PayloadVersion&lt;/key&gt;            &lt;integer&gt;1&lt;/integer&gt;        &lt;/dict&gt;    &lt;/array&gt;    &lt;key&gt;PayloadDescription&lt;/key&gt;    &lt;string&gt;Included custom settings:com.google.Chrome&lt;/string&gt;    &lt;key&gt;PayloadDisplayName&lt;/key&gt;    &lt;string&gt;MCXToProfile: com.google.Chrome&lt;/string&gt;    &lt;key&gt;PayloadIdentifier&lt;/key&gt;    &lt;string&gt;com.google.Chrome&lt;/string&gt;    &lt;key&gt;PayloadOrganization&lt;/key&gt;    &lt;string&gt;&lt;/string&gt;    &lt;key&gt;PayloadRemovalDisallowed&lt;/key&gt;    &lt;true/&gt;    &lt;key&gt;PayloadScope&lt;/key&gt;    &lt;string&gt;System&lt;/string&gt;    &lt;key&gt;PayloadType&lt;/key&gt;    &lt;string&gt;Configuration&lt;/string&gt;    &lt;key&gt;PayloadUUID&lt;/key&gt;    &lt;string&gt;7e2bec75-299e-44ff-b405-628007abffff&lt;/string&gt;    &lt;key&gt;PayloadVersion&lt;/key&gt;    &lt;integer&gt;1&lt;/integer&gt;&lt;/dict&gt;&lt;/plist&gt;</code></pre><p>修改第19行value该为插件ID，删除20，21行。命名文件为<code>com.google.Chrome.mobileconfig</code></p><p>双击导入描述文件，重启电脑即可。</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Chrome </tag>
            
            <tag> Mac </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows Chrome非官方插件去除验证</title>
      <link href="/windows-chrome-unofficial-plugin-removal-verification.html"/>
      <url>/windows-chrome-unofficial-plugin-removal-verification.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>Chrome使用非商店的插件，每次启动都有恶心的弹窗。谷歌了下，找到一个比较好点的方法。</p><h3 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h3><ul><li>首先去下个Chrome模板，<a href="https://dl.google.com/dl/edgedl/chrome/policy/policy_templates.zip" target="_blank" rel="noopener">点击下载</a></li><li><p>打开文件管理器，在地址栏输入<code>%SystemRoot%\PolicyDefinitions</code>到文件夹，提取本地化文件到<code>%SystemRoot%\PolicyDefinitions</code>目录。</p><p>./Windows/admx/chrome.admx;<br>./Windows/admx/google.admx;<br>./Windows/admx/en-US/;<br>./Windows/admx/zh-CN/;</p></li></ul><ul><li>执行Win+R并运行：<code>gpedit.msc</code>，进入<code>本地计算机策略&gt;计算机配置&gt;管理模板</code></li></ul><h3 id="将扩展程序ID添加到白名单"><a href="#将扩展程序ID添加到白名单" class="headerlink" title="将扩展程序ID添加到白名单"></a>将扩展程序ID添加到白名单</h3><p>通过以下步骤添加扩展程序ID：</p><ul><li>导航到<code>管理模板/ Google / Google Chrome /扩展程序</code></li><li>双击右侧打开<code>配置扩展安装白名单</code></li><li><code>启用策略</code>，然后单击<code>显示</code>以添加<code>扩展程序ID</code>，此ID在Chrome扩展可以看到</li></ul><p>Chrome重新启动后，该扩展程序将默认启用。</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Chrome </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Struts 2笔记-1</title>
      <link href="/struts2-notes-1.html"/>
      <url>/struts2-notes-1.html</url>
      
        <content type="html"><![CDATA[<h3 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h3><p><a href="http://struts.apache.org/" target="_blank" rel="noopener">http://struts.apache.org/</a></p><h4 id="版本说明"><a href="#版本说明" class="headerlink" title="版本说明"></a>版本说明</h4><p>Full Distribution: Struts完整版，通常下载此版本。以下全部包括。<br>Example Applications: Struts实例应用，学习使用。<br>Essential Dependencies Only: Struts 2核心库。<br>All Dependencies: Struts 2依赖库。<br>Documentation: Struts 2文档。<br>Source: Struts 2源码。</p><p>建议下载<code>Full Distribution</code>和<code>Documentation</code>。</p><h4 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h4><p>得到如下结构：<br>apps：实例应用。<br>docs：文档资料<br>lib：核心类库以及第三方插件类库<br>src：框架源码</p><h4 id="核心配置"><a href="#核心配置" class="headerlink" title="核心配置"></a>核心配置</h4><p>打开项目的Web.xml配置文件，配置Struts 2的核心Filter：</p><pre><code>&lt;code class=&quot;xml&quot;&gt;  &lt;filter&gt;        &lt;filter-name&gt;struts2&lt;/filter-name&gt;        &lt;filter-class&gt;org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter&lt;/filter-class&gt;    &lt;/filter&gt;    &lt;!-- 让Struts 2的核心Filter拦截所有请求 --&gt;    &lt;filter-mapping&gt;        &lt;filter-name&gt;struts2&lt;/filter-name&gt;        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;    &lt;/filter-mapping&gt;</code></pre><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><h4 id="编写页面"><a href="#编写页面" class="headerlink" title="编写页面"></a>编写页面</h4><p>在Eclipse新建个Dynamic Web Project项目。</p><p>导入<code>Struts 2</code>的Jar包到<code>WEB-INF\lib</code>目录下。</p><p>修改<code>WEB-INF\lib</code>目录下的<code>web.xml</code>文件：</p><pre><code>&lt;code class=&quot;xml&quot;&gt;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;web-app xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot; xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot; id=&quot;WebApp_ID&quot; version=&quot;3.1&quot;&gt;  &lt;display-name&gt;MyWeb&lt;/display-name&gt;  &lt;welcome-file-list&gt;    &lt;welcome-file&gt;index.html&lt;/welcome-file&gt;    &lt;welcome-file&gt;index.htm&lt;/welcome-file&gt;    &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;    &lt;welcome-file&gt;default.html&lt;/welcome-file&gt;    &lt;welcome-file&gt;default.htm&lt;/welcome-file&gt;    &lt;welcome-file&gt;default.jsp&lt;/welcome-file&gt;  &lt;/welcome-file-list&gt;  &lt;filter&gt;        &lt;filter-name&gt;struts2&lt;/filter-name&gt;        &lt;filter-class&gt;org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter&lt;/filter-class&gt;    &lt;/filter&gt;    &lt;!-- 让Struts 2的核心Filter拦截所有请求 --&gt;    &lt;filter-mapping&gt;        &lt;filter-name&gt;struts2&lt;/filter-name&gt;        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;    &lt;/filter-mapping&gt;&lt;/web-app&gt;</code></pre><p>在<code>WEB-INF\content</code>目录下编写文件<code>login,jsp</code>：</p><pre><code>&lt;code class=&quot;jsp&quot;&gt;&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;    pageEncoding=&quot;UTF-8&quot;%&gt;&lt;%@taglib prefix=&quot;s&quot; uri=&quot;/struts-tags&quot;%&gt;&lt;!DOCTYPE&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;&lt;title&gt;&lt;s:text name=&quot;loginPage&quot;/&gt;&lt;/title&gt;&lt;s:form action=&quot;login&quot;&gt;    &lt;s:textfield name=&quot;username&quot; key=&quot;user&quot;/&gt;    &lt;s:textfield name=&quot;password&quot; key=&quot;pass&quot;/&gt;    &lt;s:submit key=&quot;login&quot;/&gt;&lt;/s:form&gt;</code></pre><p><code>welcome.jsp</code></p><pre><code>&lt;code class=&quot;jsp&quot;&gt;&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;    pageEncoding=&quot;UTF-8&quot;%&gt;&lt;%@taglib prefix=&quot;s&quot; uri=&quot;/struts-tags&quot;%&gt;&lt;!DOCTYPE&gt;    &lt;title&gt;&lt;s:text name=&quot;succPage&quot;/&gt;&lt;/title&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;    &lt;s:text name=&quot;succTip&quot;&gt;        &lt;s:param&gt;${sessionScope.user}&lt;/s:param&gt;    &lt;/s:text&gt;&lt;br/&gt;</code></pre><p><code>error.jsp</code></p><pre><code>&lt;code class=&quot;jsp&quot;&gt;&lt;%@page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;    pageEncoding=&quot;UTF-8&quot;%&gt;&lt;%@taglib prefix=&quot;s&quot; uri=&quot;/struts-tags&quot;%&gt;&lt;!DOCTYPE&gt;    &lt;title&gt;&lt;s:text name=&quot;errorPage&quot;/&gt;&lt;/title&gt;    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;    &lt;s:text name=&quot;failTip&quot;/&gt;</code></pre><h4 id="添加struts-2配置文件"><a href="#添加struts-2配置文件" class="headerlink" title="添加struts 2配置文件"></a>添加struts 2配置文件</h4><p>在Web应用类加载路径下添加struts.xml文件：</p><pre><code>&lt;code class=&quot;xml&quot;&gt;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;struts&gt;    &lt;!-- 指定全局国际化资源文件 --&gt;    &lt;constant name=&quot;struts.custom.i18n.resources&quot; value=&quot;mess&quot;/&gt;    &lt;constant name=&quot;struts.enable.DynamicMethodInvocation&quot; value=&quot;false&quot;/&gt;    &lt;constant name=&quot;struts.devMode&quot; value=&quot;true&quot; /&gt;    &lt;!-- 所有的Action定义都应该放在package下 --&gt;       &lt;package name=&quot;iiong&quot; namespace=&quot;/&quot; extends=&quot;struts-default&quot;&gt;        &lt;action name=&quot;login&quot; class=&quot;com.iiong.app.action.LoginAction&quot;&gt;            &lt;!-- 定义三个逻辑视图和物理资源之间的映射 --&gt;            &lt;result name=&quot;error&quot;&gt;/WEB-INF/content/error.jsp&lt;/result&gt;            &lt;result name=&quot;success&quot;&gt;/WEB-INF/content/welcome.jsp&lt;/result&gt;        &lt;/action&gt;        &lt;action name=&quot;*&quot;&gt;            &lt;result&gt;/WEB-INF/content/{1}.jsp&lt;/result&gt;        &lt;/action&gt;    &lt;/package&gt;&lt;/struts&gt;</code></pre><p>由于开启国际化的支持，需要再写个<code>mess_zh_CN.properties</code>本地化文件</p><pre><code>loginPage=\u767B\u5F55\u9875\u9762errorPage=\u9519\u8BEF\u9875\u9762succPage=\u6210\u529F\u9875\u9762failTip=\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u4E0D\u80FD\u767B\u5F55\uFF01succTip=\u6B22\u8FCE\uFF0C{0},\u60A8\u5DF2\u7ECF\u767B\u5F55\uFF01user=\u7528\u6237\u540Dpass=\u5BC6  \u7801login=\u767B\u5F55</code></pre><p>到这里基本可以，启动Tomcat是否可以访问了。</p><h3 id="编写Action类"><a href="#编写Action类" class="headerlink" title="编写Action类"></a>编写Action类</h3><p>编写登录逻辑，类名<code>LoginAction</code></p><pre><code>&lt;code class=&quot;java&quot;&gt;package com.iiong.app.action;import com.opensymphony.xwork2.ActionContext;import com.opensymphony.xwork2.ActionSupport;/** * Description: * @author JaxsonWang * @version 1.0 */public class LoginAction extends ActionSupport{    // 定义封装请求参数的username和password成员变量    private String username;    private String password;        public String getUsername()    {        return username;    }    public void setUsername(String username)    {        this.username = username;    }       public String getPassword()    {        return password;    }    public void setPassword(String password)    {        this.password = password;    }    // 定义处理用户请求的execute方法    public String execute() throws Exception    {        // 当username为wangjin，password为wangjin时即登录成功        if (getUsername().equals(&quot;wangjin&quot;)            &amp;&amp; getPassword().equals(&quot;wangjin&quot;) )        {            ActionContext.getContext().getSession()                .put(&quot;user&quot; , getUsername());            return SUCCESS;        }        return ERROR;    }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于eval解析JSON数据笔记</title>
      <link href="/eval-parsing-json-data-notes.html"/>
      <url>/eval-parsing-json-data-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>之前做个项目，从服务器返回获取数据data，得到的字符串直接存入本地的localStorage里。真是够我折腾的…</p><p>例如从服务器获取的输入如下：</p><pre><code>&lt;code class=&quot;json&quot;&gt;{    &quot;createtime&quot;: null,    &quot;id&quot;: 1,    &quot;owner&quot;: {        &quot;age&quot;: null,        &quot;birthday&quot;: null    },    &quot;password&quot;: &quot;&quot;,    &quot;role&quot;: null,    &quot;roleid&quot;: null}</code></pre><p>然后存入localStorage：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;localStorage.setItem(&apos;userInfo&apos;,JSON.stringify(data));</code></pre><p>注意，存入数据需要序列化才能得到JSON数据。</p><p>事实上我很天真的以为直接从key获取到它的value…事实上，事件并没有我想象中那么简单。</p><h3 id="摸索"><a href="#摸索" class="headerlink" title="摸索"></a>摸索</h3><p>我就不信邪了…</p><p>于是我就这样玩：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;var info = {&quot;createtime&quot;:null,&quot;id&quot;:1,&quot;owner&quot;:{&quot;age&quot;:null,&quot;birthday&quot;:null},&quot;password&quot;:&quot;&quot;,&quot;role&quot;:null,&quot;roleid&quot;:null}alert(info.createtime);</code></pre><p>事实上执行的确获取到相关的value值;</p><p>但是从</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;var info = localStorage.get(&apos;info&apos;);alert(info);alert(info.createtime);</code></pre><p>从第一个弹窗出现，的确正常的…然而第二个弹窗却是<code>undefined</code>？？这是什么鬼？</p><p>然后可能想到是不是要从Object去获取…但怎么转化呢，百度相关资料，eval()很好用。</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;var info = localStorage.get(&apos;info&apos;);var Obj=eval(&quot;(&quot;+info+&quot;)&quot;);alert(info);alert(info.createtime);</code></pre><p>的确可以了。至于为啥加圆括号：</p><p>eval本身的问题。 由于json是以”{}”的方式来开始以及结束的，在JS中，它会被当成一个语句块来处理，所以必须强制性的将它转换成一种表达式。</p><p>加上圆括号的目的是迫使eval函数在处理JavaScript代码的时候强制将括号内的表达式（expression）转化为对象，而不是作为语句（statement）来执行。举一个例子，例如对象字面量{}，如若不加外层的括号，那么eval会将大括号识别为JavaScript代码块的开始和结束标记，那么{}将会被认为是执行了一句空语句。所以下面两个执行结果是不同的：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;alert(eval(&quot;{}&quot;); // return undefined alert(eval(&quot;({})&quot;);// return object[Object]</code></pre><p>对于这种写法，在JS中，可以到处看到。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MUI返回上一页并且刷新页面</title>
      <link href="/mui-note-1.html"/>
      <url>/mui-note-1.html</url>
      
        <content type="html"><![CDATA[<p>由于业务需求，比如在本页添加评论，返回上一页需要刷新数据，业务代码如下： A页面： 需要给当前页面定义一个页面ID</p><pre><code>mui.init({        subpages:[{            id: &apos;yellowPageDetails&apos;//子页面标志    }]    });</code></pre><p>B页面：</p><pre><code>mui.plusReady(function(){        var self=plus.webview.currentWebview();        console.log(JSON.stringify(self));        var old_back = mui.back;        mui.back = function() {            var wobj = plus.webview.getWebviewById(&quot;yellowPageDetails&quot;);//yellowPageDetails是返回上一页的id            wobj.reload(true);            old_back()        }    });</code></pre><p>B页面调用的是H5+函数，必须在真机环境下测试，浏览器会报<code>plus</code>错误!</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web前端 </tag>
            
            <tag> MUI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小米5S Plus Lineage OS 14.1</title>
      <link href="/mi5s-plus-lineageos-14-1.html"/>
      <url>/mi5s-plus-lineageos-14-1.html</url>
      
        <content type="html"><![CDATA[<p>来自<a href="https://forum.xda-developers.com/mi-5s/how-to/rom-lineage-os-unofficiel-mi5s-plus-t3543610" target="_blank" rel="noopener">xda论坛@JesseWhiteMan</a></p><p>感谢作者的作品！</p><h3 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h3><p>ROM 2017.02.20更新：<a href="https://mega.nz/#!yU1RyZzS!WG9XEq95s962YwpSF4T3i3DHuCbbXfWr1V_pzO6enUA" target="_blank" rel="noopener">lineage-14.1-20170220-UNOFFICIAL-natrium.zip</a></p><p>修复声音和相机补丁： <a href="https://drive.google.com/file/d/0BybzA4rRr2V5SWNDZVBjdkplV2c/view" target="_blank" rel="noopener">谷歌网盘</a></p><p>先刷入ROM在刷补丁。</p><p>目前还存在的bug：</p><p>No led light on menu button;菜单按钮LED不亮<br>Fingerprint;指纹不工作</p><h3 id="其他作品"><a href="#其他作品" class="headerlink" title="其他作品"></a>其他作品</h3><p><a href="https://www.androidfilehost.com/?fid=817550096634749607" target="_blank" rel="noopener">RRemix mi5s Plus</a></p><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>目前官方不开放device源码，编译ROM路上只能慢慢摸索了。</p><p>目前有个计划去编译LOS14.1，容我先去做个准备吧。</p><p>打包狗请离滚！</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>EMD Vol 1702</title>
      <link href="/emd-vol-1702.html"/>
      <url>/emd-vol-1702.html</url>
      
        <content type="html"><![CDATA[<h3 id="2017-02-22"><a href="#2017-02-22" class="headerlink" title="2017.02.22"></a>2017.02.22</h3><p>一个月，又这样过来了~</p><h3 id="家事"><a href="#家事" class="headerlink" title="家事"></a>家事</h3><p>也没啥事了，和家里的人关系一般吧，现在和母亲的关系可有可无，可说出这句话的时候，感觉挺悲哀的，也就无需多说了。</p><p>至于父亲更不用说了，现在估计懒得管我了。</p><p>然后发现这几天雨下得有点大，早上起来发现二楼的阳台的居然漏水了，看来有空得找人修下，真是要习惯去管理着柴米油田的生活琐事。</p><h4 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h4><p>今天刚和公司签了合同，嗯，很开心，毕竟俩个月就转正了，很开心咯。</p><p>其次在公司做的项目目前来看，问题还好吧，没多少大问题。</p><p>和同事们相处很好，一切都好。</p><h3 id="学习"><a href="#学习" class="headerlink" title="学习"></a>学习</h3><p>上个星期买个一本《JavaScript版权指南》犀牛书，大致浏览下，很不错。但是目前所有精力全部转到复习Java Web开发。</p><p>很早就动了想复习Java Web开发的计划想法，一直忙着做其他事情。可不是帮了妹纸忙，终于要复习了。</p><p>趁着每天下班回来，看一小章节，记个笔记，敲下实例就行了，贪多嚼不烂。</p><h3 id="想法"><a href="#想法" class="headerlink" title="想法"></a>想法</h3><p>之前有个朋友推荐一首赵雷的歌曲《理想》，第一次听，的确没啥感觉。有次骑车回来，听着歌回想过去的事，不知不觉流泪。</p><p>回想过去五年，我没有抛弃自己，也没有抛弃理想，正如歌中所唱，是理想支撑到我现在，现在我离理想越来越近。</p><p>致理想！</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>关于JavaScript的new的理解</title>
      <link href="/the-new-is-explained-in-javascript-html.html"/>
      <url>/the-new-is-explained-in-javascript-html.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>大部分讲 new 的文章会从面向对象的思路讲起，但是我始终认为，在解释一个事物的时候，不应该引入另一个更复杂的事物。</p><p>今天我从「省代码」的角度来讲 new。</p><p>想象我们在制作一个策略类战争游戏，玩家可以操作一堆士兵攻击敌方。</p><p>我们着重来研究一下这个游戏里面的「制造士兵」环节。</p><p>一个士兵的在计算机里就是一堆属性，如下图：</p><p>我们只需要这样就可以制造一个士兵：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;var 士兵 = {  ID: 1, // 用于区分每个士兵  兵种:&quot;美国大兵&quot;,  攻击力:5,  生命值:42,   行走:function(){ /*走俩步的代码*/},  奔跑:function(){ /*狂奔的代码*/  },  死亡:function(){ /*Go die*/    },  攻击:function(){ /*糊他熊脸*/   },  防御:function(){ /*护脸*/       }}兵营.制造(士兵)</code></pre><h3 id="制造一百个士兵"><a href="#制造一百个士兵" class="headerlink" title="制造一百个士兵"></a>制造一百个士兵</h3><p>如果需要制造 100 个士兵怎么办呢？</p><p>循环 100 次吧：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;var 士兵们 = []var 士兵for(var i=0; i&lt;100; i++){  士兵 = {    ID: i, // ID 不能重复    兵种:&quot;美国大兵&quot;,    攻击力:5,    生命值:42,     行走:function(){ /*走俩步的代码*/}，    奔跑:function(){ /*狂奔的代码*/  },    死亡:function(){ /*Go die*/    },    攻击:function(){ /*糊他熊脸*/   },    防御:function(){ /*护脸*/       }  }  士兵们.push(士兵)}兵营.批量制造(士兵们)</code></pre><p>哎呀好简单。</p><h3 id="质疑"><a href="#质疑" class="headerlink" title="质疑"></a>质疑</h3><p>上面的代码存在一个问题：浪费了很多内存。</p><ol><li>行走、奔跑、死亡、攻击、防御这五个动作对于每个士兵其实是一样的，只需要各自引用同一个函数就可以了，没必要重复创建 100 个行走、100个奔跑……</li><li>这些士兵的兵种和攻击力都是一样的，没必要创建 100 次。</li><li>只有 ID 和生命值需要创建 100 次，因为每个士兵有自己的 ID 和生命值。</li></ol><h3 id="改进"><a href="#改进" class="headerlink" title="改进"></a>改进</h3><p>看过我们的专栏以前文章（<a href="https://zhuanlan.zhihu.com/p/23090041?refer=study-fe" target="_blank" rel="noopener">JS 原型链</a>）的同学肯定知道，用原型链可以解决重复创建的问题：我们先创建一个「士兵原型」，然后让「士兵」的 <strong>proto</strong> 指向「士兵原型」</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;var 士兵原型 = {  兵种:&quot;美国大兵&quot;,  攻击力:5,  行走:function(){ /*走俩步的代码*/}，  奔跑:function(){ /*狂奔的代码*/  },  死亡:function(){ /*Go die*/    },  攻击:function(){ /*糊他熊脸*/   },  防御:function(){ /*护脸*/       }}var 士兵们 = []var 士兵for(var i=0; i&lt;100; i++){  士兵 = {    ID: i, // ID 不能重复    生命值:42  }  /*实际工作中不要这样写，因为 __proto__ 不是标准属性*/  士兵.__proto__ = 士兵原型   士兵们.push(士兵)}兵营.批量制造(士兵们)</code></pre><h3 id="优雅？"><a href="#优雅？" class="headerlink" title="优雅？"></a>优雅？</h3><p>有人指出创建一个士兵的代码分散在两个地方很不优雅，于是我们用一个函数把这两部分联系起来：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;function 士兵(ID){  var 临时对象 = {}  临时对象.__proto__ = 士兵.原型  临时对象.ID = ID  临时对象.生命值 = 42  return 临时对象}士兵.原型 = {  兵种:&quot;美国大兵&quot;,  攻击力:5,  行走:function(){ /*走俩步的代码*/}，  奔跑:function(){ /*狂奔的代码*/  },  死亡:function(){ /*Go die*/    },  攻击:function(){ /*糊他熊脸*/   },  防御:function(){ /*护脸*/       }}// 保存为文件：士兵.js</code></pre><p>然后就可以愉快地引用「士兵」来创建士兵了：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;var 士兵们 = []for(var i=0; i&lt;100; i++){  士兵们.push(士兵(i))}兵营.批量制造(士兵们)</code></pre><h3 id="JS-之父的关怀"><a href="#JS-之父的关怀" class="headerlink" title="JS 之父的关怀"></a>JS 之父的关怀</h3><p>JS 之父创建了 new 关键字，可以让我们少写几行代码：</p><p>只要你在士兵前面使用 new 关键字，那么可以少做四件事情：</p><ol><li>不用创建临时对象，因为 new 会帮你做（<strong>你使用「this」就可以访问到临时对象</strong>）；</li><li>不用绑定原型，因为 new 会帮你做（new 为了知道原型在哪，所以指定原型的名字为 prototype）；</li><li>不用 return 临时对象，因为 new 会帮你做；</li><li>不要给原型想名字了，因为 new 指定名字为 prototype。</li></ol><h3 id="这一次我们用-new-来写"><a href="#这一次我们用-new-来写" class="headerlink" title="这一次我们用 new 来写"></a>这一次我们用 new 来写</h3><pre><code>&lt;code class=&quot;javascript&quot;&gt;function 士兵(ID){  this.ID = ID  this.生命值 = 42}士兵.prototype = {  兵种:&quot;美国大兵&quot;,  攻击力:5,  行走:function(){ /*走俩步的代码*/},  奔跑:function(){ /*狂奔的代码*/  },  死亡:function(){ /*Go die*/    },  攻击:function(){ /*糊他熊脸*/   },  防御:function(){ /*护脸*/       }}// 保存为文件：士兵.js</code></pre><p>然后是创建士兵（加了一个 new 关键字）：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;var 士兵们 = []for(var i=0; i&lt;100; i++){  士兵们.push(new 士兵(i))}兵营.批量制造(士兵们)</code></pre><p><strong>new 的作用，就是省那么几行代码。（也就是所谓的语法糖）</strong></p><h3 id="注意-constructor-属性"><a href="#注意-constructor-属性" class="headerlink" title="注意 constructor 属性"></a>注意 constructor 属性</h3><p>new 操作为了记录「临时对象是由哪个函数创建的」，所以预先给「士兵.prototype」加了一个 constructor 属性：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;士兵.prototype = {  constructor: 士兵}</code></pre><p>如果你重新对「士兵.prototype」赋值，那么这个 constructor 属性就没了，所以你应该这么写：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;士兵.prototype.兵种 = &quot;美国大兵&quot;士兵.prototype.攻击力 = 5士兵.prototype.行走 = function(){ /*走俩步的代码*/}士兵.prototype.奔跑 = function(){ /*狂奔的代码*/  }士兵.prototype.死亡 = function(){ /*Go die*/    }士兵.prototype.攻击 = function(){ /*糊他熊脸*/   }士兵.prototype.防御 = function(){ /*护脸*/       }</code></pre><p>或者你也可以自己给 constructor 重新赋值：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;士兵.prototype = {  constructor: 士兵,  兵种:&quot;美国大兵&quot;,  攻击力:5,  行走:function(){ /*走俩步的代码*/},  奔跑:function(){ /*狂奔的代码*/  },  死亡:function(){ /*Go die*/    },  攻击:function(){ /*糊他熊脸*/   },  防御:function(){ /*护脸*/       }}</code></pre><hr><p>本文转自<a href="https://zhuanlan.zhihu.com/p/23987456" target="_blank" rel="noopener">知乎专栏</a></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于JavaScript的this的值解释</title>
      <link href="/the-this-value-is-explained-in-javascript.html"/>
      <url>/the-this-value-is-explained-in-javascript.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>你可能遇到过这样的 JS 面试题：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;var obj = {  foo: function(){    console.log(this)  }}var bar = obj.fooobj.foo() // 打印出的 this 是 objbar() // 打印出的 this 是 window</code></pre><p>请解释最后两行函数的值为什么不一样。</p><h3 id="函数调用"><a href="#函数调用" class="headerlink" title="函数调用"></a>函数调用</h3><p>首先需要从函数的调用开始讲起。</p><p>JS（ES5）里面有三种函数调用形式：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;func(p1, p2) obj.child.method(p1, p2)func.call(context, p1, p2) // 先不讲 apply</code></pre><p>一般，初学者都知道前两种形式，而且认为前两种形式「优于」第三种形式。<br>从看到这篇文章起，你一定要记住，第三种调用形式，才是正常调用形式：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;func.call(context, p1, p2)</code></pre><p>其他两种都是语法糖，可以等价地变为 call 形式：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;func(p1, p2) 等价于func.call(undefined, p1, p2)obj.child.method(p1, p2) 等价于obj.child.method.call(obj.child, p1, p2)</code></pre><p>请记下来。（我们称此代码为「转换代码」，方便下文引用）</p><p>至此我们的函数调用只有一种形式：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;func.call(context, p1, p2)</code></pre><h3 id="这样，this-就好解释了"><a href="#这样，this-就好解释了" class="headerlink" title="这样，this 就好解释了"></a>这样，this 就好解释了</h3><p>this，就是上面代码中的 context。就这么简单。</p><p>this 是你 call 一个函数时传的 context，由于你从来不用 call 形式的函数调用，所以你一直不知道。</p><hr><p><strong>先看 func(p1, p2) 中的 this 如何确定：</strong></p><p>当你写下面代码时</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;function func(){  console.log(this)}func()</code></pre><p>等价于</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;function func(){  console.log(this)}func.call(undefined) // 可以简写为 func.call()</code></pre><p>按理说打印出来的 this 应该就是 undefined 了吧，但是浏览器里有一条规则：</p><p>如果你传的 context 就 null 或者 undefined，那么 window 对象就是默认的 context（严格模式下默认 context 是 undefined）<br>因此上面的打印结果是 window。</p><p>如果你希望这里的 this 不是 window，很简单：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;func.call(obj) // 那么里面的 this 就是 obj 对象了</code></pre><hr><p><strong>再看 obj.child.method(p1, p2) 的 this 如何确定</strong></p><pre><code>&lt;code class=&quot;javascript&quot;&gt;var obj = {  foo: function(){    console.log(this)  }}obj.foo()</code></pre><p>按照「转换代码」，我们将 obj.foo() 转换为</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;obj.foo.call(obj)</code></pre><p>好了，this 就是 obj。搞定。</p><p>回到题目：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;var obj = {  foo: function(){    console.log(this)  }}var bar = obj.fooobj.foo() // 转换为 obj.foo.call(obj)，this 就是 objbar() // 转换为 bar.call()// 由于没有传 context// 所以 this 就是 undefined// 最后浏览器给你一个默认的 this —— window 对象</code></pre><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ol><li>this 就是你 call 一个函数时，传入的 context。</li><li>如果你的函数调用形式不是 call 形式，请按照「转换代码」将其转换为 call 形式。</li></ol><hr><p>本文转自<a href="https://zhuanlan.zhihu.com/p/23804247" target="_blank" rel="noopener">知乎专栏</a></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mimelove修改记录</title>
      <link href="/mimelove-notes.html"/>
      <url>/mimelove-notes.html</url>
      
        <content type="html"><![CDATA[<p>本书主题有几个地方不是太满意，于是进行魔改，记录下来。</p><p>部分代码由<a href="//macbolo.com">@macbolo</a>站长提供，感谢！</p><blockquote><p>media.php：</p></blockquote><pre><code>&lt;code class=&quot;php&quot;&gt;function mimelove_enqueue_scripts() { // Customized bootstrap for the theme. //wp_enqueue_style( &apos;bootstrap&apos;, get_template_directory_uri() . &apos;/css/bootstrap.css&apos;, &apos;&apos;, &apos;3.3.5&apos; );    wp_enqueue_style( &apos;bootstrap&apos;,&apos;//cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css&apos;, &apos;3.3.7&apos; ); // Theme style //wp_enqueue_style( &apos;mimelove&apos;, get_stylesheet_uri(), array() , filemtime(get_stylesheet_directory().&apos;/style.css&apos;));    wp_enqueue_style( &apos;mimelove&apos;, &apos;//res.i95.me/mimelove/style.css&apos;); // Scripts    wp_enqueue_script( &apos;jqueryjs&apos;, &apos;//cdn.bootcss.com/jquery/1.12.4/jquery.min.js&apos;, array(), true );    wp_enqueue_script( &apos;jquery-migrate-js&apos;,&apos;//cdn.bootcss.com/jquery-migrate/1.4.1/jquery-migrate.min.js&apos;,array(),true); //wp_enqueue_script( &apos;mimelove&apos;, get_template_directory_uri() . &apos;/js/script.js&apos;, array( &apos;jquery&apos; ), &apos;&apos;, true );    wp_enqueue_script( &apos;mimelove&apos;, &apos;//res.i95.me/mimelove/script.js&apos;, array(), true ); // zoom //wp_enqueue_script( &apos;zoom&apos;, get_template_directory_uri() . &apos;/js/zoom.min.js&apos;, array(), true ); wp_enqueue_script( &apos;zoom&apos;, &apos;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/zoom.min.js&apos;, array(), true ); if ( is_singular() &amp;&amp; get_option( &apos;thread_comments&apos; ) &amp;&amp; comments_open() ) {  wp_enqueue_script( &apos;comment-reply&apos; ); }}</code></pre><blockquote><p>ajax-comment.php：</p></blockquote><pre><code>wp_enqueue_script( &apos;ajax-comment&apos;, &apos;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/ajax-comment.js&apos;, array(), AC_VERSION , true );</code></pre><blockquote><p>about.php：</p></blockquote><pre><code>&lt;code class=&quot;php&quot;&gt;public function admin_scripts() {  //wp_enqueue_style( &apos;mimelove-widget-image&apos;, get_template_directory_uri() . &apos;/css/widget-image.css&apos; );        wp_enqueue_style( &apos;mimelove-widget-image&apos;, &apos;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/widget-image.css&apos; );  wp_enqueue_media();  wp_enqueue_script( &apos;mimelove-widget-image&apos;,&apos;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/widget-image.js&apos;, array(   &apos;jquery&apos;,   &apos;media-upload&apos;,   &apos;media-views&apos;  ), &apos;&apos;, true );  wp_localize_script( &apos;mimelove-widget-image&apos;, &apos;MiMeLoveWidgetImage&apos;, array(   &apos;title&apos; =&gt; esc_html__( &apos;选择一张图片&apos;, &apos;mimelove&apos; ),   &apos;button&apos; =&gt; esc_html__( &apos;插入小部件&apos;, &apos;mimelove&apos; ),  ) ); }</code></pre><blockquote><p>\template-parts\content-single.php修改：</p></blockquote><p><code>&lt;footer class=&quot;entry-footer&quot;&gt;</code>下面添加：</p><pre><code>&lt;code class=&quot;html&quot;&gt;&lt;div class=&quot;creative-commons&quot;&gt;            &lt;p&gt;文章最后编辑时间为: &lt;?php the_modified_time(&apos;Y/n/j H:m&apos;); ?&gt;&lt;/p&gt;            &lt;p&gt;本文由 &lt;a href=&quot;&lt;?php echo home_url(); ?&gt;&quot; &gt;&lt;?php the_author_nickname(); ?&gt;&lt;/a&gt; 创作，采用 &lt;a href=&quot;https://creativecommons.org/licenses/by/4.0/deed.zh&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;知识共享署名 4.0&lt;/a&gt;国际许可协议进行许可&lt;/p&gt;            &lt;p&gt;可自由转载、引用，但需署名作者且注明文章出处&lt;/p&gt;        &lt;/div&gt;</code></pre><p>样式：</p><pre><code>&lt;code class=&quot;css&quot;&gt;/*分享协议*/.creative-commons {    font-size: 13px;    color: #999;    border: 1px solid #eee;    padding: 2px;}.creative-commons a{    color: #42b983;}.creative-commons p{    margin-top: 2px;    margin-bottom: 2px;    text-align: center;}.creative-commons a:hover{    color: #ff6d6d;}</code></pre><blockquote><p>footer.php：</p></blockquote><pre><code>&lt;code class=&quot;php&quot;&gt;&lt;div class=&quot;credit&quot;&gt;   &lt;?php   echo wp_kses_post( sprintf(      __( &apos;Copyright © %s %s / Theme by %s&apos;, &apos;mimelove&apos; ),      date_i18n( __( &apos;Y&apos;, &apos;mimelove&apos; ) ),      &apos;&lt;a href=&quot;&apos; . esc_url( home_url( &apos;/&apos; ) ) . &apos;&quot; rel=&quot;home&quot;&gt;&apos; . esc_html( get_bloginfo( &apos;name&apos; ) ) . &apos;&lt;/a&gt;&apos;,                 &apos;&lt;a href=&quot;https://mrju.cn/&quot; rel=&quot;nofollow&quot; target=&quot;_blank&quot;&gt;MrJu&lt;/a&gt;&apos;   ) );   ?&gt;   &lt;?php if( get_option(&apos;mimelove_icp&apos;) ){ ?&gt;      &lt;?php esc_html_e( &apos; / &apos;, &apos;mimelove&apos; ); ?&gt;                 &lt;a target=&quot;_blank&quot; rel=&quot;nofollow&quot; href=&quot;http://www.miitbeian.gov.cn&quot;&gt;&lt;?php echo get_option(&apos;mimelove_icp&apos;); ?&gt;&lt;/a&gt;   &lt;?php } ?&gt;             &lt;?php if( get_option(&apos;mimelove_gaicp&apos;) ){ ?&gt;                 &lt;?php esc_html_e( &apos; / &apos;, &apos;mimelove&apos; ); ?&gt;                 &lt;?php echo get_option(&apos;mimelove_gaicp&apos;); ?&gt;             &lt;?php } ?&gt;   &lt;?php if( get_option(&apos;mimelove_analytics&apos;) ){ ?&gt;      &lt;?php esc_html_e( &apos; / &apos;, &apos;mimelove&apos; ); ?&gt;      &lt;?php echo stripslashes(get_option(&apos;mimelove_analytics&apos;)); ?&gt;   &lt;?php } ?&gt;&lt;/div&gt;&lt;div class=&quot;credit&quot;&gt;   &lt;?php   echo wp_kses_post( sprintf(      __( &apos;Copyright © %s %s / Theme by %s&apos;, &apos;mimelove&apos; ),      date_i18n( __( &apos;Y&apos;, &apos;mimelove&apos; ) ),      &apos;&lt;a href=&quot;&apos; . esc_url( home_url( &apos;/&apos; ) ) . &apos;&quot; rel=&quot;home&quot;&gt;&apos; . esc_html( get_bloginfo( &apos;name&apos; ) ) . &apos;&lt;/a&gt;&apos;,                 &apos;&lt;a href=&quot;https://mrju.cn/&quot; rel=&quot;nofollow&quot; target=&quot;_blank&quot;&gt;MrJu&lt;/a&gt;&apos;   ) );   ?&gt;   &lt;?php if( get_option(&apos;mimelove_icp&apos;) ){ ?&gt;      &lt;?php esc_html_e( &apos; / &apos;, &apos;mimelove&apos; ); ?&gt;                 &lt;a target=&quot;_blank&quot; rel=&quot;nofollow&quot; href=&quot;http://www.miitbeian.gov.cn&quot;&gt;&lt;?php echo get_option(&apos;mimelove_icp&apos;); ?&gt;&lt;/a&gt;   &lt;?php } ?&gt;             &lt;?php if( get_option(&apos;mimelove_gaicp&apos;) ){ ?&gt;                 &lt;?php esc_html_e( &apos; / &apos;, &apos;mimelove&apos; ); ?&gt;                 &lt;?php echo get_option(&apos;mimelove_gaicp&apos;); ?&gt;             &lt;?php } ?&gt;   &lt;?php if( get_option(&apos;mimelove_analytics&apos;) ){ ?&gt;      &lt;?php esc_html_e( &apos; / &apos;, &apos;mimelove&apos; ); ?&gt;      &lt;?php echo stripslashes(get_option(&apos;mimelove_analytics&apos;)); ?&gt;   &lt;?php } ?&gt;&lt;/div&gt;</code></pre><blockquote><p>theme-options.php:</p></blockquote><pre><code>&lt;tr&gt;                            &lt;th&gt;&lt;label for=&quot;gaicp&quot;&gt;公安备案号&lt;/label&gt;&lt;/th&gt;                            &lt;td&gt;&lt;input name=&quot;gaicp&quot; id=&quot;gaicp&quot; class=&quot;regular-text&quot; type=&quot;text&quot; value=&quot;&lt;?php echo get_option(&apos;mimelove_gaicp&apos;); ?&gt;&quot;&gt;&lt;span class=&quot;description&quot;&gt; 例如： 苏公网安备 32010402000100号&lt;/span&gt;&lt;/td&gt;                        &lt;/tr&gt;</code></pre><p><code>加个标识符：mimelove_page：gaicp</code></p><blockquote><p>刪除wp自帶的jquery依賴：<br>mimelove\inc\widgets\about.php<br>mimelove\inc\ajax-comment.php<br>mimelove\inc\media.php</p></blockquote><p>加入jquery：</p><pre><code>//jQuery JavaScriptwp_enqueue_script(&apos;jquery_js&apos;,&apos;//cdn.staticfile.org/jquery/1.12.4/jquery.min.js&apos;,array(),&apos;&apos;,true);</code></pre><blockquote><p>function.php:</p></blockquote><pre><code>//移除wp-embed.min.jsfunction my_deregister_scripts(){   wp_deregister_script( &apos;wp-embed&apos; );}add_action( &apos;wp_footer&apos;, &apos;my_deregister_scripts&apos; );//移除comment-reply.min.jsfunction disable_comment_js(){    wp_deregister_script( &apos;comment-reply&apos; );}add_action(&apos;init&apos;,&apos;disable_comment_js&apos;);</code></pre><blockquote><p>BOOTSTRAP CDN:</p><p>mimelove\inc\media.php:</p></blockquote><pre><code>wp_enqueue_style( &apos;bootstrap&apos;, &apos;//cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css&apos;, &apos;&apos;, &apos;3.3.7&apos; );function.php:// Editor styleadd_editor_style( array(   &apos;//cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css&apos;,   &apos;css/editor-style.css&apos;,) );</code></pre><blockquote><p>ajax-comment.js cdn:<br>ajax-comment.php:</p></blockquote><pre><code>wp_enqueue_script( &apos;ajax-comment&apos;, &apos;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/js/ajax-comment.js&apos;, array(), AC_VERSION , true );</code></pre><blockquote><p>script.js cdn<br>inc/media.php:</p></blockquote><pre><code>wp_enqueue_script( &apos;mimelove&apos;, &apos;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/js/script.js&apos;, array(), &apos;&apos;, true );</code></pre><blockquote><p>zoom cdn<br>inc/media.php</p></blockquote><pre><code>wp_enqueue_script( &apos;mimelove&apos;, &apos;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/js/script.js&apos;, array(), &apos;&apos;, true );</code></pre><blockquote><p>widget-image.js cdn<br>inc/widgets/about.php:</p></blockquote><pre><code>wp_enqueue_script( &apos;mimelove-widget-image&apos;, &apos;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/js/widget-image.js&apos;, array(&apos;media-upload&apos;,media-views&apos;), &apos;&apos;, true );</code></pre><blockquote><p>qiniu cdn upload files support:<br>function.php:</p></blockquote><pre><code>//图片七牛云缓存add_filter(&apos;upload_dir&apos;, &apos;wpjam_custom_upload_dir&apos;);function wpjam_custom_upload_dir($uploads){   $upload_path = &apos;&apos;;   $upload_url_path = get_option(&apos;mimelove_qiniucdn&apos;);   if (empty($upload_path) || &apos;wp-content/uploads&apos; == $upload_path) {      $uploads[&apos;basedir&apos;] = WP_CONTENT_DIR . &apos;/uploads&apos;;   } elseif (0 !== strpos($upload_path, ABSPATH)) {      $uploads[&apos;basedir&apos;] = path_join(ABSPATH, $upload_path);   } else {      $uploads[&apos;basedir&apos;] = $upload_path;   }   $uploads[&apos;path&apos;] = $uploads[&apos;basedir&apos;] . $uploads[&apos;subdir&apos;];   if ($upload_url_path) {      $uploads[&apos;baseurl&apos;] = $upload_url_path;      $uploads[&apos;url&apos;] = $uploads[&apos;baseurl&apos;] . $uploads[&apos;subdir&apos;];   }   return $uploads;}</code></pre><blockquote><p>inc/theme-options.php:</p></blockquote><pre><code>&lt;tr&gt;    &lt;th&gt;&lt;label for=&quot;qiniucdn&quot;&gt;附件七牛CDN&lt;/label&gt;&lt;/th&gt;    &lt;td&gt;&lt;input name=&quot;qiniucdn&quot; id=&quot;qiniucdn&quot; class=&quot;regular-text&quot; type=&quot;text&quot; value=&quot;&lt;?php echo stripslashes(get_option(&apos;mimelove_qiniucdn&apos;)); ?&gt;&quot;/&gt;&lt;span class=&quot;description&quot;&gt;填写格式为 http://你的二级域名（七牛三级域名）/wp-content/uploads&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;</code></pre><blockquote><p>functions.php 函数</p></blockquote><pre><code>&lt;br&gt;&lt;/br&gt;//相册添加灯箱function add_img_zoom( $attr ) {    if (!is_home()) {        $attr[&apos;data-action&apos;] = &apos;zoom&apos;;    }    return $attr;}add_filter( &apos;wp_get_attachment_image_attributes&apos;,&apos;add_img_zoom&apos;, 10, 2 );高亮：inc/media.php:wp_enqueue_style( &apos;my&apos;, &apos;//blogresource.oss-cn-hangzhou.aliyuncs.com/highlight/my.css&apos;);Header.php&lt;script src=&quot;//cdn.bootcss.com/highlight.js/9.9.0/highlight.min.js&quot;&gt;&lt;/script&gt;    &lt;script &gt;hljs.initHighlightingOnLoad();&lt;/script&gt;外链优化：// 评论链接跳转&amp;新窗口打开    function add_redirect_comment_link($text = &apos;&apos;) {        $text = str_replace(&quot;href=&apos;&quot;, &quot;href=&apos;&quot; . get_option(&apos;home&apos;) . &quot;/?r=&quot;, $text);        $text = preg_replace(&apos;/&lt;a (.+?)&gt;/i&apos;, &quot;&lt;a $1 target=&apos;_blank&apos; rel=&apos;nofollow&apos;&gt;&quot;, $text);        return $text;    }    function redirect_comment_link() {        $redirect = $_GET[&apos;r&apos;];        if ($redirect) {            if (strpos($_SERVER[&apos;HTTP_REFERER&apos;], get_option(&apos;home&apos;)) !== false) {                header(&quot;Location: $redirect&quot;);                exit;            } else {                header(&quot;Location: &quot; . bloginfo(&apos;url&apos;) . &quot;/&quot;);                exit;            }        }    }    add_action(&apos;init&apos;, &apos;redirect_comment_link&apos;);    add_filter(&apos;get_comment_author_link&apos;, &apos;add_redirect_comment_link&apos;, 5);    add_filter(&apos;the_content&apos;, &apos;add_redirect_comment_link&apos;, 5); //nofollow文章内容的站外链接</code></pre><blockquote><p>QQ链接格式错误</p></blockquote><p>在template-parts/sidebar-nav.php中把QQ链接空格替换成&amp;</p><p>首页关于我小工具只有设置值才显示</p><p>打开template-parts/sidebar-nav.php，在li标签外加上if语句，比如：</p><pre><code>//注意get_option中的mimelove_qq参数和li标签里的参数一致&lt;?php if( get_option(&apos;mimelove_qq&apos;) ){ ?&gt;    &lt;li&gt;&lt;a href=&quot;tencent://message/?uin=&lt;?php echo get_option(&apos;mimelove_qq&apos;) ?&gt;&amp;Site=QQ交谈&amp;Menu=yes&quot; target=&quot;blank&quot;&gt;&lt;i class=&quot;icon-QQ&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;/li&gt;&lt;?php } ?&gt;</code></pre><p>在404.php添加：</p><pre><code>//WordPress实现自动记录死链地址if (is_404 &amp;&amp; strpos($_SERVER[&apos;HTTP_USER_AGENT&apos;], &apos;Baiduspider&apos;) !== false) {    $fp = fopen(&quot;death.txt&quot;, &quot;a&quot;);//death.txt就是在网站根目录的记录死链的文件，名字可以随意了    flock($fp, LOCK_EX);    fwrite($fp, home_url($_SERVER[&apos;REQUEST_URI&apos;]) . &quot;\n&quot;);    flock($fp, LOCK_UN);    fclose($fp);}</code></pre><p>图片上CDN：</p><blockquote><p>mimelove\template-parts\related-posts.php</p></blockquote><pre><code>&lt;img src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/related-thumbnail.png&quot; alt=&quot;&quot; /&gt;mimelove\functions.php：$thumb_img = &apos;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/thumbnail.png&apos;;mimelove\inc\widgets\recent-posts.php:&lt;img src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/recent-thumbnail.png&quot; alt=&quot;&quot; /&gt;mimelove\template-parts\content.php：&lt;img src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/thumbnail.png&quot; alt=&quot;&quot; /&gt;mimelove\comments.php：&lt;a href=&quot;javascript:grin(\&apos;:?:\&apos;)&quot;      &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_question.gif&quot;  alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:razz:\&apos;)&quot;   &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_razz.gif&quot;      alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:sad:\&apos;)&quot;    &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_sad.gif&quot;       alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:evil:\&apos;)&quot;   &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_evil.gif&quot;      alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:!:\&apos;)&quot;      &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_exclaim.gif&quot;   alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:smile:\&apos;)&quot;  &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_smile.gif&quot;     alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:oops:\&apos;)&quot;   &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_redface.gif&quot;   alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:grin:\&apos;)&quot;   &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_biggrin.gif&quot;   alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:eek:\&apos;)&quot;    &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_surprised.gif&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:shock:\&apos;)&quot;  &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_eek.gif&quot;       alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:???:\&apos;)&quot;    &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_confused.gif&quot;  alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:cool:\&apos;)&quot;   &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_cool.gif&quot;      alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:lol:\&apos;)&quot;    &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_lol.gif&quot;       alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:mad:\&apos;)&quot;    &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_mad.gif&quot;       alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:twisted:\&apos;)&quot;&gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_twisted.gif&quot;   alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:roll:\&apos;)&quot;   &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_rolleyes.gif&quot;  alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:wink:\&apos;)&quot;   &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_wink.gif&quot;      alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:idea:\&apos;)&quot;   &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_idea.gif&quot;      alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:arrow:\&apos;)&quot;  &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_arrow.gif&quot;     alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:neutral:\&apos;)&quot;&gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_neutral.gif&quot;   alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:cry:\&apos;)&quot;    &gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_cry.gif&quot;       alt=&quot;&quot; /&gt;&lt;/a&gt;        &lt;a href=&quot;javascript:grin(\&apos;:mrgreen:\&apos;)&quot;&gt;&lt;img class=&quot;wp-smiley&quot; src=&quot;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/icon_mrgreen.gif&quot;   alt=&quot;&quot; /&gt;&lt;/a&gt;</code></pre><p>functions.php：</p><pre><code>function custom_smilie9s_src($old, $img) {        return &apos;//blogresource.oss-cn-hangzhou.aliyuncs.com/mimelove/images/smilies/&apos; . $img;    }</code></pre><blockquote><p>instagram插件的兼容</p></blockquote><p>打开插件目录下的css文件，删除<code>opacity: 1;</code></p><p>添加主题css样式：</p><pre><code>.sidebar-hide{display:none}</code></pre><p>script.js修改添加</p><pre><code>/**     * Toggle mobile sidebar     */    function toggleMobileSidebar() {        var $body = $( &apos;body&apos; ),            $button = $( &apos;#sidebar-toggle&apos; ),            sidebarClass = &apos;mobile-sidebar-open&apos;;        // Click to show mobile menu        $button.on( clickEvent, function ( e ) {            if ( $body.hasClass( sidebarClass ) ) {                return;            }            e.stopPropagation(); // Do not trigger click event on &apos;.site&apos; below            $body.addClass( sidebarClass );            $button.addClass( &apos;active&apos; );            $(&apos;.mobile-sidebar&apos;).removeClass(&apos;sidebar-hide&apos;);        } );        // When mobile menu is open, click on page content will close it        $( &apos;.site&apos; ).on( clickEvent, function ( e ) {            if ( ! $body.hasClass( sidebarClass ) ) {                return;            }            e.preventDefault();            $body.removeClass( sidebarClass );            $button.removeClass( &apos;active&apos; );            $(&apos;.mobile-sidebar&apos;).addClass(&apos;sidebar-hide&apos;);        } );    }</code></pre><p>mobile-nav.php添加class样式：<code>sidebar-hide</code></p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>封装localStorage库</title>
      <link href="/encapsulates-the-localstorage-library.html"/>
      <url>/encapsulates-the-localstorage-library.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>由于业务所需，自己封装了localStorage JavaScript库。 具体使用看看js文件如何写的：</p><pre><code>/** * Created by JaxsonWang on 2017/2/16. */var _wj = {    isLocalStorage: !!window.localStorage,    set: function (key, value) { //设置缓存        if (this.isLocalStorage) {            window.localStorage.setItem(key, value);        } else {            var expireDays = 365; //失效时间            var exDate = new Date();            exDate.setTime(exDate.getTime() + expireDays * 24 * 60 * 60 * 1000);            document.cookie = key + &quot;=&quot; + escape(value) + &quot;;expires=&quot; + exDate.toGMTString();        }    },    read: function (key) { //读取缓存        if (this.isLocalStorage) {            return window.localStorage.getItem(key);        } else {            var arr, reg = new RegExp(&quot;(^| )&quot; + key + &quot;=([^;]*)(;|$)&quot;);            if (arr = document.cookie.match(reg)) {                return unescape(arr[2]);            } else {                return null;            }        }    },    del: function (key) { //删除缓存        if (this.isLocalStorage) {            localStorage.removeItem(key);        } else {            var exDate = new Date();            exDate.setTime(exDate.getTime() - 1);            var read_val = this.read(key);            if (read_val != null) document.cookie = key + &quot;=&quot; + read_val + &quot;;expires=&quot; + exDate.toGMTString();        }    }};</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>三个CSS新特性</title>
      <link href="/3-new-css-notes.html"/>
      <url>/3-new-css-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>本文内容来自：<a href="https://bitsofco.de/3-new-css-features-to-learn-in-2017/" target="_blank" rel="noopener">3 New CSS Features to Learn in 2017</a></p><p>正如标题说到，新的一年，我们也要学新的东西，加油！</p><h3 id="Feature-Queries（特性查询）"><a href="#Feature-Queries（特性查询）" class="headerlink" title="Feature Queries（特性查询）"></a>Feature Queries（特性查询）</h3><p>此属性目前所有主流浏览器都支持特征查询（包括Opera Mini），IE浏览器除外。</p><p>Feature Queries，使用<code>@supports</code>规则，允许我们在它的条件区域内写入CSS规则，只有当当前的用户浏览器支持某个CSS属性-值对的时候，该CSS代码块才会生效。</p><p>举一个简单的例子，下面的代码中，只有当浏览器支持<code>display: flex</code>的时候才会应用<code>Flexbox</code>样式。</p><pre><code>&lt;code class=&quot;css&quot;&gt;@supports ( display: flex ) {    .foo {        display: flex;    }}</code></pre><p>另外也可以使用一些操作符，比如<code>and</code>与<code>not</code>，我们就可以创建更复杂的特征查询。例如，我们可以识别一个浏览器是否支持老版本的Flexbox语法。</p><pre><code>&lt;code class=&quot;css&quot;&gt;@supports (display: flexbox) and ( not (display: flex)) {    .foo {        display: flexbox;    }}</code></pre><p>Feature Queries同样支持Javascript接口：<code>CSS.supports()</code>，同样使用上面的例子，看下如何使用：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;if ( CSS.supports( &apos;(display: flex)&apos; ) ) {    console.log( &apos;支持flex&apos; )} else {    console.log( &apos;不支持flex&apos; )}if ( CSS.supports( &apos;(display: flexbox)&apos; ) ) {    console.log( &apos;支持flexbox&apos; )} else {    console.log( &apos;不支持flexbox&apos; )}</code></pre><h3 id="Grid-Layout（栅格布局）"><a href="#Grid-Layout（栅格布局）" class="headerlink" title="Grid Layout（栅格布局）"></a>Grid Layout（栅格布局）</h3><p>CSS栅格布局模块定义了一个创建以网格为基础的布局系统。这和弹性盒布局模块相似，但栅格布局是专门为页面布局设计，因此有很多不同的特性。</p><p>一个栅格系统是由栅格容器（<code>Grid Containe</code>，由<code>display: grid</code>创建）、栅格项（<code>Grid Item</code>）组成。在我们的CSS中，我们可以很容易且明确的组织布局以及栅格项的顺序、与标记中的布局相独立。<br>例如，我在用CSS栅格进行圣杯布局一文中如何使用栅格布局模块创建圣杯布局。</p><p><img src="https://res.i95.me/wp-content/uploads/2017/02/201702163859-1.gif" alt></p><blockquote><p>HTML</p></blockquote><pre><code>&lt;code class=&quot;html&quot;&gt;&lt;body class=&quot;hg&quot;&gt;    &lt;header class=&quot;hg__header&quot;&gt;Title&lt;/header&gt;    &lt;main class=&quot;hg__main&quot;&gt;Content&lt;/main&gt;    &lt;aside class=&quot;hg__left&quot;&gt;Menu&lt;/aside&gt;    &lt;aside class=&quot;hg__right&quot;&gt;Ads&lt;/aside&gt;    &lt;footer class=&quot;hg__footer&quot;&gt;Footer&lt;/footer&gt;&lt;code class=&quot;css&quot;&gt;.hg__header{grid-area:header;}.hg__footer{grid-area:footer;}.hg__main{grid-area:main;}.hg__left{grid-area:navigation;}.hg__right{grid-area:ads;}.hg{display:grid;grid-template-areas:&quot;header header header&quot; &quot;navigation main ads&quot; &quot;footer footer footer&quot;;grid-template-columns:150px 1fr 150px;grid-template-rows:100px 1fr 30px;min-height:100vh;}@media screen and (max-width:600px){.hg{grid-template-areas:&quot;header&quot; &quot;navigation&quot; &quot;main&quot; &quot;ads&quot; &quot;footer&quot;;grid-template-columns:100%;grid-template-rows:100px 50px 1fr 50px 30px;}}</code></pre><p>CSS栅格模块介绍了一个新的长度单位：<code>fr单元</code>，它表示在栅格容器中剩余的空间部分。</p><p>我们就可以通过栅格容器的可用空间来分配栅格项的高度与宽度。例如，在圣杯布局中，我想让main容器占满除两边容器之外的所有空间，为了实现这个效果，只需写如下一句代码：</p><pre><code>&lt;code class=&quot;css&quot;&gt;.hg {    grid-template-columns: 150px 1fr 150px;}</code></pre><p>我们可以专门定义栅格布局中元素间的空隙，<code>grid-row-gap</code>、<code>grid-column-gap</code>以及<code>grid-gap</code>属性可以完成这项工作，这些属性接受一个<code>&lt;length-percentage&gt;</code>百分比数据类型作为值，与内容区域的尺寸对应的百分比。<br>例如，有5%的空隙，可以这样写：</p><pre><code>&lt;code class=&quot;css&quot;&gt;.hg {    display: grid;    grid-column-gap: 5%;}</code></pre><h3 id="Native-Variables"><a href="#Native-Variables" class="headerlink" title="Native Variables"></a>Native Variables</h3><p>该模块介绍了创建用户自定义变量的方法，可以给一个CSS属性分配一个变量。<br>例如，如果我有一个主题色，这个主题色被用在了好几个地方，这时候，就可以抽象这个主题色到一个变量中，并且在使用的时候引用这个变量，这样比把这个颜色写到多个地方更容易维护。</p><pre><code>&lt;code class=&quot;css&quot;&gt;:root {    --theme-colour: cornflowerblue;}h1 {    color: var(--theme-colour);}a {    color: var(--theme-colour);}strong {    color: var(--theme-colour);}</code></pre><p>这种效果在之前我们一般借助CSS预处理器来实现，比如SASS，但是CSS变量有个优点就是一直存在于浏览器中。这意味着这些变量值可以在线修改。例如，为了更新–theme-colour属性值，可以通过如下方式：</p><pre><code>&lt;code class=&quot;css&quot;&gt;const rootEl = document.documentElement; rootEl.style.setProperty(&apos;--theme-colour&apos;, &apos;plum&apos;);</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSS3弹性盒布局</title>
      <link href="/css3-elastic-box-layout.html"/>
      <url>/css3-elastic-box-layout.html</url>
      
        <content type="html"><![CDATA[<h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>在定义方面来说，弹性布局是指通过调整其内元素的宽高，从而在任何显示设备上实现对可用显示空间最佳填充的能力。弹性容器扩展其内元素来填充可用空间，或将其收缩来避免溢出。</p><p>块级布局更侧重于垂直方向、行内布局更侧重于水平方向，与此相对的，弹性盒子布局算法是方向无关的。虽然块级布局对于单独一个页面来说是行之有效的，但其仍缺乏足够的定义来支持那些必须随用户代理(user agent)不同或设备方向从水平转为垂直等各种变化而变换方向、调整大小、拉伸、收缩的应用程序组件。 弹性盒子布局主要适用于应用程序的组件及小规模的布局，而（新兴的）栅格布局则针对大规模的布局。这二者都是 CSS 工作组为在不同用户代理、不同书写模式和其他灵活性要求下的网页应用程序有更好的互操作性而做出的更广泛的努力的一部分。</p><p>来源：<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Flexible_Box_Layout/Using_CSS_flexible_boxes#%E5%BC%B9%E6%80%A7%E7%9B%92%E5%B8%83%E5%B1%80%E6%A6%82%E5%BF%B5" target="_blank" rel="noopener">MDN</a></p><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><pre><code>&lt;div id=&quot;main&quot;&gt;    &lt;div id=&quot;box1&quot;&gt;&lt;/div&gt;    &lt;div id=&quot;box2&quot;&gt;&lt;/div&gt;    &lt;div id=&quot;box3&quot;&gt;&lt;/div&gt;    &lt;div id=&quot;box4&quot;&gt;&lt;/div&gt;&lt;/div&gt;#main {    height: 400px;    width: 100%;    display: flex;    flex-wrap: wrap;}#box1 {    background: olive;    width: 70%;}#box2 {    background: orange;    width: 30%;}#box3 {    background: red;    width: 50%;}#box4 {    background: darkblue;    width: 50%;}</code></pre><h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><p>定义一个弹性盒子：<code>display : flex</code>或者<code>display : inline-flex</code></p><blockquote><p>这样做将元素定义为弹性容器，其子元素则成为弹性项目。值 <code>flex</code> 使弹性容器成为块级元素。值 <code>inline-flex</code> 使弹性容器成为单个不可分的行内级元素。</p></blockquote><p><strong><code>flex-wrap</code></strong>:指定 flex 元素单行显示还是多行显示 。如果允许换行，这个属性允许你控制行的堆叠方向。具体属性查看：<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/flex-wrap" target="_blank" rel="noopener">MDN</a></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Wote_1HSTS Preload审核通过</title>
      <link href="/wote-1.html"/>
      <url>/wote-1.html</url>
      
        <content type="html"><![CDATA[<p>本站已经提交Chrome HSTS Preload，正式启用HTTP Strict Transport Security</p><pre><code>&lt;code class=&quot;json&quot;&gt;{ &quot;name&quot;: &quot;iiong.com&quot;, &quot;include_subdomains&quot;: true, &quot;mode&quot;: &quot;force-https&quot; },</code></pre><p>从提交差不多俩个月了吧，审核也是够慢的。</p><p>地址：<a href="https://chromium.googlesource.com/chromium/src/net/+/master/http/transport_security_state_static.json#19773" target="_blank" rel="noopener">HSTS Preload</a></p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>PHP开启bzip2 compression支持</title>
      <link href="/php-enabled-bzip2-compression.html"/>
      <url>/php-enabled-bzip2-compression.html</url>
      
        <content type="html"><![CDATA[<p>安装依赖库：</p><pre><code>&lt;code class=&quot;bash&quot;&gt;yum install bzip2-devel&lt;code class=&quot;bash&quot;&gt;[root@VM_226_27_centos ~]# cd oneinstack/[root@VM_226_27_centos oneinstack]# lsaddons.sh        backup.sh  include  install.log  LICENSE       pureftpd_vhost.sh  reset_db_root_password.sh  src    uninstall.sh  versions.txtbackup_setup.sh  config     init.d   install.sh   options.conf  README.md          tools  upgrade.sh          vhost.sh[root@VM_226_27_centos oneinstack]# cd src/[root@VM_226_27_centos src]# lsapcu-4.0.11.tgz                                       libmemcached-1.0.18.tar.gz                     php-5.3.29.tar.gzapcu-5.1.7.tgz                                        mariadb-10.1.20-linux-glibc_214-x86_64.tar.gz  php5.3patchapr-1.5.2.tar.gz                                      mcrypt-2.6.8.tar.gz                            php-5.4.45.tar.gzapr-util-1.5.4.tar.gz                                 memcache-3.0.8.tgz                             php-5.5.38.tar.gzbison-2.7.1.tar.gz                                    memcached-1.4.34.tar.gz                        php-5.6.30.tar.gzcurl-7.52.1.tar.gz                                    memcached-2.2.0.tgz                            php-7.0.15.tar.gzdebian_patches_disable_SSLv2_for_openssl_1_0_0.patch  mhash-0.9.9.9.tar.gz                           php-7.1.1.tar.gzeaccelerator-0.9.6.1.tar.bz2                          mod_remoteip.c                                 php-memcached-php7.tgzez_setup.py                                           mysql-5.5.54-linux2.6-i686.tar.gz.md5          phpMyAdmin-4.4.15.9-all-languages.tar.gzfpm-race-condition.patch                              mysql-5.5.54-linux2.6-x86_64.tar.gz.md5        pure-ftpd-1.0.43.tar.gzgmagick-1.1.7RC3.tgz                                  mysql-5.5-fix-arm-client_plugin.patch          redis-2.2.8.tgzgmagick-2.0.4RC1.tgz                                  mysql-5.6.35-linux-glibc2.5-i686.tar.gz.md5    redis-3.1.0.tgzGraphicsMagick-1.3.25.tar.gz                          mysql-5.6.35-linux-glibc2.5-x86_64.tar.gz.md5  redis-3.2.6.tar.gzhtop-2.0.2.tar.gz                                     mysql-5.7.17-linux-glibc2.5-i686.tar.gz.md5    start-stop-daemon.chttpd-2.2.32.tar.gz                                   mysql-5.7.17-linux-glibc2.5-x86_64.tar.gz.md5  tengine-2.1.2.tar.gzhttpd-2.4.25.tar.gz                                   nghttp2-1.18.1.tar.gz                          tmux-2.3.tar.gzImageMagick-6.9.7-5.tar.gz                            nginx-1.10.2.tar.gz                            tz_e.zipimagick-3.3.0.tgz                                     ocp.php                                        tz.zipimagick-3.4.3RC1.tgz                                  openresty-1.11.2.2.tar.gz                      xcache-3.2.0.tar.gzioncube_loaders_lin_x86-64.tar.gz                     openssl-1.0.2j                                 ZendGuardLoader-70429-PHP-5.4-linux-glibc23-i386.tar.gzioncube_loaders_lin_x86.tar.gz                        openssl-1.0.2j.tar.gz                          ZendGuardLoader-70429-PHP-5.4-linux-glibc23-x86_64.tar.gzjemalloc-4.4.0.tar.bz2                                pcre-8.39                                      ZendGuardLoader-php-5.3-linux-glibc23-i386.tar.gzlibevent-2.0.22-stable.tar.gz                         pcre-8.39.tar.gz                               ZendGuardLoader-php-5.3-linux-glibc23-x86_64.tar.gzlibiconv-1.14.tar.gz                                  pecl-memcache-php7.tgz                         zend-loader-php5.5-linux-x86_64.tar.gzlibiconv-glibc-2.16.patch                             percona-server-5.5.53-38.5.tar.gz              zend-loader-php5.6-linux-x86_64.tar.gzlibmcrypt-2.5.8.tar.gz                                percona-server-5.6.34-79.1.tar.gz              zendopcache-7.0.5.tgz[root@VM_226_27_centos src]# tar xzf php-5.6.30.tar.gz[root@VM_226_27_centos src]# cd php-5.6.30/[root@VM_226_27_centos php-5.6.30]# lsacinclude.m4      CREDITS          ltmain.sh        NEWS                      README.md                         README.TESTING2            stub.caclocal.m4        ext              main             pear                      README.namespaces                 README.UNIX-BUILD-SYSTEM   testsbuild             EXTENSIONS       makedist         php5.spec.in              README.NEW-OUTPUT-API             README.WIN32-BUILD-SYSTEM  travisbuildconf         footer           Makefile.frag    php.gif                   README.PARAMETER_PARSING_API      run-tests.php              TSRMbuildconf.bat     generated_lists  Makefile.gcov    php.ini-development       README.REDIST.BINS                sapi                       UPGRADINGCODING_STANDARDS  genfiles         Makefile.global  php.ini-production        README.RELEASE_PROCESS            scripts                    UPGRADING.INTERNALSconfig.guess      header           makerpm          README.EXT_SKEL           README.SELF-CONTAINED-EXTENSIONS  server-tests-config.php    vcscleanconfig.sub        INSTALL          missing          README.GIT-RULES          README.STREAMS                    server-tests.php           win32configure         install-sh       mkinstalldirs    README.input_filter       README.SUBMITTING_PATCH           snapshot                   Zendconfigure.in      LICENSE          netware          README.MAILINGLIST_RULES  README.TESTING                    stamp-h.in[root@VM_226_27_centos php-5.6.30]# cd ext/[root@VM_226_27_centos ext]# lsbcmath      date     ext_skel            gettext    intl      mssql    opcache    pdo_firebird  pgsql     reflection  soap       sysvmsg    xml        zlibbz2         dba      ext_skel_win32.php  gmp        json      mysql    openssl    pdo_mysql     phar      session     sockets    sysvsem    xmlreadercalendar    dom      fileinfo            hash       ldap      mysqli   pcntl      pdo_oci       posix     shmop       spl        sysvshm    xmlrpccom_dotnet  enchant  filter              iconv      libxml    mysqlnd  pcre       pdo_odbc      pspell    simplexml   sqlite3    tidy       xmlwriterctype       ereg     ftp                 imap       mbstring  oci8     pdo        pdo_pgsql     readline  skeleton    standard   tokenizer  xslcurl        exif     gd                  interbase  mcrypt    odbc     pdo_dblib  pdo_sqlite    recode    snmp        sybase_ct  wddx       zip[root@VM_226_27_centos ext]# cd bz2/[root@VM_226_27_centos bz2]# lsbz2.c  bz2.dsp  bz2_filter.c  config.m4  config.w32  CREDITS  package.xml  php_bz2.def  php_bz2.h  tests[root@VM_226_27_centos bz2]# sudo yum install bzip2-develLoaded plugins: fastestmirror, langpacksLoading mirror speeds from cached hostfilePackage bzip2-devel-1.0.6-13.el7.x86_64 already installed and latest versionNothing to do[root@VM_226_27_centos bz2]# phpizeConfiguring for:PHP Api Version:         20131106Zend Module Api No:      20131226Zend Extension Api No:   220131226[root@VM_226_27_centos bz2]# ./configure --with-php-config=/usr/local/php/bin/php-configchecking for grep that handles long lines and -e... /usr/bin/grepchecking for egrep... /usr/bin/grep -Echecking for a sed that does not truncate output... /usr/bin/sedchecking for cc... ccchecking whether the C compiler works... yeschecking for C compiler default output file name... a.outchecking for suffix of executables... checking whether we are cross compiling... nochecking for suffix of object files... ochecking whether we are using the GNU C compiler... yeschecking whether cc accepts -g... yeschecking for cc option to accept ISO C89... none neededchecking how to run the C preprocessor... cc -Echecking for icc... nochecking for suncc... nochecking whether cc understands -c and -o together... yeschecking for system library directory... libchecking if compiler supports -R... nochecking if compiler supports -Wl,-rpath,... yeschecking build system type... x86_64-unknown-linux-gnuchecking host system type... x86_64-unknown-linux-gnuchecking target system type... x86_64-unknown-linux-gnuchecking for PHP prefix... /usr/local/phpchecking for PHP includes... -I/usr/local/php/include/php -I/usr/local/php/include/php/main -I/usr/local/php/include/php/TSRM -I/usr/local/php/include/php/Zend -I/usr/local/php/include/php/ext -I/usr/local/php/include/php/ext/date/libchecking for PHP extension directory... /usr/local/php/lib/php/extensions/no-debug-non-zts-20131226checking for PHP installed headers prefix... /usr/local/php/include/phpchecking if debug is enabled... nochecking if zts is enabled... nochecking for re2c... noconfigure: WARNING: You will need re2c 0.13.4 or later if you want to regenerate PHP parsers.checking for gawk... gawkchecking for BZip2 support... yes, sharedchecking for BZip2 in default path... found in /usrchecking for BZ2_bzerror in -lbz2... yeschecking for ld used by cc... /usr/bin/ldchecking if the linker (/usr/bin/ld) is GNU ld... yeschecking for /usr/bin/ld option to reload object files... -rchecking for BSD-compatible nm... /usr/bin/nm -Bchecking whether ln -s works... yeschecking how to recognize dependent libraries... pass_allchecking for ANSI C header files... yeschecking for sys/types.h... yeschecking for sys/stat.h... yeschecking for stdlib.h... yeschecking for string.h... yeschecking for memory.h... yeschecking for strings.h... yeschecking for inttypes.h... yeschecking for stdint.h... yeschecking for unistd.h... yeschecking dlfcn.h usability... yeschecking dlfcn.h presence... yeschecking for dlfcn.h... yeschecking the maximum length of command line arguments... 1572864checking command to parse /usr/bin/nm -B output from cc object... okchecking for objdir... .libschecking for ar... archecking for ranlib... ranlibchecking for strip... stripchecking if cc supports -fno-rtti -fno-exceptions... nochecking for cc option to produce PIC... -fPICchecking if cc PIC flag -fPIC works... yeschecking if cc static flag -static works... yeschecking if cc supports -c -o file.o... yeschecking whether the cc linker (/usr/bin/ld -m elf_x86_64) supports shared libraries... yeschecking whether -lc should be explicitly linked in... nochecking dynamic linker characteristics... GNU/Linux ld.sochecking how to hardcode library paths into programs... immediatechecking whether stripping libraries is possible... yeschecking if libtool supports shared libraries... yeschecking whether to build shared libraries... yeschecking whether to build static libraries... nocreating libtoolappending configuration tag &quot;CXX&quot; to libtoolconfigure: creating ./config.statusconfig.status: creating config.h[root@VM_226_27_centos bz2]# sudo make &amp;&amp; sudo make install/bin/sh /root/oneinstack/src/php-5.6.30/ext/bz2/libtool --mode=compile cc  -I. -I/root/oneinstack/src/php-5.6.30/ext/bz2 -DPHP_ATOM_INC -I/root/oneinstack/src/php-5.6.30/ext/bz2/include -I/root/oneinstack/src/php-5.6.30/ext/bz2/main -I/root/oneinstack/src/php-5.6.30/ext/bz2 -I/usr/local/php/include/php -I/usr/local/php/include/php/main -I/usr/local/php/include/php/TSRM -I/usr/local/php/include/php/Zend -I/usr/local/php/include/php/ext -I/usr/local/php/include/php/ext/date/lib  -DHAVE_CONFIG_H  -g -O2   -c /root/oneinstack/src/php-5.6.30/ext/bz2/bz2.c -o bz2.lo mkdir .libs cc -I. -I/root/oneinstack/src/php-5.6.30/ext/bz2 -DPHP_ATOM_INC -I/root/oneinstack/src/php-5.6.30/ext/bz2/include -I/root/oneinstack/src/php-5.6.30/ext/bz2/main -I/root/oneinstack/src/php-5.6.30/ext/bz2 -I/usr/local/php/include/php -I/usr/local/php/include/php/main -I/usr/local/php/include/php/TSRM -I/usr/local/php/include/php/Zend -I/usr/local/php/include/php/ext -I/usr/local/php/include/php/ext/date/lib -DHAVE_CONFIG_H -g -O2 -c /root/oneinstack/src/php-5.6.30/ext/bz2/bz2.c  -fPIC -DPIC -o .libs/bz2.o/root/oneinstack/src/php-5.6.30/ext/bz2/bz2.c: In function ‘_php_stream_bz2open’:/root/oneinstack/src/php-5.6.30/ext/bz2/bz2.c:233:12: warning: assignment discards ‘const’ qualifier from pointer target type [enabled by default]  path_copy = path;            ^/bin/sh /root/oneinstack/src/php-5.6.30/ext/bz2/libtool --mode=compile cc  -I. -I/root/oneinstack/src/php-5.6.30/ext/bz2 -DPHP_ATOM_INC -I/root/oneinstack/src/php-5.6.30/ext/bz2/include -I/root/oneinstack/src/php-5.6.30/ext/bz2/main -I/root/oneinstack/src/php-5.6.30/ext/bz2 -I/usr/local/php/include/php -I/usr/local/php/include/php/main -I/usr/local/php/include/php/TSRM -I/usr/local/php/include/php/Zend -I/usr/local/php/include/php/ext -I/usr/local/php/include/php/ext/date/lib  -DHAVE_CONFIG_H  -g -O2   -c /root/oneinstack/src/php-5.6.30/ext/bz2/bz2_filter.c -o bz2_filter.lo  cc -I. -I/root/oneinstack/src/php-5.6.30/ext/bz2 -DPHP_ATOM_INC -I/root/oneinstack/src/php-5.6.30/ext/bz2/include -I/root/oneinstack/src/php-5.6.30/ext/bz2/main -I/root/oneinstack/src/php-5.6.30/ext/bz2 -I/usr/local/php/include/php -I/usr/local/php/include/php/main -I/usr/local/php/include/php/TSRM -I/usr/local/php/include/php/Zend -I/usr/local/php/include/php/ext -I/usr/local/php/include/php/ext/date/lib -DHAVE_CONFIG_H -g -O2 -c /root/oneinstack/src/php-5.6.30/ext/bz2/bz2_filter.c  -fPIC -DPIC -o .libs/bz2_filter.o/bin/sh /root/oneinstack/src/php-5.6.30/ext/bz2/libtool --mode=link cc -DPHP_ATOM_INC -I/root/oneinstack/src/php-5.6.30/ext/bz2/include -I/root/oneinstack/src/php-5.6.30/ext/bz2/main -I/root/oneinstack/src/php-5.6.30/ext/bz2 -I/usr/local/php/include/php -I/usr/local/php/include/php/main -I/usr/local/php/include/php/TSRM -I/usr/local/php/include/php/Zend -I/usr/local/php/include/php/ext -I/usr/local/php/include/php/ext/date/lib  -DHAVE_CONFIG_H  -g -O2   -o bz2.la -export-dynamic -avoid-version -prefer-pic -module -rpath /root/oneinstack/src/php-5.6.30/ext/bz2/modules  bz2.lo bz2_filter.lo -lbz2cc -shared  .libs/bz2.o .libs/bz2_filter.o  -lbz2  -Wl,-soname -Wl,bz2.so -o .libs/bz2.socreating bz2.la(cd .libs &amp;&amp; rm -f bz2.la &amp;&amp; ln -s ../bz2.la bz2.la)/bin/sh /root/oneinstack/src/php-5.6.30/ext/bz2/libtool --mode=install cp ./bz2.la /root/oneinstack/src/php-5.6.30/ext/bz2/modulescp ./.libs/bz2.so /root/oneinstack/src/php-5.6.30/ext/bz2/modules/bz2.socp ./.libs/bz2.lai /root/oneinstack/src/php-5.6.30/ext/bz2/modules/bz2.laPATH=&quot;$PATH:/sbin&quot; ldconfig -n /root/oneinstack/src/php-5.6.30/ext/bz2/modules----------------------------------------------------------------------Libraries have been installed in:   /root/oneinstack/src/php-5.6.30/ext/bz2/modulesIf you ever happen to want to link against installed librariesin a given directory, LIBDIR, you must either use libtool, andspecify the full pathname of the library, or use the `-LLIBDIR&apos;flag during linking and do at least one of the following:   - add LIBDIR to the `LD_LIBRARY_PATH&apos; environment variable     during execution   - add LIBDIR to the `LD_RUN_PATH&apos; environment variable     during linking   - use the `-Wl,--rpath -Wl,LIBDIR&apos; linker flag   - have your system administrator add LIBDIR to `/etc/ld.so.conf&apos;See any operating system documentation about shared libraries formore information, such as the ld(1) and ld.so(8) manual pages.----------------------------------------------------------------------Build complete.Don&apos;t forget to run &apos;make test&apos;.Installing shared extensions:     /usr/local/php/lib/php/extensions/no-debug-non-zts-20131226/[root@VM_226_27_centos bz2]# service php-fpm restartGracefully shutting down php-fpm . doneStarting php-fpm  done</code></pre><p>后台添加扩展支持：</p><pre><code>extension=bz2.so</code></pre><p>保存以后，重启php-fpm</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EMD Vol 1701</title>
      <link href="/emd-vol-1701.html"/>
      <url>/emd-vol-1701.html</url>
      
        <content type="html"><![CDATA[<h3 id="2017-01-21"><a href="#2017-01-21" class="headerlink" title="2017.01.21"></a>2017.01.21</h3><p>新年的第一篇生活笔记，其实也没啥好说的，就稍微说说这个月一些事情吧。</p><p>去年双十二开始上班，到现在逐渐稳定，一日复一日…一不小心又到了春节。不过公司还是在25号放假，对我来说这无所谓了，毕竟人在老家，上下班极为方便。</p><p>骑车接近一个月了，刚开始骑车真的好慢。每天都需要50分钟路程时间，不过中间也忍下来了，几次腿真的酸疼，也忍着去骑车，最近一次骑车，忽然发现效果出来了，基本花30分钟的路程时间，而且不怎么累。</p><p>不过…身体状况出问题了。甲沟炎越来越严重了，不知道怎么回事，这次回来脚趾头越来越难受。刚开始没注意，大概前一个月，发现脚趾头指甲皮肤附近周围渐渐发紫，而且发热。明显是发炎，当时就吃了点消炎药。还是不管用，现在肉芽越来越大…路也不能走了，一走就疼。所以计划春节放假一定要去看看。当然还有割包皮，这个年后再排吧。</p><p>公司的项目，对我来说，收益居多。感觉学了不少东西，真是极好的。我们春节福利发了一袋米和一箱苹果，然后当晚下班聚餐吃饭。从5.30下班到饭店，然后12:00结束。宴会只喝了差不多二俩的白酒，喝下去也没啥感觉，而且这还是我第一次喝白的，这归纳我们家基因特能解酒精…结束后从市里骑车到乡下，花了我接近40分钟，到家差不多凌晨1点了，倒头就睡，实在是太困了。</p><p>上面说到骑车，这个月遇到一个奇怪的大叔，各种套我的资料，最后搞明白感情给我介绍对象…mdzz，真是的，这么热情，我都不好意思了，之后留了联系方式，叔叔一直叫我去师范学院。表示没空去，想想还是到春节后再说吧。反正现在回想起来了，总感觉哪里不对劲…我有啥？莫名其妙被介绍对象？蛤？</p><p>今年计划要做的事可能要比我想象中要多得多。算了，日子慢慢来吧。</p><hr><p>新年到，博客可能要换个主题，之前的主题都看腻了。目前没选好哪个，求推荐个！</p><p>然后插件被wp反驳了，幸亏之前觉得1.0版本不规范，花了接近一个星期重写，然后重新提交…再过不去我就不提交了，php本来就不怎么会…</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>一个好用的Markdown WP插件</title>
      <link href="/wordpress-plugins-wp-editormd.html"/>
      <url>/wordpress-plugins-wp-editormd.html</url>
      
        <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>WP Editor.MD是一个漂亮又实用的在线Markdown文档编辑器。 基于Editor.md构建对WordPress平台的支持。 使用WordPress Jetpack 的Markdown模块来解析和保存内容。 Veriosn 5.0重构，更新日志请查看：<a href="https://github.com/JaxsonWang/WP-Editor.md/blob/master/CHANGELOG.md" target="_blank" rel="noopener">日志说明</a></p><h3 id="安装使用"><a href="#安装使用" class="headerlink" title="安装使用"></a>安装使用</h3><p>插件下载地址：<a href="https://wordpress.org/plugins/wp-editormd/" target="_blank" rel="noopener">WordPress插件库</a> 最新版本以WordPress插件版本为主。 上传到你的WordPress插件库启用即可使用！</p><h3 id="使用文档（5-0版本）"><a href="#使用文档（5-0版本）" class="headerlink" title="使用文档（5.0版本）"></a>使用文档（5.0版本）</h3><p>Markdown基本语法：<a href="https://raw.githubusercontent.com/JaxsonWang/WP-Editor.md/old-4.x/Document/markdown.md" target="_blank" rel="noopener">源码文件</a> 确保插件是最新版本的（6.0.1） <strong>请将源码文件的内容复制到编辑器学习！</strong>： <a href="https://raw.githubusercontent.com/JaxsonWang/WP-Editor.md/docs/Example/Markdown.md" target="_blank" rel="noopener">Markdown文档</a> <a href="https://raw.githubusercontent.com/JaxsonWang/WP-Editor.md/docs/Example/KaTeX.md" target="_blank" rel="noopener">Katex文档</a> <a href="https://raw.githubusercontent.com/JaxsonWang/WP-Editor.md/docs/Example/Mermaid.md" target="_blank" rel="noopener">绘图文档</a> <a href="https://raw.githubusercontent.com/JaxsonWang/WP-Editor.md/docs/Example/MindMap.md" target="_blank" rel="noopener">思维导图文档</a> <a href="https://jetpack.com/support/markdown/" target="_blank" rel="noopener">Jetpack文档</a></p><h3 id="添加自定义页面支持"><a href="#添加自定义页面支持" class="headerlink" title="添加自定义页面支持"></a>添加自定义页面支持</h3><p>忘了这茬了，要不是有人提醒还真忘了。 WP Editor.md插件预留支持文章和页面（Post和Page）类型。有些主题会带别的模板支持，所以想要插件支持需要你手动添加代码，很简单，不复杂。 由于页面类型过多，插件不好判断，请仔细读取下列步骤：</p><ul><li>获取文章类型： 进入自定义文章页面，获取url参数即可： <img src="https://i.loli.net/2018/05/17/5afd546754638.png" alt="QQ截图20180517180729.png"> 例如上图的<code>post_type=page</code>的<code>page</code>即文章类型，请记住这个单词。</li><li>在你得主题<code>function.php</code>或者插件目录下<code>wp-editormd.php</code>文件最下面添加如下代码： <code>add_post_type_support( &#39;page&#39;, &#39;wpcom-markdown&#39; );</code> 修改<code>page</code>为你的自定义文章关键词即可。 然后保存文件即可！这样达到你所要的需求了</li></ul><h4 id="扩展语法说明"><a href="#扩展语法说明" class="headerlink" title="扩展语法说明"></a>扩展语法说明</h4><h5 id="代码块："><a href="#代码块：" class="headerlink" title="代码块："></a>代码块：</h5><p>本插件语法高亮引擎使用<a href="http://prismjs.com/" target="_blank" rel="noopener">Prism.js</a></p><blockquote><p><code>语法类型 代码展示内容</code></p></blockquote><p>支持语法类型列表请看：<a href="http://prismjs.com/#languages-list" target="_blank" rel="noopener">Prism.js支持语法高亮列表</a>，请注意，语法类型<strong>统一小写</strong></p><h5 id="科学公式："><a href="#科学公式：" class="headerlink" title="科学公式："></a>科学公式：</h5><p>本插件公司渲染引擎使用<a href="https://khan.github.io/KaTeX/function-support.html" target="_blank" rel="noopener">KaTeX</a>. 官网语法文件：<a href="https://khan.github.io/KaTeX/function-support.html" target="_blank" rel="noopener">KaTeX语法文档</a> 使用说明（行内公式和多行公式）： 实例地址：<a href="https://github.com/JaxsonWang/WP-Editor.md/blob/old-4.x/Document/latex.md" target="_blank" rel="noopener">公式实例</a> 如果编辑器公式渲染有问题，请及时反馈！建议Github issues反馈！</p><h3 id="其它说明"><a href="#其它说明" class="headerlink" title="其它说明"></a>其它说明</h3><p>有些同学比较好奇插件的工作原理，我随便写个流程如下： <img src="https://i.loli.net/2018/05/07/5af00861c2e1a.png" alt="wpeditormd.png"> 所以就算是卸载插件也没有什么影响。</p><h3 id="QA"><a href="#QA" class="headerlink" title="QA"></a>QA</h3><p>Q: 其次有些同学可能会出现一个情况：明明是Markdown写入的，怎么再次打开变成HTML文章了？ A: 根据流程图得知md是存储在一个字段，如果是不存在可能使用优化（清理）数据库插件导致的。</p><h3 id="捐赠名单"><a href="#捐赠名单" class="headerlink" title="捐赠名单"></a>捐赠名单</h3><p>捐赠人</p><p>捐赠额数</p><p>家有白菜的小欢猪</p><p>￥10.00</p><p>扬帆大海</p><p>￥23.33</p><p>支付宝匿名</p><p>￥29.00</p><p>靖</p><p>￥10.00</p><p>支付宝匿名</p><p>￥50.00</p><p>微信匿名</p><p>￥13.30</p><p>微信匿名</p><p>￥10.00</p><p>w候人兮猗</p><p>￥8.88</p><p>*龙</p><p>￥20.00</p><p><a href="taifua.com">太傅</a></p><p>￥8.88</p><p>*谦</p><p>￥50.00</p><p>*荣</p><p>￥10.00</p><p>*耀命</p><p>￥10.00</p><p>*鸿峥</p><p>￥1.00</p><p>*源睿</p><p>￥10.00</p><p>*焕恒</p><p>￥10.00</p><p>*志康</p><p>￥10.00</p><p>*承鑫</p><p>￥50.00</p><p>S*T</p><p>￥10.00</p><p>S*s</p><p>￥9.99</p><p>*见</p><p>￥10.00</p><p>E*o</p><p>￥10.00</p><p>*啦</p><p>￥1.00</p><p>*调</p><p>￥1.00</p><p>感谢以上朋友的捐赠！</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WordPress </tag>
            
            <tag> Markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sessionStorage的使用笔记</title>
      <link href="/sessionstorage-notes.html"/>
      <url>/sessionstorage-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>之前公司同事问我项目如何做到页面和页面之间的值传递，当时我很傻很天真的认为写个所谓的“全局变量”即可…</p><p>事实上我想多了，之后我在开发项目中，采取那个方案实在是太…mdzz</p><p>于是在网上查找相关的解决方案。</p><blockquote><p>sessionStorage 属性允许你访问一个 session Storage 对象。它与 localStorage 相似，不同之处在于 localStorage 里面存储的数据没有过期时间设置，而存储在 sessionStorage 里面的数据在页面会话结束时会被清除。页面会话在浏览器打开期间一直保持，并且重新加载或恢复页面仍会保持原来的页面会话。在新标签或窗口打开一个页面会初始化一个新的会话，这点和 session cookie 的运行方式不同。</p></blockquote><p>于是自己大致的摸索下，还不错：</p><pre><code>请输入你的名字：&lt;input id=&quot;field&quot; type=&quot;text&quot; value=&quot;&quot; title=&quot;名字&quot;/&gt;&lt;br /&gt;获取你的名字：&lt;a id=&quot;fieuser&quot;&gt;&lt;/a&gt;&lt;script type=&quot;text/javascript&quot;&gt;    // 获取文本输入框    var field = document.getElementById(&quot;field&quot;);    // 检测是否存在 username 键值    // (这个会在页面偶然被刷新的情况下存在)    if (sessionStorage.getItem(&quot;username&quot;)) {        // 恢复文本输入框的内容        field.value = sessionStorage.getItem(&quot;username&quot;);    }    // 监听文本输入框的 change 事件    field.addEventListener(&quot;change&quot;, function() {        // 保存结果到 sessionStorage 对象中        sessionStorage.setItem(&quot;username&quot;, field.value);    });    document.getElementById(&quot;fieuser&quot;).innerHTML = sessionStorage.getItem(&quot;username&quot;);&lt;/script&gt;</code></pre><p>浏览器开发者模式查看：</p><p><a href="//res.i95.me/wp-content/uploads/2017/01/20170113082829.png"><img src="//res.i95.me/wp-content/uploads/2017/01/20170113082829.png" alt></a></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript图片业务处理</title>
      <link href="/javascript-make-images.html"/>
      <url>/javascript-make-images.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在公司项目，遇到一个问题，就是用户在咨询或者咨询的时候，可以上传文字和图片。</p><p>当我尝试文字和图片上传的时候，发现结果真的不理想（主要是form表单提交或者form-data），遇到一堆问题。</p><p>然后采取的是：</p><p>用户点击上传图片即可上传到服务器，问题描述(文字)是点击提交按钮将把数据提交到服务器。</p><h3 id="业务"><a href="#业务" class="headerlink" title="业务"></a>业务</h3><p>图片上传用的是input file上传，然后有个div可以看到用户上传的缩略图。</p><p>其实是限制图片大小为5M，这个简单，直接判断上传文件的大小。</p><p>在其次就是现在用户上传的文件格式类型：我这里使用的是截取字符串来判断，判断用户上传的文件，根据xxxx.xxx的[.]来截取后面的字符串(这个是最后一个点)，然后再判断所谓的非png.jpg，gif等等就行了。</p><p>图片压缩，主要是考虑到节省流量，就我一个iPhone随便一张图片都是3M~5M，实在是太大。本来想使用HTML5的<code>Canvas</code>来绘制图片，发现用户体验不咋的…于是用了第三方的JS图片压缩库：<a href="https://github.com/think2011/localResizeIMG" target="_blank" rel="noopener">localResizeIMG</a>.效果还不错，3M的图片压缩成240kb，压缩率挺高的。</p><p>最后就是图片如何提交给后台：由于我这儿图片在浏览器显示base64加密的数据，所以直接post方式传到后台。例如：</p><pre><code>data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wAARCABkAGQDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD0L7VNFLEj27eQUbzLksFCOCMAg8kEHII9MVYW5icoquCHOFIIIJ+orF8Uy6fJpU1je3Ji2KhmWJDK6EgkHaOo6nPTiub8K32keG7W/W2u575wEuRHJAYXIA27VDHBJJzwexoUbq420nY721vIbuESqXi65jmXY68kcqemcZHsabLqtlDcfZ2nLS7SxVFLYAIByQMdSPw5rkn1qKchUstUuNyrPkTKMBhnbnPbOCB3p8V/aRX17cyPJCIQqM8silGDEHCYJJAJAPuKfIxKS7nVrqdgxYC7j3IuWXdyozjJA56/zrjdR1bxhcXt3JaX2n6daLIRbQ3CIZHUYGSSe+Sc/lXN2QsLK/gFuGc+cu6R4PKCknHBJJOc9e+a09e0eymvL37VcW0MlwVKs0ReRFAAGCAQASpOOtXyqLsTzOUb/qWor7xvuBGv6SxBHBROD2PB6Vg3uhanp96t3dW8a+ZIA00MxWN3bJBUEkEnBJyetOHhKwhYE6lGCnBV7U45JwSQOh5rZu7CG28JWtol1EkL3wZZthMaqSxwQRkAEEdM5x2pyaQopu/+aOVmwzS5wSGcHNzjkRknPHHAOfQcjmo9akYWFuJQoAXKlphHyUBGGAyeMYz9etXJYopJpQLuNQHZQVtwFIERIZcjkEjAJ6sQOlR6t5I0q1aFo954cW9vmQfJ/GrcAZ646n2pNjsd3q0dhaeGNLv3iit4EgSad4owpcKgbB4BJJwBnnJyKzdfUX2naVd3sYjUgyTQqSSAULFAe/Ax+FbbmK68O6VbylJGOneYUchmIKbckdMZx9CMDpWJeK3/AAh+lrLyypGrEgk5MZBPrnGaUOhU1oy/pV7BJbu6tlWkLLgHABAIx+BorzZtSmtoLbyJpUjkt42UBfRQvr/s0VrzeRlFpKx6RqmpXImFvFq+pxSQu8byR2aMsuGPQk54yAD3AqWWK9bw4051UOZGG25vUEbxA9NoVSA2QRgjGDmsie81r5pG0m1GSW+a2cncTk4yc5zk1o67NqWnwWcOm2azqwYurqzLGMAAgAjBOSOazatZf5Fxbd3/AJlSOTU45LdJtZgleKEvJGHCrMpyQ7HYMAAjgeg4pLWcQ6IdR1PUZJY4ZmgM8CZLFgACBtGQCDjIxyabNNqyWVk8WlxNcTq7XKOjkIQ+AOuRnAOCfcVauoZpvDETHT7d57iVXltpVfyi2TkkA5BGBjn609NP+ACT18vUxSdN1q8hjj1O6llRhKiy221SFIJyc8cAgVs6/q2n6feSPdw3TMVXJimVRyGIABGc4ByehyPSqdtaXZvVnudMsrYhSolhRldc4OACcYPIOfXir+svrqXcw0rTo7mMIpV2tFky2W3DJ9Pl47Z96Tfv/wDDDS/d/Pz/AFKt14g0uILJJDe/vGMY23K8bSRyMdOK17qwi1nSYIo5ntR54dWeQFtwZgRuUEEkk44xjg81Qun8SCRFg0yKWNsZzZIxVecn8T3rbgaRLazOoIYZWnRSkaiIbi7bQQMjBGCR3zmpqOyTRVNXbT/yPNr4E6hdrIzOUmZGZroKSRGw5AHGQCenTPeodXtWh0a0lmhaOJwNrz3RVGJTICkDPTkZ7c9as3wJ1e+/eog+1OuGgHHysc5xyMjGfUgd6rajMy6PbMk6NIwG4RxF5FG3+JSMDnHToRimT1O70fybmz0+5jf96umpbMAoCYHzBlPUjJI98ZqpdOt34VsrgIyBnjcK5yVAJU5PT3/GneFCXtojIT81umS2AT65A4H4dKhO6XwdaLMpDb0DADGAJSBx9AKq1rIXNzJv1/M4KeVVt7MJOdotwM+TnOGYetFaNrFIbOLKCPBcAFO3mNg0VdjI7/TrQwXckjXCSkxEDbdGQ5OMNgk4HB596r6PptxaXiTTags6iFgV+1mQMxAAYAkggEHntUq6Tp3hy7kuHQwI1qIFuJJlCOoyRGAcEMRzz1qjoR0h5YXsLW5XbZOFdpEYKnO5Tj+Ln6c81z3un/kdNknFfqyxpOmX1tepLcaotzH5ThkF0XDErgEAkggHPPan6Tpt9aXaSXGpLdRlGDKLkuWJAAIBPIyDz2qrojaQt7ALSyuo5TZO6GQrgRkkFTgfeOOO3NHh9tJe+iextLqJ1tn2tKVwE3HIIHOcg47VUr6/5Chb3f8ANl1bS4iJZ543iCnKrOWJORg4JIPPXHSotT06OfVWuZdTtrePYo8mWVlORuycAgYOeOOcc1T06HTYrqJ7azuoZPKcK0rKVUM2SDgZyTyMdutP186dJqSw3dtPJLIoAaOZUUcOQSCCRwDz3yMUK/tP+AN29l8+4lzo0M0yldcso9uGwZWBzk8cHr/hXR2MFxaWVnDDIt46uN8qPuXYXYs2TknGQCOvHFcZfz6OkrRz2N6+0LylymMkEgjK+nauuuGtRbWpd5LaMXsYTyyGzJ5hAUkcbSevoDzRVWiRNFpNtHnd88sXiK8McdzuF2wBDgkko/RTxnGcD0yeoFVtVnnk8OWEcwufLUKUWTEaY2YBWQfM/HTPUc9aTVTbr4gv98NsT9tOV3sCQVbIJB7nknsQF6GqV9LbNploqwRpKsabpS7SbwQRjYeE7cDp0p9BPc7zwgyCxtMFSTbDABzwGwcHvz3pVjK+Goo0RZdsoKxgkBz5pOPX1/KqvhAgJp7tkltNbAxgECUc47emPStyBDaWoFy4yhLZzkDJJAB7kZxVN/oEY6ff+ZR07w5FFZql5J58u5jucAkAnIA9hRSy64vmMIY0cKcHcWJB7g7eB9OtFFmO8UJ8T4lurCw0tJ4ftjTNPHbOSGlVVIwvGN2ScAkZwcZNW/AVqr+BbLB2O7SsrgA4y5xkdxwDj2rgfEuo3dxqGo3Vwhm2yr5EpY5jKEbcfQk/nXVaN4zt7DQbS3trNna3u/Lu1kO0JG7Fi6EcEgsOD6Eelc8otGsZJs04ZtXtL/yNRvbBl+zOPkCqWlBJDYAyFxjIPHWlsp9YZ1NyIJk8nlUMaHf/AHuDnbj8DT7q1sP+EjuJzDIZgkm9zjawAxwO5578VDpcFhauEtIpUItQhDlT8mScEjvyfbmqez0/ASbutfxCJr/y4xdTW0gIO/ywmc5GCNvPHfHFSXRu/wC0FMdxHFb7QGVpUVifmzgMMnJx+XHQ1XMEUAimtonjZlCAsVwoJzyAOvTpxzU13pqNPDd3CtNKj4QhlQAkEAnIwcAnj3px+Mcrun/wSO+l1Nmi+yXlrGAMSCS4iBbjoMjscnHvWqHuWt7dikckvnLlWZZAFDnkMuAWAwQRyDx1rnby302+geG4glkRZxCf3qqSwIIPA6cDjrxV7U7W3srCCO6mljgj1CIgxjJMm/Kg/wCyWJB9jTqLRE03q3c4nUZCfEd4WdlAvBgi1DAgK4zjGT1AI/iJDdqzrqRn0O2T5g6BVKrAEfAzyZBw316n8K0tZZV8Q3IvfNWN7iNirXiqxXa4BXPAAzhc/dGQeSKxp57Y6NDAkwJGxmja5BjyQckKORz0B6d6a2Ie523hFkj0zT5ZGIK2U/yk5bAkBJz04B5+tWrvUpb2w1QhNvlQh41V8Hgk5yOmcD356AVj+Fr+CXTtOsorqAtFbXfmwoQWIPIIPUAAEn61PaMq6ddoCF+0QERg4AyTwCemcYzz2zVR1E3ZJFfT3nk+0gsEVJ2VViwoAwD+JyTzRUun6ZIiTSAl/Ok3nbHkD5QMZPXp+tFWRqc5qa3cMs7pcLLDLI2Y2HKgsQcH3IJ/AVs+HE0q+n1Gyv7hbeSd3EbuwRVAPGCeDyFzxx+NcxPNO11Kvmkq1yUCsoxgue/4n86uWt9dxm8toWTy5bkEI0UbksXKjlgSBnk4I/Gs5bFQ0ep6Le3cf9sTE2rfIsiSKLnJbkAcDIUHBIHcGn2h00IZWheNFt2kYxzOSiggFSCOT6YJ6VyUzafpOuyvqupPdLI2bwrZMhkYkkY2sMk8kN0GACDmupVNLtdGe/tLS5ayuLFpGUvhpEyCF5OVYg5H1qdLWNFdu6JLQaNqdutxprTy+U6p8zMCrc4UqT14OQaWfW7LymmNq17C9yIIdrKuWCksfmIAAIIHcnpWd4cutNbT7l9LsbjT0a6UyJNKJGd9udwPbjgiqevSWdokdt5CtbmcPGPKdyJOcEbTkYyevWl1KT9015tatoA0k/hu4WNWBdt0TBTkDcQDyRnqOannurC902ZL6Nytp5dxcxkMNhILqQRySMZx2Iwa5TWL/WIrv7LfXyKWkRtiac7IGyCoLAgZyBxn610DRR2mi317qLveTXEYe8MYEZkCqQFABwMAkA/nVNLoTFtrU43xU2jTzWOpaHGS0k7CWR1bMjAAgEN1HPYd6gEt1M0qypDGzjL/AOjgEEcDHHGQM++Kh1i+sLnTrabSbW4tEhuiStw4c7tgIIIPTGKh+26s+nPcNPD5TEykso3kqNuOmRkHIGcH60EPVnR+HVuZ9a8yZViV4nVXSFUBAHOMDnIJHp61pvqGj2rytLNEPIh3srMHdQDggKCcDBAxgHJGOK4q1ubm7jmS3iee+dCiOsm0Qpg7yBkAkgkDHqeOlZ8Fo0sDJCEGwNI3OAQFzxx1HpVJ9iU+52h8daaGbybW6kXP3tqjP4E5orkrOzMsRLJnDYzkegop8zAebVIJElku42dHEjKcqCo5KgkcsT0PTmnPE0AE4M0d0ZBJHEEBLKWJDZBOcEjp05qi8482QqpCscBQ5AAycA46/iaYjMPljwgGWIQY47nik7dAV+p0Vz4m1SS7knuIY4pSpVlZASATnOCRk9+atXXjW7urV7ARRQwNAIgpYsWJwSVwACxOAAOMcVyQmdY/LVsANu6DJPHU9T0FSyS3FzMZ55Wd2IJZuoIxjHp0A/Ci9wWh22i2+s3GnT2uh2pmvI3JmR2CNE4yASGOGHuOMjBpR4T8YTaPDYXOmkzQ3hnAWVBiMg5wQefmJ49/SuTi1XUYIxFBfzoqrsVkmIwuclRjoMkmkGpaqMj+07zHp9qf/Gk0x81jpofAPieFraRNOmdlkzcx+eADh8jaScZKnJ6jIGK1T4f8Xy6pqcl9p7G2v/kjjRkG8LkKGIPyjbnJ7kiuCl1K9bZ/pt58qgZF3I2TknI5469PanLrOrKu1dTvRnqPtL/rzS5WPmNfWNEhg1CPS7IXSkfv3+1IFyNuAFHoADnJ44HaqN7pMVomWknWRgCkcqffUHGFI6g5zx0xWfLe30twLh7u4aYAhZGkJZRgDgnkcDFI19dM0ZaaTMbAqdx+XB4AHbHP51WyJau7m5pcum6RCL24W6hlZDGyq4ZWJGPmGARgkE8nrzWdNfNBta1GFZWBLqDkMMHAPQEEYzyMVe0zxDbySNDqcURRiCJDDuJ65UgDocDBxxisZmUlsjynJLAI/wApBOQMEY4GAADmm7W0Fr1JoriTZjYjbTjpRVdRjIKgEdsUVNx2H3ESgQ9eYzn8zTIYVZs5YH2NFFMOhvaVpFtdW08khfMf3QCAP5VjsM5GfWiiqJGeWvHWjy1/SiikBfvrOGG10ySNdrT2YkkIP3m3uM/kBVTyl9/zoooGNMSkc5/OojEuTyfzoopAhpiUihwZDuZiTgD8hRRSKLNrAhjOR3/oKKKKBH//2Q==</code></pre><p>后台解码URL，然后再把base64转换jpg格式图片，发现是灰色背景或者是已损坏的图片…然后就困扰了俩三天了。</p><p>之后找到解决方案了，应该后端把<code>data:image/jpeg;base64,</code>给解析乱了，导致图片各种损坏。所以前端在发送数据，只发送截取<code>data:image/jpeg;base64,</code>后面的数据即可，另外包括图片名，这样可以判断图片类型。</p><h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><pre><code>&lt;div id=&quot;complaints-conten-input-per&quot; class=&quot;mui-input-row&quot; style=&quot;display: block&quot;&gt;    &lt;textarea id=&quot;textarea1&quot; rows=&quot;5&quot; placeholder=&quot;问题描述&quot;&gt;&lt;/textarea&gt;    &lt;div class=&quot;complaints-conten-photo&quot;&gt;        &lt;div class=&quot;complaints-conten-photo-title&quot;&gt;添加照片&lt;/div&gt;        &lt;form id=&quot;imgForm_1&quot; enctype=&quot;multipart/form-data&quot;&gt;            &lt;div class=&quot;complaints-conten-photo-images&quot;&gt;                &lt;input id=&quot;photo1&quot; type=&quot;file&quot; name=&quot;file1&quot; class=&quot;mui-btn mui-btn-block complaints-conten-photo-images-info&quot;/&gt;                &lt;div id=&quot;click1&quot; class=&quot;clickImg&quot;                     style=&quot;width: 80px; height: 80px; position: absolute; z-index: -1; border: 1px solid #bbb;left: 10px&quot;&gt;&lt;/div&gt;                &lt;input id=&quot;photo2&quot; type=&quot;file&quot; name=&quot;file2&quot; class=&quot;mui-btn mui-btn-block complaints-conten-photo-images-info&quot;/&gt;                &lt;div id=&quot;click2&quot; class=&quot;clickImg&quot;                     style=&quot;width: 80px; height: 80px; position: absolute; z-index: -1; border: 1px solid #bbb;left: 100px;&quot;&gt;&lt;/div&gt;                &lt;input id=&quot;photo3&quot; type=&quot;file&quot; name=&quot;file3&quot; class=&quot;mui-btn mui-btn-block complaints-conten-photo-images-info&quot;/&gt;                &lt;div id=&quot;click3&quot; class=&quot;clickImg&quot;                     style=&quot;width: 80px; height: 80px; position: absolute; z-index: -1; border: 1px solid #bbb;left: 190px;&quot;&gt;&lt;/div&gt;                &lt;input id=&quot;photo4&quot; type=&quot;file&quot; name=&quot;file4&quot; class=&quot;mui-btn mui-btn-block complaints-conten-photo-images-info&quot;/&gt;                &lt;div id=&quot;click4&quot; class=&quot;clickImg&quot;                     style=&quot;width: 80px; height: 80px; position: absolute; z-index: -1; border: 1px solid #bbb;left: 280px;&quot;&gt;&lt;/div&gt;            &lt;/div&gt;        &lt;/form&gt;    &lt;/div&gt;    &lt;input type=&quot;submit&quot; class=&quot;mui-btn mui-btn-orange&quot; onclick=&quot;sub();&quot; value=&quot;提交1&quot; /&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;    //循环且输出遍历按钮    for (var i = 1; i &lt; 9; i++) {        var comp1 = &apos;photo&apos; + i;        var comp2 = &apos;click&apos; + i;        //输出图片点击上传预览        document.write(&apos;\&lt;script type=\&quot;text\/javascript\&quot;\&gt;&apos; +            &apos;document.getElementById(&quot;&apos; +            comp1 +            &apos;\&quot;).addEventListener(\&quot;change\&quot;, function (e) {&apos; +            &apos;var files=this.files;&apos; +            &apos;var img=new Image();&apos; +            &apos;var reader=new FileReader();&apos; +            &apos;var fileName = &apos; +            comp1 +            &apos;.value;&apos; +            &apos;/*图片压缩START*/&apos; +            &apos;lrz(this.files[0]).then(function (rst) {&apos; +            &apos;console.log(\&quot;图片压缩详细输出信息：\&quot;);console.log(rst);&apos; +            &apos;console.log(\&quot;图片压缩后Base64输出：\&quot;);console.log(rst.base64);&apos; +            &apos;reader.readAsDataURL(files[0]);&apos; +            &apos;reader.onload=function(e){&apos; +            &apos;var mb=(e.total\/1024)\/1024;&apos; +            &apos;if(mb&gt;=5){&apos; +            &apos;mui.alert(\&quot;上传的照片不可以大于5M，请重新上传\&quot;,\&quot;照片上传\&quot;);&apos; +            &apos;return&apos; +            &apos;}&apos; +            &apos;if(fileName.length &gt; 1 &amp;&amp; fileName ) {&apos; +            &apos;var ldot = fileName.lastIndexOf(&quot;.&quot;);&apos; +            &apos;var type = fileName.substring(ldot + 1);&apos; +            &apos;if( (type != \&quot;jpg\&quot;) &amp;&amp; (type != \&quot;png\&quot;) &amp;&amp; (type != \&quot;gif\&quot;)&amp;&amp;(type != \&quot;bmp\&quot;) &amp;&amp; (type != \&quot;jpeg\&quot;) ) {&apos; +            &apos;mui.alert(\&quot;请上传标准图片格式文件\&quot;,\&quot;照片上传\&quot;);&apos; +            &apos;return&apos; +            &apos;}&apos; +            &apos;}&apos; +            &apos;img.src=this.result;&apos; +//            &apos;/*未压缩*/&apos; +//            &apos;imgSrc = img.src;&apos; +//            &apos;console.log(\&quot;用户上传图片：\&quot; + imgSrc);&apos; +            &apos;/*已压缩*/&apos; +            &apos;imgSrc = rst.base64;&apos; +            &apos;console.log(\&quot;用户上传图片（已压缩）：\&quot; + imgSrc);&apos; +            &apos;console.log(\&quot;用户上传图片：\&quot; + rst.origin.name);&apos; +            &apos;&apos; +            &apos;/*截取字符串*/&apos; +            &apos;var imgIndex = imgSrc.lastIndexOf(\&quot;,\&quot;);&apos; +            &apos;var imgBase64 = imgSrc.substring(imgIndex + 1);&apos; +            &apos;console.log(&quot;截取后字符串：&quot; + imgBase64);&apos; +            &apos;/*后台接收参数上传 */&apos; +//          &apos;alert(decodeURIComponent(imgSrc));&apos; +            &apos;mui.post(\&quot;http:\/\/192.168.0.112:8080\/module1\/FileUpload\/mobile\/fileUpload\&quot;,{&apos; +            &apos;userId: 2,&apos; +            &apos;type: 1,&apos; +            &apos;fileName: rst.origin.name,&apos; +            &apos;base64ImgData: imgBase64&apos; +            &apos;},function(data){&apos; +            &apos;/*if (data.code == \&quot;200\&quot;) {mui.toast(\&quot;图片上传失败，请稍后或者重新上传\&quot;)}*/&apos; +            &apos;},&quot;json&quot;&apos; +            &apos;);&apos; +            &apos;img.style.width=\&quot;100%\&quot;;&apos; +            &apos;document.getElementById(\&quot;&apos; +            comp2 +            &apos;\&quot;).style.width=\&quot;80px\&quot;;&apos; +            &apos;document.getElementById(\&quot;&apos; +            comp2 +            &apos;\&quot;).style.height=\&quot;80px\&quot;;&apos; +            &apos;document.getElementById(\&quot;&apos; +            comp2 +            &apos;\&quot;).innerHTML=\&quot;\&quot;;&apos; +            &apos;document.getElementById(\&quot;&apos; +            comp2 +            &apos;\&quot;).appendChild(img)};&apos; +            &apos;});&apos; +            &apos;/*图片压缩END*/&apos; +            &apos;});&apos; +            &apos;\&lt;\/script\&gt;&apos;        );    }&lt;/script&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript遍历JSON数据</title>
      <link href="/javascript-traverses-json-data.html"/>
      <url>/javascript-traverses-json-data.html</url>
      
        <content type="html"><![CDATA[<p>获取的JSON数据如下：</p><pre><code>{    &quot;code&quot;: 200,    &quot;message&quot;: &quot;操作成功！&quot;,    &quot;nowPage&quot;: 1,    &quot;pageSize&quot;: 3,    &quot;rows&quot;: [        {            &quot;id&quot;: 2,            &quot;phone&quot;: &quot;222222&quot;,            &quot;nickname&quot;: &quot;大米&quot;,            &quot;baoXiuQuYu&quot;: &quot;个人住宅&quot;,            &quot;state&quot;: 1,            &quot;bxTime&quot;: &quot;2016-12-12 00:00:00&quot;,            &quot;bxContent&quot;: &quot;222&quot;        },        {            &quot;id&quot;: 4,            &quot;phone&quot;: &quot;44444&quot;,            &quot;nickname&quot;: &quot;兰欣&quot;,            &quot;baoXiuQuYu&quot;: &quot;个人住宅&quot;,            &quot;state&quot;: 1,            &quot;bxTime&quot;: &quot;2016-12-05 00:00:00&quot;,            &quot;bxContent&quot;: &quot;444&quot;        },        {            &quot;id&quot;: 1,            &quot;phone&quot;: &quot;111111&quot;,            &quot;nickname&quot;: &quot;小米&quot;,            &quot;baoXiuQuYu&quot;: &quot;个人住宅&quot;,            &quot;state&quot;: 1,            &quot;bxTime&quot;: &quot;2016-12-04 00:00:00&quot;,            &quot;bxContent&quot;: &quot;1111&quot;        }    ],    &quot;total&quot;: 4,    &quot;totalPage&quot;: 2}</code></pre><p>由于项目中需要得到某个状态值，例如state，遍历得到他的总数：</p><pre><code>console.log(JSON.stringify(data.rows));//控制台输出json        var objs = eval(data.rows);        console.log(&quot;遍历JSON数据几条：&quot;+objs.length);        var stuNum = 0;        for(var i = 0; i &lt; objs.length; i++) {            console.log(&quot;获取状态值：&quot;+objs[i].state);            if (objs[i].state == 2 ) {                stuNum ++;                console.log(&quot;状态值为1的一共有：&quot;+stuNum);            }        }        console.log(&quot;总数：&quot;+stuNum);</code></pre><p>关于eval()解释：<a href="http://www.w3school.com.cn/jsref/jsref_eval.asp" target="_blank" rel="noopener">3wschool</a></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Json </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>正确的科学上网姿势</title>
      <link href="/fuck-the-gfw.html"/>
      <url>/fuck-the-gfw.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>之前一直用那个Sha#dow#socks（以下简称SS），虽然SS一直更新，稳定，但长时间使用你会发现很多缺点：</p><ul><li>作为前端开发者，需要使用 NPM，但是 NPM packages 基本都开源在 GitHub，而 GitHub 的访问速度很慢（并没有被墙），而 GitHub 的静态资源都存储在亚马逊的 AWS 云服务器（被墙），所以下载 GitHub 上的开源代码很慢、几乎无法下载 GitHub 上的代码压缩包或者项目编译后的版本包；</li><li>作为前端开发者，CNPM v4 在 Windows 上的兼容性不好，时不时会遇到一些莫名其妙的问题；</li><li>大部分国外网站的访问速度都很慢，因为没有在中国大陆使用 CDN（内容分发网络），或者也有可能是 GFW 的原因。</li></ul><p>所有这些问题，归根结底，在于 SS 使用的是黑名单 PAC。</p><h3 id="黑名单和白名单"><a href="#黑名单和白名单" class="headerlink" title="黑名单和白名单"></a>黑名单和白名单</h3><p>所谓黑名单，是指将“需要科学上网”的网址（域名）都记录在一个文件里，这个文件就是一份黑名单。科学上网软件通过判断将要访问的网址是否在黑名单里。该网站在黑名单里的话，就通过科学上网来访问该网址；不在的话，就不通过科学上网，直接连接。而白名单则相反。</p><blockquote><p>可见，黑名单模式最大的弊端在于：要一直维护这份黑名单，否则哪天某个网站被墙了，而黑名单没有及时更新，就无法访问该网站了。</p></blockquote><h3 id="MEOW-的杀手锏"><a href="#MEOW-的杀手锏" class="headerlink" title="MEOW 的杀手锏"></a>MEOW 的杀手锏</h3><p>除了 SS，还有一个名为 COW 的项目也是大名鼎鼎，为什么也不用 COW 呢？其实 MEOW 是 COW 的一个 Fork 分支，它在 COW 的基础上，提供了智能分流的功能。 所谓智能分流，就是 MEOW 会自动判断哪些网址是中国大陆的网址，哪些是国外网址。对于大陆的网址，将会直接连接，不通过 MEOW 和 SS 服务；对于国外网址，通过 MEOW 和 SS 服务。</p><blockquote><p>所以，MEOW 最大的好处是能节省科学上网服务的流量的同时，为访问国外网站“加速”。 个人认为，能通过判断 IP 地址所在地来决定是否使用智能分流，才是一个科学上网软件优秀与否的评判标准。MEOW 做到了，并为我节省了很多宝贵时间。</p></blockquote><h3 id="科普：为何智能分流能加速访问国外网站？"><a href="#科普：为何智能分流能加速访问国外网站？" class="headerlink" title="科普：为何智能分流能加速访问国外网站？"></a>科普：为何智能分流能加速访问国外网站？</h3><p>首先，为了能实现科学上网，科学上网服务的服务器都部署在中国大陆以外的各个地区（除非你是出国党想要翻回中国大陆，下文会提及），有香港、日本、新加坡、美国等……这些服务器扮演的角色是：我们的电子设备与目标网站的中间者。</p><ul><li>假如我们访问国内的网站，需要先经过位于国外的科学上网的服务器，再来到国内的目标网站，相当于兜了一个大圈，肯定很慢；</li><li>假如我们要访问国外的网站（由于 GFW 的原因，本来很慢；或者没有使用 CDN），先经过科学上网服务的服务器（中间者），让不在 GFW 管辖范围内的这些中间者服务器将目标网站的内容快速地加载出来，然后直接传给我们的电子设备。这个过程虽然增加了中间者的角色，连接目标网站的时间要长一点，但是访问的速度加快了，整体而言也就是访问国外网站“加速”了。</li></ul><h3 id="MEOW-配合-SS-服务的使用方法"><a href="#MEOW-配合-SS-服务的使用方法" class="headerlink" title="MEOW 配合 SS 服务的使用方法"></a>MEOW 配合 SS 服务的使用方法</h3><p>GitHub 的项目地址：<a href="https://github.com/renzhn/MEOW" target="_blank" rel="noopener">https://github.com/renzhn/MEOW</a> 各大系统平台下载地址：<a href="https://github.com/renzhn/MEOW/tree/gh-pages/dist/" target="_blank" rel="noopener">https://github.com/renzhn/MEOW/tree/gh-pages/dist/</a></p><blockquote><p>下面以Windows平台为准：</p></blockquote><p>打开下载好的压缩包，可以看到包含这么几个文件：</p><ul><li><code>rc.txt</code> 和 <code>rc-full.txt</code> 都是 MEOW 的配置文件（以 <code>rc.txt</code> 命名的文件，才是真正起作用的配置文件。<code>rc-full.txt</code> 是带有详细描述的备份配置文件，用于理解各项配置的含义，需要重命名为 <code>rc.txt</code>，该配置文件才能起作用。）；</li><li><code>MEOW.exe</code> 是运行文件，双击它即可运行 MEOW；</li><li><code>direct.txt</code> 是不使用 MEOW 的网址列表；</li><li><code>proxy.txt</code> 是使用 MEOW 的网址列表；</li><li><code>reject.txt</code> 是拒绝访问的网址列表，包含主流的用户数据追踪网站（例如友盟）、手机广告投放网站。</li></ul><blockquote><p>放在 reject.txt 里的网站都是无法访问的。如果平时需要使用友盟（umeng.com）的服务，请务必把 reject.txt 里的 umeng.com 和 umeng.co 删掉，保存，重新载入 MEOW。</p></blockquote><h3 id="设置"><a href="#设置" class="headerlink" title="设置"></a>设置</h3><ol><li>删掉 <code>rc.txt</code> 文件；</li><li>将 <code>rc-full.txt</code> 文件重命名为 <code>rc.txt</code>（也就是说，这里使用带有详细使用说明的 <code>rc-full.txt</code> 文件的内容作为 MEOW 的配置）；</li><li>用记事本或代码编辑器打开 <code>rc.txt</code> 文件。将下图中这几行的井号（#）去掉，使其生效： 1. <code>listen = http://0.0.0.0:4411</code> 意思是在本局域网内（同一个路由器或 WiFi 所在的网络）提供一个端口号为 4411 的 HTTP 代理；</li><li><code>judgeByIP = true</code> 就是通过 IP 地址判断是否直连，这个配置开启了智能分流功能；</li><li><code>loadBalance = latency</code> 是用于配合下面的 SS 科学上网服务的。latency 意为优先选择连接延迟最低的 SS 二级代理。</li><li>然后在指定二级代理下面的 proxy 设置：<code>proxy = ss://加密方式:登录密码@节点服务器地址:服务器端口号</code></li><li>双击运行 <code>MEOW.exe</code>。这时任务栏就会出现 MEOW 的图标。右键单击图标，选择“设置 IE 代理” – “ <code>http://127.0.0.1:4411/pac</code> ”。</li></ol><blockquote><p>只要 MEOW 配置文件中的代理服务器数量大于 1，上面设置的 loadBalance = latency这句配置就会起作用。此时 MEOW 会隔一段时间检查一下配置文件中所有服务器的连接情况，<strong>自动选择延时最短的服务器进行连接</strong>。</p></blockquote><h3 id="macOS-和-Linux-用户"><a href="#macOS-和-Linux-用户" class="headerlink" title="macOS 和 Linux 用户"></a>macOS 和 Linux 用户</h3><h4 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h4><p>macOS 和 Linux 系统，请使用 Terminal 终端工具或 Bash 命令行工具。在用户主目录下，执行下面命令：<code>curl -L git.io/meowproxy | bash</code> macOS 用户请使用系统自带的搜索功能，输入“Terminal”即可找到 Terminal 终端工具，输入上面的命令后，按回车，即可执行该命令。 可以输入 <code>cd ~</code>，回车，回到用户主目录。 下载 MEOW 期间，会问是否要将 MEOW 添加到开机自启动，输入 Y（是），回车。 设置 完成后，MEOW 可执行文件就会在用户主目录下，同时还有一个 <code>.meow</code> 隐藏文件夹，里面的文件与 <code>Windows</code> 版的一一对应：</p><ul><li>direct</li><li>proxy</li><li>reject</li><li>rc</li><li>rc-full 配置文件 <code>rc</code> 的内容跟 <code>Windows</code> 版本的也完全一致。</li></ul><blockquote><p>由于 <code>.meow</code> 文件夹是隐藏的，只有在 <code>Terminal</code> 或者 <code>Bash</code> 命令行工具下通过 ls 命令才能看到。编辑 rc 配置文件可以这样：<code>vi ~/.meow/rc</code> 编辑 rc 配置文件，按字母 <code>i</code> 进入 vi 编辑器的编辑模式。配置语句参考 Windows 版配置文件。编辑完成后，按<code>:wq</code>保存退出。</p></blockquote><ol><li>编辑完配置文件后，执行命令 <code>./MEOW &amp;</code> 在后台静默启动 MEOW；</li><li>此时进入 macOS 的“网络偏好设置”，点右下角的“高级…”，在弹出的页面中选中“代理”标签页，勾选“自动代理配置”；</li><li>右边 “URL” 中填写 <code>http://0.0.0.0:4411/pac</code></li><li>此时可以打开谷歌首页 <code>http://www.google.com</code>，测试是否能访问成功；</li></ol><h3 id="命令行代理配置及开发环境配置"><a href="#命令行代理配置及开发环境配置" class="headerlink" title="命令行代理配置及开发环境配置"></a>命令行代理配置及开发环境配置</h3><blockquote><p>命令行代理配置</p></blockquote><p>在命令行提示符或者终端中也能科学上网如下设置： <a href="https://www.loyalsoldier.me/content/images/2016/09/develop-config-1.png" target="_blank" rel="noopener"><img src="https://www.loyalsoldier.me/content/images/2016/09/develop-config-1.png" alt></a></p><ul><li><p>Windows 用户打开系统环境变量，点击“新建”，依次添加以下两条环境变量，重启电脑后生效： <code>`</code>bash HTTP_PROXY <a href="http://127.0.0.1:4411" target="_blank" rel="noopener">http://127.0.0.1:4411</a><br>HTTPS_PROXY <a href="http://127.0.0.1:4411" target="_blank" rel="noopener">http://127.0.0.1:4411</a>`</p><ul><li>macOS 和 Linux 用户，在终端或命令行中依次执行以下命令，重新加载命令行或终端后生效：<br><code>`</code>bash<br>vi ~/.bash_profile（使用 bash 的用户请执行这条命令，默认是 bash）<br>vi ~/.zsh_profile （使用 zsh 的用户请执行这条命令）</li></ul></li></ul><p>在文件最后加入以下两句命令（保存，重启终端后生效）：</p><pre><code>export http_proxy=&quot;http://127.0.0.1:4411&quot;export https_proxy=&quot;http://127.0.0.1:4411&quot;</code></pre><p>此时，除了 ping 等 Windows 系统自带命令，其余一切 <code>CLI</code> 命令均使用了 MEOW 的 HTTP 代理，从而实现智能分流，加速下载。此方法只对当前系统用户有效，其余用户需要按照步骤重新设置。</p><h3 id="开发环境配置"><a href="#开发环境配置" class="headerlink" title="开发环境配置"></a>开发环境配置</h3><p>MEOW 启动之后，就在本局域网的 <code>4411</code> 端口上开启了一个 HTTP 代理。所有支持 HTTP 代理的开发软件都可以配置 IP 地址 <code>0.0.0.0</code> 和端口 <code>4411</code> 使用 HTTP 代理，从而使用 MEOW 的智能分流功能加速下载。</p><ul><li>对于前端 NPM ： - 因为会智能分流，配合淘宝的 CNPM 镜像才是最快的：npm config set registry=<a href="https://registry.npm.taobao.org" target="_blank" rel="noopener">https://registry.npm.taobao.org</a></li><li>让 NPM Packages 的安装过程变得可视化：npm config set loglevel=http</li><li>安装失败后，最好先清除 NPM 的缓存文件，强制删除 node_modules 文件夹，再重新安装：npm cache clean、rm -rf node_modules</li><li>最重要：Windows 下编译 Node 的 C++ 模块终于不需要安装 Visual Studio 这个大块头了：npm install –global –production windows-build-tools；这个项目的地址：windows-build-tools</li><li>上面这个命令跑完之后，可以尝试安装 gulp-image 这个 Package 测试一下是否成功：npm install gulp-image</li><li>如果你使用 macOS，可以尝试使用 cnpm v4：npm install -g cnpm。cnpm v4 采用跟 npm 完全不一样的实现方式，超快。但在 Windows 下暂时有莫名其妙的坑，请勿在 Windows 平台下使用。</li><li>也可以尝试使用 Facebook 开源的 Yarn 包管理器，以取代 npm</li><li>对于 PHP 后端： 请使用国内的 Composer 全量镜像：composer config -g repo.packagist composer <a href="https://packagist.phpcomposer.com" target="_blank" rel="noopener">https://packagist.phpcomposer.com</a></li><li>对于 Ruby 后端： 请使用国内的 Ruby Gem 全量镜像：gem sources –add <a href="https://gems.ruby-china.org/" target="_blank" rel="noopener">https://gems.ruby-china.org/</a> –remove <a href="https://rubygems.org/" target="_blank" rel="noopener">https://rubygems.org/</a></li><li>对于 Android 开发者： 给 Android Studio 设置 HTTP 代理：<a href="http://127.0.0.1:4411" target="_blank" rel="noopener">http://127.0.0.1:4411</a></li><li>对于后端运维： - Docker for Windows 和 Docker for Mac：可在 Docker Daemon 可视化界面下配置 HTTP 代理：<a href="http://127.0.0.1:4411" target="_blank" rel="noopener">http://127.0.0.1:4411</a></li><li>Docker for Linux：可参照阿里云 Docker 镜像仓库加速器指南进行配置</li><li>Linux 运维：可使用 MEOW Linux 版本，配合 SS 服务实现生产服务器科学上网</li><li>通用用法：反正可以设置 HTTP 代理的开发软件，都可以尝试设置 HTTP 代理以实现下载加速：<a href="http://127.0.0.1:4411" target="_blank" rel="noopener">http://127.0.0.1:4411</a></li></ul><blockquote><p>这两种设置方法相当于为命令行交互界面（CLI）下的所有命令都设置了代理。以后运行命令前，必须保证 MEOW 代理正常运行，需要网络支持的命令才能正常执行。 正如不翻阅英文开发文档一样，不用科学上网的开发者月薪永远不超过 10K ：）</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2016年总结以新年计划</title>
      <link href="/2016-summed-and-2017-plan.html"/>
      <url>/2016-summed-and-2017-plan.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>岁月如梭，年华似水，手指尖匆匆流过那一年。一年前的你是否记得…(老子不写了，装什么文艺！)</p><p>2016年，过得比2015年好多了，但不开心的事也多得去…所以总结下今年的事以及明年的计划。</p><h3 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h3><p>细想出来混社会差不多有四年多了，一年前不会想到今天会转行做程序猿。之前做过电子厂操作工，码头的搬运工，满大街的推销员……做过各种各样的社会底层职业，那段时间对我来说很痛苦，也很绝望，一度觉得这辈子也只能这样了。还好性格没有被生活磨灭，对这样的路，很不满意，正如你所看到，目前所掌握的技能，都是自学而来的。可能学习过程中太枯燥，甚至想放弃，总有那么一句话支撑着自己：「骚年，别放弃自己！」</p><p>现在在职第三家公司，也是年前在老家找到的一份前端的工作。因个人原因，长期留在老家，希望新的一年和公司一起加油！</p><h3 id="家事"><a href="#家事" class="headerlink" title="家事"></a>家事</h3><p>今年，我正式加入单亲列队，父母在今年7，8月分就离异了。说实话，当是知道他们离婚的事，表现很平静。从小的记忆，只有他们俩个人的争吵，面对这样的生活，早已习惯。或许离婚对他们来说亦对我来说，是为了更好的生活。</p><p>这下好了，我处于他们战争的中心，以我的借口，各种要求…有时候真的挺讨厌他们的，老是为自己考虑…唉，摊上这类父母亲，也只能认命了吧。目前这情况也不知道怎么办，好烦躁，爷爷奶奶让我别管他们的事，该上班的上班，该生活的生活，好吧，目前也只能这样了！</p><h3 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h3><p>今年感觉没多大的事，每天也就那样过来。毕竟有了生活习惯，再长的时间也过来了。</p><p>今年剁手Mac和一加3以及米5SP，到了年底也没多少储蓄，信用卡也刷爆了，穷的今年年末只能吃土了……这剁手也真的要剁手了！明年真的多少存点钱！</p><h3 id="计划"><a href="#计划" class="headerlink" title="计划"></a>计划</h3><ul><li style="list-style: none"><input type="checkbox"> 稳定工作</li><li style="list-style: none"><input type="checkbox"> 信用额度全部还清</li><li style="list-style: none"><input type="checkbox"> 分期物品全部还清</li><li style="list-style: none"><input type="checkbox"> 存钱</li><li>[ √ ] 坚持锻炼，主要骑行和跑步</li><li style="list-style: none"><input type="checkbox"> 英语复习计划</li><li style="list-style: none"><input type="checkbox"> 谈个对象（女），陪伴走完一生的那种</li><li>[ √ ] 坚持写博客</li><li style="list-style: none"><input type="checkbox"> 多结交不同职业领域的新朋友</li><li style="list-style: none"><input type="checkbox"> 增加社交活动以及扩大社交圈</li><li style="list-style: none"><input type="checkbox"> 自主完成Java语言编写的轻量级博客系统</li><li style="list-style: none"><input type="checkbox"> 自主完成Node.JS编写的清单计划管理系统</li><li style="list-style: none"><input type="checkbox"> 使用MUI框架编写WordPress客户端</li><li>[ √ ] 完成2016年个人简历项目遗留的坑</li><li style="list-style: none"><input type="checkbox"> 系统性学习Linux运维知识</li><li style="list-style: none"><input type="checkbox"> 掌握Python语言</li><li style="list-style: none"><input type="checkbox"> 学习Docker</li></ul><h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><p>最后祝福朋友们新年快乐，新的一年，新的征途，愿风指引着你的道路，愿你的刀刃永远锋利。</p><p>最后，平淡的2016年，再见了！</p><p>2017年，你好，请多多关照！</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>iOS10.1.1修改OpenSSH通道密码</title>
      <link href="/password-ios10-1-1-modify-openssh-channels.html"/>
      <url>/password-ios10-1-1-modify-openssh-channels.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>一般人可能不知道这是什么玩意儿，如果黑客拿到就等于掌握你的手机了。所以对于普通用户在使用SSH通道时应该注意修改其登陆密码,以防被其他人恶意登陆后获取掉设备内的资料。</p><h3 id="Cydia安装"><a href="#Cydia安装" class="headerlink" title="Cydia安装"></a>Cydia安装</h3><p>安装<code>OpenSSH</code>插件，截图如下</p><p><img src="https://picabstract-preview-ftn.weiyun.com:8443/ftn_pic_abs_v2/fac6bc317817e1d765e470d7ba0c8ed12b82253207a5efda721ab52760741e13904b866d000b706c42fa04867861ffa3?pictype=scale&amp;from=30013&amp;version=2.0.0.2&amp;uin=764827577&amp;fname=IMG_0083.PNG&amp;size=1024*1024" alt></p><h3 id="电脑"><a href="#电脑" class="headerlink" title="电脑"></a>电脑</h3><p>手机连接电脑，Windows可以用<code>WinSCP</code>来联机，我就不多说了。本文是Mac环境，下面我就稍微说下。</p><p>1.首先手机和电脑都要在同一个局域网。手机的IP地址可以在WIFI列表看到，你所连接的WIFI，右边有个感叹号，点进去有个<code>IP地址</code>。</p><p>2.打开你的终端()，输入命令</p><pre><code>ssh root@192.168.0.102 -p22</code></pre><p>3.提示输入密码，默认密码为：<code>alpine</code>，回车确认就登录成功了</p><p>4.再输人<code>passwd</code>即可修改密码。要输入俩次才能生效。</p><h3 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h3><blockquote><p>Cat:~ jaxson$ ssh <a href="mailto:root@192.168.0.102" target="_blank" rel="noopener">root@192.168.0.102</a> -p22 ssh: connect to host 192.168.0.102 port 22: Connection refused</p></blockquote><p>解决：打开系统偏好设置—共享，选中远程登录</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>iOS10.1.1(14B150)越狱记录</title>
      <link href="/ios10-jailbreak-notes.html"/>
      <url>/ios10-jailbreak-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>几天前，Todesco 就宣布计划推出基于 iOS 10.1.1 内核和 root 漏洞的越狱。在发布越狱后他还提到，mobile substrate 已经被蓄意破坏，所以目前大多数的插件都无法工作。和其它越狱工具不同，本次发布的越狱测试版并不是一个基于 GUI 的工具，它是一个 Xcode 项目。</p><p>越狱目前支持 iPhone 7、iPhone 7 Plus、iPhone 6s、iPhone 6s Plus、9.7 英寸 iPad Pro 和 12.9 英寸 iPad Pro。稍后，Todesco 还计划为其它兼容的 64 位设备添加支持。</p><p>且越狱环境和iOS9.3.3极为相似，若重启得重新点开越狱APP进行越狱。</p><h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><p>iMac 10.12.2</p><p>iPhone 6S Plus iOS10.1.1(14B150)</p><h3 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h3><p>iTunes：</p><p>下载链接：<a href="http://www.apple.com/cn/itunes/download/" target="_blank" rel="noopener">http://www.apple.com/cn/itunes/download/</a></p><p>Cydia importor（签名工具）：</p><p>下载链接：<a href="http://www.cydiaimpactor.com/" target="_blank" rel="noopener">http://www.cydiaimpactor.com/</a></p><p>mach_portal+Yalu-b3（越狱APP）：</p><p>下载链接：<a href="https://yalu.qwertyoruiop.com/" target="_blank" rel="noopener">https://yalu.qwertyoruiop.com/</a></p><h3 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h3><p>1、下载好需要的工具，然后把设备连接电脑</p><p>2、连接成功后，运行已经下载好的Cydia impactor</p><p>3、然后拖动下载好的mach_portal+Yalu-b3.ipa到Cydia impactor中，</p><p>4、由于苹果系统自身的限制，因此需要对ipa签名，因此下面会让我们输入我们的apple id，这样一来可以对其进行属于自己的签名，如图输入id帐号然后点击ok</p><p>5、然后会自动进行签名步骤，并会将其安装到我们的设备</p><p>6、安装到设备后，我们去对其信任一下</p><p>7、然后在设备上运行mach_portal，即可完成越狱</p><h3 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h3><blockquote><p>Error provision.cpp:150 Please sign in with an app-specific password.</p></blockquote><p>解决：这个是150报错，因为你的ID开启了俩部验证，所以请登录你的Apple ID获取App密码复制到Cydia Impactor即可</p><blockquote><p>Error Time out</p></blockquote><p>解决：反正我挂SS是不行的，不走Http协议，想办法上个VPN吧</p><blockquote><p>点开桌面mach_portal卡死</p></blockquote><p>解决：等了几分钟没反应，只好强制重启了(home+电源键)…</p><blockquote><p>Cydia点开闪退</p></blockquote><p>解决：建议全局代理，小火箭的代理模式就可以了，然后再点mach_portal进去耐心等待它加载完毕(加载完毕会自动退出到桌面)</p><h3 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h3><p><img src="https://picabstract-preview-ftn.weiyun.com:8443/ftn_pic_abs_v2/bf45388a4a564ba549c130cc53ceee486b4526b15c81c9d1841f4eb6ee78f25c452bcacd299fef827d0438089fe6818c?pictype=scale&amp;from=30013&amp;version=2.0.0.2&amp;uin=764827577&amp;fname=IMG_0077.PNG&amp;size=1024*1024" alt></p><p><img src="https://picabstract-preview-ftn.weiyun.com:8443/ftn_pic_abs_v2/643721dc4eefedaa57881a15e354c52db868b639aa7de16b5ee4fa4f9d607450618ad42b111bedad8506577aa6d218cd?pictype=scale&amp;from=30013&amp;version=2.0.0.2&amp;uin=764827577&amp;fname=IMG_0078.PNG&amp;size=1024*1024" alt></p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一些头部meta标签信息</title>
      <link href="/meta-tag-information-notes.html"/>
      <url>/meta-tag-information-notes.html</url>
      
        <content type="html"><![CDATA[<p>使用 HTML5 doctype，不区分大小写</p><p>更加标准的 lang 属性写法 <a href="http://zhi.hu/XyIa" target="_blank" rel="noopener">http://zhi.hu/XyIa</a></p><pre><code>&lt;html lang=&quot;zh-cmn-Hans&quot;&gt;</code></pre><h3 id="meta"><a href="#meta" class="headerlink" title="meta"></a>meta</h3><p>声明文档使用的字符编码</p><pre><code>&lt;meta charset=&apos;utf-8&apos;&gt;</code></pre><p>优先使用 IE 最新版本和 Chrome</p><pre><code>&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge,chrome=1&quot;/&gt;</code></pre><p>页面描述</p><pre><code>&lt;meta name=&quot;description&quot; content=&quot;不超过150个字符&quot;/&gt;</code></pre><p>页面关键词</p><pre><code>&lt;meta name=&quot;keywords&quot; content=&quot;&quot;/&gt;</code></pre><p>网页作者</p><pre><code>&lt;meta name=&quot;author&quot; content=&quot;name, email@gmail.com&quot;/&gt;</code></pre><p>搜索引擎抓取</p><pre><code>&lt;meta name=&quot;robots&quot; content=&quot;index,follow&quot;/&gt;</code></pre><p>为移动设备添加 viewport</p><pre><code>&lt;meta name=&quot;viewport&quot; content=&quot;initial-scale=1, maximum-scale=3, minimum-scale=1, user-scalable=no&quot;&gt;    &lt;!-- `width=device-width` 会导致 iPhone 5 添加到主屏后以 WebApp 全屏模式打开页面时出现黑边 http://bigc.at/ios-webapp-viewport-meta.orz --&gt;</code></pre><h3 id="iOS-设备"><a href="#iOS-设备" class="headerlink" title="iOS 设备"></a>iOS 设备</h3><p>添加到主屏后的标题（iOS 6 新增）</p><pre><code>&lt;meta name=&quot;apple-mobile-web-app-title&quot; content=&quot;标题&quot;&gt;</code></pre><p>是否启用 WebApp 全屏模式，删除苹果默认的工具栏和菜单栏</p><pre><code>&lt;meta name=&quot;apple-mobile-web-app-capable&quot; content=&quot;yes&quot;/&gt;</code></pre><p>添加智能 App 广告条 Smart App Banner（iOS 6+ Safari）</p><pre><code>&lt;meta name=&quot;apple-itunes-app&quot; content=&quot;app-id=myAppStoreID, affiliate-data=myAffiliateData, app-argument=myURL&quot;&gt;</code></pre><p>设置苹果工具栏颜色</p><pre><code>&lt;meta name=&quot;apple-mobile-web-app-status-bar-style&quot; content=&quot;black&quot;/&gt;</code></pre><p>忽略页面中的数字识别为电话，忽略email识别</p><pre><code>&lt;meta name=&quot;format-detection&quot; content=&quot;telphone=no, email=no&quot;/&gt;</code></pre><p>启用360浏览器的极速模式(webkit)</p><pre><code>&lt;meta name=&quot;renderer&quot; content=&quot;webkit&quot;&gt;</code></pre><p>避免IE使用兼容模式</p><pre><code>&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</code></pre><p>针对手持设备优化，主要是针对一些老的不识别viewport的浏览器，比如黑莓</p><pre><code>&lt;meta name=&quot;HandheldFriendly&quot; content=&quot;true&quot;&gt;</code></pre><p>微软的老式浏览器</p><pre><code>&lt;meta name=&quot;MobileOptimized&quot; content=&quot;320&quot;&gt;</code></pre><p>uc强制竖屏</p><pre><code>&lt;meta name=&quot;screen-orientation&quot; content=&quot;portrait&quot;&gt;</code></pre><p>QQ强制竖屏</p><pre><code>&lt;meta name=&quot;x5-orientation&quot; content=&quot;portrait&quot;&gt;</code></pre><p>UC强制全屏</p><pre><code>&lt;meta name=&quot;full-screen&quot; content=&quot;yes&quot;&gt;</code></pre><p>QQ强制全屏</p><pre><code>&lt;meta name=&quot;x5-fullscreen&quot; content=&quot;true&quot;&gt;</code></pre><p>UC应用模式</p><pre><code>&lt;meta name=&quot;browsermode&quot; content=&quot;application&quot;&gt;</code></pre><p>QQ应用模式 windows phone 点击无高光</p><pre><code>&lt;meta name=&quot;msapplication-tap-highlight&quot; content=&quot;no&quot;&gt;</code></pre><h3 id="iOS-图标"><a href="#iOS-图标" class="headerlink" title="iOS 图标"></a>iOS 图标</h3><p>iPhone 和 iTouch，默认 57×57 像素，必须有</p><pre><code>&lt;link rel=&quot;apple-touch-icon-precomposed&quot; href=&quot;/apple-touch-icon-57x57-precomposed.png&quot;/&gt;</code></pre><p>Retina iPhone 和 Retina iTouch，114×114 像素，可以没有，但推荐有</p><pre><code>&lt;link rel=&quot;apple-touch-icon-precomposed&quot; sizes=&quot;114x114&quot; href=&quot;/apple-touch-icon-114x114-precomposed.png&quot;/&gt;</code></pre><p>Retina iPad，144×144 像素，可以没有，但推荐有</p><pre><code>&lt;link rel=&quot;apple-touch-icon-precomposed&quot; sizes=&quot;144x144&quot; href=&quot;/apple-touch-icon-144x144-precomposed.png&quot;/&gt;</code></pre><h3 id="iOS-启动画面"><a href="#iOS-启动画面" class="headerlink" title="iOS 启动画面"></a>iOS 启动画面</h3><p>iPad 竖屏 768 x 1004（标准分辨率）</p><pre><code>&lt;link rel=&quot;apple-touch-startup-image&quot; sizes=&quot;768x1004&quot; href=&quot;/splash-screen-768x1004.png&quot;/&gt;</code></pre><p>iPad 竖屏 1536×2008（Retina）</p><pre><code>&lt;link rel=&quot;apple-touch-startup-image&quot; sizes=&quot;1536x2008&quot; href=&quot;/splash-screen-1536x2008.png&quot;/&gt;</code></pre><p>iPad 横屏 1024×748（标准分辨率）</p><pre><code>&lt;link rel=&quot;apple-touch-startup-image&quot; sizes=&quot;1024x748&quot; href=&quot;/Default-Portrait-1024x748.png&quot;/&gt;</code></pre><p>iPad 横屏 2048×1496（Retina）</p><pre><code>&lt;link rel=&quot;apple-touch-startup-image&quot; sizes=&quot;2048x1496&quot; href=&quot;/splash-screen-2048x1496.png&quot;/&gt;</code></pre><p>iPhone/iPod Touch 竖屏 320×480 (标准分辨率)</p><pre><code>&lt;link rel=&quot;apple-touch-startup-image&quot; href=&quot;/splash-screen-320x480.png&quot;/&gt;</code></pre><p>iPhone/iPod Touch 竖屏 640×960 (Retina)</p><pre><code>&lt;link rel=&quot;apple-touch-startup-image&quot; sizes=&quot;640x960&quot; href=&quot;/splash-screen-640x960.png&quot;/&gt;</code></pre><p>iPhone 5/iPod Touch 5 竖屏 640×1136 (Retina)</p><pre><code>&lt;link rel=&quot;apple-touch-startup-image&quot; sizes=&quot;640x1136&quot; href=&quot;/splash-screen-640x1136.png&quot;/&gt;</code></pre><h3 id="iOS-设备-end"><a href="#iOS-设备-end" class="headerlink" title="iOS 设备 end"></a>iOS 设备 end</h3><p>Windows 8 磁贴颜色</p><pre><code>&lt;meta name=&quot;msapplication-TileColor&quot; content=&quot;#000&quot;/&gt;</code></pre><p>Windows 8 磁贴图标</p><pre><code>&lt;meta name=&quot;msapplication-TileImage&quot; content=&quot;icon.png&quot;/&gt;</code></pre><p>添加 RSS 订阅</p><pre><code>&lt;link rel=&quot;alternate&quot; type=&quot;application/rss+xml&quot; title=&quot;RSS&quot; href=&quot;/rss.xml&quot;/&gt;</code></pre><p>添加 favicon icon</p><pre><code>&lt;link rel=&quot;shortcut icon&quot; type=&quot;image/ico&quot; href=&quot;/favicon.ico&quot;/&gt;</code></pre><p>标题</p><pre><code>&lt;title&gt;标题&lt;/title&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>买了一辆山地车</title>
      <link href="/bought-a-mountain-bike.html"/>
      <url>/bought-a-mountain-bike.html</url>
      
        <content type="html"><![CDATA[<p>为何买？可不想莫名其妙猝死…加强锻炼，拥有强健的体魄，是做任何事的有利基础。嗯，说得好有道理…</p><p>最主要我要装逼，而且是装个持久的。😄主要家里和公司有18公里的路，公交车平均半小时一班车，而且完全没有固定时间安排可言…再加之天天坐在电脑前不运动，这身体吃枣药丸，还是锻炼身体吧，一天32公里路，坚持下来，多少有点效果的。</p><p>所以对于车子，上个星期就开始物色了。总之上个星期纠结到底买智能单车还是传统变速车，看了知乎，各种偏向于传统变速车，好吧，只要是智能单车的功能，在传统型变速车加个配件也能实现了。之后又开始纠结选择品牌了，什么捷安特，美利达，java，还有个啥来的，忘了…</p><p>综合来看，从品牌效应，质量，人性化以及售后，我觉得就捷安特不错。mdzz，最主要我们城市好多好多捷安特专卖店，再加之初中时候也买过捷安特的山地车，貌似是ATX500系列的吧，记得不是太清楚，之后还是被偷了…</p><p>你猜我这次我买了啥？捷安特ATX850，反正也不用买太好的，主要是健身而已。</p><p><img src="https://picabstract-preview-ftn.weiyun.com:8443/ftn_pic_abs_v2/58b9f636eda1c482df481b34b2ee939d795baf0bc7377cfcb249b7d6a94adf764e8536e6521f35afe90fd38e128c0259?pictype=scale&amp;from=30013&amp;version=2.0.0.2&amp;uin=764827577&amp;fname=IMG_0050.JPG&amp;size=1024*1024" alt></p><p>店里有黑红，黑绿，黑橙，黑白的..听说还有黑蓝的，但我们这却没有。看了半天就觉得黑红骚气点，就选他了，送了车撑子，水壶架这些。价格是3500左右的，赶上活动打7折，也就2600左右，又买个手套和车锁，加起来差不多3000元了，看来这几个月要吃土了…真的是穷光蛋了。</p><p>中午从专门店回到公司，路程差不多6km，啧，足足花了半小时。说实话，真是慢，到了公司也差不多累得半死，果然不运动是不行的。</p><p><img src="https://picabstract-preview-ftn.weiyun.com:8443/ftn_pic_abs_v2/35ec10e1668ae5bb33d9a7a3ff1a5e8dac77ec257d74449e6661cdc6fe5ee98a824404de25818fbdfe2284a1d44999b4?pictype=scale&amp;from=30013&amp;version=2.0.0.2&amp;uin=764827577&amp;fname=IMG_0044.PNG&amp;size=1024*1024" alt></p><p>然后晚上下班，18km，花了我接近一小时了。马丹，主要是下雨，不然我可更快些。</p><p><img src="https://picabstract-preview-ftn.weiyun.com:8443/ftn_pic_abs_v2/043dcac9a1b10b192d2d8978f7aff4d495e8886210c93b57fee40110aefd39ff93a489f58b3f733c1e5bf589019f5c8f?pictype=scale&amp;from=30013&amp;version=2.0.0.2&amp;uin=764827577&amp;fname=IMG_0046.PNG&amp;size=1024*1024" alt></p><p><img src="https://picabstract-preview-ftn.weiyun.com:8443/ftn_pic_abs_v2/ac5a5633a9c316a4fe5ef54df17d27e088770358dd938676caa0492586e5e4956f5886165645430a587b6bc7b3aafb52?pictype=scale&amp;from=30013&amp;version=2.0.0.2&amp;uin=764827577&amp;fname=IMG_0048.PNG&amp;size=1024*1024" alt></p><p>到家还好，并不是太累，多少还能坚持下来。</p><p>下面就说下体验吧：车子看起来霸气点，轮子是27.5寸，体验还不错。ATX850主要是车座有点硬，我骑着屁股蛋有点疼….然后就是座位有点低了，这个回家可以调整，其它也没啥问题了吧，变速体验还可以。</p><p><img src="https://picabstract-preview-ftn.weiyun.com:8443/ftn_pic_abs_v2/de988517d59ee83ae4434fbd827c62f9254befebeca72424279167457cd87eea0ed2e476dde3cc13d36ba3f4df627f02?pictype=scale&amp;from=30013&amp;version=2.0.0.2&amp;uin=764827577&amp;fname=IMG_0051.JPG&amp;size=1024*1024" alt></p><p><img src="https://picabstract-preview-ftn.weiyun.com:8443/ftn_pic_abs_v2/5cde643aa93b262f9baf2de604852711ecfcdbc02faf4ad870f3bf0029cd776e7f5f72542d056a6accb632de2d952fdd?pictype=scale&amp;from=30013&amp;version=2.0.0.2&amp;uin=764827577&amp;fname=IMG_0052.JPG&amp;size=1024*1024" alt></p><p><img src="https://picabstract-preview-ftn.weiyun.com:8443/ftn_pic_abs_v2/5cde643aa93b262f9baf2de604852711ecfcdbc02faf4ad870f3bf0029cd776e7f5f72542d056a6accb632de2d952fdd?pictype=scale&amp;from=30013&amp;version=2.0.0.2&amp;uin=764827577&amp;fname=IMG_0052.JPG&amp;size=1024*1024" alt></p><p><img src="https://picabstract-preview-ftn.weiyun.com:8443/ftn_pic_abs_v2/de988517d59ee83ae4434fbd827c62f9254befebeca72424279167457cd87eea0ed2e476dde3cc13d36ba3f4df627f02?pictype=scale&amp;from=30013&amp;version=2.0.0.2&amp;uin=764827577&amp;fname=IMG_0051.JPG&amp;size=1024*1024" alt></p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>iPhone 6S Plus扩容和换电池</title>
      <link href="/my-iphone-no-zuo-no-die.html"/>
      <url>/my-iphone-no-zuo-no-die.html</url>
      
        <content type="html"><![CDATA[<p>当时买iPhone的时候，以为16G完全够用的。事实上，那时候的确够用的，套餐都是免费流量的…然而我换了套餐，一切都改了以前的模样。mdzz，16G根本扛不住啊，一套歌曲下来，随便3/4G，再加上微信或者QQ，随便来个几个G，特么剩下还有几个G？心想反正都用了一年多了，就冒个险扩容吧。</p><p>之前在网上了解过扩容的大体原理，貌似从iPhone6就开始普及这个扩容方法了，到现在也没有什么副作用。听之前扩容的师傅说，他有个机器，可以在你原有的硬盘提取数据，主要是Apple硬盘识别标识码，然后再写入新的硬盘里…就这么简单，至少目前Apple是没有办法解决目前的状况。</p><p>然后呢，我的电池损耗度高达54%，对，你么看错，是54%，妈的智障鬼知道我的电池经历了什么，才一年多点就玩成这样，不过群里有几个人说原装电池就不咋的，好多人都换了飞毛腿电池，耐用…我去换说没有飞毛腿，只有原装的，算了，就凑合换了吧。</p><p>从下午2点去，到那儿店里差不多块4点了，就4点动手换，一直到接近6点才给我。期间我都是心惊胆跳过来的…师傅一会儿说，你这屏幕咋失灵了啊？我擦，别吓我，你没修之前明明好的，特么咋失灵了？然而虚惊一场….然而特么说我前置摄像头不管用了！我日，之后又说是感应器失灵了。mdzz，等到修好送到我手里，差不多可以和我说：「惊不惊喜？刺不刺激？」下次遇到这类师傅，一定要打死，决不手软！不过看在修好毫无问题的情况下，就饶了他….</p><p>指南针，没问题，振动，没问题，电话，没问题，短信，没问题，关于信息里的设备信息，没问题，序列号，没问题。哈哈，可以可以。</p><p>嗯本来是128G，师傅那儿没硬盘，就换64G，勉强能用，价格一共才500块钱。</p><p><img src="//res.i95.me/wp-content/uploads/2016/12/1.png" alt></p><p><img src="//res.i95.me/wp-content/uploads/2016/12/2.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Mac/Ubuntu安装ApkTools环境</title>
      <link href="/mac-and-ubuntuinstall-apktools-surroundings.html"/>
      <url>/mac-and-ubuntuinstall-apktools-surroundings.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>文档：<a href="https://ibotpeaches.github.io/Apktool/install/" target="_blank" rel="noopener">Apktool</a></p><p>主要有人让我汉化某个APP。所以配置下相关环境咯。</p><h3 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h3><ol><li>下载Linux<a href="https://raw.githubusercontent.com/iBotPeaches/Apktool/master/scripts/linux/apktool" target="_blank" rel="noopener">一键配置脚本</a>（右击保存，重命名为<code>apktool</code>）</li><li>下载<a href="https://bitbucket.org/iBotPeaches/apktool/downloads" target="_blank" rel="noopener">apktool-2</a></li><li>把刚刚下载的jar包重命名为<code>apktool.jar</code></li><li>将<code>apktool</code>和<code>apktool.jar</code>移动到<code>/usr/local/bin</code>目录</li><li>给予权限<code>chmod +x</code></li><li>运行<code>apktool</code>即可</li></ol><p>使用教程：<a href="https://ibotpeaches.github.io/Apktool/documentation/" target="_blank" rel="noopener">参考文档</a></p><p>使用Android Studio或者IDEA生成的JSK签名文件：</p><pre><code>jarsigner -verbose -keystore ~/Android/MySignKey/BlackCat.jks -signedjar ~/Android/MySignKey/SystemInfo.apk base.apk BlackCat</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>刚入手米环2简评</title>
      <link href="/xiaomi-band-version-2.html"/>
      <url>/xiaomi-band-version-2.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>讲真，手环我就用过小米这个牌子，并不是因为我是忠实的米粉，是其它产品实在是无法和小米比，性价比太高了！</p><p>我小米的手环，每代产品都用过。也目瞩每代产品的缺陷的修复和完美的展示。</p><p>小米手环1，如果不需要心率功能的话，它的续航力在同级产品中，最为突出，俩三个月不充电毫无压力，是我用过接近2年的产品了。虽然一年买一个，主要1代有个确定，米粒那个卡槽太松了…反正有次看到手腕上的米粒手环就这样莫名其妙就没了…然后第二个1代我特么买个橡皮筋绑在上面。</p><p>等到光感版出现，也买了个，差不多用了1年了吧。对于1代来比，光感版的米粒卡槽终于改进了，至少不担心米粒会掉下来。功能上主要是多出个心率，有了心率续航力也不行了….大部分时间都是一个月充次电。缺点也就是扣子好难扣，每次都要花大半天时间去扣上。</p><p>第二代，也就是最近要买的。从这个月开始，莫名其妙发现光感版的睡眠监控功能废了…主要是后面的绿光不亮。无奈买个2代，反正一年一个。</p><h3 id="简评"><a href="#简评" class="headerlink" title="简评"></a>简评</h3><p>我就简单说下，主要是加个OLED屏幕，啧啧，就和高端手环持平了… OLED屏可以在抬手腕看时间，对APP数据的查询观看支持。还有支持QQ，微信，支付宝等APP振动提醒，这个赞！至于续航呢，目测和光感版一致，基本一月一冲，毕竟多个屏幕，能和上代续航保持一致就不错了，不奢望提高续航能力。</p><p>也就这样吧….</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>最近一些近况和一些想法</title>
      <link href="/2016-1210-notes.html"/>
      <url>/2016-1210-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>又是一眨眼，到了12月份。嘿呀，这时间真是快呀，一旦人习惯或者重复日子，时间自然飞速而过。今晚，准确的说即将上班的前几晚，闲得无聊，突然想写些东西，来确定我要做的东西以及目标。</p><h3 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h3><p>之前留在苏州，在家做文员，没事就随便玩玩，很无聊。然而快到年底，的确是不好找工作。直到南通那方面来电，要我去考试，便思索是否回老家一趟，原本计划是拿衣服的。之后考试中有个同学对我说干脆就在老家找找看，反正都闲得无聊。于是打开智联和58投了几家公司简历，坐等消息。</p><p>然而，来到淮安的第一个白天，就收到面试的通知电话。嘿，运气这么好？安排了当天下午就去面试，回到乡下，梳理下思绪，面试的过程从脑子过下。中午便去公司面试了，接近半个小时，感觉还不错，没啥大问题，能在年前找到工作，我也没这个资格去挑吧。第二天中午就收到上岗的电话，安排在下星期一。</p><h3 id="习惯"><a href="#习惯" class="headerlink" title="习惯"></a>习惯</h3><p>之前，我一直反省工作或者学习上的一些坏习惯，我是一个比较固执的人，也爱钻牛角尖的人，虽然有人说这好，不完成不放弃的好处嘛。但我很清楚这俩个带来多大的害处。如果放在公司做项目来讲，会大大降低效率！不管怎么样，当时应该和上头说清你的情况。除了这点以外，其它没什么问题。</p><p>讲真，最近这几年的生活习惯，真的让我头疼，身体一系列问题，都是这些坏习惯带出来的！现在换了个新环境，我<strong>必须要改变，必须改了它</strong>！！！从今年8.9月开始，忽然发现睡眠质量真的很差。主要是看小米运动睡眠监控，虽然每天睡眠时间超过八个小时，但深度睡眠不足2小时，Google相关资料，一个正常的睡眠，最低是2小时…天呐。怪不得这几年精神真不咋的。</p><blockquote><p>关于睡眠时间的选择，如果你在11点上床，这四个小时，可能抵八个小时，反之如果你是熬夜之后补睡，八个小时也不够补回你损失的精气。</p></blockquote><p>所以，晚上不能再熬夜了！！！</p><p>其次，锻炼身体，神TM的体虚，必须锻炼，去年冬天跑了接近俩个星期就放弃了，主要懒床…哎哎哎…别打脸…今年开始每天最低也要3公里，标准为6公里，坚持下去！！</p><p><img src="https://res.i95.me/wp-content/uploads/2016/12/run-map.jpg" alt></p><p>嗯，等等买套运动服和手环，神TM手环，一年坏一个。</p><h3 id="健康"><a href="#健康" class="headerlink" title="健康"></a>健康</h3><p>正如上面所说到，一些列坏习惯，导致身体出现各种各样的状况，为了健康，坏习惯必须改。总之前几天问题总结下，无非就是：失眠多梦，精神不振，手脚发凉，严重脱发，免疫下降…</p><p>不说了…不就是肾虚了，还是肾阳虚的一种…神TM撸多了？我可没有那个坏习惯，别瞎说。医生说了主要是熬夜，精气流失。现在主要是补回来，于是听从意见，买1桂附地黄丸吃。</p><p>至于平常就多要和水，泡枸杞子+大枣水喝，养肾补气。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>说了这么多，计划我得排下：</p><p>生活习惯：</p><ol><li>早上6.30起床，晨跑30分钟以上，前期不低于3km，后期不低于6km</li><li>必须吃早餐</li><li>能不喝咖啡尽量不喝，多喝枸杞子泡茶</li><li>午睡一小时，确保下午精神充沛</li><li>晚上主要放松大脑，听音乐</li><li>晚上10点就寝</li></ol><p>大概这么多吧，以后慢慢补充吧。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Mac制作Linux U盘启动</title>
      <link href="/mac-production-linux-u-disk-to-start.html"/>
      <url>/mac-production-linux-u-disk-to-start.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>闲来无事，今日就把手里无用的笔记本装Linux玩玩。身边只有Mac电脑，搜集一些资料。</p><h3 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h3><ol><li>先把U盘插入电脑，执行：</li></ol><pre><code>Puss:~ jaxson$ diskutil list/dev/disk0 (internal, physical):   #: TYPE NAME SIZE IDENTIFIER   0: GUID_partition_scheme *121.3 GB disk0   1: EFI EFI 209.7 MB disk0s1   2: Apple_CoreStorage Mac OS 120.5 GB disk0s2   3: Apple_Boot Recovery HD 650.0 MB disk0s3/dev/disk1 (internal, virtual):   #: TYPE NAME SIZE IDENTIFIER   0: Mac OS +120.1 GB disk1                                 Logical Volume on disk0s2                                 8691291C-88C6-4A6A-BF46-002BEEE76E49                                 Unlocked Encrypted/dev/disk2 (external, physical):   #: TYPE NAME SIZE IDENTIFIER   0: FDisk_partition_scheme *31.0 GB disk2   1: Apple_HFS My 31.0 GB disk2s1Puss:~ jaxson$</code></pre><p>/dev/disk2就是我的U盘</p><ol><li>接下来先unmount这个U盘，使用如下命令： <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    `  </span><br><span class="line">    Puss:~ jaxson$ diskutil unmountDisk /dev/disk2  </span><br><span class="line">    Unmount of all volumes on disk2 was successful  </span><br><span class="line">    Puss:~ jaxson$`</span><br><span class="line"></span><br><span class="line"> ``这样就有了一个已经插入但是unmount的U盘了，这时候你在Finder下看不到这个U盘了，但是用diskutil list命令还可以看到。 接下来将你要制作的Linux安装的iso文件写到这个U盘里，这个任务可以使用如下命令完成：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`sudo dd if=~/Downloads/linuxmint-18-cinnamon-64bit.iso of=/dev/disk2 bs=1m</span><br></pre></td></tr></table></figure></li></ol><p>这个过程大约需要5-10分钟，完成之后会输出类似下面的日志。</p><pre><code>Puss:~ jaxson$ sudo dd if=~/Downloads/linuxmint-18-cinnamon-64bit.iso of=/dev/disk2 bs=1mPassword:1619+1 records in1619+1 records out1697906688 bytes transferred in 591.114961 secs (2872380 bytes/sec)</code></pre><p>这样一个通过USB启动的Linux安装U盘就做好了。</p><p><code>`</code></p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Mac安装MariaDB数据库笔记</title>
      <link href="/mac-install-mariadb-notes.html"/>
      <url>/mac-install-mariadb-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>别问我为何不用MySQL，MariaDB大法好，小巧玲珑，我喜欢~</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>其实也就用Homebrew安装：</p><p>参考文章：<a href="https://mariadb.com/resources/blog/installing-mariadb-10010-mac-os-x-homebrew" target="_blank" rel="noopener">官方博文</a></p><p>获取Mariadb数据库信息：</p><pre><code>Puss:~ jaxson$ brew update^CPuss:~ jaxson$ export ALL_PROXY=socks5://127.0.0.1:1086Puss:~ jaxson$ brew updateUpdated 2 taps (homebrew/core, josegonzalez/php).==&gt; Updated Formulaehighlight libpstjosegonzalez/php/n98-magerun2 libwpdPuss:~ jaxson$ brew info mariadbmariadb: stable 10.1.19 (bottled), devel 10.2.2Drop-in replacement for MySQLhttps://mariadb.org/Conflicts with: mariadb-connector-c, mysql, mysql-cluster, mysql-connector-c, mytop, percona-serverNot installedFrom: https://github.com/Homebrew/homebrew-core/blob/master/Formula/mariadb.rb==&gt; DependenciesBuild: cmake ✘Required: openssl ✔==&gt; Options--universal    Build a universal binary--with-archive-storage-engine    Compile with the ARCHIVE storage engine enabled--with-bench    Keep benchmark app when installing--with-blackhole-storage-engine    Compile with the BLACKHOLE storage engine enabled--with-embedded    Build the embedded server--with-libedit    Compile with editline wrapper instead of readline--with-local-infile    Build with local infile loading support--with-test    Keep test when installing--devel    Install development version 10.2.2==&gt; CaveatsA &quot;/etc/my.cnf&quot; from another install may interfere with a Homebrew-builtserver starting up correctly.To connect:    mysql -urootTo have launchd start mariadb now and restart at login:  brew services start mariadbOr, if you don&apos;t want/need a background service you can just run:  mysql.server startPuss:~ jaxson$</code></pre><p>安装Mariadb数据库：</p><pre><code>Puss:~ jaxson$ brew install mariadbUpdating Homebrew...==&gt; Downloading https://homebrew.bintray.com/bottles/mariadb-10.1.19.sierra.bott######################################################################## 100.0%==&gt; Pouring mariadb-10.1.19.sierra.bottle.tar.gz==&gt; Using the sandbox==&gt; /usr/local/Cellar/mariadb/10.1.19/bin/mysql_install_db --verbose --user=jaxs==&gt; CaveatsA &quot;/etc/my.cnf&quot; from another install may interfere with a Homebrew-builtserver starting up correctly.To connect:    mysql -urootTo have launchd start mariadb now and restart at login:  brew services start mariadbOr, if you don&apos;t want/need a background service you can just run:  mysql.server start==&gt; Summary🍺 /usr/local/Cellar/mariadb/10.1.19: 574 files, 136.6M``安装好了，下面编译安装：```bashPuss:~ jaxson$ unset TMPDIRPuss:~ jaxson$ cd /usr/local/Cellar/mariadb/10.1.19/Puss:10.1.19 jaxson$ mysql_install_dbWARNING: The host &apos;Puss.local&apos; could not be looked up with resolveip.This probably means that your libc libraries are not 100 % compatiblewith this binary MariaDB version. The MariaDB daemon, mysqld, should worknormally with the exception that host name resolving will not work.This means that you should use IP addresses instead of hostnameswhen specifying MariaDB privileges !Installing MariaDB/MySQL system tables in &apos;/usr/local/var/mysql&apos; ...2016-12-03 22:29:59 140735773815744 [Note] /usr/local/Cellar/mariadb/10.1.19/bin/mysqld (mysqld 10.1.19-MariaDB) starting as process 3197 ...2016-12-03 22:29:59 140735773815744 [Note] InnoDB: Using mutexes to ref count buffer pool pages2016-12-03 22:29:59 140735773815744 [Note] InnoDB: The InnoDB memory heap is disabled2016-12-03 22:29:59 140735773815744 [Note] InnoDB: Mutexes and rw_locks use GCC atomic builtins2016-12-03 22:29:59 140735773815744 [Note] InnoDB: GCC builtin __atomic_thread_fence() is used for memory barrier2016-12-03 22:29:59 140735773815744 [Note] InnoDB: Compressed tables use zlib 1.2.82016-12-03 22:29:59 140735773815744 [Note] InnoDB: Using SSE crc32 instructions2016-12-03 22:29:59 140735773815744 [Note] InnoDB: Initializing buffer pool, size = 128.0M2016-12-03 22:29:59 140735773815744 [Note] InnoDB: Completed initialization of buffer pool2016-12-03 22:29:59 140735773815744 [Note] InnoDB: Highest supported file format is Barracuda.2016-12-03 22:29:59 140735773815744 [Note] InnoDB: 128 rollback segment(s) are active.2016-12-03 22:29:59 140735773815744 [Note] InnoDB: Waiting for purge to start2016-12-03 22:29:59 140735773815744 [Note] InnoDB: Percona XtraDB (http://www.percona.com) 5.6.32-79.0 started; log sequence number 16236912016-12-03 22:29:59 123145432498176 [Note] InnoDB: Dumping buffer pool(s) not yet startedOKFilling help tables...2016-12-03 22:30:02 140735773815744 [Note] /usr/local/Cellar/mariadb/10.1.19/bin/mysqld (mysqld 10.1.19-MariaDB) starting as process 3202 ...2016-12-03 22:30:02 140735773815744 [Note] InnoDB: Using mutexes to ref count buffer pool pages2016-12-03 22:30:02 140735773815744 [Note] InnoDB: The InnoDB memory heap is disabled2016-12-03 22:30:02 140735773815744 [Note] InnoDB: Mutexes and rw_locks use GCC atomic builtins2016-12-03 22:30:02 140735773815744 [Note] InnoDB: GCC builtin __atomic_thread_fence() is used for memory barrier2016-12-03 22:30:02 140735773815744 [Note] InnoDB: Compressed tables use zlib 1.2.82016-12-03 22:30:02 140735773815744 [Note] InnoDB: Using SSE crc32 instructions2016-12-03 22:30:02 140735773815744 [Note] InnoDB: Initializing buffer pool, size = 128.0M2016-12-03 22:30:02 140735773815744 [Note] InnoDB: Completed initialization of buffer pool2016-12-03 22:30:02 140735773815744 [Note] InnoDB: Highest supported file format is Barracuda.2016-12-03 22:30:02 140735773815744 [Note] InnoDB: 128 rollback segment(s) are active.2016-12-03 22:30:02 140735773815744 [Note] InnoDB: Waiting for purge to start2016-12-03 22:30:02 140735773815744 [Note] InnoDB: Percona XtraDB (http://www.percona.com) 5.6.32-79.0 started; log sequence number 16237012016-12-03 22:30:02 123145555632128 [Note] InnoDB: Dumping buffer pool(s) not yet startedOKCreating OpenGIS required SP-s...2016-12-03 22:30:04 140735773815744 [Note] /usr/local/Cellar/mariadb/10.1.19/bin/mysqld (mysqld 10.1.19-MariaDB) starting as process 3206 ...2016-12-03 22:30:05 140735773815744 [Note] InnoDB: Using mutexes to ref count buffer pool pages2016-12-03 22:30:05 140735773815744 [Note] InnoDB: The InnoDB memory heap is disabled2016-12-03 22:30:05 140735773815744 [Note] InnoDB: Mutexes and rw_locks use GCC atomic builtins2016-12-03 22:30:05 140735773815744 [Note] InnoDB: GCC builtin __atomic_thread_fence() is used for memory barrier2016-12-03 22:30:05 140735773815744 [Note] InnoDB: Compressed tables use zlib 1.2.82016-12-03 22:30:05 140735773815744 [Note] InnoDB: Using SSE crc32 instructions2016-12-03 22:30:05 140735773815744 [Note] InnoDB: Initializing buffer pool, size = 128.0M2016-12-03 22:30:05 140735773815744 [Note] InnoDB: Completed initialization of buffer pool2016-12-03 22:30:05 140735773815744 [Note] InnoDB: Highest supported file format is Barracuda.2016-12-03 22:30:05 140735773815744 [Note] InnoDB: 128 rollback segment(s) are active.2016-12-03 22:30:05 140735773815744 [Note] InnoDB: Waiting for purge to start2016-12-03 22:30:05 140735773815744 [Note] InnoDB: Percona XtraDB (http://www.percona.com) 5.6.32-79.0 started; log sequence number 16237112016-12-03 22:30:05 123145528287232 [Note] InnoDB: Dumping buffer pool(s) not yet startedOKTo start mysqld at boot time you have to copysupport-files/mysql.server to the right place for your systemPLEASE REMEMBER TO SET A PASSWORD FOR THE MariaDB root USER !To do so, start the server, then issue the following commands:&apos;/usr/local/Cellar/mariadb/10.1.19/bin/mysqladmin&apos; -u root password &apos;new-password&apos;&apos;/usr/local/Cellar/mariadb/10.1.19/bin/mysqladmin&apos; -u root -h Puss.local password &apos;new-password&apos;Alternatively you can run:&apos;/usr/local/Cellar/mariadb/10.1.19/bin/mysql_secure_installation&apos;which will also give you the option of removing the testdatabases and anonymous user created by default. This isstrongly recommended for production servers.See the MariaDB Knowledgebase at http://mariadb.com/kb or theMySQL manual for more instructions.You can start the MariaDB daemon with:cd &apos;/usr/local/Cellar/mariadb/10.1.19&apos; ; /usr/local/Cellar/mariadb/10.1.19/bin/mysqld_safe --datadir=&apos;/usr/local/var/mysql&apos;You can test the MariaDB daemon with mysql-test-run.plcd &apos;/usr/local/Cellar/mariadb/10.1.19/mysql-test&apos; ; perl mysql-test-run.plPlease report any problems at http://mariadb.org/jiraThe latest information about MariaDB is available at http://mariadb.org/.You can find additional information about the MySQL part at:http://dev.mysql.comSupport MariaDB development by buying support/new features from MariaDBCorporation Ab. You can contact us about this at sales@mariadb.com.Alternatively consider joining our community based development effort:http://mariadb.com/kb/en/contributing-to-the-mariadb-project/</code></pre><p>启动数据库：</p><pre><code>Puss:10.1.19 jaxson$ mysql.server startStarting MySQL.161203 22:32:13 mysqld_safe Logging to &apos;/usr/local/var/mysql/Puss.local.err&apos;. SUCCESS!</code></pre><p>好了，密码默认是空的，到目前来看，安装好了，本地测试也不需要配置太多的东西。</p><pre><code>mysql -u root -p//启动数据库服务mysql.server start//重启数据库服务mysql.server restart//停止数据库服务mysql.server stop</code></pre><h3 id="安装phpMyAdmin"><a href="#安装phpMyAdmin" class="headerlink" title="安装phpMyAdmin"></a>安装phpMyAdmin</h3><p>直接说配置了：将phpmyadmin/libraries下的config.default.php，把它复制到/phpmyadmin并重命名为config.inc.php</p><p>打开修改：</p><pre><code>$cfg[&apos;PmaAbsoluteUri&apos;] = &apos;http://localhost/phpMyAdmin&apos;;</code></pre><p>允许空密码登录：</p><pre><code>$cfg[&apos;Servers&apos;][$i][&apos;AllowNoPassword&apos;] = true;</code></pre><p>登录出现#2002报错：</p><pre><code>$cfg[&apos;Servers&apos;][$i][&apos;host&apos;] = &apos;127.0.0.1&apos;;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MariaDB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于Mac Apache启动的一些报错</title>
      <link href="/mac-apache-about-error.html"/>
      <url>/mac-apache-about-error.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>然而卸载一切集成环境后，想用自带的程序作为本地开发，发现很蛋疼的问题！</p><h3 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h3><p>记录一下搭建的主要步骤 1.启动 Apache 由于 Mac 上自带 Apache，所以只要启动对应的服务就可以。 在 Mac 终端输入命令： <code>sudo apachectl start</code> 启动 Apache 服务。 Apache 常用命令</p><pre><code>//启动 Apache 服务sudo apachectl start// 重新启动 Apache 服务sudo apachectl restart// 关闭 Apache 服务sudo apachectl stop// 查看 Apache 版本httpd -v</code></pre><p><code>/Library/WebServer/Documents/</code>是 Apache 的默认根目录。</p><p>2.启动 PHP 在 Mac OS 中内置了 PHP，只需在 Apache 的配置文件中添加 Apache 对 PHP 的支持就可以。 输入 <code>sudo vim /etc/apache2/httpd.conf</code>命令打开 http.conf 配置文件。 找到以下代码并去掉注释（去掉前面的‘#’号）, wq 保存退出。</p><pre><code>LoadModule php5_module libexec/apache2/ libphp5.so</code></pre><p>3.重启 Apache 运行 <code>sudo apachectl restart</code>即可。</p><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>特么的 过程中，终端怎么启动都没有报错，百度，说什么日志删了无法启动，我看了日志都正常！</p><p>然后大概几分钟，记得php貌似有个debug模式？百度搜了下相关命令，果然有。</p><h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><pre><code>Puss:~ jaxson$ sudo apachectl -k starthttpd: Syntax error on line 537 of /private/etc/apache2/httpd.conf: Could not open configuration file /private/etc/apache2/other/+php-osx.conf: No such file or directory</code></pre><p>查了这个文件，源文件没了…就删了快捷文件。</p><p>继续启动：</p><pre><code>Puss:~ jaxson$ sudo apachectl -k startAH00112: Warning: DocumentRoot [/Users/snandy/work] does not existAH00557: httpd: apr_sockaddr_info_get() failed for Puss.localAH00558: httpd: Could not reliably determine the server&apos;s fully qualified domain name, using 127.0.0.1. Set the &apos;ServerName&apos; directive globally to suppress this message(48)Address already in use: AH00072: make_sock: could not bind to address [::]:80(48)Address already in use: AH00072: make_sock: could not bind to address 0.0.0.0:80no listening sockets available, shutting down</code></pre><p>蛤？Servername？没设定？…好吧，也就一句话的事情。</p><p>Servername指向localhost:80即可</p><p>继续：</p><pre><code>uss:~ jaxson$ sudo apachectl -k startAH00112: Warning: DocumentRoot [/Users/snandy/work] does not existhttpd (pid 1072) already running</code></pre><p>可以了，在访问本地，的确可以了！</p><p>还有就是禁止自启动Apache服务的，打开终端,执行下面的命令：</p><pre><code>sudo launchctl unload -w /System/Library/LaunchDaemons/org.apache.httpd.plist</code></pre><p>如果哪天你想让它开机启动了,则将<code>unload</code> 改为 <code>load</code>:</p><pre><code>sudo launchctl load -w /System/Library/LaunchDaemons/org.apache.httpd.plist</code></pre><p>launchd是Mac OS下，用于初始化系统环境的关键进程。类似Linux下的init, rc.此方法同样也适用于禁用系统的一些服务,比如打印机,蓝牙等.</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Apache </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac更新自带PHP大版本</title>
      <link href="/macos-upgrade-php-version-notes.html"/>
      <url>/macos-upgrade-php-version-notes.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>本文更新于2017-04-12</p></blockquote><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>虽然买来很久了，大部分开发环境还是在windows比较多。Mac平时用不到，这次去外地顺手把Mac带来了，闲的无事就开始折腾了，本来想搭建个PHP环境，网上各种集成环境都不满意，之后突然想起系统自带PHP吧，查了下果然PHP5.6版本，于是乎想升级到7看看，所以有了这篇笔记。</p><h3 id="安装Homebrew"><a href="#安装Homebrew" class="headerlink" title="安装Homebrew"></a>安装Homebrew</h3><p>地址：<a href="http://brew.sh/index_zh-cn.html" target="_blank" rel="noopener">http://brew.sh/index_zh-cn.html</a> 其实也就是一键安装的事情：</p><pre><code>/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</code></pre><h3 id="Homebrew更换国内源"><a href="#Homebrew更换国内源" class="headerlink" title="Homebrew更换国内源"></a>Homebrew更换国内源<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">在安装Homebrew过程中，那下载速度简直是惨不忍睹。搜了下清华镜像有Homebrew源，于是就换了下： ~~~ 文档：[https://mirrors.tuna.tsinghua.edu.cn/help/homebrew/](https://mirrors.tuna.tsinghua.edu.cn/help/homebrew/) ~~~ ~~~ 替换现有上游：</span><br></pre></td></tr></table></figure></h3><pre><code>cd &quot;$(brew --repo)&quot;git remote set-url origin https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/brew.gitcd &quot;$(brew --repo)/Library/Taps/homebrew/homebrew-core&quot;git remote set-url origin https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-core.gitbrew update ~~~</code></pre><p>mdzz，然后发现这个源死了…害得等了几分钟…. 于是换个中科大源：</p><pre><code>cd &quot;$(brew --repo)&quot;git remote set-url origin https://mirrors.ustc.edu.cn/brew.gitcd &quot;$(brew --repo)/Library/Taps/homebrew/homebrew-core&quot;git remote set-url origin  https://mirrors.ustc.edu.cn/homebrew-core.gitbrew update</code></pre><h3 id="卸载Homebrew"><a href="#卸载Homebrew" class="headerlink" title="卸载Homebrew"></a>卸载Homebrew</h3><p>执行：</p><pre><code>/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/uninstall)&quot;cd `brew --prefix`git checkout mastergit ls-files -z | pbcopyrm -rf Cellarbin/brew prunepbpaste | xargs -0 rmrm -r Library/Homebrew Library/Aliases Library/Formula Library/Contributions test -d Library/LinkedKegs &amp;&amp; rm -r Library/LinkedKegsrmdir -p bin Library share/man/man1 2&gt; /dev/nullrm -rf .gitrm -rf ~/Library/Caches/Homebrewrm -rf ~/Library/Logs/Homebrewrm -rf /Library/Caches/Homebrew</code></pre><h3 id="brew代理"><a href="#brew代理" class="headerlink" title="brew代理"></a>brew代理</h3><p>终端输入：<code>export ALL_PROXY=socks5://127.0.0.1:1086</code>即可代理 若长期使用则写入环境变量配置文件里：</p><pre><code>echo export ALL_PROXY=socks5://127.0.0.1:1080 &gt;&gt; ~/.bash_profile</code></pre><h3 id="安装PHP"><a href="#安装PHP" class="headerlink" title="安装PHP"></a>安装PHP</h3><pre><code>brew updatebrew tap homebrew/dupesbrew tap josegonzalez/homebrew-php</code></pre><p>可以使用<code>brew options php71</code>命令来查看安装php7.1的选项，这里我用下面的选项安装，如果希望Web容器则<code>--with-fpm</code>，如果是Apache则是<code>--with-httpd24</code>：</p><pre><code>brew install php71 --with-httpd24 --with-gmp --with-imap --with-tidy --with-debug</code></pre><p>由于Mac自带了php和php-fpm，因此需要添加系统环境变量PATH来替代自带PHP版本。</p><pre><code>echo &apos;export PATH=&quot;$(brew --prefix php71)/bin:$PATH&quot;&apos; &gt;&gt; ~/.bash_profile #for phpecho &apos;export PATH=&quot;$(brew --prefix php71)/sbin:$PATH&quot;&apos; &gt;&gt; ~/.bash_profile #for php-fpmecho &apos;export PATH=&quot;/usr/local/bin:/usr/local/sbib:$PATH&quot;&apos; &gt;&gt; ~/.bash_profile #for other brew install softsource ~/.bash_profile</code></pre><p>测试一下效果：</p><pre><code>#brew安装的php 他在/usr/local/opt/php71/bin/phpphp -v    PHP 7.1.0 (cli) (built: Dec  3 2016 17:16:55) ( NTS )Copyright (c) 1997-2016 The PHP GroupZend Engine v3.1.0-dev, Copyright (c) 1998-2016 Zend Technologies#Mac自带的PHP/usr/bin/php -v   PHP 5.4.24 (cli) (built: Jan 19 2014 21:32:15) Copyright (c) 1997-2013 The PHP GroupZend Engine v2.4.0, Copyright (c) 1998-2013 Zend Technologies#brew安装的php-fpm 他在/usr/local/opt/php71/sbin/php-fpmphp-fpm -vPHP 7.1.0 (fpm-fcgi) (built: Dec  3 2016 17:17:00)Copyright (c) 1997-2016 The PHP GroupZend Engine v3.1.0-dev, Copyright (c) 1998-2016 Zend Technologies#Mac自带的php-fpm/usr/sbin/php-fpm -vPHP 5.6.25 (fpm-fcgi) (built: Sep  6 2016 16:37:59)Copyright (c) 1997-2016 The PHP GroupZend Engine v2.6.0, Copyright (c) 1998-2016 Zend Technologies</code></pre><p>修改php-fpm配置文件，vim /usr/local/etc/php/7.1/php-fpm.conf，找到pid相关大概在25行，去掉注释 <code>pid = run/php-fpm.pid</code>, 那么php-fpm的pid文件就会自动产生在/usr/local/var/run/php-fpm.pid，下面要安装的Nginx pid文件也放在这里。</p><pre><code>#测试php-fpm配置php-fpm -tphp-fpm -c /usr/local/etc/php/7.1/php.ini -y /usr/local/etc/php/7.1/php-fpm.conf -t#启动php-fpmphp-fpm -Dphp-fpm -c /usr/local/etc/php/7.1/php.ini -y /usr/local/etc/php/7.1/php-fpm.conf -D#关闭php-fpmkill -INT `cat /usr/local/var/run/php-fpm.pid`#重启php-fpmkill -USR2 `cat /usr/local/var/run/php-fpm.pid`#也可以用上文提到的brew命令来重启php-fpm，不过他官方不推荐用这个命令了brew services restart php71#还可以用这个命令来启动php-fpmlaunchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.php71.plist</code></pre><p>启动php-fpm之后，确保它正常运行监听9000端口：</p><pre><code>lsof -Pni4 | grep LISTEN | grep phpphp-fpm   59934 jaxson    7u  IPv4 0xcd2b96ad8e94170d      0t0  TCP 127.0.0.1:9000 (LISTEN)php-fpm   59935 jaxson    0u  IPv4 0xcd2b96ad8e94170d      0t0  TCP 127.0.0.1:9000 (LISTEN)php-fpm   59936 jaxson    0u  IPv4 0xcd2b96ad8e94170d      0t0  TCP 127.0.0.1:9000 (LISTEN)#正常情况，会看到上面这些进程</code></pre><p>PHP-FPM开机启动：</p><pre><code>ln -sfv /usr/local/opt/php71/*.plist ~/Library/LaunchAgentslaunchctl load ~/Library/LaunchAgents/homebrew.mxcl.php71.plist</code></pre><h3 id="另一个方案："><a href="#另一个方案：" class="headerlink" title="另一个方案："></a>另一个方案：</h3><p>地址：<a href="https://php-osx.liip.ch/#install/" target="_blank" rel="noopener">https://php-osx.liip.ch/#install/</a></p><pre><code>curl -s https://php-osx.liip.ch/install.sh | bash -s 7.1</code></pre><p>不过折腾到现在，勉强可以用吧…先暂时这样吧。</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Socket编程实现用户登录</title>
      <link href="/java-socket-notes-1.html"/>
      <url>/java-socket-notes-1.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>这几天闲的无事，便把之前一直搞不清的Socket网络编程复习一遍，加深理解。</p><h3 id="实现单用户登录"><a href="#实现单用户登录" class="headerlink" title="实现单用户登录"></a>实现单用户登录</h3><p>Socket网络编程一般分为以下四个步骤：</p><ol><li>建立链接</li><li>打开Socket关联的输入/输出流</li><li>从数据流中写入信息和读取信息</li><li>关闭所有的数据流和Socket</li></ol><p>按照上面的步骤编写个模拟客户端和服务器之间的交流。</p><p>建立个用户类：</p><pre><code>package socket.entity;import java.io.Serializable;/** * Created by Jaxson on 2016/11/30. * 实体类-用户 */public class User implements Serializable {    private String loginName; //用户名    private String pwd; //用户名密码    public User() {}    public User (String loginName, String pwd) {        super();        this.loginName = loginName;        this.pwd = pwd;    }    public String getLoginName() {        return loginName;    }    public void setLoginName(String loginName) {        this.loginName = loginName;    }    public String getPwd() {        return pwd;    }    public void setPwd(String pwd) {        this.pwd = pwd;    }}</code></pre><p><strong>客户端实现：</strong></p><ol><li>建立连接，链接指向服务器以及端口</li><li>打开Socket关联的输入/输出流</li><li>向输出流中写入信息</li><li>从输入流中读取响应信息</li><li>关闭所有的数据流和Socket</li></ol><p>编写父类客户端：</p><pre><code>package socket.loginObj;import java.io.BufferedReader;import java.io.IOException;import java.io.InputStream;import java.io.InputStreamReader;import java.io.ObjectOutputStream;import java.io.OutputStream;import java.io.PrintWriter;import java.net.Socket;import java.net.UnknownHostException;import socket.entity.User;/** * 客户端 * */public class loginClient {    public static void main(String[] args) {        try {            //1.建立客户端Socket连接，指定服务器的位置以及端口            Socket socket=new Socket(&quot;localhost&quot;,8800);            //2.得到Socket的读写流            OutputStream os=socket.getOutputStream();            //对象序列化流            ObjectOutputStream oos=new ObjectOutputStream(os);            //输入流            InputStream is=socket.getInputStream();            BufferedReader br=new BufferedReader(new InputStreamReader(is));            //3.利用流按照一定的协议对Socket进行读/写操作            User user=new User();            user.setLoginName(&quot;Tom&quot;);            user.setPwd(&quot;123456&quot;);            oos.writeObject(user);            socket.shutdownOutput();            //接受服务器的响应并打印显示            String reply=null;            while(!((reply=br.readLine())==null)){                System.out.println(&quot;我是客户端，服务器的响应为：&quot;+reply);            }            //4.关闭资源            br.close();            is.close();            oos.close();            os.close();            socket.close();        } catch (UnknownHostException e) {            // TODO Auto-generated catch block            e.printStackTrace();        } catch (IOException e) {            // TODO Auto-generated catch block            e.printStackTrace();        }    }}</code></pre><p>编写客户端操作类：</p><pre><code>package socket.loginStr;import java.io.BufferedReader;import java.io.IOException;import java.io.InputStream;import java.io.InputStreamReader;import java.io.OutputStream;import java.io.PrintWriter;import java.net.Socket;import java.net.UnknownHostException;/** * 客户端 * */public class loginClient {    public static void main(String[] args) {        try {            //1.建立客户端Socket连接，指定服务器的位置以及端口            Socket socket=new Socket(&quot;localhost&quot;,8800);            //2.得到Socket的读写流            OutputStream os=socket.getOutputStream();            PrintWriter pw=new PrintWriter(os);            //输入流            InputStream is=socket.getInputStream();            BufferedReader br=new BufferedReader(new InputStreamReader(is));            //3.利用流按照一定的协议对Socket进行读/写操作            String info=&quot;用户名：Tom;用户密码：123456&quot;;            pw.write(info);            pw.flush();            socket.shutdownOutput();            //接受服务器的响应并打印显示            String reply=null;            while(!((reply=br.readLine())==null)){                System.out.println(&quot;我是客户端，服务器的响应为：&quot;+reply);            }            //4.关闭资源            br.close();            is.close();            pw.close();            os.close();            socket.close();        } catch (UnknownHostException e) {            e.printStackTrace();        } catch (IOException e) {            e.printStackTrace();        }    }}</code></pre><p><strong>服务器端实现：</strong></p><ol><li>建立连接，监听端口</li><li>使用accept()方法等待客户端触发通讯</li><li>打开Socket关联的输入/输出流</li><li>向输出流写入信息</li><li>从输入流中读取响应信息</li><li>关闭所有的数据流和Socket</li></ol><p>编写父类服务器端：</p><pre><code>package socket.loginObj;import java.io.BufferedReader;import java.io.IOException;import java.io.InputStream;import java.io.InputStreamReader;import java.io.ObjectInputStream;import java.io.OutputStream;import java.io.PrintWriter;import java.net.ServerSocket;import java.net.Socket;import socket.entity.User;/** * 服务器端  * */public class loginServer {    public static void main(String[] args) {        try {            //1.建立一个服务器Socket（ServerSocket）绑定指定端口并开始监听  ServerSocket serverSocket=new ServerSocket(8800);            //2.使用accept()方法阻塞等待监听，获得新的连接  Socket socket=serverSocket.accept();            //3.获得输入流  InputStream is=socket.getInputStream();            //获得流：可以对对象进行反序列化  ObjectInputStream ois=new ObjectInputStream(is);            //获得输出流  OutputStream os=socket.getOutputStream();            PrintWriter pw=new PrintWriter(os);            //4.读取用户输入信息  User user=(User)ois.readObject();            System.out.println(&quot;用户信息：&quot;+user.getLoginName()+&quot;---&quot;+user.getPwd());            //给客户一个响应  String reply=&quot;welcome!&quot;;            pw.write(reply);            pw.flush();            //5.关闭资源  pw.close();            os.close();            ois.close();            is.close();            socket.close();            serverSocket.close();        } catch (IOException e) {            // TODO Auto-generated catch block  e.printStackTrace();        } catch (ClassNotFoundException e) {            // TODO Auto-generated catch block  e.printStackTrace();        }    }}</code></pre><p>编写服务器端操作类：</p><pre><code>package socket.loginStr;import java.io.BufferedReader;import java.io.IOException;import java.io.InputStream;import java.io.InputStreamReader;import java.io.OutputStream;import java.io.PrintWriter;import java.net.ServerSocket;import java.net.Socket;/** * 服务器端 * */public class loginServer {    public static void main(String[] args) {        try {            //1.建立一个服务器Socket（ServerSocket）绑定指定端口并开始监听            ServerSocket serverSocket=new ServerSocket(8800);            //2.使用accept()方法阻塞等待监听，获得新的连接            Socket socket=serverSocket.accept();            //3.获得输入流            InputStream is=socket.getInputStream();            BufferedReader br=new BufferedReader(new InputStreamReader(is));            //获得输出流            OutputStream os=socket.getOutputStream();            PrintWriter pw=new PrintWriter(os);            //4.读取用户输入信息            String info=null;            while(!((info=br.readLine())==null)){                System.out.println(&quot;我是服务器，用户信息为：&quot;+info);            }            //给客户一个响应            String reply=&quot;welcome!&quot;;            pw.write(reply);            pw.flush();            //5.关闭资源            pw.close();            os.close();            br.close();            is.close();            socket.close();            serverSocket.close();        } catch (IOException e) {            e.printStackTrace();        }    }}</code></pre><p>写完之后先运行服务器端再执行客户端。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/11/QQ%E6%88%AA%E5%9B%BE20161130155534.png" alt><img src="https://res.i95.me/wp-content/uploads/2016/11/QQ%E6%88%AA%E5%9B%BE20161130155541.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Socket </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>腾讯云学生机抢机</title>
      <link href="/qcloud-notes.html"/>
      <url>/qcloud-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>之前的腾讯云学生机老早就有了，那时候学生认证下，代金卷发下来了。哪知道腾讯的学生机策略变了，每天12:00 200台机子限量抢购，恶心！</p><p>现在手中的阿里云和腾讯云对我来说不够用，找个以前同学借个号认证就行了。表示就差腾讯云没抢到。</p><p>一开始我听群里的基佬们说好抢啊，12点到了不用刷新网页就可以抢了。然而当天中午抢购的时候事实上不是他们说得那样…特么需要刷新一次网页才能抢，而且1S之内特么全没了？？这尼玛怎么抢啊？各种暴走。</p><h3 id="抢购"><a href="#抢购" class="headerlink" title="抢购"></a>抢购</h3><p>也就是今天，中午吃过饭，想着今天必须抢到。嗯，就去研究下网页。便有了一些思路：</p><p>浏览器F12定位到那个抢购按钮：</p><pre><code>&lt;button type=&quot;button&quot; hotrep=&quot;qcact.campus.getVoucherBtn&quot; class=&quot;button J-gotoAuth&quot; data-title=&quot;已领取&quot; disabled=&quot;disabled&quot;&gt;已领取&lt;/button&gt;</code></pre><p>毕竟是灰色(不可点击)状态，那就去掉禁用属性</p><pre><code>&lt;button type=&quot;button&quot; hotrep=&quot;qcact.campus.getVoucherBtn&quot; class=&quot;button J-gotoAuth&quot; data-title=&quot;已领取&quot;&gt;已领取&lt;/button&gt;</code></pre><p>然后尝试点击下，有弹窗，无非就是没到时间，没发抢购(抛出异常)。然后在<code>Network</code>窗口看见，有参数接收反馈，这意味并不需要手动刷新网页。只要写个定时函数就行了。</p><p>那么上面所说到的抛出异常，也就是那个弹窗，给隐藏，这样可以狂点那个按钮了，审查元素后，得知<code>id=&quot;dialog-event-xxxxxxx&quot;</code>。右键hide即可。</p><p>控制台写如下代码：</p><pre><code>var c=0;function iiong() {    $(document).ready(function(){        $(&quot;.J-gotoAuth&quot;).trigger(&quot;click&quot;);    });}setInterval(&quot;iiong()&quot;,&quot;500&quot;);</code></pre><p>嗯，就这样抢到了。</p><hr><h3 id="新版更新"><a href="#新版更新" class="headerlink" title="新版更新"></a>新版更新</h3><blockquote><p>2017-04-25更新</p></blockquote><p>新版腾讯云抢购代码，直接F浏览器F12打开控制台输入即可：</p><pre><code>&lt;code class=&quot;javascript&quot;&gt;/** * Created by 王瑾(淮城一只猫) on 2017/4/25. *///去除不可点击状态$(&apos;.J_applayLimitedPackage&apos;)[0].setAttribute(&quot;class&quot;, &quot;qc-btn J_applayLimitedPackage&quot;);//抛出弹窗信息$(&apos;.J-bizDialog&apos;)[0].remove();//点击事件 500毫秒点击一次var c=0;function iiong() {    $(document).ready(function(){        $(&quot;.J_applayLimitedPackage&quot;).trigger(&quot;click&quot;);    });}setInterval(&quot;iiong()&quot;,&quot;500&quot;);</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>MongoDB的使用笔记</title>
      <link href="/mongodb-notes.html"/>
      <url>/mongodb-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>MongoDB 是一个基于分布式文件存储的数据库。由 C++ 语言编写。旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。</p><p>MongoDB 是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。</p><p>这篇文章是我个人在Microsoft Windows 10 企业版 2016 长期服务版安装和使用的学习笔记，大家可以参考下！</p><h3 id="MongoDB安装"><a href="#MongoDB安装" class="headerlink" title="MongoDB安装"></a>MongoDB安装</h3><p>下载地址：<a href="http://www.mongodb.org/downloads" target="_blank" rel="noopener">MongoDB下载</a>，直接默认版本点击下载就行了。</p><p>我的安装位置是<code>D:\\Development\\MongoDB</code></p><h3 id="MongoDB服务启动"><a href="#MongoDB服务启动" class="headerlink" title="MongoDB服务启动"></a>MongoDB服务启动</h3><p>安装好了，需要测试使用，首先我们先要数据库以及日志文档：</p><pre><code>mkdir D:\\Development\\MongoDB\\Server\\3.2\\data\\dbmkdir D:\\Development\\MongoDB\\Server\\3.2\\data\\log</code></pre><p>启动服务：</p><pre><code>PS D:\\Development\\MongoDB\\Server\\3.2\\bin&gt; ./mongod.exe --dbpath &quot;D:\\Development\\MongoDB\\Server\\3.2\\data\\db&quot;2016-11-27T14:44:50.427+0800 I CONTROL  [initandlisten] MongoDB starting : pid=6520 port=27017 dbpath=D:\\Development\\MongoDB\\Server\\3.2\\data\\db 64-bit host=Jaxson2016-11-27T14:44:50.427+0800 I CONTROL  [initandlisten] targetMinOS: Windows 7/Windows Server 2008 R22016-11-27T14:44:50.428+0800 I CONTROL  [initandlisten] db version v3.2.112016-11-27T14:44:50.428+0800 I CONTROL  [initandlisten] git version: 009580ad490190ba33d1c6253ebd8d91808923e42016-11-27T14:44:50.428+0800 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.1t-fips  3 May 20162016-11-27T14:44:50.429+0800 I CONTROL  [initandlisten] allocator: tcmalloc2016-11-27T14:44:50.430+0800 I CONTROL  [initandlisten] modules: none2016-11-27T14:44:50.431+0800 I CONTROL  [initandlisten] build environment:2016-11-27T14:44:50.432+0800 I CONTROL  [initandlisten]     distmod: 2008plus-ssl2016-11-27T14:44:50.433+0800 I CONTROL  [initandlisten]     distarch: x86_642016-11-27T14:44:50.434+0800 I CONTROL  [initandlisten]     target_arch: x86_642016-11-27T14:44:50.435+0800 I CONTROL  [initandlisten] options: { storage: { dbPath: &quot;D:\\Development\\MongoDB\\Server\\3.2\\data\\db&quot; } }2016-11-27T14:44:50.437+0800 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=6G,session_max=20000,eviction=(threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),checkpoint=(wait=60,log_size=2GB),statistics_log=(wait=0),2016-11-27T14:44:52.071+0800 I NETWORK  [HostnameCanonicalizationWorker] Starting hostname canonicalization worker2016-11-27T14:44:52.071+0800 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory &apos;D:/Development/MongoDB/Server/3.2/data/db/diagnostic.data&apos;2016-11-27T14:44:52.367+0800 I NETWORK  [initandlisten] waiting for connections on port 27017</code></pre><h2 id="将MongoDB服务器作为Windows服务运行"><a href="#将MongoDB服务器作为Windows服务运行" class="headerlink" title="将MongoDB服务器作为Windows服务运行"></a>将MongoDB服务器作为Windows服务运行</h2><p>请注意，你必须有管理权限才能运行下面的命令。执行以下命令将MongoDB服务器作为Windows服务运行：</p><pre><code>mongod.exe --bind_ip yourIPadress --logpath &quot;C:\\data\\dbConf\\mongodb.log&quot; --logappend --dbpath &quot;C:\\data\\db&quot; --port yourPortNumber --serviceName &quot;YourServiceName&quot; --serviceDisplayName &quot;YourServiceName&quot; --install</code></pre><p><strong>下表为mongodb启动的参数说明：</strong></p><p>参数</p><p>描述</p><p>–bind_ip</p><p>绑定服务IP，若绑定127.0.0.1，则只能本机访问，不指定默认本地所有IP</p><p>–logpath</p><p>定MongoDB日志文件，注意是指定文件不是目录</p><p>–logappend</p><p>使用追加的方式写日志</p><p>–dbpath</p><p>指定数据库路径</p><p>–port</p><p>指定服务端口号，默认端口27017</p><p>–serviceName</p><p>指定服务名称</p><p>–serviceDisplayName</p><p>指定服务名称，有多个mongodb服务时执行。</p><p>–install</p><p>指定作为一个Windows服务安装。</p><p>### Robomongo安装</p><p><a href="https://robomongo.org/" target="_blank" rel="noopener">Robomongo</a> 是一个基于 Shell 的跨平台开源 MongoDB 可视化管理工具，支持 Windows、Linux 和 Mac，嵌入了 JavaScript 引擎和 MongoDB mongo，只要你会使用 mongo shell，你就会使用 Robomongo，它还提了供语法高亮、自动补全、差别视图等。</p><p><a href="https://robomongo.org/download" target="_blank" rel="noopener">Robomongo 下载地址</a></p><p>下载并安装成功后点击左上角的 <code>Create</code> 创建一个连接，给该连接起个名字如: <code>localhost</code>，使用默认地址（localhost）和端口（27017）即可，点击 <code>Save</code> 保存，即可运行。</p><p>安装好了，这个放一边，继续熟悉下MongoDB。</p><h3 id="MongoDB-概念解析"><a href="#MongoDB-概念解析" class="headerlink" title="MongoDB 概念解析"></a>MongoDB 概念解析</h3><p>SQL术语/概念</p><p>MongoDB术语/概念</p><p>解释/说明</p><p>database</p><p>database</p><p>数据库</p><p>table</p><p>collection</p><p>数据库表/集合</p><p>row</p><p>document</p><p>数据记录行/文档</p><p>column</p><p>field</p><p>数据字段/域</p><p>index</p><p>index</p><p>索引</p><p>table joins</p><p>表连接,MongoDB不支持</p><p>primary key</p><p>primary key</p><p>主键,MongoDB自动将_id字段设置为主键</p><p>一个mongodb中可以建立多个数据库。 MongoDB的默认数据库为`db`，该数据库存储在data目录中。 MongoDB的单个实例可以容纳多个独立的数据库，每一个都有自己的集合和权限，不同的数据库也放置在不同的文件中。 `show dbs` 命令可以显示所有数据的列表。 `db` 命令可以显示当前数据库对象或集合。 `use`命令，可以连接到一个指定的数据库。</p><pre><code>PS D:\\Development\\MongoDB\\Server\\3.2\\bin&gt; ./mongo.exeMongoDB shell version: 3.2.11connecting to: test&gt; show dbslocal  0.000GB&gt; dbtest&gt; use localswitched to db local</code></pre><p>数据库也通过名字来标识。数据库名可以是满足以下条件的任意UTF-8字符串。</p><ul><li>不能是空字符串（””)。</li><li>不得含有’ ‘（空格)、.、$、/、\和\0 (空宇符)。</li><li>应全部小写。</li><li>最多64字节。</li></ul><p>有一些数据库名是保留的，可以直接访问这些有特殊作用的数据库。</p><ul><li><strong>admin</strong>： 从权限的角度来看，这是”root”数据库。要是将一个用户添加到这个数据库，这个用户自动继承所有数据库的权限。一些特定的服务器端命令也只能从这个数据库运行，比如列出所有的数据库或者关闭服务器。</li><li><strong>local:</strong> 这个数据永远不会被复制，可以用来存储限于本地单台服务器的任意集合</li><li><strong>config</strong>: 当Mongo用于分片设置时，config数据库在内部使用，用于保存分片的相关信息。</li></ul><h3 id="MongoDB连接命令格式"><a href="#MongoDB连接命令格式" class="headerlink" title="MongoDB连接命令格式"></a>MongoDB连接命令格式</h3><p>使用用户名和密码连接到MongoDB服务器，你必须使用 <code>username:password@hostname/dbname</code> 格式，<code>username</code>为用户名，<code>password</code> 为密码。</p><p>标准格式：</p><pre><code>mongodb://[username:password@]host1[:port1][,host2[:port2],...[,hostN[:portN]]][/[database][?options]]</code></pre><p>标准的连接格式包含了多个选项(options)，如下所示：</p><p>选项</p><p>描述</p><p>replicaSet=name</p><p>验证replica set的名称。 Impliesconnect=replicaSet.</p><p>slaveOk=true/false</p><p>**true: **在connect=direct模式下，驱动会连接第一台机器，即使这台服务器不是主。在connect=replicaSet模式下，驱动会发送所有的写请求到主并且把读取操作分布在其他从服务器。**false: **在 connect=direct模式下，驱动会自动找寻主服务器. 在connect=replicaSet 模式下，驱动仅仅连接主服务器，并且所有的读写命令都连接到主服务器。</p><p>safe=true/false</p><p>**true: **在执行更新操作之后，驱动都会发送getLastError命令来确保更新成功。(还要参考 wtimeoutMS).**false: **在每次更新之后，驱动不会发送getLastError来确保更新成功。</p><p>w=n</p><p>驱动添加 { w : n } 到getLastError命令. 应用于safe=true。</p><p>wtimeoutMS=ms</p><p>驱动添加 { wtimeout : ms } 到 getlasterror 命令. 应用于 safe=true.</p><p>fsync=true/false</p><p>**true: **驱动添加 { fsync : true } 到 getlasterror 命令.应用于 safe=true.**false: **驱动不会添加到getLastError命令中。</p><p>journal=true/false</p><p>如果设置为 true, 同步到 journal (在提交到数据库前写入到实体中). 应用于 safe=true</p><p>connectTimeoutMS=ms</p><p>可以打开连接的时间。</p><p>socketTimeoutMS=ms</p><p>发送和接受sockets的时间。</p><p>### MongoDB创建/刪除数据库</p><p>MongoDB 创建数据库的语法格式如下：</p><pre><code>use DATABASE_NAME</code></pre><p>如果数据库不存在，则创建数据库，否则切换到指定数据库。</p><p>MongoDB 删除数据库的语法格式如下：</p><pre><code>db.dropDatabase()</code></pre><p>删除当前数据库，默认为 test，你可以使用 db 命令查看当前数据库名。</p><hr><p>集合删除语法格式如下：</p><pre><code>db.collection.drop()</code></pre><h3 id="MongoDB增删改查"><a href="#MongoDB增删改查" class="headerlink" title="MongoDB增删改查"></a>MongoDB增删改查</h3><blockquote><p>添加数据：</p></blockquote><p>MongoDB 使用 insert() 或 save() 方法向集合中插入文档，语法如下：</p><pre><code>db.COLLECTION_NAME.insert(document)</code></pre><p>实例：</p><pre><code>PS D:\\Development\\MongoDB\\Server\\3.2\\bin&gt; ./mongo.exeMongoDB shell version: 3.2.11connecting to: test&gt; show dbslocal  0.000GB&gt; use iiongswitched to db iiong&gt; dbiiong&gt; db.iiong.insert({title: &apos;MongoDB 数据库&apos;,...     description: &apos;MongoDB 是一个 Nosql 数据库&apos;,...     by: &apos;JaxsonWang&apos;,...     url: &apos;https://iiong.com&apos;,...     tags: [&apos;mongodb&apos;, &apos;database&apos;, &apos;NoSQL&apos;],...     likes: 100... }) #插入数据库WriteResult({ &quot;nInserted&quot; : 1 }) #反馈&gt; db.iiong.find() #查询数据库{ &quot;_id&quot; : ObjectId(&quot;583a8abdce5d512be46975a5&quot;), &quot;title&quot; : &quot;MongoDB 数据库&quot;, &quot;description&quot; : &quot;MongoDB 是一个 Nosql 数据库&quot;, &quot;by&quot; : &quot;JaxsonWang&quot;, &quot;url&quot; : &quot;https://iiong.com&quot;, &quot;tags&quot; : [ &quot;mongodb&quot;, &quot;database&quot;, &quot;NoSQL&quot; ], &quot;likes&quot; : 100 }</code></pre><p>或者可以将数据定义为一个变量：</p><pre><code>&gt; document=({title: &apos;MongoDB 教程&apos;,...     description: &apos;MongoDB 是一个 Nosql 数据库&apos;,...     by: &apos;Jaxson&apos;,...     url: &apos;https://i95.me&apos;,...     tags: [&apos;mongodb&apos;, &apos;database&apos;, &apos;NoSQL&apos;],...     likes: 100... });</code></pre><p>执行后显示结果如下：</p><pre><code>{        &quot;title&quot; : &quot;MongoDB 教程&quot;,        &quot;description&quot; : &quot;MongoDB 是一个 Nosql 数据库&quot;,        &quot;by&quot; : &quot;Jaxson&quot;,        &quot;url&quot; : &quot;https://i95.me&quot;,        &quot;tags&quot; : [                &quot;mongodb&quot;,                &quot;database&quot;,                &quot;NoSQL&quot;        ],        &quot;likes&quot; : 100}</code></pre><p>执行插入操作：</p><pre><code>&gt; db.iiong.insert(document)WriteResult({ &quot;nInserted&quot; : 1 })&gt; db.iiong.find(){ &quot;_id&quot; : ObjectId(&quot;583a8abdce5d512be46975a5&quot;), &quot;title&quot; : &quot;MongoDB 数据库&quot;, &quot;description&quot; : &quot;MongoDB 是一个 Nosql 数据库&quot;, &quot;by&quot; : &quot;JaxsonWang&quot;, &quot;url&quot; : &quot;https://iiong.com&quot;, &quot;tags&quot; : [ &quot;mongodb&quot;, &quot;database&quot;, &quot;NoSQL&quot; ], &quot;likes&quot; : 100 }{ &quot;_id&quot; : ObjectId(&quot;583a8c7ace5d512be46975a6&quot;), &quot;title&quot; : &quot;MongoDB 教程&quot;, &quot;description&quot; : &quot;MongoDB 是一个 Nosql 数据库&quot;, &quot;by&quot; : &quot;Jaxson&quot;, &quot;url&quot; : &quot;https://i95.me&quot;, &quot;tags&quot; : [ &quot;mongodb&quot;, &quot;database&quot;, &quot;NoSQL&quot; ], &quot;likes&quot; : 100 }</code></pre><blockquote><p>更新数据</p></blockquote><p>MongoDB 使用 update() 和 save() 方法来更新集合中的数据。</p><p>update() 方法用于更新已存在的文档。语法格式如下：</p><pre><code>db.collection.update(   &lt;query&gt;,   &lt;update&gt;,   {     upsert: &lt;boolean&gt;,     multi: &lt;boolean&gt;,     writeConcern: &lt;document&gt;   })</code></pre><p><strong>参数说明：</strong></p><p>query : update的查询条件，类似sql update查询内where后面的。 update : update的对象和一些更新的操作符（如$,$inc…）等，也可以理解为sql update查询内set后面的 upsert : 可选，这个参数的意思是，如果不存在update的记录，是否插入objNew,true为插入，默认是false，不插入。 multi : 可选，mongodb 默认是false,只更新找到的第一条记录，如果这个参数为true,就把按条件查出来多条记录全部更新。 writeConcern :可选，抛出异常的级别。</p><p>实例：</p><p>根据上面第一条数据我把<code>JaxsonWang</code>改成<code>王瑾</code>：</p><pre><code>&gt; db.iiong.update({&apos;by&apos;:&apos;JaxsonWang&apos;},{$set:{&apos;by&apos;:&apos;王瑾&apos;}})WriteResult({ &quot;nMatched&quot; : 1, &quot;nUpserted&quot; : 0, &quot;nModified&quot; : 1 }) #反馈&gt; db.iiong.find().pretty(){        &quot;_id&quot; : ObjectId(&quot;583a8abdce5d512be46975a5&quot;),        &quot;title&quot; : &quot;MongoDB 数据库&quot;,        &quot;description&quot; : &quot;MongoDB 是一个 Nosql 数据库&quot;,        &quot;by&quot; : &quot;王瑾&quot;,        &quot;url&quot; : &quot;https://iiong.com&quot;,        &quot;tags&quot; : [                &quot;mongodb&quot;,                &quot;database&quot;,                &quot;NoSQL&quot;        ],        &quot;likes&quot; : 100}{        &quot;_id&quot; : ObjectId(&quot;583a8c7ace5d512be46975a6&quot;),        &quot;title&quot; : &quot;MongoDB 教程&quot;,        &quot;description&quot; : &quot;MongoDB 是一个 Nosql 数据库&quot;,        &quot;by&quot; : &quot;Jaxson&quot;,        &quot;url&quot; : &quot;https://i95.me&quot;,        &quot;tags&quot; : [                &quot;mongodb&quot;,                &quot;database&quot;,                &quot;NoSQL&quot;        ],        &quot;likes&quot; : 100}&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line">    以上语句只会修改第一条发现的文档，如果你要修改多条相同的文档，则需要设置 multi 参数为 true：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">````db.iiong.update(&#123;&apos;by&apos;:&apos;JaxsonWang&apos;&#125;,&#123;$set:&#123;&apos;by&apos;:&apos;王瑾&apos;&#125;&#125;,&#123;multi:true&#125;)</span><br></pre></td></tr></table></figure></code></pre><p>更多实例：</p><pre><code>#只更新第一条记录：db.iiong.update( { &quot;count&quot; : { $gt : 1 } } , { $set : { &quot;test2&quot; : &quot;OK&quot;} } );#全部更新：db.iiong.update( { &quot;count&quot; : { $gt : 3 } } , { $set : { &quot;test2&quot; : &quot;OK&quot;} },false,true );#只添加第一条：db.iiong.update( { &quot;count&quot; : { $gt : 4 } } , { $set : { &quot;test5&quot; : &quot;OK&quot;} },true,false );#全部添加加进去:db.iiong.update( { &quot;count&quot; : { $gt : 5 } } , { $set : { &quot;test5&quot; : &quot;OK&quot;} },true,true );#全部更新：db.iiong.update( { &quot;count&quot; : { $gt : 15 } } , { $inc : { &quot;count&quot; : 1} },false,true );#只更新第一条记录：db.iiong.update( { &quot;count&quot; : { $gt : 10 } } , { $inc : { &quot;count&quot; : 1} },false,false );</code></pre><p>save() 方法通过传入的文档来替换已有文档。语法格式如下：</p><pre><code>db.collection.save(   &lt;document&gt;,   {     writeConcern: &lt;document&gt;   })</code></pre><p><strong>参数说明：</strong></p><p>document : 文档数据。 writeConcern :可选，抛出异常的级别。</p><p>实例：</p><pre><code>&gt; db.iiong.save({...         &quot;_id&quot; : ObjectId(&quot;583a8c7ace5d512be46975a6&quot;),...         &quot;title&quot; : &quot;MongoDB&quot;,...         &quot;description&quot; : &quot;它是一个 Nosql 数据库&quot;,...         &quot;by&quot; : &quot;苏城一只猫&quot;,...         &quot;url&quot; : &quot;https://jaxson.wang&quot;,...         &quot;tags&quot; : [...                 &quot;mongodb&quot;,...                 &quot;database&quot;,...                 &quot;NoSQL&quot;...         ],...         &quot;likes&quot; : 100... })WriteResult({ &quot;nMatched&quot; : 1, &quot;nUpserted&quot; : 0, &quot;nModified&quot; : 1 })&gt; db.iiong.find().pretty(){        &quot;_id&quot; : ObjectId(&quot;583a8abdce5d512be46975a5&quot;),        &quot;title&quot; : &quot;MongoDB 数据库&quot;,        &quot;description&quot; : &quot;MongoDB 是一个 Nosql 数据库&quot;,        &quot;by&quot; : &quot;王瑾&quot;,        &quot;url&quot; : &quot;https://iiong.com&quot;,        &quot;tags&quot; : [                &quot;mongodb&quot;,                &quot;database&quot;,                &quot;NoSQL&quot;        ],        &quot;likes&quot; : 100}{        &quot;_id&quot; : ObjectId(&quot;583a8c7ace5d512be46975a6&quot;),        &quot;title&quot; : &quot;MongoDB&quot;,        &quot;description&quot; : &quot;它是一个 Nosql 数据库&quot;,        &quot;by&quot; : &quot;苏城一只猫&quot;,        &quot;url&quot; : &quot;https://jaxson.wang&quot;,        &quot;tags&quot; : [                &quot;mongodb&quot;,                &quot;database&quot;,                &quot;NoSQL&quot;        ],        &quot;likes&quot; : 100}</code></pre><blockquote><p>删除文档</p></blockquote><p>remove() 方法的基本语法格式如下所示：</p><pre><code>db.collection.remove(   &lt;query&gt;,   &lt;justOne&gt;)</code></pre><p>如果你的 MongoDB 是 2.6 版本以后的，语法格式如下：</p><pre><code>db.collection.remove(   &lt;query&gt;,   {     justOne: &lt;boolean&gt;,     writeConcern: &lt;document&gt;   })</code></pre><p><strong>参数说明：</strong></p><p>query :（可选）删除的文档的条件。 justOne : （可选）如果设为 true 或 1，则只删除一个文档。 writeConcern :（可选）抛出异常的级别。</p><p>实例：</p><pre><code>&gt; db.iiong.remove({&apos;by&apos;:&apos;王瑾&apos;})WriteResult({ &quot;nRemoved&quot; : 1 })  #反馈&gt; db.iiong.find(){ &quot;_id&quot; : ObjectId(&quot;583a8c7ace5d512be46975a6&quot;), &quot;title&quot; : &quot;MongoDB&quot;, &quot;description&quot; : &quot;它是一个 Nosql 数据库&quot;, &quot;by&quot; : &quot;苏城一只猫&quot;, &quot;url&quot; : &quot;https://jaxson.wang&quot;, &quot;tags&quot; : [ &quot;mongodb&quot;, &quot;database&quot;, &quot;NoSQL&quot; ], &quot;likes&quot; : 100 }</code></pre><p>如果你只想删除第一条找到的记录可以设置 justOne 为 1，如下所示：</p><pre><code>&gt;db.COLLECTION_NAME.remove(DELETION_CRITERIA,1)</code></pre><p>如果你想删除所有数据，可以使用以下方式（类似常规 SQL 的 truncate 命令）：</p><pre><code>&gt;db.col.remove({})&gt;db.col.find()&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line">    &gt; 查询数据</span><br><span class="line">    </span><br><span class="line">    MongoDB 查询数据的语法格式如下：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">``&gt;db.COLLECTION_NAME.find()</span><br></pre></td></tr></table></figure></code></pre><p><code>find()</code> 方法以非结构化的方式来显示所有文档。 如果你需要以易读的方式来读取数据，可以使用 pretty() 方法，语法格式如下：</p><pre><code>&gt;db.col.find().pretty()</code></pre><p><code>pretty()</code> 方法以格式化的方式来显示所有文档。</p><p>实例：</p><pre><code>&gt; db.iiong.find(){ &quot;_id&quot; : ObjectId(&quot;583a8c7ace5d512be46975a6&quot;), &quot;title&quot; : &quot;MongoDB&quot;, &quot;description&quot; : &quot;它是一个 Nosql 数据库&quot;, &quot;by&quot; : &quot;苏城一只猫&quot;, &quot;url&quot; : &quot;https://jaxson.wang&quot;, &quot;tags&quot; : [ &quot;mongodb&quot;, &quot;database&quot;, &quot;NoSQL&quot; ], &quot;likes&quot; : 100 }&gt; db.iiong.find().pretty(){        &quot;_id&quot; : ObjectId(&quot;583a8c7ace5d512be46975a6&quot;),        &quot;title&quot; : &quot;MongoDB&quot;,        &quot;description&quot; : &quot;它是一个 Nosql 数据库&quot;,        &quot;by&quot; : &quot;苏城一只猫&quot;,        &quot;url&quot; : &quot;https://jaxson.wang&quot;,        &quot;tags&quot; : [                &quot;mongodb&quot;,                &quot;database&quot;,                &quot;NoSQL&quot;        ],        &quot;likes&quot; : 100}</code></pre><p>除了 find() 方法之外，还有一个 findOne() 方法，它只返回一个文档。</p><p>MongoDB 与 RDBMS Where 语句比较：</p><pre><code>操作        格式                            范例                                        RDBMS中的类似语句等于        {&lt;key&gt;:&lt;value&gt;}              db.iiong.find({&quot;by&quot;:&quot;黑色&quot;}).pretty()           where by = &apos;黑色&apos;小于        {&lt;key&gt;:{$lt:&lt;value&gt;}}    db.iiong.find({&quot;likes&quot;:{$lt:50}}).pretty()    where likes &lt; 50小于或等于   {&lt;key&gt;:{$lte:&lt;value&gt;}}    db.iiong.find({&quot;likes&quot;:{$lte:50}}).pretty()    where likes &lt;= 50大于        {&lt;key&gt;:{$gt:&lt;value&gt;}}    db.iiong.find({&quot;likes&quot;:{$gt:50}}).pretty()    where likes &gt; 50大于或等于   {&lt;key&gt;:{$gte:&lt;value&gt;}}    db.iiong.find({&quot;likes&quot;:{$gte:50}}).pretty()    where likes &gt;= 50不等于        {&lt;key&gt;:{$ne:&lt;value&gt;}}    db.iiong.find({&quot;likes&quot;:{$ne:50}}).pretty()      where likes != 50</code></pre><p>MongoDB AND 条件：</p><p>MongoDB 的 find() 方法可以传入多个键(key)，每个键(key)以逗号隔开，及常规 SQL 的 AND 条件。 语法格式如下：</p><pre><code>&gt;db.iiong.find({key1:value1, key2:value2}).pretty()</code></pre><p>实例 以下实例通过 by 和 title 键来查询的数据：</p><pre><code>&gt; db.iiong.find({&quot;by&quot;:&quot;苏城一只猫&quot;, &quot;title&quot;:&quot;MongoDB&quot;}).pretty(){        &quot;_id&quot; : ObjectId(&quot;583a8c7ace5d512be46975a6&quot;),        &quot;title&quot; : &quot;MongoDB&quot;,        &quot;description&quot; : &quot;它是一个 Nosql 数据库&quot;,        &quot;by&quot; : &quot;苏城一只猫&quot;,        &quot;url&quot; : &quot;https://jaxson.wang&quot;,        &quot;tags&quot; : [                &quot;mongodb&quot;,                &quot;database&quot;,                &quot;NoSQL&quot;        ],        &quot;likes&quot; : 100}</code></pre><p>MongoDB OR 条件 MongoDB OR 条件语句使用了关键字 $or,语法格式如下：</p><pre><code>&gt;db.col.find(   {      $or: [         {key1: value1}, {key2:value2}      ]   }).pretty()</code></pre><p>实例：</p><p>以下实例中，我们演示了查询键 by 值为 苏城一只猫 或键 title 值为 MongoDB 的数据。</p><pre><code>&gt; db.iiong.find({$or:[{&quot;by&quot;:&quot;苏城一只猫&quot;},{&quot;title&quot;: &quot;MongoDB&quot;}]}).pretty()){        &quot;_id&quot; : ObjectId(&quot;583a8c7ace5d512be46975a6&quot;),        &quot;title&quot; : &quot;MongoDB&quot;,        &quot;description&quot; : &quot;它是一个 Nosql 数据库&quot;,        &quot;by&quot; : &quot;苏城一只猫&quot;,        &quot;url&quot; : &quot;https://jaxson.wang&quot;,        &quot;tags&quot; : [                &quot;mongodb&quot;,                &quot;database&quot;,                &quot;NoSQL&quot;        ],        &quot;likes&quot; : 100}</code></pre><p>AND 和 OR 联合使用：</p><p>以下实例演示了 AND 和 OR 联合使用，类似常规 SQL 语句为： ‘where likes&gt;50 AND (by = ‘苏城一只猫’ OR title = ‘MongoDB’)’</p><pre><code>&gt; db.iiong.find({&quot;likes&quot;: {$gt:50}, $or: [{&quot;by&quot;: &quot;苏城一只猫&quot;},{&quot;title&quot;: &quot;MongoDB&quot;}]}).pretty()){        &quot;_id&quot; : ObjectId(&quot;583a8c7ace5d512be46975a6&quot;),        &quot;title&quot; : &quot;MongoDB&quot;,        &quot;description&quot; : &quot;它是一个 Nosql 数据库&quot;,        &quot;by&quot; : &quot;苏城一只猫&quot;,        &quot;url&quot; : &quot;https://jaxson.wang&quot;,        &quot;tags&quot; : [                &quot;mongodb&quot;,                &quot;database&quot;,                &quot;NoSQL&quot;        ],        &quot;likes&quot; : 100}</code></pre><p>基础就这点了，剩下问题以后在记录笔记吧。</p><p><code>``</code></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MongoDB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>杂记2</title>
      <link href="/miscellanies-notes-2.html"/>
      <url>/miscellanies-notes-2.html</url>
      
        <content type="html"><![CDATA[<h1 id="无题-2"><a href="#无题-2" class="headerlink" title="无题(2)"></a>无题(2)</h1><p>那天的下午，天空飘着零散的雨丝。</p><p>他和姗分手了，他提出的分手，姗只是特地做车过来，只想亲自确认下以及最后一眼。「呵呵。」转身回去，却忘天空正在下雨，浑不在意雨滴淋湿衣服，似乎淋湿了的是属于他的炽热的心。</p><p>他很想把手中的雨伞递给姗，但忍住了，怕看到伤心的姗会心软。等她的背景消失在他的视野，漫无经心走向家，五百米距离，走完似乎也有一个世纪之长，脑子如电影般播放他和姗相处的日子。说实话，他不想结束这段恋爱，但不知为何脑抽提出那要求。</p><p>姗是一个很普通的女孩，性格很活泼，是职校的学生，专业是会计。至于怎么认识的，可以归纳于网恋吧，记得刚认识的时候，俩个人之间并没有太多的交流，得知大家都是一个城市，之间的交流也渐渐多起来，相互了解也渐渐多起来。突然有一天，他敏感感觉到，姗似乎喜欢上他了，莫名其妙向他撒娇，讨到手机号码发短信，甚至打电话关心他，这对他来说，很害怕，也很惊喜。突如其来的爱情，让他措手不及，因为远在江南，一直工作的他没时间管理这份情谊，只是没想到发孝得这么快。</p><p>终于等到他休息了，请假几天回姗的城市。当天晚上，他约姗出来，想面谈他们之间感情的事。可万万没想到姗会这样的喜欢她，他不好意思说出来，「就让它这样吧！」</p><p>和她相处几天后，他发现自己渐渐喜欢上姗了。等他休息的时候，姗总是带着他去KTV，当然有姗的朋友们，他不会唱歌，总是坐在角落，默默听着姗为他点的歌曲，每听完一首歌，他的歌单就会多出一首，满满的喜欢，也是满满的爱。</p><p>事实上，异地恋的恋人们是为最辛苦，不仅要饱受思恋的折磨，恋人们还需要百分百的信任给予对方。终于有一天他最终不信任姗了，无论姗怎么解释，他很自私，从来不会考虑到别人的感受，所以姗和朋友们的劝说对他来说没什么用。半年的恋爱，也就这样结束了。</p><p>分手一个月后的他，日子依然是有规律，对他来说今天一直在重复昨天所做的。突然有个人打进他的手机里，虽然电话的人没有说出是谁，但他已经猜出来了——姗，到底没有死心。他没有急着挂断姗的电话。</p><p>「我不知道这个选择究竟是错了，我还是愿意藏起来，一辈子不想再看到你！」</p><p>他心软了，是的，他最大的缺点就是心软。</p><p>三年了，中间分分合合也有好几次。大部分分手的原因，就是没有百分百的信任，不会天长地久。今天，姗心累，回去的路上，分不清是泪水还是雨水的她想抛开对他的感情包袱，让雨水刷走俩人之间所谓的誓海盟山，刷走和他的过去。几公里路，硬生生顶着风雨回去，到家终于感冒了。</p><p>几年后冬夜，在姗的城市，他遇到了。</p><p>「嗯，还好吧，现在一家服装店经理，就是很忙。」姗对他微微一笑。</p><p>聊完几句后，各自擦肩而过。他只是不想再次打扰姗而已。</p><p>灯光仿似星光飘洒在街上，世界早已冰冻成一切。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>杂记1</title>
      <link href="/miscellanies-notes-1.html"/>
      <url>/miscellanies-notes-1.html</url>
      
        <content type="html"><![CDATA[<p>面对喧闹的城市，他后悔当时不该如此冲动，望着蓝湛湛的天空，总有一丝纯白如绸云飘过，正如他现在的烦恼。</p><p>突然脱离校园踏入社会，实在适应不过来，才知道校园是多么安逸和静，想得太多也没什么用，日子还是要过的。今天是他第一次来应聘工作——操作工，只是负责人遇到一些问题需要上报，他的年龄不符合要求…</p><p>『嘿，小伙子过来下！』工厂门口有位大叔朝喊了声，打断思绪的他走向大叔。</p><p>「实在是抱歉，你的年龄不符合我们厂的要求，如果雇佣你的话，我们可能要承担违反法律行为的。让你跑一趟了。再见！」说完大叔转头就走。似乎总有忙不完的事。</p><p>「唉…」愣着一分钟看着大叔的背景，叹气回身，准备回家。</p><p>「回来了？怎么样啊？」他老妈从厨房走出来问道。</p><p>「还能怎么样，在玩一年呗。」</p><p>「年龄不够吗？呵呵，不管怎么样，今年你必须找事做，我可不想天天养着你，否则的话今年继续跟你爸做生意吧。」说完转身进厨房忙去了。</p><p>「知道了…」上楼打开电脑，却对着屏保发呆。</p><p>「什么都没有，我讨厌这个世界！」</p><p>不过几天后，中介介绍他去一家私人工厂上班，虽然没有保险，安全措施也存在问题，免得在家天天被喷，最终选择去上班了。</p><p>他认识一个朋友——君，比他小俩岁的男孩，也是异地朋友玩得最好的。他们在一起总是很安静，无非谈谈之间过去有趣的事情，休息的时候，打打CF，不过君不会玩LOL，他有空带带君打人机，渐渐的熟悉规则后，开黑双排大闹青铜局，或许这段日子对他来说，是最快乐的日子。</p><p>很快，三年过去了。中间发生很多事，让他成熟了不少。</p><p>20岁的他，做过电子厂的手工操作员，做过码头上的搬运工，也做过满大街跑路的推销员…</p><p>他似乎失去了对生活热情，慢慢成为社会底层劳动者的一员，梦想对他来说，简直太遥远不可触及，只为明天是否能饿肚子担忧而发愁。</p><p>但这三年并没有放弃，只是心里深处总有一点不甘心，决不能一辈子成为这样！很幸运遇到一个人，带领他走进编程的世界，总算一点技术在身了。</p><p>年少的他，总会有些热血沸腾，做好了一切准备，他选择了和千千万万年轻人共有的选择——北漂。</p><p>窗外夜景飞快的消逝，他没有害怕，心境无喜无悲，心中策划着下午面试需要注意一些什么。</p><p>北京的早上7：46，这座城市又迎来一位慷慨激昂的年轻人。火车站门口，望着人山人海的过道，他恍如梦境，离家千里之外，只身北上，心境早已湖中涟漪般荡开，却不知这是什么滋味？</p><p>找下便宜的宾馆住下，打开随身带来的电脑，准备复习下题目，好应对下面的面试。下午，来到朝阳区，一家中小型的互联网公司，但面试过程中，遇到了一些问题，因为经验的不足拒绝。</p><p>但他没有放弃，很快就有了第二家抛开橄榄枝，虽然面试过去了，工资也定下来了，令人尴尬的是，剩下资金不足以让他生活三个月。短暂的几天，了解背景的情况后，他选择回到江南。</p><p>渐离北京，看着远处北京的夜景「或许几年后的今天，我会再来的！」，依然没有放弃，北京的工作生活，依然是他的梦想之一。</p><p>在江南休息近一星期，去了南京一家公司，很幸运第一家公司就应聘上了。下面几个月他的生活很有规律——喜欢简单的生活，每天准时起床，起来听几首歌曲，到了公司按时做项目，中午固定一个半小时午睡，下午依然是做项目，晚上回去充电学习。双休有时出去溜达，在不知名江河发呆，或仰望近处的紫金山。</p><p>这是他最喜欢的一句：</p><p>“O ever youthful, O ever weeping.” ——《The Dharm Bums》</p><p>“永远年轻，永远热泪盈眶。” ——《达摩流浪者》</p><p>「没错，就是我。莫要失去昨日的慷慨，莫要忘记曾经留下的眼泪！」</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>淘宝镜像npm</title>
      <link href="/taobao-npm-notes.html"/>
      <url>/taobao-npm-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="设置"><a href="#设置" class="headerlink" title="设置"></a>设置</h3><p>系统前几天重装了，啥配置重头再来…主要node管理包下不来…</p><p>万恶的长城防火墙，幸亏国内有<a href="http://npm.taobao.org/" target="_blank" rel="noopener">淘宝镜像</a>。但是我有强迫症，不喜欢单独下个cnpm….</p><p>搜了一些资料：</p><h3 id="通过config命令"><a href="#通过config命令" class="headerlink" title="通过config命令"></a>通过config命令</h3><p>终端输入</p><pre><code>npm config set registry &quot;https://registry.npm.taobao.org&quot;npm config list #输出是否配置成功npm info underscore #如果上面配置正确这个命令会有字符串response</code></pre><h3 id="命令行指定"><a href="#命令行指定" class="headerlink" title="命令行指定"></a>命令行指定</h3><p>npm –registry <a href="https://registry.npm.taobao.org" target="_blank" rel="noopener">https://registry.npm.taobao.org</a> info underscore</p><h3 id="编辑配置文件"><a href="#编辑配置文件" class="headerlink" title="编辑配置文件"></a>编辑配置文件</h3><p>Linux和Mac：~/.npmrc 加入下面内容 windows 10：C:\Users\Jaxson(Jaxson是你的用户名)加入下面的内容</p><pre><code>registry = https://registry.npm.taobao.org</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.JS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于16.11月份一些事</title>
      <link href="/about-2016-11-my-logs.html"/>
      <url>/about-2016-11-my-logs.html</url>
      
        <content type="html"><![CDATA[<h3 id="事情"><a href="#事情" class="headerlink" title="事情"></a>事情</h3><p>这个月很烦躁，家里总有一堆事情要去处理。想做一些自己的事情都不行！续续断断做个大半个月。下旬终于稍微轻松了点，也不怎么需要我了。打算月底找事情做做。</p><p>期间不少被喷了好几次，真尼玛憋屈，明明不是我引起的，怎么全是我的错，心塞。还是趁早走人，倒是怀念之前在南京的一个人“无心无肺”日子。</p><p>无奈之前发的工资以及信用卡部分钱都“借”给老爸用了。啧，我知道会拿不到的，但为什么这么心软？？当初明明可以说没有资金的，否则今天早就出去了。</p><p>我想说，好不痛快…</p><p>今天晚上洗脸的时候，仔细看镜子的自己，诶，黑眼睛又加重了，开始服用黑退素，睡眠质量一夜不如一夜。尽量改善自己的睡眠状况吧。</p><h3 id="不婚族"><a href="#不婚族" class="headerlink" title="不婚族"></a>不婚族</h3><p>今天和要好的朋友说未来，似乎都不愿意谈到结婚，或者说大家都没有结婚的想法…天呐，我这周围的人怎么回事？老早之前有个妹子谈到，她也不考虑结婚。可能那时候收到她影响或者这几年莫名其妙的有这个想法影响到我？</p><p>认认真真的反省下自己，为何有这个想法？谈不上讨厌，也没用害怕，总之就是没想法，没欲望。之后上知乎查了下，看来像这类的人还是蛮多的，不缺我一个。</p><blockquote><p>一个内心不想结婚的人永远找不到合适的结婚对象，一个内心渴望婚姻的人看谁都合适。 只是一个借口没遇到合适的人所以不婚，其实一辈子也不会遇到合适的人。 准备找个空气比较好的地方去隐居死宅养老了。也许我会在没老之前去一个没人的地方自杀，或是有天意外死去，不过我从来不后悔自己的选择。</p></blockquote><p>来自知乎的答主。</p><p>关于这点并不想多说。</p><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>最近博客更新可能少了，博客重新定位，它是属于我的博客，对，是我的博客！尽量提高原创作品能力，老是转载别人的文章，甚是木的意思。</p><p>晚安，世界！</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>iOS免越狱安装各版本软件</title>
      <link href="/ios-do-not-jailbreak-to-install-version-of-the-software.html"/>
      <url>/ios-do-not-jailbreak-to-install-version-of-the-software.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>每一次软件大更新都会为用户带来新的功能及体验，当然，随之也有可能带来了让人吃不消的内存消耗、一些没啥卵用的功能或者冒出一些原本没有的广告窗口。别的不说，就追书神器这软件实在是越来越恶心了，现在的版本看书也要钱了。</p><h3 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h3><p>环境是Windows 10专业版 1607，软件皆是最新版。</p><ol><li>iTunes</li><li>Fiddler</li></ol><h3 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h3><ol><li>打开你的Fiddler进行如下的一系列相关操作。</li></ol><p>软件设置：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/11/QQ%E6%88%AA%E5%9B%BE20161107111939.png" alt></p><p>打开HTTPS选项卡，如图勾选并填写解密白名单：<code>gas.apple.com</code></p><p><img src="https://res.i95.me/wp-content/uploads/2016/11/QQ%E6%88%AA%E5%9B%BE20161107112056.png" alt></p><p>设置监听端口号：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/11/QQ%E6%88%AA%E5%9B%BE20161107112110.png" alt></p><p>然后保存设置。</p><p>2.获取各个版本封包AppID值</p><p>首先登录你的iTunes，且对电脑进行授权。</p><p>在搜索“追书神器”获取链接来得到ID。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/11/1.png" alt></p><p>比如你复制的链接：<code>https://itunes.apple.com/cn/app/zhui-shu-shen-qi-xiao-shuo/id575826903?mt=8</code>那你的ID值是<code>575826903</code>，一串数字。</p><p>然后将获取的ID放入下面的链接：</p><pre><code>https://api.unlimapps.com/v1/apple_apps/[你获得的ID]/versions</code></pre><p>访问链接，你会发现一堆数据，其中的<code>bundle_version</code>指的是软件版本号，而后面的<code>external_identifier</code>是AppID值</p><ol><li>使用Fiddler抓包</li></ol><p>切回Fiddler窗口，监听且拦截8888端口链接：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/11/QQ%E6%88%AA%E5%9B%BE20161107113530.png" alt></p><p>然后切回iTunes，点击获取(下载)软件。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/11/2.png" alt></p><p>再起切换到Fiddler窗口，在左侧看到类似<code>pxx-buy-itunes.apple.com</code>，且是<code>http协议</code>的，点它，右侧放行。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/11/QQ%E6%88%AA%E5%9B%BE20161107113840.png" alt></p><p>然后右侧会看到类似<code>pxx-buy-itunes.apple.com</code>，且是<code>https协议</code>的，点它看右侧。</p><p>然后点<code>TextView</code>文本模式来编辑它的AppID，比如<code>812773310</code>，再然后就左下角，取消监听，双击俩次。放行这个规则。</p><p><a href="https://res.i95.me/wp-content/uploads/2016/11/QQ%E6%88%AA%E5%9B%BE20161107114434.png" target="_blank" rel="noopener"><img src="https://res.i95.me/wp-content/uploads/2016/11/QQ%E6%88%AA%E5%9B%BE20161107114434.png" alt></a></p><p>iTunes会让你输入密码，输入之后就开始下载App了。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/11/QQ%E6%88%AA%E5%9B%BE20161107114629.png" alt></p><p>教程到此结束。</p><blockquote><p>注意：你得到的ipa包是经过你的id授权的，其他用户无法使用，除非你让对方在手机app store里登陆你的ID，然后随便下载一个app并运行，再安装你的ipa包。否则其他用户通过PP助手等第三方工具安装上后会闪退无法使用。</p></blockquote><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><pre><code>QQ V4.2.2  ID:16122679    丝绸般润滑，无法使用任何与交易有关的功能。QQ V5.6    ID:812375519      无法使用任何与交易有关的功能QQ V5.9.1  ID:813463229      可以使用转账功能，但是无法发红包，抢红包功能没有测试，目测可以拆红包。【推荐使用】QQ浏览器 V6.1.1   ID:813125939    可以缓存视频的最后一个版本QQ空间  V5.1.1  ID:811660738        无广告，丝绸润滑，偶尔会出现身份错误，关闭之后重新打开就OK微信  V6.1.1          ID:811669817      能够抢发红包的最后一个版本【楼楼未测试，不推荐微信降级，因为最新版本的微信使用依旧流畅】百度云  V6.6.0     ID:812649628     可以免费在线解压小于50MB的压缩包，支持视频备份。【能在线解压，推荐降级】百度贴吧 V6.6.3   ID:没有保存，自己查吧。             【丝绸流畅，推荐使用】爱奇艺  V5.7.1    ID:759732747     【无片头广告推荐降级】追书神器 V2.23.1   ID:812773310     【据说最完美的一个版本，我还有几千的追书币，所以未测试】糗事百科 V2.6.4   ID:250112659       【无广告纯净版本，我ios10偶尔会闪退，可能是机子问题】</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>百度MIP wordpress视频教程+模版下载</title>
      <link href="/baidu-mip-wordpress-download.html"/>
      <url>/baidu-mip-wordpress-download.html</url>
      
        <content type="html"><![CDATA[<h3 id="视频介绍"><a href="#视频介绍" class="headerlink" title="视频介绍"></a>视频介绍</h3><p><a href="http://l2qq.com/mip.mp4" target="_blank" rel="noopener">点击观看</a></p><h3 id="MIP介绍"><a href="#MIP介绍" class="headerlink" title="MIP介绍"></a>MIP介绍</h3><p>官网：<a href="https://www.mipengine.org/" target="_blank" rel="noopener">https://www.mipengine.org/</a></p><h4 id="什么是MIP："><a href="#什么是MIP：" class="headerlink" title="什么是MIP："></a>什么是MIP：</h4><p>MIP(Mobile Instant Page – 移动网页加速器)，是一套应用于移动网页的开放性技术标准。通过提供MIP-HTML规范、MIP-JS运行环境以及MIP-Cache页面缓存系统，实现移动网页加速。 MIP主要由三部分组织成： MIP HTML MIP JS MIP Cache MIP HTML 基于HTML中的基础标签制定了全新的规范，通过对一部分基础标签的使用限制或功能扩展，使HTML能够展现更加丰富的内容；MIP JS 可以保证 MIP HTML 页面的快速渲染；MIP Cache 用于实现MIP页面的高速缓存，从而进一步提高页面性能。</p><h4 id="开发指南"><a href="#开发指南" class="headerlink" title="开发指南"></a>开发指南</h4><p>按照下面的步骤，你可以快速创建一个基本的 MIP HTML 页面；通过进一步了解 MIP HTML 规范、对 MIP HTML 页面进行阶段性的验证等内容，你可以轻松开发出理想的 MIP 页面。 基本步骤包括：</p><ol><li>创建基础 MIP HTML 页面</li><li>引入图片</li><li>调整样式和布局</li><li>预览和验证</li><li>最后一步</li></ol><h4 id="技术规范"><a href="#技术规范" class="headerlink" title="技术规范"></a>技术规范</h4><blockquote><p>头部使用规范</p></blockquote><pre><code>1. 起始标签使用&lt;!doctype html&gt;2. html标签必须加上mip标记，即: &lt;html mip&gt;3. 必须包含和 标签4. 必须在head标签中包含字符集声明: &lt;meta charset=&quot;utf-8&quot;&gt;，字符集统一为utf-85. 必须在head标签中包含viewport设置标签: &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,minimum-scale=1&quot;&gt;，推荐包含initial-scale=16. 必须在head标签中包含&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;//m.baidu.com/static/ala/sf/static/css/miphtml_xxxxxx.css&quot;&gt;7. 必须在head标签中包含&lt;script async src=&quot;https://m.baidu.com/miphtml/v0.js&quot;&gt;&lt;/script&gt;8. 必须在head标签中包含&lt;style&gt;body {opacity: 0} &lt;/style&gt;&lt;noscript&gt;&lt;style&gt;body {opacity: 1}&lt;/style&gt;&lt;/noscript&gt;9. 必须在body标签中包含 &lt;script src=&quot;//m.baidu.com/static/ala/sf/static/js/miphtml_main_xxxxxx.js&quot;&gt;</code></pre><p>详细文档：<a href="https://www.mipengine.org/doc/2-tech/1-mip-html.html" target="_blank" rel="noopener">Doc</a></p><h3 id="百度-amp-WordPress-MIP改造常见Q-amp-A集锦"><a href="#百度-amp-WordPress-MIP改造常见Q-amp-A集锦" class="headerlink" title="百度&amp;WordPress MIP改造常见Q&amp;A集锦"></a>百度&amp;WordPress MIP改造常见Q&amp;A集锦</h3><p>1、MIP化后对其他搜索引擎抓取收录以及SEO 的影响如何？ 答：在原页面MIP化，不会影响其它搜索引擎的抓取收录，也不会影响页面权重。新增MIP页可通过robot.txt文件禁用其它搜索引擎的抓取，从而保证原页面的权重。</p><p>2、MIP 可以加什么样子的广告？ 答：MIP既可以加入百度联盟广告，也可以加入第三方广告</p><p>3、MIPcache缓存更新时间是多长时间？ 答：目前是50分钟左右，后期将会优化到更短时间。</p><p>4、百度对站点MIP化方案的建议是怎样的？ 答：目前MIP化有两种方案：一种是在原有页面上进行修改，另一种是在保持原有页面的基础上再新建一套页面；两种方案都可以良好支持。</p><p>5、如果采取新建一套MIP 页面的方式，假设新建 MIP 页面出现问题，譬如改造错误、失效或者其他不可预知问题，百度的处理机制是怎样的？ 答：MIP是有回退机制的，MIP访问出问题后，会直接回到原来的h5页面；不会影响权重，mip会更被认可和优先。</p><p>6、是否必须是https才能 MIP化，如果不是https会有什么影响？如何快速https化? 答：mip改造本身是不需要支持https的。但如果要接入百度，要求是https的。可以通过自身支持或者走mip cache代理两种方式实现。快速进行https可以通过百度云加速的https方案进行快速部署https环境.</p><p>7、MIP 页面中可以展现哪些元素？对于弹窗广告有何限制？ 答：MIP页面中可以展示所有原页面的元素，在前端代码中对于一些标签做替换即可。我们会提供组件支持fix布局，可用于页面固定广告的显示。</p><p>8、MIP 化的收益是什么？具体数据? 答：从目前收集到的数据来看，网站MIP化上线后，页面速度提升30-80%，页面到达率提升5-40%</p><p>9、使用伪静态url的网站如何使用mip？ 答：MIP页面可能会被MIP-Cache缓存，所以用户看到的不一定是动态的页面。当需要更新页面内容时，可通过MIP组件形式封装js请求，以及后续更新DOM的js操作。</p><p>10、针对拥有pc、wap、mip三套页面的网站，如何进行移动适配工具和mip工具提交？ 答：MIP页面可单独通过站长平台的MIP入口提交，不会影响PC和WAP。</p><p>11、代码适配站点如何使用mip？ 答：区别讨论。如果后端根据UA判断是否为移动端页面，并返回页面，则将返回的页面MIP化即可。 如果是前端判断浏览器宽度或UA，再请求后端返回相应页面，则需要改变这套流程，使用后端判断，或直接改为响应式页面 。 12、MIP在原网站搭建还是重新在新子域做，还是新目录做？ 答：都可以，MIP不做限制。MIP和原页面的对应关系写在头部link标签中，具体见<a href="https://www.mipengine.org/doc/2-guide/show-your-page.html" target="_blank" rel="noopener">https://www.mipengine.org/doc/2-guide/show-your-page.html</a> 13、gbk编码的网站如何使用mip？ 答：更改成utf-8编码后使用MIP。gbk编码并不是国际通用标准，在一些手机上会有会显示乱码。</p><p>14、网站如何确认改造的mip页面已经在线上生效？ 答：MIP页面都会使用百度搜索结果页异步打开，只需要在百度搜索中搜索链接，并且打开后URL上是百度地址。</p><pre><code>15、这个mip移动网页加速器做了之后是只针对移动百度的展示还是说也对我们其它的正常用户一样显示？</code></pre><p>答：MIP页面都会使用百度搜索结果页异步打开，只需要在百度搜索中搜索链接，并且打开后URL上是百度地址。</p><p>16、MIP 与 CDN 的区别是什么？ (1)已使用了CDN之后，再进行 MIP 改造，两套CDN 会不会产生冲突和影响？ 答：不会产生冲突，也不会存在双重加速的问题。 搜索请求会先发到MIP-Cache（MIP-CDN），如果页面不存在或过期，会进一步访问原CDN。 (2)已经使用 CDN再用 MIP 的必要性是什么？ 答：MIP的性能提升方案，很大一部分是技术实现的收益，非cdn收益。MIP原理不能简单的理解为MF框架+CDN，技术核心是通过页面渲染技术等提升性能，详见：<a href="https://www.mipengine.org/article/what-is-mip.html" target="_blank" rel="noopener">https://www.mipengine.org/article/what-is-mip.html</a> 。</p><p>17、目前 MIP 组件之外的一些 javascript插件如何支持？譬如广告、统计、CSS、推荐等等？ 答：（1）MIP为了确保安全性和性能表现，不允许用户自定义JavaScript，需要用MIP 组件的形式引进来；MIP组件是开源的，允许开发者自定义功能组件。 （2）目前MIP组件已经支持多种功能组件：如广告支持站长自定义的横幅广告、视频广告、H5广告，同时也支持一些第三方广告系统，统计可以支持百度统计，更多具体的组件支持的可以参考官网的组件说明：<a href="https://www.mipengine.org/doc/3-widget/10-overview.html%EF%BC%9B%E5%90%8E%E7%BB%ADMIP%E4%B9%9F%E5%B0%86%E6%8C%81%E7%BB%AD%E6%8F%90%E4%BE%9B%E5%A4%9A%E6%A0%B7%E7%9A%84%E7%BB%84%E4%BB%B6%EF%BC%8C%E4%BB%A5%E9%80%82%E5%BA%94%E4%B8%8D%E5%90%8C%E7%9A%84%E9%9C%80%E6%B1%82" target="_blank" rel="noopener">https://www.mipengine.org/doc/3-widget/10-overview.html；后续MIP也将持续提供多样的组件，以适应不同的需求</a>.</p><p>18、搜索结果打开是百度的域名，用户分享的是否也是是百度链接？使用百度域名是否不利于网站的品牌传播同时也会影响流量统计，该如何解决？ 答：如果用户通过分享组件分享，则分享的标题，图片和内容都是原页面内容，具体分享内容可以在使用组件时定义。这种做法不会影响品牌传播，也不会影响流量统计。 如果用户直接从浏览器复制链接分享，那么被分享的是当前页面url，没有品牌和标题露出。统计代码在页面加载完成后都会生效，不会受到分享影响。</p><p>19、如果新建一套MIP页面，在搜索结果中MIP页面和原来的页面关系是怎样的？ 答：因为MIP中有页面指向的标签，当设置该标签后，搜索结果中会用MIP页面替换原生页面，用户打开后展现的是MIP页面</p><h3 id="WordPress模板下载"><a href="#WordPress模板下载" class="headerlink" title="WordPress模板下载"></a>WordPress模板下载</h3><p><a href="https://pan.baidu.com/s/1c2oRQKw" target="_blank" rel="noopener">百度网盘</a></p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>前端跨域总结</title>
      <link href="/front-end-cross-domain.html"/>
      <url>/front-end-cross-domain.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>原文地址：<a href="http://damonare.github.io/2016/10/30/%E5%89%8D%E7%AB%AF%E8%B7%A8%E5%9F%9F%E6%95%B4%E7%90%86/#more" target="_blank" rel="noopener">前端跨域总结</a></p><p><strong>相信每一个前端er对于跨域这两个字都不会陌生，在实际项目中应用也是比较多的。但跨域方法的多种多样实在让人目不暇接。老规矩，碰到这种情况，就只能自己总结一篇博客，作为记录。</strong></p><h3 id="什么是跨域？"><a href="#什么是跨域？" class="headerlink" title="什么是跨域？"></a>什么是跨域？</h3><p>跨域一词从字面意思看，就是跨域名嘛，但实际上跨域的范围绝对不止那么狭隘。具体概念如下：只要协议、域名、端口有任何一个不同，都被当作是不同的域。之所以会产生跨域这个问题呢，其实也很容易想明白，要是随便引用外部文件，不同标签下的页面引用类似的彼此的文件，浏览器很容易懵逼的，安全也得不到保障了就。什么事，都是安全第一嘛。但在安全限制的同时也给注入iframe或是ajax应用上带来了不少麻烦。所以我们要通过一些方法使本域的js能够操作其他域的页面对象或者使其他域的js能操作本域的页面对象（iframe之间）。下面是具体的跨域情况详解：</p><pre><code>URL                      说明       是否允许通信http://www.a.com/a.jshttp://www.a.com/b.js     同一域名下   允许http://www.a.com/lab/a.jshttp://www.a.com/script/b.js 同一域名下不同文件夹 允许http://www.a.com:8000/a.jshttp://www.a.com/b.js     同一域名，不同端口  不允许http://www.a.com/a.jshttps://www.a.com/b.js 同一域名，不同协议 不允许http://www.a.com/a.jshttp://70.32.92.74/b.js 域名和域名对应ip 不允许http://www.a.com/a.jshttp://script.a.com/b.js 主域相同，子域不同 不允许（cookie这种情况下也不允许访问）http://www.a.com/a.jshttp://a.com/b.js 同一域名，不同二级域名（同上） 不允许（cookie这种情况下也不允许访问）http://www.cnblogs.com/a.jshttp://www.a.com/b.js 不同域名 不允许</code></pre><p><strong>这里我们需要注意两点:</strong> 如果是协议和端口造成的跨域问题“前台”是无能为力的； 在跨域问题上，域仅仅是通过“URL的首部”来识别而不会去尝试判断相同的ip地址对应着两个域或两个域是否在同一个ip上。 (“URL的首部”指window.location.protocol +window.location.host，也可以理解为“Domains, protocols and ports must match”。)</p><h3 id="通过document-domain跨域"><a href="#通过document-domain跨域" class="headerlink" title="通过document.domain跨域"></a>通过document.domain跨域</h3><p>前面说过了，浏览器有一个同源策略，其限制之一是不能通过ajax的方法去请求不同源中的文档。 第二个限制是浏览器中不同域的框架之间是不能进行js的交互操作的。不同的框架之间是可以获取window对象的，但却无法获取相应的属性和方法。比如，有一个页面，它的地址是<a href="http://www.damonare.cn/a.html" target="_blank" rel="noopener">http://www.damonare.cn/a.html</a> ， 在这个页面里面有一个iframe，它的src是<a href="http://damonare.cn/b.html" target="_blank" rel="noopener">http://damonare.cn/b.html</a>, 很显然，这个页面与它里面的iframe框架是不同域的，所以我们是无法通过在页面中书写js代码来获取iframe中的东西的：</p><pre><code>&lt;script type=&quot;text/javascript&quot;&gt;    function test(){        var iframe = document.getElementById(&apos;￼ifame&apos;);        var win = iframe.contentWindow;//可以获取到iframe里的window对象，但该window对象的属性和方法几乎是不可用的        var doc = win.document;//这里获取不到iframe里的document对象        var name = win.name;//这里同样获取不到window对象的name属性    }&lt;/script&gt;&lt;iframe id = &quot;iframe&quot; src=&quot;http://damonare.cn/b.html&quot; onload = &quot;test()&quot;&gt;&lt;/iframe&gt;</code></pre><p>这个时候，document.domain就可以派上用场了，我们只要把<a href="http://www.damonare.cn/a.html%E5%92%8Chttp://damonare.cn/b.html%E8%BF%99%E4%B8%A4%E4%B8%AA%E9%A1%B5%E9%9D%A2%E7%9A%84document.domain%E9%83%BD%E8%AE%BE%E6%88%90%E7%9B%B8%E5%90%8C%E7%9A%84%E5%9F%9F%E5%90%8D%E5%B0%B1%E5%8F%AF%E4%BB%A5%E4%BA%86%E3%80%82%E4%BD%86%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E6%98%AF%EF%BC%8Cdocument.domain%E7%9A%84%E8%AE%BE%E7%BD%AE%E6%98%AF%E6%9C%89%E9%99%90%E5%88%B6%E7%9A%84%EF%BC%8C%E6%88%91%E4%BB%AC%E5%8F%AA%E8%83%BD%E6%8A%8Adocument.domain%E8%AE%BE%E7%BD%AE%E6%88%90%E8%87%AA%E8%BA%AB%E6%88%96%E6%9B%B4%E9%AB%98%E4%B8%80%E7%BA%A7%E7%9A%84%E7%88%B6%E5%9F%9F%EF%BC%8C%E4%B8%94%E4%B8%BB%E5%9F%9F%E5%BF%85%E9%A1%BB%E7%9B%B8%E5%90%8C%E3%80%82" target="_blank" rel="noopener">http://www.damonare.cn/a.html和http://damonare.cn/b.html这两个页面的document.domain都设成相同的域名就可以了。但要注意的是，document.domain的设置是有限制的，我们只能把document.domain设置成自身或更高一级的父域，且主域必须相同。</a></p><ul><li><p>在页面<a href="http://www.damonare.cn/a.html" target="_blank" rel="noopener">http://www.damonare.cn/a.html</a> 中设置document.domain:</p><p><iframe id="iframe" src="http://damonare.cn/b.html" onload="test()"></iframe></p><script type="text/javascript">    document.domain = 'damonare.cn';//设置成主域    function test(){        alert(document.getElementById('￼iframe').contentWindow);//contentWindow 可取得子窗口的 window 对象    }</script></li></ul><ul><li><p>在页面<a href="http://damonare.cn/b.html" target="_blank" rel="noopener">http://damonare.cn/b.html</a> 中也设置document.domain:</p><script type="text/javascript">    document.domain = 'damonare.cn';//在iframe载入这个页面也设置document.domain，使之与主页面的document.domain相同</script></li></ul><p><strong>修改document.domain的方法只适用于不同子域的框架间的交互。</strong></p><h3 id="通过location-hash跨域"><a href="#通过location-hash跨域" class="headerlink" title="通过location.hash跨域"></a>通过location.hash跨域</h3><p>因为父窗口可以对iframe进行URL读写，iframe也可以读写父窗口的URL，URL有一部分被称为hash，就是#号及其后面的字符，它一般用于浏览器锚点定位，Server端并不关心这部分，应该说HTTP请求过程中不会携带hash，所以这部分的修改不会产生HTTP请求，但是会产生浏览器历史记录。此方法的原理就是改变URL的hash部分来进行双向通信。每个window通过改变其他 window的location来发送消息（由于两个页面不在同一个域下IE、Chrome不允许修改parent.location.hash的值，所以要借助于父窗口域名下的一个代理iframe），并通过监听自己的URL的变化来接收消息。这个方式的通信会造成一些不必要的浏览器历史记录，而且有些浏览器不支持onhashchange事件，需要轮询来获知URL的改变，最后，这样做也存在缺点，诸如数据直接暴露在了url中，数据容量和类型都有限等。下面举例说明：</p><p>假如父页面是baidu.com/a.html,iframe嵌入的页面为google.com/b.html（此处省略了域名等url属性），要实现此两个页面间的通信可以通过以下方法。</p><ul><li>a.html传送数据到b.html - a.html下修改iframe的src为google.com/b.html#paco</li><li>b.html监听到url发生变化，触发相应操作</li><li>b.html传送数据到a.html，由于两个页面不在同一个域下IE、Chrome不允许修改parent.location.hash的值，所以要借助于父窗口域名下的一个代理iframe - b.html下创建一个隐藏的iframe，此iframe的src是baidu.com域下的，并挂上要传送的hash数据，如src=”<a href="http://www.baidu.com/proxy.html#data" target="_blank" rel="noopener">http://www.baidu.com/proxy.html#data</a>“</li><li>proxy.html监听到url发生变化，修改a.html的url（因为a.html和proxy.html同域，所以proxy.html可修改a.html的url hash）</li><li>a.html监听到url发生变化，触发相应操作</li></ul><p>b.html页面的关键代码如下:</p><pre><code>try {      parent.location.hash = &apos;data&apos;;  } catch (e) {      // ie、chrome的安全机制无法修改parent.location.hash，     var ifrproxy = document.createElement(&apos;iframe&apos;);      ifrproxy.style.display = &apos;none&apos;;      ifrproxy.src = &quot;http://www.baidu.com/proxy.html#data&quot;;      document.body.appendChild(ifrproxy);  }</code></pre><p>proxy.html页面的关键代码如下 :</p><pre><code>//因为parent.parent（即baidu.com/a.html）和baidu.com/proxy.html属于同一个域，所以可以改变其location.hash的值  parent.parent.location.hash = self.location.hash.substring(1);</code></pre><h3 id="通过HTML5的postMessage方法跨域"><a href="#通过HTML5的postMessage方法跨域" class="headerlink" title="通过HTML5的postMessage方法跨域"></a>通过HTML5的postMessage方法跨域</h3><p>高级浏览器Internet Explorer 8+, chrome，Firefox , Opera 和 Safari 都将支持这个功能。这个功能主要包括接受信息的”message”事件和发送消息的”postMessage”方法。比如damonare.cn域的A页面通过iframe嵌入了一个google.com域的B页面，可以通过以下方法实现A和B的通信</p><p>A页面通过postMessage方法发送消息：</p><pre><code>    window.onload = function() {      var ifr = document.getElementById(&apos;ifr&apos;);      var targetOrigin = &quot;http://www.google.com&quot;;      ifr.contentWindow.postMessage(&apos;hello world!&apos;, targetOrigin);  };</code></pre><p>postMessage的使用方法：</p><ul><li>otherWindow.postMessage(message, targetOrigin); - otherWindow:指目标窗口，也就是给哪个window发消息，是 window.frames 属性的成员或者由 window.open 方法创建的窗口</li><li>message: 是要发送的消息，类型为 String、Object (IE8、9 不支持)</li><li>targetOrigin: 是限定消息接收范围，不限制请使用 ‘*</li></ul><p>B页面通过message事件监听并接受消息:</p><pre><code>  var onmessage = function (event) {    var data = event.data;//消息   var origin = event.origin;//消息来源地址   var source = event.source;//源Window对象   if(origin==&quot;http://www.baidu.com&quot;){  console.log(data);//hello world!   }  };  if (typeof window.addEventListener != &apos;undefined&apos;) {    window.addEventListener(&apos;message&apos;, onmessage, false);  } else if (typeof window.attachEvent != &apos;undefined&apos;) {    //for ie   window.attachEvent(&apos;onmessage&apos;, onmessage);  }</code></pre><p>同理，也可以B页面发送消息，然后A页面监听并接受消息。</p><h3 id="通过jsonp跨域"><a href="#通过jsonp跨域" class="headerlink" title="通过jsonp跨域"></a>通过jsonp跨域</h3><blockquote><p>刚才说的这几种都是双向通信的，即两个iframe，页面与iframe或是页面与页面之间的，下面说几种单项跨域的（一般用来获取数据），因为通过script标签引入的js是不受同源策略的限制的。所以我们可以通过script标签引入一个js或者是一个其他后缀形式（如php，jsp等）的文件，此文件返回一个js函数的调用。</p></blockquote><p>比如，有个a.html页面，它里面的代码需要利用ajax获取一个不同域上的json数据，假设这个json数据地址是<a href="http://damonare.cn/data.php,%E9%82%A3%E4%B9%88a.html%E4%B8%AD%E7%9A%84%E4%BB%A3%E7%A0%81%E5%B0%B1%E5%8F%AF%E4%BB%A5%E8%BF%99%E6%A0%B7%EF%BC%9A" target="_blank" rel="noopener">http://damonare.cn/data.php,那么a.html中的代码就可以这样：</a></p><pre><code>&lt;script type=&quot;text/javascript&quot;&gt;    function dosomething(jsondata){        //处理获得的json数据    }&lt;/script&gt;&lt;script src=&quot;http://example.com/data.php?callback=dosomething&quot;&gt;&lt;/script&gt;</code></pre><p>我们看到获取数据的地址后面还有一个callback参数，按惯例是用这个参数名，但是你用其他的也一样。当然如果获取数据的jsonp地址页面不是你自己能控制的，就得按照提供数据的那一方的规定格式来操作了。</p><p>因为是当做一个js文件来引入的，所以<a href="http://damonare.cn/data.php%E8%BF%94%E5%9B%9E%E7%9A%84%E5%BF%85%E9%A1%BB%E6%98%AF%E4%B8%80%E4%B8%AA%E8%83%BD%E6%89%A7%E8%A1%8C%E7%9A%84js%E6%96%87%E4%BB%B6%EF%BC%8C%E6%89%80%E4%BB%A5%E8%BF%99%E4%B8%AA%E9%A1%B5%E9%9D%A2%E7%9A%84php%E4%BB%A3%E7%A0%81%E5%8F%AF%E8%83%BD%E6%98%AF%E8%BF%99%E6%A0%B7%E7%9A%84(%E4%B8%80%E5%AE%9A%E8%A6%81%E5%92%8C%E5%90%8E%E7%AB%AF%E7%BA%A6%E5%AE%9A%E5%A5%BD%E5%93%A6" target="_blank" rel="noopener">http://damonare.cn/data.php返回的必须是一个能执行的js文件，所以这个页面的php代码可能是这样的(一定要和后端约定好哦</a>):</p><pre><code>&lt;?php$callback = $_GET[&apos;callback&apos;];//得到回调函数名$data = array(&apos;a&apos;,&apos;b&apos;,&apos;c&apos;);//要返回的数据echo $callback.&apos;(&apos;.json_encode($data).&apos;)&apos;;//输出?&gt;</code></pre><p>最终，输出结果为：dosomething([‘a’,’b’,’c’]);</p><p>如果你的页面使用jquery，那么通过它封装的方法就能很方便的来进行jsonp操作了。</p><pre><code>&lt;script type=&quot;text/javascript&quot;&gt;    $.getJSON(&apos;http://example.com/data.php?callback=?,function(jsondata)&apos;){        //处理获得的json数据    });&lt;/script&gt;</code></pre><p>jquery会自动生成一个全局函数来替换callback=?中的问号，之后获取到数据后又会自动销毁，实际上就是起一个临时代理函数的作用。$.getJSON方法会自动判断是否跨域，不跨域的话，就调用普通的ajax方法；跨域的话，则会以异步加载js文件的形式来调用jsonp的回调函数。</p><ul><li>JSONP的优缺点 - JSONP的优点是：它不像XMLHttpRequest对象实现的Ajax请求那样受到同源策略的限制；它的兼容性更好，在更加古老的浏览器中都可以运行，不需要XMLHttpRequest或ActiveX的支持；并且在请求完毕后可以通过调用callback的方式回传结果。</li><li>JSONP的缺点则是：它只支持GET请求而不支持POST等其它类型的HTTP请求；它只支持跨域HTTP请求这种情况，不能解决不同域的两个页面之间如何进行JavaScript调用的问题。</li></ul><h3 id="通过CORS跨域"><a href="#通过CORS跨域" class="headerlink" title="通过CORS跨域"></a>通过CORS跨域</h3><blockquote><p>CORS（Cross-Origin Resource Sharing）跨域资源共享，定义了必须在访问跨域资源时，浏览器与服务器应该如何沟通。CORS背后的基本思想就是使用自定义的HTTP头部让浏览器与服务器进行沟通，从而决定请求或响应是应该成功还是失败。目前，所有浏览器都支持该功能，IE浏览器不能低于IE10。整个CORS通信过程，都是浏览器自动完成，不需要用户参与。对于开发者来说，CORS通信与同源的AJAX通信没有差别，代码完全一样。浏览器一旦发现AJAX请求跨源，就会自动添加一些附加的头信息，有时还会多出一次附加的请求，但用户不会有感觉。</p></blockquote><p><strong>因此，实现CORS通信的关键是服务器。只要服务器实现了CORS接口，就可以跨源通信。</strong></p><p>平时的ajax请求可能是这样的:</p><pre><code>&lt;script type=&quot;text/javascript&quot;&gt;    var xhr = new XMLHttpRequest();    xhr.open(&quot;POST&quot;, &quot;/damonare&quot;,true);    xhr.send();&lt;/script&gt;</code></pre><p>以上damonare部分是相对路径，如果我们要使用CORS，相关Ajax代码可能如下所示：</p><pre><code>&lt;script type=&quot;text/javascript&quot;&gt;    var xhr = new XMLHttpRequest();    xhr.open(&quot;￼GET&quot;, &quot;http://segmentfault.com/u/trigkit4/&quot;,true);    xhr.send();&lt;/script&gt;</code></pre><p>代码与之前的区别就在于相对路径换成了其他域的绝对路径，也就是你要跨域访问的接口地址。</p><p>服务器端对于CORS的支持，主要就是通过设置Access-Control-Allow-Origin来进行的。如果浏览器检测到相应的设置，就可以允许Ajax进行跨域的访问。关于CORS更多了解可以看下阮一峰老师的这一篇文章：<a href="http://www.ruanyifeng.com/blog/2016/04/cors.html" target="_blank" rel="noopener">跨域资源共享 CORS 详解</a></p><ul><li>CORS和JSONP对比 - JSONP只能实现GET请求，而CORS支持所有类型的HTTP请求。</li><li>使用CORS，开发者可以使用普通的XMLHttpRequest发起请求和获得数据，比起JSONP有更好的错误处理。</li><li>JSONP主要被老的浏览器支持，它们往往不支持CORS，而绝大多数现代浏览器都已经支持了CORS）。</li></ul><p>CORS与JSONP相比，无疑更为先进、方便和可靠。</p><h3 id="通过window-name跨域"><a href="#通过window-name跨域" class="headerlink" title="通过window.name跨域"></a>通过window.name跨域</h3><blockquote><p>window对象有个name属性，该属性有个特征：即在一个窗口(window)的生命周期内,窗口载入的所有的页面都是共享一个window.name的，每个页面对window.name都有读写的权限，window.name是持久存在一个窗口载入过的所有页面中的，并不会因新页面的载入而进行重置。</p></blockquote><p>比如：我们在任意一个页面输入</p><pre><code>window.name = &quot;My window&apos;s name&quot;;setTimeout(function(){    window.location.href = &quot;http://damonare.cn/&quot;;},1000)</code></pre><p>进入damonare.cn页面后我们再检测再检测 window.name :</p><pre><code>window.name; // My window&apos;s name</code></pre><p>可以看到，如果在一个标签里面跳转网页的话，我们的 window.name 是不会改变的。 基于这个思想，我们可以在某个页面设置好 window.name 的值，然后跳转到另外一个页面。在这个页面中就可以获取到我们刚刚设置的 window.name 了。</p><blockquote><p>由于安全原因，浏览器始终会保持 window.name 是string 类型。</p></blockquote><p>同样这个方法也可以应用到和iframe的交互来： 比如：我的页面(<a href="http://damonare.cn/index.html" target="_blank" rel="noopener">http://damonare.cn/index.html)中内嵌了一个iframe：</a>%E4%B8%AD%E5%86%85%E5%B5%8C%E4%BA%86%E4%B8%80%E4%B8%AAiframe%EF%BC%9A)</p><pre><code>&lt;iframe id=&quot;iframe&quot; src=&quot;http://www.google.com/iframe.html&quot;&gt;&lt;/iframe&gt;</code></pre><p>在 iframe.html 中设置好了 window.name 为我们要传递的字符串。 我们在 index.html 中写了下面的代码：</p><pre><code>var iframe = document.getElementById(&apos;iframe&apos;);var data = &apos;&apos;;iframe.onload = function() {    data = iframe.contentWindow.name;};</code></pre><p>Boom!报错！肯定的，因为两个页面不同源嘛，想要解决这个问题可以这样干：</p><pre><code>var iframe = document.getElementById(&apos;iframe&apos;);var data = &apos;&apos;;iframe.onload = function() {    iframe.onload = function(){        data = iframe.contentWindow.name;    }    iframe.src = &apos;about:blank&apos;;};</code></pre><p><strong>或者将里面的 about:blank 替换成某个同源页面（about:blank，javascript: 和 data: 中的内容，继承了载入他们的页面的源。）</strong></p><p>这种方法与 document.domain 方法相比，放宽了域名后缀要相同的限制，可以从任意页面获取 string 类型的数据。</p><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><blockquote><p>其它诸如中间件跨域，服务器代理跨域，Flash URLLoader跨域，动态创建script标签（简化版本的jsonp）不作讨论。</p></blockquote><p><strong>参考文章：</strong></p><ul><li><a href="https://segmentfault.com/a/1190000000718840#articleHeader1" target="_blank" rel="noopener">详解js跨域问题</a></li><li><a href="http://blog.csdn.net/joyhen/article/details/21631833" target="_blank" rel="noopener">前端解决跨域问题的8种方案（最新最全）</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JPEG和PNG到底有什么区别</title>
      <link href="/the-difference-between-jpeg-and-png.html"/>
      <url>/the-difference-between-jpeg-and-png.html</url>
      
        <content type="html"><![CDATA[<p>首先，这是两种特性几乎完全不同的图片格式。</p><h3 id="定义来源于网络词条："><a href="#定义来源于网络词条：" class="headerlink" title="定义来源于网络词条："></a>定义来源于网络词条：</h3><p>（1）JPEG图片以 24 位颜色存储单个位图。JPEG 是与平台无关的格式，支持最高级别的压缩，不过，这种压缩是有损耗的。渐近式 JPEG 文件支持交错。 （2）PNG的名称来源于“可移植网络图形格式(Portable Network Graphic Format，PNG)”（来自词条“png”）。png支持透明效果 PNG可以为原图像定义256个透明层次，使得彩色图像的边缘能与任何背景平滑地融合，从而彻底地消除锯齿边缘。这种功能是GIF和JPEG没有的。</p><p>PNG文件采用LZ77算法的派生算法进行压缩，其结果是获得高的压缩比，不损失数据。它利用特殊的编码方法标记重复出现的数据，因而对图像的颜色没有影响，也不可能产生颜色的损失，这样就可以重复保存而不降低图像质量。即“无损压缩”。</p><p>而且png格式的图片的设计目的是：试图替代GIF和TIFF文件格式，同时增加一些GIF文件格式所不具备的特性。（来自词条“png”）</p><p>因此我们可以得出： （1）JPEG图片在支持高级别压缩上有优势，但这种优势是以损耗一定图片质量为前提的。而PNG则支持无损压缩。 （2）png图片格式的对手其实从来都不是jpeg。</p><h3 id="从照片质量角度："><a href="#从照片质量角度：" class="headerlink" title="从照片质量角度："></a>从照片质量角度：</h3><p>jpeg：“以良好质量保存照片” png：“以高质量保存照片与绘图” 但二者的差距对于非相关专业需要的人员/色彩敏感的人来说，一般感受不到差别。</p><h3 id="从文件大小角度："><a href="#从文件大小角度：" class="headerlink" title="从文件大小角度："></a>从文件大小角度：</h3><p>可以提高或降低JPEG文件压缩的级别，从而达到减小JPEG文件大小。但是，文件大小是以牺牲图像质量为代价的。压缩比率可以高达 100:1。（JPEG 格式可在 10:1 到 20:1 的比率下轻松地压缩文件，而图片质量不会下降。） JPEG压缩可以很好地处理写实摄影作品。但是，对于颜色较少、对比级别强烈、实心边框或纯色区域大的较简单的作品，JPEG压缩无法提供理想的结果。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>一个老奶奶的唠叨：当年我玩 Linux 时…</title>
      <link href="/my-linux-story-carla-schroder.html"/>
      <url>/my-linux-story-carla-schroder.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在很久以前，那时还没有 Linux 系统。真的没有！之前也从未存在过。不像现在，Linux 系统随处可见。那时有各种流派的 Unix 系统、有苹果的操作系统、有微软的 Windows 操作系统。</p><p>比如说 Windows，它的很多东西都改变了，但是依然保持不变的东西的更多。尽管它已经增加了 20GB 以上的鬼知道是什么的东西，但是 Windows 还是大体保持不变（除了不能在 DOS 的提示下实际做些什么了）。嘿，谁还记得 Gorilla.bas 那个出现在 DOS 系统里的炸香蕉的游戏吗？多么美好的时光啊！不过互联网却不会忘记，你可以在 Kongregate.com 这个网站玩这个游戏的 Flash版本。</p><p>苹果系统也改变了，从一个鼓励你 hack 的友善系统变成了一个漂亮而密实的、根本不让你打开的小盒子，而且还限制了你使用的硬件接口。1998 年：软盘没了。2012 年：光驱没了。而 12 英寸的 MacBook 只有一个单一的 USB Type-C 接口，提供了电源、蓝牙、无线网卡、外部存储、视频输出和其它的一些配件的接口。而你要是想一次连接多个外设就不得不背着一堆转接器，这真是太令人抓狂了！然后就轮到耳机插孔了，没错，这唯一一个苹果世界里留着的非专有的标准硬件接口了，也注定要消失了。（LCTT 译注：还好，虽然最新的 IPhone 7 上没有耳机插孔了，但是新发布的 Macbook 上还有）</p><p>还有一大堆其它的操作系统，比如：Amiga、BeOS、OS/2 ，如果你愿意的话，你能找到几十个操作系统。我建议你去找找看，太容易找到了。Amiga、 BeOS 和 OS/2 这些系统都值得关注，因为它们有强大的功能，比如 32 位的多任务和高级图形处理能力。但是市场的影响击败了强大的系统性能，因此技术上并不出众的 Apple 和 Windows 操作系统统治了市场的主导地位，而那些曾经的系统也逐渐销声匿迹了。</p><p>然后 Linux 系统出现了，世界也因此改变了。</p><h3 id="第一款电脑"><a href="#第一款电脑" class="headerlink" title="第一款电脑"></a>第一款电脑</h3><p>我曾经使用过的第一款电脑是 Apple IIc ，大概在 1994年左右，而那个时候 Linux 系统刚出来 3 年。这是我从一个朋友那里借来的，用起来各方面都还不错，但是很不方便。所以我自己花了将近 500 美元买了一台二手的 Tandy 牌的电脑。这对于卖电脑的人来说是一件很伤心的事，因为新电脑要花费双倍的价钱。那个时候，电脑贬值的速度非常快。这个电脑当时看起来强劲得像是个怪物：一个英特尔 386SX 的 CPU，4MB的内存，一个 107MB 的硬盘，14 英寸的彩色 CRT 显示器，运行 MS-DOS 5 和 Windows 3.1 系统。</p><p>我曾无数次的拆开那个可怜的怪物，并且多次重新安装 Windows 和 DOS 系统。因为 Windows 桌面用的比较少，所以我的大部分工作都是在 DOS 下完成的。我喜欢玩血腥暴力的视频游戏，包括 Doom、Duke Nukem、Quake 和 Heretic。啊！那些美好的，让人心动的 8 位图像！</p><p>那个时候硬件的发展一直落后于软件，因此我经常升级硬件。现在我们能买到满足我们需求的任何配置的电脑。我已经好多年都没有再更新我的任何电脑硬件了。</p><h3 id="《比特杂志Computer-bits》"><a href="#《比特杂志Computer-bits》" class="headerlink" title="《比特杂志Computer bits》"></a>《比特杂志Computer bits》</h3><p>回到那些曾经辉煌的年代，电脑商店布满大街小巷，找到本地的一家网络服务提供商（ISP）也不用走遍整个街区。ISP 那个时候真的非比寻常，它们不是那种冷冰冰的令人讨论的超级大公司，而是像美国电信运营商和有线电视公司这样的好朋友。他们都非常友好，并且提供各种各样的像 BBS、文件下载、MUD （多玩家在线游戏）等的额外服务。</p><p>我花了很多的时间在电脑商店购买配件，但是很多时候我一个女人家去那里会让店里的员工感到吃惊，我真的很无语了，这怎么就会让一些人看不惯了。我现成已经是一位 58 岁的老家伙了，但是他们还是一样的看不惯我。我希望我这个女电脑迷在我死之前能被他们所接受。</p><p>那些商店的书架上摆满了《比特杂志Computer bits》。有关《比特杂志》的历史刊物[1]可以在互联网档案库Internet Archive中查到。《比特杂志》是当地一家免费报纸，有很多关于计算机方面的优秀的文章和大量的广告。可惜当时的广告没有网络版，因此大家不能再看到那些很有价值的关于计算机方面的详细信息了。你知道现在的广告商们有多么的抓狂吗？他们埋怨那些安装广告过滤器的人，致使科技新闻变成了伪装的广告。他们应该学习一下过去的广告模式，那时候的广告里有很多有价值的信息，大家都喜欢阅读。我从《比特杂志》和其它的电脑杂志的广告中学到了所有关于计算机硬件的知识。《电脑购买者杂志Computer Shopper》更是非常好的学习资料，其中有上百页的广告和很多高质量的文章。</p><p>《比特杂志》的出版人 Paul Harwood 开启了我的写作生涯。我的第一篇计算机专业性质的文章就是在《比特杂志》发表的。 Paul，仿佛你一直都在我的身旁，谢谢你。</p><p>在互联网档案库中，关于《比特杂志》的分类广告信息已经几乎查询不到了。分类广告模式曾经给出版商带来巨大的收入。免费的分类广告网站 Craigslist 在这个领域独占鳌头，同时也扼杀了像《比特杂志》这种以传统的报纸和出版为主的杂志行业。</p><p>其中有一些让我最难以忘怀的记忆就是一个 12 岁左右的吊儿郎当的小屁孩，他脸上挂满了对我这种光鲜亮丽的女人所做工作的不屑和不理解的表情，他在我钟爱的电脑店里走动，递给我一本《比特杂志》，当成给初学者的一本好书。我翻开杂志，指着其中一篇我写的关于 Linux 系统的文章给他看，他说“哦，我明白了”。他尴尬的脸变成了那种正常生理上都不可能呈现的颜色，然后很仓促地夹着尾巴溜走了。(不是的，我亲爱的、诚实的读者们，他不是真的只有 12 岁，而应该是 20 来岁。他现在应该比以前更成熟懂事一些了吧！）</p><h3 id="发现-Linux"><a href="#发现-Linux" class="headerlink" title="发现 Linux"></a>发现 Linux</h3><p>我第一次了解到 Linux 系统是在《比特杂志》上，大概在 1997 年左右。我一开始用的一些 Linux操作系统版本是 Red Hat 5 和 Mandrake Linux（曼德拉草）。 Mandrake 真是太棒了，它是第一款易安装型的 Linux 系统，并且还附带图形界面和声卡驱动，因此我马上就可以玩 Tux Racer 游戏了。不像那时候大多数的 Linux 迷们，因为我之前没接触过 Unix系统，所以我学习起来比较难。但是一切都还顺利吧，因为我学到的东西都很有用。相对于我在 Windows 中的体验，我在 Windows 中学习的大部分东西都是徒劳，最终只能放弃返回到 DOS 下。</p><p>玩转电脑真是充满了太多的乐趣，后来我转行成为计算机自由顾问，去帮助一些小型公司的 IT 部门把数据迁移到 Linux 服务器上，这让 Windows 系统或多或少的失去一些用武之地。通常情况下我们都是在背地里偷偷地做这些工作的，因为那段时期微软把 Linux 称为毒瘤，诬蔑 Linux 系统是一种共产主义，用来削弱和吞噬我们身体里的珍贵血液的阴谋。</p><h3 id="Linux-赢了"><a href="#Linux-赢了" class="headerlink" title="Linux 赢了"></a>Linux 赢了</h3><p>我持续做了很多年的顾问工作，也做其它一些相关的工作，比如：电脑硬件修理和升级、布线、系统和网络管理，还有运行包括 Apple、Windows、Linux 系统在内的混合网络。Apple 和 Windows 系统故意不兼容对方，因此这两个系统真的是最头疼，也最难整合到同一网络中。但是在 Linux 系统和其它开源软件中最有趣的一件事是总有一些人能够处理这些厂商之间的兼容性问题。</p><p>现在已经大不同了。在系统间的互操作方面一直存在一些兼容性问题，而且也没有桌面 Linux 系统的 1 级 OEM 厂商。我觉得这是因为微软和苹果公司在零售行业在大力垄断造成的。也许他们这样做反而帮了我们帮大忙，因为我们可以从 ZaReason 和 System76 这样独立的 Linux 系统开发商得到更好的服务和更高性能的系统。他们对 Linux 系统都很专业，也特别欢迎我们这样的用户。</p><p>Linux 除了在零售行业的桌面版系统占有一席之地以外，从嵌入式系统到超级计算机以及分布式计算系统等各个方面都占据着主要地位。开源技术掌握着软件行业的发展方向，所有的软件行业的前沿技术，比如容器、集群以及人工智能的发展都离不开开源技术的支持。从我的第一台老式的 386SX 电脑到现在，Linux 和开源技术都取得了巨大的进步。</p><p>如果没有 Linux 系统和开源，这一切都不可能发生。</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CSS变量和预处理变量有什么不同？</title>
      <link href="/difference-between-types-of-css-variables.html"/>
      <url>/difference-between-types-of-css-variables.html</url>
      
        <content type="html"><![CDATA[<h1 id="CSS变量和预处理变量有什么不同？"><a href="#CSS变量和预处理变量有什么不同？" class="headerlink" title="CSS变量和预处理变量有什么不同？"></a>CSS变量和预处理变量有什么不同？</h1><blockquote><p>原文：<a href="https://css-tricks.com/difference-between-types-of-css-variables/" target="_blank" rel="noopener">https://css-tricks.com/difference-between-types-of-css-variables/</a></p></blockquote><p>变量是 <strong>CSS 预处理器</strong> 存在的最主要的原因之一。设置变量的能力是有用的，比如把一个颜色设置成变量，用那个变量贯穿你写的CSS，你会发现它是一致的，抽离的，并且容易修改。你也可以用原生 CSS变量（CSS自定义变量）做同样的事。但是也有一些重要的区别应该搞清楚。</p><h3 id="一个简单的预处理变量的用法像是这样："><a href="#一个简单的预处理变量的用法像是这样：" class="headerlink" title="一个简单的预处理变量的用法像是这样："></a>一个简单的预处理变量的用法像是这样：</h3><pre><code>$brandColor: #F06D06;.main-header {  color: $brandColor;}.main-footer {  background-color: $brandColor;}</code></pre><p>这是使用 <a href="http://sass-lang.com/" target="_blank" rel="noopener">Sass</a> 写的 SCSS 变量，但是所有的 <strong>CSS预处理器</strong> 都提供这种变量的概念：<a href="http://stylus-lang.com/docs/variables.html" target="_blank" rel="noopener">Stylus</a>，<a href="http://lesscss.org/features/" target="_blank" rel="noopener">Less</a>，<a href="https://github.com/postcss/postcss-simple-vars" target="_blank" rel="noopener">PostCSS</a>，等等。</p><p>上面这段代码如果放入浏览器里什么都不会做。因为浏览器不理解这种声明并且忽略它。预处理器需要把它编译成浏览器能够理解的 CSS。这段代码会编译成这样：</p><pre><code>.main-header {  color: #F06D06;}.main-footer {  background-color: #F06D06;}</code></pre><p>它现在是有效的 CSS 了。那个变量是预处理器语言的一个部分，而不是 CSS 本身。一旦编译完成，变量就消失了。</p><p>最近，原生 CSS 开始支持 CSS变量，或者叫做 “CSS自定义属性”。它允许你直接在CSS里使用变量。不需要编译。</p><h3 id="一个简单的自定义-CSS-属性的用法像这样："><a href="#一个简单的自定义-CSS-属性的用法像这样：" class="headerlink" title="一个简单的自定义 CSS 属性的用法像这样："></a>一个简单的自定义 CSS 属性的用法像这样：</h3><pre><code>:root {  --main-color: #F06D06;}.main-header {  color: var(--main-color);}.main-footer {  background-color: var(--main-color);}</code></pre><p>这两个例子达到了完全相同的结果。我们可以定义一个颜色，使用两次。</p><p>那么，问题来了…… 为什么要使用 <strong>原生CSS</strong> 重复造轮子呢？</p><h3 id="为什么你要用原生的-CSS-自定义属性？"><a href="#为什么你要用原生的-CSS-自定义属性？" class="headerlink" title="为什么你要用原生的 CSS 自定义属性？"></a>为什么你要用原生的 CSS 自定义属性？</h3><ul><li>你用这些属性 <strong>不需要一个预处理器</strong>。</li><li><strong>他们是顺序执行的</strong>。 你可以在任何选择器中设置一个变量或覆盖现有变量。</li><li>当它们的值变了 (e.g. 媒体查询或其他状态)， <strong>浏览器会在需要的时候重绘</strong>.</li><li>你可以访问并且 <strong>用 JavaScript 操纵它们</strong>.</li></ul><p>对于顺序执行，这有一个简单的例子：</p><pre><code>:root {  --color: red;}body {  --color: orange;}h2 {  color: var(--color);}</code></pre><p>任何 <code>h2</code> 都会是 orange，因为所有 <code>h2</code> 都是 <code>body</code> 的孩子，而 <code>body</code> 有更高的应用特权。</p><p>你甚至能在媒体查询中重置变量并且把这些变量级联到任何地方去使用，有些事仅用预处理器变量是处理不了的。</p><p>查看 <a href="http://codepen.io/chriscoyier/pen/ORdLvq?editors=0110" target="_blank" rel="noopener">这个例子</a> 当媒体查询改变那些用来设置简单网格的变量：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/difference-between-types-of-css-variables-1.gif" alt></p><p>Rob Dodson 对 CSS自定义属性的见解 <a href="https://developers.google.com/web/updates/2016/02/css-variables-why-should-you-care" target="_blank" rel="noopener">CSS 变量：你为什么要关心？</a></p><blockquote><p>那些 [预处理器] 使用的变量面临一个重要的缺点，那就是它们是静态的，无法在运行时改变。加入可在运行时更改变量的能力，不仅仅为像动态应用主题打开了大门，也对响应式设计和多边形填充的CSS未来潜力具有深远的影响。</p></blockquote><p>他提到 <a href="https://googlechrome.github.io/samples/css-custom-properties/index.html" target="_blank" rel="noopener">一个例子</a> 当 JavaScript 改变样式时。它不直接在元素上改变样式，而仅仅是在<strong>运行时</strong>重置一些变量：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/difference-between-types-of-css-variables-2.gif" alt></p><p>Wes Bos 也有一个关于这个的很好示例：</p><p>看源码 <a href="https://codepen.io/wesbos/pen/adQjoY/" target="_blank" rel="noopener">用 JS 更新 CSS 变量</a> by Wes Bos (<a href="http://codepen.io/wesbos" target="_blank" rel="noopener">@wesbos</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a>.</p><p>注意有一大串我留在这的关于 CSS自定义属性的东西。你可以设置回滚。也可以把它们和 <code>calc()</code> 一起使用。你可以有很多技巧使用它们。看下面的家庭作业部分：</p><h3 id="为什么使用预处理器变量？"><a href="#为什么使用预处理器变量？" class="headerlink" title="为什么使用预处理器变量？"></a>为什么使用预处理器变量？</h3><ul><li>最重要的一点：没有传统浏览器支持的条件。它们被编译成一般CSS。</li><li>其次：你可以用值传递单位，如果你一定要的话。</li></ul><h3 id="你可以一起使用它们"><a href="#你可以一起使用它们" class="headerlink" title="你可以一起使用它们"></a>你可以一起使用它们</h3><p>有很多令人信服的原因去一起使用它们。你绝对可以用一个预处理器生成 CSS自定义属性。Ivan Ivanov 写了一个示例，允许你通过 Sass 写 CSS自定义属性的语法，输出的代码如下：</p><p>查看源代码 <a href="http://codepen.io/vank0/pen/kkGvAb/" target="_blank" rel="noopener">现在就使用 CSS4 变量</a> by $i.van(ov) (<a href="http://codepen.io/vank0" target="_blank" rel="noopener">@vank0</a>) on <a href="http://codepen.io" target="_blank" rel="noopener">CodePen</a>.</p><p>我试图去思考，当我们使用 CSS自定义属性而不用担心浏览器支持时，那我们就用它们去处理所有我们的变量正在处理的事。我们也许还在用预编译器为了其他方便，但是变量处理在原生CSS看起来不错，它可能值得把所有都搬到这个上面来。</p><h3 id="关于CSS自定义属性的浏览器支持"><a href="#关于CSS自定义属性的浏览器支持" class="headerlink" title="关于CSS自定义属性的浏览器支持"></a>关于CSS自定义属性的浏览器支持</h3><p>这个浏览器支持数据事从 <a href="http://caniuse.com/#feat=css-variables" target="_blank" rel="noopener">Caniuse</a>来的，它也报告了这个功能在 W3C 候选推荐位置。</p><h4 id="桌面"><a href="#桌面" class="headerlink" title="桌面"></a>桌面</h4><p>Google Chrome，Mozilla Firefox，Internet Explorer，Opera，Apple Safar i4931No369.1</p><h4 id="手机-平板电脑"><a href="#手机-平板电脑" class="headerlink" title="手机 / 平板电脑"></a>手机 / 平板电脑</h4><p>iOS Safari，Android，Opera Mobile，Android Chrome，Android Firefox 9.353375349</p><h3 id="家庭作业时间-强化"><a href="#家庭作业时间-强化" class="headerlink" title="家庭作业时间: 强化!"></a>家庭作业时间: 强化!</h3><h4 id="1-看-Lea-Verou-的-CSS-变量：-var-–subtitle"><a href="#1-看-Lea-Verou-的-CSS-变量：-var-–subtitle" class="headerlink" title="1) 看 Lea Verou 的 CSS 变量： var(–subtitle);"></a>1) 看 Lea Verou 的 <em>CSS 变量： var(–subtitle);</em></h4><p>她涵盖了大量的实际应用，还有一些技巧例如当变量顺序执行时控制一些陷阱。</p><h4 id="2-看-David-Khourshid-的-CSS-的响应式动画【Reactive-Animations-with-CSS】"><a href="#2-看-David-Khourshid-的-CSS-的响应式动画【Reactive-Animations-with-CSS】" class="headerlink" title="2) 看 David Khourshid 的 CSS 的响应式动画【Reactive Animations with CSS】"></a>2) 看 David Khourshid 的 <em>CSS 的响应式动画【Reactive Animations with CSS】</em></h4><p>David 分享了这个主意用CSS变量去连接 DOM 事件，能够做一些非常牛X的UI，而不用太多代码。查看他的网站 (<a href="http://slides.com/davidkhourshid/reactanim#/26" target="_blank" rel="noopener">从 #26 开始</a>) 那个展示了他是多么牛X。</p><h4 id="3-读-Harry-Roberts-Pragmatic-Practical-and-Progressive-Theming-with-Custom-Properties"><a href="#3-读-Harry-Roberts-Pragmatic-Practical-and-Progressive-Theming-with-Custom-Properties" class="headerlink" title="3) 读 Harry Roberts Pragmatic, Practical, and Progressive Theming with Custom Properties"></a>3) 读 Harry Roberts <em>Pragmatic, Practical, and Progressive Theming with Custom Properties</em></h4><p><a href="http://csswizardry.com/2016/10/pragmatic-practical-progressive-theming-with-custom-properties/" target="_blank" rel="noopener">他的文章</a> 解释怎么用CSS变量让站点的用户自定义主题更容易。</p><h4 id="4-阅读-Roman-Komarov-的-关于-CSS-变量的条件【Conditions-for-CSS-Variables】"><a href="#4-阅读-Roman-Komarov-的-关于-CSS-变量的条件【Conditions-for-CSS-Variables】" class="headerlink" title="4) 阅读 Roman Komarov 的 关于 CSS 变量的条件【Conditions for CSS Variables】"></a>4) 阅读 Roman Komarov 的 <em>关于 CSS 变量的条件【Conditions for CSS Variables】</em></h4><p>尽管它已经被所有人谈论很久了，但却没有逻辑门在CSS中 (e.g. <code>@if (true) { }</code>)。我们用一些东西来伪装成逻辑门，比如 <code>:checked</code>，但是那依赖 DOM。 <a href="http://kizu.ru/en/fun/conditions-for-css-variables/" target="_blank" rel="noopener">Roman 展示了一个技巧</a> 你能够用 <code>0</code> 或 <code>1</code> 在一个变量上，然后通过 <code>calc()</code> 来模拟布尔逻辑。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mi5S Plus折腾记录</title>
      <link href="/mi5s-plus-notes.html"/>
      <url>/mi5s-plus-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="解锁BootLoader"><a href="#解锁BootLoader" class="headerlink" title="解锁BootLoader"></a>解锁BootLoader</h3><p><a href="http://www.miui.com/unlock/" target="_blank" rel="noopener">申请解锁</a>，下载工具链接电脑就行了。就是解锁老是卡在50%，然后就是在，看驱动都安装了，我想应该是windows 10不兼容吧。然后卸载驱动重新安装就行了。</p><h3 id="解锁System分区读写"><a href="#解锁System分区读写" class="headerlink" title="解锁System分区读写"></a>解锁System分区读写</h3><p>mdzz，换个字体，都无法读写，百度下，系统分区有读写保护。解锁操作如下：</p><pre><code>adb devices #查看是否有设备adb rootadb disable-verityadb reboot</code></pre><p>重启好了应该可以对系统分区进行读写了。</p><h3 id="上锁BootLoader"><a href="#上锁BootLoader" class="headerlink" title="上锁BootLoader"></a>上锁BootLoader</h3><p>出问题送售后或者不想折腾的，需要上锁BL，首先手机重启到fastboot模式，输入下面命令即可：</p><pre><code>fastboot oem lock</code></pre><p>重启OK</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>小米5S Plus开箱体验</title>
      <link href="/xiaomi5plus-unpacking-note.html"/>
      <url>/xiaomi5plus-unpacking-note.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>记得14年入了个小米3，除了丑了点，其他还可以吧。时隔几年，如今再次入手小米的产品，希望这几年小米产品有所提高。虽然前几天看过小米Note 2以及MIX发布会，但开售日子对我来说太远以及能不能抢到还是个问题，无奈就入手个小米5S Plus版本。虽然小米5S有大小俩种系列产品，倒是没怎么了解过。</p><p>目前来看，这俩者区别除了RAM+ROM配置不一样以外，其次小米5S配置的CPU残血版的高通骁龙821(最高主频 2.15GHz Adreno 530 图形处理器 624MHz)，而小米5S Plus配置的是高通骁龙满血版821(处理器 最高主频 2.35GHz Adreno 530 图形处理器 653MHz)。</p><p>小米55多出一个按压屏(类似iPhone 6S以上的3D Touch功能，不过在Android算是可有可无，毕竟软件生态惨不忍睹！)</p><p>而小米5S Plus就多出个双摄。拍照这俩者都不好说啊。其他我也不对比了。</p><h3 id="开箱"><a href="#开箱" class="headerlink" title="开箱"></a>开箱</h3><p>27号下单的，却在29号才发货…真是慢，难道没货？拖个俩三天再发货，这背后也不清楚，不过发货的第二天我就收到了。</p><p><img src="https://img.alicdn.com/imgextra/i1/2038135983/TB2314wXKNOdeFjSZFBXXctzXXa_!!2038135983.jpg" alt></p><p>包装还可以吧。</p><p>开箱：</p><p><img src="https://img.alicdn.com/imgextra/i4/2038135983/TB2IuJ1bvOM.eBjSZFqXXculVXa_!!2038135983.png" alt></p><p>盒子比较简洁，也没得好说的，一般般…也不太草率，不像一加3，锤子M1那样有情调。</p><p><img src="https://img.alicdn.com/imgextra/i2/2038135983/TB2ubNVbyGO.eBjSZFpXXb3tFXa_!!2038135983.png" alt></p><p>拿起来手感还不错吧。对了，买的是银色，比较有逼格。</p><p><img src="https://img.alicdn.com/imgextra/i2/2038135983/TB2iup8bvSM.eBjSZFNXXbgYpXa_!!2038135983.png" alt></p><p>就是指纹后置了，用起来可能不习惯吧。</p><p>开机：</p><p><img src="https://img.alicdn.com/imgextra/i4/2038135983/TB2vkx8bwCN.eBjSZFoXXXj0FXa_!!2038135983.png" alt></p><p>系统自然是自家的MIUI(ADUI)。没啥好说的。</p><h3 id="相机"><a href="#相机" class="headerlink" title="相机"></a>相机</h3><p>相机试用了，还可以，给个和iPhone 6S的对比照片：</p><p>iPhone 6S Plus：</p><p><img src="https://img.alicdn.com/imgextra/i1/2038135983/TB2PGp7byKO.eBjSZPhXXXqcpXa_!!2038135983.jpg" alt=" iPhone6S_Plus.jpg"></p><p>小米5S Plus：</p><p><img src="https://img.alicdn.com/imgextra/i3/2038135983/TB2CLN1bvOM.eBjSZFqXXculVXa_!!2038135983.jpg" alt=" XiaoMi5S_Plus.jpg"></p><p>从细节来看，感觉小米配出来的照片有点真实，而且放大看也不失真。还不错吧。</p><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>系统没啥好说的，MIUI毕竟很成熟了，就是广告多了会恶心。指纹就是跑到后置了，每次解锁需要中指去解锁，刚买的并不是很习惯。</p><p>嗯….就这样吧，简单的评测下。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>手把手教你处理下划线</title>
      <link href="/styling-underlines-on-the-web.html"/>
      <url>/styling-underlines-on-the-web.html</url>
      
        <content type="html"><![CDATA[<h1 id="手把手教你处理下划线"><a href="#手把手教你处理下划线" class="headerlink" title="手把手教你处理下划线"></a>手把手教你处理下划线</h1><blockquote><p>原文：<a href="https://css-tricks.com/styling-underlines-web/" target="_blank" rel="noopener">https://css-tricks.com/styling-underlines-web/</a></p></blockquote><p>译者百科： <a href="https://zh.wikipedia.org/wiki/%E9%99%8D%E9%83%A8" target="_blank" rel="noopener">descenders</a>:<strong>降部</strong>(不明白的看wiki百科)</p><p><strong>设计链接的下划线可能是一件棘手的事，我总是忘记在什么情况下用什么方法。 然而谢天谢地, <a href="https://twitter.com/johndjameson" target="_blank" rel="noopener">John Jameson</a> 让我们在这篇博客中加快了处理这个问题的速度.</strong></p><p>有许多不同的方法让你设计下划线。也许你还记得这篇文章<a href="https://medium.com/design/7c03a9274f9" target="_blank" rel="noopener">在medium制作下划线</a>。Medium并不打算做任何<a href="http://tympanus.net/Development/InlineAnchorStyles/" target="_blank" rel="noopener">crazy</a>的事；他们只想在他们的文本中创造一个正常的下划线。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/styling-underlines-on-the-web-1.png" alt="A thin, black underline with space around descenders"></p><p>在降部周围有一个细黑有间距的下划线——来自Marcin Wichary, <a href="https://medium.com/design/7c03a9274f9" target="_blank" rel="noopener">Medium上精心制作的链接下划线</a></p><p>这是一个十分基础的下划线，但是这是一个很好的尺寸，并且他跳过了降部。很明显比任何浏览器默认的都要好。然而问题来了，为了要实现这个样式，Medium需要处理许多问题。两年过去了，这依然是一个很难实现的好看的下划线。</p><h3 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h3><p>只用<code>text-decoration: underline</code>有什么问题吗？如果我们讨论的是理想情况，一个下划线需要做以下的事：</p><ul><li>将此定位在基准线之下</li><li>跳过降部</li><li>改变颜色，厚度和样式</li><li>支持文字换行</li><li>在任何背景下都能实现</li></ul><p>我认为这些是十分合理的要求，但是据我所知，在CSS中没有直接的方法可以达到上述所有的要求。</p><h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><p>那么，在web上到底有多少可以实现文本下划线的方法？</p><p>下面是我能想到的：</p><ul><li><code>text-decoration</code></li><li><code>border-bottom</code></li><li><code>box-shadow</code></li><li><code>background-image</code></li><li>SVG filters</li><li>Underline.js (canvas)</li><li><code>text-decoration-*</code></li></ul><p>让我们一个个来看看，讨论讨论每个方法的好处和不足之处。</p><h4 id="text-decoration"><a href="#text-decoration" class="headerlink" title="text-decoration"></a>text-decoration</h4><p><code>text-decoration</code>是实现文本下划线最直接的方法。你只需要提供一个属性然后就好了。非常小，看上去也不错，但是增加了字体大小，而且在同一行开始的下划线让人觉得很笨拙。</p><p>看这个<a href="http://codepen.io/johndjameson/pen/QEzLAJ" target="_blank" rel="noopener">demo</a>.</p><p><code>text-decoration</code>最大的问题就是缺少可定制性。他们使用文本的颜色和字体大小，而且都没有跨浏览器的方法可以改变样式。之后再讲这些。</p><h5 id="好处"><a href="#好处" class="headerlink" title="好处"></a>好处</h5><ul><li><strong>很好用</strong></li><li>定位在基线以下</li><li>在Safari和iOS中默认略过降部</li><li>支持换行</li><li>在任何背景下都能使用</li></ul><h5 id="坏处"><a href="#坏处" class="headerlink" title="坏处"></a>坏处</h5><ul><li>_不能_在其他浏览器略过降部</li><li>_不能_改变颜色，厚度或者样式</li></ul><h4 id="border-bottom"><a href="#border-bottom" class="headerlink" title="border-bottom"></a>border-bottom</h4><p><code>border-bottom</code>提供了一个在_快速_和<em>自定义</em>中的平衡的解决方案. 这个方法用的是可靠的css border,也就是说你可以轻易地改变颜色，厚度和样式。</p><p>这就是为什么<code>border-bottom</code>看上去像<code>inline</code>元素:</p><p>看这个<a href="http://codepen.io/johndjameson/pen/VKPZEZ" target="_blank" rel="noopener">demo</a></p><p>最大的疑难杂症是下划线离文本的距离——这完全_低于_降部。你可以通过将元素变成<code>inline-block</code>并且减少 <code>line-height</code>来解决问题。但是你没有办法支持换行。对于一行来说是好的解决方案，但是对于多行不起作用。</p><p>看这个<a href="http://codepen.io/johndjameson/pen/kkgPAz" target="_blank" rel="noopener">demo</a>.</p><p>此外，你可以用<code>text-shadow</code>来遮盖部分降部的线，但是需要用和背景色相同的颜色。这意味着这只在固有色的背景下才能生效，因此不支持渐变或者图片背景。</p><p>看这个<a href="http://codepen.io/johndjameson/pen/kkgPAz" target="_blank" rel="noopener">demo</a>.</p><p>在这一点上，一个下滑线上有4个参数。这比<code>text-decoration</code>要多出大量工作。</p><h5 id="好处-1"><a href="#好处-1" class="headerlink" title="好处"></a>好处</h5><ul><li>跳过下行文字可以用<code>text-shadow</code></li><li><strong>可以改变颜色，厚度和样式</strong></li><li><strong>可以在颜色和厚度上做动画</strong></li><li>除非是<code>inline-block</code>，不然默认换行</li><li>在任何背景都可以用，除非是<code>text-shadow</code></li></ul><h5 id="坏处-1"><a href="#坏处-1" class="headerlink" title="坏处"></a>坏处</h5><ul><li>定位有点远而且很难复位</li><li>为了让他 <em>刚刚好</em>，需要用很多不相关额属性</li><li>Janky 当使用<code>text-shadow</code>时候文本选择</li></ul><h4 id="box-shadow"><a href="#box-shadow" class="headerlink" title="box-shadow"></a>box-shadow</h4><p><code>box-shadow</code>通过两个内部盒子之间阴影描绘了下划线: 先创建一个一个长方形，然后第二长方形改在第一个长方形上面. 也就是说你需要一个純色背景色才能生效。</p><p>看例子 <a href="http://codepen.io/johndjameson/pen/NAokqB" target="_blank" rel="noopener">demo</a>.</p><p>你可以用同样的<code>text-shadow</code>技巧来假装下划线和降部之间的距离。但是如果下划线是和文本不同的颜色——或者够细——这就不会像<code>text-decoration</code>一样冲突。</p><h5 id="好处-2"><a href="#好处-2" class="headerlink" title="好处"></a>好处</h5><ul><li>可以在基线之下定位</li><li>可以用<code>text-shadow</code>来跳过降部</li><li>可以改变颜色和厚度</li><li>支持多行</li></ul><h5 id="坏处-2"><a href="#坏处-2" class="headerlink" title="坏处"></a>坏处</h5><ul><li>不能改变样式</li><li>不能在任何背景下成功</li></ul><h4 id="背景图"><a href="#背景图" class="headerlink" title="背景图"></a>背景图</h4><p><code>background-image</code> 可以实现所有我们设想的功能，而且问题最少。你可以用<code>linear-gradient</code>和<code>background-position</code>创建一个图片然后在水平方向上重复。</p><p>这个方法也需要你设置<code>display: inline;</code>。</p><p>看个例子 <a href="http://codepen.io/johndjameson/pen/NAkgQY" target="_blank" rel="noopener">demo</a>.</p><p>这个方法不需要使用<code>linear-gradient</code>。你可以用你自己的图片做一些很酷的效果。</p><p>看个例子 <a href="http://codepen.io/johndjameson/pen/zKAKQP" target="_blank" rel="noopener">demo</a>.</p><h5 id="Good"><a href="#Good" class="headerlink" title="Good"></a>Good</h5><h5 id="好处-3"><a href="#好处-3" class="headerlink" title="好处"></a>好处</h5><ul><li>可以定位在基线以下</li><li>使用<code>text-shadow</code>跳过降部</li><li><strong>可以改变颜色厚度（允许一半的px值，如2.5px）, 和样式</strong></li><li>自定义的图像可生效</li><li><strong>支持换行</strong></li><li>如果使用 <code>text-shadow</code>，就不能让任何背景都生效</li></ul><h5 id="坏处-3"><a href="#坏处-3" class="headerlink" title="坏处"></a>坏处</h5><ul><li>图像可能会因分辨率，浏览器和缩小程度而变形。</li></ul><h4 id="SVG-filters"><a href="#SVG-filters" class="headerlink" title="SVG filters"></a>SVG filters</h4><p>这里有一个我玩过的方法：SVG滤镜。你可以创建一个内联SVG<code>filter</code>（滤镜）元素，画一条线，然后扩展文本遮住我们希望是透明的地方。然后你可以给<code>filter</code>一个<code>id</code>，然后再CSS中引用它，就像这样<code>filter: url(‘#svg-underline’)</code>。</p><p>这个的好处就是滤镜加了透明，而不用依赖于<code>text-shadow</code>。这就意味这你可以跳过任何背景的降部，包括渐变和背景图片。但是这个只在单行文本有效，因此先不看他。</p><p>看个例子<a href="http://codepen.io/johndjameson/pen/JXZrqy" target="_blank" rel="noopener">demo</a>.</p><p>这是他在Chrome和Firefox中的效果图：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/styling-underlines-on-the-web-2.png" alt></p><p>再IE，edge和safari的浏览器支持是很有问题的。很难在CSS中测试SVG滤镜的支持。你可以用<code>@supports</code>和<code>filter</code>，但是之只能测试_引用_有效，不能测试应用滤镜。我的方法就在这里结束了。因此先不看他。</p><h5 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h5><ul><li>定位在基线以下</li><li>跳过下行文字</li><li>能挨边颜色，厚度和样式</li><li><strong>任何背景都ok</strong></li></ul><h5 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h5><ul><li>不支持多行</li><li>不能再IE，Edg或者safari中运行，但是你可以返回去用<code>text-decoration</code>。safari的下划线还是很好用的。</li></ul><h4 id="Underline-js-Canvas"><a href="#Underline-js-Canvas" class="headerlink" title="Underline.js (Canvas)"></a>Underline.js (Canvas)</h4><p>Underline.js很赞。我认为它最令影响深刻的是Wenting Zhang用js做的一些对于细节的关注。如果你之前还不了解Underline.js <a href="http://underlinejs.org/" target="_blank" rel="noopener">tech demo</a>。立刻停下看此文，快去查看一下把。在<a href="http://embed.wirewax.com/8013554/7bafa8/" target="_blank" rel="noopener">how it works</a>上有很赞的9分钟的演讲，但是我给你一个短版本：他用<code>&lt;canvas&gt;</code>绘制下划线。这是一个出奇有效的新方法。</p><p>除了朗朗上口的名称，Underline.js仅仅是个<strong>技术演示</strong>。也就是说你不能将此应用到任何项目中，除非你先修改一大堆东西。</p><p>在这里提出这个作为一个概念证明十分值。<code>&lt;canvas&gt;</code>有潜力创造出有好看又可以交互的下划线，但是你需要写一些原生的js来使之生效。</p><h4 id="text-decoration-properties"><a href="#text-decoration-properties" class="headerlink" title="text-decoration-* properties"></a>text-decoration-* properties</h4><p>还记得我说过“待会再说”的部分吗？很好，现在我就要开始说了。</p><p><code>text-decoration</code>自身运行很好，但是你可以添加一些实验性的属性来定制它：</p><ul><li><code>text-decoration-color</code></li><li><code>text-decoration-skip</code></li><li><code>text-decoration-style</code></li></ul><p>不要太激动了，<strong>浏览器支持</strong>，你懂的！</p><h5 id="text-decoration-color"><a href="#text-decoration-color" class="headerlink" title="text-decoration-color"></a>text-decoration-color</h5><p><code>text-decoration-color</code> 让你可以改变下划线的颜色，以和文字颜色做区分。这个属性还没达到预期的浏览器支持——它只能用在Firefox和加了前缀之后地safari。这里有截图：如果你要清除下行文字，safari把线放在文字顶部。🙃 Firefox: <img src="https://res.i95.me/wp-content/uploads/2016/10/styling-underlines-on-the-web-3.png" alt> Safari: <img src="https://res.i95.me/wp-content/uploads/2016/10/styling-underlines-on-the-web-4.png" alt></p><h5 id="text-decoration-skip"><a href="#text-decoration-skip" class="headerlink" title="text-decoration-skip"></a>text-decoration-skip</h5><p><code>text-decoration-skip</code>在下划线文字中切换跳过降部。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/styling-underlines-on-the-web-5.png" alt></p><p>这个属性不是标准地，因此只在safari中有效，因此你需要用<code>-webkit-</code>前缀来用它。safari默认使这个属性，这就是为什么下划线跳过下行文字甚至在网站上不指明他。</p><p>如果你在用Normalize，那你应该知道最新版本<em>disable</em>这个属性让样式在浏览器之间保持一致。如果你想要这些希望地下划线，你需要设定回来。</p><h5 id="text-decoration-style"><a href="#text-decoration-style" class="headerlink" title="text-decoration-style"></a>text-decoration-style</h5><p><code>text-decoration-style</code>提供了和<code>border-style</code>一样的线的类型，但是添加了<code>wavy</code>（波浪）线。</p><p>这里有你可以设置的不同的值</p><ul><li><code>dashed</code></li><li><code>dotted</code></li><li><code>double</code></li><li><code>solid</code></li><li><code>wavy</code></li></ul><p>然而，<code>text-decoration-style</code> 只在火狐中有效，这里是截图：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/styling-underlines-on-the-web-6.png" alt></p><p>各式各样的纯色下划线风格</p><p>看上去很眼熟？</p><h5 id="少了什么？"><a href="#少了什么？" class="headerlink" title="少了什么？"></a>少了什么？</h5><p><code>text-decoration-*</code>属性远远比其他css属性装饰下划线更加直观。但是看看我们早期需求，这些属性不能提供一个方案，让我们定制线的的厚度和位置。</p><p>在做了一些研究之后，我遇到了这两个属性</p><ul><li><code>text-underline-width</code></li><li><code>text-underline-position</code></li></ul><p>这看上去是在早期的css草案中提及的，但是因为缺乏兴趣而没有被实现。啊~大家不要打我！</p><h3 id="带走"><a href="#带走" class="headerlink" title="带走"></a>带走</h3><p>因此，最好实现下划线的方法是什么？</p><p><a href="https://codepen.io/rachsmith/details/YweZbG/" target="_blank" rel="noopener">看情况</a></p><p>对于小字，我推荐使用<code>text-decoration</code>然后在头部使用<code>text-decoration-skip</code>。在所有的浏览器中个，这看上去有些乏味，但是下划线永远是那样，而且人们并不介意。外加如果你够耐心，总是会有机会的，所有的下划线都会看上去很赞，而不需要你去改变什么。</p><p>对于正文，你可能需要<code>background-image</code>这个方法。它有效而且看上去棒呆了，同时也有Sass的<a href="https://codepen.io/jimmynotjim/pen/EabQjV" target="_blank" rel="noopener">mixins</a>对它支持。如果你的下划线很细或者颜色和文本不一样，你可以忽略<code>text-shadow</code> 这个方法。</p><p>对于单行文字来说，使用<code>border-bottom</code>和其他的你想使用的属性。</p><p>对于想要在渐变或者图片背景之上跳过降部，试着用SVG滤镜。或者避免使用下划线。</p><p>在未来，当浏览器支持变好了，那么答案将是<code>text-decoration-*</code>解决一切问题。</p><hr>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>纯CSS过滤内容</title>
      <link href="/pure-css-content-filter-web.html"/>
      <url>/pure-css-content-filter-web.html</url>
      
        <content type="html"><![CDATA[<h1 id="纯CSS过滤内容"><a href="#纯CSS过滤内容" class="headerlink" title="纯CSS过滤内容"></a>纯CSS过滤内容</h1><p><strong>提示：</strong></p><ul><li>边看<a href="http://www.sassmeister.com/gist/04045234e626aede7d0064ae202f81c4" target="_blank" rel="noopener">demo</a>边食用，效果更佳</li><li>科普一下伪元素<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/:target" target="_blank" rel="noopener">：target</a></li></ul><p>仅仅通过CSS过滤内容，这是一个非常有趣且有吸引力的方法。 （译者注：作者在这里是说，他在半夜两点的时候喝了酒，然后突然想做个实践，就是纯CSS过滤内容）</p><p>通过CSS的<code>:target</code>的伪选择器，用户点击导航之后，我们可以过滤出所需内容。通过用相邻的兄弟选择器，我们可以定义DOM后续部分的样式。</p><p>来看看一个例子<a href="http://www.sassmeister.com/gist/04045234e626aede7d0064ae202f81c4" target="_blank" rel="noopener">demo</a>.</p><h2 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h2><p>我们从简单地定义需要过滤内容开始，<code>.c-filter</code>。所有的元素都会放在<code>section</code>这个节点中。</p><pre><code>&lt;section class=&quot;c-filter&quot;&gt;  ...&lt;/section&gt;</code></pre><p>接着，我们罗列出过滤目标。每个过滤主题都有一个目标，并且每个元素上都加上了相同的class，并且配有一个和主题相关的特殊ID。这些ID是<code>:target</code>选择器之后会查找的：这些是准备工作整个技术的核心框架。</p><p>他们都是被定义为（空）锚元素<code>&lt;a&gt;</code>，因为他们就是他们的样子：用来链接的锚。</p><pre><code>&lt;a class=&quot;c-filter__target&quot; id=&quot;tag:css&quot;&gt;&lt;/a&gt;&lt;a class=&quot;c-filter__target&quot; id=&quot;tag:html&quot;&gt;&lt;/a&gt;&lt;a class=&quot;c-filter__target&quot; id=&quot;tag:accessibility&quot;&gt;&lt;/a&gt;&lt;a class=&quot;c-filter__target&quot; id=&quot;tag:performance&quot;&gt;&lt;/a&gt;&lt;a class=&quot;c-filter__target&quot; id=&quot;tag:vim&quot;&gt;&lt;/a&gt;</code></pre><p>这之后，我们过滤用户会点击的链接：</p><pre><code>&lt;nav class=&quot;c-filter__links&quot;&gt;  &lt;a href=&quot;#tag:all&quot; class=&quot;c-filter__link  c-filter__link--reset&quot;&gt;Reset&lt;/a&gt;  &lt;a href=&quot;#tag:html&quot; class=&quot;c-filter__link&quot;&gt;HTML&lt;/a&gt;  &lt;a href=&quot;#tag:css&quot; class=&quot;c-filter__link&quot;&gt;CSS&lt;/a&gt;  &lt;a href=&quot;#tag:accessibility&quot; class=&quot;c-filter__link&quot;&gt;Accessibility&lt;/a&gt;  &lt;a href=&quot;#tag:performance&quot; class=&quot;c-filter__link&quot;&gt;Performance&lt;/a&gt;  &lt;a href=&quot;#tag:vim&quot; class=&quot;c-filter__link&quot;&gt;Vim&lt;/a&gt;&lt;/nav&gt;</code></pre><p>每一个链接都有一个相同的class，并且<code>href</code>指向各自的锚。当一个用户点击其中一个链接，我们的<code>:target</code>选择器会截获信息并作出相应行为。</p><p>下面，我们想要过滤的内容。在这个例子中，这些项目是博客文章。</p><pre><code>&lt;article class=&quot;c-article c-filter__item&quot; data-tag=&quot;vim&quot;&gt;  &lt;h2&gt;Using Macros&lt;/h2&gt;  &lt;p&gt;Pellentesque habitant morbi tristique senectus et netus et malesuada  fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies  eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper.  Aenean ultricies mi vitae est. Mauris placerat eleifend leo.&lt;/p&gt;&lt;/article&gt;</code></pre><p><code>article</code>元素有十分值得一提的元素。首先，他们都有<code>c-article</code>这个class，这和过滤分离没有关系的class：这个class只是为articles写样式的并且不用于过滤。</p><p>其次， 他们都有<code>c-filter__item</code>这个class：这只是简单的布了下局，并不是真正的过滤。</p><p>最后我们看到<code>data-tags</code>这个属性，这个是包含了一个或多个与过滤内容相关的标签。这些数据属性对过滤来说是必要的存在，因为我们需要通过这些值来确定哪些是用展现给户。</p><p>流程就像下面这样：</p><ol><li>页面加载显示全部项目。</li><li>用户点击一个过滤的链接，这个链接跳至相对应的<code>#tags:*</code>锚的这里，同时在url后面加上这个id。</li><li>我们会抓住所有的用 <code>:target</code>为元素的片段标识符。</li><li>我们会用这个知识点来显示/隐藏相关内容。</li></ol><h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><p>主要工作都在CSS。第一部分并没有令人兴奋的点。只是一个加点样式然后布局元素。</p><pre><code>/** * 1\. Clearfix our filter context. */.c-filter {  overflow: hidden; /* [1] */}  .c-filter__links {    padding: 1em;    margin-bottom: 1em;    background-color: #fff;    border-bottom: 1px solid #e5e5e5;  }    .c-filter__link {      display: inline-block;      padding: 0.5em 1em;      border-radius: 100px;      background-color: rgba(0, 0, 0, 0);      transition: 0.333s;    }    .c-filter__link--reset {      border-right: 1px solid;      border-radius: 0;    }  .c-filter__item {    float: left;    width: calc(33.333333333% - 1em);    margin-right: 0.5em;    margin-bottom: 1em;    margin-left: 0.5em;    transition: 0.333s;  }</code></pre><p>现在，事情变得有些有趣了：</p><pre><code>.c-filter__target:not(:target) ~ .c-filter__item {  opacity: 1;}</code></pre><p>这个选择器做了一些事情。让我们来分析分析他：</p><ul><li><code>.c-filter__target</code>指向我们所有空元素<code>a</code>。</li><li><code>:not(:target)</code>检查没有锚（<code>&lt;a&gt;</code>）当前是被指定的。</li><li><code>~</code>是相邻的兄弟选择器，并且这是寻找DOM之后出现的东西，但是却是在DOM树中相同层级的元素。</li><li><code>.c-filter__item</code>只是寻找我们所有可过滤的元素。</li></ul><p>因此基本上，如果我们当前没有指定任何锚，在DOM之后的节点寻找过滤的项目并且确保他们都是可见的。</p><p>‘可见’在这里的就是 <code>opacity: 1;</code>。这里也可以是其他的（e.g. 在我的第一版，这里这实际上从 <code>display: block;</code>开始）。</p><p>接下来的一些CSS看上去有些相似：</p><pre><code>.c-filter__target:target ~ .c-filter__item {  opacity: 0.25;}</code></pre><p>我们在做和之前几乎一样的查找，这次我们只是少了<code>:not()</code>选择器。这就意味着我们在检查哪些锚是被指向的，如果是这样的，隐藏我们所有的过滤项目 (<code>opacity: 0.25;</code>)。</p><p>因此这里有两件事：如果没有锚被指向，显示所有的；如果有任意的锚被指向，隐藏所有的。</p><p>当我们把所有都隐藏之后，我们想打开指定的项目。我们需要多做一些事，因为我们在寻找特定的DOM节点：我们不能用一个通用的规则。</p><p>在这里我需要用Sass帮我完成，就像这样：</p><pre><code>@each $tag in html, css, accessibility, performance, vim {  [id=&quot;tag:#{$tag}&quot;]:target ~ [data-tag~=&quot;#{$tag}&quot;] {    opacity: 1;  }  ...}</code></pre><p>这里，遍历每一个标签，并且遍历所有像下面这样的选择器：</p><pre><code>`[id=&quot;tag:css&quot;]:target ~ [data-tag~=&quot;css&quot;] { ... }`</code></pre><p>在这里发生了什么？</p><ul><li><code>[id=&quot;tag:css&quot;]:target</code>检查id和<code>tag:css</code>完全相同的锚是否被指定。**N.B.**我不能将此选择器写成<code>#tag\:css:target</code>，有两个我不能这么做的原因：首先，正如你所见我们要避开那个冒号。其次，我们在CSS中用ID。将此作为属性选择器写意味着我不需要放任何的其他特定CSS hook在hmtl中个，并且额外的好处是用class的特殊性来选择id。</li><li><code>~</code>就像之前那样，是选择当前DOM之后的节点并且是DOM树上同一层级上的某一元素。</li><li><code>[data-tag~=&quot;css&quot;]</code>是之后的元素，和DOM树在同一层级上的，<code>~</code>正在寻找的元素。我现在要做的就是用子选择器来找出<code>data-tags</code>这个属性的内容。<code>~=</code>明确地表示了这个属性包含了一系列空格隔开的值，然后那些值和 <code>css</code>（在那种情况下）是一样的。</li></ul><p>因此如果我们瞄准了一个<code>css</code>锚，请找所有在DOM树之后出现的标记了<code>css</code>的元素。一旦找了到，就将他们展示出来：</p><pre><code>`opacity: 1;`</code></pre><p>这就是对于过滤工作必要的事情——实际上是代码的一小部分。</p><h3 id="突出当前过滤的链接"><a href="#突出当前过滤的链接" class="headerlink" title="突出当前过滤的链接"></a>突出当前过滤的链接</h3><p>我认为有一个极佳的尝试，就是给当前过滤的链接加一个样式，因此用户可以看到那些内容他们想看的。这比我预期的要复杂一些，但是并不是不可解决的。</p><p>在同样的Sass循环之前，我生成了一套新的选择器，看上去像这样：</p><pre><code>`[id=&quot;tag:css&quot;]:target ~ .c-filter__links [href=&quot;#tag:css&quot;] { ... }`</code></pre><p>一步步通过吧：</p><ul><li><code>[id=&quot;tag:css&quot;]:target</code>严查了css锚当前是否被选中。</li><li><code>~</code>查看当前DOM后续的元素.</li><li><code>.c-filter__links</code>就是我们在寻找的东西。</li><li><code>[href=&quot;#tag:css&quot;]</code> 正在寻找<code>href</code>的值和<code>#tag:css</code>相同的元素。</li></ul><p>在这里我发现一件很有趣的事情就是获取链接。因为他们都在<code>nav</code>元素(<code>.c-filter__links</code>)之中——因此不是在DOM树的统一层次中。根据<code>~</code>选择器要求那样——我不能直接通过<code>~</code>选择器指定他们。因为这悲伤的事实，我几乎放弃了高亮练习，但是之后我发现了解决方案。</p><p>不同于指向连接自己，我可以指定他们的<code>nav</code>元素因为它在DOM树中统一层级的。接下来的步奏就是寻找正确连接。这就是为什么我要嵌套最后一个选择器。</p><h3 id="尴尬的页面跳转"><a href="#尴尬的页面跳转" class="headerlink" title="尴尬的页面跳转"></a>尴尬的页面跳转</h3><p>还有一个我不费吹灰之力解决的问题。因为我们要链接到片段标识，页面如果很长需要滚动，那么跳转的时候就会很可怕。解决方案是就是固定一页（也就是不要滚动）。</p><p>因为我们要链接到空的锚元素，他们完全不会在页面上显示（但是他们确实在DOM中存在，这就是为什么我们让页面跳转）。通过简单的的 <code>position: fixed;</code>给所有的锚元素，他们会在页面左上角定位。实际的结果是锚会在用户滚动到的地方，因此页面并不会真的跳到其他地方。</p><pre><code>.c-filter__target {  position: fixed;}</code></pre><p>问题解决啦~</p><h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><p>这个技术中有一些缺点。没有特定的顺序：</p><ul><li>添加新的标签意味着编写和重新编译新的CSS。我们可通过CMS将一个“样式”块注入到页面中，并且重复我们的标签，以此来绕过。因此这不完全是世界末日。</li><li>过滤新增的历史状态。通过过滤器点击按钮10几次可能会让你变得非常恼火。 然而，这确实意味着我们可以直接链接到过滤之后的结果。</li><li>可获得性。说真的，我不确定这对可获得性是好消息还是坏消息。不过毫无疑问的是我们可以做一些提升。至少它不是用<code>checkbox</code>的hack，对吧？</li><li>我能完全这么做吗？我感觉css做了js的事情。</li><li>讨厌的CSS，嵌套的选择器，子选择器，严重依赖位置。这不是最好的，不是吗？</li></ul><p>自从我像这样玩转CSS，已经过了很长时间了。并且依然很有意思。我需要确认我要经常像这样做事。</p><hr>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSS中的响应式图片</title>
      <link href="/responsive-images-in-css-web.html"/>
      <url>/responsive-images-in-css-web.html</url>
      
        <content type="html"><![CDATA[<h1 id="CSS中的响应式图片"><a href="#CSS中的响应式图片" class="headerlink" title="CSS中的响应式图片"></a>CSS中的响应式图片</h1><p>“响应式图片”这个术语的意思是“在html中的响应式图片”，换句话说，<code>srcset</code>和<code>sizes</code>属性是适用于<code>&lt;img&gt;</code>和<code>&lt;picture&gt;</code>元素的。但是这些html属性该如何映射在CSS中？</p><p>过去几年，CSS一般不真正地参与响应式图片之旅的。这有个很好的理由：CSS早已经有关于此的工具。响应式图片只是赶上了CSS已经能做的事。让我们来看看吧。</p><h3 id="CSS中的srcset"><a href="#CSS中的srcset" class="headerlink" title="CSS中的srcset"></a>CSS中的<code>srcset</code></h3><p>在HTML中，<code>srcset</code>就像这个（来源于Picturefill网站）：</p><pre><code>&lt;img srcset=&quot;  examples/images/image-384.jpg 1x,   examples/images/image-768.jpg 2x&quot; alt=&quot;…&quot;&gt;</code></pre><p>一张为像素比为1x的视图准备的图片,一张为像素比为2x的视图准备的较大图片。如果我们想要在CSS中做相同的事情，只有<code>background-image</code>属性可以实现：</p><pre><code>.img {  background-image: url(examples/images/image-384.jpg); }@media   (-webkit-min-device-pixel-ratio: 2),   (min-resolution: 192dpi) {   .img {    background-image: url(examples/images/image-768.jpg);  }}</code></pre><p>虽然这里与html有些不同。按照我的理解，从<code>srcset</code>变成标准的样子来看，这更像一种建议。属性和属性值提供了关于那个是可获得的以及浏览器决定哪一个在这个时候是最好的。或者说，至少，这能够决定，如果浏览器选择用这个方式实现。声明应该伴随着<code>@media</code>的查询条件。</p><p>分辨率的媒体查询器的支持是相当好的：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/responsive-images-in-css-web-1.png" alt></p><p>分辨率的媒体查询器的<a href="http://caniuse.com/#feat=css-media-resolution" target="_blank" rel="noopener">浏览器支持</a></p><hr><p>还有一个很好的方法，这很接近于<code>srcset</code>运行方式，并且它在CSS中用<code>image-set()</code>这个方法：</p><pre><code>.img {  background-image: url(examples/images/image-384.jpg);  background-image:    -webkit-image-set(      &quot;examples/images/image-384.jpg&quot; 1x,      &quot;examples/images/image-768.jpg&quot; 2x,    );  background-image:     image-set(      &quot;examples/images/image-384.jpg&quot; 1x,      &quot;examples/images/image-768.jpg&quot; 2x,    );}</code></pre><p>但是这个方法的浏览器支持不如分辨率查询：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/responsive-images-in-css-web-2.png" alt> image-set()的<a href="http://caniuse.com/#feat=css-image-set" target="_blank" rel="noopener">浏览器支持</a></p><p>这个更加贴近<code>srcset</code>这个属性，不仅仅因为语法的相似，更加是因为这允许浏览器有发言权。根据<a href="https://drafts.csswg.org/css-images-3/#image-set-notation" target="_blank" rel="noopener">细则（还处于草稿阶段）</a>:</p><blockquote><p>image-set()这个方法允许作者忽略其他的问题，只要提供多分辨率的图片并且让UA决定当前情况下哪一个最合适。</p></blockquote><p>在CSS中没有完全1：1的<code>srcset</code>的代替属性，但是这个相当接近了。</p><h3 id="CSS中的sizes"><a href="#CSS中的sizes" class="headerlink" title="CSS中的sizes"></a>CSS中的<code>sizes</code></h3><p>在HTML中的<code>sizes</code>属性直接关联CSS中的属性。事实上，它主要是：<strong>“这就是我想在CSS中处理图片大小的方式，我只是让你现在知道了，因为你可能需要这个信息并且迫不及待想下载一试”</strong></p><p>例子：</p><pre><code>&lt;img  sizes=&quot;(min-width: 40em) 80vw, 100vw&quot;  srcset=&quot; ... &quot;  alt=&quot;…&quot;&gt;</code></pre><p>假设在CSS中看上去是这样的：</p><pre><code>img {  width: 100%;}@media (min-width: 40em) {  /* Probably some parent element that limits the img width */  main {    width: 80%;  }}</code></pre><p>但是单独的<code>sizes</code>并没有什么用。你需要和<code>srcset</code>配合使用，它提供了已知的宽度，因此浏览器可以做出选择。让我们假定有一对图片像这样：</p><pre><code>&lt;img  sizes=&quot;(min-width: 400px) 80vw, 100vw&quot;  srcset=&quot;examples/images/small.jpg 375w,          examples/images/big.jpg 1500w&quot;  alt=&quot;…&quot;&gt;</code></pre><p>通过标记上的信息，浏览器可以找出最适合他的图片。因为浏览器知道 1）自己的视图尺寸 2）自己的像素密度</p><p>假定浏览器视图是320px的宽，并且像素密度是1x、同时也知道图片的尺寸将会设置为100vw。那么这个时候，他就需要在提供的两张图片中挑一张。这需要做一些算数。</p><p>375 (图#1尺寸) / 320 (显示图片的像素) = 1.17 1500 (图#2尺寸) / 320 (显示图片的像素) = 4.69</p><p>1.17 is closer to 1 (it’s a 1x display), so the 375w image wins. It’ll try to not go under, so 1.3 would beat 0.99, as far as I understand it. 1.17离1比较近（这是像素比为1的显示）。因此375宽的图片赢了。根据我了解的，这不会向下尝试，因此1.3完败0.99,。</p><p>现在有一个像素比为2的显示。这加倍了图片所需的像素数量，因此算数是这样的：</p><p>375 / 640 = 0.59 1500 / 640 = 2.34</p><p>2.34 wins here, and it’ll show the 1500w image. How about a 1x display with a 1200px viewport? 2.34赢了，那么这里就会显示1500vw的图片。那么像素比为1和1200px的视图怎么办呢？</p><p>375 / (80% of 1200) = 0.39 1500 / (80% of 1200) = 1.56</p><p>1500px宽的图片在此胜利。</p><p>在这里写的CSS有些怪异以及狡猾的。如果我们认为是像素比为1的显示，以几点来结束我们的逻辑：</p><ul><li>Over 468px, use the 1500w image.</li><li>如果视频小于375px, 用375宽的图</li><li>如果视图大于375px，小于400px，用1500w的图片（不然我们需要拉伸图片）</li><li>在400px的时候，图片需要80Vw的宽度，因此（在400px和468px之间）用375宽的图片是很安全的</li><li>大于468px,用宽度为1500w的图片</li></ul><p>我们可以向下面这么写：</p><pre><code>img {  background-image: url(small.jpg);}/* Only override this if one of the conditions for the 1500w image is met */@media   (min-width: 375px) and (max-width: 400px),  (min-width: 468px) {  main {    background-image: url(large.jpg);  }}</code></pre><p>在这个确切的情况下，一个2倍的显示，以及在像300px这种真的很窄的而宽度下，依然需要600px的图片以确保是1 .0的最小质量, 因此我们需要添加如下逻辑：</p><pre><code>.img {  background-image: url(small.jpg);}/* Only override this if one of the conditions for the 1500w image is met */@media   (min-width: 375px) and (max-width: 400px),  (min-width: 468px),  (-webkit-min-device-pixel-ratio: 2),   (min-resolution: 192dpi) {  .img {    background-image: url(large.jpg);  }}</code></pre><p>这个复杂度让断点（尺寸）和需要提供的图片的数量猛涨。然而这依然不是在html中响应式图片可以做的一个完美匹配，因为这不允许浏览器自由判断（例子：浏览器需要考虑其他的潜在因素[比如带宽]再选择图片）。</p><h3 id="CSS中的picture"><a href="#CSS中的picture" class="headerlink" title="CSS中的picture"></a>CSS中的<code>picture</code></h3><p>一个例子：</p><pre><code>&lt;picture&gt;  &lt;source srcset=&quot;extralarge.jpg&quot; media=&quot;(min-width: 1000px)&quot;&gt;  &lt;source srcset=&quot;large.jpg&quot; media=&quot;(min-width: 800px)&quot;&gt;  &lt;img srcset=&quot;medium.jpg&quot; alt=&quot;…&quot;&gt;&lt;/picture&gt;</code></pre><p>这算是媒体查询器相当直接的转换。确切的媒体查询器再这里可以拷贝：</p><pre><code>.img {  background-image: url(medium.jpg);}@media (min-width: 800px) {  .img {    background-image: url(large.jpg);  }}@media (min-width: 1000px) {  .img {    background-image: url(extralarge.jpg);  }}</code></pre><p>不要惊吓，这个可以更复杂，因为<code>srcset</code>可以做和<code>picture</code>元素相同的事情：</p><pre><code>&lt;picture&gt;  &lt;source srcset=&quot;large.jpg, extralarge.jpg 2x&quot; media=&quot;(min-width: 800px)&quot;&gt;  &lt;img srcset=&quot;small.jpg, medium.jpg 2x&quot; alt=&quot;…&quot;&gt;&lt;/picture&gt;</code></pre><p>可以翻译成：</p><pre><code>.img {  background-image: url(small.jpg);}@media  (-webkit-min-device-pixel-ratio: 2),   (min-resolution: 192dpi) {  .img {    background-image: url(medium.jpg);  }}@media  (min-width: 800px) {  .img {    background-image: url(large.jpg);  }}@media  (-webkit-min-device-pixel-ratio: 2) and (min-width: 800px),   (min-resolution: 192dpi) and (min-width: 800px) {  .img {    background-image: url(extralarge.jpg);  }}</code></pre><p>此外，在你添加一些图片和条件的时候，这只是在等复杂度的极速上升。只比<code>image-set()</code>好一丢丢：</p><pre><code>.img {  background-image: url(small.jpg);  background-image:    -webkit-image-set(      &quot;small.jpg&quot; 1x,      &quot;medium.jpg&quot; 2x,    );  background-image:    image-set(      &quot;small.jpg&quot; 1x,      &quot;medium.jpg&quot; 2x,    );}@media  (min-width: 800px) {  .img {    background-image: url(large.jpg);    background-image:      -webkit-image-set(        &quot;large.jpg&quot; 1x,        &quot;extralarge.jpg&quot; 2x,      );    background-image:      image-set(        &quot;large.jpg&quot; 1x,        &quot;extralarge.jpg&quot; 2x,      );  }}</code></pre><h3 id="mixins有帮助吗"><a href="#mixins有帮助吗" class="headerlink" title="mixins有帮助吗?"></a>mixins有帮助吗?</h3><p>可能吧？我很想看到Sass的<code>@mixin</code>支持所有的参数，同时把图片大小计算在内（通过磁盘来算出大小），以及吐出一些高品质的CSS响应的图片代码。也许甚至有一种方法可以合成分辨率查询和 <code>image-set()</code>的语法。</p><h3 id="我们真的在这么做吗"><a href="#我们真的在这么做吗" class="headerlink" title="我们真的在这么做吗?"></a>我们真的在这么做吗?</h3><p>我很好奇有多少人真的在CSS中处理响应式图片。也许取中间值，只在大的断点，换一张大的图片。我再想，也许因为 picture/srcset通常是自动的，因此事实上比CSS中响应式的图片拥有更高的接受率。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS 10 Safari 视频播放新政策</title>
      <link href="/new-video-policies-for-ios10.html"/>
      <url>/new-video-policies-for-ios10.html</url>
      
        <content type="html"><![CDATA[<h1 id="iOS-10-Safari-视频播放新政策"><a href="#iOS-10-Safari-视频播放新政策" class="headerlink" title="iOS 10 Safari 视频播放新政策"></a>iOS 10 Safari 视频播放新政策</h1><p>随着 iOS 10 的正式发布，Safari 也迎来了大量更新，例如新增了对 ES6、CSP2.0、Shadow DOM 等功能和特性的支持。本文为大家介绍 iOS10 自带 Safari 浏览器在视频播放政策上的最新变化。首先划出重点：1）iOS 10 Safari 支持特定视频自动播放；2）iOS 10 Safari 支持视频内联播放。想了解更多细节的同学请接着往下看。</p><h3 id="之前的政策？"><a href="#之前的政策？" class="headerlink" title="之前的政策？"></a>之前的政策？</h3><p>在 iPhoneOS 3（没错，当时 iOS 还不叫 iOS）Safari 开始支持 <code>&lt;video&gt;</code> 标签时，苹果人为设置了很多限制，例如视频无法自动播放 —— 甚至连 Meta 信息预加载都被禁用。显然，这是为了避免给用户造成高额流量费用而作出的妥协，顺便还能节省用户手机电量。</p><p>随着视频的普及，在 iOS 8 中，苹果放宽了对 Safari 视频播放的限制：允许使用 <code>preload=&quot;metadata&quot;</code> 来预加载视频 Meta 信息。但仅此而已，Safari 中的 <code>&lt;video&gt;</code> 元素仍然无法自动播放，也无法内联播放 —— 这意味着视频只能在用户主动操作后才能播放，且播放时必须全屏。</p><p>至于「用户主动操作」具体指的是哪些行为，苹果官方有详细的说明：</p><ul><li>点击视频播放按钮；</li><li>触发 <code>touchend</code>、<code>click</code>、<code>doubleclick</code> 或 <code>keydown</code> 事件，且在事件处理函数中直接调用 <code>video.play()</code> 方法。显然，<code>button.addEventListener(&#39;click&#39;, () =&gt; { video.play(); })</code> 满足要求；而 <code>video.addEventListener(&#39;canplaythrough&#39;, () =&gt; { video.play(); })</code> 不满足要求；</li></ul><p>值得注意的是，上面讨论的是 iOS 自带 Safari 的视频播放政策。对于 iOS APP 而言，开发者在给 webview 设置 <code>mediaPlaybackRequiresUserAction</code> 和 <code>allowsInlineMediaPlayback</code> 属性之后，页面中的 <code>&lt;video&gt;</code> 标签就可以通过 <code>autoplay</code> 和 <code>webkit-playsinline</code> 属性来启用自动播放和内联播放功能。</p><h3 id="iOS-10-新政策"><a href="#iOS-10-新政策" class="headerlink" title="iOS 10 新政策"></a>iOS 10 新政策</h3><p>随着视频的进一步普及，在 iOS 10 中，苹果终于进一步放松了 Safari 视频播放政策。</p><h4 id="自动播放"><a href="#自动播放" class="headerlink" title="自动播放"></a>自动播放</h4><p>iOS 10 Safari 允许自动播放以下两种视频：</p><ul><li>无音轨视频；</li><li>无声音视频（设置了 <code>muted</code> 属性）；</li></ul><p>对于这两种类型的视频，可以通过 <code>&lt;video autoplay&gt;</code> 或 <code>video.play()</code> 两种方式来自动播放，无需用户主动操作。但是，如果它们在播放时变得有声音（获取了音轨，或者 <code>muted</code> 属性被取消），Safari 会暂停播放。</p><p>通过 <code>&lt;video autoplay&gt;</code> 自动播放的视频元素还需要满足一个条件：在可视区域内。同样，如果它们在播放时因为页面滚动等原因导致不可见，Safari 也会暂停播放。</p><p>通过 <code>video.play()</code> 自动播放的视频元素无需可见。<code>video.play()</code> 返回的是 <code>Promise</code>，如果不满足自动播放条件，会触发 <code>reject</code> 行为。</p><h4 id="内联播放"><a href="#内联播放" class="headerlink" title="内联播放"></a>内联播放</h4><p>在 iOS 10 Safari 中，通过 <code>&lt;video playsinline&gt;</code> 可以让视频内联播放。设置了 <code>playsinline</code> 属性的视频在播放时不会自动全屏，但用户可以点击全屏按钮来手动全屏；没有设置 <code>playsinline</code> 的视频会在播放时自动全屏。无论是否设置 <code>playsinline</code> 属性，退出全屏后视频都会继续播放。</p><p><code>playsinline</code> 属性在 iOS 10 之前需要写成 <code>webkit-playsinline</code>，它的浏览器厂商前缀在 iOS 10 中被移除。但是目前 iOS 微信还不支持去掉前缀的写法，两个属性最好都加上。</p><p>显然，<code>&lt;video autoplay&gt;</code> 必须和 <code>playsinline</code> 属性一起使用。也就是说，只有默认内联播放的视频才有可能自动播放，这一点很容易理解。</p><h3 id="一些典型应用"><a href="#一些典型应用" class="headerlink" title="一些典型应用"></a>一些典型应用</h3><p>根据苹果公司的文章：GIF 相比 H.264 编码的视频，带宽占用为十二倍，电池消耗为两倍。没有声音的 <code>&lt;video&gt;</code> 元素很适合用作网页背景，取代 GIF：</p><pre><code>&lt;video autoplay loop muted playsinline&gt;    &lt;source src=&quot;image.mp4&quot;&gt;    &lt;source src=&quot;image.webm&quot; onerror=&quot;fallback(parentNode)&quot;&gt;    &lt;img src=&quot;image.gif&quot;&gt;&lt;/video&gt;&lt;script&gt;function fallback(video) {    var img = video.querySelector(&apos;img&apos;);    if (img) {        video.parentNode.replaceChild(img, video);    }}&lt;/script&gt;</code></pre><p>这段代码使用 <code>&lt;video&gt;</code> 来替代 GIF 动画，并考虑了降级。但在 iOS 10- Safari 中，由于视频无法自动并内联播放，体验很差。要解决这个问题，可以使用 CSS 的 Media Queries：</p><pre><code>&lt;style&gt;#either-gif-or-video video { display: none; }@media (-webkit-video-playable-inline) {    #either-gif-or-video img { display: none; }    #either-gif-or-video video { display: initial; }}&lt;/style&gt;&lt;div id=&quot;either-gif-or-video&quot;&gt;  &lt;video src=&quot;image.mp4&quot; autoplay loop muted playsinline&gt;&lt;/video&gt;  &lt;img src=&quot;image.gif&quot;&gt;&lt;/div&gt;</code></pre><p>由于没有声音的 <code>&lt;video&gt;</code> 元素可以通过调用 <code>video.play()</code> 来自动播放，并且 <code>&lt;video&gt;</code> 元素不需要插入到 DOM 中，我们还可以使用 <code>&lt;canvas&gt;</code> 来做为视频播放的容器，这样就可以方便地修改视频画面了。示意代码如下：</p><pre><code>var video;var canvas;function startPlayback() {    if (!video) {        video = document.createElement(&apos;video&apos;);        video.src = &apos;image.mp4&apos;;        video.loop = true;        video.addEventListener(&apos;playing&apos;, paintVideo);    }    video.play();}function paintVideo() {    if (!canvas) {        canvas = document.createElement(&apos;canvas&apos;);        canvas.width = video.videoWidth;        canvas.height = video.videoHeight;        document.body.appendChild(canvas);    }    canvas.getContext(&apos;2d&apos;).drawImage(video, 0, 0, canvas.width, canvas.height);    if (!video.paused) {        requestAnimationFrame(paintVideo);    }}startPlayback();</code></pre><p>本文主要内容来自于 Webkit 官方博客：<a href="https://webkit.org/blog/6784/new-video-policies-for-ios/" target="_blank" rel="noopener">New Policies for iOS</a>。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>何时该使用继承，何时该使用混合？</title>
      <link href="/when-to-use-extend-when-to-use-a-mixin.html"/>
      <url>/when-to-use-extend-when-to-use-a-mixin.html</url>
      
        <content type="html"><![CDATA[<h1 id="何时该使用-extend，何时该使用mixin"><a href="#何时该使用-extend，何时该使用mixin" class="headerlink" title="何时该使用 @extend，何时该使用mixin"></a>何时该使用 @extend，何时该使用mixin</h1><p>这是一个我曾被问到过许多次的问题：在什么时候我们应该使用mixin(混合)，而在什么时候我们应该使用@extend（继承）呢？</p><p>有一个老的经验法则告诉我们，不带参数的mixins（混合）是糟糕的——因为这样形式的mixin只是重复的代码跟直接复用的实例一样是肮脏的。可是事实上， 答案远没有这么简单，有许多的细节需要审视（译者注：原文是nuanced，微妙。这里水平有限所以没有采用该词汇。您只需知道：这其中有许多的微妙之处）。</p><p>现在，让我们一起看一看其中的微妙之处.</p><h3 id="何时使用继承-extend"><a href="#何时使用继承-extend" class="headerlink" title="何时使用继承 @extend"></a>何时使用继承 <code>@extend</code></h3><p>这里让我先说一句：我通常建议一点也不要使用继承开始 <code>@extend</code> 。这里有一个 <a href="http://oliverjash.me/2012/09/07/methods-for-modifying-objects-in-oocss.html" target="_blank" rel="noopener">Fool’s Gold</a>（傻瓜黄金定律）:一个特性的允诺就必然携带着两倍多的警告（译者注：我理解的是一个强大的功能就必然携带着两倍多的弊端，或者一倍收益，两倍风险。）。</p><p>如果你肯定, 确确实实要使用继承 <code>@extend</code>:</p><ol><li>请再三考虑.</li><li>使用<a href="http://csswizardry.com/2014/01/extending-silent-classes-in-sass/" target="_blank" rel="noopener">placeholder hack</a>.</li><li>时刻关注你输出的css文件.</li></ol><p>理论上, <code>@extend</code> 是很棒的方法, 然而, 事实证明, 有许多使用出现了错误。我曾见过一个输出样式表是原文件大小的两倍多;我也曾见过一份源程序输出文件变得混论不堪; 并且我还曾看见过一个编译后的样式的群组选择器有4095个选择器。最好总是宁可谨慎并且省略任何会造成很多麻烦但是收益却很少或者甚至没有的功能或者工具。由于滥用生产工具让你的碎片样式享有有低于4096选择器组是十分违反直觉的。</p><p>**N.B.**我觉得我需要补充说一下这并不是我本身就讨厌 <code>@extend</code> ;但如果你要使用它，一定要时刻保持警惕，因为有很多地方需要注意。</p><p>但是，如果你要使用 <code>@extend</code>，何时适合呢？</p><p>理解 <strong><code>@extend</code>创建的关系</strong>就很重要了。无论何时你使用<code>@extend</code>,移植一个选择器就会在在其他地方为了与其他选择器共享特征也因此被移植了。结果，你导致这些选择器全部共享了一个关系，并滥用<code>@extend</code>创建关系制定了错误的标准。 这就像分组CD收集的颜色封面一样：可行，但是并不是创建的一个有益的关系。</p><p><strong>你正在形成的这种关系是一个正确的特征是至关重要的。</strong></p><p>很频繁的——在过去，我自己也犯过——我看到的许多东西像这样(让我想一下<code>...</code>表示一个遗漏，简单的说，第100行，(译者注：即输出文件的21行）):</p><pre><code>%brand-font {    font-family: webfont, sans-serif;    font-weight: 700;}...h1 {    @extend %brand-font;    font-size: 2em;}....btn {    @extend %brand-font;    display: inline-block;    padding: 1em;}....promo {    @extend %brand-font;    background-color: #BADA55;    color: #fff;}....footer-message {    @extend %brand-font;    font-size: 0.75em;}</code></pre><p>当然，该输出文件为这样：</p><pre><code>h1, .btn, .promo, .footer-message {    font-family: webfont, sans-serif;    font-weight: 700;}...h1 {    font-size: 2em;}....btn {    display: inline-block;    padding: 1em;}....promo {    background-color: #BADA55;    color: #fff;}....footer-message {    font-size: 0.75em;}</code></pre><p>问题是我强迫了一个存在于几百行开外的没有丝毫关联的规则和当前规则因为共享特征建立了一个纯粹是巧合的联系。并且这不仅强迫生成了一个反常的关系，还使得生成的CSS选择器的顺序特异性变得乱七八糟。我竟然因为纯粹的间接关系分散了我的代码库的选择器。这并不是一个<a href="http://csswizardry.com/2014/10/the-specificity-graph/" target="_blank" rel="noopener">好消息</a>.</p><p>在基于纯粹的巧合和间接地相似之处的情况下，继承使得我为了和其他规则集共存在一个不正确的位置，移植了一个不相关的规则集到远离它们来源几百行开外的地方。<strong>使用<code>@extend</code>并不是一个好方法.</strong> (实际上,使用一个带有少量参数的mixin可能是一个完美的用例，我们很快会讲到这个话题。)</p><p>另一个滥用<code>继承</code>的情况看起来有点像这样：</p><pre><code>%bold {    font-weight: bold;}....header--home &gt; .header__tagline {    @extend %bold;    color: #333;    font-style: italic;}....btn--warning {    @extend %bold;    background-color: red;    color: white;}....alert--error &gt; .alert__text {    @extend %bold;    color: red;}</code></pre><p>如你所愿，它将输出下面的css代码：</p><pre><code>.header--home &gt; .header__tagline,.btn--warning,.alert--error &gt; .alert__text {    font-weight: bold;}....header--home &gt; .header__tagline {    color: #333;    font-style: italic;}....btn--warning {    background-color: red;    color: white;}....alert--error &gt; .alert__text {    color: red;}</code></pre><p>该文件有299个字节大小。</p><p><strong>通常情况下, 你移植的选择器可能会比你试图避免重复的声名还要长。</strong></p><p>如果我们真的只是重复<code>font-weight: bold</code>规则;声明多次——而不是试图避免重复它——结果我们确实获得了一个比较小的css文件：<strong>264 个字节</strong>。这仅仅是规模非常小的模型，但是这有助于说明收益递减的可能性。继承的单一声明往往是适得其反的。</p><p>所以，何时我们使用继承呢？</p><p>我们应该使用继承在明确相关的规则集中共享特性，一个完美的用例如下：</p><pre><code>.btn,%btn {    display: inline-block;    padding: 1em;}.btn-positive {    @extend %btn;    background-color: green;    color: white;}.btn-negative {    @extend %btn;    background-color: red;    color: white;}.btn-neutral {    @extend %btn;    background-color: lightgray;    color: black;}</code></pre><p>Which results in:</p><pre><code>.btn,.btn-positive,.btn-negative,.btn-neutral {    display: inline-block;    padding: 1em;}.btn-positive {    background-color: green;    color: white;}.btn-negative {    background-color: red;    color: white;}.btn-neutral {    background-color: lightgray;    color: black;}</code></pre><p>这是一个完美的继承用例。这些规则本质上是相关的;他们共享的特征是由于一个理由共享的，而不是偶然性的。进一步的说,我们不会再移植这些选择器到远离其来源上百行开外的地方去了，所以我们的 <a href="http://csswizardry.com/2014/10/the-specificity-graph/" target="_blank" rel="noopener">特异性图</a>能够保持漂亮和条理性.</p><h3 id="何时该使用混合mixin"><a href="#何时该使用混合mixin" class="headerlink" title="何时该使用混合mixin"></a>何时该使用混合mixin</h3><p>不带参数的混合是糟糕的规则这条古老的经验法则是善意的，但不幸的是这远没有那么简单。</p><p>这条规则源于对 DRY（译者注：DRY是“Don’t Repeat Yourself”的缩写）原则一点轻微的误解。DRY原则旨在一个项目只有一个真正的单一来源。DRY与不重复<strong>自身</strong>相关，但是并不是完全避免重复。</p><p>如果你在一个项目中手动键入一个声明50次，你是重复的：这不是DRY。 如果你生成50次声明不用手动键入，这就是DRY：你在生成重复而不是重复自身。这是一个相当微妙但重要的区别. <strong>在编译系统的重复不是一件坏事，在文件资源（来源）方面的重复才是一件坏事。</strong></p><p>这条单一的真理意味着我们可以存储一个重复结构的资源回收再利用而不是实际上去复制它。当然，一个系统可能会重复给我们，但是它的资源只存在一次。这意味着我们只需改变资源一次，其他利用到该资源的地方就会随着改变；而在我们的源代码中不会有重复的结构；只会有一个实际的单一来源。这就是当我们谈到DRY时的意思。</p><p>有了这一理解，我们就能开始意识到不带参数的mixin实际上是有用的了。现在让我们回到之前<code>%brand-font {}</code>的例子</p><p>让我们想象一下，我们使用一个特定的字体在我们的项目，必须始终在旁边定义一个字体特定的 <code>font-weight</code>:</p><pre><code>.foo {    font-family: webfont, sans-serif;    font-weight: 700;}....bar {    font-family: webfont, sans-serif;    font-weight: 700;}....baz {    font-family: webfont, sans-serif;    font-weight: 700;}</code></pre><p>像这样，在我们的代码中一遍又一遍的手动重复这两个声明是十分乏味的；我们不得不记住字体粗细这个700的数字而不是自己更熟悉的<code>regular</code>或者<code>bold</code>；并且如果我们要改变web的字体和粗细程度，我们不得不浏览整个项目更改所有地方的web字体和字体粗细程度。</p><p>我们前面不应该在这里使用<code>@extend</code>强行关联，我们也许应该使用的是一个mixin：</p><pre><code>@mixin webfont() {    font-family: webfont, sans-serif;    font-weight: 700;}....foo {    @include webfont();}....bar {    @include webfont();}....baz {    @include webfont();}</code></pre><p><strong>是的,这会编译出重复的部分。不，我们不是在重复自己。</strong> 要记住这些无关的规则集是十分重要的，所以我们不应该去使他们相关。要记住这些无关重要的规则，所以我们不应该让他们相关的。他们是无关的，只是<em>happen</em>有一些共同特征，所以这种重复是明智的，而且是可以预期的。我们<em>want</em>在N的地方使用这些声明，所以我们让他们出现在n处。It is important to remember here that these are unrelated rulesets, so we did not ought to make them related. They are unrelated and just <em>happen</em> to have some shared traits, so this repetition is sensible, and is to be expected. We <em>want</em> to use those declarations in n places, so we make them appear in n places.</p><p>Argument-less mixins are great for just spitting out repeated groups of identical declarations whilst maintaining a Single Source of Truth. See it like a Sassy extension of your copy/paste clipboard: you’re just using it to paste out a few strings you’ve stored elsewhere earlier on. We have our Single Source of Truth, which means we can propagate changes to these declarations whilst only ever making one manual change. Very DRY.</p><p>它也可能是值得注意的，有利于重复，gzip，将几乎完全否定的轻微的成本增加文件大小It is also probably worth noting that Gzip favours repetition, so that will almost entirely negate the costs of the slight added filesize.</p><p>当然，mixin是真的有用当我们使用带参数的mixin时，它会在重复的代码结构中动态的生成值。我不认为任何人都可以说它是一个坏的主意：他们不会重复自身但是允许我们修改这些重复结构的单一来源从而像坐飞机一样改变所有引用该结构的地方。例如：</p><pre><code>@mixin truncate($width: 100%) {    width: $width;    max-width: 100%;    display: block;    overflow: hidden;    white-space: nowrap;    text-overflow: ellipsis;}.foo {    @include truncate(100px);}</code></pre><p>吐出相同的声明，但根据实际案例动态地设置了“宽度”的值。</p><p>这是最常见的和广泛认同的形式的混合，我想我们都同意这是一个好主意。</p><h3 id="tl-dr"><a href="#tl-dr" class="headerlink" title="tl;dr"></a>tl;dr</h3><p>当你试图使用DRY原则的规则集是本质上和主题相关时仅仅使用<code>@extend</code>。不要强迫不存在的关系，这样做会在你的项目中创造出不寻常的分组，同时也会给你的源代码造成负面影响。</p><p>使用mixin要么注入动态值代入重复的结构中（译者注：此处指的是带参数的mixin），要么如时髦的复制/粘贴般（译者注：指不带参数的mixin）在你的整个项目中重复一组声明同时保持只有一个<a href="http://en.wikipedia.org/wiki/Single_Source_of_Truth" target="_blank" rel="noopener">来源</a>（译者注：此处可以解释为只有一个引用来源引用）.</p><h4 id="tl-dr-tl-dr"><a href="#tl-dr-tl-dr" class="headerlink" title="tl;dr;tl;dr"></a>tl;dr;tl;dr</h4><p>与本身相关的规则集是使用 <code>@extend</code>的理由；相同的构造结构仅仅是使用<code>mixin</code>的缘由。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux日常使用总结</title>
      <link href="/linux-daily-use-summary.html"/>
      <url>/linux-daily-use-summary.html</url>
      
        <content type="html"><![CDATA[<h3 id="1．设置获取root权限"><a href="#1．设置获取root权限" class="headerlink" title="1．设置获取root权限"></a>1．设置获取root权限</h3><pre><code>sudo passwd root //设置root密码</code></pre><p>然后输入当前系统账户的密码并设置新的UNIX密码，密码更新成功后在终端输入<code>su</code>然后输入刚刚设置好的新的UNIX密码，即可进入root权限，如果想退出，输入<code>exit</code>。</p><h3 id="２．在linux下如何安装sha-dow-socks"><a href="#２．在linux下如何安装sha-dow-socks" class="headerlink" title="２．在linux下如何安装sha#dow#socks"></a>２．在linux下如何安装sha#dow#socks</h3><p>因为自己是搞开发的，而且非常喜欢谷歌，所以就需要一个自由的网络环境，博主用的是sha#dow#socks，在windows下，有客户端，但是现在装了linux，既然装了linux，能用命令行搞定的就尽量用命令行，所以我选择在终端安装sha#dow#socks客户端，步骤如下：</p><h4 id="安装sha-dow-socks客户端"><a href="#安装sha-dow-socks客户端" class="headerlink" title="安装sha#dow#socks客户端"></a>安装sha#dow#socks客户端</h4><pre><code>sudo apt-get updatesudo apt-get install python-gevent python-pippip install sha#dow#socks</code></pre><h4 id="建立配置文件"><a href="#建立配置文件" class="headerlink" title="建立配置文件"></a>建立配置文件</h4><p>打开终端，运行<code>vim /etc/ss.json</code>，然后写入json</p><pre><code> {&quot;server&quot; : &quot;you server&quot;,&quot;server_port&quot; : 0000,&quot;local_address&quot; : &quot;127.0.0.1&quot;,&quot;local_port&quot; : 1080,&quot;password&quot; : &quot;you password&quot;,&quot;method&quot; : &quot;aes-256-cfb&quot;, //sha#dow#socks的加密方式&quot;fast_open&quot; : false}</code></pre><h4 id="开启sha-dow-socks"><a href="#开启sha-dow-socks" class="headerlink" title="开启sha#dow#socks"></a>开启sha#dow#socks</h4><pre><code>sslocal -c /etc/ss.json// 开启后显示以下内容，代表开启成功：// INFO loading libcrypto from libcrypto.so.1.0.0// INFO starting local at 127.0.0.1:1080</code></pre><h4 id="设置开机启动"><a href="#设置开机启动" class="headerlink" title="设置开机启动"></a>设置开机启动</h4><pre><code>// 打开图形化开机启动项管理界面gnome-session-properties// 添加(Add) -&gt; 名称(name)和描述(comment)随便填，命令(Command)填写如下： sslocal -c /etc/ss.json</code></pre><h4 id="火狐浏览器配置"><a href="#火狐浏览器配置" class="headerlink" title="火狐浏览器配置"></a>火狐浏览器配置</h4><p>设置→首选项→高级→网络→链接→设置→手动配置代理→socks主机：127.0.0.1 端口：1080→确定</p><h4 id="chrome配置"><a href="#chrome配置" class="headerlink" title="chrome配置"></a>chrome配置</h4><p>在终端中输入如下命令：</p><pre><code>chromium-browser --proxy-server=socks5://127.0.0.1:1080</code></pre><p>进入后安装SwitchyOmega，然后配置此插件： 情景模式→删除原有的情景模式，新建情景模式（原有的情景模式无socks代理）→手动配置→SOCKS代理：127.0.0.1 端口1080→保存 →ok</p><h3 id="３．安装相应的软件"><a href="#３．安装相应的软件" class="headerlink" title="３．安装相应的软件"></a>３．安装相应的软件</h3><h4 id="安装Gdebi软件包安装程序"><a href="#安装Gdebi软件包安装程序" class="headerlink" title="安装Gdebi软件包安装程序"></a>安装Gdebi软件包安装程序</h4><p>在ubuntu中有自己的软件中心，但是有些软件在里面找不到，需要自己去官网下载客户端然后安装（比如网易云音乐，搜狗拼音等），下载好的安装包大部分都是<code>.deb</code>文件，查阅了需要资料，安装这个用<code>gdebi</code>比较方便，在软件中心搜索<code>Gdebi软件包安装程序</code>安装就好，但是，既然用linux了，就用一下它强大的终端，所以我说一下在终端如何安装 在终端输入</p><pre><code>sudo apt-get install gdebi</code></pre><p>但是我在这里输入后，提示我缺少相应的依赖，并让我运行</p><pre><code>sudo apt-get install -f</code></pre><p>运行完成这个命令后，相应的依赖就被安装好了，这里的这个命令主要是修复依赖关系（depends）的命令，之后重新运行<code>sudo apt-get install gdebi</code>即可。</p><h4 id="安装对应的软件"><a href="#安装对应的软件" class="headerlink" title="安装对应的软件"></a>安装对应的软件</h4><p>在安装完成这个后，安装软件就方便很多，我比如安装chrome浏览器，直接进入下载好文件的目录，运行</p><pre><code>sudo gdebi chrome.deb //这里是你要安装包的名字</code></pre><p>完成后去搜索即可。在安装时候我发现有的软件在安装完成后需要重启下电脑才会有。</p><h4 id="卸载apt-get安装的东西"><a href="#卸载apt-get安装的东西" class="headerlink" title="卸载apt-get安装的东西"></a>卸载apt-get安装的东西</h4><p>有时候需要卸载一些<code>apt-get</code>(从15.10版本支持<code>apt</code>)安装的东西，需要命令为</p><pre><code>sudo apt-get remove XXX //XXX为要卸载的东西</code></pre><h4 id="安装node"><a href="#安装node" class="headerlink" title="安装node"></a>安装node</h4><p>做前端开发，node是必不可少的，所以需要安装一下，在windows下都是直接下载安装包安装，我本来也在linux下下了个安装包安装了，但是查了一下发现用nvm安装node的比较多，而且那天在公司老大也说在mac下推荐使用nvm安装，所以自己决定试下。</p><h5 id="1-安装-nvm-之后最好先删除下已安装的-node-和全局-node-模块："><a href="#1-安装-nvm-之后最好先删除下已安装的-node-和全局-node-模块：" class="headerlink" title="1.安装 nvm 之后最好先删除下已安装的 node 和全局 node 模块："></a>1.安装 nvm 之后最好先删除下已安装的 node 和全局 node 模块：</h5><pre><code>npm ls -g --depth=0 //查看已经安装在全局的模块，以便删除这些全局模块后再按照不同的 node 版本重新进行全局安装sudo rm -rf /usr/local/lib/node_modules //删除全局 node_modules 目录sudo rm /usr/local/bin/node //删除 nodecd /usr/local/bin &amp;&amp; ls -l | grep &quot;../lib/node_modules/&quot; | awk &apos;{print $9}&apos;| xargs rm //删除全局 node 模块注册的软链</code></pre><h5 id="2-安装nvm"><a href="#2-安装nvm" class="headerlink" title="2.安装nvm"></a>2.安装<a href="https://github.com/creationix/nvm" target="_blank" rel="noopener">nvm</a></h5><p>运行以下两条命令之一</p><pre><code> | curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.32.0/install.sh | bash//orwget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.32.0/install.sh | bash</code></pre><p>然后进入(~/.bash_profile, ~/.zshrc, ~/.profile, or ~/.bashrc)这些文件，看哪个文件有，在最后一行添加.</p><pre><code>export NVM_DIR=&quot;$HOME/.nvm&quot;[ -s &quot;$NVM_DIR/nvm.sh&quot; ] &amp;&amp; . &quot;$NVM_DIR/nvm.sh&quot; # This loads nvm</code></pre><p>这里如果不太会改这个的话，可以设置终端从而达到效果，在终端打开<code>编辑→配置文件首选项→命令</code>中勾选<code>以登录shell方式运行命令</code>。在ubuntu中没有<code>执行命令时更新登录登录记录</code>，如果有，一起勾选，然后在终端输入</p><pre><code>nvm</code></pre><p>即可看到帮助，之后运行</p><pre><code>nvm install node</code></pre><p>就可以安装到最新版本的node，更多关于nvm的用法可参考<a href="https://segmentfault.com/a/1190000004404505" target="_blank" rel="noopener">node版本管理工具nvm-Mac下安装及使用</a> 至此，linux下常用的软件就安装完成…</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java面试知识点总结</title>
      <link href="/java-interview-questions.html"/>
      <url>/java-interview-questions.html</url>
      
        <content type="html"><![CDATA[<p><strong>1. Java中的原始数据类型都有哪些，它们的大小及对应的封装类是什么？</strong></p><ul><li><strong>boolean</strong> boolean数据类型非true即false。这个数据类型表示1 bit，但是它的大小并没有精确定义。 《Java虚拟机规范》中如是说：“虽然定义了boolean这种数据类型，但是只对它提供了非常有限的支持。在Java虚拟机中没有任何供boolean值专用的字节码指令，Java语言表达式所操作的boolean值，在编译之后都使用Java虚拟机中的int数据类型来代替，而boolean数组将会被编码成Java虚拟机的byte数组，每个元素boolean元素占8位”。这样我们可以得出**boolean类型单独使用是4个字节，在数组中又是1个字节。**那虚拟机为什么要用int来代替boolean呢？为什么不用byte或short，这样不是更节省内存空间吗？实际上，使用int的原因是，对于当下32位的CPU来说，一次进行32位的数据交换更加高效。 综上，我们可以知道：官方文档对boolean类型没有给出精确的定义，《Java虚拟机规范》给出了“单独时使用4个字节，boolean数组时1个字节”的定义，具体还要看虚拟机实现是否按照规范来，所以1个字节、4个字节都是有可能的。这其实是一种时空权衡。 boolean类型的封装类是Boolean。</li><li>byte——1 byte——Byte</li><li>short——2 bytes——Short</li><li>int——4 bytes——Integer</li><li>long——8 bytes——Long</li><li>float——4 bytes——Float</li><li>double——8 bytes——Double</li><li>char——2 bytes——Character</li></ul><p><strong>2. 谈一谈”==“与”equals()”的区别。</strong> 《Think in Java》中说：“关系操作符生成的是一个boolean结果，它们计算的是操作数的值之间的关系”。 “”判断的是两个对象的内存地址是否一样，适用于原始数据类型和枚举类型（它们的变量存储的是值本身，而引用类型变量存储的是引用）；equals是Object类的方法，Object对它的实现是比较内存地址，我们可以重写这个方法来自定义“相等”这个概念。比如类库中的String、Date等类就对这个方法进行了重写。 综上，对于枚举类型和原始数据类型的相等性比较，应该使用””；对于引用类型的相等性比较，应该使用equals方法。</p><p><strong>3. Java中的四种引用及其应用场景是什么？</strong></p><ul><li>强引用: 通常我们使用new操作符创建一个对象时所返回的引用即为强引用</li><li>软引用: 若一个对象只能通过软引用到达，那么这个对象在内存不足时会被回收，可用于图片缓存中，内存不足时系统会自动回收不再使用的Bitmap</li><li>弱引用: 若一个对象只能通过弱引用到达，那么它就会被回收（即使内存充足），同样可用于图片缓存中，这时候只要Bitmap不再使用就会被回收</li><li>虚引用: 虚引用是Java中最“弱”的引用，通过它甚至无法获取被引用的对象，它存在的唯一作用就是当它指向的对象回收时，它本身会被加入到引用队列中，这样我们可以知道它指向的对象何时被销毁。</li></ul><p><strong>4. object中定义了哪些方法？</strong> clone(), equals(), hashCode(), toString(), notify(), notifyAll(), wait(), finalize(), getClass()</p><p><strong>5. hashCode的作用是什么？</strong> 请参见<a href="http://www.jianshu.com/p/01028590ada2" target="_blank" rel="noopener">散列表的基本原理与实现</a></p><p><strong>6. ArrayList, LinkedList, Vector的区别是什么？</strong></p><ul><li>ArrayList: 内部采用数组存储元素，支持高效随机访问，支持动态调整大小</li><li>LinkedList: 内部采用链表来存储元素，支持快速插入/删除元素，但不支持高效地随机访问</li><li>Vector: 可以看作线程安全版的ArrayList</li></ul><p><strong>7. String, StringBuilder, StringBuffer的区别是什么？</strong></p><ul><li>String: 不可变的字符序列，若要向其中添加新字符需要创建一个新的String对象</li><li>StringBuilder: 可变字符序列，支持向其中添加新字符（无需创建新对象）</li><li>StringBuffer: 可以看作线程安全版的StringBuilder</li></ul><p><strong>8. Map, Set, List, Queue、Stack的特点及用法。</strong></p><ul><li>Map&lt;K, V&gt;: Java中存储键值对的数据类型都实现了这个接口，表示“映射表”。支持的两个核心操作是<em>get(Object key)</em>以及<em>put(K key, V value)</em>，分别用来获取键对应的值以及向映射表中插入键值对。</li><li>Set: 实现了这个接口的集合类型中不允许存在重复的元素，代表数学意义上的“集合”。它所支持的核心操作有<em>add(E e)</em>, <em>remove(Object o)</em>, <em>contains(Object o)</em>，分别用于添加元素，删除元素以及判断给定元素是否存在于集中。</li><li>List: Java中集合框架中的列表类型都实现了这个接口，表示一种有序序列。支持<em>get(int index)</em>, *add(E e)*等操作。</li><li>Queue: Java集合框架中的队列接口，代表了“先进先出”队列。支持<em>add(E element)</em>, *remove()*等操作。</li><li>Stack: Java集合框架中表示堆栈的数据类型，堆栈是一种“后进先出”的数据结构。支持<em>push(E item)</em>, *pop()*等操作。</li></ul><p>更详细的说明请参考官方文档，对相关数据结构不太熟悉的同学可以参考《算法导论》或其他相关书籍。</p><p><strong>9. HashMap和HashTable的区别</strong></p><ul><li>HashTable是线程安全的，而HashMap不是</li><li>HashMap中允许存在null键和null值，而HashTable中不允许</li></ul><p><strong>10. HashMap的实现原理</strong> 简单的说，HashMap的底层实现是“基于拉链法的散列表”。详细分析请参考<a href="http://blog.csdn.net/tgxblue/article/details/8479147" target="_blank" rel="noopener">深入解析HashMap、HashTable</a></p><p><strong>11. ConcurrentHashMap的实现原理</strong> ConcurrentHashMap是支持并发读写的HashMap，它的特点是读取数据时无需加锁，写数据时可以保证加锁粒度尽可能的小。由于其内部采用“分段存储”，只需对要进行写操作的数据所在的“段”进行加锁。关于ConcurrentHashMap底层实现的详细分析请参考<a href="http://www.cnblogs.com/dolphin0520/p/3932905.html" target="_blank" rel="noopener">Java并发编程：并发容器之ConcurrentHashMap</a></p><p><strong>12. TreeMap, LinkedHashMap, HashMap的区别是什么？</strong></p><ul><li>HashMap的底层实现是散列表，因此它内部存储的元素是无序的；</li><li>TreeMap的底层实现是红黑树，所以它内部的元素的有序的。排序的依据是自然序或者是创建TreeMap时所提供的比较器（Comparator）对象。</li><li>LinkedHashMap可以看作能够记住插入元素的顺序的HashMap。</li></ul><p><strong>13. Collection与Collections的区别是什么？</strong></p><ul><li>Collection是Java集合框架中的基本接口；</li><li>Collections是Java集合框架提供的一个工具类，其中包含了大量用于操作或返回集合的静态方法。</li></ul><p><strong>14. 对于“try-catch-finally”，若try语句块中包含“return”语句，finally语句块会执行吗？</strong> 会执行。只有两种情况finally块中的语句不会被执行：<em>**</em></p><ul><li>调用了*System.exit()*方法；</li><li>JVM“崩溃”了。</li></ul><p><strong>15. Java中的异常层次结构</strong> Java中的异常层次结构如下图所示：</p><pre><code>我们可以看到Throwable类是异常层级中的基类。Error类表示内部错误，这类错误使我们无法控制的；Exception表示异常，RuntimeException及其子类属于未检查异常，这类异常包括ArrayIndexOutOfBoundsException、NullPointerException等，我们应该通过条件判断等方式语句避免未检查异常的发生。IOException及其子类属于已检查异常，编译器会检查我们是否为所有可能抛出的已检查异常提供了异常处理器，若没有则会报错。对于未检查异常，我们无需捕获（当然Java也允许我们捕获，但我们应该做的事避免未检查异常的发生）。</code></pre><p><strong>16. Java面向对象的三个特征与含义</strong> 三大特征：封装、继承、多态。详细介绍请戳<a href="http://javabc.baike.com/article-692235.html" target="_blank" rel="noopener">Java面向对象三大特性</a></p><p><strong>17. Override, Overload的含义与区别</strong></p><ul><li>Override表示“重写”，是子类对父类中同一方法的重新定义</li><li>Overload表示“重载”，也就是定义一个与已定义方法名称相同但签名不同的新方法<em>**</em></li></ul><p><strong>18. 接口与抽象类的区别</strong></p><ul><li>接口是一种约定，实现接口的类要遵循这个约定；</li><li>抽象类本质上是一个类，使用抽象类的代价要比接口大。</li><li>接口与抽象类的对比如下： - 抽象类中可以包含属性，方法（包含抽象方法与有着具体实现的方法），常量；接口只能包含常量和方法声明。</li><li>抽象类中的方法和成员变量可以定义可见性（比如public、private等）；而接口中的方法只能为public（缺省为public）。</li><li>一个子类只能有一个父类（具体类或抽象类）；而一个接口可以继承一个多个接口，一个类也可以实现多个接口。</li><li>子类中实现父类中的抽象方法时，可见性可以大于等于父类中的；而接口实现类中的接口 方法的可见性只能与接口中相同（public）。</li></ul><p><strong>19. 静态内部类与非静态内部类的区别</strong> 静态内部类不会持有外围类的引用，而非静态内部类会隐式持有外围类的一个引用。</p><p><strong>20. Java中多态的实现原理</strong> 所谓多态，指的就是父类引用指向子类对象，调用方法时会调用子类的实现而不是父类的实现。多态的实现的关键在于“动态绑定”。详细介绍请戳<a href="http://blog.csdn.net/sureyonder/article/details/5569617" target="_blank" rel="noopener">Java动态绑定的内部实现机制</a></p><p><strong>21. 简述Java中创建新线程的两种方法</strong></p><ul><li>继承Thread类（假设子类为MyThread），并重写run()方法，然后new一个MyThread对象并对其调用start()即可启动新线程。</li><li>实现Runnable接口（假设实现类为MyRunnable），而后将MyRunnable对象作为参数传入Thread构造器，在得到的Thread对象上调用start()方法即可。</li></ul><p><strong>22. 简述Java中进行线程同步的方法</strong></p><ul><li>volatile: Java Memory Model保证了对同一个volatile变量的写happens before对它的读；</li><li>synchronized: 可以来对一个代码块或是对一个方法上锁，被“锁住”的地方称为临界区，进入临界区的线程会获取对象的monitor，这样其他尝试进入临界区的线程会因无法获取monitor而被阻塞。由于等待另一个线程释放monitor而被阻塞的线程无法被中断。</li><li>ReentrantLock: 尝试获取锁的线程可以被中断并可以设置超时参数。</li></ul><p><strong>23. 简述Java中具有哪几种粒度的锁</strong> Java中可以对类、对象、方法或是代码块上锁。</p><p><strong>24. 给出“生产者-消费者”问题的一种解决方案</strong> 使用阻塞队列：</p><pre><code>public class BlockingQueueTest {  private int size = 20;  private ArrayBlockingQueue&lt;Integer&gt; blockingQueue = new ArrayBlockingQueue&lt;&gt;(size);  public static void main(String[] args) {    BlockingQueueTest test = new BlockingQueueTest();     Producer producer = test.new Producer();     Consumer consumer = test.new Consumer();     producer.start(); consumer.start();   }   class Consumer extends Thread{     @Override     public void run() {       while(true){         try {           //从阻塞队列中取出一个元素           queue.take();           System.out.println(&quot;队列剩余&quot; + queue.size() + &quot;个元素&quot;);         } catch (InterruptedException e) {         }       }     }   }   class Producer extends Thread{     @Override     public void run() {       while (true) {         try {           //向阻塞队列中插入一个元素           queue.put(1);           System.out.println(&quot;队列剩余空间：&quot; + (size - queue.size()));         } catch (InterruptedException e) {         }       }     }   }}</code></pre><p><strong>25. ThreadLocal的设计理念与作用</strong> ThreadLocal的作用是提供线程内的局部变量，在多线程环境下访问时能保证各个线程内的ThreadLocal变量各自独立。也就是说，每个线程的ThreadLocal变量是自己专用的，其他线程是访问不到的。ThreadLocal最常用于以下这个场景：多线程环境下存在对非线程安全对象的并发访问，而且该对象不需要在线程间共享，但是我们不想加锁，这时候可以使用ThreadLocal来使得每个线程都持有一个该对象的副本。</p><p><strong>26. concurrent包的整体架构</strong></p><p><img src="http://upload-images.jianshu.io/upload_images/2397836-998c32bf72ba921c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p><strong>27. ArrayBlockingQueue, CountDownLatch类的作用</strong></p><ul><li>CountDownLatch: 允许线程集等待直到计数器为0。适用场景: 当一个或多个线程需要等待指定数目的事件发生后再继续执行。</li><li>ArrayBlockingQueue: 一个基于数组实现的阻塞队列，它在构造时需要指定容量。当试图向满队列中添加元素或者从空队列中移除元素时，当前线程会被阻塞。通过阻塞队列，我们可以按以下模式来工作：工作者线程可以周期性的将中间结果放入阻塞队列中，其它线程可以取出中间结果并进行进一步操作。若工作者线程的执行比较慢（还没来得及向队列中插入元素），其他从队列中取元素的线程会等待它（试图从空队列中取元素从而阻塞）；若工作者线程执行较快（试图向满队列中插入元素），则它会等待其它线程取出元素再继续执行。</li></ul><p><strong>28. wait()，sleep() 的区别</strong></p><ul><li>wait(): Object类中定义的实例方法。在指定对象上调用wait方法会让当前线程进入等待状态（前提是当前线程持有该对象的monitor），此时当前线程会释放相应对象的monitor，这样一来其它线程便有机会获取这个对象的monitor了。当其它线程获取了这个对象的monitor并进行了所需操作时，便可以调用notify方法唤醒之前进入等待状态的线程。</li><li>sleep(): Thread类中的静态方法，作用是让当前线程进入休眠状态，以便让其他线程有机会执行。进入休眠状态的线程不会释放它所持有的锁。</li></ul><p><strong>29. 线程池的用法与优势</strong></p><ul><li>优势: 实现对线程的复用，避免了反复创建及销毁线程的开销；使用线程池统一管理线程可以减少并发线程的数目，而线程数过多往往会在线程上下文切换上以及线程同步上浪费过多时间。</li><li>用法: 我们可以调用ThreadPoolExecutor的某个构造方法来自己创建一个线程池。但通常情况下我们可以使用Executors类提供给我们的静态工厂方法来更方便的创建一个线程池对象。创建了线程池对象后，我们就可以调用submit方法提交任务到线程池中去执行了；线程池使用完毕后我们要记得调用shutdown方法来关闭它。</li></ul><p><strong>30. for-each与常规for循环的效率对比</strong> 关于这个问题我们直接看《Effective Java》给我们做的解答：</p><blockquote><p>for-each能够让代码更加清晰，并且减少了出错的机会。 下面的惯用代码适用于集合与数组类型：</p><pre><code>for (Element e : elements) {    doSomething(e);}</code></pre><p>使用for-each循环与常规的for循环相比，并不存在性能损失，即使对数组进行迭代也是如此。实际上，在有些场合下它还能带来微小的性能提升，因为它只计算一次数组索引的上限。</p></blockquote><p><strong>31. 简述Java IO与NIO的区别</strong></p><ul><li>Java IO是面向流的，这意味着我们需要每次从流中读取一个或多个字节，直到读取完所有字节；NIO是面向缓冲的，也就是说会把数据读取到一个缓冲区中，然后对缓冲区中的数据进行相应处理。</li><li>Java IO是阻塞IO，而NIO是非阻塞IO。</li><li>Java NIO中存在一个称为选择器（selector）的东西，它允许你把多个通道（channel）注册到一个选择器上，然后使用一个线程来监视这些通道：若这些通道里有某个准备好可以开始进行读或写操作了，则开始对相应的通道进行读写。而在等待某通道变为可读/写期间，请求对通道进行读写操作的线程可以去干别的事情。</li></ul><p><strong>32. 反射的作用与原理</strong> 反射的作用概括地说是运行时获取类的各种定义信息，比如定义了哪些属性与方法。原理是通过类的class对象来获取它的各种信息。</p><p><strong>33. Java中的泛型机制</strong> 关于泛型机制的详细介绍请直接戳<a href="http://www.jianshu.com/p/b70c703cc303" target="_blank" rel="noopener">Java核心技术点之泛型</a></p><p><strong>34. Java 7与Java 8的新特性</strong> 这里有两篇总结的非常好的： <a href="http://www.csdn.net/article/2011-07-22/302072" target="_blank" rel="noopener">Java 7的新特性</a> <a href="http://www.open-open.com/lib/view/open1403232177575.html" target="_blank" rel="noopener">Java 8的新特性</a></p><p><strong>35. 常见设计模式</strong> 所谓“设计模式”，不过是面向对象编程中一些常用的软件设计手法，并且经过实践的检验，这些设计手法在各自的场景下能解决一些需求，因此它们就成为了如今广为流传的”设计模式“。也就是说，正式因为在某些场景下产生了一些棘手的问题，才催生了相应的设计模式。明确了这一点，我们在学习某种设计模式时要充分理解它产生的背景以及它所解决的主要矛盾是什么。</p><p>常用的设计模式可以分为以下三大类：</p><ul><li>创建型模式: 包括工厂模式（又可进一步分为简单工厂模式、工厂方法模式、抽象工厂模式）、建造者模式、单例模式。</li><li>结构型模式: 包括适配器模式、桥接模式、装饰模式、外观模式、享元模式、代理模式。</li><li>行为型模式: 包括命令模式、中介者模式、观察者模式、状态模式、策略模式。关于每个模式具体的介绍请参考<a href="http://design-patterns.readthedocs.io/zh_CN/latest/" target="_blank" rel="noopener">图说设计模式</a></li></ul><p><strong>36. JNI的基本用法</strong> 关于JNI，这里有篇好文：<a href="http://www.jianshu.com/p/aba734d5b5cd" target="_blank" rel="noopener">Android中的JNI</a></p><p><strong>37. 动态代理的定义、应用场景及原理</strong> 请参见<a href="http://www.jianshu.com/p/cbd58642fc08" target="_blank" rel="noopener">十分钟理解Java之动态代理</a></p><p><strong>38. 注解的基本概念与使用</strong> 注解可以看作是“增强版的注释”，它可以向编译器、虚拟机说明一些事情。 注解是描述Java代码的代码，它能够被编译器解析，注解处理工具在运行时也能够解析注解。注解本身是“被动”的信息，只有主动解析它才有意义。 除了向编译器/虚拟机传递信息，我们也可以使用注解来生成一些“模板化”的代码。</p><p>文／absfree（简书作者） 原文链接：<a href="http://www.jianshu.com/p/1990eb1f66eb" target="_blank" rel="noopener">http://www.jianshu.com/p/1990eb1f66eb</a> 著作权归作者所有，转载请联系作者获得授权，并标注“简书作者”。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git常用命令清单</title>
      <link href="/git-commonly-used-commands.html"/>
      <url>/git-commonly-used-commands.html</url>
      
        <content type="html"><![CDATA[<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul><li><a href="http://git-scm.com/" target="_blank" rel="noopener">Git官网</a></li><li><a href="https://try.github.io" target="_blank" rel="noopener"><strong>Github 15分钟学习Git</strong></a></li><li><a href="http://gitref.org/zh/index.html" target="_blank" rel="noopener">Git参考手册</a></li><li><a href="http://www.mceiba.com/tool/git-cheat-sheet.html" target="_blank" rel="noopener">Git简明手册</a></li><li><a href="http://www-cs-students.stanford.edu/~blynn/gitmagic/intl/zh_cn/" target="_blank" rel="noopener">Git Magic</a></li><li><a href="http://gitbook.liuhui998.com/index.html" target="_blank" rel="noopener">Git Community Book 中文版</a></li><li><a href="http://git-scm.com/book/en/v2" target="_blank" rel="noopener">Pro Git</a></li><li><a href="http://marklodato.github.io/visual-git-guide/index-zh-cn.html" target="_blank" rel="noopener">图解Git</a></li><li><a href="http://rogerdudler.github.io/git-guide/index.zh.html" target="_blank" rel="noopener">git-简明指南</a></li><li><a href="http://pcottle.github.io/learnGitBranching/" target="_blank" rel="noopener">learnGitBranching 在线学习工具</a></li><li><a href="http://rogerdudler.github.io/git-guide/index.zh.html" target="_blank" rel="noopener">初级教程</a></li><li><a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000" target="_blank" rel="noopener">廖雪峰的Git教程</a></li><li><a href="http://www.worldhello.net/gotgithub/" target="_blank" rel="noopener">蒋鑫老师将带你入github的大门</a></li><li><a href="http://www.open-open.com/lib/view/open1328069609436.html" target="_blank" rel="noopener">git详解</a></li><li><a href="http://git.oschina.net/progit/" target="_blank" rel="noopener">oschina教程</a></li><li><a href="https://github.com/blog/2019-how-to-undo-almost-anything-with-git" target="_blank" rel="noopener">How to undo (almost) anything with Git撤销一切，汇总各种回滚撤销的场景，加强学习。</a></li><li><a href="http://www.runoob.com/git/git-tutorial.html" target="_blank" rel="noopener">Git 教程 | 菜鸟教程runoob.com</a></li></ul><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>首先是配置帐号信息<br><code>ssh -T git@github.com</code> #登陆github</p><h3 id="修改项目中的个人信息"><a href="#修改项目中的个人信息" class="headerlink" title="修改项目中的个人信息"></a>修改项目中的个人信息</h3><p><code>$ git config --global user.name &quot;wirelessqa&quot;</code><br><code>$ git config --global user.email wirelessqa.me@gmail.com</code></p><h3 id="config"><a href="#config" class="headerlink" title="config"></a>config</h3><pre><code>git config --global user.name JSLite    # 设置提交用户名  git config --global user.email JSLite@yeah.net  # 设置提交邮箱  git config --list         # 查看配置的信息  git remote remove origin  # 删除该远程路径  git remote add origin git@jslite.github.com:JSLite/JSLite.git  # 添加远程路径</code></pre><h3 id="help"><a href="#help" class="headerlink" title="help"></a>help</h3><p><code>git help config</code> # 获取帮助信息</p><h3 id="配置自动换行（自动转换坑太大）"><a href="#配置自动换行（自动转换坑太大）" class="headerlink" title="配置自动换行（自动转换坑太大）"></a>配置自动换行（自动转换坑太大）</h3><p><code>git config --global core.autocrlf input</code> # 提交到git是自动将换行符转换为lf</p><h3 id="配置密钥"><a href="#配置密钥" class="headerlink" title="配置密钥"></a>配置密钥</h3><p><code>ssh-keygen -t rsa -C JSLite@yeah.net</code> # 生成密钥<br><code>ssh -T git@github.com</code> #测试是否成功</p><h3 id="多账号ssh配置"><a href="#多账号ssh配置" class="headerlink" title="多账号ssh配置"></a>多账号ssh配置</h3><h3 id="1-生成指定名字的密钥"><a href="#1-生成指定名字的密钥" class="headerlink" title="1.生成指定名字的密钥"></a>1.生成指定名字的密钥</h3><p><code>ssh-keygen -t rsa -C &quot;邮箱地址&quot; -f ~/.ssh/github_jslite</code><br>会生成 <code>github_jslite</code> 和 <code>github_jslite.pub</code> 这两个文件</p><h3 id="2-密钥复制到托管平台上"><a href="#2-密钥复制到托管平台上" class="headerlink" title="2.密钥复制到托管平台上"></a>2.密钥复制到托管平台上</h3><p><code>vim ~/.ssh/github_jslite.pub</code><br>打开公钥文件 <code>github_jslite.pub</code> ，并把内容复制至代码托管平台上</p><h3 id="3-修改config文件"><a href="#3-修改config文件" class="headerlink" title="3.修改config文件"></a>3.修改config文件</h3><p><code>vim ~/.ssh/config</code> #修改config文件，如果没有创建 <code>config</code></p><pre><code>Host jslite.github.comHostName github.comUser gitIdentityFile ~/.ssh/github_jsliteHost abc.github.comHostName github.comUser gitIdentityFile ~/.ssh/github_abc</code></pre><h3 id="4-测试"><a href="#4-测试" class="headerlink" title="4.测试"></a>4.测试</h3><p><code>ssh -T git@jslite.github.com</code> # <code>@</code>后面跟上定义的Host</p><h3 id="Git推向3个库"><a href="#Git推向3个库" class="headerlink" title="Git推向3个库"></a>Git推向3个库</h3><h3 id="增加3个远程库地址"><a href="#增加3个远程库地址" class="headerlink" title="增加3个远程库地址"></a>增加3个远程库地址</h3><p><code>git remote add origin https://github.com/JSLite/JSLite.git</code><br><code>git remote set-url --add origin https://gitlab.com/wang/JSLite.js.git</code><br><code>git remote set-url --add origin https://oschina.net/wang/JSLite.js.git</code></p><h3 id="删除其中一个-set-url-地址"><a href="#删除其中一个-set-url-地址" class="headerlink" title="删除其中一个 set-url 地址"></a>删除其中一个 set-url 地址</h3><pre><code>usage: git remote set-url [--push] &lt;name&gt; &lt;newurl&gt; [&lt;oldurl&gt;]   or: git remote set-url --add &lt;name&gt; &lt;newurl&gt;   or: git remote set-url --delete &lt;name&gt; &lt;url&gt;</code></pre><p><code>git remote set-url --delete origin https://oschina.net/wang/JSLite.js.git</code></p><h3 id="push"><a href="#push" class="headerlink" title="push"></a>push</h3><p><code>git push origin master</code><br><code>git push -f origin master</code> #强制推送</p><ol><li>缩写 -f</li><li>全写–force</li><li>注：强制推送文件没有了哦</li></ol><h3 id="pull"><a href="#pull" class="headerlink" title="pull"></a>pull</h3><p>只能拉取 <code>origin</code> 里的一个url地址，这个fetch-url<br>默认为你添加的到 <code>origin</code>的第一个地址</p><p><code>git pull origin master</code><br><code>git pull --all</code> # 获取远程所有内容包括tag<br><code>git pull origin next:master</code> # 取回origin主机的next分支，与本地的master分支合并<br><code>git pull origin next</code> # 远程分支是与当前分支合并</p><p>上面一条命令等同于下面两条命令<br><code>git fetch origin</code><br><code>git merge origin/next</code></p><p>如果远程主机删除了某个分支，默认情况下，git pull 不会在拉取远程分支的时候，删除对应的本地分支。这是为了防止，由于其他人操作了远程主机，导致git pull不知不觉删除了本地分支。<br>但是，你可以改变这个行为，加上参数 -p 就会在本地删除远程已经删除的分支。</p><pre><code>$ git pull -p# 等同于下面的命令$ git fetch --prune origin $ git fetch -p</code></pre><h3 id="更改pull"><a href="#更改pull" class="headerlink" title="更改pull"></a>更改pull</h3><p>只需要更改config文件里，那三个url的顺序即可，fetch-url会直接对应排行第一的那个utl连接。</p><h3 id="新建仓库"><a href="#新建仓库" class="headerlink" title="新建仓库"></a>新建仓库</h3><h3 id="init"><a href="#init" class="headerlink" title="init"></a>init</h3><p><code>git init</code> #初始化</p><h3 id="status"><a href="#status" class="headerlink" title="status"></a>status</h3><p><code>git status</code> #获取状态</p><h3 id="add"><a href="#add" class="headerlink" title="add"></a>add</h3><p><code>git add file</code> # .或*代表全部添加<br><code>git rm --cached &lt;added_file_to_undo&gt;</code> # 在commit之前撤销git add操作<br><code>git reset head</code> # 好像比上面<code>git rm --cached</code>更方便</p><h3 id="commit"><a href="#commit" class="headerlink" title="commit"></a>commit</h3><p><code>git commit -m &quot;message&quot;</code> #此处注意乱码</p><h3 id="remote"><a href="#remote" class="headerlink" title="remote"></a>remote</h3><p><code>git remote add origin git@github.com:JSLite/test.git</code> #添加源</p><h3 id="push-1"><a href="#push-1" class="headerlink" title="push"></a>push</h3><p><code>git push -u origin master</code> #push同事设置默认跟踪分支<br><code>git push origin master</code></p><h3 id="从现有仓库克隆-git-clone-git-github-com-JSLite-JSLite-js-git"><a href="#从现有仓库克隆-git-clone-git-github-com-JSLite-JSLite-js-git" class="headerlink" title="从现有仓库克隆 git clone git://github.com/JSLite/JSLite.js.git"></a>从现有仓库克隆 <code>git clone git://github.com/JSLite/JSLite.js.git</code></h3><p><code>git clone git://github.com/JSLite/JSLite.js.git mypro</code> #克隆到自定义文件夹<br><code>git clone [user@]example.com:path/to/repo.git/</code> #SSH协议还有另一种写法。</p><p>git clone支持多种协议，除了HTTP(s)以外，还支持SSH、Git、本地文件协议等，下面是一些例子。<code>$ git clone &lt;版本库的网址&gt; &lt;本地目录名&gt;</code></p><pre><code>$ git clone http[s]://example.com/path/to/repo.git/$ git clone ssh://example.com/path/to/repo.git/$ git clone git://example.com/path/to/repo.git/$ git clone /opt/git/project.git $ git clone file:///opt/git/project.git$ git clone ftp[s]://example.com/path/to/repo.git/$ git clone rsync://example.com/path/to/repo.git/</code></pre><h3 id="submodule"><a href="#submodule" class="headerlink" title="submodule"></a>submodule</h3><p><code>git submodule add --force 仓库地址 路径</code><br>其中，仓库地址是指子模块仓库地址，路径指将子模块放置在当前工程下的路径。<br>注意：路径不能以 / 结尾（会造成修改不生效）、不能是现有工程已有的目录（不能順利 Clone）<br><code>git submodule init</code> 初始化submodule<br><code>git submodule update</code> 更新submodule(必须在根目录执行命令)</p><p>当使用git clone下来的工程中带有submodule时，初始的时候，submodule的内容并不会自动下载下来的，此时，只需执行如下命令：<br><code>git submodule update --init --recursive</code> 下载的工程带有submodule</p><p><code>git submodule foreach git pull</code> submodule 里有其他的 submodule 一次更新<br><code>git submodule foreach git pull origin master</code> submodule更新</p><p><code>git submodule foreach --recursive git submodule init</code><br><code>git submodule foreach --recursive git submodule update</code></p><h3 id="本地"><a href="#本地" class="headerlink" title="本地"></a>本地</h3><h3 id="add-1"><a href="#add-1" class="headerlink" title="add"></a>add</h3><pre><code>git add *   # 跟踪新文件   git add -u [path]   # 添加[指定路径下]已跟踪文件</code></pre><h3 id="rm"><a href="#rm" class="headerlink" title="rm"></a>rm</h3><pre><code>rm *&amp;git rm *          # 移除文件  git rm -f *            # 移除文件  git rm --cached *      # 取消跟踪  git mv file_from file_to  # 重命名跟踪文件  git log   # 查看提交记录</code></pre><h3 id="commit-1"><a href="#commit-1" class="headerlink" title="commit"></a>commit</h3><pre><code>git commit #提交更新   git commit -m &apos;message&apos; #提交说明   git commit -a #跳过使用暂存区域，把所有已经跟踪过的文件暂存起来一并提交   git commit --amend #修改最后一次提交   git commit log #查看所有提交，包括没有push的commit    git commit -m &quot;#133&quot; #关联issue 任意位置带上# 符号加上issue号码  git commit -m &quot;fix #133&quot; commit关闭issue  git commit -m &apos;概要描述&apos;$&apos;\n\n&apos;&apos;1.详细描述&apos;$&apos;\n&apos;&apos;2.详细描述&apos; #提交简要描述和详细描述</code></pre><h3 id="reset"><a href="#reset" class="headerlink" title="reset"></a>reset</h3><pre><code>git reset HEAD *  # 取消已经暂存的文件   git reset --mixed HEAD * # 同上   git reset --soft HEAD *  # 重置到指定状态，不会修改索引区和工作树   git reset --hard HEAD *  # 重置到指定状态，会修改索引区和工作树   git reset -- files *     # 重置index区文件</code></pre><h3 id="revert"><a href="#revert" class="headerlink" title="revert"></a>revert</h3><pre><code>git revert HEAD   # 撤销前一次操作   git revert HEAD~  # 撤销前前一次操作   git revert commit # 撤销指定操作</code></pre><h3 id="checkout"><a href="#checkout" class="headerlink" title="checkout"></a>checkout</h3><pre><code>git checkout -- file  # 取消对文件的修改（从暂存区——覆盖worktree file）  git checkout branch|tag|commit -- file_name  # 从仓库取出file覆盖当前分支   git checkout HEAD~1 [文件]  # 将会更新 working directory 去匹配某次 commit   git checkout -- .          # 从暂存区取出文件覆盖工作区   git checkout -b gh-pages  0c304c9  # 这个表示 从当前分支 commit 哈希值为 0c304c9 的节点，分一个新的分支gh-pages出来，并切换到 gh-pages</code></pre><h3 id="diff"><a href="#diff" class="headerlink" title="diff"></a>diff</h3><pre><code>git diff file     # 查看指定文件的差异   git diff --stat   # 查看简单的diff结果   git diff  # 比较Worktree和Index之间的差异   git diff --cached   # 比较Index和HEAD之间的差异   git diff HEAD       # 比较Worktree和HEAD之间的差异   git diff branch     # 比较Worktree和branch之间的差异   git diff branch1 branch2  # 比较两次分支之间的差异   git diff commit commit    # 比较两次提交之间的差异   git diff master..test   # 上面这条命令只显示两个分支间的差异  git diff master...test    # 你想找出‘master’,‘test’的共有 父分支和&apos;test&apos;分支之间的差异，你用3个‘.&apos;来取代前面的两个&apos;.&apos;</code></pre><h3 id="stash"><a href="#stash" class="headerlink" title="stash"></a>stash</h3><pre><code>git stash # 将工作区现场（已跟踪文件）储藏起来，等以后恢复后继续工作。   git stash list  # 查看保存的工作现场   git stash apply # 恢复工作现场   git stash drop  # 删除stash内容   git stash pop   # 恢复的同时直接删除stash内容   git stash apply stash@{0} # 恢复指定的工作现场，当你保存了不只一份工作现场时。</code></pre><h3 id="merge"><a href="#merge" class="headerlink" title="merge"></a>merge</h3><p><code>git merge --squash test</code> ###合并压缩，将test上的commit压缩为一条</p><h3 id="cherry-pick"><a href="#cherry-pick" class="headerlink" title="cherry-pick"></a>cherry-pick</h3><pre><code>git cherry-pick commit    # 拣选合并，将commit合并到当前分支   git cherry-pick -n commit # 拣选多个提交，合并完后可以继续拣选下一个提交</code></pre><h3 id="rebase"><a href="#rebase" class="headerlink" title="rebase"></a>rebase</h3><pre><code>git rebase master   # 将master分之上超前的提交，变基到当前分支  git rebase --onto master 169a6  # 限制回滚范围，rebase当前分支从169a6以后的提交  git rebase --interactive # 交互模式，修改commit   git rebase --continue    # 处理完冲突继续合并   git rebase --skip   # 跳过   git rebase --abort  # 取消合并</code></pre><h3 id="分支branch"><a href="#分支branch" class="headerlink" title="分支branch"></a>分支branch</h3><h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><pre><code>git push origin :branchName  #删除远程分支  git push origin --delete new #删除远程分支new   git branch -d branchName     #删除本地分支，强制删除用-D  git branch -d test #删除本地test分支   git branch -D test #强制删除本地test分支</code></pre><h3 id="提交"><a href="#提交" class="headerlink" title="提交"></a>提交</h3><p><code>git push -u origin branchName</code> #提交分支到远程origin主机中</p><h3 id="拉取"><a href="#拉取" class="headerlink" title="拉取"></a>拉取</h3><p><code>git fetch -p</code> #拉取远程分支时，自动清理 远程分支已删除，本地还存在的对应同名分支。</p><h3 id="分支合并"><a href="#分支合并" class="headerlink" title="分支合并"></a>分支合并</h3><pre><code>git merge branchName      # 合并分支 - 将分支branchName和当前所在分支合并   git merge origin/master   # 在本地分支上合并远程分支。   git rebase origin/master  # 在本地分支上合并远程分支。   git merge test            # 将test分支合并到当前分支</code></pre><h3 id="重命名"><a href="#重命名" class="headerlink" title="重命名"></a>重命名</h3><p><code>git branch -m old new</code> #重命名分支</p><h3 id="查看"><a href="#查看" class="headerlink" title="查看"></a>查看</h3><pre><code>git branch      # 列出本地分支   git branch -r   # 列出远端分支   git branch -a   # 列出所有分支   git branch -v   # 查看各个分支最后一个提交对象的信息   git branch --merge      # 查看已经合并到当前分支的分支   git branch --no-merge   # 查看为合并到当前分支的分支</code></pre><h3 id="新建"><a href="#新建" class="headerlink" title="新建"></a>新建</h3><pre><code>git branch test # 新建test分支  git checkout -b newBrach origin/master # 取回远程主机的更新以后，在它的基础上创建一个新的分支</code></pre><h3 id="连接"><a href="#连接" class="headerlink" title="连接"></a>连接</h3><pre><code>git branch --set-upstream dev origin/dev     # 将本地dev分支与远程dev分支之间建立链接  git branch --set-upstream master origin/next # 手动建立追踪关系</code></pre><h3 id="分支切换"><a href="#分支切换" class="headerlink" title="分支切换"></a>分支切换</h3><pre><code>git checkout test     # 切换到test分支   git checkout -b test  # 新建+切换到test分支   git checkout -b test dev # 基于dev新建test分支，并切换</code></pre><h3 id="远端"><a href="#远端" class="headerlink" title="远端"></a>远端</h3><pre><code>git fetch &lt;远程主机名&gt; &lt;分支名&gt;   # fetch取回所有分支（branch）的更新  git fetch origin remotebranch[:localbranch]   #  从远端拉去分支[到本地指定分支]   git merge origin/branch   # 合并远端上指定分支   git pull origin remotebranch:localbranch  #  拉去远端分支到本地分支   git push origin branch    # 将当前分支，推送到远端上指定分支   git push origin localbranch:remotebranch  # 推送本地指定分支，到远端上指定分支   git push origin :remotebranch   # 删除远端指定分支   git checkout -b [--track] test origin/dev # 基于远端dev分支，新建本地test分支[同时设置跟踪]</code></pre><h3 id="撤销远程记录"><a href="#撤销远程记录" class="headerlink" title="撤销远程记录"></a>撤销远程记录</h3><p><code>git reset --hard HEAD~1</code> #撤销一条记录<br><code>git push -f origin HEAD:master</code> #同步到远程仓库</p><h3 id="忽略文件"><a href="#忽略文件" class="headerlink" title="忽略文件"></a>忽略文件</h3><p><code>echo node_modules/ &gt;&gt; .gitignore</code></p><h3 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h3><p><code>git rm -rf node_modules/</code></p><h3 id="源remote"><a href="#源remote" class="headerlink" title="源remote"></a>源remote</h3><p>git是一个分布式代码管理工具，所以可以支持多个仓库，在git里，服务器上的仓库在本地称之为remote。<br>个人开发时，多源用的可能不多，但多源其实非常有用。</p><pre><code>git remote add origin1 git@github.com:yanhaijing/data.js.git  git remote    # 显示全部源  git remote -v # 显示全部源+详细信息  git remote rename origin1 origin2 # 重命名  git remote rm origin    # 删除  git remote show origin  # 查看指定源的全部信息</code></pre><h3 id="同步一个fork"><a href="#同步一个fork" class="headerlink" title="同步一个fork"></a>同步一个fork</h3><p><a href="https://help.github.com/articles/syncing-a-fork/" target="_blank" rel="noopener">github教程</a><br><a href="http://www.miss77.net/549.html" target="_blank" rel="noopener">在github上同步一个分支(fork)</a></p><h3 id="设置"><a href="#设置" class="headerlink" title="设置"></a>设置</h3><p>在同步之前，需要创建一个远程点指向上游仓库(repo).如果你已经派生了一个原始仓库，可以按照如下方法做。</p><pre><code>$ git remote -v# List the current remotes （列出当前远程仓库）# origin  https://github.com/user/repo.git (fetch)# origin  https://github.com/user/repo.git (push)$ git remote add upstream https://github.com/otheruser/repo.git# Set a new remote (设置一个新的远程仓库)$ git remote -v# Verify new remote (验证新的原唱仓库)# origin    https://github.com/user/repo.git (fetch)# origin    https://github.com/user/repo.git (push)# upstream  https://github.com/otheruser/repo.git (fetch)# upstream  https://github.com/otheruser/repo.git (push)</code></pre><h3 id="同步"><a href="#同步" class="headerlink" title="同步"></a>同步</h3><p>同步上游仓库到你的仓库需要执行两步：首先你需要从远程拉去，之后你需要合并你希望的分支到你的本地副本分支。</p><p>从上游的存储库中提取分支以及各自的提交内容。 <code>master</code> 将被存储在本地分支机构 <code>upstream/master</code></p><pre><code>git fetch upstream# remote: Counting objects: 75, done.# remote: Compressing objects: 100% (53/53), done.# remote: Total 62 (delta 27), reused 44 (delta 9)# Unpacking objects: 100% (62/62), done.# From https://github.com/ORIGINAL_OWNER/ORIGINAL_REPOSITORY#  * [new branch]      master     -&gt; upstream/master</code></pre><p>检查你的 fork’s 本地 <code>master</code> 分支</p><pre><code>git checkout master# Switched to branch &apos;master&apos;</code></pre><p>合并来自 <code>upstream/master</code> 的更改到本地 master 分支上。 这使你的前 fork’s <code>master</code> 分支与上游资源库同步，而不会丢失你本地修改。</p><pre><code>git merge upstream/master# Updating a422352..5fdff0f# Fast-forward#  README                    |    9 -------#  README.md                 |    7 ++++++#  2 files changed, 7 insertions(+), 9 deletions(-)#  delete mode 100644 README#  create mode 100644 README.md</code></pre><h3 id="标签tag"><a href="#标签tag" class="headerlink" title="标签tag"></a>标签tag</h3><p>当开发到一定阶段时，给程序打标签是非常棒的功能。<br><code>git tag</code> #列出现有标签<br><code>git tag v0gi.1</code> #新建标签<br><code>git tag -a v0.1 -m &#39;my version 1.4&#39;</code> #新建带注释标签<br><code>git checkout tagname</code> #切换到标签<br><code>git push origin v1.5</code> #推送分支到源上<br><code>git push origin --tags</code> #一次性推送所有分支<br><code>git tag -d v0.1</code> #删除标签<br><code>git push origin :refs/tags/v0.1</code> #删除远程标签<br><code>git pull --all</code> #获取远程所有内容包括tag<br><code>git --git-dir=&#39;&lt;绝对地址&gt;/.git&#39; describe --tags HEAD</code> #查看本地版本信息</p><h3 id="日志log"><a href="#日志log" class="headerlink" title="日志log"></a>日志log</h3><p><code>git config format.pretty oneline</code> #显示历史记录时，每个提交的信息只显示一行<br><code>git config color.ui true</code> #彩色的 git 输出<br><code>git log</code> #查看最近的提交日志<br><code>git log --pretty=oneline</code> #单行显示提交日志<br><code>git log --graph --pretty=oneline --abbrev-commit</code><br><code>git log -num</code> #显示第几条log（倒数）<br><code>git reflog</code> #查看所有分支的所有操作记录<br><code>git log --since=1.day</code> #一天内的提交；你可以给出各种时间格式，比如说具体的某一天（“2008-01-15”），或者是多久以前（“2 years 1 day 3 minutes ago”）。<br><code>git log --pretty=&quot;%h - %s&quot; --author=自己的名字</code> #查看自己的日志<br><code>git log -p -2</code> #展开两次更新显示每次提交的内容差异<br><code>git log --stat</code> #要快速浏览其他协作者提交的更新都作了哪些改动<br><code>git log --pretty=format:&quot;%h - %an, %ar : %s&quot;</code>#定制要显示的记录格式<br><code>git log --pretty=format:&#39;%h : %s&#39; --date-order --graph</code>#拓扑顺序展示<br><code>git log --pretty=format:&#39;%h : %s - %ad&#39; --date=short</code> #日期YYYY-MM-DD显示<br><code>git log &lt;last tag&gt; HEAD --pretty=format:%s</code> 只显示commit</p><p>选项</p><p>说明</p><p>%H</p><p>提交对象（commit）的完整哈希字串</p><p>%h</p><p>提交对象的简短哈希字串</p><p>%T</p><p>树对象（tree）的完整哈希字串</p><p>%t</p><p>树对象的简短哈希字串</p><p>%P</p><p>父对象（parent）的完整哈希字串</p><p>%p</p><p>父对象的简短哈希字串</p><p>%an</p><p>作者（author）的名字</p><p>%ae</p><p>作者的电子邮件地址</p><p>%ad</p><p>作者修订日期（可以用 -date= 选项定制格式）</p><p>%ar</p><p>作者修订日期，按多久以前的方式显示</p><p>%cn</p><p>提交者(committer)的名字</p><p>%ce</p><p>提交者的电子邮件地址</p><p>%cd</p><p>提交日期</p><p>%cr</p><p>提交日期，按多久以前的方式显示</p><p>%s</p><p>提交说明</p><p>### 重写历史</p><p><code>git commit --amend</code> #改变最近一次提交<br><code>git rebase -i HEAD~3</code> #修改最近三次的提交说明，或者其中任意一次<br><code>git commit --amend</code> #保存好了，这些指示很明确地告诉了你该干什么<br><code>git rebase --continue</code> 修改提交说明，退出编辑器。</p><pre><code>pick f7f3f6d changed my name a bitpick 310154e updated README formatting and added blamepick a5f4a0d added cat-file</code></pre><p>改成</p><pre><code>pick 310154e updated README formatting and added blamepick f7f3f6d changed my name a bit</code></pre><h3 id="利用commit关闭一个issue"><a href="#利用commit关闭一个issue" class="headerlink" title="利用commit关闭一个issue"></a>利用commit关闭一个issue</h3><p>这个功能在Github上可以玩儿，Gitlab上特别老的版本不能玩儿哦，那么如何跟随着commit关闭一个issue呢? 在confirm merge的时候可以使用一下命令来关闭相关issue:</p><ol><li>fixes #xxx</li><li>fixed #xxx</li><li>fix #xxx</li><li>closes #xxx</li><li>close #xxx</li><li>closed #xxx</li></ol><h3 id="查看某个文件历史"><a href="#查看某个文件历史" class="headerlink" title="查看某个文件历史"></a>查看某个文件历史</h3><pre><code>git log --pretty=oneline 文件名  # 列出文件的所有改动历史  git show c178bf49   # 某次的改动的修改记录  git log -p c178bf49 # 某次的改动的修改记录  git blame 文件名     # 显示文件的每一行是在那个版本最后修改。  git whatchanged 文件名  # 显示某个文件的每个版本提交信息：提交日期，提交人员，版本号，提交备注（没有修改细节）</code></pre><h3 id="打造自己的git命令"><a href="#打造自己的git命令" class="headerlink" title="打造自己的git命令"></a>打造自己的git命令</h3><pre><code>git config --global alias.st statusgit config --global alias.br branchgit config --global alias.co checkoutgit config --global alias.ci commit</code></pre><p>配置好后再输入git命令的时候就不用再输入一大段了，例如我们要查看状态，只需：</p><pre><code>git st</code></pre><h3 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h3><pre><code>git help *  # 获取命令的帮助信息  git status  # 获取当前的状态，非常有用，因为git会提示接下来的能做的操作</code></pre><h3 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h3><ol><li><code>git fatal: protocol error: bad line length character: No s</code> 解决办法：更换remote地址为 <code>http/https</code> 的</li><li><code>The requested URL returned error: 403 Forbidden while accessing</code>解决github push错误的办法</li></ol><p>解决方案：</p><pre><code>#vim 编辑器打开 当前项目中的config文件vim .git/config#修改[remote &quot;origin&quot;]      url = https://github.com/jaywcjlove/example.git  #为下面代码[remote &quot;origin&quot;]      url = https://jaywcjlove@github.com/jaywcjlove/example.git</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>你所不知道的 Console</title>
      <link href="/web-console-notes.html"/>
      <url>/web-console-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="1-凡人视角"><a href="#1-凡人视角" class="headerlink" title="1.凡人视角"></a>1.凡人视角</h3><h4 id="打印字符串"><a href="#打印字符串" class="headerlink" title="打印字符串"></a>打印字符串</h4><p>代码：</p><pre><code>console.log(&quot;I am a 凡人&quot;);</code></pre><h4 id="打印提示消息"><a href="#打印提示消息" class="headerlink" title="打印提示消息"></a>打印提示消息</h4><p>代码：</p><pre><code>console.info(&quot;Yes, you arm a 凡人&quot;);</code></pre><h4 id="打印警告消息"><a href="#打印警告消息" class="headerlink" title="打印警告消息"></a>打印警告消息</h4><p>代码：</p><pre><code>console.warn(&quot;凡人你居然敢窥视我&quot;);</code></pre><h4 id="打印错误消息"><a href="#打印错误消息" class="headerlink" title="打印错误消息"></a>打印错误消息</h4><p>代码：</p><pre><code>console.error(&quot;天兵天将，把这个凡人给我打入地狱&quot;);</code></pre><h4 id="打印调试信息"><a href="#打印调试信息" class="headerlink" title="打印调试信息"></a>打印调试信息</h4><pre><code>console.debug(&quot;我就是传说中的debug&quot;);</code></pre><h3 id="2-上帝视角"><a href="#2-上帝视角" class="headerlink" title="2.上帝视角"></a>2.上帝视角</h3><h4 id="查看所有方法"><a href="#查看所有方法" class="headerlink" title="查看所有方法"></a>查看所有方法</h4><p><code>console</code> 除了上面的几个方法还有什么方法呢？<code>log</code> 除了能打印字符串外，还能打印出对象，我们可以利用 <code>console.log</code> 打印自己。</p><p>代码：</p><pre><code>console.log(console);</code></pre><p>输出：</p><pre><code>Object {    assert: ...,    clear: ...,    count: ...,    debug: ...,    dir: ...,    dirxml: ...,    error: ...,    group: ...,    groupCollapsed: ...,    groupEnd: ...,    info: ...,    log: ...,    markTimeline: ...,    profile: ...,    profileEnd: ...,    table: ...,    time: ...,    timeEnd: ...,    timeStamp: ...,    timeline: ...,    timelineEnd: ...,    trace: ...,    warn: ...}</code></pre><p>啊咧咧？怎么这么多方法。其实上面的 <code>console</code> 方法 <code>不一定每个浏览器</code> 都有实现，我这边使用的是 <code>chrome浏览器</code> 。所以说，这个特性是非标准的，请尽量不要在 <code>生产环境</code> 中使用它。</p><p>但是我们可以在 <code>开发环境</code> 中，<code>合理的利用</code> 这些方法来帮助我们开发。</p><h4 id="清理控制台"><a href="#清理控制台" class="headerlink" title="清理控制台"></a>清理控制台</h4><p>如果我们在控制台调试的时候，难免 <code>强迫症</code> 发作想清理掉已经乱七八糟的控制台。浏览器和命令行 <code>clear</code> 一样提供了一个清理函数 <code>console.clear()</code> 。</p><pre><code>console.clear()</code></pre><p>当然我们也可以用 <code>chrome</code> 的 <code>command line api</code> 来清理控制台。</p><pre><code>clear()</code></pre><p>又或者可以使用按键Mac上 <code>cmd + k</code> ，Win <code>ctrl + l</code>（我用的是<code>chrome浏览器</code>）。</p><h4 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h4><p>当代码非常长，或者我们需要把一个函数，或者一个文件中的函数等区分出来。我们可以使用分组来实现。</p><p>代码：</p><pre><code>console.group(&apos;凡人&apos;);console.log(&quot;手&quot;);console.log(&quot;脚&quot;);console.groupEnd();console.group(&apos;神&apos;);console.log(&quot;法力无边&quot;);console.log(&quot;腾云架雾&quot;);console.groupEnd();</code></pre><p>输出：</p><p><img src="https://segmentfault.com/img/bVCmKx" alt></p><p>如果想要输出为折叠，我们可以使用 <code>console.groupCollapsed</code> ，用法和 <code>console.group</code> 类似。</p><h4 id="查看对象信息"><a href="#查看对象信息" class="headerlink" title="查看对象信息"></a>查看对象信息</h4><p>有时候我们需要打印出对象信息,可以使用 <code>console.log</code> 来进行简单的输出。</p><p>代码：</p><pre><code>var person = {    head: 1,    hand: 2,    leg: 2};console.log(person);</code></pre><p>呜呜，可是这个显示得好丑，我们这个时候就可以使用传说中的神器 <code>console.table</code> 来帮助我们清楚的显示 <code>关联数组信息</code>。</p><pre><code>var data = [    {        &apos;姓名&apos;: &apos;幼儿园&apos;,         &apos;性别&apos;: &apos;女&apos;    },    {        &apos;姓名&apos;: &apos;李狗嗨&apos;,        &apos;数量&apos;: 1    }];console.table(data);</code></pre><p>输出：</p><p><img src="https://segmentfault.com/img/bVCmKK" alt></p><p>但是如果想要看详细的对象信息，我们可以使用 <code>console.dir</code>，将一个 <code>JavaScript</code> 对象的所有属性和属性值显示成一个可交互的列表，它还能打印出函数等。</p><pre><code>console.dir(clear);</code></pre><p>什么？你想看某个节点中的html代码？没事，我们可以用 <code>console.dirxml</code> 来查看页面中对应元素的 <code>html/xml</code> 内容。</p><p>html代码：</p><pre><code>&lt;div id=&apos;person&apos;&gt;    &lt;p&gt;I am a 凡人&lt;/p&gt;&lt;/div&gt;</code></pre><p>javascirpt代码：</p><pre><code>var person = document.getElementById(&apos;person&apos;);console.dirxml(person)；</code></pre><h4 id="性能测试"><a href="#性能测试" class="headerlink" title="性能测试"></a>性能测试</h4><p>雷军粑粑老是喜欢说：“不服？跑个分。”有时候，我们也需要对代码跑个分。这个时候，我们可以使用<code>console.time</code>和<code>console.timeEnd</code>，他们可以记录代码运行所花费的时间。</p><pre><code>console.time(&quot;神机妙算&quot;);(function () {    for(var i = 0; i &lt; 10; i++) {        var sum = (function () {            var flog = 0;            for(var i = 0; i &lt; 10; i++) {                flog+=i;            }        })();    }})();console.timeEnd(&quot;神机妙算&quot;);</code></pre><p>啊咧咧？你这个顶多就是 <code>计时器</code> 怎么能说是 <code>性能测试</code> 。客官别急，我们这还有一个叫做 <code>console.profile</code> 和 <code>console.profileEnd</code> 姐妹呢~~</p><pre><code>console.profile(&quot;神机妙算&quot;);(function () {    for(var i = 0; i &lt; 10; i++) {        var sum = (function () {            var flog = 0;            for(var i = 0; i &lt; 10; i++) {                flog+=i;            }        })();    }})();console.profileEnd(&quot;神机妙算&quot;);</code></pre><p>输出会显示在 <code>profile</code></p><p><img src="https://segmentfault.com/img/bVCmKN" alt></p><p>什么还是不够？你还想知道运行时的结果栈？可以可以，我们这还有一位 <code>console.trace</code> 哦。他可以看透大爷你的一局一动哦。 代码：</p><pre><code>function add(num) {    if (0 &lt; num) {        console.trace(&quot;现在num的值为&quot;, num);        return num + add(num - 1);    } else {        return 0;    }}var a =3;add(3);</code></pre><p>输出：</p><p><img src="https://segmentfault.com/img/bVCmKS" alt></p><h4 id="判断真假"><a href="#判断真假" class="headerlink" title="判断真假"></a>判断真假</h4><p>平时我们在写代码是时候，经常需要判断一下当前值的真假情况，使用if或者三元表达式来达到目的。我们现在也可以使用 <code>console.assert</code> 来判断，该方法会在条件为错误时，返回一个 <code>console.error</code> 的输出。</p><pre><code>console.assert(1 == 1);console.assert(1 == 0);console.assert(!(1 == 0));</code></pre><h4 id="统计次数"><a href="#统计次数" class="headerlink" title="统计次数"></a>统计次数</h4><p>有时候我们需要统计一个函数或者被调用了几次，我们通常会增加一个变量 <code>count</code> 来记录，然后在控制台中查看。这样相当的麻烦，我们可以使用 <code>console.count</code> 函数来帮忙我们记录次数，并输出。</p><pre><code>function hi(name) {    console.count(name);    return &quot;hi &quot; + name;}for(var i = 0; i &lt; 10; i++) {    if(i &lt; 4) {        hi(&quot;person&quot;);    } else {        hi(&quot;god&quot;);    }}</code></pre><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><code>console</code> 中有很多对我们调试代码有帮助的函数，我们可以在开发环境中配合 <code>console</code> 来调试代码，使得我们测试更加便利。</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>[已停更]WordPress Theme AkinaPro 使用说明教程</title>
      <link href="/wordpress-theme-akinapro-tutorial.html"/>
      <url>/wordpress-theme-akinapro-tutorial.html</url>
      
        <content type="html"><![CDATA[<h1 id="本主题已停更，不再维护！"><a href="#本主题已停更，不再维护！" class="headerlink" title="本主题已停更，不再维护！"></a>本主题已停更，不再维护！</h1><h3 id="主题简介"><a href="#主题简介" class="headerlink" title="主题简介"></a>主题简介</h3><p>AkinaPro是基于<a href="http://www.akina.pw/archives/22" target="_blank" rel="noopener">Akina</a>上增强修改而来，在原有的基础上添加一些相对实用的功能以及SEO的增强性功能。</p><p>感谢原作者授权。</p><h3 id="主题信息"><a href="#主题信息" class="headerlink" title="主题信息"></a>主题信息</h3><p>原主题发布地址：<a href="http://www.akina.pw/archives/22" target="_blank" rel="noopener">Akina</a></p><p>原主题作者：<a href="http://www.akina.pw/" target="_blank" rel="noopener">Akina</a></p><p>主题发布地址：<a href="https://iiong.com/wordpress-theme-akinapro-tutorial.html" target="_blank" rel="noopener">苏城一只猫</a></p><p>原主题作者：<a href="https://iiong.com/" target="_blank" rel="noopener">苏城一只猫</a></p><p>标签： 文艺青年、二逼青年、逗逼青年、极客者、热爱生活者、唯美、简约</p><h3 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h3><p>zip文件上传到主题或者FTP上传</p><h3 id="使用教程"><a href="#使用教程" class="headerlink" title="使用教程"></a>使用教程</h3><blockquote><p>文章页面作者信息头像一直显示<code>蓝色背景白色G字</code>的图像怎么办？</p></blockquote><p>AkinaPro 2.1.0支持头像更换，请尽快更新2.1.0版本以上，谢谢！老版本请到<a href="http://cn.gravatar.com/" target="_blank" rel="noopener">Gravatar</a>官网绑定你的邮箱更新上传图像。</p><blockquote><p>编辑文章时候，下面有个Markdown是什么？</p></blockquote><p>请<a href="https://www.baidu.com/s?wd=Markdown" target="_blank" rel="noopener">百度一下</a>，语法可以到上述的搜索结果学习，本文就是使用Markdown语法编写而来的。Markdown让你更加注重编写文章，而不去关心调整那些杂乱的HTML各种语法。</p><blockquote><p>如何实现本站的二级菜单显示？</p></blockquote><p>如题设置<img src="https://res.i95.me/wp-content/uploads/2016/10/QQ%E6%88%AA%E5%9B%BE20161020181722.png" alt><br>图中的<code>目录</code>和<code>其它</code>是自定义链接，记得要删除链接！</p><blockquote><p>如何实现图片灯箱效果</p></blockquote><p>代码形式：</p><pre><code>&lt;a href=&quot;你的图片链接&quot;&gt;&lt;img src=&quot;你的图片链接&quot; alt=&quot;图片描述&quot;&gt;&lt;/a&gt;</code></pre><p>试试点击图片是不是生效了~</p><blockquote><p>网站支持Nginx fastcgi_cache缓存加速，使用七牛CDN报”E502″的错误怎么办？</p></blockquote><p>修改你的js/functions.js文件，搜索：</p><pre><code>;js_url=js_url.replace(&apos;res.i95.me&apos;,&apos;iiong.com&apos;)</code></pre><p>搜到这段代码，先把注释去掉，修改相关网址，res.i95.me是七牛的CDN网址，iiong.com是你的网站网址。</p><blockquote><p>目录如何实现和首页一样的文章列表模式而不是图片展示模式？</p></blockquote><p>先到你的后台-主题设置-高级设置-作品页面-打勾的就是图像列表模式，不打勾是文章列表模式，必须有一个打勾，才能满足以上的条件！</p><blockquote><p>语法高亮支持：</p></blockquote><p>HTML：</p><pre><code>&lt;pre class=&quot;language-java&quot;&gt;code_here&lt;/pre&gt;</code></pre><p>language-java是语法语言</p><p>Markdown：</p><pre><code>```javacode_herejava是语法语言&gt; 高亮语法库本主题默认集成以下语言：</code></pre><p>markup,css,clike,javascript,git,go,jade,java,json,less,markdown,nginx,php,powershell,python,sass,scss,sql<br>功能上就一个高亮</p><pre><code>若想要添加其他语言，以及功能(行数，语法类型显示等)请到[Prism官网](http://prismjs.com/download.html)添加相关功能后替换本主题的prism文件夹下的prism.css/prism.js。&gt; 其它若有其他问题，请加群(群号已更新)咨询，谢谢！  [![GayPyMod](//pub.idqqimg.com/wpa/images/group.png &quot;GayPyMod&quot;)](//shang.qq.com/wpa/qunwpa?idkey=73192933f070c1d732902bb6a0d84815af9c9c486e9f2d73f907620653c6f344)### 主题下载稳定版(支持WP后台更新)：[点击下载](https://iiong.com/wp-upload/themes/AkinaPro.zip)实时开发版：[点击下载](https://coding.net/u/JaxsonWang/p/AkinaPro/git/archive/master)注：实时开发版可能让你博客不稳定，建议使用稳定版。Coding地址：[点击下载](https://coding.net/u/JaxsonWang/p/AkinaPro/git)### 其他说明本主题是长期支持(Long-Term Support)，稳定是9天~15天更新一次(没有意外的话)，长期更新3年~5年。</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>站点在Android 5.0下Chrome的App Bar颜色定制</title>
      <link href="/theme-color-for-chrome-on-lollipop.html"/>
      <url>/theme-color-for-chrome-on-lollipop.html</url>
      
        <content type="html"><![CDATA[<h3 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h3><p>在 Android 5.0 中, 原先的最近任务(Recents)界面被概览(Overview)界面替换了,同时新的 Chrome 支持通过读取网页的某个HTML标签来改变 Overview 界面里 App Bar 的颜色，同时影响了 Chrome 内的toolbar/statusbar颜色。</p><h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p>Overview是Android 4.0时代提供的API，overview screen通常也指最近画面，最近任务表，或者是最近app，它是一个显示最近使用的activitys和tasks的系统级UI。用户可以通过它进行应用导航，或者是选择一个task进行resume，当然也可以将一个task或者是activity从该列表中移除，通常一个activity里面会包含多个事件，故一个Activity中会有多个文件（document）以task的形式出现在overview screen中</p><p>在 Android L 中，系统将直接开启 Overview（概览）菜单，该页面不仅显示最近使用的应用程序，还包括浏览器标签，用户可以直接进入某一个特定标签，而无需打开浏览器再来选择标签，</p><h3 id="Overview-对比-Recent"><a href="#Overview-对比-Recent" class="headerlink" title="Overview 对比 Recent"></a>Overview 对比 Recent</h3><ol><li>Android 5.0 的 Material Design 引入了深度的的感念，通过纸张在background上阴影范围的改变，表现出纸张在Z轴上的深度，纸与纸之间在Z轴空间上可以产生重叠，在Overview中通过字的层叠可以展现出更多的内容。</li><li>Overview中卡片的App Bar可以跟随应用改变颜色增加了应用的识别度. 而 4.X Recents 界面里的缩略图识别度其实很低, 的大部分时候还是要靠图标和标题。</li><li>在 5.0 中, 卡片的存在使得整个多任务列表可以被拉到屏幕2/3高度,最上面的一张卡片可以触及的范围甚至达到了屏幕的下半部分,可以直接单手触到</li></ol><h3 id="新特性"><a href="#新特性" class="headerlink" title="新特性"></a>新特性</h3><ol><li>同时在 5.0 中, Document UI 允许一个应用同时显示多个界面在 Overview 中 (如 Chrome 的多个标签页),如下图：Google Drive 中多个 document 组成一个task呈现在 overview screen中</li><li>新的 Chrome 和 Chrome Beta 都支持通过读取网页的某个 HTML 标签来改变 Overview 界面里 App Bar 的颜色，这对于增加网页/Web App 的辨识度而言产生了极大的帮助</li><li>如果你细心的话, 会注意到知乎 Alpha 和 Google Wallet 在 Overview 里显示的图标和他们的应用图标不一样. 这就是 Overview 的一个新特性, 我们可以自定义显示在 Overview 里的图标</li><li>可以修改在 Overview 中显示不同的 Title —— 比如说,在知乎中 当你在阅读答案时, 进入 Overview 界面, 知乎显示的标题就是 回答, 如果你在某个人的个人主页,那么在 Overview 里知乎的标题就是这个人的名字</li></ol><h3 id="修改网页App-Bar颜色"><a href="#修改网页App-Bar颜色" class="headerlink" title="修改网页App Bar颜色"></a>修改网页App Bar颜色</h3><p>只要满足以下条件，即可定义 Overview App Bar 颜色，同时也影响了 Chrome 内的 toolbar / statusbar 颜色。</p><ol><li>系统要求 Android 5.0 以上</li><li>未开启“合并标签页和应用” 的 Chrome 39 以上</li><li>在网站<code></code>中添加自定义主题颜色<code>&lt;meta name=&quot;theme-color&quot; content=&quot;#262a30&quot;&gt;</code></li></ol>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react-router 按需加载</title>
      <link href="/react-router-load-on-demand.html"/>
      <url>/react-router-load-on-demand.html</url>
      
        <content type="html"><![CDATA[<p>React Router 是一个非常出色的路由解决方案，同时也非常容易上手。但是当网站规模越来越大的时候，首先出现的问题是 Javascript 文件变得巨大，这导致首页渲染的时间让人难以忍受。实际上程序应当只加载当前渲染页所需的 JavaScript，也就是大家说的“代码分拆” — 将所有的代码分拆成多个小包，在用户浏览过程中按需加载。</p><p>官方示例在 <a href="https://github.com/ReactTraining/react-router/tree/master/examples/huge-apps" target="_blank" rel="noopener">这里</a>。</p><p>所得到的效果是：</p><p>以前是这样（23333，我真不是故意的。。）</p><p><img src="https://segmentfault.com/image?src=http://7xo08n.com1.z0.glb.clouddn.com/blog/react-router-dynamic/01.png&amp;objectId=1190000007141049&amp;token=8803a4391b64a7c96ac72514ed942162" alt></p><p>现在是这样：</p><p><img src="https://segmentfault.com/image?src=http://7xo08n.com1.z0.glb.clouddn.com/blog/react-router-dynamic/02.png&amp;objectId=1190000007141049&amp;token=5b11e129cfae5b8ea43f759e49812692" alt></p><p>实际上就是将一个大 javascript 文件拆分成了若干个 chunk file。</p><p>下面是改造过程</p><h2 id="Webpack-配置"><a href="#Webpack-配置" class="headerlink" title="Webpack 配置"></a>Webpack 配置</h2><p>首先在 <code>webpack.config.js</code> 的 <code>output</code> 内加上 <code>chunkFilename</code></p><pre><code>output: {    path: path.join(__dirname, &apos;/../dist/assets&apos;),    filename: &apos;app.js&apos;,    publicPath: defaultSettings.publicPath,    // 添加 chunkFilename    chunkFilename: &apos;[name].[chunkhash:5].chunk.js&apos;,},</code></pre><p><code>name</code> 是在代码里为创建的 chunk 指定的名字，如果代码中没指定则 webpack 默认分配 id 作为 name。</p><p><code>chunkhash</code> 是文件的 hash 码，这里只使用前五位。</p><h2 id="添加首页"><a href="#添加首页" class="headerlink" title="添加首页"></a>添加首页</h2><p>以前你的路由大概应该是这样的：（作为需要按需加载的大型应用，路由肯定是相当复杂，这里只列举部分路由举例）</p><pre><code>ReactDOM.render(  (    &lt;Router history={browserHistory}&gt;      {/* 主页 */}      &lt;Route path=&quot;/&quot; component={App}&gt;        {/* 默认 */}        &lt;IndexRoute component={HomePage} /&gt;        {/* baidu */}        &lt;Route path=&quot;/baidu&quot; component={BaiduPage}&gt;          &lt;Route path=&quot;result&quot; component={BaiduResultPage} /&gt;          &lt;Route path=&quot;frequency&quot; component={BaiduFrequencyPage} /&gt;        &lt;/Route&gt;        {/* 404 */}        &lt;Route path=&apos;/404&apos; component={NotFoundPage} /&gt;        {/* 其他重定向到 404 */}        &lt;Redirect from=&apos;*&apos; to=&apos;/404&apos; /&gt;      &lt;/Route&gt;    &lt;/Router&gt;  ), document.getElementById(&apos;app&apos;));</code></pre><p>按需加载之后，我们需要让路由动态加载组件，需要将 <code>component</code> 换成 <code>getComponent</code>。首先将路由拆出来（因为路由庞大之后全部写在一起会很难看），创建一个根路由 rootRoute：</p><pre><code>const rootRoute = {  path: &apos;/&apos;,  indexRoute: {    getComponent(nextState, cb) {      require.ensure([], (require) =&gt; {        cb(null, require(&apos;components/layer/HomePage&apos;))      }, &apos;HomePage&apos;)    },  },  getComponent(nextState, cb) {    require.ensure([], (require) =&gt; {      cb(null, require(&apos;components/Main&apos;))    }, &apos;Main&apos;)  },  childRoutes: [    require(&apos;./routes/baidu&apos;),    require(&apos;./routes/404&apos;),    require(&apos;./routes/redirect&apos;)  ]}ReactDOM.render(  (    &lt;Router      history={browserHistory}      routes={rootRoute}      /&gt;  ), document.getElementById(&apos;app&apos;));</code></pre><p>history 不变，在 Router 中添加 routes 属性，将创建的路由传递进去。</p><p>这里有四个属性：</p><h3 id="path"><a href="#path" class="headerlink" title="path"></a>path</h3><p>将匹配的路由，也就是以前的 path。</p><h3 id="getComponent"><a href="#getComponent" class="headerlink" title="getComponent"></a>getComponent</h3><p>对应于以前的 component 属性，但是这个方法是异步的，也就是当路由匹配时，才会调用这个方法。</p><p>这里面有个 <strong>require.ensure</strong> 方法</p><pre><code>require.ensure(dependencies, callback, chunkName)</code></pre><p>这是 webpack 提供的方法，这也是按需加载的核心方法。第一个参数是依赖，第二个是回调函数，第三个就是上面提到的 chunkName，用来指定这个 chunk file 的 name。</p><p>如果需要返回多个子组件，则使用 <code>getComponents</code> 方法，将多个组件作为一个对象的属性通过 <code>cb</code> 返回出去即可。这个在官方示例也有，但是我们这里并不需要，而且根组件是不能返回多个子组件的，所以使用 <code>getComponent</code>。</p><h3 id="indexRoute"><a href="#indexRoute" class="headerlink" title="indexRoute"></a>indexRoute</h3><p>用来设置主页，对应于以前的 <code>&lt;IndexRoute&gt;</code>。</p><p>注意这里的 indexRoute 写法， <strong>这是个对象，在对象里面使用 getComponent</strong>。</p><h3 id="childRoutes"><a href="#childRoutes" class="headerlink" title="childRoutes"></a>childRoutes</h3><p>这里面放置的就是子路由的配置，对应于以前的子路由们。我们将以前的 <code>/baidu</code>、<code>/404</code> 和 <code>*</code> 都拆了出来，接下来将分别为他们创建路由配置。</p><h2 id="路由控制"><a href="#路由控制" class="headerlink" title="路由控制"></a>路由控制</h2><p>上面的<code>childRoutes</code> 里面，我们 require 了三个子路由，在目录下创建 <code>routes</code> 目录，将这三个路由放置进去。</p><pre><code>routes/├── 404│   └── index.js├── baidu│   ├── index.js│   └── routes│       ├── frequency│       │   └── index.js│       └── result│           └── index.js└── redirect    └── index.js</code></pre><p>和 rootRoute 类似，里面的每个 index.js 都是一个路由对象：</p><h3 id="404-index-js"><a href="#404-index-js" class="headerlink" title="/404/index.js"></a>/404/index.js</h3><pre><code>module.exports = {  path: &apos;404&apos;,  getComponent(nextState, cb) {    require.ensure([], (require) =&gt; {      cb(null, require(&apos;components/layer/NotFoundPage&apos;))    }, &apos;NotFoundPage&apos;)  }}</code></pre><h3 id="baidu-index-js"><a href="#baidu-index-js" class="headerlink" title="/baidu/index.js"></a>/baidu/index.js</h3><pre><code>module.exports = {  path: &apos;baidu&apos;,  getChildRoutes(partialNextState, cb) {    require.ensure([], (require) =&gt; {      cb(null, [        require(&apos;./routes/result&apos;),        require(&apos;./routes/frequency&apos;)      ])    })  },  getComponent(nextState, cb) {    require.ensure([], (require) =&gt; {      cb(null, require(&apos;components/layer/BaiduPage&apos;))    }, &apos;BaiduPage&apos;)  }}</code></pre><h3 id="baidu-routes-frequency-index-js"><a href="#baidu-routes-frequency-index-js" class="headerlink" title="/baidu/routes/frequency/index.js"></a>/baidu/routes/frequency/index.js</h3><pre><code>module.exports = {  path: &apos;frequency&apos;,  getComponent(nextState, cb) {    require.ensure([], (require) =&gt; {      cb(null, require(&apos;components/layer/BaiduFrequencyPage&apos;))    }, &apos;BaiduFrequencyPage&apos;)  }}</code></pre><p>举这几个例子应该就差不多了，其他都是一样的，稍微有点特别的是 redirect。</p><h2 id="设置-Redirect"><a href="#设置-Redirect" class="headerlink" title="设置 Redirect"></a>设置 Redirect</h2><p>之前我们在根路由下是这么设置重定向的：</p><pre><code>&lt;Router history={browserHistory}&gt;      &lt;Route path=&quot;/&quot; component={App}&gt;        {/* home */}        &lt;IndexRoute component={HomePage} /&gt;        &lt;Route path=&quot;/baidu&quot; component={BaiduPage}&gt;          &lt;Route path=&quot;result&quot; component={BaiduResultPage} /&gt;          &lt;Route path=&quot;frequency&quot; component={BaiduFrequencyPage} /&gt;        &lt;/Route&gt;        &lt;Route path=&apos;/404&apos; component={NotFoundPage} /&gt;        {/* 如果都不匹配，重定向到 404 */}        &lt;Redirect from=&apos;*&apos; to=&apos;/404&apos; /&gt;      &lt;/Route&gt;    &lt;/Router&gt;</code></pre><p>当改写之后，我们需要把这个重定向的路由单独拆出来，也就是 <code>*</code> 这个路由，我们上面已经为他创建了一个 <code>redirect</code> 目录。这里使用到 onEnter 方法，然后在这个方法里改变路由状态，调到另外的路由，实现 redirect ：</p><h3 id="redirect-index-js"><a href="#redirect-index-js" class="headerlink" title="/redirect/index.js"></a>/redirect/index.js</h3><pre><code>module.exports = {  path: &apos;*&apos;,  onEnter: (_, replaceState) =&gt; replaceState(null, &quot;/404&quot;)}</code></pre><h2 id="The-root-route-must-render-a-single-element"><a href="#The-root-route-must-render-a-single-element" class="headerlink" title="The root route must render a single element"></a>The root route must render a single element</h2><p>跟着官方示例和上面码出来之后，可能页面并没有渲染出来，而是报 <strong>The root route must render a single element</strong> 这个异常，这是因为 <code>module.exports</code> 和 ES6 里的 <code>export default</code> 有区别。</p><p>如果你是使用 es6 的写法，也就是你的组件都是通过 <code>export default</code> 导出的，那么在 <code>getComponent</code> 方法里面需要加入 <code>.default</code>。</p><pre><code>getComponent(nextState, cb) {    require.ensure([], (require) =&gt; {      // 在后面加 .default      cb(null, require(&apos;components/layer/ReportPage&apos;)).default    }, &apos;ReportPage&apos;)}</code></pre><p>如果你是使用 CommonJS 的写法，也就是通过 <code>module.exports</code> 导出的，那就无须加 <code>.default</code> 了。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ReactJS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IntelliJ IDEA 注册码</title>
      <link href="/intellij-idea-warrant.html"/>
      <url>/intellij-idea-warrant.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>书签中有几个授权服务器都过时了，听说被官方封了？好怕怕，吓得我赶紧自己搭建个。</p><h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><ol><li>授权服务器理论支持的版本有</li><li>IntelliJ IDEA 7.0 或更高</li><li>ReSharper 3.1 或更高</li><li>ReSharper Cpp 1.0 或更高</li><li>dotTrace 5.5 或更高</li><li>dotMemory 4.0 或更高</li><li>dotCover 1.0 或更高</li><li>RubyMine 1.0 或更高</li><li>PyCharm 1.0 或更高</li><li>WebStorm 1.0 或更高</li><li>PhpStorm 1.0 或更高</li><li>AppCode 1.0 或更高</li><li>CLion 1.0 或更高</li></ol><h3 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h3><p><img src="https://res.i95.me/wp-content/uploads/2016/10/idea-1.png" alt></p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/idea-2.png" alt></p><h3 id="授权地址"><a href="#授权地址" class="headerlink" title="授权地址"></a>授权地址</h3><p><a href="https://idea.i95.me" target="_blank" rel="noopener">https://idea.i95.me</a></p><p>低调使用，么么哒…</p><p>维护服务器不易，欢迎捐赠😂😂😂支付宝帐号：<a href="mailto:wangjin@boxrom.com" target="_blank" rel="noopener">wangjin@boxrom.com</a></p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Nginx如何设置域名301重定向</title>
      <link href="/nginx-301-rewrite.html"/>
      <url>/nginx-301-rewrite.html</url>
      
        <content type="html"><![CDATA[<h3 id="修改域名配置文件"><a href="#修改域名配置文件" class="headerlink" title="修改域名配置文件"></a>修改域名配置文件</h3><pre><code>省略虚拟主机server配置server {listen 80;server_name www.;return 301 http:$request_uri;}</code></pre><p>如果是想让http强制跳转到https，把里面的http换成https就行。 例：</p><pre><code>server {listen 443 ssl;server_name www.lnmp.org;省略其他配置}server {listen 80;server_name ;return 301 https:$request_uri;}</code></pre><p>添加完成后保存，执行：/etc/init.d/nginx restart 重启nginx，使其生效</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.JS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>利用Nginx fastcgi_cache缓存对WordPress博客进行加速修复版</title>
      <link href="/nginx-fastcgi-cache-acceleration-of-wordpress-prefect.html"/>
      <url>/nginx-fastcgi-cache-acceleration-of-wordpress-prefect.html</url>
      
        <content type="html"><![CDATA[<p>在<a href="http://https:/nginx-fastcgi_cache-acceleration-of-wordpress.html" target="_blank" rel="noopener">原文</a>修改配置文件。 nginx.conf配置文件添加：</p><pre><code>    fastcgi_cache_path /tmp/wpcache levels=1:2 keys_zone=WORDPRESS:250m inactive=1d max_size=5G;    fastcgi_temp_path /tmp/temp/;    fastcgi_cache_key &quot;$scheme$request_method$host$request_uri&quot;;    fastcgi_cache_use_stale error timeout invalid_header http_500;    fastcgi_ignore_headers Cache-Control Expires Set-Cookie;server    {        listen 80;        #请修改为自己的域名        server_name ;        index index.html index.htm index.php default.html default.htm default.php;        #请修改为自己网站的存放路径        root  /data/wwwroot/;        set $skip_cache 0;        #post访问不缓存        if ($request_method = POST) {            set $skip_cache 1;        }           #动态查询不缓存        if ($query_string != &quot;&quot;) {            set $skip_cache 1;        }           #后台等特定页面不缓存（其他需求请自行添加即可）        if ($request_uri ~* &quot;/wp-admin/|/xmlrpc.php|wp-.*.php|/feed/|index.php|sitemap(_index)?.xml&quot;) {            set $skip_cache 1;        }           #对登录用户、评论过的用户不展示缓存（这个规则张戈博客并没有使用，所有人看到的都是缓存）        if ($http_cookie ~* &quot;comment_author|wordpress_[a-f0-9]+|wp-postpass|wordpress_no_cache|wordpress_logged_in&quot;) {            set $skip_cache 1;        }        #这里请参考你网站之前的配置，特别是sock的路径，弄错了就502了！        location ~ [^/]\.php(/|$)            {                try_files $uri =404;                fastcgi_pass  unix:/tmp/php-cgi.sock;                fastcgi_index index.php;                include fastcgi.conf;                  #新增的缓存规则                fastcgi_cache_bypass $skip_cache;                fastcgi_no_cache $skip_cache;                add_header X-Cache &quot;$upstream_cache_status From $host&quot;;                fastcgi_cache WORDPRESS;                fastcgi_cache_valid 200 301 302 1d;        }        location / {                #此处可以添加自定义的伪静态规则（之前你新增的伪静态规则可以添加到这，没有就不用了）                try_files $uri $uri/ /index.php?$args;                rewrite /wp-admin$ $scheme://$host$uri/ permanent;         }        #缓存清理配置（可选模块，请细看下文说明）        location ~ /purge(/.*) {            allow 127.0.0.1;            allow &quot;此处填写你服务器的真实外网IP&quot;;            deny all;            fastcgi_cache_purge WORDPRESS &quot;$scheme$request_method$host$1&quot;;        }        location ~* ^.+\.(ogg|ogv|svg|svgz|eot|otf|woff|mp4|ttf|rss|atom|jpg|jpeg|gif|png|ico|zip|tgz|gz|rar|bz2|doc|xls|exe|ppt|tar|mid|midi|wav|bmp|rtf)$ {                access_log off; log_not_found off; expires max;        }        location = /robots.txt { access_log off; log_not_found off; }        location ~ /\. { deny  all; access_log off; log_not_found off; }        #请注意修改日志路径        access_log /data/wwwlogs/.log access;}</code></pre><p>我的.conf配置：</p><pre><code>server {    listen 80;    listen 443 ssl http2;    ssl_certificate /usr/local/nginx/conf/ssl/.crt;    ssl_certificate_key /usr/local/nginx/conf/ssl/.key;    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;    ssl_ciphers EECDH+CHACHA20:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5;    ssl_prefer_server_ciphers on;    ssl_session_timeout 10m;    ssl_session_cache builtin:1000 shared:SSL:10m;    ssl_buffer_size 1400;    add_header Strict-Transport-Security max-age=15768000;    ssl_stapling on;    ssl_stapling_verify on;    server_name  www.;    access_log /data/wwwlogs/_nginx.log combined;    index index.php index.htm index.html default.html default.htm default.php;    include /usr/local/nginx/conf/rewrite/wordpress.conf;    root /data/wwwroot/;    if ($ssl_protocol = &quot;&quot;) {        return 301 https://$host$request_uri;    }    if ($host != ) {        rewrite ^/(.*)$ $scheme:/$1 permanent;    }    set $skip_cache 0;    if ($request_method = POST) {        set $skip_cache 1;    }    if ($query_string != &quot;&quot;) {        set $skip_cache 1;    }    if ($request_uri ~* &quot;/wp-admin/|/xmlrpc.php|wp-.*.php|/feed/|index.php|sitemap(_index)?.xml&quot;) {        set $skip_cache 1;    }    if ($http_cookie ~* &quot;comment_author|wordpress_[a-f0-9]+|wp-postpass|wordpress_no_cache|wordpress_logged_in&quot;) {        set $skip_cache 1;    }    location ~ \.php$ {        try_files $uri =404;        #fastcgi_pass  unix:/tmp/php-cgi.sock;        fastcgi_pass  unix:/dev/shm/php-cgi.sock;        fastcgi_index index.php;        include fastcgi.conf;        fastcgi_cache_bypass $skip_cache;        fastcgi_no_cache $skip_cache;        add_header X-Cache &quot;$upstream_cache_status From $host&quot;;        fastcgi_cache WORDPRESS;        fastcgi_cache_valid 200 301 302 1d;    }    location ~ /purge(/.*) {        allow 127.0.0.1;        allow 外网IP;        deny all;        fastcgi_cache_purge WORDPRESS &quot;$scheme$request_method$host$1&quot;;    }    location ~* ^.+\.(ogg|ogv|svg|svgz|eot|otf|woff|mp4|ttf|rss|atom|jpg|jpeg|gif|png|ico|zip|tgz|gz|rar|bz2|doc|xls|exe|ppt|tar|mid|midi|wav|bmp|rtf)$ {        access_log off;        log_not_found off;        expires max;    }    location = /robots.txt {        access_log off;        log_not_found off;    }    location ~ /\. {        deny  all;        access_log off;        log_not_found off;    }}server {    server_name  www.;    rewrite ^/(.*)$ https:/$1 permanent;}</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WordPress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntu 16.10 Yakkety编译CyanogenMod 14(OnePlus 3)笔记</title>
      <link href="/building-cyanogenmod14-for-oneplus3.html"/>
      <url>/building-cyanogenmod14-for-oneplus3.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>原本计划前几周动手编译的，无奈事情太多了，没空折腾，正好这几天可以折腾玩玩。 系统是Ubuntu 16.10最新版，U盘引导安装上去的新系统。</p><h3 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h3><p>首先要保持系统组件最新版：</p><pre><code>sudo apt update</code></pre><p>有提示升级最新版本的组件：</p><pre><code>sudo apt upgrade -y</code></pre><p>安装编译环境所需要的组件：</p><pre><code>sudo apt install bison build-essential curl flex git gnupg libesd0-dev liblz4-tool libncurses5-dev libsdl1.2-dev libxml2 libxml2-utils lzop maven pngcrush schedtool squashfs-tools xsltproc zip zlib1g-dev bc ccache automake lzop gperf zlib1g-dev g++-multilib gcc-multilib lib32ncurses5-dev lib32readline6-dev lib32z1-dev python-networkx libxml2-utils bzip2 libbz2-dev libbz2-1.0 libghc-bzlib-dev squashfs-tools schedtool dpkg-dev liblz4-tool make optipng libwxgtk3.0-dev openjdk-8-jdk</code></pre><p>从Android7.0开始 JDK需要8.0以上，我尝试用JDK7.0去编译，会出现报错。 设置 Git 信息：</p><pre><code>git config --global user.name &quot;xxx_username&quot;git config --global user.email &quot;xxx_mail@gmail.com&quot;</code></pre><p>由于天朝特色防火墙的存在，请先准备好代理，同步源码。</p><h3 id="使用Sha-dow-socks-Privoxy打造Ubuntu下稳定的Android源码同步环境"><a href="#使用Sha-dow-socks-Privoxy打造Ubuntu下稳定的Android源码同步环境" class="headerlink" title="使用Sha#dow#socks+Privoxy打造Ubuntu下稳定的Android源码同步环境"></a>使用Sha#dow#socks+Privoxy打造Ubuntu下稳定的Android源码同步环境</h3><p>Linux安装Sha#dow#socks详细文档请参考：<a href="https://github.com/shadowsocks/shadowsocks-qt5/wiki/Installation" target="_blank" rel="noopener">Github Wiki</a></p><pre><code>sudo add-apt-repository ppa:hzwhuang/ss-qt5sudo apt updatesudo apt install sha#dow#socks-qt5</code></pre><p>然后通过Privoxy来将Sha#dow#socks的Socket转换成HTTP代理以便于git使用。</p><pre><code>sudo apt install privoxy</code></pre><p>Privoxy配置：</p><pre><code>sudo gedit /etc/privoxy/config</code></pre><p>内容最末尾另起一行输入： <code>forward-socks5 / 127.0.0.1:1080 .</code> 这里的1080看你自己的情况修改，不知道就默认吧。 启动Privoxy：</p><pre><code>sudo service privoxy restart</code></pre><p>使用代理同步源码先在终端输入：</p><pre><code>git config --global --add http.proxy 127.0.0.1:8118git config --global --add http.sslVerify false</code></pre><p>然后再执行相关Git clone等相关命令，当终端关闭重新再开的时候，需要重新执行以上的命令。</p><h3 id="同步源码"><a href="#同步源码" class="headerlink" title="同步源码"></a>同步源码</h3><blockquote><p>设置Repo：</p></blockquote><pre><code>mkdir -p ~/Android/{bin,CyanogenMod}curl https://storage.googleapis.com/git-repo-downloads/repo &gt; ~/Android/bin/repochmod a+x ~/Android/bin/repoecho &quot;export PATH=~/Android/bin:$PATH&quot; &gt;&gt; ~/.bashrcsource ~/.bashrc</code></pre><blockquote><p>同步CyanogenMod 14源码</p></blockquote><pre><code>cd ~/Android/CyanogenModrepo init -u https://github.com/CyanogenMod/android.git -b cm-14.0repo sync --force-sync -j8</code></pre><p>执行<code>repo sync --force-sync -j8</code>就可以同步源码了。如果网络很容易出现中断的现象，可以执行以下的脚本： 新建个sync.sh脚本：</p><pre><code>#!/bin/bashecho &quot;================start repo sync====================&quot;git config --global --add http.proxy 127.0.0.1:8118git config --global --add http.sslVerify falserepo sync --force-sync -j8while [ $? = 1 ]; doecho &quot;====================sync failed, re-sync again=======&quot;sleep 3git config --global --add http.proxy 127.0.0.1:8118git config --global --add http.sslVerify falserepo sync --force-sync -j8done</code></pre><p>执行：</p><pre><code>sh sync.sh</code></pre><blockquote><p>同步机型设备内核源码</p></blockquote><pre><code>mkdir ~/Android/CyanogenMod/.repo/local_manifestswget -P ~/Android/CyanogenMod/.repo/local_manifests https://raw.githubusercontent.com/BoxMod/device_local_manifests/master/cm14_oneplus3_local_manifests.xml ~/Android/CyanogenMod/.repo/local_manifests/local_manifests.xmlrepo sync --force-sync -j8</code></pre><p>OnePlus 3机型源码：</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;manifest&gt;  &lt;project name=&quot;CyanogenMod/android_device_oppo_common&quot; path=&quot;device/oppo/common&quot; remote=&quot;github&quot; revision=&quot;cm-14.0&quot; /&gt;  &lt;project name=&quot;CyanogenMod/android_device_qcom_common&quot; path=&quot;device/qcom/common&quot; remote=&quot;github&quot; revision=&quot;cm-14.0&quot; /&gt;  &lt;project name=&quot;TheMuppets/proprietary_vendor_oneplus&quot; path=&quot;vendor/oneplus&quot; remote=&quot;github&quot; revision=&quot;cm-14.0&quot; /&gt;  &lt;project name=&quot;CyanogenMod/android_device_oneplus_oneplus3&quot; path=&quot;device/oneplus/oneplus3&quot; remote=&quot;github&quot; revision=&quot;cm-14.0&quot; /&gt;  &lt;project name=&quot;CyanogenMod/android_kernel_oneplus_msm8996&quot; path=&quot;kernel/oneplus/msm8996&quot; remote=&quot;github&quot; revision=&quot;cm-14.0&quot; /&gt;  &lt;project name=&quot;CyanogenMod/android_external_sony_boringssl-compat&quot; path=&quot;external/sony/boringssl-compat&quot; remote=&quot;github&quot; revision=&quot;cm-14.0&quot; /&gt;  &lt;project name=&quot;CyanogenMod/android_external_stlport&quot; path=&quot;external/stlport&quot; remote=&quot;github&quot; revision=&quot;cm-14.0&quot; /&gt;  &lt;project name=&quot;CyanogenMod/android_vendor_nxp-nfc_opensource_Nfc&quot; path=&quot;vendor/nxp-nfc/opensource/Nfc&quot; remote=&quot;github&quot; revision=&quot;cm-14.0&quot; /&gt;  &lt;project name=&quot;CyanogenMod/android_vendor_nxp-nfc_opensource_frameworks&quot; path=&quot;vendor/nxp-nfc/opensource/frameworks&quot; remote=&quot;github&quot; revision=&quot;cm-14.0&quot; /&gt;  &lt;project name=&quot;CyanogenMod/android_vendor_nxp-nfc_opensource_libnfc-nci&quot; path=&quot;vendor/nxp-nfc/opensource/libnfc-nci&quot; remote=&quot;github&quot; revision=&quot;cm-14.0&quot; /&gt;  &lt;project name=&quot;TheMuppets/proprietary_vendor_qcom_binaries&quot; path=&quot;vendor/qcom/binaries&quot; remote=&quot;github&quot; revision=&quot;cm-14.0&quot; /&gt;&lt;/manifest&gt;</code></pre><h3 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h3><blockquote><p>启用缓存加速编译</p></blockquote><pre><code>cd ~/Android/CyanogenModexport USE_CCACHE=1prebuilts/misc/linux-x86/ccache/ccache -M 50G</code></pre><p>以下文档可以参考下：</p><blockquote><p>Set RAM for the building process</p></blockquote><p>This prevents any errors relating to memory overhead.</p><pre><code>cd ~/Android/CyanogenModexport JACK_SERVER_VM_ARGUMENTS=&quot;-Dfile.encoding=UTF-8 -XX:+TieredCompilation -Xmx4g&quot;./prebuilts/sdk/tools/jack-admin kill-server./prebuilts/sdk/tools/jack-admin start-server</code></pre><p>At the end of the second line, replace the ‘7’ with the number of GB of memory your linux machine has -1 GB. E.g. If your VM has 12GB of RAM, you’ll write 11GB like so:</p><pre><code>export JACK_SERVER_VM_ARGUMENTS=&quot;-Dfile.encoding=UTF-8 -XX:+TieredCompilation -Xmx11g&quot;</code></pre><blockquote><p>获取预编译的部分文件</p></blockquote><pre><code>cd ~/Android/CyanogenMod/vendor/cm./get-prebuilts</code></pre><blockquote><p>开始编译</p></blockquote><pre><code>cd ~/Android/CyanogenModsource build/envsetup.shbreakfast oneplus3brunch oneplus3</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>当程序员好处多多</title>
      <link href="/programmers-benefit.html"/>
      <url>/programmers-benefit.html</url>
      
        <content type="html"><![CDATA[<h3 id="当程序员好处多多"><a href="#当程序员好处多多" class="headerlink" title="当程序员好处多多"></a>当程序员好处多多</h3><hr><p>以前从没想过成为一个程序员。就这么一步步走过来了。回头看看也是挺有意思。</p><p>我从小痴迷于生物，尤对动物感兴趣，异宠类更甚。看过很多生物的书籍，图册，特别喜欢法国昆虫学家法布尔的《昆虫记》，自己也饲养过很多动物。</p><p>高中参加生物竞赛班，拿过生物竞赛市级奖项（当然并不算什么）。</p><p>高考毕业填报志愿时，原本报了生物工程，结果学院生物工程系对所在省只招收3个名额，自动被分配到信息工程。</p><p>曾一度讨厌编程，因为自己不会，没入门，就恐惧，逃避。</p><p>后来慢慢摸爬滚打，总算入了编程这个不好入的门。渐渐地，越来越喜欢编程了。</p><p>现在以编程为生，以编程自乐。”终我一生，始乱终不弃；生命不息，编程不止”。</p><p>除非以后有了高科技，可以代替我们编程。但总不忘敲几行代码，遥想一下“公瑾当年，弹指间，键盘灰飞烟灭”。</p><p>总结一些做程序员的好处，与广大程序员共勉，也给想从事或正在从事这一行业的小伙伴们以信心。</p><ul><li>每天都是新的开始：怎么说呢，很少有一个行业可以像程序员这样，每天都能学习新的东西。总是和同事聊起，说编程太有意思了，每天工作的内容和上一天都有不同，每天都能整点新玩意，自己凭兴趣学或者工作需要不得不学。而且现在新的编程语言经常在被发明，新的编程技术在被创造，新的科技又给了程序员无限的进步空间，什么无人机，物联网，3D打印，VR，AR，自动化，等等。”数风流人物，还看今朝”。</li><li>历练出耿直，坚韧不拔的品格：曾经我以为与活生生的动物打交道是很有意思的（小时候想做生物学家），但是没想到与一板一眼的机器打交道也是挺不错。我们的电脑永远忠诚，永远高效，永远真实，说一是一，绝不说零（因为电脑只认得0和1）。因此，长期对着呆萌可爱不说谎的电脑，怎么会不打造出同样呆萌，天真，无邪，正义的攻城狮呢？要说永不言弃的品格，那面对经常失败的程序，你肯定会练就的。</li><li>需求大于供给，不怕失业：程序员的市场不容易饱和，小到银行，大到国防部，都须要有程序员任职，负责网页，软件，等等。而且这个时代可以说是程序员的show time（“出风头之时”），现在的智能产品，哪一个不需要内嵌代码。在各国，程序员总是比较容易找工作，而且相对高薪。除了正式工作，还可以选择技术创业，或者做做项目，接点私活，赚些外快。</li><li>不容易得老年痴呆：要说头脑经过特殊训练的人群，程序员可以算其中之一。要知道，用编程语言来实现东西，思维的模式和一般是不一样的，因此编程可以开启我们大脑另一部分的潜能。只要编程学得好，那什么玩游戏，比如Dota什么的，那不是信手拈来，根本不需要动用多少脑细胞。而且经过Vim，Emacs这样的编辑器练手之后，对于快捷键极为熟练，你让我玩Dota之类的需要手速的游戏，分分钟记住里面英雄的快捷键，要我再用鼠标点技能，简直是不能忍。会编程之后，你会发现以前有些比较难的事情，现在“天空飘来五个字，都不是事儿”。所以，程序员大脑经常得到充分锻炼，患老年痴呆的概率大大下降。当然了, “青年痴呆”还是有可能的…</li><li>记忆力，英语水平，打字速度，都有提升：看了N多编程书籍，你好意思说自己记忆力没提升？编程里经常要用到英语词汇，而且好的编程资料都是英语写的，因此编程可以帮我们提高英语水平。打字速度，自然不用说，以前不会盲打的我，现在手机上输入文字都飞快。</li><li>多一项生活技能：谁家电脑不行了，手机，平板出了问题，网络连不上，机器不会配置，等等，还不得找你。在异地，不是问题，远程协助啊。当他们用“敬仰之情如滔滔江水连绵不绝”的眼神45度仰视你的时候，是不是觉得做程序员真的无限美好呢？</li><li>专一，不胡来，有耐心：因为长期面对电脑，培养了专一，单纯的品格，每天处理那么多程序，找那么多bug，耐心也是够够的。程序员较少会花心乱来，毕竟写一天程序，到了家里，最宝贝的就是另一半啦。</li><li>乐观，积极向上：每天面对很难的编程问题，数不尽的bug，必须陶冶出热爱生活，珍惜生命的可贵节操啊。</li><li>马上有对象：我们有面向对象编程，那生活中也必须要能解决自己的燃眉之急。前面的那么多优点，例如多金，呆萌，专一，再加上程序员挂得比较早，心仪的对象不是分分钟实例化给你？</li></ul><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><hr><p>还有很多，希望大家在评论里补充。不才，共勉。</p><p>当然了，做程序员也有坏处，比如，就不比如了吧…</p><p>毕竟这篇文章的主旨是给编程自家人涨势气，”人艰不拆”，就不要把用switch语句的case都列举不完的坏处一一陈明了吧。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>理解CSS模块化</title>
      <link href="/understanding-the-css-modules-methodology.html"/>
      <url>/understanding-the-css-modules-methodology.html</url>
      
        <content type="html"><![CDATA[<p>在瞬息万变的前端开发世界中，很难找到一个真正有意义的概念，并且将其清晰明了的向广大人民群众普及。</p><p>把目光投向CSS，一个重大转折就是CSS预处理器的出现（在工具方面来看），其中， <a href="http://sass-lang.com/" target="_blank" rel="noopener">Sass</a>应该是最为著名的一个。此外，还有 <a href="https://github.com/postcss" target="_blank" rel="noopener">PostCSS</a>，它和Sass略有不同，但是殊途同归——都是用浏览器不能解析的语法编写，并且最终编译成浏览器能够理解的语法。</p><p>现在，又有一位新的成员出现了，它就是<a href="https://github.com/css-modules/css-modules" target="_blank" rel="noopener">CSS模块</a>。本文就将介绍CSS模块化的诸多优点，以及如何编写模块化的CSS。</p><h2 id="什么是CSS模块"><a href="#什么是CSS模块" class="headerlink" title="什么是CSS模块"></a>什么是CSS模块</h2><p>首先，让我们从官方文档入手：</p><blockquote><p>A <strong>CSS Module</strong> is a CSS file in which all class names and animation names are scoped locally by default. <strong>CSS模块</strong>就是所有的类名都只有局部作用域的CSS文件。</p></blockquote><p>事实稍微有一些复杂。由于类名需要<em>默认具有局部作用域</em>，这就涉及到一些初始设置、一个编译过程，以及其他一些难以琢磨的东西。</p><p>但是最终，我们会为CSS模块化带来的好处而开心：CCS模块将作用域限制于组件中，从而避免了全局作用域的问题。我们再也不用操心为组件寻找一个好的命名了，因为编译过程已经帮你完成了这个任务。</p><h2 id="它是如何工作的"><a href="#它是如何工作的" class="headerlink" title="它是如何工作的"></a>它是如何工作的</h2><p>CSS模块需要在构建步骤进行管道化，这也就是说，它不是自动驱动的。它可以看成是<a href="https://webpack.github.io/" target="_blank" rel="noopener">webpack</a> 或 <a href="http://browserify.org/" target="_blank" rel="noopener">Browserify</a>的一个插件。其基本工作方式是：当你在一个JavaScript模块中导入一个CSS文件时（例如，在一个 <a href="https://facebook.github.io/react/" target="_blank" rel="noopener">React</a> 组件中），CSS模块将会定义一个对象，将文件中类的名字动态的映射为JavaScript作用域中可以使用的字符串。举个具体的例子：</p><p>如下是一个简单的CSS文件。其中，<code>.base</code>类名不需要是工程中唯一的，因为它将不会是真正被解析的类名。它可以看成是在JavaScript模块中使用的类在样式表中的别名。</p><pre><code>.base {  color: deeppink;  max-width: 42em;  margin: 0 auto;}</code></pre><p>下面是该CSS类在JavaScript组件中的使用方式：</p><pre><code>import styles from &apos;./styles.css&apos;;element.innerHTML = `&lt;div class=&quot;${styles.base}&quot;&gt;  CSS Modules are fun.&lt;/div&gt;`;</code></pre><p>最终，它将生成下面这个东西（当使用webpack的默认步骤时）：</p><pre><code>`&lt;div class=&quot;_20WEds96_Ee1ra54-24ePy&quot;&gt;CSS Modules are fun.&lt;/div&gt;`._20WEds96_Ee1ra54-24ePy {  color: deeppink;  max-width: 42em;  margin: 0 auto;}</code></pre><p>当然，生成的类名可以通过配置，使得它的长度更短或者遵循一些特定的模式。当然了，这些最终都不重要（虽然短的类名意味着更短的样式表），重点在于这些类名是动态生成的、唯一的且和正确的样式表一一对应的。</p><h2 id="一些需要注意的地方"><a href="#一些需要注意的地方" class="headerlink" title="一些需要注意的地方"></a>一些需要注意的地方</h2><p>这就是CSS模块工作的方式了。这时，你可能会想，“这到底是个什么玩意儿，我甚至。。。”。OK，停下！我知道你想说什么。现在就让我一一解答你可能有的疑虑。</p><p><em><strong>这看起来太丑了</strong></em></p><p>确实如此。但是类名并不要求一定要长的好看对不对？只要可以将样式正确的应用于元素就可以了嘛。而CSS模块化方法完成的非常好，所以我觉得，这不是一个问题。</p><p><em><strong>这非常难debug啊</strong></em></p><p>由于需要有一个编译的步骤，所以直接debug是非常困难的。其实，像Sass直接debug也是相当不容易的，所以我们才有了 <a href="http://www.sitepoint.com/using-source-maps-debug-sass-chrome/" target="_blank" rel="noopener">sourcemaps</a>。对于CSS模块，我们也可以设置sourcemap。</p><p>其实，我还想说的是，虽然在模块中，类的名字是自动生成而不可预知的，但是对于模块来说，它还是比样式表更容易debug的。只要你知道当前在开发者工具中查看的样式属于哪个模块，在相应的样式表中也是很容易定位。</p><p><em><strong>这使得样式不容易复用啦！</strong></em></p><p>这句话既对也不对。一方面来说，确实如此。但这是因为模块将CSS样式和组件相绑定，从而不会发生全局样式的冲突。这其实是一件好事，我相信你也会同意的对不对。</p><p>另一方面，要定义全局样式也是可以的，只要使用<code>:global()</code>就好了。比如，作者需要保留的全局辅助样式。</p><pre><code>:global(.clearfix::after) {  content: &apos;&apos;;  clear: both;  display: table;}</code></pre><p>CSS模块还可以从其他模块中继承样式，这和Sass中的<code>@extend</code>方法其实是一样的。它不会拷贝样式，只是将选择器连接到继承的样式中。</p><pre><code>.base {  composes: appearance from &apos;../AnoherModule/styles.css&apos;;}</code></pre><p><em><strong>它需要webpack，Browserify或者其他工具！</strong></em></p><p>这和Sass需要将<code>.scss</code>文件编译成CSS文件，PostCSS需要将样式表处理成浏览器能够识别的样式其实是一样的。无论如何，都需要一个构建步骤。</p><p><em><strong>我们究竟为什么要讨论这个东西？</strong></em></p><p>其实，我甚至不确定CSS模块在未来到底会不会继续存在，不过，我确定这是一种编写样式的正确方式。试想，在拆分成许多细小组件的庞大站点中，却拥有一个臃肿的全局样式表，这肯定是不合适的。</p><p>CSS统一的名空间使得它既强大又脆弱。而CSS模块化或者未来延续这个思想的其他工具可以在支持样式复用的同时，避免命名冲突，这是一个双赢的选择。</p><h2 id="入门"><a href="#入门" class="headerlink" title="入门"></a>入门</h2><p>如前面所说的，你需要有webpack或者Browserify来实现CSS模块化。</p><h3 id="Webpack"><a href="#Webpack" class="headerlink" title="Webpack"></a>Webpack</h3><p>先从webpack版本的模块化开始。在<code>webpack.config.js</code>中，加上如下配置，使得webpack将CSS文件作为CSS模块来看待：</p><pre><code>{  test: /\.css$/,  loader: &apos;style-loader!css-loader?modules&apos;}</code></pre><p>这时，它将把样式注入到页面中的“元素中。这可能不是我们想要的，使用<a href="https://github.com/webpack/extract-text-webpack-plugin" target="_blank" rel="noopener">extract text plugin for webpack</a>，我们可以很方便的抽取出样式表：</p><pre><code>{  test: /\.css$/,  loader: ExtractTextPlugin.extract(&apos;style-loader&apos;, &apos;css-loader?modules&apos;)}</code></pre><p>对于webpack，要讲的就是这么多了。</p><h3 id="Browserify"><a href="#Browserify" class="headerlink" title="Browserify"></a>Browserify</h3><p>我只在命令行中用过Browserify，所以我猜使用起来会更复杂一些。在<code>package.json</code>文件中，加入 <a href="https://docs.npmjs.com/misc/scripts" target="_blank" rel="noopener">npm script</a> ：</p><pre><code>{  &quot;scripts&quot;: {    &quot;build&quot;: &quot;browserify -p [ css-modulesify -o dist/main.css ] -o dist/index.js src/index.js&quot;  }}</code></pre><p>这条命令告诉Browserify运行<code>src/index.js</code>，返回<code>dist/index.js</code>，并且使用 <a href="https://github.com/css-modules/css-modulesify" target="_blank" rel="noopener">css-modulesify</a>将样式表编译至<code>dist/main.css</code>。如果你想再加上<a href="https://github.com/postcss/autoprefixer" target="_blank" rel="noopener">Autoprefixer</a>，那么命令可以写成这样：</p><pre><code>{  &quot;scripts&quot;: {    &quot;build&quot;: &quot;browserify -p [ css-modulesify --after autoprefixer -o dist/main.css ] -o dist/index.js src/index.js&quot;  }}</code></pre><p>如你所见，使用<code>--after</code>选项可以在编译完成样式表时候，继续对它进行处理。</p><h3 id="阅读更多"><a href="#阅读更多" class="headerlink" title="阅读更多"></a>阅读更多</h3><ul><li><a href="https://www.sitepoint.com/setting-up-a-living-styleguide-in-jekyll/?utm_source=sitepoint&amp;utm_medium=relatedinline&amp;utm_term=&amp;utm_campaign=relatedauthor" target="_blank" rel="noopener">Setting up a Living Styleguide in Jekyll</a></li><li><a href="https://www.sitepoint.com/javascript-functional-testing-nightwatch-js/?utm_source=sitepoint&amp;utm_medium=relatedinline&amp;utm_term=&amp;utm_campaign=relatedauthor" target="_blank" rel="noopener">JavaScript Functional Testing with Nightwatch.js</a></li><li><a href="https://www.sitepoint.com/sitepoints-tiles-a-case-study/?utm_source=sitepoint&amp;utm_medium=relatedinline&amp;utm_term=&amp;utm_campaign=relatedauthor" target="_blank" rel="noopener">SitePoint’s Tiles: A Case Study in Components, Theming and Flexbox</a></li></ul><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>从今天看来，<a href="https://github.com/css-modules/css-modules" target="_blank" rel="noopener">CSS模块化</a>系统和生态确实有些原始了，从Browserify中的配置就能看出来。不过，我确信CSS模块化将变得更好，并且越来越多的人将意识到不管对小项目还是大项目来说，这都是一个很好的方法。</p><p>我认为CSS模块化背后的思想是正确的。当然，我不是说这个库就是最佳解决方案，但是，它确实包含了一些CSS应该采用的写法：模块化、作用域隔离、同时支持复用。</p><p>最后，我向大家推荐项目作者Glen Maddern的文章 <a href="http://glenmaddern.com/articles/css-modules" target="_blank" rel="noopener">this introduction to CSS Modules</a>。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>前端面试题</title>
      <link href="/front-end-face.html"/>
      <url>/front-end-face.html</url>
      
        <content type="html"><![CDATA[<h3 id="常用那几种浏览器测试？有哪些内核-Layout-Engine"><a href="#常用那几种浏览器测试？有哪些内核-Layout-Engine" class="headerlink" title="常用那几种浏览器测试？有哪些内核(Layout Engine)?"></a>常用那几种浏览器测试？有哪些内核(Layout Engine)?</h3><p>(Q1) 浏览器：IE，Chrome，FireFox，Safari，Opera。 (Q2) 内核：Trident，Gecko，Presto，Webkit。</p><h3 id="说下行内元素和块级元素的区别？行内块元素的兼容性使用？（IE8-以下）"><a href="#说下行内元素和块级元素的区别？行内块元素的兼容性使用？（IE8-以下）" class="headerlink" title="说下行内元素和块级元素的区别？行内块元素的兼容性使用？（IE8 以下）"></a>说下行内元素和块级元素的区别？行内块元素的兼容性使用？（IE8 以下）</h3><p>(Q1) 行内元素：会在水平方向排列，不能包含块级元素，设置width无效，height无效(可以设置line-height)，margin上下无效，padding上下无效。 块级元素：各占据一行，垂直方向排列。从新行开始结束接着一个断行。 (Q2) 兼容性：display:inline-block;*display:inline;*zoom:1;</p><h3 id="清除浮动有哪些方式？比较好的方式是哪一种？"><a href="#清除浮动有哪些方式？比较好的方式是哪一种？" class="headerlink" title="清除浮动有哪些方式？比较好的方式是哪一种？"></a>清除浮动有哪些方式？比较好的方式是哪一种？</h3><p>(Q1) （1）父级div定义height。 （2）结尾处加空div标签clear:both。 （3）父级div定义伪类:after和zoom。 （4）父级div定义overflow:hidden。 （5）父级div定义overflow:auto。 （6）父级div也浮动，需要定义宽度。 （7）父级div定义display:table。 （8）结尾处加br标签clear:both。 (Q2) 比较好的是第3种方式，好多网站都这么用。</p><h3 id="box-sizing常用的属性有哪些？分别有什么作用？"><a href="#box-sizing常用的属性有哪些？分别有什么作用？" class="headerlink" title="box-sizing常用的属性有哪些？分别有什么作用？"></a>box-sizing常用的属性有哪些？分别有什么作用？</h3><p>(Q1)box-sizing: content-box|border-box|inherit; (Q2)content-box:宽度和高度分别应用到元素的内容框。在宽度和高度之外绘制元素的内边距和边框(元素默认效果)。 border-box:元素指定的任何内边距和边框都将在已设定的宽度和高度内进行绘制。通过从已设定的宽度和高度分别减去边框和内边距才能得到内容的宽度和高度。</p><h3 id="Doctype作用？标准模式与兼容模式各有什么区别"><a href="#Doctype作用？标准模式与兼容模式各有什么区别" class="headerlink" title="Doctype作用？标准模式与兼容模式各有什么区别?"></a>Doctype作用？标准模式与兼容模式各有什么区别?</h3><p>(Q1) &lt;!DOCTYPE&gt;告知浏览器的解析器用什么文档标准解析这个文档。DOCTYPE不存在或格式不正确会导致文档以兼容模式呈现。 (Q2) 标准模式的排版和JS运作模式都是以该浏览器支持的最高标准运行。在兼容模式中，页面以宽松的向后兼容的方式显示,模拟老式浏览器的行为以防止站点无法工作。</p><h3 id="HTML5-为什么只需要写-？"><a href="#HTML5-为什么只需要写-？" class="headerlink" title="HTML5 为什么只需要写 ？"></a>HTML5 为什么只需要写 ？</h3><p>HTML5不基于 SGML，因此不需要对DTD进行引用，但是需要doctype来规范浏览器的行为（让浏览器按照它们应该的方式来运行）。 而HTML4.01基于SGML,所以需要对DTD进行引用，才能告知浏览器文档所使用的文档类型。</p><h3 id="页面导入样式时，使用link和-import有什么区别？"><a href="#页面导入样式时，使用link和-import有什么区别？" class="headerlink" title="页面导入样式时，使用link和@import有什么区别？"></a>页面导入样式时，使用link和@import有什么区别？</h3><p>（1）link属于XHTML标签，除了加载CSS外，还能用于定义RSS, 定义rel连接属性等作用；而@import是CSS提供的，只能用于加载CSS; （2）页面被加载的时，link会同时被加载，而@import引用的CSS会等到页面被加载完再加载; （3）import是CSS2.1 提出的，只在IE5以上才能被识别，而link是XHTML标签，无兼容问题。</p><h3 id="介绍一下你对浏览器内核的理解？"><a href="#介绍一下你对浏览器内核的理解？" class="headerlink" title="介绍一下你对浏览器内核的理解？"></a>介绍一下你对浏览器内核的理解？</h3><p>主要分成两部分：渲染引擎(layout engineer或Rendering Engine)和js引擎。</p><p>渲染引擎：负责取得网页的内容（HTML、XML、图像等等）、整理讯息（例如加入CSS等），以及计算网页的显示方式，然后会输出至显示器或打印机。 浏览器的内核的不同对于网页的语法解释会有不同，所以渲染的效果也不相同。所有网页浏览器、电子邮件客户端以及其它需要编辑、显示网络内容的应用程序都需要内核。</p><p>JS引擎则：解析和执行javascript来实现网页的动态效果。</p><p>最开始渲染引擎和JS引擎并没有区分的很明确，后来JS引擎越来越独立，内核就倾向于只指渲染引擎。</p><h3 id="html5有哪些新特性？如何处理HTML5新标签的浏览器兼容问题？如何区分-HTML-和-HTML5？"><a href="#html5有哪些新特性？如何处理HTML5新标签的浏览器兼容问题？如何区分-HTML-和-HTML5？" class="headerlink" title="html5有哪些新特性？如何处理HTML5新标签的浏览器兼容问题？如何区分 HTML 和 HTML5？"></a>html5有哪些新特性？如何处理HTML5新标签的浏览器兼容问题？如何区分 HTML 和 HTML5？</h3><p>(Q1) HTML5 现在已经不是 SGML 的子集，主要是关于图像，位置，存储，多任务等功能的增加。 (1)绘画 canvas; (2)用于媒介回放的 video 和 audio 元素; (3)本地离线存储 localStorage 长期存储数据，浏览器关闭后数据不丢失; (4)sessionStorage 的数据在浏览器关闭后自动删除; (5)语意化更好的内容元素，比如 article、footer、header、nav、section; (6)表单控件，calendar、date、time、email、url、search; (7)新的技术webworker, websocket, Geolocation;</p><p>(Q2) IE8/IE7/IE6支持通过document.createElement方法产生的标签， 可以利用这一特性让这些浏览器支持HTML5新标签， 浏览器支持新标签后，还需要添加标签默认的样式。 当然也可以直接使用成熟的框架、比如html5shim，</p><h3 id="简述一下你对HTML语义化的理解？"><a href="#简述一下你对HTML语义化的理解？" class="headerlink" title="简述一下你对HTML语义化的理解？"></a>简述一下你对HTML语义化的理解？</h3><p>用正确的标签做正确的事情。 html语义化让页面的内容结构化，结构更清晰，便于对浏览器、搜索引擎解析; 即使在没有样式CSS情况下也以一种文档格式显示，并且是容易阅读的; 搜索引擎的爬虫也依赖于HTML标记来确定上下文和各个关键字的权重，利于seo; 使阅读源代码的人对网站更容易将网站分块，便于阅读维护理解。</p><h2 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h2><h3 id="介绍js的基本数据类型"><a href="#介绍js的基本数据类型" class="headerlink" title="介绍js的基本数据类型"></a>介绍js的基本数据类型</h3><p>Undefined、Null、Boolean、Number、String</p><h3 id="js有哪些内置对象？"><a href="#js有哪些内置对象？" class="headerlink" title="js有哪些内置对象？"></a>js有哪些内置对象？</h3><p>数据封装类对象：Object、Array、Boolean、Number 和 String</p><p>其他对象：Function、Arguments、Math、Date、RegExp、Error</p><h3 id="this对象的理解"><a href="#this对象的理解" class="headerlink" title="this对象的理解"></a>this对象的理解</h3><p>this总是指向函数的直接调用者（而非间接调用者）；</p><p>如果有new关键字，this指向new出来的那个对象；</p><p>在事件中，this指向触发这个事件的对象，特殊的是，IE中的attachEvent中的this总是指向全局对象Window。</p><h3 id="eval是做什么的？"><a href="#eval是做什么的？" class="headerlink" title="eval是做什么的？"></a>eval是做什么的？</h3><p>它的功能是把对应的字符串解析成JS代码并运行；</p><p>应该避免使用eval，不安全，非常耗性能（2次，一次解析成js语句，一次执行）。</p><p>由JSON字符串转换为JSON对象的时候可以用eval，var obj =eval(‘(‘+ str +’)’)。</p><h3 id="DOM怎样添加、移除、移动、复制、创建和查找节点"><a href="#DOM怎样添加、移除、移动、复制、创建和查找节点" class="headerlink" title="DOM怎样添加、移除、移动、复制、创建和查找节点"></a>DOM怎样添加、移除、移动、复制、创建和查找节点</h3><p>// 创建新节点</p><p>createDocumentFragment() //创建一个DOM片段</p><p>createElement() //创建一个具体的元素</p><p>createTextNode() //创建一个文本节点</p><p>// 添加、移除、替换、插入</p><p>appendChild()</p><p>removeChild()</p><p>replaceChild()</p><p>insertBefore() //在已有的子节点前插入一个新的子节点</p><p>// 查找</p><p>getElementsByTagName() //通过标签名称</p><p>getElementsByName() //通过元素的Name属性的值(IE容错能力较强，会得到一个数组，其中包括id等于name值的)</p><p>getElementById() //通过元素Id，唯一性</p><h3 id="null和undefined的区别？"><a href="#null和undefined的区别？" class="headerlink" title="null和undefined的区别？"></a>null和undefined的区别？</h3><p>null是一个表示”无”的对象，转为数值时为0；undefined是一个表示”无”的原始值，转为数值时为NaN。</p><p>undefined：</p><p>（1）变量被声明了，但没有赋值时，就等于undefined。</p><p>（2) 调用函数时，应该提供的参数没有提供，该参数等于undefined。</p><p>（3）对象没有赋值的属性，该属性的值为undefined。</p><p>（4）函数没有返回值时，默认返回undefined。</p><p>null：</p><p>（1） 作为函数的参数，表示该函数的参数不是对象。</p><p>（2） 作为对象原型链的终点。</p><h3 id="new操作符具体干了什么呢"><a href="#new操作符具体干了什么呢" class="headerlink" title="new操作符具体干了什么呢?"></a>new操作符具体干了什么呢?</h3><p>（1）创建一个空对象，并且 this 变量引用该对象，同时还继承了该函数的原型。</p><p>（2）属性和方法被加入到 this 引用的对象中。</p><p>（3）新创建的对象由 this 所引用，并且最后隐式的返回 this 。</p><h3 id="JSON-的了解？"><a href="#JSON-的了解？" class="headerlink" title="JSON 的了解？"></a>JSON 的了解？</h3><p>JSON(JavaScript Object Notation) 是一种轻量级的数据交换格式。它是基于JavaScript的一个子集。数据格式简单, 易于读写, 占用带宽小。</p><p>格式：采用键值对，例如：{‘age’:’12’, ‘name’:’back’}</p><h3 id="call-和-apply-的区别和作用？"><a href="#call-和-apply-的区别和作用？" class="headerlink" title="call() 和 apply() 的区别和作用？"></a>call() 和 apply() 的区别和作用？</h3><p>apply()函数有两个参数：第一个参数是上下文，第二个参数是参数组成的数组。如果上下文是null，则使用全局对象代替。</p><p>如：function.apply(this,[1,2,3]);</p><p>call()的第一个参数是上下文，后续是实例传入的参数序列。</p><p>如：function.call(this,1,2,3);</p><h3 id="如何获取UA？"><a href="#如何获取UA？" class="headerlink" title="如何获取UA？"></a>如何获取UA？</h3><p>function whatBrowser() {</p><p>document.Browser.Name.value=navigator.appName;</p><p>document.Browser.Version.value=navigator.appVersion;</p><p>document.Browser.Code.value=navigator.appCodeName;</p><p>document.Browser.Agent.value=navigator.userAgent;</p><p>}</p><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="HTTP状态码知道哪些？"><a href="#HTTP状态码知道哪些？" class="headerlink" title="HTTP状态码知道哪些？"></a>HTTP状态码知道哪些？</h3><p>100 Continue 继续，一般在发送post请求时，已发送了http header之后服务端将返回此信息，表示确认，之后发送具体参数信息</p><p>200 OK 正常返回信息</p><p>201 Created 请求成功并且服务器创建了新的资源</p><p>202 Accepted 服务器已接受请求，但尚未处理</p><p>301 Moved Permanently 请求的网页已永久移动到新位置。</p><p>302 Found 临时性重定向。</p><p>303 See Other 临时性重定向，且总是使用 GET 请求新的 URI。</p><p>304 Not Modified 自从上次请求后，请求的网页未修改过。</p><p>400 Bad Request 服务器无法理解请求的格式，客户端不应当尝试再次使用相同的内容发起请求。</p><p>401 Unauthorized 请求未授权。</p><p>403 Forbidden 禁止访问。</p><p>404 Not Found 找不到如何与 URI 相匹配的资源。</p><p>500 Internal Server Error 最常见的服务器端错误。</p><p>503 Service Unavailable 服务器端暂时无法处理请求（可能是过载或维护）。</p><h3 id="你有哪些性能优化的方法？"><a href="#你有哪些性能优化的方法？" class="headerlink" title="你有哪些性能优化的方法？"></a>你有哪些性能优化的方法？</h3><p>（1） 减少http请求次数：CSS Sprites, JS、CSS源码压缩、图片大小控制合适；网页Gzip，CDN托管，data缓存 ，图片服务器。</p><p>（2） 前端模板 JS+数据，减少由于HTML标签导致的带宽浪费，前端用变量保存ajax请求结果，每次操作本地变量，不用请求，减少请求次数</p><p>（3） 用innerHTML代替DOM操作，减少DOM操作次数，优化javascript性能。</p><p>（4） 当需要设置的样式很多时设置className而不是直接操作style。</p><p>（5） 少用全局变量、缓存DOM节点查找的结果。减少IO读取操作。</p><p>（6） 避免使用CSS Expression（css表达式)又称Dynamic properties(动态属性)。</p><p>（7） 图片预加载，将样式表放在顶部，将脚本放在底部 加上时间戳。</p><h3 id="什么叫优雅降级和渐进增强？"><a href="#什么叫优雅降级和渐进增强？" class="headerlink" title="什么叫优雅降级和渐进增强？"></a>什么叫优雅降级和渐进增强？</h3><p>优雅降级：web站点在所有新式浏览器中都能正常工作，如果用户使用的是老式浏览器，则代码会检查以确认它们是否能正常工作。 由于IE独特的盒模型布局问题，针对不同版本的IE的hack实践过优雅降级了,为那些无法支持功能的浏览器增加候选方案，使之在旧式浏览器上以某种形式降级体验却不至于完全失效。</p><p>渐进增强：从被所有浏览器支持的基本功能开始，逐步地添加那些只有新式浏览器才支持的功能,向页面增加无害于基础浏览器的额外样式和功能的。当浏览器支持时，它们会自动地呈现出来并发挥作用。</p><h3 id="哪些常见操作会造成内存泄漏？"><a href="#哪些常见操作会造成内存泄漏？" class="headerlink" title="哪些常见操作会造成内存泄漏？"></a>哪些常见操作会造成内存泄漏？</h3><p>内存泄漏指任何对象在您不再拥有或需要它之后仍然存在。</p><p>垃圾回收器定期扫描对象，并计算引用了每个对象的其他对象的数量。如果一个对象的引用数量为 0（没有其他对象引用过该对象），或对该对象的惟一引用是循环的，那么该对象的内存即可回收。</p><p>setTimeout 的第一个参数使用字符串而非函数的话，会引发内存泄漏。</p><p>闭包、控制台日志、循环（在两个对象彼此引用且彼此保留时，就会产生一个循环）。</p><h3 id="线程与进程的区别"><a href="#线程与进程的区别" class="headerlink" title="线程与进程的区别"></a>线程与进程的区别</h3><p>一个程序至少有一个进程,一个进程至少有一个线程。</p><p>线程的划分尺度小于进程，使得多线程程序的并发性高。</p><p>另外，进程在执行过程中拥有独立的内存单元，而多个线程共享内存，从而极大地提高了程序的运行效率。</p><p>线程在执行过程中与进程还是有区别的。每个独立的线程有一个程序运行的入口、顺序执行序列和程序的出口。但是线程不能够独立执行，必须依存在应用程序中，由应用程序提供多个线程执行控制。</p><p>从逻辑角度来看，多线程的意义在于一个应用程序中，有多个执行部分可以同时执行。但操作系统并没有将多个线程看做多个独立的应用，来实现进程的调度和管理以及资源分配。这就是进程和线程的重要区别。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>常用的Git命令</title>
      <link href="/git-shell-notes.html"/>
      <url>/git-shell-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h3><pre><code>git init 初始化git仓库git status 查看git仓库状态git diff &lt;filename&gt; 查看文件修改过的地方git add &lt;filename&gt;  添加文件到暂存区git commit -m &quot;blablabla...&quot; 提交文件到版本库git commit --amend 对上一次的提交做修改</code></pre><h3 id="远程库操作"><a href="#远程库操作" class="headerlink" title="远程库操作"></a>远程库操作</h3><pre><code>git remote -v 查看远程仓库git remote add origin git@server-name:path/repo-name.git  关联远程库(github已创建)git push -u origin master   关联后第一次推送git push origin master   平常推送git pull [remoteName] [localBranchName] 拉取远程仓库git clone git@server-name:path/repo-name.git 克隆仓库</code></pre><h3 id="版本回退和撤销修改"><a href="#版本回退和撤销修改" class="headerlink" title="版本回退和撤销修改"></a>版本回退和撤销修改</h3><pre><code>git log 查看历史版本git log --pretty=oneline 查看简要历史版本(可以查看更多版本)git reset --hard HEAD^ 版本回退(上一个版本就是HEAD^，上上一个版本就是HEAD^^，当然往上100个版本写100个^比较容易数不过来，所以写成HEAD~100)git reset --hard [commit id] 版本回退第二种命令， 用commit 的id 来指定版本回退git reflog 查看命令历史, 可查看每次的命令操作 id 来进行历史操作的任意跳转(用到上面的命令)git checkout -- &lt;filename&gt;  撤销文件在工作区的修改</code></pre><h3 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h3><pre><code>git tag 查看当前所有标签git tag -a &lt;tagname&gt; -m &quot;blablabla...&quot; 添加新标签git tag -d &lt;tagname&gt;  删除标签git push origin :refs/tags/&lt;tagname&gt;  删除远程指定标签git push origin --tags 推送所有标签到远程库</code></pre><h3 id="分支"><a href="#分支" class="headerlink" title="分支"></a>分支</h3><pre><code>git branch 查看当前所有分支git branch &lt;branchname&gt; 创建分支git branch -d &lt;branchname&gt; 删除分支git checkout &lt;branchname&gt; 切换分支git checkout -b &lt;branchname&gt; 创建分支并切换到新创建的分支git merge &lt;branchname&gt;  合并&lt;branchname&gt;分支到当前分支git log --graph 查看分支的合并情况</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Gradle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSS单词换行and断词笔记</title>
      <link href="/css-word-for-word-breaker.html"/>
      <url>/css-word-for-word-breaker.html</url>
      
        <content type="html"><![CDATA[<h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>截图的英文单词为什么被截断了？</p><p><a href="http://cdn.alloyteam.com/wp-content/uploads/auto_save_image/2016/05/104717l1Y.png" target="_blank" rel="noopener"><img src="http://cdn.alloyteam.com/wp-content/uploads/auto_save_image/2016/05/104717l1Y.png" alt="QQ截图20160523145733.png" title="点击查看大图"></a></p><p>这个问题太简单了，css里加两行属性，分分钟搞定。</p><pre><code>word-break:  keep-all;word-wrap:  break-word;</code></pre><p>开心的提交代码，刷新页面。我擦，怎么还是没有断词？不可能啊！！！ 难道这两个属性有什么兼容性问题或者有什么限制条件？为了不搬石头砸自己的脚，还是去深入了解一下。</p><h3 id="css单词断词、换行"><a href="#css单词断词、换行" class="headerlink" title="css单词断词、换行"></a>css单词断词、换行</h3><p>关键字： word-break, word-wrap</p><p><strong>提前声明：上面的问题用这两个属性来解决并没有什么问题，这里只是再加深巩固一下知识。想了解原因的同学请直接看下一小节。</strong></p><p>word-break, word-wrap这两个属性都比较常见，断词、溢出显示省略号等常见功能都需要用到它们。但具体它们分别是什么意思，各自有什么属性，可能很多人都不是很清楚。反正我不懂。每次都是从网上查一查就用上了，两个属性长得太像了，总是记不住。</p><p>来，先看文档。</p><pre><code>word-break:  normal  |  break-all  |  keep-all;</code></pre><p><strong>normal</strong> 使用浏览器默认的换行规则。 <strong>break-all</strong> 允许在单词内换行。 <strong>keep-all</strong> 只能在半角空格或连字符处换行。</p><p><a href="http://www.w3school.com.cn/cssref/pr_word-break.asp" target="_blank" rel="noopener">http://www.w3school.com.cn/cssref/pr_word-break.asp</a></p><pre><code>word-wrap:  normal  |  break-word;</code></pre><p><strong>normal</strong> 只在允许的断字点换行（浏览器保持默认处理）。 <strong>break-word</strong> 在长单词或 URL 地址内部进行换行。</p><p><a href="http://www.w3school.com.cn/cssref/pr_word-wrap.asp" target="_blank" rel="noopener">http://www.w3school.com.cn/cssref/pr_word-wrap.asp</a></p><p>看懂了吗？反正我好像没看懂。</p><p>看图貌似会好点。</p><p><a href="http://www.w3school.com.cn/tiy/t.asp?f=css3_word-wrap" target="_blank" rel="noopener">http://www.w3school.com.cn/tiy/t.asp?f=css3_word-wrap</a></p><p><a href="http://cdn.alloyteam.com/wp-content/uploads/auto_save_image/2016/05/104717Tfq.png" target="_blank" rel="noopener"><img src="http://cdn.alloyteam.com/wp-content/uploads/auto_save_image/2016/05/104717Tfq.png" alt="word-break.png-6.9kB" title="点击查看大图"></a></p><p><a href="http://cdn.alloyteam.com/wp-content/uploads/auto_save_image/2016/05/104717zmN.png" target="_blank" rel="noopener"><img src="http://cdn.alloyteam.com/wp-content/uploads/auto_save_image/2016/05/104717zmN.png" alt="word-wrap.png-8.7kB"></a></p><p>相信大概能看明白了，我简单总结下：</p><ol><li>word-break 当行尾放不下一个单词时，决定单词内部该怎么摆放。 break-all: 强行上，挤不下的话剩下的就换下一行显示呗。霸道型。 keep-all: 放不下我了，那我就另起一行展示，再放不下，我也不退缩。傲骄型。</li><li>word-wrap 当行尾放不下时，决定单词内是否允许换行 normal: 单词太长，换行显示，再超过一行就溢出显示。 break-word: 当单词太长时，先尝试换行，换行后还是太长，单词内还可以换行。</li><li>上面这些换行神马的都是针对英文单词，像CJK(中文/日文/韩文)这样的语言就算了，因为他们不需要，不信你读一下下面的文字</li></ol><blockquote><p>研表究明，汉字的序顺并不定一能影阅响读，比如当你看完这句话后，才发这现里的字全是都乱的。</p></blockquote><p>这样子都可以流畅阅读，更别说断词了…</p><p>再回头来看我们的问题，理论上加上了word-break: keep-all;word-wrap: break-word;应该没问题了，看来还有别的坑。</p><h3 id="空格转换"><a href="#空格转换" class="headerlink" title="空格转换"></a>空格转换</h3><p>关键字： white-space</p><p>确认word-break和word-wrap使用方法没有错后，开始检查我们自己的代码。抓包发现，后台同学返回的文本里空格全部以 来代替。</p><p><a href="http://cdn.alloyteam.com/wp-content/uploads/auto_save_image/2016/05/104717juI.png" target="_blank" rel="noopener"><img src="http://cdn.alloyteam.com/wp-content/uploads/auto_save_image/2016/05/104717juI.png" alt="image_1ajjmjc0r17sp390ho2j0i6h613.png-21.5kB"></a></p><p>what？为什么要用转义字符代替？为什么css不能识别这个转义空格？</p><p>电话后台同学，告知：在很早之前的为了解决某个前端问题才这么做的。 抓耳挠腮，使劲回忆了下，确实有这么回事。 因为浏览器会自动将多个空格压缩为一个空格显示。为了还原用户的原本输入，才将空格进行html转义。</p><ol><li>很多用户会用空格来换行或者实现宽字间距</li><li>字符画也很好玩，压缩空格就全乱了。不知道字符画的请看下面</li></ol><p><a href="http://cdn.alloyteam.com/wp-content/uploads/auto_save_image/2016/05/104717kAZ.png" target="_blank" rel="noopener"><img src="http://cdn.alloyteam.com/wp-content/uploads/auto_save_image/2016/05/104717kAZ.png" alt="image_1ajjlmh8r122l1edl2eb1kqc76c9.png-14.2kB"></a></p><p><a href="http://cdn.alloyteam.com/wp-content/uploads/auto_save_image/2016/05/104717kAN.png" target="_blank" rel="noopener"><img src="http://cdn.alloyteam.com/wp-content/uploads/auto_save_image/2016/05/104717kAN.png" alt="image_1ajjlnmssduu1p4d114p1ete2rrm.png-4.4kB"></a></p><p>专业的字符画制作人员会用全角空格来做，这样就不担心浏览器的空格合并问题了_</p><p>ok,那 暂时还不能动它。</p><h4 id="为什么浏览器会自动压缩空格？"><a href="#为什么浏览器会自动压缩空格？" class="headerlink" title="为什么浏览器会自动压缩空格？"></a>为什么浏览器会自动压缩空格？</h4><ol><li>规范如此,就是这么<strong>任性</strong><a href="https://www.w3.org/TR/REC-html40/struct/text.html#h-9.1" target="_blank" rel="noopener">https://www.w3.org/TR/REC-html40/struct/text.html#h-9.1</a></li><li><p>如果不自动压缩空格，那我们写html的时候就只能写成1行了，否则先这样的代码就会出现大段的空白。</p><div><br>  <div><br>    bananas<br>  </div><br></div></li></ol><p>既然规范这么定了，埋了坑，肯定会想办法让你绕过的，想起了white-space。 white-space我们更多的时候只用到nowrap的属性，来配合实现…的特效，实际它还有更多的姿势未解锁。</p><pre><code>white-space:  normal  |  nowrap  |  pre  |  pre-wrap  |  pre-line 我们重点关注pre开头的几个属性。pre是preserve(保留)的缩写。没错，它就跟保留空格有关系。</code></pre><p><strong>pre</strong>: 保留所有的空格和回车，且不允许折行。 <strong>pre-wrap</strong>: 保留所有的空格和回车，但是允许折行。 <strong>pre-line</strong>: 会合并空格，且允许折行</p><p>意思简单明了，好像也不用解释什么。</p><p>所以我们的解决方案来了： 后台按照用户的输入的原始空格返回，不用做转义，前端加上</p><pre><code>word-break:  keep-all;word-wrap:  break-word;white-space:  pre-wrap;</code></pre><p><img src="http://cdn.alloyteam.com/wp-content/plugins/ckeditor-for-wordpress/ckeditor/plugins/smiley/images/teeth_smile.png" alt="laugh" title="laugh"></p><p>不过，这些个属性都是作用于Text上的，而我们的页面里有很多都是富文本，如果将pre-wrap作用于富文本上的父节点上也会有同样的功效吗？ 带着疑问，测试了几个富文本，果然出现了大段空白….</p><p><a href="http://cdn.alloyteam.com/wp-content/uploads/auto_save_image/2016/05/104717DCN.png" target="_blank" rel="noopener"><img src="http://cdn.alloyteam.com/wp-content/uploads/auto_save_image/2016/05/104717DCN.png" alt="image_1ajjnhgql42vmnn1tar165l1kir9.png-24.7kB"></a></p><p><strong>富文本里的html标签之间有空格。</strong></p><p>有兴趣的同学可以在</p><blockquote><p><a href="http://www.taoba.com/" target="_blank" rel="noopener">http://www.taoba.com</a> <a href="http://www.qq.com/" target="_blank" rel="noopener">http://www.qq.com</a> 的body上加上white-space:pre-wrap看看效果。</p></blockquote><p>那富文本的问题要怎么解决呢，黑科技登场了！！</p><p>无法反抗，那就享受吧。 既然浏览器会压缩多个空格，那只要保证文本里每次只有一个空格相邻不就可以了。</p><pre><code>□ -&gt; □ □□ -&gt; □  □□□ -&gt; □ □ □□□□ -&gt; □ □ </code></pre><p>自动规避了浏览器的合并空格策略。</p><p>这个思路来自于富文本编辑器，写过富文本编辑器的同学可能会不屑一顾，这个方案我们都用烂了.. 感谢你们！！</p><blockquote><p>(写个富文本编辑器是学习前端的最佳方式，欢迎闲的蛋疼的同学快去踩坑)_</p></blockquote><p>通知后台同学按照这个规则来改，问题搞定。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ol><li>word-wrap： 决定句尾放不下单词时，单词是否换行</li><li>word-break: 决定单词内该怎么换行</li><li>平文本可以配合white-space: pre-wrap来解决多空格压缩显示问题</li><li>富文本采用的解决方案是对空格进行<strong>间隔</strong>html转义，这种方法更灵活，可以适应不同的场景，也适用于平文本。</li></ol>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>W3C vs. WhatWG HTML5 标准 - 差异记录</title>
      <link href="/w3c-vs-whatwg-html5-specs-differences-documented.html"/>
      <url>/w3c-vs-whatwg-html5-specs-differences-documented.html</url>
      
        <content type="html"><![CDATA[<h1 id="W3C-vs-WhatWG-HTML5-标准-–-差异记录"><a href="#W3C-vs-WhatWG-HTML5-标准-–-差异记录" class="headerlink" title="W3C vs. WhatWG HTML5 标准 – 差异记录"></a>W3C vs. WhatWG HTML5 标准 – 差异记录</h1><blockquote><p>原文：<a href="http://developer.telerik.com/featured/w3c-vs-whatwg-html5-specs-differences-documented/" target="_blank" rel="noopener">http://developer.telerik.com/featured/w3c-vs-whatwg-html5-specs-differences-documented/</a></p></blockquote><p>几周以前，HTML5成为W3C的一个正式推荐。我在SitePoint上针对这一事件讨论了<a href="http://www.sitepoint.com/5-obsolete-features-html5/" target="_blank" rel="noopener">5个有趣但现在过时的功能</a> 。 问题在于W3C标准是同一硬币的一面。从HTML的这个版本开始，开发者和浏览器供应商可以在相同标记语言的两种不同风格之间进行选择：W3C开发的规范和WHATWG开发的规范。</p><blockquote><p>译者注：WHATWG：Web Hypertext Application Technology Working Group，网页超文本应用技术工作小组，是一个以推动网络标准为目的而成立的组织。（后面再不做翻译）</p></blockquote><p>就大部分而言，这些规范都是相同或者说非常相似的，但是几年过去之后，越来越多的差异出现。你会关心他们吗？在大多数情况下不会，因为它对你和你的项目差异很小，或者浏览器供应商会支持这两个标准。然而，在短期内，那些影响已给定功能实现的差异可能对你比较重要。每个浏览器供应商遵循规范都有自己的需求。例如<a href="https://groups.google.com/forum/#!msg/mozilla.dev.platform/BnY1261cNJo/MdkaT_EX6M0J" target="_blank" rel="noopener">来自于Mozilla的David Baron目前声明</a>:</p><blockquote><p>当W3C和WHATWG的HTML标准不同时，我们倾向于遵循WHATWG标准。</p></blockquote><p>在这篇文章里，我们将解决W3C和WHATWG标准之间的一些差异，在每个部分的结尾我会给出我对差异的看法。这并不是一个全面的列表，但是足够让你在这个问题有自己的观点。</p><h3 id="“HTML5”-vs-“HTML-现存标准”"><a href="#“HTML5”-vs-“HTML-现存标准”" class="headerlink" title="“HTML5” vs “HTML 现存标准”"></a>“HTML5” vs “HTML 现存标准”</h3><p>我们以一个简单的主题来开始讨论差异：标准的名称。<a href="http://www.whatwg.org/html/" target="_blank" rel="noopener">WHATWG标准的版本</a>去掉了名字后面的”5″<a href="https://blog.whatwg.org/html-is-the-new-html5" target="_blank" rel="noopener">在2011年初更名为”HTML”</a>。然后，又改名为”HTML 现存标准”来指定它将不断发展和不再支持使用版本号引用。</p><p>相反地，<a href="http://www.w3.org/TR/html5/" target="_blank" rel="noopener">W3C标准</a>继续使用数字，正如介绍中提到的一样，最后一个稳定版本是5，例如HTML5。作为这一步的结果，该组织正在积极开发的标准被称为HTML5.1新版本。在HTML5.1里，一些HTML5里面的元素和属性将不会再有，例如正在讨论的<code>dailog</code>元素，<code>month</code>和<code>week</code>类型的<code>input</code>。</p><h4 id="观点"><a href="#观点" class="headerlink" title="观点"></a>观点</h4><p>我认为现在和2000年之前的世界变化太大了，因为技术以一个疯狂的速度发展着，尤其在web端。所以，删除版本号使其具有连续性听起来是比较合理地。然而，不是所有的浏览器都会自动更新或者以同样的速度发布(常用的术语是一个<strong>evergreen browser</strong>),所以将一组功能放到一个或者多个浏览器版本是有道理的。</p><p>我的观点是，有一个版本可以供开发人员参考并做出更好的计划，直到每一个浏览器都采用这一策略的快速发布和自动更新。不是因为，为了使用一些的功能去开发网站而需要检测浏览器的版本（你真的需要使用该功能检测），而是因为，我们可以获得其统计数据使用一个特定版本的浏览器。使用这些统计数据，在合适的时间你可以采用一些功能在你的项目中。 polyfills 和 shims可以帮助你实现，但是把它们加到你的网站中你需要考虑权重？</p><h3 id="main-元素"><a href="#main-元素" class="headerlink" title="main 元素"></a><code>main</code> 元素</h3><p><code>main</code>元素是最新增加标准中的其中一个，不同的标准对于它有不同的定义。W3C标准定义为页面的主要内容 – 内容是一个页面的主要主题或者一个应用的核心功能。标准还定义一个文档中不能出现一个以上的<code>main</code>元素，并且<code>main</code>元素需要搭配<code>role=&quot;main&quot;</code>或者其他等效性的APIS。</p><p>根据这个标准的一个简单的例子如下所示：</p><pre><code>&lt;header&gt;   &lt;h1&gt;Main title&lt;/h1&gt;&lt;/header&gt;&lt;main&gt;   &lt;article&gt;      &lt;h1&gt;Main title&lt;/h1&gt;      &lt;p&gt;This is the content of this section&lt;/p&gt;      &lt;footer&gt;         The author of this content is Aurelio De Rosa      &lt;/footer&gt;   &lt;/article&gt;&lt;/main&gt;&lt;footer&gt;   &lt;small&gt;Copyright © Aurelio De Rosa 2014&lt;/small&gt;&lt;/footer&gt;</code></pre><p>WHATWG标准不给<code>main</code>元素分配任何语义值，它定义为其他元素主导内容的容器。如果你坚持WHATWG标准，它没有限制你使用<code>main</code>元素的次数。因此如果你在一个页面中有多个<code>article</code>元素，你需要使用<code>main</code>元素标记每个<code>article</code>的的内容。</p><p>使用基于WHATWG标准的一个例子是：</p><pre><code>&lt;header&gt;   &lt;h1&gt;Main title&lt;/h1&gt;&lt;/header&gt;&lt;main&gt;   &lt;article&gt;      &lt;h1&gt;Main title&lt;/h1&gt;      &lt;main&gt;         &lt;p&gt;This is the content of this section&lt;/p&gt;      &lt;/main&gt;      &lt;footer&gt;         The author of this content is Aurelio De Rosa      &lt;/footer&gt;   &lt;/article&gt;&lt;/main&gt;&lt;footer&gt;   &lt;small&gt;Copyright © Aurelio De Rosa 2014&lt;/small&gt;&lt;/footer&gt;</code></pre><p>请注意，在上面的代码中，我使用了两次<code>main</code>元素。</p><h4 id="观点-1"><a href="#观点-1" class="headerlink" title="观点"></a>观点</h4><p>关于<code>main</code>元素，我与W3C看法一致，因为我质疑在一个文档中有多个主要区域的需求。此外，我记得 Steve Faulkner（W3C的标准的编辑）多次敦促 Ian Hickson（WHATWG标准的编辑）在WHATWG邮件中提供能够证明需要多个主要区域的数据。结论是，在所有的场合WHATWG编辑提供这些数据失败。</p><h3 id="hgroup-元素"><a href="#hgroup-元素" class="headerlink" title="hgroup 元素"></a><code>hgroup</code> 元素</h3><p><code>hgroup</code>元素用于组合一个或多个<code>h1</code>–<code>h6</code>的元素集合，对组织一个部分的标题和相应的子标题十分有用。</p><p>引入此元素以便于创建子标题，并解决文档轮廓算法的重要问题。实际上，将多个标题元素放在<code>hgroup</code>中，想象文档大纲应该是包含所有标题，但从最终的结果中看出只有最高级别的标题元素。</p><p>一个使用它的例子，来源于我的文章<a href="http://www.sitepoint.com/5-obsolete-features-html5/" target="_blank" rel="noopener">HTML5中5个过时的功能</a>，如下所示：</p><pre><code>&lt;article&gt;   &lt;hgroup&gt;      &lt;h1&gt;5 deprecated features of HTML5&lt;/h1&gt;      &lt;h2&gt;Sometimes specifications are changed      and you need to refactor your code&lt;/h2&gt;   &lt;/hgroup&gt;   &lt;p&gt;In this article we&apos;ll discuss...&lt;/p&gt;&lt;/article&gt;</code></pre><p>2013年4月由于缺乏实现，用例不足和促进标记反面模式而从W3C标准删除。相反地，WHATWG标准还包括<code>ghroup</code>。</p><h4 id="观点-2"><a href="#观点-2" class="headerlink" title="观点"></a>观点</h4><p>正如引用文章中所说，我一直是这个元素的粉丝但是我弃用了它。第一个原因是，我是W3C标准的一个追随者。第二个原因是，我注意到对这个缺乏兴趣和在浏览器中实现。</p><h3 id="Web-Notifications-API"><a href="#Web-Notifications-API" class="headerlink" title="Web Notifications API"></a>Web Notifications API</h3><p>Web Notifications API定义是为终端用户提供通知的一个API。一个允许提示用户当前网页之外的通知，例如电子邮件传送。每当用户收到了一封新的电子邮件都需要通知用户或者有意见事情需要他们关注。一些具体的例子是如果有人在twitter发文，或者发了一张照片在Facebook或Google+。</p><p>使用此API的简单例子如下：</p><pre><code>Notification.requestPermission(function() {   var notification = new Notification(&apos;Email received&apos;, {      body: &apos;You have a total of 3 unread emails&apos;   });   notification.onshow = function() {      console.log(&apos;Notification shown&apos;);   };});</code></pre><p>Web Notifications API在<a href="http://www.w3.org/TR/notifications/" target="_blank" rel="noopener">W3C标准</a>和<a href="https://notifications.spec.whatwg.org/" target="_blank" rel="noopener">WHATWG标准</a>都有明确的规定，两个版本之间有一些差异。特别地，WHATWG标准去掉了<code>onclose</code>和<code>onshow</code>事件。因此，W3C标准定义了4个事件(<code>onclick</code>, <code>onclose</code>, <code>onerror</code>, 和<code>onshow</code>)，WHATWG标准只定义了两个(<code>onclick</code> 和 <code>onerror</code>)。</p><p>如果你想了解更多API的不同版本和主要浏览器的支持，你可以看看我的这篇文章<a href="http://aurelio.audero.it/blog/2014/10/18/state-web-notifications-api/" target="_blank" rel="noopener">Web Notifications API的状态</a>。</p><h4 id="观点-3"><a href="#观点-3" class="headerlink" title="观点"></a>观点</h4><p>标准之间没有太大的差异，但是它会影响你执行某些任务的方法。在这种情况下，我遵循W3C标准，我考虑的当我触发关闭事件的需要做执行某些操作，但是WHATWG不可能。</p><h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>在本文中我们讨论了一些W3C与WHATWG标准之间最重要的差异。正如你看到的，考虑到标准中定义的元素和APIS的数量，还是没有太多的差异。有了这一想法，就不会担心未来，因为我相信标准最后都会和现实需求匹配，这意味着，不管哪个组织开始一个新的功能都会有明确的规定，开发者和浏览器供应商都有权利去使用成功的一个或另一个版本。因此，浏览器供应商和开发者是决定哪个标准”成功”实施或者弃用他们的主导者。正因为如此，对于每一个讨论的功能，最终都会该表标准以符合现实需求。</p><p>最后一点，如果你想发现更多的差异，你可以看W3C的这篇文章<a href="http://www.w3.org/wiki/HTML/W3C-WHATWG-Differences" target="_blank" rel="noopener">W3C HTML5.1标准与WHATWG LS的不同</a>。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>为什么很少见人傻钱多的程序员炫富？</title>
      <link href="/programmers-show-off-their-wealth.html"/>
      <url>/programmers-show-off-their-wealth.html</url>
      
        <content type="html"><![CDATA[<p>程序员一直都是一个备受人们关注的群体。据IDC2015年的统计数据，全球约有1850万名程序员，中国占10%。随着近年全国互联网创业热潮的兴起，“互联网+”、“云计算”以及“智能硬件”等领域发展迅速，市场对程序员的需求更为旺盛。除了需求旺盛之外，程序员的工资水平也相对较高。</p><p><img src="https://static.oschina.net/uploads/space/2016/1008/071358_Tt5P_2886655.jpg" alt></p><p>2016年7月，国家统计局公布了过去一年各个行业的工资薪酬数据。其中，IT行业的从业者，在平均年薪上达到11万左右。对于科技和互联网中的IT人员，尤其是程序员来说，很多人的工资水平可能还要高于这个数字。而在阿里巴巴、腾讯等大型互联网公司，年薪30—50万的程序员可谓大有人在。比如就阿里巴巴的级别和对应工资来说，P6就有望拿到30万的年薪。</p><p><img src="https://static.oschina.net/uploads/space/2016/1008/071414_35BP_2886655.jpg" alt></p><p>当然，对于中小互联网公司，尤其是北京、上海、深圳、杭州、广州等城市之外的程序员，在工资水平上可能要降低一个档次。不过，总的来看，程序员的薪资水平还是处在一个较高的水平。值得注意的是，不管是互联网上还是身边，不少人都有这样的疑惑：为什么很少见工资高的程序员炫富呢？</p><p>对此，在笔者看来，首先是程序员没有时间去炫耀自己的收入。对于大部分互联网公司来说，996工作制已经是基本的要求了。而对于阿里巴巴、腾讯，包括华为这样的科技公司，晚上十点之前下班已经算早了。除此之外，在产品上线或者出bug的时候，程序员经常会连续一周乃至半个月没有假期。凡此种种，促使程序员的工资匹配着相符合的工作压力，也就很少有时间去炫耀自己的收入。</p><p><img src="https://static.oschina.net/uploads/space/2016/1008/071430_MHJ8_2886655.png" alt></p><p>其次，根据此前的调查结果，有一半以上的程序员来自于北京（23.55%）、广东（16.53%）、浙江（12.81%）和上海（12.40%）。北上广作为国内科技和互联网行业相对于发达的地区，是程序员的主要聚集地。由此，虽然程序员的收入相对较高，但是在以上一线城市，面对更高的房价和物价，程序员的工资也要承受不小的压力。试想一下，假设北京一个程序员税后年薪30万，要买一套100平的房子，大概需要多少年呢？</p><p><img src="https://static.oschina.net/uploads/space/2016/1008/071446_zc8X_2886655.png" alt></p><p>最后，身边既有科班出身的程序员，也有半路培训的程序员，经过一段时间的工作上，性格上变得比较内敛乃至有点沉默。换而言之，这些人现在微信朋友圈、QQ空间动态都几乎不发了，更不用提炫富了。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript中的工厂方法、构造函数与class</title>
      <link href="/javascript-factory-functions-vs-constructor-functions-vs-classes.html"/>
      <url>/javascript-factory-functions-vs-constructor-functions-vs-classes.html</url>
      
        <content type="html"><![CDATA[<p>在ES6出现之前，人们常常疑惑JavaScript中的工厂模式和构造函数模式到底有什么区别。ES6中提出了<em><code>class</code><em>关键字，许多人认为这解决了构造函数模式中的诸多问题。事实上，问题并没有得到解决。下面就让我们来看看工厂模式、构造函数模式和</em><code>class</code></em>的一些重要区别。</p><p>首先，让我们看看这三种方式的例子：</p><pre><code>// classclass ClassCar {  drive () {    console.log(&apos;Vroom!&apos;);  }}const car1 = new ClassCar();console.log(car1.drive());// constructor（构造函数模式）function ConstructorCar () {}ConstructorCar.prototype.drive = function () {  console.log(&apos;Vroom!&apos;);};const car2 = new ConstructorCar();console.log(car2.drive());// factory （工厂模式）const proto = {  drive () {    console.log(&apos;Vroom!&apos;);  }};function factoryCar () {  return Object.create(proto);}const car3 = factoryCar();console.log(car3.drive());</code></pre><p>这些方式都将方法存储于共享的原型中，然后通过构造函数的闭包有选择的支持私有数据。换句话说，他们几乎拥有相同的特性，所以通常来说也能交替使用。</p><blockquote><p>在JavaScript中，任何函数都能返回一个新的对象。当这个函数不是构造函数或<em><code>class</code></em>时，它就叫做工厂函数。</p></blockquote><p>ES6中的<em><code>class</code></em>其实是构造函数的语法糖，所以它具有构造函数的一切优点和缺点：</p><pre><code>class Foo {}console.log(typeof Foo); // function</code></pre><h3 id="构造函数和class的优点"><a href="#构造函数和class的优点" class="headerlink" title="构造函数和class的优点"></a>构造函数和<em><code>class</code></em>的优点</h3><ul><li>大多数书本都教了<em><code>class</code></em>或者构造函数。</li><li><em><code>this</code></em>指向新的对象。</li><li>一些人喜欢<em><code>myFoo = new Foo()</code></em>这种写法。</li><li>构造函数和<em><code>class</code></em>存在许多微小的优化，不过除非你已经定量的分析了代码，并且这些优化确实对程序的性能很重要，否则这不应该被列入考虑范围。</li></ul><h3 id="构造函数和class的缺点"><a href="#构造函数和class的缺点" class="headerlink" title="构造函数和class的缺点"></a>构造函数和<em><code>class</code></em>的缺点</h3><h4 id="1-需要new"><a href="#1-需要new" class="headerlink" title="1.需要new"></a>1.需要<code>new</code></h4><p>在ES6之前，漏写<em><code>new</code></em>是一个普遍的bug。为了对付它，许多人使用了以下方式：</p><pre><code>function Foo() {  if (!(this instanceof Foo)) { return new Foo(); }}</code></pre><p>在ES6（ES2015）中，如果你试图不使用<em><code>new</code><em>来调用class构造函数，将抛出错误。只有用工厂模式包裹class，才有可能避免必须使用</em><code>new</code><em>。对于未来版本的JavaScript，有人提出建议，希望能够定制忽略</em><code>new</code></em>时class构造函数的行为。不过这种方式依然增加了使用class时的开销（这也意味着会有更少的人使用它）。</p><h4 id="2-调用API时，实例化的细节被泄露（从new的角度展开）"><a href="#2-调用API时，实例化的细节被泄露（从new的角度展开）" class="headerlink" title="2. 调用API时，实例化的细节被泄露（从new的角度展开）"></a>2. 调用API时，实例化的细节被泄露（从<code>new</code>的角度展开）</h4><p>构造函数的调用方法与构造函数的实现方式紧密耦合。当你需要其具有工厂方法的灵活性时，重构起来将会是<strong>巨大的变化</strong>。将class放入工厂方法进行重构是非常常见的，它甚至被写入了Martin Fowler, Kent Beck, John Brant, William Opdyke, 和 Don Roberts的 <a href="http://www.amazon.com/Refactoring-Improving-Design-Existing-Code/dp/0201485672/ref=as_li_ss_tl?ie=UTF8&amp;linkCode=ll1&amp;tag=eejs-20&amp;linkId=7cca2e0acb03cf4b88c1f888c43aa24d" target="_blank" rel="noopener">“Refactoring: Improving the Design of Existing Code”</a> 。</p><h4 id="3-构造函数模式违背了开／闭原则"><a href="#3-构造函数模式违背了开／闭原则" class="headerlink" title="3. 构造函数模式违背了开／闭原则"></a>3. 构造函数模式违背了开／闭原则</h4><p>由于对<em><code>new</code></em>的要求，构造函数违背了开／闭原则：即一个API应该对扩展开放，对改装关闭。</p><p>我的意见是，既然从类到工厂方法的重构是非常常见的，那么应该将不应该造成任何破坏作为所有构造函数进行扩展时的标准。</p><p>如果你开放了一个构造函数或者类，而用户使用了这个构造函数，在这之后，如果需要增加这个方法的灵活性，（例如，换成使用对象池的方式进行实现，或者跨执行上下文的实例化，或者使用替代原型来拥有更多的继承灵活性），都需要用户同时进行重构。</p><p>不幸的是，在JavaScript中，从构造函数或者类切换到工厂方法需要进行<strong>巨大的改变</strong>：</p><pre><code>// Original Implementation:// 原始实现：// class Car {//   drive () {//     console.log(&apos;Vroom!&apos;);//   }// }// const AutoMaker = { Car };// Factory refactored implementation:// 工厂函数重构实现：const AutoMaker = {  Car (bundle) {    return Object.create(this.bundle[bundle]);  },  bundle: {    premium: {      drive () {        console.log(&apos;Vrooom!&apos;);      },      getOptions: function () {        return [&apos;leather&apos;, &apos;wood&apos;, &apos;pearl&apos;];      }    }  }};// The refactored factory expects:// 重构后的方法希望这样调用const newCar = AutoMaker.Car(&apos;premium&apos;);newCar.drive(); // &apos;Vrooom!&apos;// But since it&apos;s a library, lots of callers// in the wild are still doing this:// 但是由于这是一个库，许多用户依然这样使用const oldCar = new AutoMaker.Car();// Which of course throws:// TypeError: Cannot read property &apos;undefined&apos; of// undefined at new AutoMaker.Car// 这样的话，就会抛出：// TypeError: Cannot read property &apos;undefined&apos; of// undefined at new AutoMaker.Car</code></pre><p>在上面的例子中，我们首先提供了一个类，但是接下来希望提供不同的汽车种类。于是，工厂方法为不同的汽车种类使用了不同的原型。我曾经使用这种技术来存储不同的播放器接口，然后通过要处理的文件格式选择合适的原型。</p><h4 id="4-使用构造函数会导致instanceof具有欺骗性"><a href="#4-使用构造函数会导致instanceof具有欺骗性" class="headerlink" title="4. 使用构造函数会导致instanceof具有欺骗性"></a>4. 使用构造函数会导致<code>instanceof</code>具有欺骗性</h4><p>与工厂方法相比，构造函数带来的巨大变化就是<em><code>instanceof</code><em>的表现。人们有时使用</em><code>instanceof</code><em>进行类型检查。这种方式其实是经常会出问题的，我建议你避免使用</em><code>instanceof</code></em>。</p><blockquote><p><code>instanceof</code>会撒谎。</p></blockquote><pre><code>// instanceof is a prototype identity check.// NOT a type check.// instanceof是一个原型检查// 而不是类型检查// That means it lies across execution contexts,// when prototypes are dynamically reassigned,// and when you throw confusing cases like this// at it:function foo() {}const bar = { a: &apos;a&apos;};foo.prototype = bar;// Is bar an instance of foo? Nope!console.log(bar instanceof foo); // false// Ok... since bar is not an instance of foo,// baz should definitely not be an instance of foo, right?const baz = Object.create(bar);// ...Wrong.console.log(baz instanceof foo); // true. oops.</code></pre><p><em><code>instanceof</code><em>进行类型检查的方式和强类型语言不一样，它会将对象的</em><code>[[Prototype]]</code><em>对象和</em><code>Constructor.prototype</code></em>属性进行一致性检查。</p><p>例如，当执行上下文发生变化时，<em><code>instanceof</code><em>会发生错误。当</em><code>Constructor.prototype</code><em>变化了之后，</em><code>instanceof</code></em>一样不会正常工作。</p><p>当你从一个class或构造函数开始（这将会返回指向 <em><code>Constructor.prototype</code></em>的<em><code>this</code></em>），然后转而探索另外一个对象（没有指向 <em><code>Constructor.prototype</code></em>），这同样会导致instanceof的失败。这种情况在将构造函数转换为工厂函数时会出现。</p><p>简而言之，<em><code>instanceof</code></em>是另外一种将构造函数转换为工厂函数时会发生的<strong>巨大变化</strong>。</p><h3 id="使用class的优点"><a href="#使用class的优点" class="headerlink" title="使用class的优点"></a>使用class的优点</h3><ul><li>方便的，自包含的语法。</li><li>是JavaScript中使用类的一种单一、规范的方式。在ES6之前，在一些流行的库中已经出现了其实现方式。</li><li>对于有基于类的语言的背景的人来说，会更加熟悉。</li></ul><h3 id="使用class的缺点"><a href="#使用class的缺点" class="headerlink" title="使用class的缺点"></a>使用class的缺点</h3><p>除了具有构造函数的缺点外，还有：</p><ul><li>用户可能会尝试使用extends关键字来创建导致问题的多层级的类。</li></ul><p>多层级的类将会导致许多在面向对象程序设计中广为人知的问题，包括<strong>脆弱的基类问题，香蕉猴子雨林问题，必要性重复问题</strong>等等。不幸的是，class可以用来extends就像球可以用来扔，椅子可以用来坐一样自然。想了解更多内容，请阅读<a href="https://medium.com/javascript-scene/the-two-pillars-of-javascript-ee6f3281e7f3" target="_blank" rel="noopener">“The Two Pillars of JavaScript: Prototypal OO”</a> and <a href="https://medium.com/javascript-scene/inside-the-dev-team-death-spiral-6a7ea255467b" target="_blank" rel="noopener">“Inside the Dev Team Death Spiral”</a>.</p><p>值得指出的是，构造函数和工厂函数都有可能导致有问题的层次继承，但通过<em><code>extends</code>_关键字，class提供了一个让你犯错的功能可见性。换句话说，它鼓励你思考不灵活的的而且通常是错误的<em>is-a</em>关系，而不是更加灵活的_has-a</em> 或者 <em>can-do</em>组件化关系。</p><blockquote><p>功能可见性是让你能够执行一定动作的机会。例如，旋钮可以用来旋转，杠杆可以用来拉，按钮可以用来按，等等。</p></blockquote><h3 id="使用工厂方法的优点"><a href="#使用工厂方法的优点" class="headerlink" title="使用工厂方法的优点"></a>使用工厂方法的优点</h3><p>工厂方法比构造函数或类都要灵活，并且它不会诱惑人们使用<em><code>extends</code></em>来构造太深的继承层级。你可以使用多种方法来继承工厂函数。特别的，如果想了解组合式工厂方法，请查看<a href="https://github.com/stampit-org/stamp-specification" target="_blank" rel="noopener">Stamp Specification</a>。</p><h4 id="1-返回任意对象与使用任意原型"><a href="#1-返回任意对象与使用任意原型" class="headerlink" title="1. 返回任意对象与使用任意原型"></a>1. 返回任意对象与使用任意原型</h4><p>例如，你可以通过同一API轻松的创建多种类型的对象，例如，一个能够针对不同类型视频实例化播放器的媒体播放器，活着能够出发DOM事件或web socket事件的事件库。</p><p>工厂函数还能跨越之行上下文来实例化对象，充分利用对象池，并且允许更灵活的原型模型继承。</p><h4 id="2-没有重构的忧虑"><a href="#2-没有重构的忧虑" class="headerlink" title="2. 没有重构的忧虑"></a>2. 没有重构的忧虑</h4><p>你永远不需要从一个工厂转换到一个构造函数，所以重构将永远不会是一个问题。</p><h4 id="3-没有new"><a href="#3-没有new" class="headerlink" title="3. 没有new"></a>3. 没有<em><code>new</code></em></h4><p>关于要不要使用<em><code>new</code><em>只有一个选择，那就是不要用。（这将会使</em><code>this</code></em>表现不好，原因见下一点）。</p><h4 id="4-标准的this行为"><a href="#4-标准的this行为" class="headerlink" title="4. 标准的this行为"></a>4. 标准的<em><code>this</code></em>行为</h4><p><em><code>this</code></em>和它通常的表现一样，所以你可以用它来获取其父级对象。例如，在<em><code>player.create()</code></em>中，<em><code>this</code></em>指向player，正如其他方法调用那样。<em><code>call()</code></em> 和<em><code>apply()</code><em>也会同样的指向</em><code>this</code></em>。</p><h4 id="5-不会有欺骗性的instanceof问题"><a href="#5-不会有欺骗性的instanceof问题" class="headerlink" title="5. 不会有欺骗性的instanceof问题"></a>5. 不会有欺骗性的<em><code>instanceof</code></em>问题</h4><h4 id="6-有些人喜欢myFoo-createFoo-这种写法"><a href="#6-有些人喜欢myFoo-createFoo-这种写法" class="headerlink" title="6. 有些人喜欢myFoo = createFoo()这种写法"></a>6. 有些人喜欢<code>myFoo = createFoo()</code>这种写法</h4><h3 id="工厂方法的缺点"><a href="#工厂方法的缺点" class="headerlink" title="工厂方法的缺点"></a>工厂方法的缺点</h3><ul><li>不会创建一个指向<em><code>Factory.prototype</code><em>的链接——但这其实是件好事，因为这样你就不会得到一个具有欺骗性的</em><code>instanceof</code><em>。相反，</em><code>instanceof</code></em>会一直失败。详情见工厂方法的优点。</li><li><em><code>this</code></em>不会指向工厂方法中的新对象。详情见工厂方法的优点。</li><li>在经过微优化的基准中，工厂方法可能会稍微比构造函数模式慢一些。如果这对你有影响，请务必在你程序的上下文中进行测试。</li></ul><h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>在我看来，<em><code>class</code><em>或许有简单的语法形式，但这不能弥补它引诱粗心的用户在类继承中犯错的事实。对于未来它也是有风险的，因为你有可能会想将其升级成为一个工厂函数，而由于</em><code>new</code></em>关键字，你的所有调用都将和构造函数紧密耦合，于是从class向工厂方法迁移将会是一个巨大的改变。</p><p>你也许会想可以只重构调用部分，不过在大的团队中，或者你使用的class是公共API的一部分，你就有可能要破坏不在你掌控中的代码。换句话说，不能假设只重构调用部分永远是一个可选项。</p><p>关于工厂方法，有趣的事情在于它们不仅更加强大和灵活，而且是鼓励整个团队，以及所有API用户使用简单、灵活和安全的模式的最简单的方法。</p><p>关于工厂函数的好处，特别是关于对象组合的能力，还有许多内容可以详述。想要了解更多内容，以及这种方式与类继承的区别，请阅读<a href="https://medium.com/javascript-scene/3-different-kinds-of-prototypal-inheritance-es6-edition-32d777fa16c9" target="_blank" rel="noopener">“3 Different Kinds of Prototypal Inheritance”</a>.</p><hr><p>For more training in in prototypal inheritance techniques, factory functions, and object composition, be sure to check out <a href="https://ericelliottjs.com/product/webcast-monday-oct-19th-the-two-pillars-of-js-composition-with-prototypes/" target="_blank" rel="noopener">“The Two Pillars of JS: Composition with Prototypes”</a> — free for members. Not a member yet?</p><h3 id="Learn-JavaScript-with-Eric-Elliott"><a href="#Learn-JavaScript-with-Eric-Elliott" class="headerlink" title="Learn JavaScript with Eric Elliott"></a><a href="https://ericelliottjs.com/product/webcast-monday-oct-19th-the-two-pillars-of-js-composition-with-prototypes/" target="_blank" rel="noopener">Learn JavaScript with Eric Elliott</a></h3><hr><p><em><strong>Eric Elliott</strong></em>* is the author of _<a href="http://pjabook.com/" target="_blank" rel="noopener"><em>“Programming JavaScript Applications”</em></a>_ (O’Reilly), and _<a href="http://ericelliottjs.com/product/lifetime-access-pass/" target="_blank" rel="noopener"><em>“Learn JavaScript with Eric Elliott”</em></a>_. He has contributed to software experiences for <strong><strong>Adobe Systems</strong></strong>, <strong><strong>Zumba Fitness</strong></strong>, <strong><strong>The Wall Street Journal, ESPN</strong></strong>, <strong><strong>BBC</strong></strong>, and top recording artists including <strong><strong>Usher</strong></strong>, <strong><strong>Frank Ocean</strong></strong>,<strong><strong>Metallica</strong></strong>, and many more.*</p><p><em>He spends most of his time in the San Francisco Bay Area with the most beautiful woman in the world.<em>在ES6出现之前，人们常常疑惑JavaScript中的工厂模式和构造函数模式到底有什么区别。ES6中提出了</em><code>class</code><em>关键字，许多人认为这解决了构造函数模式中的诸多问题。事实上，问题并没有得到解决。下面就让我们来看看工厂模式、构造函数模式和</em><code>class</code></em>的一些重要区别。</p><p>首先，让我们看看这三种方式的例子：</p><pre><code>// classclass ClassCar {  drive () {    console.log(&apos;Vroom!&apos;);  }}const car1 = new ClassCar();console.log(car1.drive());// constructor（构造函数模式）function ConstructorCar () {}ConstructorCar.prototype.drive = function () {  console.log(&apos;Vroom!&apos;);};const car2 = new ConstructorCar();console.log(car2.drive());// factory （工厂模式）const proto = {  drive () {    console.log(&apos;Vroom!&apos;);  }};function factoryCar () {  return Object.create(proto);}const car3 = factoryCar();console.log(car3.drive());</code></pre><p>这些方式都将方法存储于共享的原型中，然后通过构造函数的闭包有选择的支持私有数据。换句话说，他们几乎拥有相同的特性，所以通常来说也能交替使用。</p><blockquote><p>在JavaScript中，任何函数都能返回一个新的对象。当这个函数不是构造函数或<em><code>class</code></em>时，它就叫做工厂函数。</p></blockquote><p>ES6中的<em><code>class</code></em>其实是构造函数的语法糖，所以它具有构造函数的一切优点和缺点：</p><pre><code>class Foo {}console.log(typeof Foo); // function</code></pre><h3 id="构造函数和class的优点-1"><a href="#构造函数和class的优点-1" class="headerlink" title="构造函数和class的优点"></a>构造函数和<em><code>class</code></em>的优点</h3><ul><li>大多数书本都教了<em><code>class</code></em>或者构造函数。</li><li><em><code>this</code></em>指向新的对象。</li><li>一些人喜欢<em><code>myFoo = new Foo()</code></em>这种写法。</li><li>构造函数和<em><code>class</code></em>存在许多微小的优化，不过除非你已经定量的分析了代码，并且这些优化确实对程序的性能很重要，否则这不应该被列入考虑范围。</li></ul><h3 id="构造函数和class的缺点-1"><a href="#构造函数和class的缺点-1" class="headerlink" title="构造函数和class的缺点"></a>构造函数和<em><code>class</code></em>的缺点</h3><h4 id="1-需要new-1"><a href="#1-需要new-1" class="headerlink" title="1.需要new"></a>1.需要<code>new</code></h4><p>在ES6之前，漏写<em><code>new</code></em>是一个普遍的bug。为了对付它，许多人使用了以下方式：</p><pre><code>function Foo() {  if (!(this instanceof Foo)) { return new Foo(); }}</code></pre><p>在ES6（ES2015）中，如果你试图不使用<em><code>new</code><em>来调用class构造函数，将抛出错误。只有用工厂模式包裹class，才有可能避免必须使用</em><code>new</code><em>。对于未来版本的JavaScript，有人提出建议，希望能够定制忽略</em><code>new</code></em>时class构造函数的行为。不过这种方式依然增加了使用class时的开销（这也意味着会有更少的人使用它）。</p><h4 id="2-调用API时，实例化的细节被泄露（从new的角度展开）-1"><a href="#2-调用API时，实例化的细节被泄露（从new的角度展开）-1" class="headerlink" title="2. 调用API时，实例化的细节被泄露（从new的角度展开）"></a>2. 调用API时，实例化的细节被泄露（从<code>new</code>的角度展开）</h4><p>构造函数的调用方法与构造函数的实现方式紧密耦合。当你需要其具有工厂方法的灵活性时，重构起来将会是<strong>巨大的变化</strong>。将class放入工厂方法进行重构是非常常见的，它甚至被写入了Martin Fowler, Kent Beck, John Brant, William Opdyke, 和 Don Roberts的 <a href="http://www.amazon.com/Refactoring-Improving-Design-Existing-Code/dp/0201485672/ref=as_li_ss_tl?ie=UTF8&amp;linkCode=ll1&amp;tag=eejs-20&amp;linkId=7cca2e0acb03cf4b88c1f888c43aa24d" target="_blank" rel="noopener">“Refactoring: Improving the Design of Existing Code”</a> 。</p><h4 id="3-构造函数模式违背了开／闭原则-1"><a href="#3-构造函数模式违背了开／闭原则-1" class="headerlink" title="3. 构造函数模式违背了开／闭原则"></a>3. 构造函数模式违背了开／闭原则</h4><p>由于对<em><code>new</code></em>的要求，构造函数违背了开／闭原则：即一个API应该对扩展开放，对改装关闭。</p><p>我的意见是，既然从类到工厂方法的重构是非常常见的，那么应该将不应该造成任何破坏作为所有构造函数进行扩展时的标准。</p><p>如果你开放了一个构造函数或者类，而用户使用了这个构造函数，在这之后，如果需要增加这个方法的灵活性，（例如，换成使用对象池的方式进行实现，或者跨执行上下文的实例化，或者使用替代原型来拥有更多的继承灵活性），都需要用户同时进行重构。</p><p>不幸的是，在JavaScript中，从构造函数或者类切换到工厂方法需要进行<strong>巨大的改变</strong>：</p><pre><code>// Original Implementation:// 原始实现：// class Car {//   drive () {//     console.log(&apos;Vroom!&apos;);//   }// }// const AutoMaker = { Car };// Factory refactored implementation:// 工厂函数重构实现：const AutoMaker = {  Car (bundle) {    return Object.create(this.bundle[bundle]);  },  bundle: {    premium: {      drive () {        console.log(&apos;Vrooom!&apos;);      },      getOptions: function () {        return [&apos;leather&apos;, &apos;wood&apos;, &apos;pearl&apos;];      }    }  }};// The refactored factory expects:// 重构后的方法希望这样调用const newCar = AutoMaker.Car(&apos;premium&apos;);newCar.drive(); // &apos;Vrooom!&apos;// But since it&apos;s a library, lots of callers// in the wild are still doing this:// 但是由于这是一个库，许多用户依然这样使用const oldCar = new AutoMaker.Car();// Which of course throws:// TypeError: Cannot read property &apos;undefined&apos; of// undefined at new AutoMaker.Car// 这样的话，就会抛出：// TypeError: Cannot read property &apos;undefined&apos; of// undefined at new AutoMaker.Car</code></pre><p>在上面的例子中，我们首先提供了一个类，但是接下来希望提供不同的汽车种类。于是，工厂方法为不同的汽车种类使用了不同的原型。我曾经使用这种技术来存储不同的播放器接口，然后通过要处理的文件格式选择合适的原型。</p><h4 id="4-使用构造函数会导致instanceof具有欺骗性-1"><a href="#4-使用构造函数会导致instanceof具有欺骗性-1" class="headerlink" title="4. 使用构造函数会导致instanceof具有欺骗性"></a>4. 使用构造函数会导致<code>instanceof</code>具有欺骗性</h4><p>与工厂方法相比，构造函数带来的巨大变化就是<em><code>instanceof</code><em>的表现。人们有时使用</em><code>instanceof</code><em>进行类型检查。这种方式其实是经常会出问题的，我建议你避免使用</em><code>instanceof</code></em>。</p><blockquote><p><code>instanceof</code>会撒谎。</p></blockquote><pre><code>// instanceof is a prototype identity check.// NOT a type check.// instanceof是一个原型检查// 而不是类型检查// That means it lies across execution contexts,// when prototypes are dynamically reassigned,// and when you throw confusing cases like this// at it:function foo() {}const bar = { a: &apos;a&apos;};foo.prototype = bar;// Is bar an instance of foo? Nope!console.log(bar instanceof foo); // false// Ok... since bar is not an instance of foo,// baz should definitely not be an instance of foo, right?const baz = Object.create(bar);// ...Wrong.console.log(baz instanceof foo); // true. oops.</code></pre><p><em><code>instanceof</code><em>进行类型检查的方式和强类型语言不一样，它会将对象的</em><code>[[Prototype]]</code><em>对象和</em><code>Constructor.prototype</code></em>属性进行一致性检查。</p><p>例如，当执行上下文发生变化时，<em><code>instanceof</code><em>会发生错误。当</em><code>Constructor.prototype</code><em>变化了之后，</em><code>instanceof</code></em>一样不会正常工作。</p><p>当你从一个class或构造函数开始（这将会返回指向 <em><code>Constructor.prototype</code></em>的<em><code>this</code></em>），然后转而探索另外一个对象（没有指向 <em><code>Constructor.prototype</code></em>），这同样会导致instanceof的失败。这种情况在将构造函数转换为工厂函数时会出现。</p><p>简而言之，<em><code>instanceof</code></em>是另外一种将构造函数转换为工厂函数时会发生的<strong>巨大变化</strong>。</p><h3 id="使用class的优点-1"><a href="#使用class的优点-1" class="headerlink" title="使用class的优点"></a>使用class的优点</h3><ul><li>方便的，自包含的语法。</li><li>是JavaScript中使用类的一种单一、规范的方式。在ES6之前，在一些流行的库中已经出现了其实现方式。</li><li>对于有基于类的语言的背景的人来说，会更加熟悉。</li></ul><h3 id="使用class的缺点-1"><a href="#使用class的缺点-1" class="headerlink" title="使用class的缺点"></a>使用class的缺点</h3><p>除了具有构造函数的缺点外，还有：</p><ul><li>用户可能会尝试使用extends关键字来创建导致问题的多层级的类。</li></ul><p>多层级的类将会导致许多在面向对象程序设计中广为人知的问题，包括<strong>脆弱的基类问题，香蕉猴子雨林问题，必要性重复问题</strong>等等。不幸的是，class可以用来extends就像球可以用来扔，椅子可以用来坐一样自然。想了解更多内容，请阅读<a href="https://medium.com/javascript-scene/the-two-pillars-of-javascript-ee6f3281e7f3" target="_blank" rel="noopener">“The Two Pillars of JavaScript: Prototypal OO”</a> and <a href="https://medium.com/javascript-scene/inside-the-dev-team-death-spiral-6a7ea255467b" target="_blank" rel="noopener">“Inside the Dev Team Death Spiral”</a>.</p><p>值得指出的是，构造函数和工厂函数都有可能导致有问题的层次继承，但通过<em><code>extends</code>_关键字，class提供了一个让你犯错的功能可见性。换句话说，它鼓励你思考不灵活的的而且通常是错误的<em>is-a</em>关系，而不是更加灵活的_has-a</em> 或者 <em>can-do</em>组件化关系。</p><blockquote><p>功能可见性是让你能够执行一定动作的机会。例如，旋钮可以用来旋转，杠杆可以用来拉，按钮可以用来按，等等。</p></blockquote><h3 id="使用工厂方法的优点-1"><a href="#使用工厂方法的优点-1" class="headerlink" title="使用工厂方法的优点"></a>使用工厂方法的优点</h3><p>工厂方法比构造函数或类都要灵活，并且它不会诱惑人们使用<em><code>extends</code></em>来构造太深的继承层级。你可以使用多种方法来继承工厂函数。特别的，如果想了解组合式工厂方法，请查看<a href="https://github.com/stampit-org/stamp-specification" target="_blank" rel="noopener">Stamp Specification</a>。</p><h4 id="1-返回任意对象与使用任意原型-1"><a href="#1-返回任意对象与使用任意原型-1" class="headerlink" title="1. 返回任意对象与使用任意原型"></a>1. 返回任意对象与使用任意原型</h4><p>例如，你可以通过同一API轻松的创建多种类型的对象，例如，一个能够针对不同类型视频实例化播放器的媒体播放器，活着能够出发DOM事件或web socket事件的事件库。</p><p>工厂函数还能跨越之行上下文来实例化对象，充分利用对象池，并且允许更灵活的原型模型继承。</p><h4 id="2-没有重构的忧虑-1"><a href="#2-没有重构的忧虑-1" class="headerlink" title="2. 没有重构的忧虑"></a>2. 没有重构的忧虑</h4><p>你永远不需要从一个工厂转换到一个构造函数，所以重构将永远不会是一个问题。</p><h4 id="3-没有new-1"><a href="#3-没有new-1" class="headerlink" title="3. 没有new"></a>3. 没有<em><code>new</code></em></h4><p>关于要不要使用<em><code>new</code><em>只有一个选择，那就是不要用。（这将会使</em><code>this</code></em>表现不好，原因见下一点）。</p><h4 id="4-标准的this行为-1"><a href="#4-标准的this行为-1" class="headerlink" title="4. 标准的this行为"></a>4. 标准的<em><code>this</code></em>行为</h4><p><em><code>this</code></em>和它通常的表现一样，所以你可以用它来获取其父级对象。例如，在<em><code>player.create()</code></em>中，<em><code>this</code></em>指向player，正如其他方法调用那样。<em><code>call()</code></em> 和<em><code>apply()</code><em>也会同样的指向</em><code>this</code></em>。</p><h4 id="5-不会有欺骗性的instanceof问题-1"><a href="#5-不会有欺骗性的instanceof问题-1" class="headerlink" title="5. 不会有欺骗性的instanceof问题"></a>5. 不会有欺骗性的<em><code>instanceof</code></em>问题</h4><h4 id="6-有些人喜欢myFoo-createFoo-这种写法-1"><a href="#6-有些人喜欢myFoo-createFoo-这种写法-1" class="headerlink" title="6. 有些人喜欢myFoo = createFoo()这种写法"></a>6. 有些人喜欢<code>myFoo = createFoo()</code>这种写法</h4><h3 id="工厂方法的缺点-1"><a href="#工厂方法的缺点-1" class="headerlink" title="工厂方法的缺点"></a>工厂方法的缺点</h3><ul><li>不会创建一个指向<em><code>Factory.prototype</code><em>的链接——但这其实是件好事，因为这样你就不会得到一个具有欺骗性的</em><code>instanceof</code><em>。相反，</em><code>instanceof</code></em>会一直失败。详情见工厂方法的优点。</li><li><em><code>this</code></em>不会指向工厂方法中的新对象。详情见工厂方法的优点。</li><li>在经过微优化的基准中，工厂方法可能会稍微比构造函数模式慢一些。如果这对你有影响，请务必在你程序的上下文中进行测试。</li></ul><h3 id="结论-1"><a href="#结论-1" class="headerlink" title="结论"></a>结论</h3><p>在我看来，<em><code>class</code><em>或许有简单的语法形式，但这不能弥补它引诱粗心的用户在类继承中犯错的事实。对于未来它也是有风险的，因为你有可能会想将其升级成为一个工厂函数，而由于</em><code>new</code></em>关键字，你的所有调用都将和构造函数紧密耦合，于是从class向工厂方法迁移将会是一个巨大的改变。</p><p>你也许会想可以只重构调用部分，不过在大的团队中，或者你使用的class是公共API的一部分，你就有可能要破坏不在你掌控中的代码。换句话说，不能假设只重构调用部分永远是一个可选项。</p><p>关于工厂方法，有趣的事情在于它们不仅更加强大和灵活，而且是鼓励整个团队，以及所有API用户使用简单、灵活和安全的模式的最简单的方法。</p><p>关于工厂函数的好处，特别是关于对象组合的能力，还有许多内容可以详述。想要了解更多内容，以及这种方式与类继承的区别，请阅读<a href="https://medium.com/javascript-scene/3-different-kinds-of-prototypal-inheritance-es6-edition-32d777fa16c9" target="_blank" rel="noopener">“3 Different Kinds of Prototypal Inheritance”</a>.</p><hr><p>For more training in in prototypal inheritance techniques, factory functions, and object composition, be sure to check out <a href="https://ericelliottjs.com/product/webcast-monday-oct-19th-the-two-pillars-of-js-composition-with-prototypes/" target="_blank" rel="noopener">“The Two Pillars of JS: Composition with Prototypes”</a> — free for members. Not a member yet?</p><h3 id="Learn-JavaScript-with-Eric-Elliott-1"><a href="#Learn-JavaScript-with-Eric-Elliott-1" class="headerlink" title="Learn JavaScript with Eric Elliott"></a><a href="https://ericelliottjs.com/product/webcast-monday-oct-19th-the-two-pillars-of-js-composition-with-prototypes/" target="_blank" rel="noopener">Learn JavaScript with Eric Elliott</a></h3><hr><p><em><strong>Eric Elliott</strong></em>* is the author of _<a href="http://pjabook.com/" target="_blank" rel="noopener"><em>“Programming JavaScript Applications”</em></a>_ (O’Reilly), and _<a href="http://ericelliottjs.com/product/lifetime-access-pass/" target="_blank" rel="noopener"><em>“Learn JavaScript with Eric Elliott”</em></a>_. He has contributed to software experiences for <strong><strong>Adobe Systems</strong></strong>, <strong><strong>Zumba Fitness</strong></strong>, <strong><strong>The Wall Street Journal, ESPN</strong></strong>, <strong><strong>BBC</strong></strong>, and top recording artists including <strong><strong>Usher</strong></strong>, <strong><strong>Frank Ocean</strong></strong>,<strong><strong>Metallica</strong></strong>, and many more.*</p><p><em>He spends most of his time in the San Francisco Bay Area with the most beautiful woman in the world.</em></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React 数据阵营之 State 与 Props</title>
      <link href="/working-with-data-in-react-properties-state.html"/>
      <url>/working-with-data-in-react-properties-state.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://cloud.githubusercontent.com/assets/7554325/18606944/8f5768ce-7cf0-11e6-966f-decce36b0378.png" alt="image"></p><p>在任何应用中管理数据都是必不可少的。通过用户界面来编排数据流是一项具有挑战的工程。现代的 Web 应用会涉及复杂的 UI 交互，比如改变了一个地方的 UI 数据，需要直接或者间接的改变其他地方的 UI 数据。一些双向绑定的框架（比如：Angular.js 等）都是对这种场景比较好的解决方案。</p><p>对于一些应用（尤其是数据流比较简单的），这种双向绑定是非常快速和足够的解决方案。但是对于一些更加复杂的应用场景，数据双向绑定已经被证明是不够的，它会妨碍用户界面的设计。实际上，React 并没有解决这样一个复杂应用中比较复杂的数据流问题（虽然后面出现了 Flux 这种解决方案），但是他确实解决了一个组件中数据流的问题。</p><p>对于一个有上下文关系的组件， React 解决了数据流问题 —— 即通过更新 UI 来反应数据流的结果；除此之外，React 解决的另外一个问题是命名模式问题 —— 通过比较有创意的虚拟 DOM 解决。</p><h3 id="组件数据的类型"><a href="#组件数据的类型" class="headerlink" title="组件数据的类型"></a>组件数据的类型</h3><p>在 React 中组件的数据存储在 <code>props</code> 和 <code>state</code> 中。</p><p><code>props</code> 是一个组件的输入。他经常被用作渲染组件和初始化状态。当实例化完一个组件，<code>props</code> 应该是不可变的（持久的）。<code>props</code> 被用作在实例化组件的时候，然后组件将再次渲染 DOM，在这个过程中，React 将会对比新 <code>props</code> 和老 <code>props</code> 然后来确定哪些 DOM 的变化是必要的。</p><p>下面是一个设置 <code>props</code> 然后用 <code>props</code> 的变化来更新 DOM 的例子：</p><pre><code> &quot;use strict&quot;;var HelloWorld = React.createClass({  render: function() {    return (      &lt;div&gt;        &lt;span&gt;Counter: {this.props.count}&lt;/span&gt;        &lt;br /&gt;        &lt;input type=&quot;text&quot; /&gt;      &lt;/div&gt;    );  },});var  mainElement = document.querySelector(&quot;main&quot;),  count = 1;setInterval(function() {  ReactDOM.render(&lt;HelloWorld count={count++}&gt;&lt;/HelloWorld&gt;, mainElement);</code></pre><p><a href="http://codepen.io/SitePoint/pen/XKqQqN" target="_blank" rel="noopener">http://codepen.io/SitePoint/pen/XKqQqN</a></p><p><code>state</code> 可以通过组组件发生变化，这种变化经常会和组件的事件处理函数连接起来。通常情况下，<code>state</code> 的这种变化会触发组件的重新渲染。在组件初始化之前，他的 <code>state</code>必须先进行初始化，其值包含常数、<code>props</code>。</p><p>与 Angular 这样的框架相比，可以理解为 <code>props</code> 是单向数据绑定，<code>state</code> 是双向数据绑定。当然这并不是一种恰当的比喻： Angular 使用一种有两种方式的数据对象，而 React 是使用两种数据对象，每种对象都有着自己的使用方法。</p><h3 id="Props"><a href="#Props" class="headerlink" title="Props"></a>Props</h3><p>当我们给一个组件添加 <code>css</code> 样式的 <code>class</code> 时，我们必须用 <code>className</code>，而不是 <code>class</code>。这是因为在 ES 2015 中 <code>class</code> 是一个用来定义对象的保留字。为了去避免这种冲突，在 React 中使用了 <code>className</code>。如果你使用了 <code>class</code>，React 将会在 console 里面输出一段友好的提示，让你使用 <code>className</code> 而不是 <code>class</code>。</p><p>除了像 <code>className</code> 一样这些 <code>props</code> 的名字之外，<code>props</code> 还有一些其他有意思的地方。比如改变 props 的值就是一种<strong>反模式</strong>。<code>props</code> 应该在组件实例化之前就进行设置，在这之后进行设置是不可的。其中就包括在组件实例化之后（render 之后）。可变值在组件中被认为是状态，一般使用 <code>state</code> 而不是 <code>props</code>。</p><p>在下面的这个例子中，<code>someComponent</code> 实例化了，在这之后 <code>props</code> 的值发生了变化。</p><pre><code>var someComponent = &lt;SomeComponent /&gt;; someComponent.props.prop1 = “some value”; someComponent.props.prop2 = “some value”;</code></pre><p>改变 <code>props</code> 的值会让应用程序发生一些错误，并且这种错误是无法跟踪的。于此同时，改变 <code>props</code> 的值不会触发组件的再次渲染，这样就会让数据和界面不是同步的。</p><p>所以。<code>props</code> 应该在实例化的时候作为组件的一部分。</p><pre><code>var someComponent = &lt;SomeComponent prop1=”some value” prop2=”some value” /&gt;</code></pre><p>这样，<code>props</code> 发生变化的时候就会协调进行 DOM 树的对比，然后进行 UI 的更新。</p><h3 id="State"><a href="#State" class="headerlink" title="State"></a>State</h3><p><code>state</code> 表示组件内可变的状态，这个状态一般是由用户去作用而产生的。为了促成这种改变，事件处理程序将会作用在相应的 DOM 元素上，当事件触发之后，值将会从 DOM 上取得，然后去通知组件有一个新的 <code>state</code>。在组件使用 <code>state</code> 之前，<code>state</code> 必须通过 <code>getInitialState</code> 函数进行初始化。通常情况下，<code>getInitilaState</code> 函数通过静态值、<code>props</code> 或者其他数据源进行初始化 <code>state</code>。</p><pre><code>var Message = React.createClass({   getInitialState: function() {     return { message: this.props.message };   },</code></pre><p>一旦 <code>state</code> 被初始化，就能像 <code>props</code> 一样在组件中使用了。为了去捕获用户的行为带来，然后去更新 <code>state</code>，各种需要使用的事件函数都会注册。为了保持组件的独立（和其他组件之间只通过数据进行交换，较少耦合性），每个事件处理函数都可以以 <code>props</code>的形式进性传递，也可以直接在组件内进行定义。</p><pre><code>&quot;use strict&quot;;var Message = React.createClass({  getInitialState: function() {    return { message: this.props.message };  },  _messageChange: function(e) {    this.setState({ message: e.target.value });  },  render: function() {    return (      &lt;div&gt;        &lt;span&gt;Message: {this.state.message}&lt;/span&gt;        &lt;br /&gt;        Message: &lt;input type=&quot;text&quot; value={this.state.message} onChange={this._messageChange} /&gt;      &lt;/div&gt;    );  },});var mainElement = document.querySelector(&quot;main&quot;);ReactDOM.render(&lt;Message message=&quot;Hello World!!&quot; /&gt;, mainElement);</code></pre><p>React 的另外一个优点就是使用了标准的 HTML 事件。这样一来学习特殊的事件库，事件处理函数和第三方事件就不再是需要的。</p><p>为了去处理 <code>state</code> 的变化，<code>setState</code> 函数被用来设置 <code>state</code> 的新值。调用这个函数会触发组件的重新渲染。</p><h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>React 组件对数据提供了两种机制： <code>props</code> 与 <code>state</code>。他把数据清楚的划分为了持久性数据 <code>props</code> 与经常改变的数据 <code>state</code>，然后把这两种数据和组件产生关联。</p><p>通常意义上，对于简单的数据流 <code>props</code> 是首选的，<code>state</code> 对于捕获用户交互或者其他 UI 事件造成的数据更新是非常有用的。</p><p><code>props</code> 和 <code>state</code> 之间的关系促成了数据通过组件的流动。<code>props</code> 可以用来初始化 <code>state</code>，<code>state</code> 可以在初始化、渲染组件的使用设置 <code>props</code>。通过 <code>state</code> 来捕获用户输出的值、更新 <code>props</code>。</p><p>上面讨论的只是组件中数据流相关，对于大型的应用中的数据流建议使用 <code>Flux</code> 等</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>欢迎来到 HTML 5.2 时代</title>
      <link href="/welcome-to-html-5-2.html"/>
      <url>/welcome-to-html-5-2.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://res.i95.me/wp-content/uploads/2016/10/html5.2.jpg" alt="html"></p><p>21世纪，2016年6月，HTML 5.1从工作草案变为了候选标准。正如你了解的那样，这是将提案变为标准的第二步，Web的如此发展也将影响我们的日常生活。作为候选标准，W3C认为HTML 5.1已经通过了review并且能够满足工作组的技术需求了。</p><p>几天前，<a href="https://lists.w3.org/Archives/Public/public-webapps/2016JulSep/0086.html" target="_blank" rel="noopener">HTML 5.1被提案进入第三阶段：推荐标准（PR）</a>。这意味着这个规范只需要进行微量的修改就可以进入W3C标准的最后一阶段了。</p><p>随着HTML 5.1接近最后阶段，工作组开始关注于未来。于是工作组正式开始研究HTML 5.2工作草案，因此，W3C在社区中发布了<a href="https://www.w3.org/TR/html52/" target="_blank" rel="noopener">HTML 5.2规范</a>来让W3C成员、公众以及其他组织进行review。</p><p>HTML5凭借语义性、兼容性和不需要第三方依赖的API迅速席卷了整个互联网。这是一场革命性的技术变革。HTML 5.1保留了先前版本全部优良的特性又引入了一些语义元素的重大改进。想想HTML 5.1都带来了什么，可想而知HTML 5.2会更为惊艳。</p><p>在本文中，我将做一个关于HTML发展的简短的概述，包括HTML 5，HTML 5.1，和HTML 5.2中引入和废除的特性。</p><p>以下是本文的重点：</p><ul><li>HTML 5引入的语义元素概述；</li><li>关于HTML 5和HTML 5.1中新特性和未定案特性的变化；</li><li>HTML 5.2的介绍以及对于接下来可能发生的事的猜想；</li></ul><h2 id="HTML-5-新的语义元素"><a href="#HTML-5-新的语义元素" class="headerlink" title="HTML 5 新的语义元素"></a>HTML 5 新的语义元素</h2><p>HTML 5.1最伟大的创新之一就是引入了新的语义元素。它们也许（很有可能）会成为你如今日常写码的一部分。就是因为有了标记性的结构和语义，才使我们的站点有了很大改善。</p><p>我将主要提到的元素有：</p><ul><li><code>&lt;main&gt;</code> 定义主要内容;</li><li><code>&lt;nav&gt;</code> 定义主体模块或者导航链接的集合;</li><li><code>&lt;article&gt;</code> 包含独立于页面其他部分的内容；</li><li><code>&lt;header&gt;</code> 包含介绍部分或者是导航链接的集合；</li><li><code>&lt;footer&gt;</code> 定义了整个页面或其中一部分的页脚（并且通常包含原创作者，版权信息，联系方式和站点地图）；</li><li><code>&lt;aside&gt;</code>定义了所处内容的侧边栏，<code>&lt;section&gt;</code>定义了文档中特定的部分。</li></ul><p>将两个革命性的元素单独拿出来说，它们帮助我们解决了Flash等技术难题：</p><ul><li><code>&lt;audio&gt;</code>用来在文档中嵌入音频内容</li><li><code>&lt;video&gt;</code>用来在文档中嵌入视频内容</li></ul><p>在上面提到的所有元素中，最有争议的无非是<code>&lt;main&gt;</code>元素。在W3C规范的描述中它是页面中的主要内容，然而万维网超文本应用技术工作组(WHATWG)却定义<code>&lt;main&gt;</code>元素为其他元素主要内容的容器。由于这个区别，WHATWA没有限制一个文档中<code>&lt;main&gt;</code>元素出现的次数。按WHATWA的定义，如果你在一个页面中定义了多个<code>&lt;article&gt;</code>元素，你就可以给每个<code>&lt;article&gt;</code>标记<code>&lt;main&gt;</code>元素。</p><p>两种规范在其他方面也有一些不同，例如<code>&lt;hgroup&gt;</code>的存在（W3C标准中删除了此元素，但它仍旧存在于WHATWG中–译者注）。这篇文章中不会详细讲解这部分内容，如果你感兴趣可以阅读Aurelio De Rosa的这篇文章，<a href="http://developer.telerik.com/featured/w3c-vs-whatwg-html5-specs-differences-documented/" target="_blank" rel="noopener">W3C vs. WHATWG HTML5 规范 – 文档中的不同</a>，你可以从中了解到很多。</p><p>现在我们来看一下HTML 5和HTML 5.1中的不同。</p><h2 id="HTML-5-和-HTML-5-1的不同之处"><a href="#HTML-5-和-HTML-5-1的不同之处" class="headerlink" title="HTML 5 和 HTML 5.1的不同之处"></a>HTML 5 和 HTML 5.1的不同之处</h2><p>这部分将主要介绍HTML 5.1中一些尚未确定的元素、方法和属性。我将就其概念和优点进行介绍，并且提供了一些其他资料，如果感兴趣可以进行扩展阅读。需要注意的是，这里提到的大部分新元素都在HTML5中被提出却因为某些原因没有通过提案，所以对你来说也许并不陌生。例如 <code>&lt;details&gt;</code> 和<code>&lt;summary&gt;</code>就是从HTML 5转移至HTML 5.1规范中的。</p><p>就像其他规范一样，HTML 5.1也引入了一些被移除不久的特性。其中之一就是<strong>inert</strong>属性，它在2014年被提出。正如<a href="https://github.com/whatwg/html/commit/5ddfc78b1f82e86cc202d72ccc752a0e15f1e4ad" target="_blank" rel="noopener">Github上这个discussion中</a>所提到的，这个属性自从被归入<code>&lt;dialog&gt;</code>元素后就被遗弃了。</p><p>开始使用新的元素吧~</p><h3 id="HTML-5-1引入的新元素"><a href="#HTML-5-1引入的新元素" class="headerlink" title="HTML 5.1引入的新元素"></a>HTML 5.1引入的新元素</h3><p>第一个准备讲的就是<code>&lt;picture&gt;</code>元素。它的用处就是把<strong>source</strong>元素和<strong>srcset</strong>属性结合到一起，更方便的是当网页展示在小屏幕（例如移动设备）上时，它可以提供内存和尺寸较小的图片。</p><p><code>&lt;picture&gt;</code>元素的另一个功能就是当页面加载在高分辨率屏幕上的时候就提供高密度的图片。由于这个元素的存在，你可以更好的给用户展示图片并且很好的避免过大的高密度图片与网站不相称。如果你想更多的了解，可以阅读我的另外两篇文章：<a href="https://www.sitepoint.com/improving-responsive-images-picture-element/" target="_blank" rel="noopener">使用Picture元素提升响应式图片</a> 和 <a href="https://www.sitepoint.com/responsive-images-part-1-using-srcset/" target="_blank" rel="noopener">响应式图片第一步：使用srcset</a>。当然也有一些人主张<a href="https://css-tricks.com/dont-use-picture-time/" target="_blank" rel="noopener">picture元素的不必要的 (大多数时候)</a>。不管怎样，这都取决于你的选择。</p><p>接下来介绍<code>&lt;dialog&gt;</code>元素，当下有Chrome和Opera已经对其进行支持，<a href="https://developer.microsoft.com/en-us/microsoft-edge/platform/status/dialogelementformodals/" target="_blank" rel="noopener">微软Edge则仍在考虑中</a>。这个元素可以用来作为对话框，确认框或者窗体。可以通过把<code>&lt;form&gt;</code>元素的method属性设置为<strong>dialog</strong>来把其合并到<code>&lt;dialog&gt;</code>元素中。这样这个form表单提交的时候，这个对话框就会关闭同时把提交按钮返回的值设置为<strong>returnValue</strong>。这里有一个在线的demo，<a href="https://developer.mozilla.org/en/docs/Web/HTML/Element/dialog" target="_blank" rel="noopener">代码来自MDN</a>, <a href="https://jsfiddle.net/8jLhoqd1/" target="_blank" rel="noopener">由JSFiddle展示</a>。</p><p>同时<code>&lt;details&gt;</code>和<code>&lt;summary&gt;</code>也是值得推荐的新增元素。<code>&lt;details&gt;</code>展示给用户 在这个组件上可以获取额外的信息或者控件。<code>&lt;summary&gt;</code>元素作为总结，标题，或是图例放在<code>&lt;details&gt;</code>的内容中，二者互相配合。目前有Chrome，Firefox（版本49+），Opera，Safari支持了<code>&lt;details&gt;</code>元素。我认为这两个元素未来会在折叠/展开组件上起很大作用。</p><h3 id="HTML-5-1其他新增"><a href="#HTML-5-1其他新增" class="headerlink" title="HTML 5.1其他新增"></a>HTML 5.1其他新增</h3><p>除了这些元素，HTML 5.1还添加了如下新增：</p><ul><li><code>&lt;input&gt;</code>元素的<strong>type</strong>属性新增了<strong>month</strong>和<strong>week</strong>两个值。正如它们名字所表示的那样，它们定义控件将元素的值设置为代表一个月或者一周的字符串。</li><li><strong>forceSpellcheck()</strong>方法加入到<strong>HTMLElement</strong>接口中，并且允许开发者通过在元素上调用此函数强制用户执行拼写和语法检查，即使用户没有聚焦这个单词。其中一个用途就是<strong>inputElement.forceSpellcheck()</strong>。不幸的是还没有浏览器支持这个特性。</li><li><strong>allowfullscreen</strong>是<strong>iframe</strong>元素的一个布尔类型属性，它指定了当调用<code>requestFullScreen()</code>方法时，<strong>iframe</strong>是否接受全屏。当该属性未被指定时，默认元素不接受全屏模式。</li><li><strong>reportValidity()</strong>方法被调用时，强制用户进行<code>&lt;form&gt;</code>元素的约束校验。比如当一个<strong>必填</strong>元素没有被填写或者一个字段涉及到它的<strong>pattern</strong>属性时。如果约束的校验返回正确的结果时，这个函数会返回<strong>true</strong>，反之则返回<strong>false</strong>。目前有Chrome和Opera支持了这个方法。</li></ul><h3 id="未定案的特性"><a href="#未定案的特性" class="headerlink" title="未定案的特性"></a>未定案的特性</h3><p>HTML 5.1规范中也描述了一些当前被认为<em>“at risk”</em>的特性。</p><p>我要提的第一个未定案的特性就是<code>&lt;menu&gt;</code>元素。它代表了菜单指令的集合，它原本是被设计用来创建工具栏和弹出菜单的。当下Chrome和Opeara只有在<em>实验性网络平台（Experimental Web Platform features）</em>打开后才能支持，并且只支持context menu，不支持button menu。Firefox的近期版本也是同样，目前的其他浏览器没有可以支持的。</p><p>接下来要介绍的特性是<code>&lt;menuitem&gt;</code>元素，定义了用户可以从弹出菜单中调用的命令。在变种包含了context menu，同时menu可能关联了一个menu button。当下Chrome和Opeara只有在<em>实验性网络平台（Experimental Web Platform features）</em>打开后才能支持，并且只支持<strong>type=”command”</strong>。在Firefox中也只有当关闭tag后才能支持带有<strong>contextmenu</strong>属性的<code>&lt;menu&gt;</code>。IE和Edge都没有支持该元素。</p><p>另一个未定案的特性则是<code>&lt;keygen&gt;</code>。这个元素会在控件的表单提交的时候生成一对密钥，私有密钥会存储在本地的keystore中，公有密钥则会被打包发送到服务器。 In addition to these elements, the following features are also considered at risk: 除了上面提到的这些元素，下面这些特性也同样没有确定：</p><ul><li><code>&lt;input&gt;</code>元素的<strong>type</strong>的<strong>datatime</strong>和<strong>datatime-local</strong>两个值。前者用来定义一个特定地区的日期和时间，候着则是代表本地日期和时间，没有时区偏移量信息。</li><li><strong>context</strong>属性为<code>&lt;div&gt;</code>指定了一个context menu，并且当用户右键点击div时会显示菜单。所有的浏览器中，只有Firefox支持了这个属性。</li><li><strong>inputmode</strong>属性。它指定了当用户在表格控件中输入内容时，输入机制会提供更多的帮助。</li></ul><p>好了，现在你已经知道了HTML 5.1做了哪些改变，可以进一步了解工作组现在在研究的规范内容了。</p><h2 id="HTML-5-2会带来什么"><a href="#HTML-5-2会带来什么" class="headerlink" title="HTML 5.2会带来什么"></a>HTML 5.2会带来什么</h2><p><a href="https://www.w3.org/TR/html52/" target="_blank" rel="noopener">HTML 5.2规范</a>的制定工作才刚刚开始，所以此时此刻还没办法猜测出很多东西。</p><p>最重要的特性之一就是<code>&lt;script type=&quot;module&quot;&gt;</code>和对于模块如何分解、获取和评估，这也是制定HTML 5.2将要讨论的一部分。这个特性加入了对于加载JavaScript模块的支持，以及分解、获取、解析、评估模块所必须的依赖。关于这个话题想了解更多的话，可以阅读WHATWG的<a href="https://blog.whatwg.org/js-modules" target="_blank" rel="noopener">为Web平台添加JavaScript模块</a>这篇文章。</p><p>另一个开发中的特性就是<a href="https://html.spec.whatwg.org/multipage/semantics.html#meta-theme-color" target="_blank" rel="noopener">关于 <code>&lt;meta name=&quot;theme-color&quot;&gt;</code> 的定义</a>。它的值可以是包括HEX和RGB在内的任何你在CSS中使用的颜色。一旦页面中如此使用了，只要浏览器和操作系统定制了用户界面，这个新的meta标签就会建议它们使用这个颜色。你可以看到Android端的Chrome浏览器已经像下图这样做出这样的行为。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/html5.2_android.jpg" alt="theme-color"></p><p>对于<strong>autocapitalize</strong>属性的标准化也在讨论中。当前Safari在IOS上对它的支持由于版本的不同有两种不同的实现。老版本（IOS 5之前）是作为布尔型属性，而新版本则支持不同的值。已经有<a href="https://github.com/mounirlamouri/html-autocapitalize" target="_blank" rel="noopener">提案</a> 发布建议以一种独特的方式让所有浏览器支持这个属性。</p><p>最后我想提一下这个关于<a href="http://www.informit.com/articles/article.aspx?p=1729269&amp;seqNum=5" target="_blank" rel="noopener">大纲算法</a>概念的<a href="https://github.com/w3c/html/issues/33" target="_blank" rel="noopener">discussion</a>。轮廓算法是一种基于节段元素的结构而不是标题的level来提供Web页面大纲的机制。理论上，你可以在一个页面中所有的标题都使用h1，只要把标题放置于正确的节段元素中，就可以创建出结构化文档。然而实际上还没有任何代理实现了它，因此<a href="https://www.paciellogroup.com/blog/2013/10/html5-document-outline/" target="_blank" rel="noopener">在网站中依赖这个算法是非常危险的</a>。</p><p>除了开发新的特性之外，工作组同样致力于使浏览器实现已存在的特性。<a href="https://github.com/w3c/html/issues/236" target="_blank" rel="noopener">其中之一</a>就是 <code>&lt;input&gt;</code>元素与一个<code>&lt;datalist&gt;</code>元素关联时的行为。</p><p>如果你想了解关于工作组工作重点的其他细节，可以关注这个<a href="https://github.com/w3c/html/issues/368" target="_blank" rel="noopener">GitHub issue</a>。</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>程序员高级装逼指南</title>
      <link href="/programmer-presentation-guide.html"/>
      <url>/programmer-presentation-guide.html</url>
      
        <content type="html"><![CDATA[<h1 id="程序员高级装逼指南"><a href="#程序员高级装逼指南" class="headerlink" title="程序员高级装逼指南"></a>程序员高级装逼指南</h1><p><img src="https://res.i95.me/wp-content/uploads/2016/10/w1.jpg" alt></p><p><strong><a href="https://link.zhihu.com/?target=https%3A//www.shiyanlou.com/courses/558" target="_blank" rel="noopener">《 C++ 实现太阳系行星系统 》</a></strong></p><p>手把手教你用 OpenGL GLUT 编写一个简单的太阳系运行系统，只需要有C ++语言基础就可实现。</p><p>每天上班前5分钟，翘着二郎腿看看自己的星球运转情况，请感受其他部门的人投来的炙热目光。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/w2.png" alt></p><p><strong><a href="https://link.zhihu.com/?target=https%3A//www.shiyanlou.com/courses/142" target="_blank" rel="noopener">《 基于scrapy爬虫的天气数据采集(python) 》</a></strong></p><p>星球有了，下一步要实现天气系统了。利用Scrapy，几步就可以实现对全球天气的爬取。</p><p>程序员星球正在诞生…..</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/w3.png" alt></p><p><a href="https://link.zhihu.com/?target=https%3A//www.shiyanlou.com/courses/599" target="_blank" rel="noopener">《 高德API+Python解决租房问题 》</a></p><p>每一个租过房的人都知道这事有多烦！线下中介房源少、范围小；线上租房好不容易找到个交通方便、价钱合适的，现场一看完全和网上不一样！</p><p>这时，就能体现出程序员如何改变世界了。</p><p>只要你会最基础的Python，配合高德地图提供的API，就能定制你所需要的房源，实现下图效果！</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/w4.jpg" alt></p><p>身边再有人想租房时，请静静打开你的程序，输入信息并按下回车键，之后，带上耳机，不理会背后的尖叫声。</p><p>果然，我们程序员才是最高贵的，科科。</p><p><a href="https://link.zhihu.com/?target=https%3A//www.shiyanlou.com/courses/623" target="_blank" rel="noopener">《 Python3 实现火车票查询工具 》</a></p><p>程序员怎么查火车票？</p><p>12306？拜托，输对验证码的人都能去当古董鉴定师了。</p><p>去哪？携程？拜托，初中生都会的东西，怎么拿来装逼？</p><p>正确的做法是用 Python 写一个命令行版的火车票查看器，只需敲一行命令就能获得你想要的火车票信息，如下图！</p><p>就问你6不6！</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/w5.png" alt></p><p><a href="https://link.zhihu.com/?target=https%3A//www.shiyanlou.com/courses/358" target="_blank" rel="noopener">《 R语言股票数据分析 》</a></p><p>每个人都知道股市中的消息不可信，但又不得不信。归根结底是因为信息不对等，他们无法获得可信的信息。</p><p>但程序员知道，只要数据是不会骗人的。当别人讨论着某条小道消息是真是假时，你只需打开做好的数据分析程序，泡一杯咖啡，然后看着面前的大数据云卷云舒即可。</p><p>滚雪球，本应如此装逼。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/w6.jpg" alt></p><p><a href="https://link.zhihu.com/?target=https%3A//www.shiyanlou.com/courses/47" target="_blank" rel="noopener">《 Linux桌面词典 》</a></p><p>单词不懂怎么办？普通青年用百度，二逼青年翻字典，而我们文艺又装逼的程序员，只需要300行代码，便可一劳永逸。</p><p>同时，这个教程也解决了Linux上没有像有道词典一样简单好用的翻译系统的难题。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/w7.png" alt></p><p><a href="https://link.zhihu.com/?target=https%3A//www.shiyanlou.com/courses/271" target="_blank" rel="noopener">《 亲戚称谓计算器 》</a></p><p>爸爸的爸爸叫爷爷，那爸爸的姐姐的丈夫的弟弟的儿子的奶奶叫什么？</p><p>这种问题可难不倒机智的程序员，只需利用linux，便可完成下图中的“亲戚称谓计算器”。当大家都一片懵逼不知道该怎么喊时，你只需轻轻一点，“姻伯母”脱口而出！自己怎么能这么吊，晚上加个菜！</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/w8.png" alt></p><p>类似的练手项目课这里还有数百个：<a href="https://link.zhihu.com/?target=https%3A//www.shiyanlou.com/courses/" target="_blank" rel="noopener">项目课</a></p><p>如果你也有好玩有趣的项目，也欢迎投稿过来和大家一期分享：<a href="https://link.zhihu.com/?target=https%3A//www.shiyanlou.com/contribute" target="_blank" rel="noopener">项目投稿</a></p><p>下面这份装逼指南转载自网络（简书 <a href="https://link.zhihu.com/?target=http%3A//www.jianshu.com/p/c2f71148cec6" target="_blank" rel="noopener">程序员装逼指南</a>），小伙伴们很有共鸣，一起放上来，看看你又占了几条呢？</p><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p><strong>“工欲善其事必先利其器。”</strong></p><ol><li>双屏电脑：电脑不一定要配置高，但是双屏是必须的，越大越好，能一个横屏一个竖屏更好。一个用来查资料，一个用来写代码 。总之要显得信息量很大，效率很高。</li><li>椅子不一定要舒服，但是一定要可以半躺着。</li><li>大量的便签，各种的颜色的，用来记录每天要完成的事务，多多益善。沿着电脑屏幕的边框，尽量贴满，显出有很多事情的样子。</li></ol><h2 id="从进门开始…"><a href="#从进门开始…" class="headerlink" title="从进门开始…"></a>从进门开始…</h2><p><img src="https://res.i95.me/wp-content/uploads/2016/10/w9.jpg" alt></p><ol><li>着装！着装！初级装：衬衣+牛仔裤+休闲鞋。中级装：T恤+宽松短裤+拖鞋。高级装：背心+宽松大花裤衩+人字拖。</li><li>得体的举止。在走廊以及任何形式的过道里，一定要双手插兜，走得像个痞子，至少要看起来有点反社会。如若不行，可走文弱天才型geek路线。</li></ol><h2 id="坐下就不要再动了"><a href="#坐下就不要再动了" class="headerlink" title="坐下就不要再动了"></a>坐下就不要再动了</h2><p><img src="https://res.i95.me/wp-content/uploads/2016/10/w10.jpg" alt></p><ol><li>坐下以后，姿势需要略微后仰，能翘着二郎腿最好了，然后在后仰的情况下低着头，以便看到屏幕，然后千万就不要再动了。</li><li>粗暴地把电脑前的大堆书推开一个口，然后摘下电脑上的一个便签，看一眼，不过3秒，可以开始coding了。</li><li>能不用IDE就不要用，实在装不了，无论IDE是什么，一定要调成DOS那种黑色背景的。</li><li>如果写前台界面，就不停地调试后台代码；如果写java，就在里面混编C；如果写C，就在里面混编汇编。不光要coding，还要时不时的翻出一本什么英文的书翻一翻，看不懂就看看插图，然后扔到面前假装懂了继续coding。</li><li>什么看起来高端就用什么，不要管实用不实用。例如对C++：switch统统重构成多态；如果有指针，统统改成智能的；C++一定要自己写 template；数字是全部要替换成宏的名字能起多长就起多长。</li></ol><h2 id="潇洒的离开"><a href="#潇洒的离开" class="headerlink" title="潇洒的离开"></a>潇洒的离开</h2><ol><li>人走，主机是千万千万不能关的，至少要跑个daily build，实在不行正在svn提交也勉强算过关。</li><li>书应该已经又堆到屏幕前了，千万不要整理，明天再来推开。</li><li>走得时候一定要率性，千万不要收拾任何东西，站起来，出门，好的，就这样。</li></ol>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>附录四、GraphQL/Relay 初体验</title>
      <link href="/reactjs-getting-started-14.html"/>
      <url>/reactjs-getting-started-14.html</url>
      
        <content type="html"><![CDATA[<h1 id="附录四、GraphQL-Relay-初体验"><a href="#附录四、GraphQL-Relay-初体验" class="headerlink" title="附录四、GraphQL/Relay 初体验"></a>附录四、GraphQL/Relay 初体验</h1><p><img src="https://res.i95.me/wp-content/uploads/2016/10/relay-graphql.png" alt="Relay/GraphQL 初体验"></p><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>GraphQL 的出现主要是为了要解决 Web/Mobile 端不断增加的 API 请求所衍生的问题。由于 RESTful 最大的功能在于很有效的前后端分离和建立 stateless 请求，然而 RESTful API 的资源设计上比较偏向单方面的互动，若是有著複杂资源间的关联就会出现请求次数过多，遇到不少的瓶颈。</p><h3 id="GraphQL-初体验"><a href="#GraphQL-初体验" class="headerlink" title="GraphQL 初体验"></a>GraphQL 初体验</h3><blockquote><p>GraphQL is a data query language and runtime designed and used at Facebook to request and deliver data to mobile and web apps since 2012.</p></blockquote><p>根据 <a href="http://graphql.org/" target="_blank" rel="noopener">GraphQL 官方网站</a>的定义，GraphQL 是一个资料查询语言和 runtime。Query responses 是由 client 所宣告决定，而非 server 端，且只会回传 client 所宣告的内容。此外，GraphQL 是强型别（strong type）且可以容易使用阶层（hierarchical）和处理複杂的资料关连性，并更容易让前端工程师和产品工程师定义 Schema 来使用，赋予前端对于资料的制定能力。</p><p>GraphQL 主要由以下元件构成：</p><p>类别系统（Type System） 查询语言（Query Language）：在 Operations 中 query 只读取资料而 mutation 写入操作 执行语意（Execution Semantics） 静态验证（Static Validation） 类别检查（Type Introspection）</p><p>一般 RESTful 在取用资源时会对应到 HTTP 中 <code>GET</code>、<code>POST</code>、<code>DELETE</code>、<code>PUT</code> 等方法，并以 URL 对应的方式去取得资源，例如：</p><p>取得 id 为 3500401 的使用者资料：</p><p>GET <code>/users/3500401</code></p><p>以下则是 GraphQL 宣告的 query 范例，宣告式（declarative）的方式比起 RESTful 感觉起来相对直观：</p><pre><code>{  user(id: 3500401) {    id,    name,    isViewerFriend,    profilePicture(size: 50)  {      uri,      width,      height    }  }}</code></pre><p>接收到 GraphQL query 后 server 回传结果：</p><pre><code>{  &quot;user&quot; : {    &quot;id&quot;: 3500401,    &quot;name&quot;: &quot;Jing Chen&quot;,    &quot;isViewerFriend&quot;: true,    &quot;profilePicture&quot;: {      &quot;uri&quot;: &quot;http://someurl.cdn/pic.jpg&quot;,      &quot;width&quot;: 50,      &quot;height&quot;: 50    }  }}</code></pre><h4 id="实战演练"><a href="#实战演练" class="headerlink" title="实战演练"></a>实战演练</h4><p>在 GraphQL 中有取得资料 Query、更改资料 Mutation 等操作。以下我们先介绍如何建立 GraphQL Server 并取得资料。</p><ol><li>环境建置 接下来我们将动手建立 GraphQL 的简单范例，让大家感受一下 GraphQL 的特性，在这之前我们需要先安装以下套件建立好环境： 1. <a href="https://github.com/graphql/graphql-js" target="_blank" rel="noopener">graphql</a>：GraphQL 的 JavaScript 实作.</li><li><a href="https://github.com/expressjs/express" target="_blank" rel="noopener">express</a>：Node web framework.</li><li><p><a href="https://github.com/graphql/express-graphql" target="_blank" rel="noopener">express-graphql</a>, an express middleware that exposes a GraphQL server. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">    $ npm init  </span><br><span class="line">    $ npm install graphql express express-graphql --save</span><br><span class="line"></span><br><span class="line">    2. Data 格式设计 以下是 `data.json`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&#123;  </span><br><span class="line">&quot;1&quot;: &#123;  </span><br><span class="line">&quot;id&quot;: &quot;1&quot;,  </span><br><span class="line">&quot;name&quot;: &quot;Dan&quot;  </span><br><span class="line">&#125;,  </span><br><span class="line">&quot;2&quot;: &#123;  </span><br><span class="line">&quot;id&quot;: &quot;2&quot;,  </span><br><span class="line">&quot;name&quot;: &quot;Marie&quot;  </span><br><span class="line">&#125;,  </span><br><span class="line">&quot;3&quot;: &#123;  </span><br><span class="line">&quot;id&quot;: &quot;3&quot;,  </span><br><span class="line">&quot;name&quot;: &quot;Jessie&quot;  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    3. Server 设计</span><br></pre></td></tr></table></figure></p><p> // 引入函式库<br> import graphql from ‘graphql’;<br> import graphqlHTTP from ‘express-graphql’;<br> import express from ‘express’;</p><p> // 引入 data<br> const data = require(‘./data.json’);</p><p> // 定义 User type 的两个子 fields：<code>id</code> 和 <code>name</code> 字串，注意型别对于 GraphQL 非常重要<br> const userType = new graphql.GraphQLObjectType({<br>   name: ‘User’,<br>   fields: {</p><pre><code>id: { type: graphql.GraphQLString },name: { type: graphql.GraphQLString },</code></pre><p>   }<br> });</p><p> const schema = new graphql.GraphQLSchema({<br>   query: new graphql.GraphQLObjectType({</p><pre><code>name: &apos;Query&apos;,fields: {  user: {      // 使用上面定义的 userType    type: userType,    // 定义所接受的 user 参数    args: {      id: { type: graphql.GraphQLString }    },    // 当传入参数后 resolve 如何处理回传 data    resolve: function (_, args) {      return data[args.id];    }  }}</code></pre><p>   })<br> });</p><p> // 启动 graphql server<br> express()<br>   .use(‘/graphql’, graphqlHTTP({ schema: schema, pretty: true }))<br>   .listen(3000);</p><p> console.log(‘GraphQL server running on <a href="http://localhost:3000/graphql&#39;)" target="_blank" rel="noopener">http://localhost:3000/graphql&#39;)</a>;</p></li></ol><p>在终端机执行：</p><pre><code>node index.js</code></pre><p>这个时候我们可以打开浏览器输入 <code>localhost:3000/graphql.</code>，由于没有任何 Query，目前会出现以下画面：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/graphql-demo-1.png" alt="Relay/GraphQL 初体验"><br>4. Query 设计 当 GraphQL 指令为：</p><pre><code>{  user(id: &quot;1&quot;) {    name  }}</code></pre><p>将回传资料：</p><pre><code>{  &quot;data&quot;: {    &quot;user&quot;: {      &quot;name&quot;: &quot;Dan&quot;    }  }}</code></pre><p>在了解了资料和 Query 设计后，这个时候我们可以打开浏览器输入（当然也可以透过终端机 curl 的方式执行）： <code>http://localhost:3000/graphql?query={user(id:&quot;1&quot;){name}}</code>，此时 server 会根据 GET 的资料回传：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/graphql-demo-2.png" alt="Relay/GraphQL 初体验"></p><p>到这裡，你已经完成了最简单的 GraphQL Server 设计了，若你遇到编码问题，可以尝试使用 JavaScript 中的 <code>encodeURI</code> 去进行转码。也可以自己尝试不同的 Schema 和 Query，感受一下 GraphQL 的特性。事实上，GraphQL 还拥有许多有趣的特色，例如：Fragment、指令、Promise 等，若读者对于 GraphQL 有兴趣可以进一步参考 <a href="http://graphql.org/" target="_blank" rel="noopener">GraphQL 官网</a>。</p><h3 id="Relay-初体验"><a href="#Relay-初体验" class="headerlink" title="Relay 初体验"></a>Relay 初体验</h3><blockquote><p>Relay is a new framework from Facebook that provides data-fetching functionality for React applications.</p></blockquote><p>在体验完 GraphQL 后，我们要来聊聊 Relay。Relay 是 Facebook 为了满足大型应用程式开发所建构的框架，主要用于处理 React 应用层（Application）的资料互动框架。在 Relay 中可以让每个 Component 透过 GraphQL 的整合处理可以精确地向 Component props 提供取得的数据，并在 client side 存放一份所有数据的 store 当作暂存。</p><p>整个 Relay 架构流程图：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/relay-architecture.png" alt="Relay/GraphQL 初体验"></p><p>一般来说要使用 Relay 必须先准备好以下三项工具：</p><ol><li>A GraphQL Schema - <a href="https://github.com/graphql/graphql-js" target="_blank" rel="noopener">graphql-js</a></li></ol><ul><li><a href="https://github.com/graphql/graphql-relay-js" target="_blank" rel="noopener">graphql-relay-js</a></li></ul><ol start="2"><li>A GraphQL Server - <a href="https://github.com/expressjs/express" target="_blank" rel="noopener">express</a></li></ol><ul><li><a href="https://github.com/graphql/express-graphql" target="_blank" rel="noopener">express-graphql</a></li></ul><ol start="3"><li>Relay - <a href="https://github.com/facebook/relay/tree/master/src/network-layer/default" target="_blank" rel="noopener">network layer</a>：Relay 透过 network layer 传 GraphQL 给 server</li></ol><p>接下来我们来透过 React 官方上的范例来让大家感受一下 Relay 的特性。上面我们有提过：在 Relay 中可以让每个 Component 透过 GraphQL 的整合处理可以更精确地向 Component props 提供取得的数据，并在 client side 存放一份所有数据的 store 当作暂存。所以，首先我们先建立每个 Component 和 GraphQL/Relay 的对应：</p><pre><code>// 建立 Tea Component，从 this.props.tea 取得资料class Tea extends React.Component {  render() {    var {name, steepingTime} = this.props.tea;    return (      &lt;li key={name}&gt;        {name} (&lt;em&gt;{steepingTime} min&lt;/em&gt;)      &lt;/li&gt;    );  }}// 使用 Relay.createContainer 建立资料沟通窗口 Tea = Relay.createContainer(Tea, {  fragments: {    tea: () =&gt; Relay.QL`      fragment on Tea {        name,        steepingTime,      }    `,  },});class TeaStore extends React.Component {  render() {    return &lt;ul&gt;      {this.props.store.teas.map(        tea =&gt; &lt;Tea tea={tea} /&gt;      )}    &lt;/ul&gt;;  }}TeaStore = Relay.createContainer(TeaStore, {  fragments: {    store: () =&gt; Relay.QL`      fragment on Store {        teas { ${Tea.getFragment(&apos;tea&apos;)} },      }    `,  },});// Route 设计class TeaHomeRoute extends Relay.Route {  static routeName = &apos;Home&apos;;  static queries = {    store: (Component) =&gt; Relay.QL`      query TeaStoreQuery {        store { ${Component.getFragment(&apos;store&apos;)} },      }    `,  };}ReactDOM.render(  &lt;Relay.RootContainer    Component={TeaStore}    route={new TeaHomeRoute()}  /&gt;,  mountNode);</code></pre><p>GraphQL Schema 和 store 建立：</p><pre><code>// 引入函式库import {  GraphQLInt,  GraphQLList,  GraphQLObjectType,  GraphQLSchema,  GraphQLString,} from &apos;graphql&apos;;// client side 暂存 store，GraphQL Server reponse 会更新 store，再透过 props 传递给 Componentconst STORE = {  teas: [    {name: &apos;Earl Grey Blue Star&apos;, steepingTime: 5},    {name: &apos;Milk Oolong&apos;, steepingTime: 3},    {name: &apos;Gunpowder Golden Temple&apos;, steepingTime: 3},    {name: &apos;Assam Hatimara&apos;, steepingTime: 5},    {name: &apos;Bancha&apos;, steepingTime: 2},    {name: &apos;Ceylon New Vithanakande&apos;, steepingTime: 5},    {name: &apos;Golden Tip Yunnan&apos;, steepingTime: 5},    {name: &apos;Jasmine Phoenix Pearls&apos;, steepingTime: 3},    {name: &apos;Kenya Milima&apos;, steepingTime: 5},    {name: &apos;Pu Erh First Grade&apos;, steepingTime: 4},    {name: &apos;Sencha Makoto&apos;, steepingTime: 2},  ],};// 设计 GraphQL Typevar TeaType = new GraphQLObjectType({  name: &apos;Tea&apos;,  fields: () =&gt; ({    name: {type: GraphQLString},    steepingTime: {type: GraphQLInt},  }),});// 将 Tea 整合进来var StoreType = new GraphQLObjectType({  name: &apos;Store&apos;,  fields: () =&gt; ({    teas: {type: new GraphQLList(TeaType)},  }),});// 输出 GraphQL Schemaexport default new GraphQLSchema({  query: new GraphQLObjectType({    name: &apos;Query&apos;,    fields: () =&gt; ({      store: {        type: StoreType,        resolve: () =&gt; STORE,      },    }),  }),});</code></pre><p>限于篇幅，我们只能让大家感受一下 Relay 的简单范例，若大家想进一步体验 Relay 的优势，已经帮你准备好 GraphQL Server、transpiler 的 <a href="https://github.com/relayjs/relay-starter-kit" target="_blank" rel="noopener">Relay Starter Kit</a> 专案会是个很好的开始。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>React 生态系中，除了前端 View 的部份有革新性的创新外，GraphQL 更是对于资料取得的全新思路。虽然 GraphQL 和 Relay 已经成为开源专案，但技术上仍持续演进，若需要在团队 production 上导入仍可以持续观察。到这边，若是一路从第一章看到这裡的读者真的要给自己一个热烈掌声了，我知道对于初学者来说 React 庞大且有许多的新的观念需要消化，但如同笔者在最初时所提到的，学习 React 重要的是透过这个生态系去学习现代化网页开发的工具和方法以及思路，成为更好的开发者。根据前端摩尔定律，每半年就有一次大变革，但基本 Web 问题和观念依然不变，大家一起加油啦！若有任何问题都欢迎来信给笔者或是发 <code>issue</code>，当然 PR is welcome 🙂</p><h3 id="延伸阅读"><a href="#延伸阅读" class="headerlink" title="延伸阅读"></a>延伸阅读</h3><ol><li><a href="https://medium.com/the-graphqlhub/your-first-graphql-server-3c766ab4f0a2#.7e02np1rs" target="_blank" rel="noopener">Your First GraphQL Server</a></li><li><a href="http://qianduan.guru/2016/01/03/Your-First-GraphQL-Server/" target="_blank" rel="noopener">搭建你的第一个 GraphQL 服务器</a></li><li><a href="https://learngraphql.com/" target="_blank" rel="noopener">Learn GraphQL</a></li><li><a href="https://kadira.io/blog/graphql/graphql-vs-relay" target="_blank" rel="noopener">GraphQL vs Relay</a></li><li><a href="http://graphql.org/" target="_blank" rel="noopener">GraphQL 官网</a></li><li><a href="https://facebook.github.io/relay/" target="_blank" rel="noopener">Relay 官网</a></li><li><a href="https://github.com/graphql/graphql-js" target="_blank" rel="noopener">A reference implementation of GraphQL for JavaScript</a></li><li><a href="http://taobaofed.org/blog/2016/03/10/graphql-in-depth/" target="_blank" rel="noopener">深入理解 GraphQL</a></li><li><a href="http://taobaofed.org/blog/2015/11/26/graphql-basics-server-implementation/" target="_blank" rel="noopener">Node.js 服务端实践之 GraphQL 初探</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>附录三、React 测试入门教学</title>
      <link href="/reactjs-getting-started-13.html"/>
      <url>/reactjs-getting-started-13.html</url>
      
        <content type="html"><![CDATA[<h1 id="附录三、React-测试入门教学"><a href="#附录三、React-测试入门教学" class="headerlink" title="附录三、React 测试入门教学"></a>附录三、React 测试入门教学</h1><p><img src="https://res.i95.me/wp-content/uploads/2016/10/mocha.png" alt="React 测试入门教学"></p><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>测试是软体开发中非常重要的一个环节，本章我们将带领大家从撰写最简单的测试程式码到整合 <code>Mocha</code> + <code>Chai</code> 官方提供的<a href="https://facebook.github.io/react/docs/test-utils.html" target="_blank" rel="noopener">测试工具</a>和 Airbnb 所设计的 <a href="https://github.com/airbnb/enzyme" target="_blank" rel="noopener">Enzyme</a> 进行 React 测试。</p><h3 id="Mocha-测试初体验"><a href="#Mocha-测试初体验" class="headerlink" title="Mocha 测试初体验"></a>Mocha 测试初体验</h3><p><a href="https://mochajs.org/" target="_blank" rel="noopener">Mocha</a> 是目前颇为流行的 JavaScript 测试框架之一，其可以很方便使用于浏览器端和 Node 环境。</p><blockquote><p>Mocha is a feature-rich JavaScript test framework running on Node.js and in the browser, making asynchronous testing simple and fun. Mocha tests run serially, allowing for flexible and accurate reporting, while mapping uncaught exceptions to the correct test cases.</p></blockquote><p>除了 Mocha 外，尚有许多 JavaScript 单元测试工具可以选择，例如：<a href="http://jasmine.github.io/" target="_blank" rel="noopener">Jasmine</a>、<a href="http://karma-runner.github.io/1.0/index.html" target="_blank" rel="noopener">Karma</a> 等。但本章我们主要使用 <code>Mocha</code> + <code>Chai</code> 结合 React 官方测试工具和 Enzyme 进行讲解。</p><p>在这边我们先介绍一些比较常用的 Mocha 使用方法，让大家熟悉测试的用法（若是已经熟悉撰写测试程式码的读者这部份可以跳过）：</p><ol><li><p>安装环境与套件 安装 <code>react</code> 和 <code>react-dom</code></p><p> $ npm install –save react react-dom</p></li></ol><p>可以在全域安装 mocha：</p><pre><code>$ npm install --global mocha</code></pre><p>也可以在开发环境下本地端安装（同时安装了 babel、eslint、webpack 等相关套件，其中以 mocha、chai、babel 为主要必须）：</p><pre><code>$ npm install --save-dev babel-core babel-loader babel-eslint babel-preset-react babel-preset-es2015 eslint eslint-config-airbnb eslint-loader eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-react webpack webpack-dev-server html-webpack-plugin chai mocha</code></pre><ol start="2"><li>测试程式码 1. describe（test suite）：表示一组相关的测试。<code>describe</code> 为一个函数，第一个参数为 <code>test suite</code>的名称，第二个参数为实际执行的函数。</li><li>it（test case）：表示一个单独测试，为测试裡最小单位。<code>it</code> 为一个函数，第一个参数为 <code>test case</code> 的描述名称，第二个参数为实际执行的函数。 在测试程式码中会包含一个或多个 <code>test suite</code>，而每个 <code>test suite</code> 则会包含一个或多个 <code>test case</code>。</li><li>整合 assertion 函式库 <code>Chai</code>所谓的 assertion（断言），就是判断程式码的执行成果是否和预期一样，若是不一致则会发生错误。通常一个 test case 会拥有一个或多个 assertion。由于 Mocha 本身是一个测试框架，但不包含 assertion，所以我们使用 <a href="http://chaijs.com/" target="_blank" rel="noopener">Chai</a> 这个适用于浏览器端和 Node 端的 BDD / TDD assertion library。在 Chai 中共提供三种操作 assertion 介面风格：Expect、Assert、Should，在这边我们选择使用比较接近自然语言的 Expect。</li></ol><p>基本上，expect assertion 的写法都是类似：开头为 <code>expect</code> 方法 + <code>to</code> 或 <code>to.be</code> + 结尾 assertion 方法（例如：equal、a/an、ok、match）<br>4. Mocha 基本用法 mocha 若没指定要执行哪个档案，预设会执行 <code>test</code> 资料夹下第一层的测试程式码。若要让 <code>test</code> 资料夹中的子资料夹测试码也执行则要加上 <code>--recursive</code> 参数。</p><p>包含子资料夹：</p><pre><code>$ mocha --recursive</code></pre><p>指定一个档案</p><pre><code>$ mocha file1.js</code></pre><p>也可以指定多个档案</p><pre><code>$ mocha file1.js file2.js</code></pre><p>现在，我们来撰写一个简单的测试程式，亲身感受一下测试的感觉。以下是 <code>react-mocha-test-example/src/modules/add.js</code>，一个加法的函数：</p><pre><code>const add = (x, y) =&gt; (  x + y);export default add;</code></pre><p>接著我们撰写测试这个函数的程式码，测试是否正确。以下是 <code>react-mocha-test-example/src/test/add.test.js</code>：</p><pre><code>// test add.jsimport add from &apos;../src/modules/add&apos;;import { expect } from &apos;chai&apos;;// describe is test suite, it is test casedescribe(&apos;test add function&apos;, () =&gt; (  it(&apos;1 + 1 = 2&apos;, () =&gt; (    expect(add(1, 1)).to.be.equal(2)  ))));</code></pre><p>在开始执行 <code>mocha</code> 后由于我们使用了，ES6 的语法所以必须使用 bable 进行转译，否则会出现类似以下的错误：</p><pre><code>import add from &apos;../src/modules/add&apos;;^^^^^^</code></pre><p>我们先行设定 <code>.bablerc</code>，我们在之前已经有安装 <code>babel</code> 相关套件和 <code>presets</code> 所以就会将 ES2015 语法转译。</p><pre><code>{    &quot;presets&quot;: [      &quot;es2015&quot;,      &quot;react&quot;,     ],    &quot;plugins&quot;: []}</code></pre><p>此时，我们更改 <code>package.json</code> 中的 <code>scripts</code>，这样方便每次测试执行：</p><p>若是使用本地端：</p><pre><code>$ ./node_modules/mocha/bin/mocha --compilers js:babel-core/register</code></pre><p>若是使用全域：</p><pre><code>$ mocha --compilers js:babel-core/register</code></pre><p>若是一切顺利，我们就可以看到执行测试成功的结果：</p><p>“` $ mocha add.test.js</p><p>test add function</p><pre><code> ✓ 1 + 1 = 2   1 passing (181ms)   “`1. Mocha 指令参数 在 Mocha 中有许多可以使用的好用参数，例如：`--recursive` 可以执行执行测试资料夹下的子资料夹程式码、`--reporter 格式` 更改测试报告格式（预设是 `spec`，也可以更改为 `tap`）、`--watch` 用来监控测试程式码，当有测试程式码更新就会重新执行、`--grep` 撷取符合条件的 test case。以上这些参数我们可以都整理在 `test` 资料夹下的 `mocha.opts` 档案中当作设定资料，此时再次执行 `npm run test` 就会把参数也使用进去。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--watch</span><br><span class="line">--reporter spec</span><br></pre></td></tr></table></figure>2. 非同步测试 在上面我们讨论的主要是同步的状况，但实际上在开发应用时往往会遇到非同步的情形。而在 Mocha 中每个 test case 最多允许执行 2000 毫秒，当时间超过就会显示错误。为了解决这个问题我们可以在 `package.json` 中更改：`&quot;test&quot;: &quot;mocha -t 5000 --compilers js:babel-core/register&quot;` 档案。为了模拟测试非同步的情境，所以我们必须先安装 [axios](https://github.com/mzabriskie/axios)。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save axios</span><br></pre></td></tr></table></figure>以下是 `react-mocha-test-example/src/test/async.test.js`：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import axios from &apos;axios&apos;;</span><br><span class="line">import &#123; expect &#125; from &apos;chai&apos;;</span><br><span class="line">    </span><br><span class="line">it(&apos;asynchronous return an object&apos;, function(done)&#123;</span><br><span class="line">  axios</span><br><span class="line">    .get(&apos;https://api.github.com/users/torvus&apos;)</span><br><span class="line">    .then(function (response) &#123;</span><br><span class="line">      expect(response).to.be.an(&apos;object&apos;);</span><br><span class="line">      done();</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(function (error) &#123;</span><br><span class="line">      console.log(error);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>由于测试环境是在 Node 中，所以我们必须先安装 [node-fetch](https://github.com/bitinn/node-fetch) 来展现 promise 的情境。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save node-fetch</span><br></pre></td></tr></table></figure>以下是 `react-mocha-test-example/src/test/promise.test.js`：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import fetch from &apos;node-fetch&apos;;</span><br><span class="line">import &#123; expect &#125; from &apos;chai&apos;;</span><br><span class="line">    </span><br><span class="line">it(&apos;asynchronous fetch promise&apos;, function() &#123;</span><br><span class="line">  return fetch(&apos;https://api.github.com/users/torvus&apos;)</span><br><span class="line">    .then(function(response) &#123; return response.json() &#125;)</span><br><span class="line">    .then(function(json) &#123; </span><br><span class="line">      expect(json).to.be.an(&apos;object&apos;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>3. 测试使用的 hook 在 Mocha 中的 test suite 中，有 before()、after()、beforeEach() 和 afterEach() 四种 hook，可以让你设计在特定时间点执行测试。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">describe(&apos;hooks&apos;, function() &#123;</span><br><span class="line">  before(function() &#123;</span><br><span class="line">    // 在 before 中的 test case 会在所有 test cases 前执行</span><br><span class="line">  &#125;);</span><br><span class="line">  after(function() &#123;</span><br><span class="line">    // 在 after 中的 test case 会在所有 test cases 后执行</span><br><span class="line">  &#125;);</span><br><span class="line">  beforeEach(function() &#123;</span><br><span class="line">    // 在 beforeEach 中的 test case 会在每个 test cases 前执行</span><br><span class="line">  &#125;);</span><br><span class="line">  afterEach(function() &#123;</span><br><span class="line">    // 在 afterEach 中的 test case 会在每个 test cases 后执行</span><br><span class="line">  &#125;);</span><br><span class="line">  // test cases</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>### 动手实作在上面我们已经先讲解了 `Mocha` + `Chai` 测试工具和基础的测试写法。现在接著我们要来探讨 React 中的测试用法。然而，要在 React 中测试 Component 以及 JSX 语法时，使用传统的测试工具并不方便，所以要整合 `Mocha` + `Chai` 官方提供的[测试工具](https://facebook.github.io/react/docs/test-utils.html)和 Airbnb 所设计的 [Enzyme](https://github.com/airbnb/enzyme)（由于官方的测试工具使用起来不太方便所以有第三方针对其进行封装）进行测试。#### 使用官方测试工具我们知道在 React 一个重要的特色为 Virtual DOM 所以在官方的测试工具中有提供测试 Virtual DOM 的方法：Shallow Rendering（createRenderer），以及测试真实 DOM 的方法：DOM Rendering（renderIntoDocument）。1. Shallow Rendering（createRenderer） Shallow Rendering 系指将一个 Virtual DOM 渲染成子 Component，但是只渲染第一层，不渲染所有子元件，因此处理速度快且不需要 DOM 环境。Shallow rendering 在单元测试非常有用，由于只测试一个特定的 component，而重要的不是它的 children。这也意味著改变一个 child component 不会影响 parent component 的测试。以下是 `react-addons-test-utils-example/src/test/shallowRender.test.js`：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import TestUtils from &apos;react-addons-test-utils&apos;;</span><br><span class="line">import &#123; expect &#125; from &apos;chai&apos;;</span><br><span class="line">import Main from &apos;../src/components/Main&apos;;</span><br><span class="line">    </span><br><span class="line">function shallowRender(Component) &#123;</span><br><span class="line">  const renderer = TestUtils.createRenderer();</span><br><span class="line">  renderer.render();</span><br><span class="line">  return renderer.getRenderOutput();</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">describe(&apos;Shallow Rendering&apos;, function () &#123;</span><br><span class="line">  it(&apos;Main title should be h1&apos;, function () &#123;</span><br><span class="line">    const todoItem = shallowRender(Main);</span><br><span class="line">    expect(todoItem.props.children[0].type).to.equal(&apos;h1&apos;);</span><br><span class="line">    expect(todoItem.props.children[0].props.children).to.equal(&apos;Todos&apos;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>以下是 `react-addons-test-utils-example/src/test/shallowRenderProps.test.js`：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import TestUtils from &apos;react-addons-test-utils&apos;;</span><br><span class="line">import &#123; expect &#125; from &apos;chai&apos;;</span><br><span class="line">import TodoList from &apos;../src/components/TodoList&apos;;</span><br><span class="line">    </span><br><span class="line">const shallowRender = (Component, props) =&gt; &#123;</span><br><span class="line">  const renderer = TestUtils.createRenderer();</span><br><span class="line">  renderer.render();</span><br><span class="line">  return renderer.getRenderOutput();</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">describe(&apos;Shallow Props Rendering&apos;, () =&gt; &#123;</span><br><span class="line">  it(&apos;TodoList props check&apos;, () =&gt; &#123;</span><br><span class="line">    const todos = [&#123; id: 0, text: &apos;reading&apos;&#125;, &#123; id: 1, text: &apos;coding&apos;&#125;];</span><br><span class="line">    const todoList = shallowRender(TodoList, &#123;todos: todos&#125;);</span><br><span class="line">    expect(todoList.props.children.type).to.equal(&apos;ul&apos;);</span><br><span class="line">    expect(todoList.props.children.props.children[0].props.children).to.equal(&apos;reading&apos;);</span><br><span class="line">    expect(todoList.props.children.props.children[1].props.children).to.equal(&apos;coding&apos;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>2. DOM Rendering（renderIntoDocument） 注意，因为 Mocha 运行在 Node 环境中，所以你不会存取到 DOM。所以我们要使用 JSDOM 来模拟真实 DOM 环境。同时我在这边引入 `react-dom`，这样我们就可以使用 findDOMNode 来选取元素。事实上，findDOMNode 方法的最大优势是提供比 TestUtils 更好的 CSS 选择器，方便开发者选择元素。以下是 `react-addons-test-utils-example/src/test/setup.test.js`：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import jsdom from &apos;jsdom&apos;;</span><br><span class="line">    </span><br><span class="line">if (typeof document === &apos;undefined&apos;) &#123;</span><br><span class="line">  global.document = jsdom.jsdom(&apos;&apos;);</span><br><span class="line">  global.window = document.defaultView;</span><br><span class="line">  global.navigator = global.window.navigator;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>以下是 `react-addons-test-utils-example/src/components/TodoHeader/TodoHeader.js`：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">    </span><br><span class="line">class TodoHeader extends React.Component &#123;</span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line">    this.toggleButton = this.toggleButton.bind(this);</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      isActivated: false,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  toggleButton() &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      isActivated: !this.state.isActivated,      </span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      </span><br><span class="line">        Add</span><br><span class="line">      </span><br><span class="line">    );</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">export default TodoHeader;</span><br></pre></td></tr></table></figure>需要留意的是若是 stateless components 使用 TestUtils.renderIntoDocument，要将 renderIntoDocument 包在 `` 内，使用 `findDOMNode(TodoHeaderApp).children[0]` 取得，不然会回传 null。更进一步细节可以[参考这裡](https://github.com/facebook/react/issues/4839)。不过由于我们是使用 `class-based` Component 所以不会遇到这个问题。以下是 `react-addons-test-utils-example/src/test/renderIntoDocument.test.js`：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import TestUtils from &apos;react-addons-test-utils&apos;;</span><br><span class="line">import &#123; expect &#125; from &apos;chai&apos;;</span><br><span class="line">import &#123; findDOMNode &#125; from &apos;react-dom&apos;;</span><br><span class="line">import TodoHeader from &apos;../src/components/TodoHeader&apos;;</span><br><span class="line">    </span><br><span class="line">describe(&apos;Simulate Event&apos;, function () &#123;</span><br><span class="line">  it(&apos;When click the button, it will be toggle&apos;, function () &#123;</span><br><span class="line">    const TodoHeaderApp = TestUtils.renderIntoDocument();</span><br><span class="line">    const TodoHeaderDOM = findDOMNode(TodoHeaderApp);</span><br><span class="line">    const button = TodoHeaderDOM.querySelector(&apos;button&apos;);</span><br><span class="line">    TestUtils.Simulate.click(button);</span><br><span class="line">    let todoHeaderButtonAfterClick = TodoHeaderDOM.querySelector(&apos;button&apos;).disabled;</span><br><span class="line">    expect(todoHeaderButtonAfterClick).to.equal(true);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>这种渲染 DOM 的测试方式类似于 JavaScript 或 jQuery 的 DOM 操作。首先要先找到欲操作的目标节点，而后触发想要执行的动作，在官方测试工具中拥有许多可以[协助选取节点的方法](https://facebook.github.io/react/docs/test-utils.html#scryrenderedcomponentswithtype)。然而由于其在使用上不够简洁，也因此我们接下来将介绍由 Airbnb 所设计的 [Enzyme](https://github.com/airbnb/enzyme)进行 React 测试。#### 使用 Enzyme 函式库进行测试[Enzyme](https://github.com/airbnb/enzyme) 优势是在于针对官方测试工具封装成了类似 jQuery API 的选取元素的方式。根据官方网站介绍 Enzyme 将更容易地去操作选取 React Component：&gt; Enzyme is a JavaScript Testing utility for React that makes it easier to assert, manipulate, and traverse your React Components’ output. Enzyme is unopinionated regarding which test runner or assertion library you use, and should be compatible with all major test runners and assertion libraries out there.在 Enzyme 中选取元素使用 `find()`：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">component.find(&apos;.className&apos;); // 使用 class 选取</span><br><span class="line">component.find(&apos;#idName&apos;); // 使用 id 选取</span><br><span class="line">component.find(&apos;h1&apos;); // 使用元素选取</span><br></pre></td></tr></table></figure>接下来我们介绍 Enzyme 三个主要的 API 方法：1. Shallow Rendering shallow 方法事实上就是官方测试工具的 shallow rendering 封装。同样是只渲染第一层，不渲染所有子元件。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import TestUtils from &apos;react-addons-test-utils&apos;;</span><br><span class="line">import &#123; expect &#125; from &apos;chai&apos;;</span><br><span class="line">import &#123; shallow &#125; from &apos;enzyme&apos;;</span><br><span class="line">import Main from &apos;../../src/components/Main&apos;;</span><br><span class="line">    </span><br><span class="line">describe(&apos;Enzyme Shallow Rendering&apos;, () =&gt; &#123;</span><br><span class="line">  it(&apos;Main title should be Todos&apos;, () =&gt; &#123;</span><br><span class="line">    const main = shallow();</span><br><span class="line">    // 判断 h1 文字是否如预期</span><br><span class="line">    expect(main.find(&apos;h1&apos;).text()).to.equal(&apos;Todos&apos;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>2. Static Rendering render 方法是将 React 元件渲染成静态的 HTML 字串，并利用 Cheerio 函式库（这点和 shallow 不同）分析其结构返回物件。虽然底层是不同的处理引擎但使用上 API 封装起来和 Shallow 却是一致的。需要注意的是 Static Rendering 非只渲染一层，需要注意是否需要 mock props 传递。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import TestUtils from &apos;react-addons-test-utils&apos;;</span><br><span class="line">import &#123; expect &#125; from &apos;chai&apos;;</span><br><span class="line">import &#123; render &#125; from &apos;enzyme&apos;;</span><br><span class="line">import Main from &apos;../../src/components/Main&apos;;</span><br><span class="line">    </span><br><span class="line">describe(&apos;Enzyme Staic Rendering&apos;, () =&gt; &#123;</span><br><span class="line">  it(&apos;Main title should be Todos&apos;, () =&gt; &#123;</span><br><span class="line">    const todos = [&#123; id: 0, text: &apos;reading&apos;&#125;, &#123; id: 1, text: &apos;coding&apos;&#125;];</span><br><span class="line">    const main = render();</span><br><span class="line">    expect(main.find(&apos;h1&apos;).text()).to.equal(&apos;Todos&apos;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>3. Full Rendering mount 方法 React 元件载入真实 DOM 节点。同样因为牵涉到 DOM 也要使用 JSDOM。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import TestUtils from &apos;react-addons-test-utils&apos;;</span><br><span class="line">import &#123; expect &#125; from &apos;chai&apos;;</span><br><span class="line">import &#123; findDOMNode &#125; from &apos;react-dom&apos;;</span><br><span class="line">import &#123; mount &#125; from &apos;enzyme&apos;;</span><br><span class="line">import TodoHeader from &apos;../../src/components/TodoHeader&apos;;</span><br><span class="line">    </span><br><span class="line">describe(&apos;Enzyme Mount&apos;, () =&gt; &#123;</span><br><span class="line">  it(&apos;Click Button&apos;, () =&gt; &#123;</span><br><span class="line">    let todoHeaderDOM = mount();</span><br><span class="line">    // 取得 button 并模拟 click</span><br><span class="line">    let button = todoHeaderDOM.find(&apos;button&apos;).at(0);</span><br><span class="line">    button.simulate(&apos;click&apos;);</span><br><span class="line">    // 检查 prop(key) 是否正确</span><br><span class="line">    expect(button.prop(&apos;disabled&apos;)).to.equal(true);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>最后我们可以在 `react-addons-test-utils-example` 资料夹下执行：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm test</span><br></pre></td></tr></table></figure>若一切顺利就可以看到测试通过的讯息！<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Enzyme Mount</span><br><span class="line">  ✓ Click Button (44ms)</span><br><span class="line">    </span><br><span class="line">Enzyme Shallow Rendering</span><br><span class="line">  ✓ Main title should be Todos</span><br><span class="line">    </span><br><span class="line">Enzyme Staic Rendering</span><br><span class="line">  ✓ Main title should be Todos</span><br><span class="line">    </span><br><span class="line">Simulate Event</span><br><span class="line">  ✓ When click the button, it will be toggle</span><br><span class="line">    </span><br><span class="line">Shallow Rendering</span><br><span class="line">  ✓ Main title should be h1</span><br><span class="line">    </span><br><span class="line">Shallow Props Rendering</span><br><span class="line">  ✓ TodoList props check</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">6 passing (279ms)</span><br></pre></td></tr></table></figure>事实上 Enzyme 还提供更多的 API 可以使用，若是读者想了解更多 Enzyme API 可以 [参考官方文件](http://airbnb.io/enzyme/docs/api/index.html)。### 总结以上我们从 `Mocha` + `Chai` 的使用方式介绍到 React 官方提供的[测试工具](https://facebook.github.io/react/docs/test-utils.html) 和 Airbnb 所设计的 [Enzyme](https://github.com/airbnb/enzyme)，相信读者对于测试程式码已经有初步的了解，若尚未掌握的读者不妨跟著上面的范例再重新走过一遍，接著我们要进到最后的 `GraphQL/Relay`的介绍。### 延伸阅读1. [React 测试入门教程](http://www.ruanyifeng.com/blog/2016/02/react-testing-tutorial.html)2. [测试框架 Mocha 实例教程](http://www.ruanyifeng.com/blog/2015/12/a-mocha-tutorial-of-examples.html)3. [Test Utilities](https://facebook.github.io/react/docs/test-utils.html)4. [JavaScript Testing utilities for React](https://github.com/airbnb/enzyme)5. [持续集成是什么？](http://www.ruanyifeng.com/blog/2015/09/continuous-integration.html)6. [Let’s test React components with TDD, Mocha, Chai, and jsdom](https://medium.freecodecamp.com/simple-react-testing-d9e25ec87e2)7. [Unit Testing React-Native Components with Enzyme Part 1](https://kyrisu.com/2016/01/31/unit-testing-react-native-components-with-enzyme-part-1/)8. [What React Stateless Components Are Missing](http://jaketrent.com/post/react-stateless-components-missing/)9. [0.14-rc1: findDOMNode(statelessComponent) doesn’t work with TestUtils.renderIntoDocument #4839](https://github.com/facebook/react/issues/4839)10. [Writing Redux Tests](http://redux.js.org/docs/recipes/WritingTests.html)11. [【译】展望2016，React.js 最佳实践 (中英对照版)](http://blog.jimmylv.info/2016-01-22-React.js-Best-Practices-for-2016/)</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>附录二、用 React Native + Firebase 开发跨平台行动应用程式</title>
      <link href="/reactjs-getting-started-12.html"/>
      <url>/reactjs-getting-started-12.html</url>
      
        <content type="html"><![CDATA[<h1 id="附录二、用-React-Native-Firebase-开发跨平台行动应用程式"><a href="#附录二、用-React-Native-Firebase-开发跨平台行动应用程式" class="headerlink" title="附录二、用 React Native + Firebase 开发跨平台行动应用程式"></a>附录二、用 React Native + Firebase 开发跨平台行动应用程式</h1><p><img src="https://res.i95.me/wp-content/uploads/2016/10/react-native-logo.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></p><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>跨平台（<code>Wirte once, Run Everywhere</code>）一直以来是软体工程的圣杯。过去一段时间市场上有许多尝试跨平台开发原生行动装置（Native Mobile App）的解决方案，尝试运用 HTML、CSS　和 JavaScript 等网页前端技术达到跨平台的效果，例如：运用 <a href="https://jquerymobile.com/" target="_blank" rel="noopener">jQuery Mobile</a>、<a href="http://ionicframework.com/" target="_blank" rel="noopener">Ionic</a> 和 <a href="http://framework7.io/" target="_blank" rel="noopener">Framework7</a> 等 Mobile UI 框架（Framework）结合 JavaScript 框架并搭配 <a href="https://en.wikipedia.org/wiki/Apache_Cordova" target="_blank" rel="noopener">Cordova/PhoneGap</a> 进行跨平台行动装置开发。然而，因为这些解决方案通常都是运行在 <code>WebView</code> 之上，导致效能和体验要真正趋近于原生应用程式（Native App）还有一段路要走。</p><p>不过，随著 Facebook 工程团队开发的 <a href="https://facebook.github.io/react-native/" target="_blank" rel="noopener">React Native</a> 横空出世，想尝试跨平台解决方案的开发者又有了新的选择。</p><h3 id="React-Native-特色"><a href="#React-Native-特色" class="headerlink" title="React Native 特色"></a>React Native 特色</h3><p>在正式开始开发 React Native App 之前我们先来介绍一下 React Native 的主要特色：</p><ol><li>使用 JavaScript（ES6+）和 <a href="https://facebook.github.io/react/" target="_blank" rel="noopener">React</a> 打造跨平台原生应用程式（Learn once, write anywhere）</li><li>使用 Native Components，更贴近原生使用者体验</li><li>在 JavaScript 和 Native 之间的操作为非同步（Asynchronous）执行，并可用 Chrome 开发者工具除错，支援 <code>Hot Reloading</code></li><li>使用 <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout/Using_CSS_flexible_boxes" target="_blank" rel="noopener">Flexbox</a> 进行排版和布局</li><li>良好的可扩展性（Extensibility），容易整合 Web 生态系标准（XMLHttpRequest、 navigator.geolocation 等）或是原生的元件或函式库（Objective-C、Java 或 Swift）</li><li>Facebook 已使用 React Native 于自家 Production App 且将持续维护，另外也有持续蓬勃发展的技术社群</li><li>让 Web 开发者可以使用熟悉的技术切入 Native App 开发</li><li>2015/3 释出 iOS 版本，2015/9 释出 Android 版本</li><li>目前更新速度快，平均每两週发佈新的版本。社群也还持续在寻找最佳实践，关于版本进展可以<a href="https://facebook.github.io/react-native/versions.html" target="_blank" rel="noopener">参考这个文件</a></li><li>支援的作业系统为 &gt;= Android 4.1 (API 16) 和 &gt;= iOS 7.0</li></ol><h3 id="React-Native-初体验"><a href="#React-Native-初体验" class="headerlink" title="React Native 初体验"></a>React Native 初体验</h3><p>在了解了 React Native 特色后，我们准备开始开发我们的 React Native 应用程式！由于我们的范例可以让程式跨平台共用，所以你可以使用 iOS 和 Android 平台运行。不过若是想在 iOS 平台开发需要先准备 Mac OS 和安装 <a href="https://developer.apple.com/xcode/" target="_blank" rel="noopener">Xcode</a> 开发工具，若是你准备使用 Android 平台的话建议先行安装 <a href="https://developer.android.com/studio/index.html" target="_blank" rel="noopener">Android Studio</a> 和 <a href="https://www.genymotion.com/" target="_blank" rel="noopener">Genymotion 模拟器</a>。在我们范例我们使用笔者使用的 MacO OS 作业系统并使用 Android 平台为主要范例，若有其他作业系统需求的读者可以参考 <a href="https://facebook.github.io/react-native/docs/getting-started.html" target="_blank" rel="noopener">官方安装说明</a>。</p><p>一开始请先安装 <a href="https://nodejs.org/en/" target="_blank" rel="noopener">Node</a>、<a href="https://facebook.github.io/watchman/" target="_blank" rel="noopener">Watchman</a> 和 React Native command line 工具：</p><pre><code>// 若你使用 Mac OS 你可以使用官网安装方式或是使用 homebrew 安装$ brew install node// watchman 可以监看档案是否有修改$ brew install watchman// 安装 React Native command line 工具$ npm install -g react-native-cli</code></pre><p>由于我们是要开发 Android 平台，所以必须安装：</p><ol><li>安装 JDK</li><li>安装 Android SDK</li><li>设定一些环境变数</li></ol><p>以上可以透过 <a href="https://developer.android.com/studio/install.html" target="_blank" rel="noopener">Install Android Studio</a> 官网和 <a href="https://facebook.github.io/react-native/docs/getting-started.html" target="_blank" rel="noopener">官方安装说明</a> 步骤完成。</p><p>现在，我们先透过一个简单的 <code>HelloWorldApp</code>，让大家感受一下 React Native 专案如何开发。</p><p>首先，我们先初始化一个 React Native Project：</p><pre><code>$ react-native init HelloWorldApp</code></pre><p>初始的资料夹结构长相：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/folder-1.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></p><p>接下来请先安装注册 <a href="https://www.genymotion.com/" target="_blank" rel="noopener">Genymotion</a>，Genymotion 是一个透过电脑模拟 Android 系统的好用开发模拟器环境。安装完后可以打开并选择欲使用的萤幕大小和 API 版本的 Android 系统。建立装置后就可以启动我们的装置：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/android-1.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></p><p>若你是使用 Mac OS 作业系统的话可以执行 <code>run-ios</code>，若是使用 Android 平台则使用 <code>run-android</code> 启动你的 App。在这边我们先使用 Android 平台进行开发（若你希望实机测试，请将电脑接上你的 Android 手机，记得确保 menu 中的 ip 位置要和电脑网路 相同。若是遇到连不到程式 server 且手机为 Android 5.0+ 系统，可以执行 <code>adb reverse tcp:8081 tcp:8081</code>，详细情形可以<a href="https://facebook.github.io/react-native/docs/running-on-device-android.html#using-adb-reverse" target="_blank" rel="noopener">参考官网说明</a>）：</p><pre><code>$ react-native run-android</code></pre><p>如果一切顺利的话就可以在模拟器中看到初始画面：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/android-2.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></p><p>接著打开 <code>index.android.js</code> 就可以看到以下程式码：</p><pre><code>import React, { Component } from &apos;react&apos;;import {  AppRegistry,  StyleSheet,  Text,  View} from &apos;react-native&apos;;// 元件式的开发方式和 React 如出一辙，但要注意的是在 React Native 中我们不使用 HTML 元素而是使用 React Native 元件进行开发，这也符合 Learn once, write anywhere 的原则。class HelloWorldApp extends Component {  render() {    return (      &lt;View style={styles.container}&gt;        &lt;Text style={styles.welcome}&gt;          Welcome to React Native!        &lt;/Text&gt;        &lt;Text style={styles.instructions}&gt;          To get started, edit index.android.js        &lt;/Text&gt;        &lt;Text style={styles.instructions}&gt;          Double tap R on your keyboard to reload,{&apos;\n&apos;}          Shake or press menu button for dev menu        &lt;/Text&gt;      &lt;/View&gt;    );  }}// 在 React Native 中 styles 是使用 JavaScript 形式来撰写，与一般 CSS 比较不同的是他使用驼峰式的属性命名：const styles = StyleSheet.create({  container: {    flex: 1,    justifyContent: &apos;center&apos;,    alignItems: &apos;center&apos;,    backgroundColor: &apos;#F5FCFF&apos;,  },  welcome: {    fontSize: 20,    textAlign: &apos;center&apos;,    margin: 10,  },  instructions: {    textAlign: &apos;center&apos;,    color: &apos;#333333&apos;,    marginBottom: 5,  },});// 告诉 React Native App 你的进入点：AppRegistry.registerComponent(&apos;HelloWorldApp&apos;, () =&gt; HelloWorldApp);</code></pre><p>由于 React Native 有支援 <code>Hot Reloading</code>，若我们更改了档案内容，我们可以使用打开模拟器 Menu 重新刷新页面，此时就可以在看到原本的 <code>Welcome to React Native!</code> 文字已经改成 <code>Welcome to React Native Rock!!!!</code></p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/android-3.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/android-4.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></p><p>嗯，有没有感觉在开发网页的感觉？</p><h3 id="动手实作"><a href="#动手实作" class="headerlink" title="动手实作"></a>动手实作</h3><p>相信看到这裡读者们一定等不及想大展身手，使用 React Native 开发你第一个 App。俗话说学习一项新技术最好的方式就是做一个 TodoApp。所以，接下来的文章，笔者将带大家使用 React Native 结合 Redux/ImmutableJS 和 Firebase 开发一个记录和删除名言佳句（Mottos）的 Mobile App！</p><h4 id="专案成果截图"><a href="#专案成果截图" class="headerlink" title="专案成果截图"></a>专案成果截图</h4><p><img src="https://res.i95.me/wp-content/uploads/2016/10/demo-1.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/demo-2.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></p><h4 id="环境安装与设定"><a href="#环境安装与设定" class="headerlink" title="环境安装与设定"></a>环境安装与设定</h4><p>相关套件安装：</p><pre><code>$ npm install --save redux react-redux immutable redux-immutable redux-actions uuid firebase$ npm install --save-dev babel-core babel-eslint babel-loader babel-preset-es2015 babel-preset-react babel-preset-react-native eslint-plugin-react-native  eslint eslint-config-airbnb eslint-loader eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-react redux-logger</code></pre><p>安装完相关工具后我们可以初始化我们专案：</p><pre><code>// 注意专案不能使用 - 或 _ 命名$ react-native init ReactNativeFirebaseMotto$ cd ReactNativeFirebaseMotto</code></pre><p>我们先准备一下我们资料夹架构，将它设计成：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/folder-2.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></p><h4 id="Firebase-简介与设定"><a href="#Firebase-简介与设定" class="headerlink" title="Firebase 简介与设定"></a>Firebase 简介与设定</h4><p>在这个专案中我们会使用到 <a href="https://firebase.google.com/" target="_blank" rel="noopener">Firebase</a> 这个 <code>Back-End as Service</code>的服务，也就是说我们不用自己建立后端程式资料库，只要使用 Firebase 所提供的 API 就好像有了一个 NoSQL 资料库一样，当然 Firebase 不单只有提供资料储存的功能，但限于篇幅我们这边将只介绍资料储存的功能。</p><ol><li>首先我们进到 Firebase 首页 <img src="https://res.i95.me/wp-content/uploads/2016/10/firebase-landing.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></li><li>登入后点选建立专案，依照自己想取的专案名称命名<img src="https://res.i95.me/wp-content/uploads/2016/10/firebase-init.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></li><li>选择将 Firebase 加入你的网路应用程式的按钮可以取得 App ID 的 config 资料，待会我们将会使用到<img src="https://res.i95.me/wp-content/uploads/2016/10/firebase-dashboard.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></li><li><p>点选左边选单中的 Database 并点选 Realtime Database Tab 中的规则<img src="https://res.i95.me/wp-content/uploads/2016/10/firebase-database-0.png" alt="用 React Native + Firebase 开发跨平台行动应用程式">设定改为，在范例中为求简单，我们先不用验证方式即可操作：</p><p>{<br> “rules”: {<br>   “.read”: true,<br>   “.write”: true<br> }<br>}</p></li></ol><p>Firebase 在使用上有许多优点，其中一个使用 Back-End As Service 的好处是你可以专注在应用程式的开发便免花过多时间处理后端基础建设的部份，更可以让 Back-End 共用在不同的 client side 中。此外 Firebase 在和 React 整合上也十分容易，你可以想成 Firebase 负责资料的储存，透过 API 和 React 元件互动，Redux 负责接收管理 client state，若是监听到 Firebase 后端资料更新后同步更新 state 并重新 render 页面。</p><h4 id="使用-Flexbox-进行-UI-布局设计"><a href="#使用-Flexbox-进行-UI-布局设计" class="headerlink" title="使用 Flexbox 进行 UI 布局设计"></a>使用 Flexbox 进行 UI 布局设计</h4><p>在 React Native 中是使用 <code>Flexbox</code> 进行排版，若读者对于 Flexbox 尚不熟悉，建议可以<a href="https://css-tricks.com/snippets/css/a-guide-to-flexbox/" target="_blank" rel="noopener">参考这篇文章</a>，若有需要游戏化的学习工具，也非常推荐这两个教学小游戏：<a href="http://www.flexboxdefense.com/" target="_blank" rel="noopener">FlexDefense</a>、<a href="http://flexboxfroggy.com/" target="_blank" rel="noopener">FLEXBOX FROGGY</a>。</p><p>事实上我们可以将 Flexbox 视为一个箱子，最外层是 <code>flex containers</code>、内层包的是 <code>flex items</code>，在属性上也有分是针对<code>flex containers</code> 还是针对是 <code>flex items</code> 设计的。在方向性上由左而右是 <code>main axis</code>，而上到下是 <code>cross axis</code>。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/flexbox-1.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></p><p>在 Flexbox 有许多属性值，其中最重要的当数 <code>justifyContent</code> 和 <code>alignItems</code> 以及 <code>flexDirection</code>（注意 React Native Style 都是驼峰式写法），所以我们这边主要介绍这三个属性：</p><p>Flex Direction 负责决定整个 <code>flex containers</code> 的方向，预设为 <code>row</code> 也可以改为 <code>column</code> 、 <code>row-reverse</code> 和 <code>column-reverse</code>。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/flexbox-flex-direction.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></p><p>Justify Content 负责决定整个 <code>flex containers</code> 内的 items 的水平摆设，主要属性值有：<code>flex-start</code>、<code>flex-end</code>、<code>center</code>、<code>space-between</code>、<code>space-around</code>。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/justify-content.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></p><p>Align Items 负责决定整个 <code>flex containers</code> 内的 items 的垂直摆设，主要属性值有：<code>flex-start</code>、<code>flex-end</code>、<code>center</code>、<code>stretch</code>、<code>baseline</code>。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/align-items.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></p><h3 id="动手实作-1"><a href="#动手实作-1" class="headerlink" title="动手实作"></a>动手实作</h3><p>有了前面的准备，现在我们终于要开始进入核心的应用程式开发了！</p><p>首先我们先设定好整个 App 的进入档 <code>index.android.js</code>，在这个档案中我们设定了初始化的设定和主要元件 <code>&lt;Main /&gt;</code>：</p><pre><code>/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, { Component } from &apos;react&apos;;import {  AppRegistry,  Text,  View} from &apos;react-native&apos;;import Main from &apos;./src/components/Main&apos;;class ReactNativeFirebaseMotto extends Component {  render() {    return (      &lt;Main /&gt;    );  }}AppRegistry.registerComponent(&apos;ReactNativeFirebaseMotto&apos;, () =&gt; ReactNativeFirebaseMotto);</code></pre><p>在 <code>src/components/Main/Main.js</code> 中我们设定好整个 Component 的布局和并将 <code>Firebase</code> 引入并初始化，将操作 Firebase 资料库的参考往下传，根节点我们命名为 <code>items</code>，所以之后所有新增的 motto 都会在这个根节点之下并拥有特定的 key 值。在 Main 我们同样规划了整个布局，包括：<code>&lt;ToolBar /&gt;</code>、<code>&lt;MottoListContainer /&gt;</code>、<code>&lt;ActionButtonContainer /&gt;</code>、<code>&lt;InputModalContainer /&gt;</code>。</p><pre><code>import React from &apos;react&apos;;import ReactNative from &apos;react-native&apos;;import { Provider } from &apos;react-redux&apos;; import ToolBar from &apos;../ToolBar&apos;;import MottoListContainer from &apos;../../containers/MottoListContainer&apos;;import ActionButtonContainer from &apos;../../containers/ActionButtonContainer&apos;;import InputModalContainer from &apos;../../containers/InputModalContainer&apos;;import ListItem from &apos;../ListItem&apos;;import * as firebase from &apos;firebase&apos;;// 将 Firebase 的 config 值引入import { firebaseConfig } from &apos;../../constants/config&apos;;// 引用 Redux storeimport store from &apos;../../store&apos;;const { View, Text } = ReactNative;// Initialize Firebaseconst firebaseApp = firebase.initializeApp(firebaseConfig);// Create a reference with .ref() instead of new Firebase(url)const rootRef = firebaseApp.database().ref();const itemsRef = rootRef.child(&apos;items&apos;);// 将 Redux 的 store 透过 Provider 往下传const Main = () =&gt; (  &lt;Provider store={store}&gt;    &lt;View&gt;      &lt;ToolBar style={styles.toolBar} /&gt;      &lt;MottoListContainer itemsRef={itemsRef} /&gt;      &lt;ActionButtonContainer /&gt;      &lt;InputModalContainer itemsRef={itemsRef} /&gt;    &lt;/View&gt;  &lt;/Provider&gt;);export default Main;</code></pre><p>设定完了基本的布局方式后我们来设定 Actions 和其使用的常数，<code>src/actions/mottoActions.js</code>：</p><pre><code>export const GET_MOTTOS = &apos;GET_MOTTOS&apos;;export const CREATE_MOTTO = &apos;CREATE_MOTTO&apos;;export const SET_IN_MOTTO = &apos;SET_IN_MOTTO&apos;;export const TOGGLE_MODAL = &apos;TOGGLE_MODAL&apos;;</code></pre><p>我们在 constants 资料夹中也设定了我们整个 data 的资料结构，以下是 <code>src/constants/models.js</code>：</p><pre><code>import Immutable from &apos;immutable&apos;;export const MottoState = Immutable.fromJS({  mottos: [],  motto: {    id : &apos;&apos;,    text: &apos;&apos;,    updatedAt: &apos;&apos;,  }});export const UiState = Immutable.fromJS({  isModalVisible: false,});</code></pre><p>还记得我们提到的 Firebase config 吗？这边我们把相关的设定档放在<code>src/configs/config.js</code>中：</p><pre><code>export const firebaseConfig = {  apiKey: &quot;apiKey&quot;,  authDomain: &quot;authDomain&quot;,  databaseURL: &quot;databaseURL&quot;,  storageBucket: &quot;storageBucket&quot;,};</code></pre><p>在我们应用程式中同样使用了 <code>redux</code> 和 <code>redux-actions</code>。在这个范例中我们设计了：GET_MOTTOS、CREATE_MOTTO、SET_IN_MOTTO 三个操作 motto 的 action，分别代表从 Firebase 取出资料、新增资料和 set 资料。以下是 <code>src/actions/mottoActions.js</code>：</p><pre><code>import { createAction } from &apos;redux-actions&apos;;import {  GET_MOTTOS,  CREATE_MOTTO,  SET_IN_MOTTO,} from &apos;../constants/actionTypes&apos;;export const getMottos = createAction(&apos;GET_MOTTOS&apos;);export const createMotto = createAction(&apos;CREATE_MOTTO&apos;);export const setInMotto = createAction(&apos;SET_IN_MOTTO&apos;);</code></pre><p>同样地，由于我们设计了当使用者想新增 motto 时会跳出 modal，所以我们可以设定一个 <code>TOGGLE_MODAL</code> 负责开关 modal 的 state。以下是 <code>src/actions/uiActions.js</code>：</p><pre><code>import { createAction } from &apos;redux-actions&apos;;import {  TOGGLE_MODAL,} from &apos;../constants/actionTypes&apos;;export const toggleModal = createAction(&apos;TOGGLE_MODAL&apos;);</code></pre><p>以下是 <code>src/actions/index.js</code>，用来汇出我们的 actions：</p><pre><code>export * from &apos;./uiActions&apos;;export * from &apos;./mottoActions&apos;;</code></pre><p>设定完我们的 actions 后我们来设定 reducers，在这边我们同样使用 <code>redux-actions</code> 整合 <code>ImmutableJS</code>，</p><pre><code>import { handleActions } from &apos;redux-actions&apos;;// 引入 initialState import {   MottoState} from &apos;../../constants/models&apos;;import {  GET_MOTTOS,  CREATE_MOTTO,  SET_IN_MOTTO,} from &apos;../../constants/actionTypes&apos;;// 透过 set 和 seIn 可以产生 newStateconst mottoReducers = handleActions({  GET_MOTTOS: (state, { payload }) =&gt; (    state.set(      &apos;mottos&apos;,      payload.mottos    )  ),    CREATE_MOTTO: (state) =&gt; (    state.set(      &apos;mottos&apos;,      state.get(&apos;mottos&apos;).push(state.get(&apos;motto&apos;))    )  ),  SET_IN_MOTTO: (state, { payload }) =&gt; (    state.setIn(      payload.path,      payload.value    )  )}, MottoState);export default mottoReducers;</code></pre><p>以下是 <code>src/reducers/uiState.js</code>：</p><pre><code>import { handleActions } from &apos;redux-actions&apos;;import {   UiState,} from &apos;../../constants/models&apos;;import {  TOGGLE_MODAL,} from &apos;../../constants/actionTypes&apos;;// modal 的显示与否const uiReducers = handleActions({  TOGGLE_MODAL: (state) =&gt; (    state.set(      &apos;isModalVisible&apos;,      !state.get(&apos;isModalVisible&apos;)    )  ),  }, UiState);export default uiReducers;</code></pre><p>以下是 <code>src/reducers/index.js</code>，将所有 reducers combine 在一起：</p><pre><code>import { combineReducers } from &apos;redux-immutable&apos;;import ui from &apos;./ui/uiReducers&apos;;import motto from &apos;./data/mottoReducers&apos;;const rootReducer = combineReducers({  ui,  motto,});export default rootReducer;</code></pre><p>透过 <code>src/store/configureStore.js</code>将 reducers 和 initialState 以及要使用的 middleware 整合成 store：</p><pre><code>import { createStore, applyMiddleware } from &apos;redux&apos;;import createLogger from &apos;redux-logger&apos;;import Immutable from &apos;immutable&apos;;import rootReducer from &apos;../reducers&apos;;const initialState = Immutable.Map();export default createStore(  rootReducer,  initialState,  applyMiddleware(createLogger({ stateTransformer: state =&gt; state.toJS() })));</code></pre><p>设定完资料层的架构后，我们又重新回到 View 的部份，我们开始依序设定我们的 Component 和 Container。首先，我们先设计我们的标题列 ToolBar，以下是 <code>src/components/ToolBar/ToolBar.js</code>：</p><pre><code>import React from &apos;react&apos;;import ReactNative from &apos;react-native&apos;;import styles from &apos;./toolBarStyles&apos;;const { View, Text } = ReactNative;const ToolBar = () =&gt; (  &lt;View style={styles.toolBarContainer}&gt;    &lt;Text style={styles.toolBarText}&gt;Startup Mottos&lt;/Text&gt;  &lt;/View&gt;);export default ToolBar;</code></pre><p>以下是 <code>src/components/ToolBar/toolBarStyles.js</code>，将底色设定为黄色，文字置中：</p><pre><code>import { StyleSheet } from &apos;react-native&apos;;export default StyleSheet.create({  toolBarContainer: {    height: 40,    justifyContent: &apos;center&apos;,    alignItems: &apos;center&apos;,    flexDirection: &apos;column&apos;,    backgroundColor: &apos;#ffeb3b&apos;,  },  toolBarText: {    fontSize: 20,    color: &apos;#212121&apos;  }});</code></pre><p>以下是 <code>src/components/MottoList/MottoList.js</code>，这个 Component 中稍微複杂一些，主要是使用到了 React Native 中的 ListView Component 将资料阵列传进 dataSource，透过 renderRow 把一个个 row 给 render 出来，过程中我们透过 <code>!Immutable.is(r1.get(&#39;id&#39;), r2.get(&#39;id&#39;))</code> 去判断整个 ListView 画面是否需要 loading 新的 item 进来，这样就可以提高整个 ListView 的效能。</p><pre><code>import React, { Component } from &apos;react&apos;;import ReactNative from &apos;react-native&apos;;import Immutable from &apos;immutable&apos;;import ListItem from &apos;../ListItem&apos;;import styles from &apos;./mottoStyles&apos;;const { View, Text, ListView } = ReactNative;class MottoList extends Component {  constructor(props) {    super(props);    this.renderListItem = this.renderListItem.bind(this);    this.listenForItems = this.listenForItems.bind(this);    this.ds = new ListView.DataSource({      rowHasChanged: (r1, r2) =&gt; !Immutable.is(r1.get(&apos;id&apos;), r2.get(&apos;id&apos;)),    })  }  renderListItem(item) {    return (      &lt;ListItem item={item} onDeleteMotto={this.props.onDeleteMotto} itemsRef={this.props.itemsRef} /&gt;    );  }    listenForItems(itemsRef) {    itemsRef.on(&apos;value&apos;, (snap) =&gt; {      if(snap.val() === null) {        this.props.onGetMottos(Immutable.fromJS([]));      } else {        this.props.onGetMottos(Immutable.fromJS(snap.val()));        }         });  }  componentDidMount() {    this.listenForItems(this.props.itemsRef);  }  render() {    return (      &lt;View&gt;        &lt;ListView          style={styles.listView}          dataSource={this.ds.cloneWithRows(this.props.mottos.toArray())}          renderRow={this.renderListItem}          enableEmptySections={true}        /&gt;      &lt;/View&gt;    );  }}export default MottoList;</code></pre><p>以下是 <code>src/components/MottoList/mottoListStyles.js</code>，我们使用到了 Dimensions，可以根据萤幕的高度来设定整个 ListView 高度：</p><pre><code>import { StyleSheet, Dimensions } from &apos;react-native&apos;;const { height } = Dimensions.get(&apos;window&apos;);export default StyleSheet.create({  listView: {    flex: 1,    flexDirection: &apos;column&apos;,    height: height - 105,  },});</code></pre><p>以下是 <code>src/components/ListItem/ListItem.js</code>，我们从 props 收到了上层传进来的 motto item，显示出 motto 文字内容。当我们点击 <code>&lt;TouchableHighlight&gt;</code> 时就会删除该 motto。</p><pre><code>import React from &apos;react&apos;;import ReactNative from &apos;react-native&apos;;import styles from &apos;./listItemStyles&apos;;const { View, Text, TouchableHighlight } = ReactNative;const ListItem = (props) =&gt; {  return (    &lt;View style={styles.listItemContainer}&gt;      &lt;Text style={styles.listItemText}&gt;{props.item.get(&apos;text&apos;)}&lt;/Text&gt;      &lt;TouchableHighlight onPress={props.onDeleteMotto(props.item.get(&apos;id&apos;), props.itemsRef)}&gt;        &lt;Text&gt;Delete&lt;/Text&gt;      &lt;/TouchableHighlight&gt;    &lt;/View&gt;  )};export default ListItem;</code></pre><p>以下是 <code>src/components/ListItem/listItemStyles.js</code>：</p><pre><code>import { StyleSheet } from &apos;react-native&apos;;export default StyleSheet.create({  listItemContainer: {    flex: 1,    flexDirection: &apos;row&apos;,    padding: 10,    margin: 5,  },  listItemText: {    flex: 10,    fontSize: 18,    color: &apos;#212121&apos;,  }});</code></pre><p>以下是 <code>src/components/ActionButton/ActionButton.js</code>，当点击了按钮则会触发 onToggleModal 方法，出现新增 motto 的 modal：</p><pre><code>import React from &apos;react&apos;;import ReactNative from &apos;react-native&apos;;import styles from &apos;./actionButtonStyles&apos;;const { View, Text, Modal, TextInput, TouchableHighlight } = ReactNative;  const ActionButton = (props) =&gt; (  &lt;TouchableHighlight onPress={props.onToggleModal}&gt;    &lt;View style={styles.buttonContainer}&gt;        &lt;Text style={styles.buttonText}&gt;Add Motto&lt;/Text&gt;    &lt;/View&gt;  &lt;/TouchableHighlight&gt;);export default ActionButton;</code></pre><p>以下是 <code>src/components/ActionButton/actionButtonStyles.js</code>：</p><pre><code>import { StyleSheet } from &apos;react-native&apos;;export default StyleSheet.create({  buttonContainer: {    height: 40,    justifyContent: &apos;center&apos;,    alignItems: &apos;center&apos;,    flexDirection: &apos;column&apos;,    backgroundColor: &apos;#66bb6a&apos;,  },  buttonText: {    fontSize: 20,    color: &apos;#e8f5e9&apos;  }});</code></pre><p>以下是 <code>src/components/InputModal/InputModal.js</code>，其主要负责 Modal Component 的设计，当输入内容会触发 onChangeMottoText 发出 action，注意的是当按下送出键，同时会把 Firebase 的参考 itemsRef 送入 onCreateMotto 中，方便透过 API 去即时新增到 Firebase Database，并更新 client state 和重新渲染了 View：</p><pre><code>import React from &apos;react&apos;;import ReactNative from &apos;react-native&apos;;import styles from &apos;./inputModelStyles&apos;;const { View, Text, Modal, TextInput, TouchableHighlight } = ReactNative;const InputModal = (props) =&gt; (  &lt;View&gt;    &lt;Modal      animationType={&quot;slide&quot;}      transparent={false}      visible={props.isModalVisible}      onRequestClose={props.onToggleModal}      &gt;     &lt;View&gt;      &lt;View&gt;        &lt;Text style={styles.modalHeader}&gt;Please Keyin your Motto!&lt;/Text&gt;        &lt;TextInput          onChangeText={props.onChangeMottoText}        /&gt;        &lt;View style={styles.buttonContainer}&gt;                &lt;TouchableHighlight             onPress={props.onToggleModal}            style={[styles.cancelButton]}          &gt;            &lt;Text              style={styles.buttonText}            &gt;              Cancel            &lt;/Text&gt;          &lt;/TouchableHighlight&gt;          &lt;TouchableHighlight             onPress={props.onCreateMotto(props.itemsRef)}            style={[styles.submitButton]}          &gt;            &lt;Text              style={styles.buttonText}            &gt;              Submit            &lt;/Text&gt;          &lt;/TouchableHighlight&gt;          &lt;/View&gt;      &lt;/View&gt;     &lt;/View&gt;    &lt;/Modal&gt;  &lt;/View&gt;);export default InputModal;</code></pre><p>以下是 <code>src/components/InputModal/inputModalStyles.js</code>：</p><pre><code>import { StyleSheet } from &apos;react-native&apos;;export default StyleSheet.create({  modalHeader: {    flex: 1,    height: 30,    padding: 10,    flexDirection: &apos;row&apos;,    backgroundColor: &apos;#ffc107&apos;,    fontSize: 20,  },  buttonContainer: {    flex: 1,    flexDirection: &apos;row&apos;,  },  button: {    borderRadius: 5,  },  cancelButton: {    flex: 1,    height: 40,    alignItems: &apos;center&apos;,    justifyContent: &apos;center&apos;,    backgroundColor: &apos;#eceff1&apos;,    margin: 5,  },  submitButton: {    flex: 1,    height: 40,    alignItems: &apos;center&apos;,    justifyContent: &apos;center&apos;,    backgroundColor: &apos;#4fc3f7&apos;,    margin: 5,  },  buttonText: {    fontSize: 20,  }});</code></pre><p>设定完了 Component，我们来探讨一下 Container 的部份。以下是 <code>src/containers/ActionButtonContainer/ActionButtonContainer.js</code>：</p><pre><code>import { connect } from &apos;react-redux&apos;;import ActionButton from &apos;../../components/ActionButton&apos;;import {  toggleModal,} from &apos;../../actions&apos;;export default connect(  (state) =&gt; ({}),  (dispatch) =&gt; ({    onToggleModal: () =&gt; (      dispatch(toggleModal())    )  }))(ActionButton);</code></pre><p>以下是 <code>src/containers/InputModalContainer/InputModalContainer.js</code>：</p><pre><code>import { connect } from &apos;react-redux&apos;;import InputModal from &apos;../../components/InputModal&apos;;import Immutable from &apos;immutable&apos;;import {  toggleModal,  setInMotto,  createMotto,} from &apos;../../actions&apos;;import uuid from &apos;uuid&apos;;export default connect(  (state) =&gt; ({    isModalVisible: state.getIn([&apos;ui&apos;, &apos;isModalVisible&apos;]),    motto: state.getIn([&apos;motto&apos;, &apos;motto&apos;]),  }),  (dispatch) =&gt; ({    onToggleModal: () =&gt; (      dispatch(toggleModal())    ),    onChangeMottoText: (text) =&gt; (      dispatch(setInMotto({ path: [&apos;motto&apos;, &apos;text&apos;], value: text }))    ),    // 新增 motto 是透过 itemsRef 将新增的 motto push 进去，新增后要把本地端的 motto 清空，并关闭 modal：    onCreateMotto: (motto) =&gt; (itemsRef) =&gt; () =&gt; {      itemsRef.push({ id: uuid.v4(), text: motto.get(&apos;text&apos;), updatedAt: Date.now() });      dispatch(setInMotto({ path: [&apos;motto&apos;], value: Immutable.fromJS({ id: &apos;&apos;, text: &apos;&apos;, updatedAt: &apos;&apos; })}));      dispatch(toggleModal());    }  }),  (stateToProps, dispatchToProps, ownProps) =&gt; {    const { motto } = stateToProps;    const { onCreateMotto } = dispatchToProps;    return Object.assign({}, stateToProps, dispatchToProps, ownProps, {      onCreateMotto: onCreateMotto(motto),    });  },)(InputModal);</code></pre><p>以下是 <code>src/containers/MottoListContainer/MottoListContainer.js</code>：</p><pre><code>import { connect } from &apos;react-redux&apos;;import MottoList from &apos;../../components/MottoList&apos;;import Immutable from &apos;immutable&apos;;import uuid from &apos;uuid&apos;;import {  createMotto,  getMottos,  changeMottoTitle,} from &apos;../../actions&apos;;export default connect(  (state) =&gt; ({    mottos: state.getIn([&apos;motto&apos;, &apos;mottos&apos;]),  }),  (dispatch) =&gt; ({    onCreateMotto: () =&gt; (      dispatch(createMotto())    ),    onGetMottos: (mottos) =&gt; (      dispatch(getMottos({ mottos }))    ),    onChangeMottoTitle: (title) =&gt; (      dispatch(changeMottoTitle({ value: title }))    ),    // 判断点击的是哪一个 item 取出其 key，透过 itemsRef 将其移除    onDeleteMotto: (mottos) =&gt; (id, itemsRef) =&gt; () =&gt; {      mottos.forEach((value, key) =&gt; {        if(value.get(&apos;id&apos;) === id) {          itemsRef.child(key).remove();        }      });    }  }),  (stateToProps, dispatchToProps, ownProps) =&gt; {    const { mottos } = stateToProps;    const { onDeleteMotto } = dispatchToProps;    return Object.assign({}, stateToProps, dispatchToProps, ownProps, {      onDeleteMotto: onDeleteMotto(mottos),    });  })(MottoList);</code></pre><p>最后我们可以透过启动模拟器后使用以下指令开启我们 App！</p><pre><code>$ react-native run-android</code></pre><p>最后的成果：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/demo-1.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></p><p>同时你可以在 Firebase 后台进行观察，当呼叫 Firebase API 进行资料更动时，Firebase Realtime Database 就会即时更新：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/10/firebase-database-2.png" alt="用 React Native + Firebase 开发跨平台行动应用程式"></p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>恭喜你！你已经完成了你的第一个 React Native App，若你希望将你开发的应用程式签章后上架，请参考<a href="https://facebook.github.io/react-native/docs/signed-apk-android.html" target="_blank" rel="noopener">官方的说明文件</a>，当你完成签章打包等流程后，我们可以获得 .apk 档，这时就可以上架到市集让隔壁班心仪的女生，啊不是，是广大的 Android 使用者使用你的 App 啦！当然，由于我们的程式码可以 100% 共用于 iOS 和 Android 端，所以你也可以同步上架到 Apple Store！</p><h3 id="延伸阅读"><a href="#延伸阅读" class="headerlink" title="延伸阅读"></a>延伸阅读</h3><ol><li><a href="https://facebook.github.io/react-native/" target="_blank" rel="noopener">React Native 官方网站</a></li><li><a href="https://facebook.github.io/react/" target="_blank" rel="noopener">React 官方网站</a></li><li><a href="http://redux.js.org/index.html" target="_blank" rel="noopener">Redux 官方文件</a></li><li><a href="https://medium.com/react-id/ionic-framework-hybrid-app-vs-react-native-4facdd93f690#.eh74uqqlk" target="_blank" rel="noopener">Ionic Framework vs React Native</a></li><li><a href="https://www.sitepoint.com/how-to-build-a-todo-app-using-react-redux-and-immutable-js/" target="_blank" rel="noopener">How to Build a Todo App Using React, Redux, and Immutable.js</a></li><li><a href="https://reactjsnews.com/your-first-redux-app" target="_blank" rel="noopener">Your First Immutable React &amp; Redux App</a></li><li><a href="https://www.toptal.com/react/react-redux-and-immutablejs" target="_blank" rel="noopener">React, Redux and Immutable.js: Ingredients for Efficient Web Applications</a></li><li><a href="http://teropa.info/blog/2015/09/10/full-stack-redux-tutorial.html" target="_blank" rel="noopener">Full-Stack Redux Tutorial</a></li><li><a href="http://react-china.org/t/redux-immutable/2431" target="_blank" rel="noopener">redux与immutable实例</a></li><li><a href="https://github.com/gajus/redux-immutable" target="_blank" rel="noopener">gajus/redux-immutable</a></li><li><a href="https://github.com/acdlite/redux-actions" target="_blank" rel="noopener">acdlite/redux-actions</a></li><li><a href="https://github.com/acdlite/flux-standard-action" target="_blank" rel="noopener">Flux Standard Action</a></li><li><a href="https://medium.com/front-end-hacking/react-native-immutable-listview-example-78662fa64a15#.1b3jtjghp" target="_blank" rel="noopener">React Native ImmutableJS ListView Example</a></li><li><a href="https://github.com/FaridSafi/react-native-gifted-listview/issues/39" target="_blank" rel="noopener">React Native 0.23.1 warning: ‘In next release empty section headers will be rendered’</a></li><li><a href="https://js.coach/" target="_blank" rel="noopener">js.coach</a></li><li><a href="https://github.com/rnpm/rnpm" target="_blank" rel="noopener">React Native Package Manager</a></li><li><a href="https://github.com/crazycodeboy/RNStudyNotes" target="_blank" rel="noopener">React Native 学习笔记</a></li><li><a href="https://firebase.googleblog.com/2016/01/the-beginners-guide-to-react-native-and_84.html" target="_blank" rel="noopener">The beginners guide to React Native and Firebase</a></li><li><a href="https://www.sitepoint.com/authentication-in-react-native-with-firebase/" target="_blank" rel="noopener">Authentication in React Native with Firebase</a></li><li><a href="https://github.com/bruz/react-native-redux-groceries" target="_blank" rel="noopener">bruz/react-native-redux-groceries</a></li><li><a href="https://devdactic.com/react-native-firebase-todo/" target="_blank" rel="noopener">Building a Simple ToDo App With React Native and Firebase</a></li><li><a href="http://stackoverflow.com/questions/37403747/firebase-permission-denied" target="_blank" rel="noopener">Firebase Permission Denied</a></li><li><a href="https://firebase.googleblog.com/2014/04/best-practices-arrays-in-firebase.html" target="_blank" rel="noopener">Best Practices: Arrays in Firebase</a></li><li><a href="https://pilloxa.gitlab.io/posts/safer-passwords-in-gradle/" target="_blank" rel="noopener">Avoiding plaintext passwords in gradle</a></li><li><a href="https://facebook.github.io/react-native/docs/signed-apk-android.html" target="_blank" rel="noopener">Generating Signed APK</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>附录一、React ES5、ES6+ 常见用法对照表</title>
      <link href="/reactjs-getting-started-11.html"/>
      <url>/reactjs-getting-started-11.html</url>
      
        <content type="html"><![CDATA[<h1 id="附录一、React-ES5、ES6-常见用法对照表"><a href="#附录一、React-ES5、ES6-常见用法对照表" class="headerlink" title="附录一、React ES5、ES6+ 常见用法对照表"></a>附录一、React ES5、ES6+ 常见用法对照表</h1><p><img src="https://res.i95.me/wp-content/uploads/2016/10/react-es6.jpg" alt="一看就懂的 React ES5、ES6+ 常见用法对照表"></p><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p><a href="https://facebook.github.io/react/" target="_blank" rel="noopener">React</a> 是 Facebook 推出的开源 <a href="https://en.wikipedia.org/wiki/JavaScript" target="_blank" rel="noopener">JavaScript</a> Library。自从 React 正式开源后，React 生态系开始蓬勃发展。事实上，透过学习 React 生态系（ecosystem）的过程中，可以让我们顺便学习现代化 Web 开发的重要观念（例如：ES6、<a href="https://github.com/webpack/webpack" target="_blank" rel="noopener">Webpack</a>、<a href="https://babeljs.io/" target="_blank" rel="noopener">Babel</a>、模组化等），成为更好的开发者。虽然 ES6（ECMAScript2015）、ES7 是未来趋势（本文将 ES6、ES7 称为 ES6+），然而目前在网路上有许多的学习资源仍是以 ES5 为主，导致读者在学习上遇到一些坑洞和迷惑（本文假设读者对于 React 已经有些基本认识，若你对于 React 尚不熟悉，建议先行<a href="https://facebook.github.io/react/" target="_blank" rel="noopener">阅读官方文件</a>和<a href="https://scotch.io/tutorials/learning-react-getting-started-and-concepts" target="_blank" rel="noopener">本篇入门教学</a>）。因此本文希望透过整理在 React 中 ES5、ES6+ 常见用法对照表，让读者们可以在实现功能时（尤其在 <a href="https://facebook.github.io/react-native/" target="_blank" rel="noopener">React Native</a>）可以更清楚两者的差异，无痛转移到 ES6+。</p><h3 id="大纲"><a href="#大纲" class="headerlink" title="大纲"></a>大纲</h3><ol><li>Modules</li><li>Classes</li><li>Method definition</li><li>Property initializers</li><li>State</li><li>Arrow functions</li><li>Dynamic property names &amp; template strings</li><li>Destructuring &amp; spread attributes</li><li>Mixins</li><li>Default Parameters</li></ol><h3 id="1-Modules"><a href="#1-Modules" class="headerlink" title="1. Modules"></a>1. Modules</h3><p>随著 Web 技术的进展，模组化开发已经成为一个重要课题。关于 JavaScript 模组化我们这边不详述，建议读者参考 <a href="http://huangxuan.me/js-module-7day/#/" target="_blank" rel="noopener">这份投影片</a> 和 <a href="http://justineo.github.io/singles/writing-modular-js/" target="_blank" rel="noopener">这篇文章</a>。</p><p>ES5 若使用 CommonJS 标准，一般使用 <code>require()</code> 用法引入模组：</p><pre><code>var React = require(&apos;react&apos;);var MyComponent = require(&apos;./MyComponent&apos;);</code></pre><p>输出则是使用 <code>module.exports</code>：</p><pre><code>module.exports = MyComponent;</code></pre><p>ES6+ <code>import</code> 用法：</p><pre><code>import React from &apos;react&apos;;import MyComponent from &apos;./MyComponent&apos;;</code></pre><p>输出则是使用 <code>export default</code>：</p><pre><code>export default class MyComponent extends React.Component {}</code></pre><h3 id="2-Classes"><a href="#2-Classes" class="headerlink" title="2. Classes"></a>2. Classes</h3><p>在 React 中元件（Component）是组成视觉页面的基础。在 ES5 中我们使用 <code>React.createClass()</code> 来建立 Component，而在 ES6+ 则是用 <a href="https://babeljs.io/docs/learn-es2015/#classes" target="_blank" rel="noopener">Classes</a> 继承 <code>React.Component</code> 来建立 Component。若是有写过 Java 等物件导向语言（OOP）的读者应该对于这种写法比较不陌生，不过要注意的是 JavaScript 仍是原型继承类型的物件导向程式语言，只是使用 <code>Classes</code> 让物件导向使用上更加直观。对于选择 <code>class</code> 使用上还有疑惑的读者建议可以阅读 <a href="https://toddmotto.com/react-create-class-versus-component/" target="_blank" rel="noopener">React.createClass versus extends React.Component</a> 这篇文章。</p><p>ES5 <code>React.createClass()</code> 用法：</p><pre><code>var Photo = React.createClass({  render: function() {    return (      &lt;div&gt;        &lt;images alt={this.props.description} src={this.props.src} /&gt;      &lt;/div&gt;      );  }});ReactDOM.render(&lt;Photo /&gt;, document.getElementById(&apos;main&apos;));</code></pre><p>ES6+ <code>class</code> 用法：</p><pre><code>class Photo extends React.Component {  render() {    return &lt;images alt={this.props.description} src={this.props.src} /&gt;;  }}ReactDOM.render(&lt;Photo /&gt;, document.getElementById(&apos;main&apos;));</code></pre><p>在 ES5 我们会在 <code>componentWillMount</code> 生命週期定义希望在 <code>render</code> 前执行，且只会执行一次的任务：</p><pre><code>var Photo = React.createClass({  componentWillMount: function() {}});</code></pre><p>在 ES6+ 则是定义在 <code>constructor</code> 建构子中：</p><pre><code>class Photo extends React.Component {  constructor(props) {    super(props);    // 原本在 componentWillMount 操作的动作可以放在这  }}</code></pre><h3 id="3-Method-definition"><a href="#3-Method-definition" class="headerlink" title="3. Method definition"></a>3. Method definition</h3><p>在 ES6 中我们使用 <code>Method</code> 可以忽略 <code>function</code> 和 <code>,</code>，使用上更为简洁！ES5 <code>React.createClass()</code> 用法：</p><pre><code>var Photo = React.createClass({  handleClick: function(e) {},  render: function() {}});</code></pre><p>ES6+ class 用法：</p><pre><code>class Photo extends React.Component {  handleClick(e) {}  render() {}}</code></pre><h3 id="4-Property-initializers"><a href="#4-Property-initializers" class="headerlink" title="4. Property initializers"></a>4. Property initializers</h3><p>Component 属性值是资料传递重要的元素，在 ES5 中我们使用 <code>propTypes</code> 和 <code>getDefaultProps</code> 来定义属性（props）的预设值和型别：</p><pre><code>var Todo = React.createClass({  getDefaultProps: function() {    return {      checked: false,      maxLength: 10,    };  },  propTypes: {    checked: React.PropTypes.bool.isRequired,    maxLength: React.PropTypes.number.isRequired  },  render: function() {    return();  }});</code></pre><p>在 ES6+ 中我们则是参考 <a href="https://github.com/jeffmo/es-class-fields-and-static-properties" target="_blank" rel="noopener">ES7 property initializers</a> 使用 <code>class</code> 中的静态属性（static properties）来定义：</p><pre><code>class Todo extends React.Component {  static defaultProps = {    checked: false,    maxLength: 10,  }; // 注意有分号  static propTypes = {    checked: React.PropTypes.bool.isRequired,    maxLength: React.PropTypes.number.isRequired  };  render() {    return();  }}</code></pre><p>ES6+ 另外一种写法，可以留意一下，主要是看各团队喜好和规范，选择合适的方式：</p><pre><code>class Todo extends React.Component {    render() {        return (            &lt;View /&gt;        );    }}Todo.defaultProps = {    checked: false,    maxLength: 10,};Todo.propTypes = {    checked: React.PropTypes.bool.isRequired,    maxLength: React.PropTypes.number.isRequired,};</code></pre><h3 id="5-State"><a href="#5-State" class="headerlink" title="5. State"></a>5. State</h3><p>在 React 中 <code>Props</code> 和 <code>State</code> 是资料流传递的重要元素，不同的是 <code>state</code> 可更动，可以去执行一些运算。在 ES5 中我们使用 <code>getInitialState</code> 去初始化 <code>state</code>：</p><pre><code>var Todo = React.createClass({    getInitialState: function() {        return {            maxLength: this.props.maxLength,        };    },});</code></pre><p>在 ES6+ 中我们初始化 <code>state</code> 有两种写法：</p><pre><code>class Todo extends React.Component {    state = {        maxLength: this.props.maxLength,    }}</code></pre><p>另外一种写法，使用在建构式初始化。比较推荐使用这种方式，方便做一些运算：</p><pre><code>class Todo extends React.Component {    constructor(props){        super(props);        this.state = {            maxLength: this.props.maxLength,        };    }}</code></pre><h3 id="6-Arrow-functions"><a href="#6-Arrow-functions" class="headerlink" title="6. Arrow functions"></a>6. Arrow functions</h3><p>在讲 <code>Arrow functions</code> 之前，我们先聊聊在 React 中 <code>this</code> 和它所代表的 <code>context</code>。在 ES5 中，我们使用 <code>React.createClass()</code> 来建立 Component，而在 <code>React.createClass()</code> 下，预设帮你绑定好 <code>method</code> 的 <code>this</code>，你毋须自行绑定。所以你可以看到像是下面的例子，<code>callback function</code> handleButtonClick 中的 <code>this</code> 是指到 component 的实例（instance），而非触发事件的物件：</p><pre><code>var TodoBtn = React.createClass({    handleButtonClick: function(e) {        // 此 this 指到 component 的实例（instance），而非 button        this.setState({showOptionsModal: true});    },    render: function(){        return (            &lt;div&gt;                &lt;Button onClick={this.handleButtonClick}&gt;{this.props.label}&lt;/Button&gt;            &lt;/div&gt;        )    },});</code></pre><p>然而自动绑定这种方式反而会让人容易误解，所以在 ES6+ 推荐使用 <code>bind</code> 绑定 <code>this</code> 或使用 <code>Arrow functions</code>（它会绑定当前 <code>scope</code> 的 <code>this context</code>）两种方式，你可以参考下面例子：</p><pre><code>class TodoBtn extends React.Component{    handleButtonClick(e){        // 确认绑定 this 指到 component instance        this.setState({toggle: true});    }    render(){        // 这边可以用 this.handleButtonClick.bind(this) 手动绑定或是 Arrow functions () =&gt; {} 用法        return (            &lt;div&gt;                &lt;Button onClick={this.handleButtonClick.bind(this)} onClick={(e)=&gt; {this.handleButtonClick(e)} }&gt;{this.props.label}&lt;/Button&gt;            &lt;/div&gt;        )    },}</code></pre><p><code>Arrow functions</code> 虽然一开始看起来有点怪异，但其实观念很简单：一个简化的函数。函数基本上就是参数（不一定要有参数）、表达式、回传值（也可能是回传 undefined）：</p><pre><code>// Arrow functions 的一些例子()=&gt;7e=&gt;e+2()=&gt;{    alert(&apos;XD&apos;);}(a,b)=&gt;a+be=&gt;{    if (e == 2){        return 2;    }    return 100/e;}</code></pre><p>不过要注意的是无论是 <code>bind</code> 或是 <code>Arrow functions</code>，每次执行回传都是指到一个新的函数，若需要再调用到这个函数，请记得先把它存起来：</p><p>错误用法：</p><pre><code>class TodoBtn extends React.Component{    componentWillMount(){        Btn.addEventListener(&apos;click&apos;, this.handleButtonClick.bind(this));    }    componentDidmount(){        Btn.removeEventListener(&apos;click&apos;, this.handleButtonClick.bind(this));    }    onAppPaused(event){    }}</code></pre><p>正确用法：</p><pre><code>class TodoBtn extends React.Component{    constructor(props){        super(props);        this.handleButtonClick = this.handleButtonClick.bind(this);    }    componentWillMount(){        Btn.addEventListener(&apos;click&apos;, this.handleButtonClick);    }    componentDidMount(){        Btn.removeEventListener(&apos;click&apos;, this.handleButtonClick);    }}</code></pre><p>更多 Arrows and Lexical This 特性可以<a href="https://babeljs.io/docs/learn-es2015/#arrows" target="_blank" rel="noopener">参考这个文件</a>。</p><h3 id="7-Dynamic-property-names-amp-template-strings"><a href="#7-Dynamic-property-names-amp-template-strings" class="headerlink" title="7. Dynamic property names &amp; template strings"></a>7. Dynamic property names &amp; template strings</h3><p>以前在 ES5 我们要动态设定属性名称时，往往需要多写几行程式码才能达到目标：</p><pre><code>var Todo = React.createClass({  onChange: function(inputName, e) {    var stateToSet = {};    stateToSet[inputName + &apos;Value&apos;] = e.target.value;    this.setState(stateToSet);  },});</code></pre><p>但在 ES6+中，透过 <a href="https://babeljs.io/blog/2015/06/07/react-on-es6-plus" target="_blank" rel="noopener">enhancements to object literals</a> 和 <a href="https://babeljs.io/docs/learn-es2015/#template-strings" target="_blank" rel="noopener">template strings</a> 可以轻鬆完成动态设定属性名称的任务：</p><pre><code>class Todo extends React.Component {  onChange(inputName, e) {    this.setState({      [`${inputName}Value`]: e.target.value,    });  }}</code></pre><p>Template Strings 是一种语法糖（syntactic sugar），方便我们组织字串（这边也用上 <code>let</code>、<code>const</code> 变数和常数宣告的方式，和 <code>var</code> 的 <code>function scope</code> 不同的是它们是属于 <code>block scope</code>，亦即生存域存在于 <code>{}</code> 间）：</p><pre><code>// Interpolate variable bindingsconst name = &quot;Bob&quot;, let = &quot;today&quot;;`Hello ${name}, how are you ${time}?` \\ Hello Bob, how are you today?</code></pre><h3 id="8-Destructuring-amp-spread-attributes"><a href="#8-Destructuring-amp-spread-attributes" class="headerlink" title="8. Destructuring &amp; spread attributes"></a>8. Destructuring &amp; spread attributes</h3><p>在 React 的 Component 中，父元件利用 <code>props</code> 来传递资料到子元件是常见作法，然而我们有时会希望只传递部分资料，此时 ES6+ 中的 <a href="https://babeljs.io/docs/learn-es2015/#destructuring" target="_blank" rel="noopener">Destructuring</a> 和 <a href="https://facebook.github.io/react/docs/jsx-spread.html" target="_blank" rel="noopener">JSX 的 Spread Attributes</a> ，<code>...</code> Spread Attributes 主要是用来迭代物件：</p><pre><code>class Todo extends React.Component {  render() {    var {      className,      ...others,  // ...others 包含 this.props 除了 className 外所有值。this.props = {value: &apos;true&apos;, title: &apos;header&apos;, className: &apos;content&apos;}    } = this.props;    return (      &lt;div className={className}&gt;        &lt;TodoList {...others} /&gt;        &lt;button onClick={this.handleLoadMoreClick}&gt;Load more&lt;/button&gt;      &lt;/div&gt;    );  }}</code></pre><p>但使用上要注意的是若是有重複的属性值则以后来覆盖，下面的例子中若 <code>...this.props</code>，有 <code>className</code>，则被后来的 <code>main</code> 所覆盖：</p><pre><code>&lt;div {...this.props} className=&quot;main&quot;&gt;  …&lt;/div&gt;</code></pre><p>而 <code>Destructuring</code> 也可以用在简化 <code>Module</code> 的引入上，这边我们先用 ES5 中引入方式来看：</p><pre><code>var React = require(&apos;react-native&apos;);var Component = React.component;class HelloWorld extends Component {  render() {    return (      &lt;View&gt;        &lt;Text&gt;Hello, world!&lt;/Text&gt;      &lt;/View&gt;    );  }}export default HelloWorld;</code></pre><p>以下 ES5 写法：</p><pre><code>var React = require(&apos;react-native&apos;);var View = React.View;</code></pre><p>在 ES6+ 则可以直接使用 <code>Destructuring</code> 这种简化方式来引入模组中的元件：</p><pre><code>// 这边等于上面的写法var { View } = require(&apos;react-native&apos;);</code></pre><p>更进一步可以使用 <code>import</code> 语法：</p><pre><code>import React, {  View,  Component,  Text,} from &apos;react-native&apos;;class HelloWorld extends Component {  render() {    return (      &lt;View&gt;        &lt;Text&gt;Hello, world!&lt;/Text&gt;      &lt;/View&gt;    );  }}export default HelloWorld;</code></pre><h3 id="9-Mixins"><a href="#9-Mixins" class="headerlink" title="9. Mixins"></a>9. Mixins</h3><p>在 ES5 中，我们可以使用 <code>Mixins</code> 的方式去让不同的 Component 共用相似的功能，重用我们的程式码：</p><pre><code>var PureRenderMixin = require(&apos;react-addons-pure-render-mixin&apos;);React.createClass({  mixins: [PureRenderMixin],  render: function() {    return &lt;div className={this.props.className}&gt;foo&lt;/div&gt;;  }});</code></pre><p>但由于官方不打算在 ES6+ 中继续推行 <code>Mixins</code>，若还是希望使用，可以参考看看<a href="https://www.npmjs.com/package/es6-class-mixin" target="_blank" rel="noopener">第三方套件</a>或是<a href="https://gist.github.com/sebmarkbage/ef0bf1f338a7182b6775" target="_blank" rel="noopener">这个文件的用法</a>。</p><h3 id="10-Default-Parameters"><a href="#10-Default-Parameters" class="headerlink" title="10. Default Parameters"></a>10. Default Parameters</h3><p>以前 ES5 我们函数要使用预设值需要这样使用：</p><pre><code>var link = function (height, color) {      var height = height || 50;      var color = color || &apos;red&apos;;  }</code></pre><p>现在 ES6+ 的函数可以支援预设值，让程式码更为简洁：</p><pre><code>var link = function(height = 50, color = &apos;red&apos;) {    ...  }</code></pre><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>以上就是 React ES5、ES6+常见用法对照表，能看到这边的你应该已经对于 React ES5、ES6 使用上有些认识，先给自己一些掌声吧！确实从 ES6 开始，JavaScript 和以前我们看到的 JavaScript 有些不同，增加了许多新的特性，有些读者甚至会很怀疑说这真的是 JavaScript 吗？ES6 的用法对于初学者来说可能会需要写一点时间吸收，下一章我们将进到同样也是有革新性设计和有趣的 React Native，用 JavaScript 和 React 写 Native App！</p><h3 id="延伸阅读"><a href="#延伸阅读" class="headerlink" title="延伸阅读"></a>延伸阅读</h3><ol><li><a href="http://bbs.reactnative.cn/topic/15/react-react-native-%E7%9A%84es5-es6%E5%86%99%E6%B3%95%E5%AF%B9%E7%85%A7%E8%A1%A8" target="_blank" rel="noopener">React/React Native 的ES5 ES6写法对照表</a></li><li><a href="https://babeljs.io/blog/2015/06/07/react-on-es6-plus" target="_blank" rel="noopener">React on ES6+</a></li><li><a href="http://www.ghugo.com/react-native-es6/" target="_blank" rel="noopener">react native 中es6语法解析</a></li><li><a href="https://babeljs.io/docs/learn-es2015/" target="_blank" rel="noopener">Learn ES2015</a></li><li><a href="http://es6.ruanyifeng.com/" target="_blank" rel="noopener">ECMAScript 6入门</a></li><li><a href="https://facebook.github.io/react/index.html" target="_blank" rel="noopener">React官方网站</a></li><li><a href="http://fraserxu.me/intro-to-react/" target="_blank" rel="noopener">React INTRO TO REACT.JS</a></li><li><a href="https://toddmotto.com/react-create-class-versus-component/" target="_blank" rel="noopener">React.createClass versus extends React.Component</a></li><li><a href="https://github.com/lzbSun/react-native-coding-style" target="_blank" rel="noopener">react-native-coding-style</a></li><li><a href="https://github.com/airbnb/javascript/tree/master/react" target="_blank" rel="noopener">Airbnb React/JSX Style Guide</a></li><li><a href="http://es6.ruanyifeng.com/" target="_blank" rel="noopener">ECMAScript 6入门</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于今天面试的记录</title>
      <link href="/about-20160930-interview.html"/>
      <url>/about-20160930-interview.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>今天去面试，虽然过程中不到半个小时，在我回去路上想了想，觉得有些地方并没有做得很好，故笔记下。以及给一些盆友们参考下。</p><h3 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h3><p>在去面试之前，要做好一切准备，毕竟你即将面对的是人事部HR，她会从你的作风，习惯等看出你是个什么样的人。总之做好万无一失。</p><p>当接到通知去面试的电话时候，记住一定要注意你的口气，以及别忘了你的礼貌。而且在挂断电话的时候，切记别急着忙着挂，尽量等待对方挂断电话或者等待五秒后再挂断，这样的话不怕对方会有什么遗留的事情需要叮嘱。其次在你收到HR的短信或者邮件时候，尽量回复个“收到了，谢谢您！”，至少给对方留个谦虚的好印象！但我之前太忙了，没来得及回复，不过第二天回复了…</p><p>然后就是简历了，简历上的东西废话不能太多，不然HR看这没营养的文字甚是心烦。可以参考下我所制作的简历。还有哦，简历模板千万千万别在用那些传统式的排版，简直是OUT了…我看了都想吐…找个耳目一新的模板有加分项！</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/jianli.jpg" alt="我的简历"></p><p>关于简历的内容，第二页尽量超过一半，连一半都不到，那干脆不用第二页了，直接写在第一页吧。</p><p>去公司面试的时间，尽量提早10-15分钟之前到达，要给HR一个守时的好印象…虽然我今天去的时候迟到了，233333，不过我发短信给HR说明状况。</p><p>总之面试一定一定要顺利，出现情况最好打个电话或者发条短信说明下情况。</p><h3 id="面试"><a href="#面试" class="headerlink" title="面试"></a>面试</h3><p>也不知道这是第几次面试了，至少今天在门口等待中心情真紧张…不过深吸几下，心情也差不多平静了。</p><p>刚进去的第一个问题，这都是普遍需要的流程，请自我介绍下自己。</p><p>回答这个问题，我基本把自身的基础信息介绍下，但我说到我有一年工作经验的时候，这时候你可以围绕下你之前在哪上过，做什么的，期间怎么样。说完了再谈谈自己有什么优缺点，(我貌似忘了说自己缺点…)，以及你的<code>职业规划</code>，职业规划这个很重要！必须说，否则HR感觉你这一生简直碌碌无为…</p><p>总之自我介绍千万别太短，时间控制在5-10分钟。还有和HR交流的时候，眼光尽量别瞎漂…也别老盯着HR看…不然尴尬癌犯了…</p><p>接下来可能就是HR问你一些你自身的详细情况，比如你住在哪，家里的情况什么的。也没啥好说的。然后可能在你简历找点什么说说。</p><p>我几天所被问到的除了以上还有就是对我职业规划，我回答是全栈，但HR的意思希望你需要去了解Android，这个对我来说没什么问题，本身就有些基础。除此之外就是问了有没有看<code>公司官网</code>，你觉得我们公司是做什么的。幸亏昨天发短信提到公司的网址，我点进去仔细看看…不然真的尴尬了，233333，这也算得上一个雷点了。</p><p>然后谈到薪资了，还是那句话，你有技术就会有应有的薪资，未来的日子可以提出提薪。</p><p>结束之后别忘了客气点，说声<code>谢谢，再见</code>。</p><p>我就这样过来了，话不想说得太满，感觉没啥问题吧。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>R10-实战教学：用 React + Redux + Node（Isomorphic JavaScript）开发食谱分享网站</title>
      <link href="/reactjs-getting-started-10.html"/>
      <url>/reactjs-getting-started-10.html</url>
      
        <content type="html"><![CDATA[<h1 id="React-Redux-Sever-Rendering（Isomorphic-JavaScript）入门"><a href="#React-Redux-Sever-Rendering（Isomorphic-JavaScript）入门" class="headerlink" title="React Redux Sever Rendering（Isomorphic JavaScript）入门"></a>React Redux Sever Rendering（Isomorphic JavaScript）入门</h1><p><img src="https://res.i95.me/wp-content/uploads/2016/09/isomorphic-javascript.png" alt="React Redux Sever Rendering（Isomorphic）入门" title="React Redux Sever Rendering（Isomorphic）入门"></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>由于可能有些读者没听过 <a href="http://isomorphic.net/" target="_blank" rel="noopener">Isomorphic JavaScript</a> 。因此在进到开发 React Redux Sever Rendering 应用程式的主题之前我们先来聊聊 Isomorphic JavaScript 这个议题。</p><p>根据 <a href="http://isomorphic.net/" target="_blank" rel="noopener">Isomorphic JavaScript</a> 这个网站的说明：</p><blockquote><p>Isomorphic JavaScript Isomorphic JavaScript apps are JavaScript applications that can run both client-side and server-side. The backend and frontend share the same code.</p></blockquote><p>Isomorphic JavaScript 系指浏览器端和伺服器端共用 JavaScript 的程式码。</p><p>另外，除了 Isomorphic JavaScript 外，读者或许也有听过 Universal JavaScript 这个用词。那什麽是 Universal JavaScript 呢？它和 Isomorphic JavaScript 是指一样的意思吗？针对这个议题网路上有些开发者提出了自己的观点： <a href="https://medium.com/@mjackson/universal-javascript-4761051b7ae9#.67xsay73m" target="_blank" rel="noopener">Universal JavaScript</a>、<a href="https://medium.com/@ghengeveld/isomorphism-vs-universal-javascript-4b47fb481beb#.qvggcp3v8" target="_blank" rel="noopener">Isomorphism vs Universal JavaScript</a>。其中 Isomorphism vs Universal JavaScript 这篇文章的作者 Gert Hengeveld 指出 <code>Isomorphic JavaScript</code> 主要是指前后端共用 JavaScript 的开发方式，而 <code>Universal JavaScript</code> 是指 JavaScript 程式码可以在不同环境下运行，这当然包含浏览器端和伺服器端，甚至其他环境。也就是说 <code>Universal JavaScript</code> 在意义上可以涵盖的比 <code>Isomorphic JavaScript</code> 更广泛一些，然而在 Github 或是许多技术讨论上通常会把两者视为同一件事情，这部份也请读者留意。</p><h2 id="Isomorphic-JavaScript-的好处"><a href="#Isomorphic-JavaScript-的好处" class="headerlink" title="Isomorphic JavaScript 的好处"></a>Isomorphic JavaScript 的好处</h2><p>在开始真正撰写 Isomorphic JavaScript 前我们在进一步探讨使用 Isomorphic JavaScript 有哪些好处？在谈好处之前，我们先看看最早 Web 开发是如何处理页面渲染和 state 管理，还有遇到哪些挑战。</p><p>最早的时候我们谈论 Web 很单纯，都是由 Server 端进行模版的处理，你可以想成 template 是一个函数，我们传送资料进去，template 最后产生一张 HTML 给浏览器显示。例如：Node 使用的（<a href="http://ejs.co/" target="_blank" rel="noopener">EJS</a>、<a href="http://jade-lang.com/" target="_blank" rel="noopener">Jade</a>）、Python/Django 的 <a href="https://docs.djangoproject.com/el/1.10/ref/templates/" target="_blank" rel="noopener">Template</a> 或替代方案 <a href="https://github.com/pallets/jinja" target="_blank" rel="noopener">Jinja</a>、PHP 的 <a href="http://www.smarty.net/" target="_blank" rel="noopener">Smarty</a>、<a href="https://laravel.com/" target="_blank" rel="noopener">Laravel</a> 使用的 <a href="https://laravel.com/docs/5.0/templates" target="_blank" rel="noopener">Blade</a>，甚至是 Ruby on Rails 用的 <a href="http://guides.rubyonrails.org/layouts_and_rendering.html" target="_blank" rel="noopener">ERB</a>。都是由后端去 render 所有资料和页面，前端处理相对单纯。</p><p>然而随著前端工程的软体工程化和使用者体验的要求，开始出现各式前端框架的百花齐放，例如：<a href="http://backbonejs.org/" target="_blank" rel="noopener">Backbone.js</a>、<a href="http://emberjs.com/" target="_blank" rel="noopener">Ember.js</a> 和 <a href="https://angularjs.org/" target="_blank" rel="noopener">Angular.js</a> 等前端 MVC (Model-View-Controller) 或 MVVM (Model-View-ViewModel) 框架，将页面于前端渲染的不刷页单页式应用程式（Single Page App）也因此开始流行。</p><p>后端除了提供初始的 HTML 外，还提供 API Server 让前端框架可以取得资料用于前端 template。複杂的逻辑由 ViewModel/Presenter 来处理，前端 template 只处理简单的是否显示或是元素迭代的状况，如下图所示：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/client-mvc.png" alt="React Redux Sever Rendering（Isomorphic）入门" title="React Redux Sever Rendering（Isomorphic）入门"></p><p>然而前端渲染 template 虽然有它的好处但也遇到一些问题包括效能、SEO 等议题。此时我们就开始思考 Isomorphic JavaScript 的可能性：为什麽我们不能前后端都使用 JavaScript 甚至是 React？</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/isomorphic-api.png" alt="React Redux Sever Rendering（Isomorphic）入门" title="React Redux Sever Rendering（Isomorphic）入门"></p><p>事实上，React 的优势就在于它可以很优雅地实现 Server Side Rendering 达到 Isomorphic JavaScript 的效果。在 <code>react-dom/server</code> 中有两个方法 <code>renderToString</code> 和 <code>renderToStaticMarkup</code> 可以在 server 端渲染你的 components。其主要都是将 React Component 在 Server 端转成 DOM String，也可以将 props 往下传，然而事件处理会失效，要到 client-side 的 React 接收到后才会把它加上去（但要注意 server-side 和 client-side 的 checksum 要一致不然会出现错误），这样一来可以提高渲染速度和 SEO 效果。<code>renderToString</code> 和 <code>renderToStaticMarkup</code> 最大的差异在于 <code>renderToStaticMarkup</code> 会少加一些 React 内部使用的 DOM 属性，例如：<code>data-react-id</code>，因此可以节省一些资源。</p><p>使用 <code>renderToString</code> 进行 Server 端渲染：</p><pre><code>import ReactDOMServer from &apos;react-dom/server&apos;;ReactDOMServer.renderToString(&lt;HelloButton name=&quot;Mark&quot; /&gt;);</code></pre><p>渲染出来的效果：</p><pre><code>&lt;button data-reactid=&quot;.7&quot; data-react-checksum=&quot;762752829&quot;&gt;  Hello, Mark&lt;/button&gt;</code></pre><p>总的来说使用 Isomorphic JavaScript 会有以下的好处：</p><ol><li>有助于 SEO</li><li>Rendering 速度较快，效能较佳</li><li>放弃蹩脚的 Template 语法拥抱 Component 元件化思考，便于维护</li><li>尽量前后端共用程式码节省开发时间</li></ol><p>不过要注意的是如果有使用 Redux 在 Server Side Rendering 中，其流程相对複杂，不过大致流程如下： 由后端预先载入需要的 initialState，由于 Server 渲染必须全部都转成 string，所以先将 state 先 dehydration（脱水），等到 client 端再 rehydration（覆水），重建 store 往下传到前端的 React Component。</p><p>而要把资料从伺服器端传递到客户端，我们需要：</p><ol><li>把取得初始 state 当做参数并对每个请求建立一个全新的 Redux store 实体</li><li>选择性地 dispatch 一些 action</li><li>把 state 从 store 取出来</li><li>把 state 一起传到客户端</li></ol><p>接下来我们就开始动手实作一个简单的 React Server Side Rendering Counter 应用程式。</p><h2 id="专案成果截图"><a href="#专案成果截图" class="headerlink" title="专案成果截图"></a>专案成果截图</h2><p><img src="https://res.i95.me/wp-content/uploads/2016/09/react-server-rendering-demo.png" alt="React Redux Sever Rendering（Isomorphic）入门" title="React Redux Sever Rendering（Isomorphic）入门"></p><h2 id="环境安装与设定"><a href="#环境安装与设定" class="headerlink" title="环境安装与设定"></a>环境安装与设定</h2><ol><li>安装 Node 和 NPM</li><li><p>安装所需套件 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    $ npm install --save react react-dom redux react-redux react-router immutable redux-immutable redux-actions redux-thunk babel-polyfill babel-register body-parser express morgan qs</span><br><span class="line"></span><br><span class="line">$ npm install --save-dev babel-core babel-eslint babel-loader babel-preset-es2015 babel-preset-react babel-preset-stage-1 eslint eslint-config-airbnb eslint-loader eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-react html-webpack-plugin webpack webpack-dev-server redux-logger</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    接下来我们先设定一下开发文档。</span><br><span class="line">    </span><br><span class="line">    1. 设定 Babel 的设定档： `.babelrc`</span><br></pre></td></tr></table></figure></p><p>{<br> “presets”: [<br>   “es2015”,<br>   “react”,<br> ],<br> “plugins”: []<br>}</p></li></ol><ol start="2"><li><p>设定 ESLint 的设定档和规则： `.eslintrc<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">    `&#123;  </span><br><span class="line">    &quot;extends&quot;: &quot;airbnb&quot;,  </span><br><span class="line">    &quot;rules&quot;: &#123;  </span><br><span class="line">    &quot;react/jsx-filename-extension&quot;: [1, &#123; &quot;extensions&quot;: [&quot;.js&quot;, &quot;.jsx&quot;] &#125;],  </span><br><span class="line">    &#125;,  </span><br><span class="line">    &quot;env&quot; :&#123;  </span><br><span class="line">    &quot;browser&quot;: true,  </span><br><span class="line">    &#125;  </span><br><span class="line">    &#125;`</span><br><span class="line"></span><br><span class="line">````````````````````````````````````````3. 设定 Webpack 设定档： `webpack.config.js</span><br></pre></td></tr></table></figure></p><p>// 让你可以动态插入 bundle 好的 .js 档到 .index.html<br>const HtmlWebpackPlugin = require(‘html-webpack-plugin’);</p><p>const HTMLWebpackPluginConfig = new HtmlWebpackPlugin({<br> template: <code>${__dirname}/src/index.html</code>,<br> filename: ‘index.html’,<br> inject: ‘body’,<br>});</p><p>// entry 为进入点，output 为进行完 eslint、babel loader 转译后的档案位置<br>module.exports = {<br> entry: [<br>   ‘./src/index.js’,<br> ],<br> output: {<br>   path: <code>${__dirname}/dist</code>,<br>   filename: ‘index_bundle.js’,<br> },<br> module: {<br>   preLoaders: [</p><pre><code>{  test: /.jsx$|.js$/,  loader: &apos;eslint-loader&apos;,  include: `${__dirname}/src`,  exclude: /bundle.js$/}</code></pre><p>   ],<br>   loaders: [{</p><pre><code>test: /.js$/,exclude: /node_modules/,loader: &apos;babel-loader&apos;,query: {  presets: [&apos;es2015&apos;, &apos;react&apos;],},</code></pre><p>   }],<br> },<br> // 启动开发测试用 server 设定（不能用在 production）<br> devServer: {<br>   inline: true,<br>   port: 8008,<br> },<br> plugins: [HTMLWebpackPluginConfig],<br>};</p></li></ol><p>太好了！这样我们就完成了开发环境的设定可以开始动手实作 <code>React Server Side Rendering Counter</code> 应用程式了！</p><p>先看一下我们整个专案的资料结构，我们把整个专案分成三个主要的资料夹（<code>client</code>、<code>server</code>，还有共用程式码的 <code>common</code>）：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/react-server-rendering-folder.png" alt="React Redux Sever Rendering（Isomorphic）入门" title="React Redux Sever Rendering（Isomorphic）入门"></p><h2 id="动手实作"><a href="#动手实作" class="headerlink" title="动手实作"></a>动手实作</h2><p>首先，我们先定义了 <code>client</code> 的 <code>index.js</code>：</p><pre><code>// 引用 babel-polyfill 避免浏览器不支援部分 ES6 用法import &apos;babel-polyfill&apos;;import React from &apos;react&apos;;import ReactDOM from &apos;react-dom&apos;;import { Provider } from &apos;react-redux&apos;;import CounterContainer from &apos;../common/containers/CounterContainer&apos;;import configureStore from &apos;../common/store/configureStore&apos;import { fromJS } from &apos;immutable&apos;;// 从 server 取得传进来的 initialState。由于从字串转回物件，又称为 rehydration（覆水） const initialState = window.__PRELOADED_STATE__;// 由于我们使用 ImmutableJS，所以需要把在 server-side dehydration（脱水）又在前端 rehydration（覆水）的 initialState 转成 ImmutableJS 资料型态，并传进 configureStore 建立 storeconst store = configureStore(fromJS(initialState));// 接下来就跟一般的 React App 一样，把 store 透过 Provider 往下传到 Component 中ReactDOM.render(  &lt;Provider store={store}&gt;    &lt;CounterContainer /&gt;  &lt;/Provider&gt;,  document.getElementById(&apos;app&apos;));</code></pre><p>由于 Node 端要到新版对于 ES6 支援较好，所以先用 <code>babel-register</code> 在 <code>src/server/index.js</code> 去即时转译 <code>server.js</code>，但目前不建议在 <code>production</code> 环境使用。</p><pre><code>// use babel-register to precompile ES6 syntaxrequire(&apos;babel-register&apos;);require(&apos;./server&apos;);</code></pre><p>接著是我们 <code>server</code> 端，也是这个范例最重要的一个部分。首先我们用 <code>express</code> 建立了一个 port 为 3000 的 server，并使用 webpack 去执行 <code>client</code> 的程式码。这个范例中我们使用了 <code>handleRender</code> 当 request 进来时（直接拜访页面或重新整理）就会执行 fetchCounter() 进行处理：</p><pre><code>import Express from &apos;express&apos;;import qs from &apos;qs&apos;;import webpack from &apos;webpack&apos;;import webpackDevMiddleware from &apos;webpack-dev-middleware&apos;;import webpackHotMiddleware from &apos;webpack-hot-middleware&apos;;import webpackConfig from &apos;../webpack.config&apos;;import React from &apos;react&apos;;import { renderToString } from &apos;react-dom/server&apos;;import { Provider } from &apos;react-redux&apos;;import { fromJS } from &apos;immutable&apos;;import configureStore from &apos;../common/store/configureStore&apos;;import CounterContainer from &apos;../common/containers/CounterContainer&apos;;import { fetchCounter } from &apos;../common/api/counter&apos;;const app = new Express();const port = 3000;function handleRender(req, res) {  // 模仿实际非同步 api 处理情形  fetchCounter(apiResult =&gt; {  // 读取 api 提供的资料（这边我们 api 是用 setTimeout 进行模仿非同步状况），若网址参数有值择取值，若无则使用 api 提供的随机值，若都没有则取 0    const params = qs.parse(req.query);    const counter = parseInt(params.counter, 10) || apiResult || 0;    // 将 initialState 转成 immutable 和符合 state 设计的格式     const initialState = fromJS({      counterReducers: {        count: counter,      }    });    // 建立一个 redux store    const store = configureStore(initialState);    // 使用 renderToString 将 component 转为 string    const html = renderToString(      &lt;Provider store={store}&gt;        &lt;CounterContainer /&gt;      &lt;/Provider&gt;    );    // 从建立的 redux store 中取得 initialState    const finalState = store.getState();    // 将 HTML 和 initialState 传到 client-side    res.send(renderFullPage(html, finalState));  })}// HTML Markup，同时也把 preloadedState 转成字串（stringify）传到 client-side，又称为 dehydration（脱水）function renderFullPage(html, preloadedState) {  return `    &lt;!doctype html&gt;        &lt;title&gt;Redux Universal Example&lt;/title&gt;        &lt;div id=&quot;app&quot;&gt;${html}&lt;/div&gt;        &lt;script&gt;          window.__PRELOADED_STATE__ = ${JSON.stringify(preloadedState).replace(/&lt;/g, &apos;\x3c&apos;)}        &lt;/script&gt;        &lt;script src=&quot;/static/bundle.js&quot;&gt;&lt;/script&gt;    `}// 使用 middleware 于 webpack 去进行 hot module reloading const compiler = webpack(webpackConfig);app.use(webpackDevMiddleware(compiler, { noInfo: true, publicPath: webpackConfig.output.publicPath }));app.use(webpackHotMiddleware(compiler));// 每次 server 接到 request 都会呼叫 handleRenderapp.use(handleRender);// 监听 server 状况app.listen(port, (error) =&gt; {  if (error) {    console.error(error)  } else {    console.info(`==&gt; 🌎  Listening on port ${port}. Open up http://localhost:${port}/ in your browser.`)  }});</code></pre><p>处理完 Server 的部份接下来我们来处理 actions 的部份，在这个范例中 actions 相对简单，主要就是新增和减少两个行为，以下为 <code>src/actions/counterActions.js</code>：</p><pre><code>import { createAction } from &apos;redux-actions&apos;;import {  INCREMENT_COUNT,  DECREMENT_COUNT,} from &apos;../constants/actionTypes&apos;;export const incrementCount = createAction(INCREMENT_COUNT);export const decrementCount = createAction(DECREMENT_COUNT);</code></pre><p>以下为输出常数 <code>src/constants/actionTypes.js</code>：</p><pre><code>export const INCREMENT_COUNT = &apos;INCREMENT_COUNT&apos;;  export const DECREMENT_COUNT = &apos;DECREMENT_COUNT&apos;;</code></pre><p>在这个范例中我们使用 <code>setTimeout()</code> 来模拟非同步的产生资料让 server 端在每次接收 request 时读取随机产生的值。实务上，我们会开 API 让 Server 读取初始要汇入的 initialState。</p><pre><code>function getRandomInt(min, max) {  return Math.floor(Math.random() * (max - min)) + min}export function fetchCounter(callback) {  setTimeout(() =&gt; {    callback(getRandomInt(1, 100))  }, 500)}</code></pre><p>谈完 actions 我们来看我们的 reducers，在这个范例中 reducers 也是相对简单的，主要就是针对新增和减少两个行为去 set 值，以下是 <code>src/reducers/counterReducers.js</code>：</p><pre><code>import { fromJS } from &apos;immutable&apos;;import { handleActions } from &apos;redux-actions&apos;;import { CounterState } from &apos;../constants/models&apos;;import {  INCREMENT_COUNT,  DECREMENT_COUNT,} from &apos;../constants/actionTypes&apos;;const counterReducers = handleActions({  INCREMENT_COUNT: (state) =&gt; (    state.set(      &apos;count&apos;,      state.get(&apos;count&apos;) + 1    )  ),  DECREMENT_COUNT: (state) =&gt; (    state.set(      &apos;count&apos;,      state.get(&apos;count&apos;) - 1    )  ),}, CounterState);export default counterReducers;</code></pre><p>准备好了 <code>rootReducer</code> 就可以使用 <code>createStore</code> 来创建我们 store，值得注意的是由于 <code>configureStore</code> 需要被 client-side 和 server-side 使用，所以把它输出成 function 方便传入 initialState 使用。以下是 <code>src/store/configureStore.js</code>：</p><pre><code>import { createStore, applyMiddleware } from &apos;redux&apos;;import thunk from &apos;redux-thunk&apos;;import createLogger from &apos;redux-logger&apos;;import rootReducer from &apos;../reducers&apos;;export default function configureStore(preloadedState) {  const store = createStore(    rootReducer,    preloadedState,    applyMiddleware(createLogger({ stateTransformer: state =&gt; state.toJS() }), thunk)  )  return store}</code></pre><p>最后来到了 <code>components</code> 和 <code>containers</code> 的时间，这次我们的 Component 主要有两个按钮让使用者可以新增和减少数字并显示目前数字。以下是 <code>src/components/Counter/Counter.js</code>：</p><pre><code>import React, { Component, PropTypes } from &apos;react&apos;const Counter = ({  count,  onIncrement,  onDecrement,}) =&gt; (  &lt;p&gt;    Clicked: {count} times    {&apos; &apos;}    &lt;button onClick={onIncrement}&gt;      +    &lt;/button&gt;    {&apos; &apos;}    &lt;button onClick={onDecrement}&gt;      -    &lt;/button&gt;    {&apos; &apos;}  &lt;/p&gt;);// 注意要检查 propTypes 和给定预设值Counter.propTypes = {  count: PropTypes.number.isRequired,  onIncrement: PropTypes.func.isRequired,  onDecrement: PropTypes.func.isRequired}Counter.defaultProps = {  count: 0,  onIncrement: () =&gt; {},  onDecrement: () =&gt; {}}export default Counter;</code></pre><p>最后把取出的 <code>count</code> 和事件处理方法用 connect 传到 <code>Counter</code> 就大功告成了！以下是 <code>src/containers/CounterContainer/CounterContainer.js</code>：</p><pre><code>import &apos;babel-polyfill&apos;;import { connect } from &apos;react-redux&apos;;import Counter from &apos;../../components/Counter&apos;;import {  incrementCount,  decrementCount,} from &apos;../../actions&apos;;export default connect(  (state) =&gt; ({    count: state.get(&apos;counterReducers&apos;).get(&apos;count&apos;),  }),  (dispatch) =&gt; ({     onIncrement: () =&gt; (      dispatch(incrementCount())    ),    onDecrement: () =&gt; (      dispatch(decrementCount())    ),  }))(Counter);</code></pre><p>若一切顺利，在终端机打上 <code>$ npm start</code>，你将可以在浏览器的 <code>http://localhost:3000</code> 看到自己的成果！</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/react-server-rendering-demo.png" alt="React Redux Sever Rendering（Isomorphic）入门" title="React Redux Sever Rendering（Isomorphic）入门"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本章阐述了 Web 页面浏览的进程和 Isomorphic JavaScript 的优势，并介绍了如何使用 React Redux 进行 Server Side Rendering 的应用程式设计。下一个章节我们将整合后端资料库，运用 React + Redux + Node（Isomorphic）开发一个简单的食谱分享网站。</p><h2 id="延伸阅读"><a href="#延伸阅读" class="headerlink" title="延伸阅读"></a>延伸阅读</h2><ol><li><a href="https://github.com/DavidWells/isomorphic-react-example" target="_blank" rel="noopener">DavidWells/isomorphic-react-example</a></li><li><a href="https://github.com/RickWong/react-isomorphic-starterkit" target="_blank" rel="noopener">RickWong/react-isomorphic-starterkit</a></li><li><a href="https://www.bensmithett.com/server-rendered-react-components-in-rails/" target="_blank" rel="noopener">Server-rendered React components in Rails</a></li><li><a href="http://nerds.airbnb.com/weve-launched-our-first-nodejs-app-to-product/" target="_blank" rel="noopener">Our First Node.js App: Backbone on the Client and Server</a></li><li><a href="https://bensmithett.github.io/going-isomorphic-with-react/#/" target="_blank" rel="noopener">Going Isomorphic with React</a></li><li><a href="https://github.com/airbnb/hypernova" target="_blank" rel="noopener">A service for server-side rendering your JavaScript views</a></li><li><a href="http://nerds.airbnb.com/isomorphic-javascript-future-web-apps/" target="_blank" rel="noopener">Isomorphic JavaScript: The Future of Web Apps</a></li><li><a href="https://github.com/reactjs/react-router-tutorial/tree/master/lessons/13-server-rendering" target="_blank" rel="noopener">React Router Server Rendering</a></li></ol><hr><h1 id="用-React-Redux-Node（Isomorphic-JavaScript）开发食谱分享网站"><a href="#用-React-Redux-Node（Isomorphic-JavaScript）开发食谱分享网站" class="headerlink" title="用 React + Redux + Node（Isomorphic JavaScript）开发食谱分享网站"></a>用 React + Redux + Node（Isomorphic JavaScript）开发食谱分享网站</h1><h2 id="前言-1"><a href="#前言-1" class="headerlink" title="前言"></a>前言</h2><p>如果你是从一开始跟著我们踏出 React 旅程的读者真的恭喜你，也谢谢你一路跟著我们的学习脚步，对一个初学者来说这一段路并不容易。本章是扣除附录外我们最后一个正式章节的范例，也是规模最大的一个，在这个章节中我们要整合过去所学和添加一些知识开发一个可以登入会员并分享食谱的社群网站，Les’s GO！</p><h2 id="需求规划"><a href="#需求规划" class="headerlink" title="需求规划"></a>需求规划</h2><p>让使用者可以登入会员并分享食谱的社群网站</p><h2 id="功能规划"><a href="#功能规划" class="headerlink" title="功能规划"></a>功能规划</h2><ol><li>React Router / Redux / Immutable / Server Render / Async API</li><li>使用者登入/登出（JSON Web Token）</li><li>CRUD 表单资料处理</li><li>资料库串接(ORM/MongoDB)</li></ol><h2 id="使用技术"><a href="#使用技术" class="headerlink" title="使用技术"></a>使用技术</h2><ol><li>React</li><li>Redux(redux-actions/redux-promise/redux-immutable)</li><li>React Router</li><li>ImmutableJS</li><li>Node MongoDB ORM(Mongoose)</li><li>JSON Web Token</li><li>React Bootstrap</li><li>Axios(Promise)</li><li>Webpack</li><li>UUID</li></ol><h2 id="专案成果截图-1"><a href="#专案成果截图-1" class="headerlink" title="专案成果截图"></a>专案成果截图</h2><p><img src="https://res.i95.me/wp-content/uploads/2016/09/open-cook-demo-1.png" alt="用 React + Redux + Node（Isomorphic）开发一个食谱分享网站" title="用 React + Redux + Node（Isomorphic）开发一个食谱分享网站"></p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/open-cook-demo-2.png" alt="用 React + Redux + Node（Isomorphic）开发一个食谱分享网站" title="用 React + Redux + Node（Isomorphic）开发一个食谱分享网站"></p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/open-cook-demo-3.png" alt="用 React + Redux + Node（Isomorphic）开发一个食谱分享网站" title="用 React + Redux + Node（Isomorphic）开发一个食谱分享网站"></p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/open-cook-demo-4.png" alt="用 React + Redux + Node（Isomorphic）开发一个食谱分享网站" title="用 React + Redux + Node（Isomorphic）开发一个食谱分享网站"></p><h2 id="环境安装与设定-1"><a href="#环境安装与设定-1" class="headerlink" title="环境安装与设定"></a>环境安装与设定</h2><ol><li>安装 Node 和 NPM</li><li><p>安装所需套件</p><p>$ npm install –save react react-dom redux react-redux react-router immutable redux-immutable redux-actions redux-promise bcrypt body-parser cookie-parser debug express immutable jsonwebtoken mongoose morgan passport passport-local react-router-bootstrap axios serve-favicon validator uuid</p></li></ol><pre><code>$ npm install --save-dev babel-core babel-eslint babel-loader babel-preset-es2015 babel-preset-react babel-preset-stage-1 eslint eslint-config-airbnb eslint-loader eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-react html-webpack-plugin webpack webpack-dev-server redux-logger</code></pre><p>接下来我们先设定一下开发文档。</p><ol><li><p>设定 Babel 的设定档： `.babelrc<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">    `&#123;  </span><br><span class="line">    &quot;presets&quot;: [  </span><br><span class="line">    &quot;es2015&quot;,  </span><br><span class="line">    &quot;react&quot;,  </span><br><span class="line">    ],  </span><br><span class="line">    &quot;plugins&quot;: []  </span><br><span class="line">    &#125;`</span><br><span class="line"></span><br><span class="line">```````````````````````````````````````2. 设定 ESLint 的设定档和规则： `.eslintrc</span><br></pre></td></tr></table></figure></p><p> {<br>   “extends”: “airbnb”,<br>   “rules”: {</p><pre><code>&quot;react/jsx-filename-extension&quot;: [1, { &quot;extensions&quot;: [&quot;.js&quot;, &quot;.jsx&quot;] }],</code></pre><p>   },<br>   “env” :{</p><pre><code>&quot;browser&quot;: true,</code></pre><p>   }<br> }</p></li></ol><ol start="3"><li>设定 Webpack 设定档： <code>webpack.config.js</code>： <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br></pre></td><td class="code"><pre><span class="line">    `import webpack from &apos;webpack&apos;;`</span><br><span class="line"></span><br><span class="line">``````````````````````````````````````module.exports = &#123;  </span><br><span class="line">entry: [  </span><br><span class="line">&apos;./src/client/index.js&apos;,  </span><br><span class="line">],  </span><br><span class="line">output: &#123;  </span><br><span class="line">path: `$&#123;__dirname&#125;/dist`,  </span><br><span class="line">filename: &apos;bundle.js&apos;,  </span><br><span class="line">publicPath: &apos;/static/&apos;  </span><br><span class="line">&#125;,  </span><br><span class="line">module: &#123;  </span><br><span class="line">preLoaders: [  </span><br><span class="line">&#123;  </span><br><span class="line">test: /.jsx$|.js$/,  </span><br><span class="line">loader: &apos;eslint-loader&apos;,  </span><br><span class="line">include: `$&#123;__dirname&#125;/app`,  </span><br><span class="line">exclude: /bundle.js$/,  </span><br><span class="line">&#125;,  </span><br><span class="line">],  </span><br><span class="line">// 使用 Hot Module Replacement 外挂  </span><br><span class="line">plugins: [  </span><br><span class="line">new webpack.optimize.OccurrenceOrderPlugin(),  </span><br><span class="line">new webpack.HotModuleReplacementPlugin()  </span><br><span class="line">],  </span><br><span class="line">loaders: [&#123;  </span><br><span class="line">test: /.js$/,  </span><br><span class="line">exclude: /node_modules/,  </span><br><span class="line">loader: &apos;babel-loader&apos;,  </span><br><span class="line">query: &#123;  </span><br><span class="line">presets: [&apos;es2015&apos;, &apos;react&apos;],  </span><br><span class="line">&#125;,  </span><br><span class="line">&#125;],  </span><br><span class="line">&#125;,  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">    4. 设定 `src/server/config/index.js`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`export default (&#123;  </span><br><span class="line">&quot;secret&quot;: &quot;ilovecooking&quot;,  </span><br><span class="line">&quot;database&quot;: &quot;mongodb://localhost/open_cook&quot;  </span><br><span class="line">&#125;);`</span><br><span class="line"></span><br><span class="line"> `````````````````````````````````````太好了！这样我们就完成了开发环境的设定可以开始动手实作我们的食谱分享社群应用程式了！</span><br><span class="line">    </span><br><span class="line">    同时我们也初步设计我们资料夹结构，主要我们将资料夹分为 `client`、`common`、`server`：</span><br><span class="line">    </span><br><span class="line">    ![用 React + Redux + Node（Isomorphic）开发一个食谱分享网站](https://res.i95.me/wp-content/uploads/2016/09/open-cook-demo-folder.png &quot;用 React + Redux + Node（Isomorphic）开发一个食谱分享网站&quot;)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    ## 动手实作</span><br><span class="line">    </span><br><span class="line">    首先我们先进行 `src/client/index.js` 的设计：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import ReactDOM from &apos;react-dom&apos;;  </span><br><span class="line">import &#123; Provider &#125; from &apos;react-redux&apos;;  </span><br><span class="line">import &#123; browserHistory, Router &#125; from &apos;react-router&apos;;  </span><br><span class="line">import &#123; fromJS &#125; from &apos;immutable&apos;;  </span><br><span class="line">// 我们的 routing 放置在 common 资料夹中的 routes  </span><br><span class="line">import routes from &apos;../common/routes&apos;;  </span><br><span class="line">import configureStore from &apos;../common/store/configureStore&apos;;  </span><br><span class="line">import &#123; checkAuth &#125; from &apos;../common/actions&apos;;`</span><br><span class="line"></span><br><span class="line">````````````````````````````````````// 将 server side 传过来的 initialState 给 rehydration（覆水）  </span><br><span class="line">const initialState = window.**PRELOADED_STATE**;</span><br><span class="line"></span><br><span class="line">// 将 initialState 传给 configureStore 函数创建出 store 并传给 Provider  </span><br><span class="line">const store = configureStore(fromJS(initialState));  </span><br><span class="line">ReactDOM.render(  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">,  </span><br><span class="line">document.getElementById(&apos;app&apos;)  </span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    由于 Node 端要到新版对于 ES6 支援较好，所以先用 `babel-register` 在 `src/server/index.js` 去即时转译 `server.js`，但不建议在 `production` 环境使用。</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`// use babel-register to precompile ES6  </span><br><span class="line">require(&apos;babel-register&apos;);  </span><br><span class="line">require(&apos;./server&apos;);`</span><br><span class="line"></span><br><span class="line"> ``````````````````````````````````` `// 引入 Express、mongoose（MongoDB ORM）以及相关 server 上使用的套件  </span><br><span class="line">/* Server Packages */  </span><br><span class="line">import Express from &apos;express&apos;;  </span><br><span class="line">import bodyParser from &apos;body-parser&apos;;  </span><br><span class="line">import cookieParser from &apos;cookie-parser&apos;;  </span><br><span class="line">import morgan from &apos;morgan&apos;;  </span><br><span class="line">import mongoose from &apos;mongoose&apos;;  </span><br><span class="line">import config from &apos;./config&apos;;  </span><br><span class="line">// 引入后端 model 透过 model 和资料库互动  </span><br><span class="line">import User from &apos;./models/user&apos;;  </span><br><span class="line">import Recipe from &apos;./models/recipe&apos;;`</span><br><span class="line"></span><br><span class="line">``````````````````````````````````// 引入 webpackDevMiddleware 当做前端 server middleware  </span><br><span class="line">/* Client Packages _/  </span><br><span class="line">import webpack from &apos;webpack&apos;;  </span><br><span class="line">import React from &apos;react&apos;;  </span><br><span class="line">import webpackDevMiddleware from &apos;webpack-dev-middleware&apos;;  </span><br><span class="line">import webpackHotMiddleware from &apos;webpack-hot-middleware&apos;;  </span><br><span class="line">import &#123; RouterContext, match &#125; from &apos;react-router&apos;;  </span><br><span class="line">import &#123; renderToString &#125; from &apos;react-dom/server&apos;;  </span><br><span class="line">import &#123; Provider &#125; from &apos;react-redux&apos;;  </span><br><span class="line">import Immutable, &#123; fromJS &#125; from &apos;immutable&apos;;  </span><br><span class="line">/_ Common Packages _/  </span><br><span class="line">import webpackConfig from &apos;../../webpack.config&apos;;  </span><br><span class="line">import routes from &apos;../common/routes&apos;;  </span><br><span class="line">import configureStore from &apos;../common/store/configureStore&apos;;  </span><br><span class="line">import fetchComponentData from &apos;../common/utils/fetchComponentData&apos;;  </span><br><span class="line">import apiRoutes from &apos;./controllers/api.js&apos;;  </span><br><span class="line">/_ config */  </span><br><span class="line">// 初始化 Express server  </span><br><span class="line">const app = new Express();  </span><br><span class="line">const port = process.env.PORT || 3000;  </span><br><span class="line">// 连接到资料库，相关设定档案放在 config.database  </span><br><span class="line">mongoose.connect(config.database); // connect to database  </span><br><span class="line">app.set(&apos;env&apos;, &apos;production&apos;);  </span><br><span class="line">// 设定静态档案位置  </span><br><span class="line">app.use(&apos;/static&apos;, Express.static(__dirname + &apos;/public&apos;));  </span><br><span class="line">app.use(cookieParser());  </span><br><span class="line">// use body parser so we can get info from POST and/or URL parameters  </span><br><span class="line">app.use(bodyParser.urlencoded(&#123; extended: false &#125;)); // only can deal with key/value  </span><br><span class="line">app.use(bodyParser.json());  </span><br><span class="line">// use morgan to log requests to the console  </span><br><span class="line">app.use(morgan(&apos;dev&apos;));</span><br><span class="line"></span><br><span class="line">// 负责每次接受到 request 的处理函数，判断该如何处理和取得 initialState 整理后结合伺服器渲染页面传往前端  </span><br><span class="line">const handleRender = (req, res) =&gt; &#123;  </span><br><span class="line">// Query our mock API asynchronously  </span><br><span class="line">match(&#123; routes, location: req.url &#125;, (error, redirectLocation, renderProps) =&gt; &#123;  </span><br><span class="line">if (error) &#123;  </span><br><span class="line">res.status(500).send(error.message);  </span><br><span class="line">&#125; else if (redirectLocation) &#123;  </span><br><span class="line">res.redirect(302, redirectLocation.pathname + redirectLocation.search);  </span><br><span class="line">&#125; else if (renderProps == null) &#123;  </span><br><span class="line">res.status(404).send(&apos;Not found&apos;);  </span><br><span class="line">&#125;  </span><br><span class="line">fetchComponentData(req.cookies.token).then((response) =&gt; &#123;  </span><br><span class="line">let isAuthorized = false;  </span><br><span class="line">if (response[1].data.success === true) &#123;  </span><br><span class="line">isAuthorized = true;  </span><br><span class="line">&#125; else &#123;  </span><br><span class="line">isAuthorized = false;  </span><br><span class="line">&#125;  </span><br><span class="line">const initialState = fromJS(&#123;  </span><br><span class="line">recipe: &#123;  </span><br><span class="line">recipes: response[0].data,  </span><br><span class="line">recipe: &#123;  </span><br><span class="line">id: &apos;&apos;,  </span><br><span class="line">name: &apos;&apos;,  </span><br><span class="line">description: &apos;&apos;,  </span><br><span class="line">imagePath: &apos;&apos;,  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;,  </span><br><span class="line">user: &#123;  </span><br><span class="line">isAuthorized: isAuthorized,  </span><br><span class="line">isEdit: false,  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;);  </span><br><span class="line">// server side 渲染页面  </span><br><span class="line">// Create a new Redux store instance  </span><br><span class="line">const store = configureStore(initialState);  </span><br><span class="line">const initView = renderToString(  </span><br><span class="line">  </span><br><span class="line">&lt;RouterContext &#123;...renderProps&#125; /&gt;  </span><br><span class="line">  </span><br><span class="line">);  </span><br><span class="line">let state = store.getState();  </span><br><span class="line">let page = renderFullPage(initView, state);  </span><br><span class="line">return res.status(200).send(page);  </span><br><span class="line">&#125;)  </span><br><span class="line">.catch(err =&gt; res.end(err.message));  </span><br><span class="line">&#125;)  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 基础页面 HTML 设计  </span><br><span class="line">const renderFullPage = (html, preloadedState) =&gt; (`  </span><br><span class="line">&lt;!doctype html&gt;</span><br><span class="line"></span><br><span class="line">        &lt;title&gt;OpenCook 分享料理的美好时光&lt;/title&gt;</span><br><span class="line">        &lt;!-- Latest compiled and minified CSS --&gt;</span><br><span class="line">        &lt;link rel=&quot;stylesheet&quot; href=&quot;//maxcdn.bootstrapcdn.com/bootstrap/latest/css/bootstrap.min.css&quot;&gt;</span><br><span class="line">        &lt;!-- Optional theme --&gt;</span><br><span class="line">        &lt;link rel=&quot;stylesheet&quot; href=&quot;//maxcdn.bootstrapcdn.com/bootstrap/latest/css/bootstrap-theme.min.css&quot;&gt;</span><br><span class="line">        &lt;link rel=&quot;stylesheet&quot; href=&quot;//maxcdn.bootstrapcdn.com/bootswatch/3.3.7/journal/bootstrap.min.css&quot;&gt;</span><br><span class="line">      </span><br><span class="line">        &lt;div id=&quot;app&quot;&gt;$&#123;html&#125;&lt;/div&gt;</span><br><span class="line">        &lt;script&gt;</span><br><span class="line">          window.__PRELOADED_STATE__ = $&#123;JSON.stringify(preloadedState).replace(/&lt;/g, &apos;\x3c&apos;)&#125;</span><br><span class="line">        &lt;/script&gt;</span><br><span class="line">        &lt;script src=&quot;/static/bundle.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">      </span><br><span class="line">    `</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">// 设定 hot reload middleware  </span><br><span class="line">const compiler = webpack(webpackConfig);  </span><br><span class="line">app.use(webpackDevMiddleware(compiler, &#123; noInfo: true, publicPath: webpackConfig.output.publicPath &#125;));  </span><br><span class="line">app.use(webpackHotMiddleware(compiler));</span><br><span class="line"></span><br><span class="line">// 设计 API prefix，并使用 controller 中的 apiRoutes 进行处理  </span><br><span class="line">app.use(&apos;/api&apos;, apiRoutes);  </span><br><span class="line">// 使用伺服器端 handleRender  </span><br><span class="line">app.use(handleRender);  </span><br><span class="line">app.listen(port, (error) =&gt; &#123;  </span><br><span class="line">if (error) &#123;  </span><br><span class="line">console.error(error)  </span><br><span class="line">&#125; else &#123;  </span><br><span class="line">console.info(`==&gt; 🌎 Listening on port $&#123;port&#125;. Open up http://localhost:$&#123;port&#125;/ in your browser.`)  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    由于 Node 端要到新版对于 ES6 支援较好，所以先用 `babel-register` 在 `src/server/index.js` 去即时转译 `server.js`，但目前不建议在 `production` 环境使用。</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`// use babel-register to precompile ES6 syntax  </span><br><span class="line">require(&apos;babel-register&apos;);  </span><br><span class="line">require(&apos;./server&apos;);`</span><br><span class="line"></span><br><span class="line"> `````````````````````````````````现在我们来设计一下我们资料库的 Schema，在这边我们使用 MongoDB 的 ORM Mongoose，可以方便我们使用物件方式进行资料库的操作：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`// 引入 mongoose 和 Schema  </span><br><span class="line">import mongoose, &#123; Schema &#125; from &apos;mongoose&apos;;`</span><br><span class="line"></span><br><span class="line">````````````````````````````````// 使用 mongoose.model 建立新的资料表，并将 Schema 传入  </span><br><span class="line">// 这边我们设计了食谱分享的一些基本要素，包括名称、描述、照片位置等  </span><br><span class="line">export default mongoose.model(&apos;Recipe&apos;, new Schema(&#123;  </span><br><span class="line">id: String,  </span><br><span class="line">name: String,  </span><br><span class="line">description: String,  </span><br><span class="line">imagePath: String,  </span><br><span class="line">steps: Array,  </span><br><span class="line">updatedAt: Date,  </span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">`// 引入 mongoose 和 Schema  </span><br><span class="line">import mongoose, &#123; Schema &#125; from &apos;mongoose&apos;;`</span><br><span class="line"></span><br><span class="line">```````````````````````````````// 使用 mongoose.model 建立新的资料表，并将 Schema 传入  </span><br><span class="line">// 这边我们设计了使用者的一些基本要素，包括名称、描述、照片位置等  </span><br><span class="line">export default mongoose.model(&apos;User&apos;, new Schema(&#123;  </span><br><span class="line">id: Number,  </span><br><span class="line">username: String,  </span><br><span class="line">email: String,  </span><br><span class="line">password: String,  </span><br><span class="line">admin: Boolean  </span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    为了方便维护，我们把 API 的部份统一在 `src/server/controllers/api.js` 进行管理，这部份会涉及比较多 Node 和 mongoose 的操作，若读者尚不熟悉可以参考 [mongoose 官网](http://mongoosejs.com/)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import Express from &apos;express&apos;;  </span><br><span class="line">// 引入 jsonwebtoken 套件  </span><br><span class="line">import jwt from &apos;jsonwebtoken&apos;;  </span><br><span class="line">// 引入 User、Recipe Model 方便进行资料库操作  </span><br><span class="line">import User from &apos;../models/user&apos;;  </span><br><span class="line">import Recipe from &apos;../models/recipe&apos;;  </span><br><span class="line">import config from &apos;../config&apos;;`</span><br><span class="line"></span><br><span class="line">``````````````````````````````// API Route  </span><br><span class="line">const app = new Express();  </span><br><span class="line">const apiRoutes = Express.Router();  </span><br><span class="line">// 设定 JSON Web Token 的 secret variable  </span><br><span class="line">app.set(&apos;superSecret&apos;, config.secret); // secret variable  </span><br><span class="line">// 使用者登入 API ，依据使用 email 和 密码去验证，若成功则回传一个认证 token（时效24小时）我们把它存在 cookie 中，方便前后端存取。这边我们先不考虑太多资讯安全的议题  </span><br><span class="line">apiRoutes.post(&apos;/login&apos;, function(req, res) &#123;  </span><br><span class="line">// find the user  </span><br><span class="line">User.findOne(&#123;  </span><br><span class="line">email: req.body.email  </span><br><span class="line">&#125;, (err, user) =&gt; &#123;  </span><br><span class="line">if (err) throw err;  </span><br><span class="line">if (!user) &#123;  </span><br><span class="line">res.json(&#123; success: false, message: &apos;Authentication failed. User not found.&apos; &#125;);  </span><br><span class="line">&#125; else if (user) &#123;  </span><br><span class="line">// check if password matches  </span><br><span class="line">if (user.password != req.body.password) &#123;  </span><br><span class="line">res.json(&#123; success: false, message: &apos;Authentication failed. Wrong password.&apos; &#125;);  </span><br><span class="line">&#125; else &#123;  </span><br><span class="line">// if user is found and password is right  </span><br><span class="line">// create a token  </span><br><span class="line">const token = jwt.sign(&#123; email: user.email &#125;, app.get(&apos;superSecret&apos;), &#123;  </span><br><span class="line">expiresIn: 60 * 60 * 24 // expires in 24 hours  </span><br><span class="line">&#125;);  </span><br><span class="line">// return the information including token as JSON  </span><br><span class="line">// 若登入成功回传一个 json 讯息  </span><br><span class="line">res.json(&#123;  </span><br><span class="line">success: true,  </span><br><span class="line">message: &apos;Enjoy your token!&apos;,  </span><br><span class="line">token: token,  </span><br><span class="line">userId: user._id  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;);  </span><br><span class="line">// 初始化 api，一开始资料库尚未建立任何使用者，我们需要在浏览器输入 `http://localhost:3000/api/setup`，进行资料库初始化。这个动作将新增一个使用者、一份食谱，若是成功新增将回传一个 success 讯息  </span><br><span class="line">apiRoutes.get(&apos;/setup&apos;, (req, res) =&gt; &#123;  </span><br><span class="line">// create a sample user  </span><br><span class="line">const sampleUser = new User(&#123;  </span><br><span class="line">username: &apos;mark&apos;,  </span><br><span class="line">email: &apos;mark@demo.com&apos;,  </span><br><span class="line">password: &apos;123456&apos;,  </span><br><span class="line">admin: true  </span><br><span class="line">&#125;);  </span><br><span class="line">const sampleRecipe = new Recipe(&#123;  </span><br><span class="line">id: &apos;110ec58a-a0f2-4ac4-8393-c866d813b8d1&apos;,  </span><br><span class="line">name: &apos;番茄炒蛋&apos;,  </span><br><span class="line">description: &apos;番茄炒蛋，一道非常经典的家常菜料理。虽然看似普通，但每个家庭都有属于自己家裡的不同味道&apos;,  </span><br><span class="line">imagePath: &apos;[https://c1.staticflickr.com/6/5011/5510599760_6668df5a8a_z.jpg](https://c1.staticflickr.com/6/5011/5510599760_6668df5a8a_z.jpg)&apos;,  </span><br><span class="line">steps: [&apos;放入番茄&apos;, &apos;打个蛋&apos;, &apos;放入少许盐巴&apos;, &apos;用心快炒&apos;],  </span><br><span class="line">updatedAt: new Date()  </span><br><span class="line">&#125;);  </span><br><span class="line">// save the sample user  </span><br><span class="line">sampleUser.save((err) =&gt; &#123;  </span><br><span class="line">if (err) throw err;  </span><br><span class="line">sampleRecipe.save((err) =&gt; &#123;  </span><br><span class="line">if (err) throw err;  </span><br><span class="line">console.log(&apos;User saved successfully&apos;);  </span><br><span class="line">res.json(&#123; success: true &#125;);  </span><br><span class="line">&#125;)  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;);  </span><br><span class="line">// 回传所有 recipes  </span><br><span class="line">apiRoutes.get(&apos;/recipes&apos;, (req, res) =&gt; &#123;  </span><br><span class="line">Recipe.find(&#123;&#125;, (err, recipes) =&gt; &#123;  </span><br><span class="line">res.status(200).json(recipes);  </span><br><span class="line">&#125;)  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// route middleware to verify a token  </span><br><span class="line">// 接下来的 api 将进行控管，也就是说必须在网址请求中夹带认证 token 才能完成请求  </span><br><span class="line">apiRoutes.use((req, res, next) =&gt; &#123;  </span><br><span class="line">// check header or url parameters or post parameters for token  </span><br><span class="line">// 确认标头、网址或 post 参数是否含有 token，本范例因为简便使用网址 query 参数  </span><br><span class="line">var token = req.body.token || req.query.token || req.headers[&apos;x-access-token&apos;];  </span><br><span class="line">// decode token  </span><br><span class="line">if (token) &#123;  </span><br><span class="line">// verifies secret and checks exp  </span><br><span class="line">jwt.verify(token, app.get(&apos;superSecret&apos;), (err, decoded) =&gt; &#123;  </span><br><span class="line">if (err) &#123;  </span><br><span class="line">return res.json(&#123; success: false, message: &apos;Failed to authenticate token.&apos; &#125;);  </span><br><span class="line">&#125; else &#123;  </span><br><span class="line">// if everything is good, save to request for use in other routes  </span><br><span class="line">req.decoded = decoded;  </span><br><span class="line">next();  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125; else &#123;  </span><br><span class="line">// if there is no token  </span><br><span class="line">// return an error  </span><br><span class="line">return res.status(403).send(&#123;  </span><br><span class="line">success: false,  </span><br><span class="line">message: &apos;No token provided.&apos;  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;);  </span><br><span class="line">// 确认认证是否成功  </span><br><span class="line">apiRoutes.get(&apos;/authenticate&apos;, (req, res) =&gt; &#123;  </span><br><span class="line">res.json(&#123;  </span><br><span class="line">success: true,  </span><br><span class="line">message: &apos;Enjoy your token!&apos;,  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;);  </span><br><span class="line">// create recipe 新增食谱  </span><br><span class="line">apiRoutes.post(&apos;/recipes&apos;, (req, res) =&gt; &#123;  </span><br><span class="line">const newRecipe = new Recipe(&#123;  </span><br><span class="line">name: req.body.name,  </span><br><span class="line">description: req.body.description,  </span><br><span class="line">imagePath: req.body.imagePath,  </span><br><span class="line">steps: [&apos;放入番茄&apos;, &apos;打个蛋&apos;, &apos;放入少许盐巴&apos;, &apos;用心快炒&apos;],  </span><br><span class="line">updatedAt: new Date()  </span><br><span class="line">&#125;);  </span><br><span class="line">newRecipe.save((err) =&gt; &#123;  </span><br><span class="line">if (err) throw err;  </span><br><span class="line">console.log(&apos;User saved successfully&apos;);  </span><br><span class="line">res.json(&#123; success: true &#125;);  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;);  </span><br><span class="line">// update recipe 根据 _id（mongodb 的 id）更新食谱  </span><br><span class="line">apiRoutes.put(&apos;/recipes/:id&apos;, (req, res) =&gt; &#123;  </span><br><span class="line">Recipe.update(&#123; _id: req.params.id &#125;, &#123;  </span><br><span class="line">name: req.body.name,  </span><br><span class="line">description: req.body.description,  </span><br><span class="line">imagePath: req.body.imagePath,  </span><br><span class="line">steps: [&apos;放入番茄&apos;, &apos;打个蛋&apos;, &apos;放入少许盐巴&apos;, &apos;用心快炒&apos;],  </span><br><span class="line">updatedAt: new Date()  </span><br><span class="line">&#125; ,(err) =&gt; &#123;  </span><br><span class="line">if (err) throw err;  </span><br><span class="line">console.log(&apos;User updated successfully&apos;);  </span><br><span class="line">res.json(&#123; success: true &#125;);  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;);  </span><br><span class="line">// remove recipe 根据 _id 删除食谱，若成功回传成功讯息  </span><br><span class="line">apiRoutes.delete(&apos;/recipes/:id&apos;, (req, res) =&gt; &#123;  </span><br><span class="line">Recipe.remove(&#123; _id: req.params.id &#125;, (err, recipe) =&gt; &#123;  </span><br><span class="line">if (err) throw err;  </span><br><span class="line">console.log(&apos;remove saved successfully&apos;);  </span><br><span class="line">res.json(&#123; success: true &#125;);  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;);  </span><br><span class="line">export default apiRoutes;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    设定整个 App 的 routing，我们主要页面有 `HomePageContainer`、`LoginPageContainer`、`SharePageContainer`，值得注意的是我们这边使用 [Higher Order Components](http://www.darul.io/post/2016-01-05_react-higher-order-components) （Higher Order Components 为一个函数， 接收一个 Component 后在 Class Component 的 render 中 return 回传入的 components）方式去确认使用者是否有登入，若有没登入则不能进入分享食谱页面，反之若已登入也不会再进到登入页面：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import &#123; Route, IndexRoute &#125; from &apos;react-router&apos;;  </span><br><span class="line">import Main from &apos;../components/Main&apos;;  </span><br><span class="line">import CheckAuth from &apos;../components/CheckAuth&apos;;  </span><br><span class="line">import HomePageContainer from &apos;../containers/HomePageContainer&apos;;  </span><br><span class="line">import LoginPageContainer from &apos;../containers/LoginPageContainer&apos;;  </span><br><span class="line">import SharePageContainer from &apos;../containers/SharePageContainer&apos;;`</span><br><span class="line"></span><br><span class="line">`````````````````````````````export default (  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">&lt;Route path=&quot;/login&quot; component=&#123;CheckAuth(LoginPageContainer, &apos;guest&apos;)&#125;/&gt;  </span><br><span class="line">&lt;Route path=&quot;/share&quot; component=&#123;CheckAuth(SharePageContainer, &apos;auth&apos;)&#125;/&gt;  </span><br><span class="line">  </span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    设定行为常数（`src/constants/actionTypes.js`）：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`export const AUTH_START = &quot;AUTH_START&quot;;  </span><br><span class="line">export const AUTH_COMPLETE = &quot;AUTH_COMPLETE&quot;;  </span><br><span class="line">export const AUTH_ERROR = &quot;AUTH_ERROR&quot;;  </span><br><span class="line">export const START_LOGOUT = &quot;START_LOGOUT&quot;;  </span><br><span class="line">export const CHECK_AUTH = &quot;CHECK_AUTH&quot;;  </span><br><span class="line">export const SET_USER = &quot;SET_USER&quot;;  </span><br><span class="line">export const SHOW_SPINNER = &quot;SHOW_SPINNER&quot;;  </span><br><span class="line">export const HIDE_SPINNER = &quot;HIDE_SPINNER&quot;;  </span><br><span class="line">export const SET_UI = &quot;SET_UI&quot;;  </span><br><span class="line">export const GET_RECIPES = &apos;GET_RECIPES&apos;;  </span><br><span class="line">export const SET_RECIPE = &apos;SET_RECIPE&apos;;  </span><br><span class="line">export const ADD_RECIPE = &apos;ADD_RECIPE&apos;;  </span><br><span class="line">export const UPDATE_RECIPE = &apos;UPDATE_RECIPE&apos;;  </span><br><span class="line">export const DELETE_RECIPE = &apos;DELETE_RECIPE&apos;;`</span><br><span class="line"></span><br><span class="line"> ````````````````````````````设定 `src/actions/recipeActions.js`，我们这边使用 redux-promise，可以很容易使用非同步的行为 WebAPI：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import &#123; createAction &#125; from &apos;redux-actions&apos;;  </span><br><span class="line">import WebAPI from &apos;../utils/WebAPI&apos;;`</span><br><span class="line"></span><br><span class="line">```````````````````````````import &#123;  </span><br><span class="line">GET_RECIPES,  </span><br><span class="line">ADD_RECIPE,  </span><br><span class="line">UPDATE_RECIPE,  </span><br><span class="line">DELETE_RECIPE,  </span><br><span class="line">SET_RECIPE,  </span><br><span class="line">&#125; from &apos;../constants/actionTypes&apos;;</span><br><span class="line"></span><br><span class="line">export const getRecipes = createAction(&apos;GET_RECIPES&apos;, WebAPI.getRecipes);  </span><br><span class="line">export const addRecipe = createAction(&apos;ADD_RECIPE&apos;, WebAPI.addRecipe);  </span><br><span class="line">export const updateRecipe = createAction(&apos;UPDATE_RECIPE&apos;, WebAPI.updateRecipe);  </span><br><span class="line">export const deleteRecipe = createAction(&apos;DELETE_RECIPE&apos;, WebAPI.deleteRecipe);  </span><br><span class="line">export const setRecipe = createAction(&apos;SET_RECIPE&apos;);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    设定 `src/actions/uiActions.js`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import &#123; createAction &#125; from &apos;redux-actions&apos;;  </span><br><span class="line">import WebAPI from &apos;../utils/WebAPI&apos;;`</span><br><span class="line"></span><br><span class="line">``````````````````````````import &#123;  </span><br><span class="line">SHOW_SPINNER,  </span><br><span class="line">HIDE_SPINNER,  </span><br><span class="line">SET_UI,  </span><br><span class="line">&#125; from &apos;../constants/actionTypes&apos;;</span><br><span class="line"></span><br><span class="line">export const showSpinner = createAction(&apos;SHOW_SPINNER&apos;);  </span><br><span class="line">export const hideSpinner = createAction(&apos;HIDE_SPINNER&apos;);  </span><br><span class="line">export const setUi = createAction(&apos;SET_UI&apos;);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    设定 `src/actions/userActions.js`，处理使用者登入登出等行为：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import &#123; createAction &#125; from &apos;redux-actions&apos;;  </span><br><span class="line">import WebAPI from &apos;../utils/WebAPI&apos;;`</span><br><span class="line"></span><br><span class="line">`````````````````````````import &#123;  </span><br><span class="line">AUTH_START,  </span><br><span class="line">AUTH_COMPLETE,  </span><br><span class="line">AUTH_ERROR,  </span><br><span class="line">START_LOGOUT,  </span><br><span class="line">CHECK_AUTH,  </span><br><span class="line">SET_USER  </span><br><span class="line">&#125; from &apos;../constants/actionTypes&apos;;</span><br><span class="line"></span><br><span class="line">export const authStart = createAction(&apos;AUTH_START&apos;, WebAPI.login);  </span><br><span class="line">export const authComplete = createAction(&apos;AUTH_COMPLETE&apos;);  </span><br><span class="line">export const authError = createAction(&apos;AUTH_ERROR&apos;);  </span><br><span class="line">export const startLogout = createAction(&apos;START_LOGOUT&apos;, WebAPI.logout);  </span><br><span class="line">export const checkAuth = createAction(&apos;CHECK_AUTH&apos;);  </span><br><span class="line">export const setUser = createAction(&apos;SET_USER&apos;);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    于 `scr/actions/index.js` 输出 actions：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`export * from &apos;./userActions&apos;;  </span><br><span class="line">export * from &apos;./recipeActions&apos;;  </span><br><span class="line">export * from &apos;./uiActions&apos;;`</span><br><span class="line"></span><br><span class="line"> ````````````````````````于 `scr/common/utils/fetchComponentData.js` 设定 server side 初始 fetchComponentData：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`// 这边使用 axios 方便进行 promises base request  </span><br><span class="line">import axios from &apos;axios&apos;;  </span><br><span class="line">// 记得附加上我们存在 cookies 的 token  </span><br><span class="line">export default function fetchComponentData(token = &apos;token&apos;) &#123;  </span><br><span class="line">const promises = [axios.get(&apos;[http://localhost:3000/api/recipes](http://localhost:3000/api/recipes)&apos;), axios.get(&apos;[http://localhost:3000/api/authenticate?token=](http://localhost:3000/api/authenticate?token=)&apos; + token)];  </span><br><span class="line">return Promise.all(promises);  </span><br><span class="line">&#125;`</span><br><span class="line"></span><br><span class="line"> ```````````````````````于 `scr/common/utils/WebAPI.js` 所有前端 API 的处理：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import axios from &apos;axios&apos;;  </span><br><span class="line">import &#123; browserHistory &#125; from &apos;react-router&apos;;  </span><br><span class="line">// 引入 uuid 当做食谱 id  </span><br><span class="line">import uuid from &apos;uuid&apos;;`</span><br><span class="line"></span><br><span class="line">``````````````````````import &#123;  </span><br><span class="line">authComplete,  </span><br><span class="line">authError,  </span><br><span class="line">hideSpinner,  </span><br><span class="line">completeLogout,  </span><br><span class="line">&#125; from &apos;../actions&apos;;</span><br><span class="line"></span><br><span class="line">// getCookie 函数传入 key 回传 value  </span><br><span class="line">function getCookie(keyName) &#123;  </span><br><span class="line">var name = keyName + &apos;=&apos;;  </span><br><span class="line">const cookies = document.cookie.split(&apos;;&apos;);  </span><br><span class="line">for(let i = 0; i &lt; cookies.length; i++) &#123;  </span><br><span class="line">let cookie = cookies[i];  </span><br><span class="line">while (cookie.charAt(0)==&apos; &apos;) &#123;  </span><br><span class="line">cookie = cookie.substring(1);  </span><br><span class="line">&#125;  </span><br><span class="line">if (cookie.indexOf(name) == 0) &#123;  </span><br><span class="line">return cookie.substring(name.length, cookie.length);  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;  </span><br><span class="line">return &quot;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default &#123;  </span><br><span class="line">// 呼叫后端登入 api  </span><br><span class="line">login: (dispatch, email, password) =&gt; &#123;  </span><br><span class="line">axios.post(&apos;/api/login&apos;, &#123;  </span><br><span class="line">email: email,  </span><br><span class="line">password: password  </span><br><span class="line">&#125;)  </span><br><span class="line">.then((response) =&gt; &#123;  </span><br><span class="line">if(response.data.success === false) &#123;  </span><br><span class="line">dispatch(authError());  </span><br><span class="line">dispatch(hideSpinner());  </span><br><span class="line">alert(&apos;发生错误，请再试一次！&apos;);  </span><br><span class="line">window.location.reload();  </span><br><span class="line">&#125; else &#123;  </span><br><span class="line">if (!document.cookie.token) &#123;  </span><br><span class="line">let d = new Date();  </span><br><span class="line">d.setTime(d.getTime() + (24 * 60 * 60 * 1000));  </span><br><span class="line">const expires = &apos;expires=&apos; + d.toUTCString();  </span><br><span class="line">document.cookie = &apos;token=&apos; + response.data.token + &apos;; &apos; + expires;  </span><br><span class="line">dispatch(authComplete());  </span><br><span class="line">dispatch(hideSpinner());  </span><br><span class="line">browserHistory.push(&apos;/&apos;);  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;)  </span><br><span class="line">.catch(function (error) &#123;  </span><br><span class="line">dispatch(authError());  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;,  </span><br><span class="line">// 呼叫后端登出 api  </span><br><span class="line">logout: (dispatch) =&gt; &#123;  </span><br><span class="line">document.cookie = &apos;token=; &apos; + &apos;expires=Thu, 01 Jan 1970 00:00:01 GMT;&apos;;  </span><br><span class="line">dispatch(hideSpinner());  </span><br><span class="line">browserHistory.push(&apos;/&apos;);  </span><br><span class="line">&#125;,  </span><br><span class="line">// 确认使用者是否登入  </span><br><span class="line">checkAuth: (dispatch, token) =&gt; &#123;  </span><br><span class="line">axios.post(&apos;/api/authenticate&apos;, &#123;  </span><br><span class="line">token: token,  </span><br><span class="line">&#125;)  </span><br><span class="line">.then((response) =&gt; &#123;  </span><br><span class="line">if(response.data.success === false) &#123;  </span><br><span class="line">dispatch(authError());  </span><br><span class="line">&#125; else &#123;  </span><br><span class="line">dispatch(authComplete());  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;)  </span><br><span class="line">.catch(function (error) &#123;  </span><br><span class="line">dispatch(authError());  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;,  </span><br><span class="line">// 取得目前所有食谱  </span><br><span class="line">getRecipes: () =&gt; &#123;  </span><br><span class="line">axios.get(&apos;/api/recipes&apos;)  </span><br><span class="line">.then((response) =&gt; &#123;  </span><br><span class="line">&#125;)  </span><br><span class="line">.catch((error) =&gt; &#123;  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;,  </span><br><span class="line">// 呼叫新增食谱 api，记得附加上我们存在 cookies 的 token  </span><br><span class="line">addRecipe: (dispatch, name, description, imagePath) =&gt; &#123;  </span><br><span class="line">const id = uuid.v4();  </span><br><span class="line">axios.post(&apos;/api/recipes?token=&apos; + getCookie(&apos;token&apos;), &#123;  </span><br><span class="line">id: id,  </span><br><span class="line">name: name,  </span><br><span class="line">description: description,  </span><br><span class="line">imagePath: imagePath,  </span><br><span class="line">&#125;)  </span><br><span class="line">.then((response) =&gt; &#123;  </span><br><span class="line">if(response.data.success === false) &#123;  </span><br><span class="line">dispatch(hideSpinner());  </span><br><span class="line">alert(&apos;发生错误，请再试一次！&apos;);  </span><br><span class="line">browserHistory.push(&apos;/share&apos;);  </span><br><span class="line">&#125; else &#123;  </span><br><span class="line">dispatch(hideSpinner());  </span><br><span class="line">window.location.reload();  </span><br><span class="line">browserHistory.push(&apos;/&apos;);  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;)  </span><br><span class="line">.catch(function (error) &#123;  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;,  </span><br><span class="line">// 呼叫更新食谱 api，记得附加上我们存在 cookies 的 token  </span><br><span class="line">updateRecipe: (dispatch, recipeId, name, description, imagePath) =&gt; &#123;  </span><br><span class="line">axios.put(&apos;/api/recipes/&apos; + recipeId + &apos;?token=&apos; + getCookie(&apos;token&apos;), &#123;  </span><br><span class="line">id: recipeId,  </span><br><span class="line">name: name,  </span><br><span class="line">description: description,  </span><br><span class="line">imagePath: imagePath,  </span><br><span class="line">&#125;)  </span><br><span class="line">.then((response) =&gt; &#123;  </span><br><span class="line">if(response.data.success === false) &#123;  </span><br><span class="line">dispatch(hideSpinner());  </span><br><span class="line">dispatch(setRecipe(&#123; key: &apos;recipeId&apos;, value: &apos;&apos; &#125;));  </span><br><span class="line">dispatch(setUi(&#123; key: &apos;isEdit&apos;, value: false &#125;));  </span><br><span class="line">alert(&apos;发生错误，请再试一次！&apos;);  </span><br><span class="line">browserHistory.push(&apos;/share&apos;);  </span><br><span class="line">&#125; else &#123;  </span><br><span class="line">dispatch(hideSpinner());  </span><br><span class="line">window.location.reload();  </span><br><span class="line">browserHistory.push(&apos;/&apos;);  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;)  </span><br><span class="line">.catch(function (error) &#123;  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;,  </span><br><span class="line">// 呼叫删除食谱 api，记得附加上我们存在 cookies 的 token  </span><br><span class="line">deleteRecipe: (dispatch, recipeId) =&gt; &#123;  </span><br><span class="line">axios.delete(&apos;/api/recipes/&apos; + recipeId + &apos;?token=&apos; + getCookie(&apos;token&apos;))  </span><br><span class="line">.then((response) =&gt; &#123;  </span><br><span class="line">if(response.data.success === false) &#123;  </span><br><span class="line">dispatch(hideSpinner());  </span><br><span class="line">alert(&apos;发生错误，请再试一次！&apos;);  </span><br><span class="line">browserHistory.push(&apos;/&apos;);  </span><br><span class="line">&#125; else &#123;  </span><br><span class="line">dispatch(hideSpinner());  </span><br><span class="line">window.location.reload();  </span><br><span class="line">browserHistory.push(&apos;/&apos;);  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;)  </span><br><span class="line">.catch(function (error) &#123;  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    接下来设定我们的 `reducers`，以下是 `src/common/reducers/data/recipeReducers.js`，`GET_RECIPES` 负责将后端 API 取得的所有食谱存放在 recipes 中：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import &#123; handleActions &#125; from &apos;redux-actions&apos;;  </span><br><span class="line">import &#123; RecipeState &#125; from &apos;../../constants/models&apos;;`</span><br><span class="line"></span><br><span class="line">`````````````````````import &#123;  </span><br><span class="line">GET_RECIPES,  </span><br><span class="line">SET_RECIPE,  </span><br><span class="line">&#125; from &apos;../../constants/actionTypes&apos;;</span><br><span class="line"></span><br><span class="line">const recipeReducers = handleActions(&#123;  </span><br><span class="line">GET_RECIPES: (state, &#123; payload &#125;) =&gt; (  </span><br><span class="line">state.set(  </span><br><span class="line">&apos;recipes&apos;,  </span><br><span class="line">payload.recipes  </span><br><span class="line">)  </span><br><span class="line">),  </span><br><span class="line">SET_RECIPE: (state, &#123; payload &#125;) =&gt; (  </span><br><span class="line">state.setIn(payload.keyPath, payload.value)  </span><br><span class="line">),  </span><br><span class="line">&#125;, RecipeState);</span><br><span class="line"></span><br><span class="line">export default recipeReducers;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `src/common/reducers/data/userReducers.js`，负责确认登入相关处理事项。注意的是由于登入是非同步执行，所以会有几个阶段的行为要做处理：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import &#123; handleActions &#125; from &apos;redux-actions&apos;;  </span><br><span class="line">import &#123; UserState &#125; from &apos;../../constants/models&apos;;`</span><br><span class="line"></span><br><span class="line">````````````````````import &#123;  </span><br><span class="line">AUTH_START,  </span><br><span class="line">AUTH_COMPLETE,  </span><br><span class="line">AUTH_ERROR,  </span><br><span class="line">LOGOUT_START,  </span><br><span class="line">SET_USER,  </span><br><span class="line">&#125; from &apos;../../constants/actionTypes&apos;;</span><br><span class="line"></span><br><span class="line">const userReducers = handleActions(&#123;  </span><br><span class="line">AUTH_START: (state) =&gt; (  </span><br><span class="line">state.merge(&#123;  </span><br><span class="line">isAuthorized: false,  </span><br><span class="line">&#125;)  </span><br><span class="line">),  </span><br><span class="line">AUTH_COMPLETE: (state) =&gt; (  </span><br><span class="line">state.merge(&#123;  </span><br><span class="line">email: &apos;&apos;,  </span><br><span class="line">password: &apos;&apos;,  </span><br><span class="line">isAuthorized: true,  </span><br><span class="line">&#125;)  </span><br><span class="line">),  </span><br><span class="line">AUTH_ERROR: (state) =&gt; (  </span><br><span class="line">state.merge(&#123;  </span><br><span class="line">username: &apos;&apos;,  </span><br><span class="line">email: &apos;&apos;,  </span><br><span class="line">password: &apos;&apos;,  </span><br><span class="line">isAuthorized: false,  </span><br><span class="line">&#125;)  </span><br><span class="line">),  </span><br><span class="line">START_LOGOUT: (state) =&gt; (  </span><br><span class="line">state.merge(&#123;  </span><br><span class="line">isAuthorized: false,  </span><br><span class="line">&#125;)  </span><br><span class="line">),  </span><br><span class="line">CHECK_AUTH: (state) =&gt; (  </span><br><span class="line">state.set(&apos;isAuthorized&apos;, true)  </span><br><span class="line">),  </span><br><span class="line">SET_USER: (state, &#123; payload &#125;) =&gt; (  </span><br><span class="line">state.set(payload.key, payload.value)  </span><br><span class="line">),  </span><br><span class="line">&#125;, UserState);</span><br><span class="line"></span><br><span class="line">export default userReducers;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `src/common/reducers/ui/uiReducers.js`，负责确认 UI State 相关处理：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import &#123; handleActions &#125; from &apos;redux-actions&apos;;  </span><br><span class="line">import &#123; UiState &#125; from &apos;../../constants/models&apos;;`</span><br><span class="line"></span><br><span class="line">```````````````````import &#123;  </span><br><span class="line">SHOW_SPINNER,  </span><br><span class="line">HIDE_SPINNER,  </span><br><span class="line">SET_UI,  </span><br><span class="line">&#125; from &apos;../../constants/actionTypes&apos;;</span><br><span class="line"></span><br><span class="line">const uiReducers = handleActions(&#123;  </span><br><span class="line">SHOW_SPINNER: (state) =&gt; (  </span><br><span class="line">state.set(  </span><br><span class="line">&apos;spinnerVisible&apos;,  </span><br><span class="line">true  </span><br><span class="line">)  </span><br><span class="line">),  </span><br><span class="line">HIDE_SPINNER: (state) =&gt; (  </span><br><span class="line">state.set(  </span><br><span class="line">&apos;spinnerVisible&apos;,  </span><br><span class="line">false  </span><br><span class="line">)  </span><br><span class="line">),  </span><br><span class="line">SET_UI: (state, &#123; payload &#125;) =&gt; (  </span><br><span class="line">state.set(payload.key, payload.value)  </span><br><span class="line">),  </span><br><span class="line">&#125;, UiState);</span><br><span class="line"></span><br><span class="line">export default uiReducers;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    最后把所有 recipes 在 `src/common/reducers/index.js` 使用 `combineReducers` 整合在一起，注意的是我们整个 App 的资料流要维持 immutable：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import &#123; combineReducers &#125; from &apos;redux-immutable&apos;;  </span><br><span class="line">import ui from &apos;./ui/uiReducers&apos;;  </span><br><span class="line">import recipe from &apos;./data/recipeReducers&apos;;  </span><br><span class="line">import user from &apos;./data/userReducers&apos;;  </span><br><span class="line">// import routes from &apos;./routes&apos;;`</span><br><span class="line"></span><br><span class="line">``````````````````const rootReducer = combineReducers(&#123;  </span><br><span class="line">ui,  </span><br><span class="line">recipe,  </span><br><span class="line">user,  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default rootReducer;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `src/common/store/configureStore.js` 处理 store 的建立，这次我们使用了 `promiseMiddleware` 的 middleware：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import &#123; createStore, applyMiddleware &#125; from &apos;redux&apos;;  </span><br><span class="line">import promiseMiddleware from &apos;redux-promise&apos;;  </span><br><span class="line">import createLogger from &apos;redux-logger&apos;;  </span><br><span class="line">import Immutable from &apos;immutable&apos;;  </span><br><span class="line">import rootReducer from &apos;../reducers&apos;;`</span><br><span class="line"></span><br><span class="line">`````````````````const initialState = Immutable.Map();</span><br><span class="line"></span><br><span class="line">export default function configureStore(preloadedState = initialState) &#123;  </span><br><span class="line">const store = createStore(  </span><br><span class="line">rootReducer,  </span><br><span class="line">preloadedState,  </span><br><span class="line">applyMiddleware(createLogger(&#123; stateTransformer: state =&gt; state.toJS() &#125;, promiseMiddleware))  </span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">return store;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    经过一连串努力，我们来到了 View 的佈建。在这个 App 中我们主要会由一个 AppBar 负责所有页面的导览，也就是每个页面都会有 AppBar 常驻在上面，然而上面的内容则会依 UI State 中的 isAuthorized 而有所不同。最后要留意的是我们使用了 React Bootstrapt 来建立 React Component。</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import &#123; LinkContainer &#125; from &apos;react-router-bootstrap&apos;;  </span><br><span class="line">import &#123; Link &#125; from &apos;react-router&apos;;  </span><br><span class="line">import &#123; Navbar, Nav, NavItem, NavDropdown, MenuItem &#125; from &apos;react-bootstrap&apos;;`</span><br><span class="line"></span><br><span class="line">````````````````const AppBar = (&#123;  </span><br><span class="line">isAuthorized,  </span><br><span class="line">onToShare,  </span><br><span class="line">onLogout,  </span><br><span class="line">&#125;) =&gt; (  </span><br><span class="line">  </span><br><span class="line">&lt;Navbar.Header&gt;  </span><br><span class="line">&lt;Navbar.Brand&gt;  </span><br><span class="line">OpenCook  </span><br><span class="line">&lt;/Navbar.Brand&gt;  </span><br><span class="line">&lt;Navbar.Toggle /&gt;  </span><br><span class="line">&lt;/Navbar.Header&gt;  </span><br><span class="line">&lt;Navbar.Collapse&gt;  </span><br><span class="line">&#123;  </span><br><span class="line">isAuthorized === false ?  </span><br><span class="line">(  </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">&lt;LinkContainer to=&#123; &#123; pathname: &apos;/login&apos; &#125;&#125;&gt;登入  </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">) :  </span><br><span class="line">(  </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">分享食谱  </span><br><span class="line">登出  </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">)  </span><br><span class="line">&#125;  </span><br><span class="line">&lt;/Navbar.Collapse&gt;  </span><br><span class="line">  </span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">export default AppBar;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `src/common/containers/AppBarContainer/AppBarContainer.js`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import &#123; connect &#125; from &apos;react-redux&apos;;  </span><br><span class="line">import AppBar from &apos;../../components/AppBar&apos;;  </span><br><span class="line">import &#123; browserHistory &#125; from &apos;react-router&apos;;`</span><br><span class="line"></span><br><span class="line">```````````````import &#123;  </span><br><span class="line">startLogout,  </span><br><span class="line">setRecipe,  </span><br><span class="line">setUi,  </span><br><span class="line">&#125; from &apos;../../actions&apos;;</span><br><span class="line"></span><br><span class="line">export default connect(  </span><br><span class="line">(state) =&gt; (&#123;  </span><br><span class="line">isAuthorized: state.getIn([&apos;user&apos;, &apos;isAuthorized&apos;]),  </span><br><span class="line">&#125;),  </span><br><span class="line">(dispatch) =&gt; (&#123;  </span><br><span class="line">onToShare: () =&gt; &#123;  </span><br><span class="line">dispatch(setRecipe(&#123; key: &apos;recipeId&apos;, value: &apos;&apos; &#125;));  </span><br><span class="line">dispatch(setUi(&#123; key: &apos;isEdit&apos;, value: false &#125;));  </span><br><span class="line">window.location.reload();  </span><br><span class="line">browserHistory.push(&apos;/share&apos;);  </span><br><span class="line">&#125;,  </span><br><span class="line">onLogout: () =&gt; (  </span><br><span class="line">dispatch(startLogout(dispatch))  </span><br><span class="line">),  </span><br><span class="line">&#125;)  </span><br><span class="line">)(AppBar);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `src/components/Main/Main.js`，透过 route 机制让 AppBarContainer 可以成为整个 App 母模版：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import AppBarContainer from &apos;../../containers/AppBarContainer&apos;;`</span><br><span class="line"></span><br><span class="line">``````````````const Main = (props) =&gt; (</span><br><span class="line"></span><br><span class="line">&#123;props.children&#125;</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">export default Main;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    在 `checkAuth` 这个 Component 中，我们使用到了 Higher Order Components 的观念。Higher Order Components 为一个函数， 接收一个 Component 后在 Class Component 的 render 中 return 回传入的 components 方式去确认使用者是否有登入，若有没登入则不能进入分享食谱页面，反之若已登入也不会再进到登入页面：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import &#123; connect &#125; from &apos;react-redux&apos;;  </span><br><span class="line">import &#123; withRouter &#125; from &apos;react-router&apos;;`</span><br><span class="line"></span><br><span class="line">`````````````// High Order Component  </span><br><span class="line">export default function requireAuthentication(Component, type) &#123;  </span><br><span class="line">class AuthenticatedComponent extends React.Component &#123;  </span><br><span class="line">componentWillMount() &#123;  </span><br><span class="line">this.checkAuth();  </span><br><span class="line">&#125;  </span><br><span class="line">componentWillReceiveProps(nextProps) &#123;  </span><br><span class="line">this.checkAuth();  </span><br><span class="line">&#125;  </span><br><span class="line">checkAuth() &#123;  </span><br><span class="line">if(type === &apos;auth&apos;) &#123;  </span><br><span class="line">if (!this.props.isAuthorized) &#123;  </span><br><span class="line">this.props.router.push(&apos;/&apos;);  </span><br><span class="line">&#125;  </span><br><span class="line">&#125; else &#123;  </span><br><span class="line">if (this.props.isAuthorized) &#123;  </span><br><span class="line">this.props.router.push(&apos;/&apos;);  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;  </span><br><span class="line">render() &#123;  </span><br><span class="line">return (  </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">&#123;  </span><br><span class="line">(type === &apos;auth&apos;) ?  </span><br><span class="line">this.props.isAuthorized === true ? &lt;Component &#123;...this.props &#125; /&gt; : null  </span><br><span class="line">: this.props.isAuthorized === false ? &lt;Component &#123;...this.props &#125; /&gt; : null  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">)  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;;  </span><br><span class="line">const mapStateToProps = (state) =&gt; (&#123;  </span><br><span class="line">isAuthorized: state.getIn([&apos;user&apos;, &apos;isAuthorized&apos;]),  </span><br><span class="line">&#125;);  </span><br><span class="line">return connect(mapStateToProps)(withRouter(AuthenticatedComponent));  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    我们将每个食谱呈现设计成 RecipeBox，以下是在 `src/common/components/HomePage/HomePage.js` 使用 map 方法去迭代我们的食谱：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import RecipeBoxContainer from &apos;../../containers/RecipeBoxContainer&apos;;`</span><br><span class="line"></span><br><span class="line">````````````const HomePage = (&#123;  </span><br><span class="line">recipes  </span><br><span class="line">&#125;) =&gt; (</span><br><span class="line"></span><br><span class="line">&#123; recipes.map((recipe, index) =&gt; ( )).toJS() &#125;</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">export default HomePage;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `src/common/containers/HomePageContainer/HomePageContainer.js`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import &#123; connect &#125; from &apos;react-redux&apos;;  </span><br><span class="line">import HomePage from &apos;../../components/HomePage&apos;;`</span><br><span class="line"></span><br><span class="line">```````````export default connect(  </span><br><span class="line">(state) =&gt; (&#123;  </span><br><span class="line">recipes: state.getIn([&apos;recipe&apos;, &apos;recipes&apos;]),  </span><br><span class="line">&#125;),  </span><br><span class="line">(dispatch) =&gt; (&#123;  </span><br><span class="line">&#125;)  </span><br><span class="line">)(HomePage);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    在 `src/common/components/LoginBox/LoginBox.js` 设计我们 LoginBox：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import &#123; Form, FormGroup, Button, FormControl, ControlLabel &#125; from &apos;react-bootstrap&apos;;`</span><br><span class="line"></span><br><span class="line">``````````const LoginBox = (&#123;  </span><br><span class="line">email,  </span><br><span class="line">password,  </span><br><span class="line">onChangeEmailInput,  </span><br><span class="line">onChangePasswordInput,  </span><br><span class="line">onLoginSubmit  </span><br><span class="line">&#125;) =&gt; (</span><br><span class="line"></span><br><span class="line">请输入您的 Email 请输入您的密码 提交送出</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">export default LoginBox;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `src/common/containers/LoginBoxContainer/LoginBoxContainer.js`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import &#123; connect &#125; from &apos;react-redux&apos;;  </span><br><span class="line">import LoginBox from &apos;../../components/LoginBox&apos;;`</span><br><span class="line"></span><br><span class="line">`````````import &#123;  </span><br><span class="line">authStart,  </span><br><span class="line">showSpinner,  </span><br><span class="line">setUser,  </span><br><span class="line">&#125; from &apos;../../actions&apos;;</span><br><span class="line"></span><br><span class="line">export default connect(  </span><br><span class="line">(state) =&gt; (&#123;  </span><br><span class="line">email: state.getIn([&apos;user&apos;, &apos;email&apos;]),  </span><br><span class="line">password: state.getIn([&apos;user&apos;, &apos;password&apos;]),  </span><br><span class="line">&#125;),  </span><br><span class="line">(dispatch) =&gt; (&#123;  </span><br><span class="line">onChangeEmailInput: (event) =&gt; (  </span><br><span class="line">dispatch(setUser(&#123; key: &apos;email&apos;, value: event.target.value &#125;))  </span><br><span class="line">),  </span><br><span class="line">onChangePasswordInput: (event) =&gt; (  </span><br><span class="line">dispatch(setUser(&#123; key: &apos;password&apos;, value: event.target.value &#125;))  </span><br><span class="line">),  </span><br><span class="line">onLoginSubmit: (email, password) =&gt; () =&gt; &#123;  </span><br><span class="line">dispatch(authStart(dispatch, email, password));  </span><br><span class="line">dispatch(showSpinner());  </span><br><span class="line">&#125;,  </span><br><span class="line">&#125;),  </span><br><span class="line">(stateProps, dispatchProps, ownProps) =&gt; &#123;  </span><br><span class="line">const &#123; email, password &#125; = stateProps;  </span><br><span class="line">const &#123; onLoginSubmit &#125; = dispatchProps;  </span><br><span class="line">return Object.assign(&#123;&#125;, stateProps, dispatchProps, ownProps, &#123;  </span><br><span class="line">onLoginSubmit: onLoginSubmit(email, password),  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;  </span><br><span class="line">)(LoginBox);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    在 `src/common/components/LoginPage/LoginPage.js`，当 spinnerVisible 为 true 会显示 spinner：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import &#123; Grid, Row, Col, Image &#125; from &apos;react-bootstrap&apos;;  </span><br><span class="line">import LoginBoxContainer from &apos;../../containers/LoginBoxContainer&apos;;`</span><br><span class="line"></span><br><span class="line">````````const LoginPage = (&#123;  </span><br><span class="line">spinnerVisible,  </span><br><span class="line">&#125;) =&gt; (</span><br><span class="line"></span><br><span class="line">&#123; spinnerVisible === true ? ![](/static/images/loading.gif) : null &#125; </span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">export default LoginPage;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `src/common/containers/LoginPageContainer/LoginPageContainer.js`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">import React from &apos;react&apos;;  </span><br><span class="line">import &#123; connect &#125; from &apos;react-redux&apos;;  </span><br><span class="line">import LoginPage from &apos;../../components/LoginPage&apos;;</span><br><span class="line"></span><br><span class="line">export default connect(  </span><br><span class="line">(state) =&gt; (&#123;  </span><br><span class="line">spinnerVisible: state.getIn([&apos;ui&apos;, &apos;spinnerVisible&apos;]),  </span><br><span class="line">&#125;),  </span><br><span class="line">(dispatch) =&gt; (&#123;  </span><br><span class="line">&#125;)  </span><br><span class="line">)(LoginPage);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    真正设计我们内部的食谱， `src/common/components/RecipeBox`，使用者登入的话可以修改和删除食谱：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import &#123; Grid, Row, Col, Image, Thumbnail, Button &#125; from &apos;react-bootstrap&apos;;`</span><br><span class="line"></span><br><span class="line">```````const RecipeBox = (props) =&gt; &#123;  </span><br><span class="line">return(  </span><br><span class="line">  </span><br><span class="line">&lt;Thumbnail src=&#123;props.recipe.get(&apos;imagePath&apos;)&#125; alt=&quot;242x200&quot;&gt;  </span><br><span class="line"></span><br><span class="line">### &#123;props.recipe.get(&apos;name&apos;)&#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">&#123;props.recipe.get(&apos;description&apos;)&#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">&#123;  </span><br><span class="line">props.isAuthorized === true ? (  </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">&lt;Button bsStyle=&quot;primary&quot; onClick=&#123;props.onDeleteRecipe(props.recipe.get(&apos;_id&apos;))&#125;&gt;删除   </span><br><span class="line">&lt;Button bsStyle=&quot;default&quot; onClick=&#123;props.onUpadateRecipe(props.recipe.get(&apos;_id&apos;))&#125;&gt;修改  </span><br><span class="line"></span><br><span class="line">)  </span><br><span class="line">: null  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">);  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default RecipeBox;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `src/common/containers/RecipeBoxContainer/RecipeBoxContainer.js`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import &#123; connect &#125; from &apos;react-redux&apos;;  </span><br><span class="line">import RecipeBox from &apos;../../components/RecipeBox&apos;;  </span><br><span class="line">import &#123; browserHistory &#125; from &apos;react-router&apos;;`</span><br><span class="line"></span><br><span class="line">``````import &#123;  </span><br><span class="line">deleteRecipe,  </span><br><span class="line">setRecipe,  </span><br><span class="line">setUi  </span><br><span class="line">&#125; from &apos;../../actions&apos;;</span><br><span class="line"></span><br><span class="line">export default connect(  </span><br><span class="line">(state) =&gt; (&#123;  </span><br><span class="line">isAuthorized: state.getIn([&apos;user&apos;, &apos;isAuthorized&apos;]),  </span><br><span class="line">recipes: state.getIn([&apos;recipe&apos;, &apos;recipes&apos;]),  </span><br><span class="line">&#125;),  </span><br><span class="line">(dispatch) =&gt; (&#123;  </span><br><span class="line">onDeleteRecipe: (recipeId) =&gt; () =&gt; (  </span><br><span class="line">dispatch(deleteRecipe(dispatch, recipeId))  </span><br><span class="line">),  </span><br><span class="line">onUpadateRecipe: (recipes) =&gt; (recipeId) =&gt; () =&gt; &#123;  </span><br><span class="line">const recipeIndex = recipes.findIndex((_recipe) =&gt; (_recipe.get(&apos;_id&apos;) === recipeId));  </span><br><span class="line">const recipe = recipeIndex !== -1 ? recipes.get(recipeIndex) : undefined;  </span><br><span class="line">dispatch(setRecipe(&#123; keyPath: [&apos;recipe&apos;], value: recipe &#125;));  </span><br><span class="line">dispatch(setRecipe(&#123; keyPath: [&apos;recipe&apos;, &apos;id&apos;], value: recipeId &#125;));  </span><br><span class="line">dispatch(setUi(&#123; key: &apos;isEdit&apos;, value: true &#125;));  </span><br><span class="line">browserHistory.push(&apos;/share?recipeId=&apos; + recipeId);  </span><br><span class="line">&#125;,  </span><br><span class="line">&#125;),  </span><br><span class="line">(stateProps, dispatchProps, ownProps) =&gt; &#123;  </span><br><span class="line">const &#123; recipes &#125; = stateProps;  </span><br><span class="line">const &#123; onUpadateRecipe &#125; = dispatchProps;  </span><br><span class="line">return Object.assign(&#123;&#125;, stateProps, dispatchProps, ownProps, &#123;  </span><br><span class="line">onUpadateRecipe: onUpadateRecipe(recipes),  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;  </span><br><span class="line">)(RecipeBox);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    设计我们分享食谱页面，这边我们把编辑食谱和新增分享一起共用了同一个 components，差别在于我们会判断 UI State 中的 `isEdit`， 决定相应处理方式。在中 `src/common/components/ShareBox/ShareBox.js`，可以让使用者登入的后修改和删除食谱：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import &#123; Form, FormGroup, Button, FormControl, ControlLabel &#125; from &apos;react-bootstrap&apos;;`</span><br><span class="line"></span><br><span class="line">`````const ShareBox = (props) =&gt; &#123;  </span><br><span class="line">return (</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">请输入食谱名称  </span><br><span class="line">  </span><br><span class="line">&lt;FormControl.Feedback /&gt;  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">请输入食谱说明  </span><br><span class="line">  </span><br><span class="line">&lt;FormControl.Feedback /&gt;  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">请输入食谱图片网址  </span><br><span class="line">  </span><br><span class="line">&lt;FormControl.Feedback /&gt;  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">提交送出  </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">); &#125;;</span><br><span class="line"></span><br><span class="line">export default ShareBox;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `src/common/containers/ShareBoxContainer/ShareBoxContainer.js`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import &#123; connect &#125; from &apos;react-redux&apos;;  </span><br><span class="line">import ShareBox from &apos;../../components/ShareBox&apos;;`</span><br><span class="line"></span><br><span class="line">````import &#123;  </span><br><span class="line">addRecipe,  </span><br><span class="line">updateRecipe,  </span><br><span class="line">showSpinner,  </span><br><span class="line">setRecipe,  </span><br><span class="line">&#125; from &apos;../../actions&apos;;</span><br><span class="line"></span><br><span class="line">export default connect(  </span><br><span class="line">(state) =&gt; (&#123;  </span><br><span class="line">recipes: state.getIn([&apos;recipe&apos;, &apos;recipes&apos;]),  </span><br><span class="line">recipeId: state.getIn([&apos;recipe&apos;, &apos;recipe&apos;, &apos;id&apos;]),  </span><br><span class="line">name: state.getIn([&apos;recipe&apos;, &apos;recipe&apos;, &apos;name&apos;]),  </span><br><span class="line">description: state.getIn([&apos;recipe&apos;, &apos;recipe&apos;, &apos;description&apos;]),  </span><br><span class="line">imagePath: state.getIn([&apos;recipe&apos;, &apos;recipe&apos;, &apos;imagePath&apos;]),  </span><br><span class="line">isEdit: state.getIn([&apos;ui&apos;, &apos;isEdit&apos;]),  </span><br><span class="line">&#125;),  </span><br><span class="line">(dispatch) =&gt; (&#123;  </span><br><span class="line">onChangeNameInput: (event) =&gt; (  </span><br><span class="line">dispatch(setRecipe(&#123; keyPath: [&apos;recipe&apos;, &apos;name&apos;], value: event.target.value &#125;))  </span><br><span class="line">),  </span><br><span class="line">onChangeDescriptionInput: (event) =&gt; (  </span><br><span class="line">dispatch(setRecipe(&#123; keyPath: [&apos;recipe&apos;, &apos;description&apos;], value: event.target.value &#125;))  </span><br><span class="line">),  </span><br><span class="line">onChangeImageUrl: (event) =&gt; (  </span><br><span class="line">dispatch(setRecipe(&#123; keyPath: [&apos;recipe&apos;, &apos;imagePath&apos;], value: event.target.value &#125;))  </span><br><span class="line">),  </span><br><span class="line">onRecipeSubmit: (recipes, recipeId, name, description, imagePath, isEdit) =&gt; () =&gt; &#123;  </span><br><span class="line">if (isEdit === true) &#123;  </span><br><span class="line">dispatch(updateRecipe(dispatch, recipeId, name, description, imagePath));  </span><br><span class="line">dispatch(showSpinner());  </span><br><span class="line">&#125; else &#123;  </span><br><span class="line">dispatch(addRecipe(dispatch, name, description, imagePath));  </span><br><span class="line">dispatch(showSpinner());  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;,  </span><br><span class="line">&#125;),  </span><br><span class="line">(stateProps, dispatchProps, ownProps) =&gt; &#123;  </span><br><span class="line">const &#123; recipes, recipeId, name, description, imagePath, isEdit &#125; = stateProps;  </span><br><span class="line">const &#123; onRecipeSubmit &#125; = dispatchProps;  </span><br><span class="line">return Object.assign(&#123;&#125;, stateProps, dispatchProps, ownProps, &#123;  </span><br><span class="line">onRecipeSubmit: onRecipeSubmit(recipes, recipeId, name, description, imagePath, isEdit),  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;  </span><br><span class="line">)(ShareBox);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    单纯的 SharePage（`src/common/components/SharePage/SharePage.js`）页面：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import &#123; Grid, Row, Col &#125; from &apos;react-bootstrap&apos;;  </span><br><span class="line">import ShareBoxContainer from &apos;../../containers/ShareBoxContainer&apos;;`</span><br><span class="line"></span><br><span class="line">```const SharePage = () =&gt; (</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">export default SharePage;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `src/common/containers/SharePageContainer/SharePageContainer.js`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import &#123; connect &#125; from &apos;react-redux&apos;;  </span><br><span class="line">import SharePage from &apos;../../components/SharePage&apos;;`</span><br><span class="line"></span><br><span class="line">``export default connect(  </span><br><span class="line">(state) =&gt; (&#123;  </span><br><span class="line">&#125;),  </span><br><span class="line">(dispatch) =&gt; (&#123;  </span><br><span class="line">&#125;)  </span><br><span class="line">)(SharePage);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    恭喜你成功抵达终点！若一切顺利，在终端机打上 `$ npm start`，你将可以在浏览器的 `http://localhost:3000` 看到自己的成果！</span><br><span class="line">    </span><br><span class="line">    ![用 React + Redux + Node（Isomorphic）开发一个食谱分享网站](https://res.i95.me/wp-content/uploads/2016/09/open-cook-demo-1.png &quot;用 React + Redux + Node（Isomorphic）开发一个食谱分享网站&quot;)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    ## 总结</span><br><span class="line">    </span><br><span class="line">    本章整合过去所学和添加一些后端资料库知识开发了一个可以登入会员并分享食谱的社群网站！快把你的成果和你的朋友分享吧！觉得意犹未尽？别忘了附录也很精采！最后，再次谢谢读者们支持我们一路走完了 React 开发学习之旅！然而前端技术变化很快，唯有不断自我学习才能持续成长。笔者才疏学浅，撰写学习心得或有疏漏，若有任何建议或提醒都欢迎和我说，大家一起加油：）</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    ## 延伸阅读</span><br><span class="line">    </span><br><span class="line">    1. [joshgeller/react-redux-jwt-auth-example](https://github.com/joshgeller/react-redux-jwt-auth-example)</span><br><span class="line">    2. [Securing React Redux Apps With JWT Tokens](https://medium.com/@rajaraodv/securing-react-redux-apps-with-jwt-tokens-fcfe81356ea0#.5hfri5j5m)</span><br><span class="line">    3. [Adding Authentication to Your React Native App Using JSON Web Tokens](https://auth0.com/blog/adding-authentication-to-react-native-using-jwt/)</span><br><span class="line">    4. [Authentication in React Applications, Part 2: JSON Web Token (JWT)](http://vladimirponomarev.com/blog/authentication-in-react-apps-jwt)</span><br><span class="line">    5. [Node.js 身份认证：Passport 入门](https://nodejust.com/nodejs-passport-auth-tutorial/)</span><br><span class="line">    6. [react-bootstrap compatibility #83](https://github.com/reactjs/react-router/issues/83)</span><br><span class="line">    7. [How to authenticate routes using Passport? #725](https://github.com/reactjs/react-router/issues/725)</span><br><span class="line">    8. [Isomorphic React Web App Demo with Material UI](https://github.com/tech-dojo/react-showcase)</span><br><span class="line">    9. [react-router/examples/auth-flow/](https://github.com/reactjs/react-router/tree/master/examples/auth-flow)</span><br><span class="line">    10. [redux-promise](https://github.com/acdlite/redux-promise)</span><br><span class="line">    11. [How to use redux-promise](http://qiita.com/takaki@github/items/42bddf01d36dc18bdc8e)</span><br><span class="line">    12. [Authenticate a Node.js API with JSON Web Tokens](https://scotch.io/tutorials/authenticate-a-node-js-api-with-json-web-tokens)</span><br><span class="line">    13. [3 JavaScript ORMs You Might Not Know](https://www.sitepoint.com/3-javascript-orms-you-might-not-know/)</span><br><span class="line">    14. [lynndylanhurley/redux-auth](https://github.com/lynndylanhurley/redux-auth)</span><br><span class="line">    15. [How to avoid getting error ‘localStorage is not defined’ on server in ReactJS isomorphic app?](http://stackoverflow.com/questions/33724396/how-to-avoid-getting-error-localstorage-is-not-defined-on-server-in-reactjs-is)</span><br><span class="line">    16. [Where to Store your JWTs – Cookies vs HTML5 Web Storage](https://stormpath.com/blog/where-to-store-your-jwts-cookies-vs-html5-web-storage)</span><br><span class="line">    17. [What is the difference between server side cookie and client side cookie? [closed]](http://stackoverflow.com/questions/6922145/what-is-the-difference-between-server-side-cookie-and-client-side-cookie)</span><br><span class="line">    18. [Cookies vs Tokens. Getting auth right with Angular.JS](https://auth0.com/blog/angularjs-authentication-with-cookies-vs-token/)</span><br><span class="line">    19. [Cookies vs Tokens: The Definitive Guide](https://auth0.com/blog/cookies-vs-tokens-definitive-guide/)</span><br><span class="line">    20. [joshgeller/react-redux-jwt-auth-example](https://github.com/joshgeller/react-redux-jwt-auth-example)</span><br><span class="line">    21. [Programmatically navigate using react router](http://stackoverflow.com/questions/31079081/programmatically-navigate-using-react-router)</span><br><span class="line">    22. [withRouter HoC (higher-order component) v2.4.0 Upgrade Guide](https://github.com/reactjs/react-router/blob/master/upgrade-guides/v2.4.0.md)`` ``` ```` ````` `````` ``````` ```````` ````````` `````````` ``````````` ```````````` ````````````` `````````````` ``````````````` ```````````````` ````````````````` `````````````````` ``````````````````` ```````````````````` ````````````````````` `````````````````````` ``````````````````````` ```````````````````````` ````````````````````````` `````````````````````````` ``````````````````````````` ```````````````````````````` ````````````````````````````` `````````````````````````````` ``````````````````````````````` ```````````````````````````````` ````````````````````````````````` `````````````````````````````````` ``````````````````````````````````` ```````````````````````````````````` ````````````````````````````````````` `````````````````````````````````````` ``````````````````````````````````````` `````````````````````````````````````</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>R09-用 React + Router + Redux + ImmutableJS 写一个 Github 查询应用</title>
      <link href="/reactjs-getting-started-9.html"/>
      <url>/reactjs-getting-started-9.html</url>
      
        <content type="html"><![CDATA[<h1 id="用-React-Router-Redux-ImmutableJS-写一个-Github-查询应用"><a href="#用-React-Router-Redux-ImmutableJS-写一个-Github-查询应用" class="headerlink" title="用 React + Router + Redux + ImmutableJS 写一个 Github 查询应用"></a>用 React + Router + Redux + ImmutableJS 写一个 Github 查询应用</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>学了一身本领后，本章将带大家完成一个单页式应用程式（Single Page Application），整合 React + Redux + ImmutableJS + React Router 搭配 Github API 製作一个简单的 Github 使用者查询应用，实际体验一下开发 React App 的感受。</p><h2 id="功能规划"><a href="#功能规划" class="headerlink" title="功能规划"></a>功能规划</h2><p>让访客可以使用 Github ID 搜寻 Github 使用者，展示 Github 使用者名称、follower、following、avatar_url 并可以返回首页。</p><h2 id="使用技术"><a href="#使用技术" class="headerlink" title="使用技术"></a>使用技术</h2><ol><li>React</li><li>Redux</li><li>Redux Thunk</li><li>React Router</li><li>ImmutableJS</li><li>Fetch</li><li><a href="http://www.material-ui.com/#/" target="_blank" rel="noopener">Material UI</a></li><li>Roboto Font from Google Font</li><li>Github API（<a href="https://api.github.com/users/torvalds%EF%BC%89" target="_blank" rel="noopener">https://api.github.com/users/torvalds）</a></li></ol><p>不过要注意的是 Github API 若没有使用 App key 的话可以呼叫 API 的次数会受限</p><h2 id="专案成果截图"><a href="#专案成果截图" class="headerlink" title="专案成果截图"></a>专案成果截图</h2><p><img src="https://res.i95.me/wp-content/uploads/2016/09/demo-1.png" alt="React Redux" title="React Redux"></p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/demo-2.png" alt="React Redux" title="React Redux"></p><h2 id="环境安装与设定"><a href="#环境安装与设定" class="headerlink" title="环境安装与设定"></a>环境安装与设定</h2><ol><li>安装 Node 和 NPM</li><li><p>安装所需套件</p><p>$ npm install –save react react-dom redux react-redux react-router immutable redux-immutable redux-actions whatwg-fetch redux-thunk material-ui react-tap-event-plugin</p></li></ol><pre><code>$ npm install --save-dev babel-core babel-eslint babel-loader babel-preset-es2015 babel-preset-react babel-preset-stage-1 eslint eslint-config-airbnb eslint-loader eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-react html-webpack-plugin webpack webpack-dev-server redux-logger</code></pre><p>接下来我们先设定一下开发文档。</p><ol><li><p>设定 Babel 的设定档： `.babelrc<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">    `&#123;  </span><br><span class="line">    &quot;presets&quot;: [  </span><br><span class="line">    &quot;es2015&quot;,  </span><br><span class="line">    &quot;react&quot;,  </span><br><span class="line">    ],  </span><br><span class="line">    &quot;plugins&quot;: []  </span><br><span class="line">    &#125;`</span><br><span class="line"></span><br><span class="line">``````````````````2. 设定 ESLint 的设定档和规则： `.eslintrc</span><br></pre></td></tr></table></figure></p><p> {<br>   “extends”: “airbnb”,<br>   “rules”: {</p><pre><code>&quot;react/jsx-filename-extension&quot;: [1, { &quot;extensions&quot;: [&quot;.js&quot;, &quot;.jsx&quot;] }],</code></pre><p>   },<br>   “env” :{</p><pre><code>&quot;browser&quot;: true,</code></pre><p>   }<br> }</p></li></ol><ol start="3"><li>设定 Webpack 设定档： `webpack.config.js<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br></pre></td><td class="code"><pre><span class="line">    `// 让你可以动态插入 bundle 好的 .js 档到 .index.html  </span><br><span class="line">    const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;);`</span><br><span class="line"></span><br><span class="line">`````````````````const HTMLWebpackPluginConfig = new HtmlWebpackPlugin(&#123;  </span><br><span class="line">template: `$&#123;__dirname&#125;/src/index.html`,  </span><br><span class="line">filename: &apos;index.html&apos;,  </span><br><span class="line">inject: &apos;body&apos;,  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// entry 为进入点，output 为进行完 eslint、babel loader 转译后的档案位置  </span><br><span class="line">module.exports = &#123;  </span><br><span class="line">entry: [  </span><br><span class="line">&apos;./src/index.js&apos;,  </span><br><span class="line">],  </span><br><span class="line">output: &#123;  </span><br><span class="line">path: `$&#123;__dirname&#125;/dist`,  </span><br><span class="line">filename: &apos;index_bundle.js&apos;,  </span><br><span class="line">&#125;,  </span><br><span class="line">module: &#123;  </span><br><span class="line">preLoaders: [  </span><br><span class="line">&#123;  </span><br><span class="line">test: /.jsx$|.js$/,  </span><br><span class="line">loader: &apos;eslint-loader&apos;,  </span><br><span class="line">include: `$&#123;__dirname&#125;/src`,  </span><br><span class="line">exclude: /bundle.js$/  </span><br><span class="line">&#125;  </span><br><span class="line">],  </span><br><span class="line">loaders: [&#123;  </span><br><span class="line">test: /.js$/,  </span><br><span class="line">exclude: /node_modules/,  </span><br><span class="line">loader: &apos;babel-loader&apos;,  </span><br><span class="line">query: &#123;  </span><br><span class="line">presets: [&apos;es2015&apos;, &apos;react&apos;],  </span><br><span class="line">&#125;,  </span><br><span class="line">&#125;],  </span><br><span class="line">&#125;,  </span><br><span class="line">// 启动开发测试用 server 设定（不能用在 production）  </span><br><span class="line">devServer: &#123;  </span><br><span class="line">inline: true,  </span><br><span class="line">port: 8008,  </span><br><span class="line">&#125;,  </span><br><span class="line">plugins: [HTMLWebpackPluginConfig],  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    太好了！这样我们就完成了开发环境的设定可以开始动手实作 `Github Finder` 应用程式了！</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    ## 动手实作</span><br><span class="line">    </span><br><span class="line">    1. Setup Mockup HTML Markup（`src/index.html`）：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"> ````````````````GithubFinder </span><br><span class="line"></span><br><span class="line">     &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    设定 `webpack.config.js` 的进入点 `src/index.js`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import ReactDOM from &apos;react-dom&apos;;  </span><br><span class="line">import &#123; Provider &#125; from &apos;react-redux&apos;;  </span><br><span class="line">import &#123; browserHistory, Router, Route, IndexRoute &#125; from &apos;react-router&apos;;  </span><br><span class="line">import injectTapEventPlugin from &apos;react-tap-event-plugin&apos;;  </span><br><span class="line">import MuiThemeProvider from &apos;material-ui/styles/MuiThemeProvider&apos;;  </span><br><span class="line">import Main from &apos;./components/Main&apos;;  </span><br><span class="line">import HomePageContainer from &apos;./containers/HomePageContainer&apos;;  </span><br><span class="line">import ResultPageContainer from &apos;./containers/ResultPageContainer&apos;;  </span><br><span class="line">import store from &apos;./store&apos;;`</span><br><span class="line"></span><br><span class="line">```````````````// 引入 react-tap-event-plugin 避免 material-ui onTouchTap event 会遇到的问题  </span><br><span class="line">// Needed for onTouchTap  </span><br><span class="line">// [http://stackoverflow.com/a/34015469/988941](http://stackoverflow.com/a/34015469/988941)  </span><br><span class="line">injectTapEventPlugin();</span><br><span class="line"></span><br><span class="line">// 用 react-redux 的 Provider 包起来将 store 传递下去，让每个 components 都可以存取到 state  </span><br><span class="line">// 这边使用 browserHistory 当做 history，并使用 material-ui 的 MuiThemeProvider 包裹整个 components  </span><br><span class="line">// 由于这边是简易的 App 我们设计了 Main 为母模版，其有两个子元件 HomePageContainer 和 ResultPageContainer，其中 HomePageContainer 为根位置的子元件  </span><br><span class="line">ReactDOM.render(  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">,  </span><br><span class="line">document.getElementById(&apos;app&apos;)  </span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">    2. Actions 首先先定义 actions 常数：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`export const SHOW_SPINNER = &apos;SHOW_SPINNER&apos;;  </span><br><span class="line">export const HIDE_SPINNER = &apos;HIDE_SPINNER&apos;;  </span><br><span class="line">export const GET_GITHUB_INITIATE = &apos;GET_GITHUB_INITIATE&apos;;  </span><br><span class="line">export const GET_GITHUB_SUCCESS = &apos;GET_GITHUB_SUCCESS&apos;;  </span><br><span class="line">export const GET_GITHUB_FAIL = &apos;GET_GITHUB_FAIL&apos;;  </span><br><span class="line">export const CHAGE_USER_ID = &apos;CHAGE_USER_ID&apos;;`</span><br><span class="line"></span><br><span class="line"> ``````````````现在我们来规划我们的 actions 的部份，这个范例我们使用到了 `redux-thunk` 来处理非同步的 action（若读者对于新的 Ajax 处理方式 fetch() 不熟悉可以先[参考这个文件](https://developer.mozilla.org/zh-TW/docs/Web/API/GlobalFetch/fetch)）。以下是 `src/actions/githubActions.js` 完整程式码：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`// 这边引入了 fetch 的 polyfill，考以让旧的浏览器也可以使用 fetch  </span><br><span class="line">import &apos;whatwg-fetch&apos;;  </span><br><span class="line">// 引入 actionTypes 常数  </span><br><span class="line">import &#123;  </span><br><span class="line">GET_GITHUB_INITIATE,  </span><br><span class="line">GET_GITHUB_SUCCESS,  </span><br><span class="line">GET_GITHUB_FAIL,  </span><br><span class="line">CHAGE_USER_ID,  </span><br><span class="line">&#125; from &apos;../constants/actionTypes&apos;;`</span><br><span class="line"></span><br><span class="line">`````````````// 引入 uiActions 的 action  </span><br><span class="line">import &#123;  </span><br><span class="line">showSpinner,  </span><br><span class="line">hideSpinner,  </span><br><span class="line">&#125; from &apos;./uiActions&apos;;</span><br><span class="line"></span><br><span class="line">// 这边是这个范例的重点，要学习我们之前尚未讲解的非同步 action 处理方式：不同于一般同步 action 直接发送 action，非同步 action 会回传一个带有 dispatch 参数的 function，裡面使用了 Ajax（这裡使用 fetch()）进行处理  </span><br><span class="line">// 一般和 API 互动的流程：INIT（开始请求/秀出 spinner）-&gt; COMPLETE（完成请求/隐藏 spinner）-&gt; ERROR（请求失败）  </span><br><span class="line">// 这次我们虽然没有使用 redux-actions 但我们还是维持标准 Flux Standard Action 格式：&#123; type: &apos;&apos;, payload: &#123;&#125; &#125;</span><br><span class="line"></span><br><span class="line">export const getGithub = (userId = &apos;torvalds&apos;) =&gt; &#123;  </span><br><span class="line">return (dispatch) =&gt; &#123;  </span><br><span class="line">dispatch(&#123; type: GET_GITHUB_INITIATE &#125;);  </span><br><span class="line">dispatch(showSpinner());  </span><br><span class="line">fetch(&apos;[https://api.github.com/users/](https://api.github.com/users/)&apos; + userId)  </span><br><span class="line">.then(function(response) &#123; return response.json() &#125;)  </span><br><span class="line">.then(function(json) &#123;  </span><br><span class="line">dispatch(&#123; type: GET_GITHUB_SUCCESS, payload: &#123; data: json &#125; &#125;);  </span><br><span class="line">dispatch(hideSpinner());  </span><br><span class="line">&#125;)  </span><br><span class="line">.catch(function(response) &#123; dispatch(&#123; type: GET_GITHUB_FAIL &#125;) &#125;);  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 同步 actions 处理，回传 action 物件  </span><br><span class="line">export const changeUserId = (text) =&gt; (&#123; type: CHAGE_USER_ID, payload: &#123; userId: text &#125; &#125;);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `src/actions/uiActions.js` 负责处理 UI 的行为：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import &#123; createAction &#125; from &apos;redux-actions&apos;;  </span><br><span class="line">import &#123;  </span><br><span class="line">SHOW_SPINNER,  </span><br><span class="line">HIDE_SPINNER,  </span><br><span class="line">&#125; from &apos;../constants/actionTypes&apos;;`</span><br><span class="line"></span><br><span class="line">````````````// 同步 actions 处理，回传 action 物件  </span><br><span class="line">export const showSpinner = () =&gt; (&#123; type: SHOW_SPINNER&#125;);  </span><br><span class="line">export const hideSpinner = () =&gt; (&#123; type: HIDE_SPINNER&#125;);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    透过于 `src/actions/index.js` 将我们 actions 输出</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`export * from &apos;./uiActions&apos;;  </span><br><span class="line">export * from &apos;./githubActions&apos;;`</span><br><span class="line"></span><br><span class="line">```````````3. Reducers 接下来我们要来设定一下 Reducers 和 models（initialState 格式）的设计，注意我们这个范例都是使用 `ImmutableJS`。以下是 `src/constants/models.js`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import Immutable from &apos;immutable&apos;;`</span><br><span class="line"></span><br><span class="line">``````````export const UiState = Immutable.fromJS(&#123;  </span><br><span class="line">spinnerVisible: false,  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 我们使用 userId 来暂存使用者 ID，data 存放 Ajax 取回的资料  </span><br><span class="line">export const GithubState = Immutable.fromJS(&#123;  </span><br><span class="line">userId: &apos;&apos;,  </span><br><span class="line">data: &#123;&#125;,  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `src/reducers/data/githubReducers.js`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import &#123; handleActions &#125; from &apos;redux-actions&apos;;  </span><br><span class="line">import &#123; GithubState &#125; from &apos;../../constants/models&apos;;`</span><br><span class="line"></span><br><span class="line">`````````import &#123;  </span><br><span class="line">GET_GITHUB_INITIATE,  </span><br><span class="line">GET_GITHUB_SUCCESS,  </span><br><span class="line">GET_GITHUB_FAIL,  </span><br><span class="line">CHAGE_USER_ID,  </span><br><span class="line">&#125; from &apos;../../constants/actionTypes&apos;;</span><br><span class="line"></span><br><span class="line">const githubReducers = handleActions(&#123;  </span><br><span class="line">// 当使用者按送出按钮，发出 GET_GITHUB_SUCCESS action 时将接收到的资料 merge  </span><br><span class="line">GET_GITHUB_SUCCESS: (state, &#123; payload &#125;) =&gt; (  </span><br><span class="line">state.merge(&#123;  </span><br><span class="line">data: payload.data,  </span><br><span class="line">&#125;)  </span><br><span class="line">),  </span><br><span class="line">// 当使用者输入使用者 ID 会发出 CHAGE_USER_ID action 时将接收到的资料 merge  </span><br><span class="line">CHAGE_USER_ID: (state, &#123; payload &#125;) =&gt; (  </span><br><span class="line">state.merge(&#123;  </span><br><span class="line">&apos;userId&apos;:  </span><br><span class="line">payload.userId  </span><br><span class="line">&#125;)  </span><br><span class="line">),  </span><br><span class="line">&#125;, GithubState);</span><br><span class="line"></span><br><span class="line">export default githubReducers;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `src/reducers/ui/uiReducers.js`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import &#123; handleActions &#125; from &apos;redux-actions&apos;;  </span><br><span class="line">import &#123; UiState &#125; from &apos;../../constants/models&apos;;`</span><br><span class="line"></span><br><span class="line">````````import &#123;  </span><br><span class="line">SHOW_SPINNER,  </span><br><span class="line">HIDE_SPINNER,  </span><br><span class="line">&#125; from &apos;../../constants/actionTypes&apos;;</span><br><span class="line"></span><br><span class="line">// 随著 fetch 结果显示 spinner  </span><br><span class="line">const uiReducers = handleActions(&#123;  </span><br><span class="line">SHOW_SPINNER: (state) =&gt; (  </span><br><span class="line">state.set(  </span><br><span class="line">&apos;spinnerVisible&apos;,  </span><br><span class="line">true  </span><br><span class="line">)  </span><br><span class="line">),  </span><br><span class="line">HIDE_SPINNER: (state) =&gt; (  </span><br><span class="line">state.set(  </span><br><span class="line">&apos;spinnerVisible&apos;,  </span><br><span class="line">false  </span><br><span class="line">)  </span><br><span class="line">),  </span><br><span class="line">&#125;, UiState);</span><br><span class="line"></span><br><span class="line">export default uiReducers;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    将 reduces 使用 `redux-immutable` 的 `combineReducers` 在一起。以下是 `src/reducers/index.js`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import &#123; combineReducers &#125; from &apos;redux-immutable&apos;;  </span><br><span class="line">import ui from &apos;./ui/uiReducers&apos;;// import routes from &apos;./routes&apos;;  </span><br><span class="line">import github from &apos;./data/githubReducers&apos;;// import routes from &apos;./routes&apos;;`</span><br><span class="line"></span><br><span class="line">```````const rootReducer = combineReducers(&#123;  </span><br><span class="line">ui,  </span><br><span class="line">github,  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default rootReducer;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    运用 redux 提供的 createStore API 把 `rootReducer`、`initialState`、`middlewares` 整合后创建出 store。以下是 `src/store/configureSotore.js`</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import &#123; createStore, applyMiddleware &#125; from &apos;redux&apos;;  </span><br><span class="line">import reduxThunk from &apos;redux-thunk&apos;;  </span><br><span class="line">import createLogger from &apos;redux-logger&apos;;  </span><br><span class="line">import Immutable from &apos;immutable&apos;;  </span><br><span class="line">import rootReducer from &apos;../reducers&apos;;`</span><br><span class="line"></span><br><span class="line">``````const initialState = Immutable.Map();</span><br><span class="line"></span><br><span class="line">export default createStore(  </span><br><span class="line">rootReducer,  </span><br><span class="line">initialState,  </span><br><span class="line">applyMiddleware(reduxThunk, createLogger(&#123; stateTransformer: state =&gt; state.toJS() &#125;))  </span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">    4. Build Component 终于我们进入了 View 的细节设计，首先我们先针对母模版，也就是每个页面都会出现的 `AppBar` 做设计。以下是 `src/components/Main/Main.js`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">// 引入 AppBar  </span><br><span class="line">import AppBar from &apos;material-ui/AppBar&apos;;`</span><br><span class="line"></span><br><span class="line">`````const Main = (props) =&gt; (</span><br><span class="line"></span><br><span class="line">&#123;props.children&#125;</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">// 进行 propTypes 验证  </span><br><span class="line">Main.propTypes = &#123;  </span><br><span class="line">children: React.PropTypes.object,  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default Main;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `src/components/ResultPage/ResultPage.js`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">// 使用 react-router 的 Link 当做超连结，传送 userId 当作 query  </span><br><span class="line">import &#123; Link &#125; from &apos;react-router&apos;;  </span><br><span class="line">import RaisedButton from &apos;material-ui/RaisedButton&apos;;  </span><br><span class="line">import TextField from &apos;material-ui/TextField&apos;;  </span><br><span class="line">import IconButton from &apos;material-ui/IconButton&apos;;  </span><br><span class="line">import FontIcon from &apos;material-ui/FontIcon&apos;;`</span><br><span class="line"></span><br><span class="line">````const HomePage = (&#123;  </span><br><span class="line">userId,  </span><br><span class="line">onSubmitUserId,  </span><br><span class="line">onChangeUserId,  </span><br><span class="line">&#125;) =&gt; (</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">export default HomePage;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `src/components/ResultPage/ResultPage.js`，将 `userId` 当作 `props` 传给 `&lt;GithubBox /&gt;`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    import React from &apos;react&apos;;</span><br><span class="line">    import GithubBox from &apos;../../components/GithubBox&apos;;</span><br><span class="line">    </span><br><span class="line">    const ResultPage = (props) =&gt; (</span><br><span class="line">      &lt;div&gt; </span><br><span class="line">        &lt;GithubBox data=&#123;props.data&#125; userId=&#123;props.location.query.userId&#125; /&gt;  </span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    export default ResultPage;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">以下是 `src/components/GithubBox/GithubBox.js`，负责撷取的 Github 资料呈现：</span><br><span class="line"></span><br><span class="line">    import React from &apos;react&apos;;</span><br><span class="line">    import &#123; Link &#125; from &apos;react-router&apos;;</span><br><span class="line">    // 引入 material-ui 的卡片式元件</span><br><span class="line">    import &#123; Card, CardActions, CardHeader, CardMedia, CardTitle, CardText &#125; from &apos;material-ui/Card&apos;;</span><br><span class="line">    // 引入 material-ui 的 RaisedButton</span><br><span class="line">    import RaisedButton from &apos;material-ui/RaisedButton&apos;;</span><br><span class="line">    // 引入 ActionHome icon</span><br><span class="line">    import ActionHome from &apos;material-ui/svg-icons/action/home&apos;;</span><br><span class="line">    </span><br><span class="line">    const GithubBox = (props) =&gt; (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;Card&gt;</span><br><span class="line">          &lt;CardHeader</span><br><span class="line">            title=&#123;props.data.get(&apos;name&apos;)&#125;</span><br><span class="line">            subtitle=&#123;props.userId&#125;</span><br><span class="line">            avatar=&#123;props.data.get(&apos;avatar_url&apos;)&#125;</span><br><span class="line">          /&gt;</span><br><span class="line">          &lt;CardText&gt;</span><br><span class="line">            Followers : &#123;props.data.get(&apos;followers&apos;)&#125;</span><br><span class="line">          &lt;/CardText&gt;      </span><br><span class="line">          &lt;CardText&gt;</span><br><span class="line">            Following : &#123;props.data.get(&apos;following&apos;)&#125;</span><br><span class="line">          &lt;/CardText&gt;</span><br><span class="line">          &lt;CardActions&gt;</span><br><span class="line">            &lt;Link to=&quot;/&quot;&gt;</span><br><span class="line">              &lt;RaisedButton </span><br><span class="line">                label=&quot;Back&quot; </span><br><span class="line">                icon=&#123;&lt;ActionHome /&gt;&#125;</span><br><span class="line">                secondary=&#123;true&#125; </span><br><span class="line">              /&gt;</span><br><span class="line">            &lt;/Link&gt;</span><br><span class="line">          &lt;/CardActions&gt;</span><br><span class="line">        &lt;/Card&gt; </span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    export default GithubBox;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    1. Connect State to Component 最后，我们要将 Container 和 Component 连接在一起（若忘记了，请先回去複习 Container 与 Presentational Components 入门！）。以下是 `src/containers/HomePage/HomePage.js`，负责将 userId 和使用到的事件处理方法用 props 传进 component ：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import &#123; connect &#125; from &apos;react-redux&apos;;  </span><br><span class="line">import HomePage from &apos;../../components/HomePage&apos;;`</span><br><span class="line"></span><br><span class="line">```import &#123;  </span><br><span class="line">getGithub,  </span><br><span class="line">changeUserId,  </span><br><span class="line">&#125; from &apos;../../actions&apos;;</span><br><span class="line"></span><br><span class="line">export default connect(  </span><br><span class="line">(state) =&gt; (&#123;  </span><br><span class="line">userId: state.getIn([&apos;github&apos;, &apos;userId&apos;]),  </span><br><span class="line">&#125;),  </span><br><span class="line">(dispatch) =&gt; (&#123;  </span><br><span class="line">onChangeUserId: (event) =&gt; (  </span><br><span class="line">dispatch(changeUserId(event.target.value))  </span><br><span class="line">),  </span><br><span class="line">onSubmitUserId: (userId) =&gt; () =&gt; (  </span><br><span class="line">dispatch(getGithub(userId))  </span><br><span class="line">),  </span><br><span class="line">&#125;),  </span><br><span class="line">(stateProps, dispatchProps, ownProps) =&gt; &#123;  </span><br><span class="line">const &#123; userId &#125; = stateProps;  </span><br><span class="line">const &#123; onSubmitUserId &#125; = dispatchProps;  </span><br><span class="line">return Object.assign(&#123;&#125;, stateProps, dispatchProps, ownProps, &#123;  </span><br><span class="line">onSubmitUserId: onSubmitUserId(userId),  </span><br><span class="line">&#125;);  </span><br><span class="line">&#125;  </span><br><span class="line">)(HomePage);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `src/containers/ResultPage/ResultPage.js`：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import &#123; connect &#125; from &apos;react-redux&apos;;  </span><br><span class="line">import ResultPage from &apos;../../components/ResultPage&apos;;`</span><br><span class="line"></span><br><span class="line">``export default connect(  </span><br><span class="line">(state) =&gt; (&#123;  </span><br><span class="line">data: state.getIn([&apos;github&apos;, &apos;data&apos;])  </span><br><span class="line">&#125;),  </span><br><span class="line">(dispatch) =&gt; (&#123;&#125;)  </span><br><span class="line">)(ResultPage);</span><br><span class="line"></span><br><span class="line">    2. That’s it 若一切顺利的话，这时候你可以在终端机下 `$ npm start` 指令，然后在 `http://localhost:8008` 就可以看到你的努力成果萝！</span><br><span class="line">    </span><br><span class="line">    ![React Redux](https://res.i95.me/wp-content/uploads/2016/09/demo-1.png &quot;React Redux&quot;)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    ## 总结</span><br><span class="line">    </span><br><span class="line">    本章带领读者们从零开始整合 React + Redux + ImmutableJS + React Router 搭配 Github API 製作一个简单的 Github 使用者查询应用。下一章我们将挑战进阶应用，学习 Server Side Rendering 方面的知识，并用 React + Redux + Node（Isomorphic）开发一个食谱分享网站。</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    ## 延伸阅读</span><br><span class="line">    </span><br><span class="line">    1. [Tutorial: build a weather app with React](http://joanmira.com/tutorial-build-a-weather-app-with-react/)</span><br><span class="line">    2. [OpenWeatherMap](http://openweathermap.org/)</span><br><span class="line">    3. [Weather Icons](https://erikflowers.github.io/weather-icons/)</span><br><span class="line">    4. [Weather API Icons](https://erikflowers.github.io/weather-icons/api-list.html)</span><br><span class="line">    5. [Material UI](http://www.material-ui.com/#/)</span><br><span class="line">    6. [【翻译】这个API很“迷人”——(新的Fetch API)](http://www.w3ctech.com/topic/854)</span><br><span class="line">    7. [Redux: trigger async data fetch on React view event](http://stackoverflow.com/questions/33304225/redux-trigger-async-data-fetch-on-react-view-event)</span><br><span class="line">    8. [Github API](https://api.github.com/)</span><br><span class="line">    9. [传统 Ajax 已死，Fetch 永生](https://github.com/camsong/blog/issues/2)`` ``` ```` ````` `````` ``````` ```````` ````````` `````````` ``````````` ```````````` ````````````` `````````````` ``````````````` ```````````````` ````````````````` ``````````````</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>R08-Container 与 Presentational Components 入门</title>
      <link href="/reactjs-getting-started-8.html"/>
      <url>/reactjs-getting-started-8.html</url>
      
        <content type="html"><![CDATA[<h1 id="Container-与-Presentational-Components-入门"><a href="#Container-与-Presentational-Components-入门" class="headerlink" title="Container 与 Presentational Components 入门"></a>Container 与 Presentational Components 入门</h1><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在聊完了 React 和 Redux 整合后我们来谈谈分离 Presentational 和 Container Component 的概念，若你是第一次听过这个名词，我建议你可以先看看 Redux 作者 Dan AbramovFollow 所写的这篇文章 <a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0#.vtcuxsurv" target="_blank" rel="noopener">Presentational and Container Components</a>。</p><h3 id="Container-与-Presentational-Components-超级比一比"><a href="#Container-与-Presentational-Components-超级比一比" class="headerlink" title="Container 与 Presentational Components 超级比一比"></a>Container 与 Presentational Components 超级比一比</h3><p>以下先参考 <a href="http://redux.js.org/docs/basics/UsageWithReact.html" target="_blank" rel="noopener">Redux 官网</a> 列出两者相异之处：</p><ol><li>Presentational Components - 用途：怎麽看事情（Markup、外观）</li></ol><ul><li>是否让 Redux 意识到：否</li><li>取得资料方式：从 props 取得</li><li>改变资料方式：从 props 去呼叫 callback function - 写入方式：手动处理</li></ul><ol start="2"><li>Container Components - 用途：怎麽做事情（撷取资料，更新 State）</li></ol><ul><li>是否让 Redux 意识到：是</li><li>取得资料方式：订阅 Redux State（store）</li><li>改变资料方式：Dispatch Redux Action</li><li>写入方式：从 React Redux 产生</li></ul><p>从上面的分析读者可以发现，两者最大的差别在于 <code>Component</code> 主要负责单纯的 UI 的渲染，而 <code>Container</code> 则负责和 Redux 的 store 沟通，作为 <code>Redux</code> 和 <code>Component</code> 之间的桥梁。这样的分法可以让程式架构和职责更清楚，所以接下来我们就使用上一章节的 Redux TodoApp 进行改造，改造成 Container 与 Presentational Components 模式。</p><h3 id="Container-Components"><a href="#Container-Components" class="headerlink" title="Container Components"></a>Container Components</h3><p>以下是 <code>src/containers/TodoHeaderContainer/TodoHeaderContainer.js</code> 的部份：</p><pre><code>import { connect } from &apos;react-redux&apos;;import TodoHeader from &apos;../../components/TodoHeader&apos;;// 将欲使用的 actions 引入import {  changeText,  createTodo,} from &apos;../../actions&apos;;const mapStateToProps = (state) =&gt; ({  // 从 store 取得 todo state  todo: state.getIn([&apos;todo&apos;, &apos;todo&apos;])});const mapDispatchToProps = (dispatch) =&gt; ({  // 当使用者在 input 输入资料值即会触发这个函数，发出 changeText action 并附上使用者输入内容 event.target.value  onChangeText: (event) =&gt; (    dispatch(changeText({ text: event.target.value }))  ),  // 当使用者按下送出时，发出 createTodo action 并清空 input   onCreateTodo: () =&gt; {    dispatch(createTodo());    dispatch(changeText({ text: &apos;&apos; }));  }});export default connect(  mapStateToProps,  mapDispatchToProps,)(TodoHeader);</code></pre><p>以下是 <code>src/containers/TodoListContainer/TodoListContainer.js</code> 的部份：</p><pre><code>import { connect } from &apos;react-redux&apos;;import TodoList from &apos;../../components/TodoList&apos;;import {  deleteTodo,} from &apos;../../actions&apos;;const mapStateToProps = (state) =&gt; ({  todos: state.getIn([&apos;todo&apos;, &apos;todos&apos;])});const mapDispatchToProps = (dispatch) =&gt; ({  onDeleteTodo: (index) =&gt; () =&gt; (    dispatch(deleteTodo({ index }))  )});export default connect(  mapStateToProps,  mapDispatchToProps,)(TodoList);</code></pre><h3 id="Presentational-Components"><a href="#Presentational-Components" class="headerlink" title="Presentational Components"></a>Presentational Components</h3><p>以下是 <code>src/components/TodoHeader/TodoHeader.js</code> 的部份：</p><pre><code>import React from &apos;react&apos;;import ReactDOM from &apos;react-dom&apos;;// 开始建设 Component 并使用 connect 进来的 props 并绑定事件（onChange、onClick）。注意我们的 state 因为是使用 `ImmutableJS` 所以要用 `get()` 取值const TodoHeader = ({  onChangeText,  onCreateTodo,  todo,}) =&gt; (  &lt;div&gt;    &lt;h1&gt;TodoHeader&lt;/h1&gt;    &lt;input type=&quot;text&quot; value={todo.get(&apos;text&apos;)} onChange={onChangeText} /&gt;    &lt;button onClick={onCreateTodo}&gt;送出&lt;/button&gt;  &lt;/div&gt;);export default TodoHeader;</code></pre><p>以下是 <code>src/components/TodoList/TodoList.js</code> 的部份：</p><pre><code>import React from &apos;react&apos;;import ReactDOM from &apos;react-dom&apos;;// Component 部分值的注意的是 todos state 是透过 map function 去迭代出元素，由于要让 React JSX 可以渲染并保持传入触发 event state 的 immutable，所以需使用 toJS() 转换 component of array。// 由 Component 传进欲删除元素的 indexconst TodoList = ({  todos,  onDeleteTodo,}) =&gt; (  &lt;div&gt;    &lt;ul&gt;    {      todos.map((todo, index) =&gt; (        &lt;li key={index}&gt;          {todo.get(&apos;text&apos;)}          &lt;button onClick={onDeleteTodo(index)}&gt;X&lt;/button&gt;        &lt;/li&gt;      )).toJS()    }    &lt;/ul&gt;  &lt;/div&gt;);export default TodoList;</code></pre><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>That’s it！透过区分 Container 与 Presentational Components 可以让程式架构和职责更清楚了！接下来我们将运用我们所学实际开发两个贴近生活的专案，让读者更加熟悉 React 生态系如何应用于实务上。</p><h3 id="延伸阅读"><a href="#延伸阅读" class="headerlink" title="延伸阅读"></a>延伸阅读</h3><ol><li><a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0#.vtcuxsurv" target="_blank" rel="noopener">Presentational and Container Components</a></li><li><a href="http://redux.js.org/docs/basics/UsageWithReact.html" target="_blank" rel="noopener">Redux Usage with React</a></li><li><a href="https://medium.com/@franleplant/react-higher-order-components-in-depth-cf9032ee6c3e#.r8srulpaj" target="_blank" rel="noopener">React Higher Order Components in depth</a></li><li><a href="http://www.darul.io/post/2016-01-05_react-higher-order-components" target="_blank" rel="noopener">React higher order components</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>R07-Flux/Redux 入门实战教学</title>
      <link href="/reactjs-getting-started-7.html"/>
      <url>/reactjs-getting-started-7.html</url>
      
        <content type="html"><![CDATA[<h2 id="Flux-基础概念与实战入门"><a href="#Flux-基础概念与实战入门" class="headerlink" title="Flux 基础概念与实战入门"></a>Flux 基础概念与实战入门</h2><p><img src="https://res.i95.me/wp-content/uploads/2016/09/react-flux.jpeg" alt="React Flux" title="React Flux"></p><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>随著 React App 複杂度提昇，我们会发现常常需要从 Parent Component 透过 props 传递方法到 Child Component 去改变 state tree，不但不方便也难以管理，因此我们需要更好的资料架构来建置更複杂的应用程式。<a href="https://facebook.github.io/flux/" target="_blank" rel="noopener">Flux</a> 是 Facebook 推出的 client-side 应用程式架构（Architecture），主要想解决 <code>MVC</code> 架构的一些问题。事实上，Flux 并非一个完整的前端 Framework，其特色在于实现了 Unidirectional Data Flow（单向流）的资料流设计模式，在开发複杂的大型应用程式时可以更容易地管理 state（状态）。由于 React 主要是负责 View 的部份，所以透过搭配 Flux-like 的资料处理架构，可以更好的去管理我们的 state（状态），处理複杂的使用者互动（例如：Facebook 同时要维护使用者是否按讚、点击相片，是否有新讯息等状态）。</p><p>由于原始的 Flux 架构在实现上有些部分可以精简和改善，在实务上我们通常会使用开发者社群开发的 Flux-like 相关的架构实现（例如：<a href="http://redux.js.org/index.html" target="_blank" rel="noopener">Redux</a>、<a href="http://alt.js.org/" target="_blank" rel="noopener">Alt</a>、<a href="https://github.com/reflux/refluxjs" target="_blank" rel="noopener">Reflux</a> 等）。不过这边我们主要会使用 Facebook 本身提供 <code>Dispatcher API</code> 函式库（可以想成是一个 pub/sub 处理器，透过 broadcast 将 <code>payloads</code> 传给注册的 callback function）并搭配 <code>NodeJS</code> 的 <code>EventEmitter</code> 模组去完成 Flux 架构的实现。</p><h3 id="Flux-概念介绍"><a href="#Flux-概念介绍" class="headerlink" title="Flux 概念介绍"></a>Flux 概念介绍</h3><p><img src="https://res.i95.me/wp-content/uploads/2016/09/flux-simple-diagram.png" alt="React Flux" title="React Flux"></p><p>在 Flux Unidirectional Data Flow（单项流）世界裡有四大主角，分别负责不同对应的工作：</p><ol><li>actions / Action Creator action 负责定义所有改变 state（状态）的行为，可以让开发者快速了解 App 的各种功能，若你想改变 state 你只能发 action。注意 action 可以是同步或是非同步。例如：新增代办事项，呼叫非同步 API 获取资料。</li></ol><p>实务上我们会分成 action 和 Action Creator。action 为描述行为的 object（物件），Action Creator 将 action 送给 dispatcher。一般来说符合 Flux Standard Action 的 action 会如以下范例程式码，具备 <code>type</code> 来区别所触发的行为。而 <code>payload</code> 则是所夹带的资料：</p><pre><code>// actionconst addTodo = {  type: &apos;ADD_TODO&apos;,  payload: {    text: &apos;Do something.&apos;    }}AppDispatcher.dispatch(addTodo);</code></pre><p>当发生 rejected Promise 情况：</p><pre><code>{  type: &apos;ADD_TODO&apos;,  payload: new Error(),  error: true}</code></pre><ol start="2"><li>Dispatcher <code>Dispatcher</code> 是 Flux 架构的核心，每个 App 只有一个 Dispatcher，提供 API 让 store 可以注册 <code>callback function</code>，并负责向所有 store 发送 action 事件。在本范例中我们使用 Facebook 提供的 Dispatcher API，其内建有 <code>dispatch</code> 和 <code>subscribe</code> 方法。</li><li>Stores 一个 App 通常会有多个 store 负责存放业务逻辑，根据不同业务会有不同 store，例如：TodoStore、RecipeStore。 store 负责操作和储存资料并提供 <code>view</code> 使用 <code>listener</code>（监听器），若有资料更新即会触发更新。值得注意的是 store 只提供 <code>getter API</code> 读取资料，若想改变 state 一律发送 action。</li><li>Views（Controller Views） 这部份是 <code>React</code> 负责的范畴，负责提供监听事件的 <code>callback function</code>，当事件发生时重新取得资料并重绘 <code>View</code>。</li></ol><h3 id="Flux-流程回顾"><a href="#Flux-流程回顾" class="headerlink" title="Flux 流程回顾"></a>Flux 流程回顾</h3><p><img src="https://res.i95.me/wp-content/uploads/2016/09/flux-react.png" alt="React Flux" title="React Flux"></p><p>Flux 架构前置作业：</p><ol><li>Stores 向 Dispatcher 注册 callback，当资料改变时告知 Stores</li><li>Controller Views 向 Stores 取得初始资料</li><li>Controller Views 将资料给 Views 去渲染 UI</li><li>Controller Views 向 store 注册 listener，当资料改变时告知 Controller Views</li></ol><p>Flux 与使用者互动运作流程：</p><ol><li>使用者和 App 互动，触发事件，Action Creator 发送 actions 给 Dispatcher</li><li>Dispatcher 依序将 action 传给 store 并由 action type 判断合适的处理方式</li><li>若有资料更新则会触发 Controller Views 向 store 注册的 listener 并向 store 取得更新资料</li><li>View 根据 Controller Views 的新资料重新绘製 UI</li></ol><h3 id="Flux-实战初体验"><a href="#Flux-实战初体验" class="headerlink" title="Flux 实战初体验"></a>Flux 实战初体验</h3><p>介绍完了整个 Flux 基本架构后，接下来我们就来动手实作一个简单 Flux 架构的 Todo，让使用者可以在 <code>input</code> 输入代办事项并新增。</p><p>首先，我们先完成一些开发的前置作业，先透过以下指令在根目录产生 npm 设定档 <code>package.json</code>：</p><pre><code>$ npm init</code></pre><p>安装相关套件（包含开发环境使用的套件）：</p><pre><code>$ npm install --save react react-dom flux events$ npm install --save-dev babel-core babel-eslint babel-loader babel-preset-es2015 babel-preset-react eslint eslint-config-airbnb eslint-loader eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-react html-webpack-plugin webpack webpack-dev-server</code></pre><p>安装好后我们可以设计一下我们的资料夹结构，首先我们在根目录建立 <code>src</code>，放置 <code>script</code> 的 <code>source</code> 。在 <code>components</code> 资料夹中我们会放置所有 <code>components</code>（个别元件资料夹中会用 <code>index.js</code> 输出元件，让引入元件更简洁），另外还有 <code>actions</code>、<code>constants</code>、<code>dispatcher</code>、<code>stores</code>，其馀设定档则放置于根目录下。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/folder-1.png" alt="React Flux 资料夹结构" title="React Flux 资料夹结构"></p><p>接下来我们参考上一章设定一下开发文档（<code>.babelrc</code>、<code>.eslintrc</code>、<code>webpack.config.js</code>）。这样我们就完成了开发环境的设定可以开始动手实作 <code>React Flux</code> 应用程式了！</p><p>HTML Markup：</p><pre><code>&lt;html lang=&quot;en&quot;&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;TodoFlux&lt;/title&gt;    &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</code></pre><p>以下为 <code>src/index.js</code> 完整程式码，安排了父 <code>component</code> 和在 HTML Markup 插入位置：</p><pre><code>import React from &apos;react&apos;;import ReactDOM from &apos;react-dom&apos;;import TodoHeader from &apos;./components/TodoHeader&apos;;import TodoList from &apos;./components/TodoList&apos;;class App extends React.Component {  constructor(props) {    super(props);    this.state = {};  }  render() {    return (      &lt;div&gt;        &lt;TodoHeader /&gt;        &lt;TodoList /&gt;      &lt;/div&gt;    );  }}ReactDOM.render(&lt;App /&gt;, document.getElementById(&apos;app&apos;));</code></pre><p>通常实务上我们会开一个 <code>constants</code> 资料夹存放 <code>config</code> 或是 <code>actionTypes</code> 常数。以下是 <code>src/constants/actionTypes.js</code>：</p><pre><code>export const ADD_TODO = &apos;ADD_TODO&apos;;</code></pre><p>在这个范例中我们继承了 Facebook 提供的 Dispatcher API（主要是继承了 <code>dispatch</code>、<code>register</code> 和 <code>subscribe</code> 的方法），打造自己的 DispatcherClass，当使用者触发 <code>handleAction()</code> 会 <code>dispatch</code> 出事件。以下是 <code>src/dispatch/AppDispatcher.js</code>：</p><pre><code>// Todo app dispatcher with actions responding to both// view and server actionsimport { Dispatcher } from &apos;flux&apos;;class DispatcherClass extends Dispatcher {  handleAction(action) {    this.dispatch({      type: action.type,      payload: action.payload,    });  }}const AppDispatcher = new DispatcherClass();export default AppDispatcher;</code></pre><p>以下是我们利用 <code>AppDispatcher</code> 打造的 <code>Action Creator</code> 由 <code>handleAction</code> 负责发出传入的 <code>action</code> ，完整程式码如 <code>src/actions/todoActions.js</code>：</p><pre><code>import AppDispatcher from &apos;../dispatcher/AppDispatcher&apos;;import { ADD_TODO } from &apos;../constants/actionTypes&apos;;export const TodoActions = {  addTodo(text) {    AppDispatcher.handleAction({      type: ADD_TODO,      payload: {        text,      },    });  },};</code></pre><p><code>Store</code> 主要是负责资料以及业务逻辑处理，我们继承了 <code>events</code> 模组的 <code>EventEmitter</code>，当 <code>action</code> 传入 <code>AppDispatcher.register</code> 的处理范围后，根据 <code>action type</code> 选择适合处理的 <code>store</code> 进行处理，处理完后透过 <code>emit</code> 方法发出事件让监听的 <code>Views Controller</code> 知道。以下是 <code>src/stores/TodoStore.js</code>：</p><pre><code>import AppDispatcher from &apos;../dispatcher/AppDispatcher&apos;;import { ADD_TODO } from &apos;../constants/actionTypes&apos;;import { EventEmitter } from &apos;events&apos;;const store = {  todos: [],  editing: false,};class TodoStoreClass extends EventEmitter {  addChangeListener(callback) {    this.on(ADD_TODO, callback);  }  removeChangeListener(callback) {    this.removeListener(ADD_TODO, callback);  }  getTodos() {    return store.todos;  }}const TodoStore = new TodoStoreClass();AppDispatcher.register((action) =&gt; {  switch (action.type) {    case ADD_TODO:      store.todos.push(action.payload.text);      TodoStore.emit(ADD_TODO);      break;    default:      return true;  }  return true;});export default TodoStore;</code></pre><p>在这个 React Flux 范例中我们把 <code>View</code> 和 <code>Views Controller</code> 整合在一起。在 <code>TodoHeader</code> 中，我们主要任务是让使用者可以透过 <code>input</code> 新增代办事项。使用者输入文字在 <code>input</code> 时会触发 <code>onChange</code> 事件，进而更新内部的 <code>state</code>，当使用者按了送出钮就会触发 <code>onAdd</code> 事件，<code>dispatch</code> 出 <code>addTodo event</code>。以下是 <code>src/components/TodoHeader.js</code> 完整范例：</p><pre><code>import React, { Component } from &apos;react&apos;;import { TodoActions } from &apos;../../actions/todoActions&apos;;class TodoHeader extends Component {  constructor(props) {    super(props);    this.onChange = this.onChange.bind(this);    this.onAdd = this.onAdd.bind(this);    this.state = {      text: &apos;&apos;,      editing: false,    };  }  onChange(event) {    this.setState({      text: event.target.value,    });  }  onAdd() {    TodoActions.addTodo(this.state.text);    this.setState({      text: &apos;&apos;,    });  }  render() {    return (      &lt;div&gt;        &lt;h1&gt;TodoFlux&lt;/h1&gt;        &lt;div&gt;          &lt;input            value={this.state.text}            type=&quot;text&quot;            placeholder=&quot;请输入代办事项&quot;            onChange={this.onChange}          /&gt;          &lt;button            onClick={this.onAdd}          &gt;            送出          &lt;/button&gt;        &lt;/div&gt;      &lt;/div&gt;    );  }}export default TodoHeader;</code></pre><p>在上面的 Component 中我们让使用者可以新增代办事项，接下来我们要让新增的代办事项可以显示。我们在 <code>componentDidMount</code> 设了一个监听器 <code>TodoStore</code> 资料改变时会去把资料重新再更新，这样当使用者新增代办事项时 <code>TodoList</code> 就会保持同步。当以下是 <code>src/components/TodoList.js</code> 完整程式码：</p><pre><code>import React, { Component } from &apos;react&apos;;import TodoStore from &apos;../../stores/TodoStore&apos;;function getAppState() {  return {    todos: TodoStore.getTodos(),  };}class TodoList extends Component {  constructor(props) {    super(props);    this.onChange = this.onChange.bind(this);    this.state = {      todos: [],    };  }  componentDidMount() {    TodoStore.addChangeListener(this.onChange);  }  onChange() {    this.setState(getAppState());  }  render() {    return (      &lt;div&gt;        &lt;ul&gt;          {            this.state.todos.map((todo, key) =&gt; (              &lt;li key={key}&gt;{todo}&lt;/li&gt;            ))          }        &lt;/ul&gt;      &lt;/div&gt;    );  }}export default TodoList;</code></pre><p>若读者都有跟著上面的步骤走完的话，最后我们在终端机的根目录位置执行 <code>npm start</code> 就可以看到整个成果萝，YA！ <img src="https://res.i95.me/wp-content/uploads/2016/09/flux-demo.png" alt="React Flux " title="React Flux "></p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>Flux 优势：</p><ol><li>让开发者可以快速了解整个 App 中的行为</li><li>资料和业务逻辑统一存放好管理</li><li>让 View 单纯化只负责 UI 的排版不需负责 state 管理</li><li>清楚的架构和分工对于複杂中大型应用程式易于维护和管理程式码</li></ol><p>Flux 劣势：</p><ol><li>程式码上不够简洁</li><li>对于简单小应用来说稍微複杂</li></ol><p>以上就是 Flux 的实战入门，我知道一开始接触 Flux 的读者一定会觉得很抽象，有些读者甚至会觉得这个架构到底有什麽好处（明明感觉没比 MVC 高明到哪去或是一点都不简洁），但如同上述优点所说 Flux 设计模式的优势在于清楚的架构和分工对于複杂中大型应用程式易于维护和管理程式码。若还是不熟悉的读者可以跟著范例多动手，相信慢慢就可以体会 Flux 的特色。事实上，在开发社群中为了让 Flux 架构更加简洁，产生了许多 Flux-like 的架构和函式库，接下来将带读者们进入目前最热门的架构：<code>Redux</code>。</p><h2 id="延伸阅读"><a href="#延伸阅读" class="headerlink" title="延伸阅读"></a>延伸阅读</h2><ol><li><a href="https://scotch.io/tutorials/getting-to-know-flux-the-react-js-architecture" target="_blank" rel="noopener">Getting To Know Flux, the React.js Architecture</a></li><li><a href="https://facebook.github.io/flux/" target="_blank" rel="noopener">Flux 官方网站</a></li><li><a href="http://blog.techbridge.cc/2016/04/29/introduce-flux-from-flux-and-mvc/" target="_blank" rel="noopener">从 Flux 与 MVC 的差异来简介 Flux</a></li><li><a href="https://medium.com/@softwarecf/flux-stores-and-es6-9b453dbf9db#.uuf1ddj8u" target="_blank" rel="noopener">Flux Stores and ES6</a></li><li><a href="https://medium.com/front-end-developers/react-and-flux-migrating-to-es6-with-babel-and-eslint-6390cf4fd878#.vafamphwy" target="_blank" rel="noopener">React and Flux: Migrating to ES6 with Babel and ESLint</a></li><li><a href="https://shellmonger.com/2015/08/17/building-an-es6jsxreact-flux-app-part-2-the-flux/" target="_blank" rel="noopener">Building an ES6/JSX/React Flux App – Part 2 – The Flux</a></li><li><a href="https://github.com/reactjs/redux/issues/1287" target="_blank" rel="noopener">Question: How to choose between Redux’s store and React’s state? #1287</a></li><li><a href="https://github.com/acdlite/flux-standard-action" target="_blank" rel="noopener">acdlite/flux-standard-action</a></li></ol><hr><h1 id="Redux-基础概念"><a href="#Redux-基础概念" class="headerlink" title="Redux 基础概念"></a>Redux 基础概念</h1><p><img src="https://res.i95.me/wp-content/uploads/2016/09/redux-logo.png" alt="React Redux" title="React Redux"></p><h2 id="前言-1"><a href="#前言-1" class="headerlink" title="前言"></a>前言</h2><p>前面一个章节我们讲解了 Flux 的功能和用法，但在实务上许多开发者较偏好的是同为 Flux-like 但较为简洁且文件丰富清楚的 <a href="http://redux.js.org/index.html" target="_blank" rel="noopener">Redux</a> 当作状态资料管理的架构。Redux 是由 Dan Abramov 所发起的一个开源的 library，其主要功能如官方首页写著：<code>Redux is a predictable state container for JavaScript apps.</code>，亦即 Redux 希望能提供一个可以预测的 state 管理容器，让开发者可以可以更容易开发複杂的 JavaScript 应用程式（注意 Redux 和 React 并无相依性，只是和 React 可以有很好的整合）。</p><h2 id="Flux-Redux-超级比一比"><a href="#Flux-Redux-超级比一比" class="headerlink" title="Flux/Redux 超级比一比"></a>Flux/Redux 超级比一比</h2><p>从简单 Flux/Redux 比较图可以看出两者之间有些差异：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/using-redux-compare.jpg" alt="React Redux" title="React Redux"></p><p>在开始实作 Redux App 之前我们先来了解一下 Redux 和 Flux 的一些差异：</p><ol><li><p>只使用一个 store 将整个应用程式的状态 (state) 用物件树 (object tree) 的方式储存起来： 原生的 Flux 会有许多分散的 store 储存各个不同的状态，但在 redux 中，只会有唯一一个 store 将所有的资料用物件的方式包起来。</p><p> //原生 Flux 的 store<br> const userStore = {</p><pre><code>name: &apos;&apos;</code></pre><p> }<br> const todoStore = {</p><pre><code>text: &apos;&apos;</code></pre><p> }</p><p> // Redux 的单一 store<br> const state = {</p><pre><code>userState: {    name: &apos;&apos;},todoState: {    text: &apos;&apos;}</code></pre><p> }</p></li></ol><ol start="2"><li>唯一可以改变 state 的方法就是发送 action，这部份和 Flux 类似，但 Redux 并没有像 Flux 设计有 Dispatcher。Redux 的 action 和 Flux 的 action 都是一个包含 <code>type</code> 和 <code>payload</code> 的物件。</li><li>Redux 拥有 Flux 所没有的 Reducer。Reducer 根据 action 的 type 去执行对应的 state 做变化的函式叫做 Reducer。你可以使用 switch 或是使用函式 mapping 的方式去对应处理的方式。</li><li>Redux 拥有许多方便好用的辅助测试工具（例如：<a href="https://github.com/gaearon/redux-devtools" target="_blank" rel="noopener">redux-devtools</a>、<a href="https://github.com/gaearon/react-transform-boilerplate" target="_blank" rel="noopener">react-transform-boilerplate</a>），方便测试和使用 <code>Hot Module Reload</code>。</li></ol><h3 id="Redux-核心概念介绍"><a href="#Redux-核心概念介绍" class="headerlink" title="Redux 核心概念介绍"></a>Redux 核心概念介绍</h3><p><img src="https://res.i95.me/wp-content/uploads/2016/09/redux-flowchart.png" alt="React Redux" title="React Redux"></p><p>从上述的图中我们可以看到 Redux 资料流的模型大致上可以简化成： <code>View -&gt; Action -&gt; (Middleware) -&gt; Reducer</code>。当使用者和 View 互动时会触发事件发出 Action，若有使用 Middleware 的话会在进入 Reducer 进行一些处理，当 Action 进到 Reducer 时，Reducer 会根据，action type 去 mapping 对应处理的动作，然后回传回新的 state。View 则因为侦测到 state 更新而重绘页面。在这个章节我们讨论的是 synchronous（同步）的情形，asynchronous（非同步）的状况会在接下来的章节进行讨论。以下就用官方网站上的简单范例来让大家感受一下 Redux 的整个使用流程：</p><pre><code>import { createStore } from &apos;redux&apos;;/**   下面是一个简单的 reducers ，主要功能是针对传进来的 action type 判断并回传新的 state  reducer 规格：(state, action) =&gt; newState   一般而言 state 可以是 primitive、array 或 object 甚至是 ImmutableJS Data。但要留意的是不能修改到原来的 state ，  回传的是新的 state。由于使用在 Redux 中使用 ImmutableJS 有许多好处，所以我们的范例 App 也会使用 ImmutableJS */function counter(state = 0, action) {  switch (action.type) {  case &apos;INCREMENT&apos;:    return state + 1;  case &apos;DECREMENT&apos;:    return state - 1;  default:    return state;  }}// 创建 Redux store 去存放 App 的所有 state// store 的可用 API { subscribe, dispatch, getState } let store = createStore(counter);// 可以使用 subscribe() 来订阅 state 是否更新。但实务通常会使用 react-redux 来串连 React 和 Reduxstore.subscribe(() =&gt;  console.log(store.getState()););// 若想改变 state ，一律发 actionstore.dispatch({ type: &apos;INCREMENT&apos; });// 1store.dispatch({ type: &apos;INCREMENT&apos; });// 2store.dispatch({ type: &apos;DECREMENT&apos; });// 1</code></pre><h3 id="Redux-API-入门"><a href="#Redux-API-入门" class="headerlink" title="Redux API 入门"></a>Redux API 入门</h3><ol><li>createStore：<code>createStore(reducer, [preloadedState], [enhancer])</code>我们知道在 Redux 中只会有一个 store。在产生 store 时我们会使用 <code>createStore</code> 这个 API 来创建 store。第一个参数放入我们的 <code>reducer</code> 或是有多个 <code>reducers</code> combine（使用 <code>combineReducers</code>）在一起的 <code>rootRuducers</code>。第二个参数我们会放入希望预先载入的 <code>state</code> 例如：user session 等。第三个参数通常会放入我们想要使用用来增强 Redux 功能的 <code>middlewares</code>，若有多个 <code>middlewares</code> 的话，通常会使用 <code>applyMiddleware</code> 来整合。</li><li>Store 属于 Store 的四个方法：</li></ol><ul><li>getState()</li><li>dispatch(action)</li><li>subscribe(listener)</li><li>replaceReducer(nextReducer) 关于 Store 重点是要知道 Redux 只有一个 Sotre 负责存放整个 App 的 State，而唯一能改变 State 的方法只有发送 action。</li></ul><ol start="3"><li>combineReducers：<code>combineReducers(reducers)</code>combineReducers 可以将多个 reducers 进行整合并回传一个 Function，让我们可以将 reducer 适度分割</li><li>applyMiddleware：<code>applyMiddleware(...middlewares)</code>官方针对 Middleware 进行说明</li></ol><blockquote><p>It provides a third-party extension point between dispatching an action, and the moment it reaches the reducer.</p></blockquote><p>若有 NodeJS 的经验的读者，对于 middleware 概念应该不陌生，让开发者可以在 req 和 res 之间进行一些操作。在 Redux 中 Middleware 则是扮演 action 到达 reducer 前的第三方扩充。而 applyMiddleware 可以将多个 <code>middlewares</code> 整合并回传一个 Function，便于使用。</p><p>若是你要使用 asynchronous（非同步）的行为的话需要使用其中一种 middleware： <a href="https://github.com/gaearon/redux-thunk" target="_blank" rel="noopener">redux-thunk</a>、<a href="https://github.com/acdlite/redux-promise" target="_blank" rel="noopener">redux-promise</a> 或 <a href="https://github.com/pburtchaell/redux-promise-middleware" target="_blank" rel="noopener">redux-promise-middleware</a> ，这样可以让你在 actions 中 dispatch Promises 而非 function。asynchronous（非同步）运作方式就如同下图所示：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/react-redux-diagram.png" alt="React Redux" title="React Redux"><br>5. bindActionCreators：<code>bindActionCreators(actionCreators, dispatch)</code>bindActionCreators 可以将 <code>actionCreators</code> 和 <code>dispatch</code> 绑定，并回传一个 Function 或 Object，让程式更简洁。但若是使用 react-redux 可以用 <code>connect</code> 让 dispatch 行为更容易管理<br>6. compose：<code>compose(...functions)</code>compose 可以将 function 由右到左合併并回传一个 Function，如官网范例所示：</p><pre><code>import { createStore, combineReducers, applyMiddleware, compose } from &apos;redux&apos;import thunk from &apos;redux-thunk&apos;import DevTools from &apos;./containers/DevTools&apos;import reducer from &apos;../reducers/index&apos;const store = createStore(  reducer,  compose(    applyMiddleware(thunk),    DevTools.instrument()  ))</code></pre><h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><p>以上介绍了 Redux 的基础概念，若是读者觉得还是有点抽象的话也没关系，在下一个章节我们将实际带大家开发一个整合 <code>React</code>、<code>Redux</code> 和 <code>ImmutableJS</code> 的 TodoApp。</p><h3 id="延伸阅读-1"><a href="#延伸阅读-1" class="headerlink" title="延伸阅读"></a>延伸阅读</h3><ol><li><a href="http://redux.js.org/index.html" target="_blank" rel="noopener">Redux 官方网站</a></li><li><a href="http://react-china.org/t/redux-single-source-of-truth/5564" target="_blank" rel="noopener">Redux架构实践——Single Source of Truth</a></li><li><a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0" target="_blank" rel="noopener">Presentational and Container Components</a></li><li><a href="https://github.com/matthew-sun/blog/issues/18" target="_blank" rel="noopener">使用Redux管理你的React应用</a></li><li><a href="http://www.slideshare.net/JonasOhlsson/using-redux" target="_blank" rel="noopener">Using redux</a></li></ol><hr><h1 id="Redux-实战入门"><a href="#Redux-实战入门" class="headerlink" title="Redux 实战入门"></a>Redux 实战入门</h1><h3 id="前言-2"><a href="#前言-2" class="headerlink" title="前言"></a>前言</h3><p>上一节我们了解了 Redux 基本的概念和特性后，本章我们要实际动手用 Redux、React Redux 结合 ImmutableJS 开发一个简单的 Todo 应用。话不多说，那就让让我们开始吧！</p><p>以下这张图表示了整个 React Redux App 的资料流程图（使用者与 View 互动 =&gt; dispatch 出 Action =&gt; Reducers 依据 action tyoe 分配到对应处理方式，回传新的 state =&gt; 透过 React Redux 传送给 React，React 重新绘製 View）：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/redux-flow.png" alt="React Redux" title="React Redux"></p><h3 id="动手创作-React-Redux-ImmutableJS-TodoApp"><a href="#动手创作-React-Redux-ImmutableJS-TodoApp" class="headerlink" title="动手创作 React Redux ImmutableJS TodoApp"></a>动手创作 React Redux ImmutableJS TodoApp</h3><p>在开始创作之前我们先完成一些开发的前置作业，先透过以下指令在根目录产生 npm 设定档 <code>package.json</code>：</p><pre><code>$ npm init</code></pre><p>安装相关套件（包含开发环境使用的套件）：</p><pre><code>$ npm install --save react react-dom redux react-redux immutable redux-actions redux-immutable$ npm install --save-dev babel-core babel-eslint babel-loader babel-preset-es2015 babel-preset-react eslint eslint-config-airbnb eslint-loader eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-react html-webpack-plugin webpack webpack-dev-server</code></pre><p>安装好后我们可以设计一下我们的资料夹结构，首先我们在根目录建立 <code>src</code>，放置 <code>script</code> 的 <code>source</code> 。在 <code>components</code> 资料夹中我们会放置所有 <code>components</code>（个别元件资料夹中会用 <code>index.js</code> 输出元件，让引入元件更简洁）、<code>containers</code>（负责和 store 互动取得 state），另外还有 <code>actions</code>、<code>constants</code>、<code>reducers</code>、<code>store</code>，其馀设定档则放置于根目录下。</p><p>大致上的资料夹结构会长这样：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/redux-folder.png" alt="React Redux" title="React Redux"></p><p>接下来我们参考上一章设定一下开发文档（<code>.babelrc</code>、<code>.eslintrc</code>、<code>webpack.config.js</code>）。这样我们就完成了开发环境的设定可以开始动手实作 <code>React Redux</code> 应用程式了！</p><p>首先我们先用 Component 之眼感受一下我们应用程式，将它切成一个个 <code>Component</code>。在这边我们设计一个主要的 <code>Main</code> 包含两个子 Component：<code>TodoHeader</code>、<code>TodoList</code>。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/react-redux-demo.png" alt="React Redux" title="React Redux"></p><p>首先设计 HTML Markup：</p><pre><code>&lt;html lang=&quot;en&quot;&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;Redux Todo&lt;/title&gt;    &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</code></pre><p>在撰写 <code>src/index.js</code> 之前，我们先说明整合 <code>react-redux</code> 的用法。从以下这张图可以看到 <code>react-redux</code> 是 React 和 Redux 间的桥梁，使用 <code>Provider</code>、<code>connect</code> 去连结 <code>store</code> 和 React View。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/using-redux.jpg" alt="React Redux" title="React Redux"></p><p>事实上，整合了 <code>react-redux</code> 后，我们的 React App 就可以解决传统跨 Component 之前传递 state 的问题和困难。只要透过 <code>Provider</code> 就可以让每个 React App 中的 <code>Component</code> 取用 store 中的 state，非常方便（接下来我们也会更详细说明 Container/Component、<code>connect</code> 的用法）。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/redux-store.png" alt="React Redux" title="React Redux"></p><p>以下是 <code>src/index.js</code> 完整程式码：</p><pre><code>import React from &apos;react&apos;;import ReactDOM from &apos;react-dom&apos;;import { Provider } from &apos;react-redux&apos;;import Main from &apos;./components/Main&apos;;import store from &apos;./store&apos;;ReactDOM.render(  &lt;Provider store={store}&gt;    &lt;Main /&gt;  &lt;/Provider&gt;,  document.getElementById(&apos;app&apos;));</code></pre><p>其中 <code>src/components/Main/Main.js</code> 是 Stateless Component，负责所有 View 的进入点。</p><pre><code>import React from &apos;react&apos;;import ReactDOM from &apos;react-dom&apos;;import ReactDOM from &apos;react-dom&apos;;import TodoHeaderContainer from &apos;../../containers/TodoHeaderContainer&apos;;import TodoListContainer from &apos;../../containers/TodoListContainer&apos;;const Main = () =&gt; (  &lt;div&gt;    &lt;TodoHeaderContainer /&gt;    &lt;TodoListContainer /&gt;  &lt;/div&gt;);export default Main;</code></pre><p>接下来我们定义一下 <code>Actions</code> 的部份，由于是范例 App 所以相对简单，这边只定义一个 todoActions。在这边我们使用了 <a href="https://github.com/acdlite/redux-actions" target="_blank" rel="noopener">redux-actions</a>，它可以方便我们使用 Flux Standard Action 格式的 action。以下是 <code>src/actions/todoActions.js</code> 完整程式码：</p><pre><code>import { createAction } from &apos;redux-actions&apos;;import {  CREATE_TODO,  DELETE_TODO,  CHANGE_TEXT,} from &apos;../constants/actionTypes&apos;;export const createTodo = createAction(&apos;CREATE_TODO&apos;);export const deleteTodo = createAction(&apos;DELETE_TODO&apos;);export const changeText = createAction(&apos;CHANGE_TEXT&apos;);</code></pre><p>我们在 <code>src/actions/index.js</code> 将所有 actions 输出</p><pre><code>export * from &apos;./todoActions&apos;;</code></pre><p>另外我们把 constants 放到 <code>components</code> 资料夹中方便管理，以下是 <code>src/constants/actionTypes.js</code> 程式码：</p><pre><code>export const CREATE_TODO = &apos;CREATE_TODO&apos;;export const DELETE_TODO = &apos;DELETE_TODO&apos;;export const CHANGE_TEXT = &apos;CHANGE_TEXT&apos;;/* 或是可以考虑使用 keyMirror，方便产生与 key 相同的常数import keyMirror from &apos;fbjs/lib/keyMirror&apos;;export default keyMirror({    ADD_ITEM: null,    DELETE_ITEM: null,    DELETE_ALL: null,    FILTER_ITEM: null});*/</code></pre><p>设定 Actions 后我们来讨论一下 Reducers 的部份。在讨论 Reducers 之前我们先来设定一下我们的前端的资料结构，在这边我们把所有资料结构（initialState）放到 <code>src/constants/models.js</code> 中。这边特别注意的是由于 Redux 中有一个重要特性是 <code>State is read-only</code>，也就是说更新当 reducers 进到 action 只会回传新的 state 不会更改到原有的 state。因此我们会在整个 Redux App 中使用 <code>ImmutableJS</code> 让整个资料流维持在 <code>Immutable</code> 的状态，也可以提昇程式开发上的效能和避免不可预期的副作用。</p><p>以下是 <code>src/constants/models.js</code> 完整程式码，其设定了 TodoState 的资料结构并使用 <code>fromJS()</code> 转成 <code>Immutable</code>：</p><pre><code>import Immutable from &apos;immutable&apos;;export const TodoState = Immutable.fromJS({  &apos;todos&apos;: [],  &apos;todo&apos;: {    id: &apos;&apos;,    text: &apos;&apos;,    updatedAt: &apos;&apos;,    completed: false,  }});</code></pre><p>接下来我们要讨论的是 Reducers 的部份，在 <code>todoReducers</code> 中我们会根据接收到的 action 进行 mapping 到对应的处理函式并传入夹带的 <code>payload</code> 资料（这边我们使用 <a href="https://github.com/acdlite/redux-actions" target="_blank" rel="noopener">redux-actions</a> 来进行 mapping，使用上比传统的 switch 更为简洁）。Reducers 接收到 action 的处理方式为 <code>(initialState, action) =&gt; newState</code>，最终会回传一个新的 state，而非更改原来的 state，所以这边我们使用 <code>ImmutableJS</code>。</p><pre><code>import { handleActions } from &apos;redux-actions&apos;;import { TodoState } from &apos;../../constants/models&apos;;import {  CREATE_TODO,  DELETE_TODO,  CHANGE_TEXT,} from &apos;../../constants/actionTypes&apos;; const todoReducers = handleActions({  CREATE_TODO: (state) =&gt; {    let todos = state.get(&apos;todos&apos;).push(state.get(&apos;todo&apos;));    return state.set(&apos;todos&apos;, todos)  },  DELETE_TODO: (state, { payload }) =&gt; (    state.set(&apos;todos&apos;, state.get(&apos;todos&apos;).splice(payload.index, 1))  ),  CHANGE_TEXT: (state, { payload }) =&gt; (    state.merge({ &apos;todo&apos;: payload })  )}, TodoState);export default todoReducers;import { handleActions } from &apos;redux-actions&apos;;import UiState from &apos;../../constants/models&apos;;export default handleActions({  SHOW: (state, { payload }) =&gt; (    state.set(&apos;todos&apos;, payload.todo)  ),}, UiState);</code></pre><p>虽然 Redux 本身仅会有一个 store，但 redux 本身有提供了 <code>combineReducers</code> 可以让我们切割我们 state 方便维护和管理。实上，state 的规划也是一们学问，通常需要不断地实作和工作团队讨论才能找到比较好的方式。不过这边要注意的是我们改使用了 <code>redux-immutable</code> 的 <code>combineReducers</code> 这样可以确保我们的 state 维持在 <code>Immutable</code> 的状态。</p><p>由于 Redux 官方也没有特别明确或严谨的规范。在一般情况我会将 reducers 分为 <code>data</code> 和单纯和 UI 有关的 <code>ui</code> state。但由于这边是比较简单的例子，我们最终只使用到 <code>src/reducers/data/todoReducers.js</code>。</p><pre><code>import { combineReducers } from &apos;redux-immutable&apos;;import ui from &apos;./ui/uiReducers&apos;;// import routes from &apos;./routes&apos;;import todo from &apos;./data/todoReducers&apos;;// import routes from &apos;./routes&apos;;const rootReducer = combineReducers({  todo,});export default rootReducer;</code></pre><p>还记得我们上面说明 React Redux 之前的桥梁时有提到的 store 吗？现在我们要更仔细地去设计 <code>store</code>，我们这边使用到了 redux 其中两个 API：applyMiddleware、createStore。分别可以产生 store 和挂载我们要使用的 middleware（这边我们只使用到 redux-logger 方便我们除错）。注意我们 initialState 也是维持在 <code>Immutable</code> 的状态。</p><pre><code>import { createStore, applyMiddleware } from &apos;redux&apos;;import createLogger from &apos;redux-logger&apos;;import Immutable from &apos;immutable&apos;;import rootReducer from &apos;../reducers&apos;;const initialState = Immutable.Map();export default createStore(  rootReducer,  initialState,  applyMiddleware(createLogger({ stateTransformer: state =&gt; state.toJS() })));</code></pre><p>透过 <code>src/store/index.js</code> 输出 configureStore：</p><pre><code>export { default } from &apos;./configureStore&apos;;</code></pre><p>讲解完架构层面的议题，终于我们来到了 View 的部份。加油，距离我们终点也不远了！ 在开始讨论 <code>Component</code> 的部份之前我们先来研究一下</p><p><a href="https://github.com/reactjs/react-redux" target="_blank" rel="noopener">react-redux</a> 所提供的 API <code>connect</code> 将 props 传给 Component，其用法如下：</p><p><code>connect([mapStateToProps], [mapDispatchToProps], [mergeProps], [options])</code></p><p>在我们的范例 App 中我们只会先用到前两个参数，第三个参数会在之后的例子裡用到。第一个参数 mapStateToProps 是一个让开发者可以从 store 取出想要 state 并当做 props 往下传的功能，第二个参数则是将 dispatch 行为封装成函数顺著 props 可以方便往下传和呼叫。</p><p>以下是 <code>src/components/TodoHeader/TodoHeader.js</code> 的部份：</p><pre><code>import React from &apos;react&apos;;import ReactDOM from &apos;react-dom&apos;;import { connect } from &apos;react-redux&apos;;import TodoHeader from &apos;../../components/TodoHeader&apos;;// 将欲使用的 actions 引入import {  changeText,  createTodo,} from &apos;../../actions&apos;;const mapStateToProps = (state) =&gt; ({    // 从 store 取得 todo state    todo: state.getIn([&apos;todo&apos;, &apos;todo&apos;])});const mapDispatchToProps = (dispatch) =&gt; ({    // 当使用者在 input 输入资料值即会触发这个函数，发出 changeText action 并附上使用者输入内容 event.target.value    onChangeText: (event) =&gt; (      dispatch(changeText({ text: event.target.value }))    ),    // 当使用者按下送出时，发出 createTodo action 并清空 input     onCreateTodo: () =&gt; {      dispatch(createTodo());      dispatch(changeText({ text: &apos;&apos; }));    }});export default connect(    mapStateToProps,    mapDispatchToProps,)(TodoHeader);// 开始建设 Component 并使用 connect 进来的 props 并绑定事件（onChange、onClick）。注意我们的 state 因为是使用 `ImmutableJS` 所以要用 `get()` 取值const TodoHeader = ({  onChangeText,  onCreateTodo,  todo,}) =&gt; (  &lt;div&gt;    &lt;h1&gt;TodoHeader&lt;/h1&gt;    &lt;input type=&quot;text&quot; value={todo.get(&apos;text&apos;)} onChange={onChangeText} /&gt;    &lt;button onClick={onCreateTodo}&gt;送出&lt;/button&gt;  &lt;/div&gt;);export default TodoHeader;</code></pre><p>以下是 <code>src/components/TodoList/TodoList.js</code> 的部份：</p><pre><code>import React from &apos;react&apos;;import ReactDOM from &apos;react-dom&apos;;import { connect } from &apos;react-redux&apos;;import TodoList from &apos;../../components/TodoList&apos;;import {  deleteTodo,} from &apos;../../actions&apos;;const mapStateToProps = (state) =&gt; ({  todos: state.getIn([&apos;todo&apos;, &apos;todos&apos;])});// 由 Component 传进欲删除元素的 indexconst mapDispatchToProps = (dispatch) =&gt; ({  onDeleteTodo: (index) =&gt; () =&gt; (    dispatch(deleteTodo({ index }))  )});export default connect(    mapStateToProps,    mapDispatchToProps,)(TodoList);// Component 部分值的注意的是 todos state 是透过 map function 去迭代出元素，由于要让 React JSX 可以渲染并保持传入触发 event state 的 immutable，所以需使用 toJS() 转换 component of array。const TodoList = ({  todos,  onDeleteTodo,}) =&gt; (  &lt;div&gt;    &lt;ul&gt;    {      todos.map((todo, index) =&gt; (        &lt;li key={index}&gt;          {todo.get(&apos;text&apos;)}          &lt;button onClick={onDeleteTodo(index)}&gt;X&lt;/button&gt;        &lt;/li&gt;      )).toJS()    }    &lt;/ul&gt;  &lt;/div&gt;);export default TodoList;</code></pre><p>若是一切顺利的话就可以在浏览器上看到自己努力的成果萝！（因为我们有使用 <code>redux-logger</code> 所以打开 console 会看到 action 和 state 的变化情形，但记得在 <code>production</code> 环境要拿掉）</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/react-redux-dev-demo.png" alt="React Redux" title="React Redux"></p><h3 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h3><p>以上就是 Redux 实战入门，对于第一次自己动手写 Redux 的朋友可能会需要多练习几次，多体会整个架构。在接下来的章节我们将优化我们的 React Redux TodoApp，让它可以有更清晰好维护的架构。</p><h3 id="延伸阅读-2"><a href="#延伸阅读-2" class="headerlink" title="延伸阅读"></a>延伸阅读</h3><ol><li><a href="http://redux.js.org/index.html" target="_blank" rel="noopener">Redux 官方网站</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于9月下旬的一些事</title>
      <link href="/late-september-notes.html"/>
      <url>/late-september-notes.html</url>
      
        <content type="html"><![CDATA[<h3 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h3><p>之前在上海大量投简历，收到大部分都是上海市区那儿的，工作基本在8K-1.2W左右，我记得这几家都是做电商的，工资待遇虽然不错，但听了朋友说，电商公司很忙，每天都要加班到大半夜，基本是<code>996</code>那种情况吧，虽然我很想去，无奈家里有事一时走不开，而且市中心，想想就蛋疼了..人这么多…</p><p>这个月接触前端工程师，感觉要求真的是越来越高了，或许以后前端工程师必须掌握Node.js技能，而且其中的ReactJS最为火热…</p><p>还有不是有神马微信小程序那玩意儿…不想吐槽，还不知道是不是TX请水军来宣传的…效果太夸张…难道iOS Android 后端全特么下岗了？？😂😂</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/QQ%E5%9B%BE%E7%89%8720160926203400.jpg" alt></p><p>现在天天在家都不知道干啥…代码完全看不下去了..表示沉迷于梦幻西游手游😂😂等我玩够就卸了…</p><p>马上到月底，估摸着要回老家一趟，主要是拿衣服和办点事情。</p><h3 id="杂-家-事"><a href="#杂-家-事" class="headerlink" title="杂(家)事"></a>杂(家)事</h3><p>都说家丑不可外扬，我已经无力吐槽家里那些破事了，上个月我还以为处于双亲家庭，这样我妈突然拿出离婚证给看，讲真，当时我就蒙逼了一样。谈不上有太大的伤感，对我来说轻松了点，天天夹在他们俩中间也是够难受的。</p><p>现在跟着我爸过咯，中旬的时候，公司过户给我爸，又接下一比大生意，基本没多少资金请人了，我留下做文员兼各种…诶，真不想干，但还有什么办法呢？思索着到十月份拍拍屁股走人。</p><h3 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h3><p>听说windows 10 1607很不错？除了对软件兼容性存在问题，其他还可以吧。而且支持emoji表情了。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/emoji_style.png" alt></p><p>看着风格，我都不知道那些工程师审美观是不是存在问题…</p><p>算了，凑合用吧😂😂，看到这风格真是日了吉娃娃的…比android好看一点，只是一点点而已😂</p><p>还有哦，iOS 10 Emoji表情风格也变了…简直就是丧心病狂…是不是我的审美观出问题了？要不要去矫正下？😂😂</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>R06-ImmutableJS 入门教学</title>
      <link href="/reactjs-getting-started-6.html"/>
      <url>/reactjs-getting-started-6.html</url>
      
        <content type="html"><![CDATA[<h1 id="ImmutableJS-入门教学"><a href="#ImmutableJS-入门教学" class="headerlink" title="ImmutableJS 入门教学"></a>ImmutableJS 入门教学</h1><p><img src="https://res.i95.me/wp-content/uploads/2016/09/immutable.png" alt="ImmutableJS" title="ImmutableJS"></p><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>一般来说在 JavaScript 中有两种资料类型：Primitive（String、Number、Boolean、null、undefinded）和 Object（Reference）。在 JavaScript 中物件的操作比起 Java 容易很多，但也因为相对弹性不严谨，所以产生了一些问题。在 JavaScript 中的 Object（物件）资料是 Mutable（可以变的），由于是使用 Reference 的方式，所以当修改到複製的值也会修改到原始值。例如下面的 <code>map2</code> 值是指到 <code>map1</code>，所以当 <code>map1</code> 值一改，<code>map2</code> 的值也会受影响。</p><pre><code>var map1 = { a: 1 }; var map2 = map1; map2.a = 2</code></pre><p>通常一般作法是使用 <code>deepCopy</code> 来避免修改，但这样作法会产生较多的资源浪费。为了很好的解决这个问题，我们可以使用 <code>Immutable Data</code>，所谓的 Immutable Data 就是一旦建立，就不能再被修改的数据资料。</p><p>为了解决这个问题，在 2013 年时 Facebook 工程师 Lee Byron 打造了 <a href="https://facebook.github.io/immutable-js/" target="_blank" rel="noopener">ImmutableJS</a>，但并没有被预设放到 React 工具包中（虽然有提供简化的 Helper），但 <code>ImmutableJS</code> 的出现确实解决了 <code>React</code> 甚至 <code>Redux</code> 所遇到的一些问题。</p><p>以下范例即是引入了 <code>ImmutableJS</code> 的效果，读者可以发现，虽然我们操作了 <code>map1</code> 的值，但会发现原本的 <code>map1</code> 并未受到影响（因为任何修改都不会影响到原始资料），虽然使用 <code>deepCopy</code> 也可以模拟类似的效果但会浪费过多的计算资源和记忆体，<code>ImmutableJS</code> 则可以容易地共享没有被修该到的资料（例如下面的资料 <code>b</code> 即为 <code>map1</code> 所 <code>map2</code> 共享），因而有更好的效能表现。</p><pre><code>import Immutable from &apos;immutable&apos;;var map1 = Immutable.Map({ a: 1, b: 3 });var map2 = map1.set(&apos;a&apos;, 2);map1.get(&apos;a&apos;); // 1map2.get(&apos;a&apos;); // 2</code></pre><h3 id="ImmutableJS-特性介绍"><a href="#ImmutableJS-特性介绍" class="headerlink" title="ImmutableJS 特性介绍"></a>ImmutableJS 特性介绍</h3><p>ImmutableJS 提供了 7 种不可修改的资料类型：<code>List</code>、<code>Map</code>、<code>Stack</code>、<code>OrderedMap</code>、<code>Set</code>、<code>OrderedSet</code>、<code>Record</code>。若是对 Immutable 物件操作都会回传一个新值。其中比较常用的有 <code>List</code>、<code>Map</code> 和 <code>Set</code>：</p><ol><li>Map：类似于 key/value 的 object，在 ES6 也有原生 <code>Map</code> 对应 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">    `const Map= Immutable.Map;`</span><br><span class="line"></span><br><span class="line">``</span><br></pre></td></tr></table></figure></li></ol><p>// 1. Map 大小<br>const map1 = Map({ a: 1 });<br>map1.size<br>// =&gt; 1</p><p>// 2. 新增或取代 Map 元素<br>// set(key: K, value: V)<br>const map2 = map1.set(‘a’, 7);<br>// =&gt; Map { “a”: 7 }</p><p>// 3. 删除元素<br>// delete(key: K)<br>const map3 = map1.delete(‘a’);<br>// =&gt; Map {}</p><p>// 4. 清除 Map 内容<br>const map4 = map1.clear();<br>// =&gt; Map {}</p><p>// 5. 更新 Map 元素<br>// update(updater: (value: Map&lt;K, V&gt;) =&gt; Map&lt;K, V&gt;)<br>// update(key: K, updater: (value: V) =&gt; V)<br>// update(key: K, notSetValue: V, updater: (value: V) =&gt; V)<br>const map5 = map1.update(‘a’, () =&gt; (7))<br>// =&gt; Map { “a”: 7 }</p><p>// 6. 合併 Map<br>const map6 = Map({ b: 3 });<br>map1.merge(map6);<br>// =&gt; Map { “a”: 1, “b”: 3 }</p><pre><code>2. List：有序且可以重複值，对应于一般的 Array <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">    const List= Immutable.List;</span><br><span class="line">    </span><br><span class="line">    // 1. 取得 List 长度</span><br><span class="line">    const arr1 = List([1, 2, 3]);</span><br><span class="line">    arr1.size</span><br><span class="line">    // =&gt; 3</span><br><span class="line">    </span><br><span class="line">    // 2. 新增或取代 List 元素内容</span><br><span class="line">    // set(index: number, value: T)</span><br><span class="line">    // 将 index 位置的元素替换</span><br><span class="line">    const arr2 = arr1.set(-1, 7);</span><br><span class="line">    // =&gt; [1, 2, 7]</span><br><span class="line">    const arr3 = arr1.set(4, 0);</span><br><span class="line">    // =&gt; [1, 2, 3, undefined, 0]</span><br><span class="line">    </span><br><span class="line">    // 3. 删除 List 元素</span><br><span class="line">    // delete(index: number)</span><br><span class="line">    // 删除 index 位置的元素</span><br><span class="line">    const arr4 = arr1.delete(1);</span><br><span class="line">    // =&gt; [1, 3]</span><br><span class="line">    </span><br><span class="line">    // 4. 插入元素到 List</span><br><span class="line">    // insert(index: number, value: T)</span><br><span class="line">    // 在 index 位置插入 value</span><br><span class="line">    const arr5 = arr1.insert(1, 2);</span><br><span class="line">    // =&gt; [1, 2, 2, 3]</span><br><span class="line">    </span><br><span class="line">    // 5. 清空 List</span><br><span class="line">    // clear()</span><br><span class="line">    const arr6 = arr1.clear();</span><br><span class="line">    // =&gt; []</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">3.  Set：没有顺序且不能重複的列表 ```  </span><br><span class="line">    `const Set= Immutable.Set;`</span><br><span class="line"></span><br><span class="line">`</span><br></pre></td></tr></table></figure></code></pre><p>// 1. 建立 Set<br>const set1 = Set([1, 2, 3]);<br>// =&gt; Set { 1, 2, 3 }</p><p>// 2. 新增元素<br>const set2 = set1.add(1).add(5);<br>// =&gt; Set { 1, 2, 3, 5 }<br>// 由于 Set 为不能重複集合，故 1 只能出现一次</p><p>// 3. 删除元素<br>const set3 = set1.delete(3);<br>// =&gt; Set { 1, 2 }</p><p>// 4. 取联集<br>const set4 = Set([2, 3, 4, 5, 6]);<br>set1.union(set4);<br>// =&gt; Set { 1, 2, 3, 4, 5, 6 }</p><p>// 5. 取交集<br>set1.intersect(set4);<br>// =&gt; Set { 2, 3 }</p><p>// 6. 取差集<br>set1.subtract(set4);<br>// =&gt; Set { 1 }</p><pre><code>### ImmutableJS 的特性整理1. Persistent Data Structure 在 `ImmutableJS` 的世界裡，只要资料一被创建，就不能修改，维持 `Immutable`。就不会发生下列的状况： <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">    var obj = &#123;</span><br><span class="line">    a: 1</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    funcationA(obj);</span><br><span class="line">    console.log(obj.a) // 不确定结果为多少？</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">使用 `ImmutableJS` 就没有这个问题：</span><br><span class="line"></span><br><span class="line">    // 有些开发者在使用时会在 ``Immutable` 变数前加 `$` 以示区隔。</span><br><span class="line">    </span><br><span class="line">    const $obj = fromJS(&#123;</span><br><span class="line">    a: 1</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    funcationA($obj);</span><br><span class="line">    console.log($obj.get(&apos;a&apos;)) // 1</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">2.  Structural Sharing 为了维持资料的不可变，又要避免像 `deepCopy` 一样複製所有的节点资料而造成的资源损耗，在 `ImmutableJS` 使用的是 Structural Sharing 特性，亦即如果物件树中一个节点发生变化的话，只会修改这个节点和和受它影响的父节点，其他节点则共享。 ```  </span><br><span class="line">    `const obj = &#123;  </span><br><span class="line">    count: 1,  </span><br><span class="line">    list: [1, 2, 3, 4, 5]  </span><br><span class="line">    &#125;  </span><br><span class="line">    var map1 = Immutable.fromJS(obj);  </span><br><span class="line">    var map2 = map1.set(&apos;count&apos;, 4);`</span><br><span class="line"></span><br><span class="line">``</span><br><span class="line"></span><br><span class="line">console.log(map1.list === map2.list); // true</span><br><span class="line"></span><br><span class="line">    3. Support Lazy Operation</span><br></pre></td></tr></table></figure>Immutable.Range(1, Infinity).map(n =&gt; -n)// Error: Cannot perform this action with an infinite size.Immutable.Range(1, Infinity).map(n =&gt; -n).take(2).reduce((r, n) =&gt; r + n, 0); // -3</code></pre><ol start="4"><li>丰富的 API 并提供快速转换原生 JavaScript 的方式 在 ImmutableJS 中可以使用 <code>fromJS()</code>、<code>toJS()</code> 进行 JavaScript 和 ImmutableJS 之间的转换。但由于在转换之间会非常耗费资源，所以若是你决定引入 <code>ImmutableJS</code> 的话请尽量维持资料处在 <code>Immutable</code> 的状态。</li><li>支持 Functional Programming <code>Immutable</code> 本身就是 Functional Programming（函数式程式设计）的概念，所以在 <code>ImmutableJS</code> 中可以使用许多 Functional Programming 的方法，例如：<code>map</code>、<code>filter</code>、<code>groupBy</code>、<code>reduce</code>、<code>find</code>、<code>findIndex</code> 等。</li><li>容易实现 Redo/Undo 历史回顾</li></ol><h3 id="React-效能优化"><a href="#React-效能优化" class="headerlink" title="React 效能优化"></a>React 效能优化</h3><p><code>ImmutableJS</code> 除了可以和 <code>Flux/Redux</code> 整合外，也可以用于基本 react 效能优化。以下是一般使用效能优化的简单方式：</p><p>传统 JavaScript 比较方式，若资料型态为 Primitive 就不会有问题：</p><pre><code>// 在 shouldComponentUpdate 比较接下来的 props 一否一致，若相同则不重新渲染，提昇效能shouldComponentUpdate (nextProps) {    return this.props.value !== nextProps.value;}</code></pre><p>但当比较的是物件的话就会出现问题：</p><pre><code>// 假设 this.props.value 为 { foo: &apos;app&apos; }// 架设 nextProps.value 为 { foo: &apos;app&apos; },// 虽然两者值是一样，但由于 reference 位置不同，所以视为不同。但由于值一样应该要避免重複渲染this.props.value !== nextProps.value; // true</code></pre><p>使用 <code>ImmutableJS</code>：</p><pre><code>var SomeRecord = Immutable.Record({ foo: null });var x = new SomeRecord({ foo: &apos;app&apos;  });var y = x.set(&apos;foo&apos;, &apos;azz&apos;);x === y; // false</code></pre><p>在 ES6 中可以使用官方文件上的 <code>PureRenderMixin</code> 进行比较，可以让程式码更简洁：</p><pre><code>import PureRenderMixin from &apos;react-addons-pure-render-mixin&apos;;class FooComponent extends React.Component {  constructor(props) {    super(props);    this.shouldComponentUpdate = PureRenderMixin.shouldComponentUpdate.bind(this);  }  render() {    return &lt;div className={this.props.className}&gt;foo&lt;/div&gt;;  }}</code></pre><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>虽然 <code>ImmutableJS</code> 的引入可以带来许多好处和效能的提升但由于引入整体档案较大且较具侵入性，在引入之前可以自行评估看看是否合适于目前的专案。接下来我们将在后面的章节讲解如何将 <code>ImmutableJS</code> 和 <code>Redux</code> 整合应用到实务上的范例。</p><h3 id="延伸阅读"><a href="#延伸阅读" class="headerlink" title="延伸阅读"></a>延伸阅读</h3><ol><li><a href="https://facebook.github.io/immutable-js/" target="_blank" rel="noopener">官方网站</a></li><li><a href="http://www.w3cplus.com/javascript/immutable-js.html" target="_blank" rel="noopener">Immutable.js初识</a></li><li><a href="https://github.com/camsong/blog/issues/3" target="_blank" rel="noopener">Immutable 详解及 React 中实践</a></li><li><a href="http://zhenhua-lee.github.io/react/Immutable.html" target="_blank" rel="noopener">为什么需要Immutable.js</a></li><li><a href="https://www.zhihu.com/question/28016223" target="_blank" rel="noopener">facebook immutable.js 意义何在，使用场景？</a></li><li><a href="https://blog.wuct.me/react-%E5%B7%A2%E7%8B%80-component-%E6%95%88%E8%83%BD%E5%84%AA%E5%8C%96-b01d8a0d3eff#.3kf4h1xq1" target="_blank" rel="noopener">React 巢状 Component 效能优化</a></li><li><a href="https://facebook.github.io/react/docs/pure-render-mixin.html" target="_blank" rel="noopener">PureRenderMixin</a></li><li><a href="https://github.com/rtfeldman/seamless-immutable" target="_blank" rel="noopener">seamless-immutable</a></li><li><a href="http://jlongster.com/Using-Immutable-Data-Structures-in-JavaScript" target="_blank" rel="noopener">Immutable Data Structures and JavaScript</a></li></ol><p><code>``</code> <code>`</code></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>R05-React Router 入门实战教学</title>
      <link href="/reactjs-getting-started-5.html"/>
      <url>/reactjs-getting-started-5.html</url>
      
        <content type="html"><![CDATA[<h1 id="React-Router-入门实战教学"><a href="#React-Router-入门实战教学" class="headerlink" title="React Router 入门实战教学"></a>React Router 入门实战教学</h1><p><img src="https://res.i95.me/wp-content/uploads/2016/09/react-router.jpg" alt="React Router 资料夹结构"></p><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>若你是从一开始一路走到这裡读者请先给自己一个爱的鼓励吧！在经历了 React 基础的训练后，相信各位读者应该都等不及想大展拳脚了！接下来我们将进行比较複杂的应用程式开发并和读者介绍目前市场上常见的不刷页单页式应用程式（single page application）的设计方式。</p><h3 id="单页式应用程式（single-page-application）"><a href="#单页式应用程式（single-page-application）" class="headerlink" title="单页式应用程式（single page application）"></a>单页式应用程式（single page application）</h3><p>传统的 Web 开发主要是由伺服器管理 URL Routing 和渲染 HTML 页面，过往每次 URL 一换或使用者连结一点，就需要重新从伺服器端重新载入页面。但随著使用者对于使用者体验的要求提昇，许多的网页应用程式纷纷设计成不刷页的单页式应用程式（single page application），由前端负责 URL 的 routing 管理，若需要和后端进行 API 资料沟通的话，通常也会使用 Ajax 的技术。在 React 开发世界中主流是使用 <a href="https://github.com/reactjs/react-router" target="_blank" rel="noopener">react-router</a> 这个 routing 管理用的 library。</p><h3 id="React-Router-环境设置"><a href="#React-Router-环境设置" class="headerlink" title="React Router 环境设置"></a>React Router 环境设置</h3><p>先透过以下指令在根目录产生 npm 设定档 <code>package.json</code> ：</p><pre><code>$ npm init</code></pre><p>安装相关套件（包含开发环境使用的套件）：</p><pre><code>$ npm install --save react react-dom react-router$ npm install --save-dev babel-core babel-eslint babel-loader babel-preset-es2015 babel-preset-react eslint eslint-config-airbnb eslint-loader eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-react webpack webpack-dev-server html-webpack-plugin</code></pre><p>安装好后我们可以设计一下我们的资料夹结构，首先我们在根目录建立 <code>src</code> 和 <code>res</code> 资料夹，分别放置 <code>script</code> 的 <code>source</code> 和静态资源（如：全域使用的 <code>.css</code> 和图档）。在 <code>components</code> 资料夹中我们会放置所有 <code>components</code>（个别元件资料夹中会用 <code>index.js</code> 输出元件，让引入元件更简洁），其馀设定档则放置于根目录下。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/folder.png" alt="React Router 资料夹结构"></p><p>接下来我们先设定一下开发文档。</p><ol><li><p>设定 Babel 的设定档： `.babelrc<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">    `&#123;  </span><br><span class="line">    &quot;presets&quot;: [  </span><br><span class="line">    &quot;es2015&quot;,  </span><br><span class="line">    &quot;react&quot;,  </span><br><span class="line">    ],  </span><br><span class="line">    &quot;plugins&quot;: []  </span><br><span class="line">    &#125;`</span><br><span class="line"></span><br><span class="line">```````2. 设定 ESLint 的设定档和规则： `.eslintrc</span><br></pre></td></tr></table></figure></p><p> {<br>   “extends”: “airbnb”,<br>   “rules”: {</p><pre><code>&quot;react/jsx-filename-extension&quot;: [1, { &quot;extensions&quot;: [&quot;.js&quot;, &quot;.jsx&quot;] }],</code></pre><p>   },<br>   “env” :{</p><pre><code>&quot;browser&quot;: true,</code></pre><p>   }<br> }</p></li></ol><ol start="3"><li><p>设定 Webpack 设定档： `webpack.config.js<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">    `// 让你可以动态插入 bundle 好的 .js 档到 .index.html  </span><br><span class="line">    const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;);`</span><br><span class="line"></span><br><span class="line">``````const HTMLWebpackPluginConfig = new HtmlWebpackPlugin(&#123;  </span><br><span class="line">template: `$&#123;__dirname&#125;/src/index.html`,  </span><br><span class="line">filename: &apos;index.html&apos;,  </span><br><span class="line">inject: &apos;body&apos;,  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// entry 为进入点，output 为进行完 eslint、babel loader 转译后的档案位置  </span><br><span class="line">module.exports = &#123;  </span><br><span class="line">entry: [  </span><br><span class="line">&apos;./src/index.js&apos;,  </span><br><span class="line">],  </span><br><span class="line">output: &#123;  </span><br><span class="line">path: `$&#123;__dirname&#125;/dist`,  </span><br><span class="line">filename: &apos;index_bundle.js&apos;,  </span><br><span class="line">&#125;,  </span><br><span class="line">module: &#123;  </span><br><span class="line">preLoaders: [  </span><br><span class="line">&#123;  </span><br><span class="line">test: /.jsx$|.js$/,  </span><br><span class="line">loader: &apos;eslint-loader&apos;,  </span><br><span class="line">include: `$&#123;__dirname&#125;/src`,  </span><br><span class="line">exclude: /bundle.js$/  </span><br><span class="line">&#125;  </span><br><span class="line">],  </span><br><span class="line">loaders: [&#123;  </span><br><span class="line">test: /.js$/,  </span><br><span class="line">exclude: /node_modules/,  </span><br><span class="line">loader: &apos;babel-loader&apos;,  </span><br><span class="line">query: &#123;  </span><br><span class="line">presets: [&apos;es2015&apos;, &apos;react&apos;],  </span><br><span class="line">&#125;,  </span><br><span class="line">&#125;],  </span><br><span class="line">&#125;,  </span><br><span class="line">// 启动开发测试用 server 设定（不能用在 production）  </span><br><span class="line">devServer: &#123;  </span><br><span class="line">inline: true,  </span><br><span class="line">port: 8008,  </span><br><span class="line">&#125;,  </span><br><span class="line">plugins: [HTMLWebpackPluginConfig],  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    太好了！这样我们就完成了开发环境的设定可以开始动手实作 `React Router` 应用程式了！</span><br><span class="line">    </span><br><span class="line">    ### 开始 React Routing 之旅</span><br><span class="line">    </span><br><span class="line">    HTML Markup：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"> `````ReactRouter </span><br><span class="line"></span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    以下是 `webpack.config.js` 的进入点 `src/index.js`，负责管理 `Router` 和 `render` 元件。这边我们要先详细讨论的是，为了使用 React Router 功能引入了许多 `react-router` 内部的元件。</span><br><span class="line">    </span><br><span class="line">    1. Router `Router` 是放置 Route 的容器，其本身不定义 routing ，真正 routing 规则由 `Route` 定义。</span><br><span class="line">    2. Route `Route` 负责 URL 和对应的元件关系，可以有多个 `Route` 规则也可以有嵌套（nested）`Routing`。像下面的例子就是每个页面都会先载入 `App` 元件再载入对应 URL 的元件。</span><br><span class="line">    3. history `Router` 中有一个属性 `history` 的规则，这边使用我们使用 `hashHistory`，使用 routing 将由 `hash`（#）变化决定。例如：当使用者拜访 `http://www.github.com/`，实际看到的会是 `http://www.github.com/#/`。下列范例若是拜访了 `/about` 则会看到 `http://localhost:8008/#/about` 并载入 `App` 元件再载入 `About` 元件。 - hashHistory 教学范例使用的，会通过 `hash` 进行对应。好处是简单易用，不用多馀设定。</span><br><span class="line">    - browserHistory 适用于伺服器端渲染，但需要设定伺服器端避免处理错误，这部份我们会在后面的章节详细说明。注意的是若是使用 Webpack 开发用伺服器需加上 `--history-api-fallback</span><br></pre></td></tr></table></figure></p><p>$ webpack-dev-server –inline –content-base . –history-api-fallback</p></li></ol><ul><li>createMemoryHistory 主要用于伺服器渲染，使用上会建立一个存在记忆体的 <code>history</code> 物件，不会修改浏览器的网址位置。 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line">    const history = createMemoryHistory(location)</span><br><span class="line"></span><br><span class="line">    4. path `path` 是对应 URL 的规则。例如：`/repos/torvalds` 会对应到 `/repos/:name` 的位置，并将参数传入 `Repos` 元件中。由 `this.props.params.name` 取得参数。顺带一提，若为查询参数 `/user?q=torvalds` 则由 `this.props.location.query.q` 取得参数。</span><br><span class="line">    5. IndexRoute 由于 `/` 情况下 App 元件对应的 `this.props.children` 会是 `undefinded`，所以使用 `IndexRoute` 来解决对应问题。这样当 URL 为 `/` 时将会对应到 Home 元件。不过要注意的是 `IndexRoute` 没有 path 属性。</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import ReactDOM from &apos;react-dom&apos;;  </span><br><span class="line">import &#123; Router, Route, hashHistory, IndexRoute &#125; from &apos;react-router&apos;;  </span><br><span class="line">import App from &apos;./components/App&apos;;  </span><br><span class="line">import Home from &apos;./components/Home&apos;;  </span><br><span class="line">import Repos from &apos;./components/Repos&apos;;  </span><br><span class="line">import About from &apos;./components/About&apos;;  </span><br><span class="line">import User from &apos;./components/User&apos;;  </span><br><span class="line">import Contacts from &apos;./components/Contacts&apos;;`</span><br><span class="line"></span><br><span class="line">````ReactDOM.render(  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">,  </span><br><span class="line">document.getElementById(&apos;app&apos;));</span><br><span class="line"></span><br><span class="line">/* 另外一种写法：  </span><br><span class="line">const routes = (  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">    ReactDOM.render(</span><br><span class="line">      &lt;Router routes=&#123;routes&#125; history=&#123;hashHistory&#125; /&gt;,</span><br><span class="line">      document.getElementById(&apos;app&apos;));</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    由于我们在 `index.js` 使用嵌套 routing，把 App 元件当做每个元件都会载入的母模版，亦即进入每个对应页面载入对应元件前都会先载入 App 元件。这样就可以让每个页面都有导览列连结可以点选，同时可以透过 `props.children` 载入对应 URL 的子元件。</span><br><span class="line">    </span><br><span class="line">    1. Link `Link` 元件主要用于点击后连结转换，可以想成是 `&lt;a&gt;` 超连结的 React 版本。若是希望当点击时候有对应的 css style，可以使用 `activeStyle`、`activeClassName` 去做设定。范例分别使用于 `index.html`使用传统 `CSS` 载入、Inline Style、外部引入 `Inline Style` 写法。</span><br><span class="line">    2. IndexLink IndexLink 主要是了处理 `index` 用途，特别注意当 child route `actived` 时，parent route 也会 `actived`。所以我们回首页的连结使用 `&lt;IndexLink /&gt;` 内部的 `onlyActiveOnIndex` 属性来解决这个问题。</span><br><span class="line">    3. Redirect、IndexRedirect 这边虽然没有用到，但若读者有需要使用到连结跳转的话可以参考这两个元件，用法类似于 `Route` 和 `IndexRedirect`。</span><br><span class="line">    </span><br><span class="line">    以下是 `src/components/App/App.js` 完整程式码：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import &#123; Link, IndexLink &#125; from &apos;react-router&apos;;  </span><br><span class="line">import styles from &apos;./appStyles&apos;;  </span><br><span class="line">import NavLink from &apos;../NavLink&apos;;`</span><br><span class="line"></span><br><span class="line">```const App = (props) =&gt; (</span><br><span class="line"></span><br><span class="line">React Router Tutorial</span><br><span class="line">=====================</span><br><span class="line"></span><br><span class="line">*   Home</span><br><span class="line">*   About</span><br><span class="line">*   Repos</span><br><span class="line">*   User</span><br><span class="line">*   Contacts</span><br><span class="line"></span><br><span class="line">&#123;props.children&#125;</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">App.propTypes = &#123;  </span><br><span class="line">children: React.PropTypes.object,  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default App;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    对应的元件内部使用 Functional Component 进行 UI 渲染：</span><br><span class="line">    </span><br><span class="line">    以下是 `src/components/Repos/Repos.js` 完整程式码：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;`</span><br><span class="line"></span><br><span class="line">``const Repos = (props) =&gt; (</span><br><span class="line"></span><br><span class="line">### Repos</span><br><span class="line"></span><br><span class="line">##### &#123;props.params.name&#125;</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">Repos.propTypes = &#123;  </span><br><span class="line">params: React.PropTypes.object,  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default Repos;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    详细的程式码读者可以参考范例资料夹，若读者跟著范例完成的话，可以在终端机上执行 `npm start`，并于浏览器 `http://localhost:8008`看到以下成果，当你点选连结时会切换对应元件并改变 `actived` 状态！</span><br><span class="line">    </span><br><span class="line">    ![范例成果](https://res.i95.me/wp-content/uploads/2016/09/example.png)</span><br><span class="line">    </span><br><span class="line">    ### 总结</span><br><span class="line">    </span><br><span class="line">    到这边我们又一起完成了一个重要的一关，学习 `routing` 对于使用 `React` 开发複杂应用程式是非常重要的一步，接下来我们将一起学习一个相对独立的单元 `ImmutableJS`，但学习 `ImmutableJS` 可以让我们在使用 `React` 和 `Flux/Redux` 可以有更好的效能和避免一些副作用。</span><br><span class="line">    </span><br><span class="line">    ### 延伸阅读</span><br><span class="line">    </span><br><span class="line">    1. [Leveling Up With React: React Router](https://css-tricks.com/learning-react-router/)</span><br><span class="line">    2. [Programmatically navigate using react router](http://stackoverflow.com/questions/31079081/programmatically-navigate-using-react-router)</span><br><span class="line">    3. [React Router 使用教程](http://www.ruanyifeng.com/blog/2016/05/react_router.html)</span><br><span class="line">    4. [React Router 中文文档](https://react-guide.github.io/react-router-cn/index.html)</span><br><span class="line">    5. [React Router Tutorial](https://github.com/reactjs/react-router-tutorial)`` ``` ```` ````` `````` ````</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>R04-Props/State 基础与 Component 生命周期</title>
      <link href="/reactjs-getting-started-4.html"/>
      <url>/reactjs-getting-started-4.html</url>
      
        <content type="html"><![CDATA[<h1 id="Props、State、Refs-与表单处理"><a href="#Props、State、Refs-与表单处理" class="headerlink" title="Props、State、Refs 与表单处理"></a>Props、State、Refs 与表单处理</h1><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在前面的章节中我们已经对于 React 和 JSX 有初步的认识，我们也了解到 React Component 事实上可以视为显示 UI 的一个状态机（state machine），而这个状态机根据不同的 state（透过 <code>setState()</code> 修改）和 props（由父元素传入），Component 会出现对应的显示结果。本章将使用 <a href="https://facebook.github.io/react/index.html" target="_blank" rel="noopener">React 官网首页上的范例</a>（使用 ES6+）来更进一步说明 Props 和 State 特性及在 React 如何进行事件和表单处理。</p><h3 id="Props"><a href="#Props" class="headerlink" title="Props"></a>Props</h3><p>首先我们使用 React 官网上的 A Simple Component 来说明 props 的使用方式。由于传入元件的 name 属性为 Mark，故以下程式码将会在浏览器显示 Hello, Mark。针对传入的 props 我们也有验证和预设值的设计，让我们撰写的元件可以更加稳定健壮（robust）。</p><p>HTML Markup：</p><pre><code>  &lt;meta charset=&quot;utf-8&quot;&gt;  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;&gt;  &lt;title&gt;A Component Using External Plugins&lt;/title&gt;&lt;!-- 这边方便使用 CDN 方式引入 react 、 react-dom 进行讲解，实务上和实战教学部分我们会使用 webpack --&gt;&lt;script src=&quot;https://fb.me/react-15.1.0.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://fb.me/react-dom-15.1.0.js&quot;&gt;&lt;/script&gt;  &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;    &lt;script src=&quot;./app.js&quot;&gt;&lt;/script&gt;</code></pre><p>app.js，使用 ES6 Class Component 写法：</p><pre><code>class HelloMessage extends React.Component {    constructor(props) {        // 对于 OOP 物件导向程式设计熟悉的读者应该对于 constructor 建构子的使用不陌生，事实上它是 ES6 的语法糖，骨子裡还是 portotype based 物件导向程式语言。透过 extends 可以继承 React.Component 父类别。super 方法可以呼叫继承父类别的建构子        super(props);        this.state = {}    }    render() {        return (            &lt;div&gt;Hello {this.props.name}&lt;/div&gt;        )    }}// PropTypes 验证，若传入的 props type 不是 string 将会显示错误HelloMessage.propTypes = {  name: React.PropTypes.string,}// Prop 预设值，若对应 props 没传入值将会使用 default 值 ZuckHelloMessage.defaultProps = { name: &apos;Zuck&apos;, }ReactDOM.render(&lt;HelloMessage name=&quot;Mark&quot; /&gt;, document.getElementById(&apos;app&apos;));</code></pre><p>使用 Functional Component 写法：</p><pre><code>// Functional Component 可以视为 f(d) =&gt; UI，根据传进去的 props 绘出对应的 UI。注意这边 props 是传入函式的参数。因此取用 props 不用加 thisconst HelloMessage = (props) =&gt; (    &lt;div&gt;Hello {props.name}&lt;/div&gt;);// PropTypes 验证，若传入的 props type 不是 string 将会显示错误HelloMessage.propTypes = {  name: React.PropTypes.string,}// Prop 预设值，若对应 props 没传入值将会使用 default 值 Zuck。用法等于 ES5 的 getDefaultPropsHelloMessage.defaultProps = { name: &apos;Zuck&apos;, }ReactDOM.render(&lt;HelloMessage name=&quot;Mark&quot; /&gt;, document.getElementById(&apos;app&apos;));</code></pre><p>在 jsbin 上的范例：</p><p><a href="http://jsbin.com/wadice/embed?html,js,console,output" target="_blank" rel="noopener">A Component Using External Plugins on jsbin.com</a></p><h3 id="State"><a href="#State" class="headerlink" title="State"></a>State</h3><p>接下来我们将使用 A Stateful Component 这个范例来讲解 State 的用法。在 React Component 可以自己管理自己的内部 state，并用 <code>this.state</code> 来存取 state。当 <code>setState()</code> 方法更新了 state 后将重新呼叫 <code>render()</code> 方法，重新绘製 component 内容。以下范例是一个每 1000 毫秒（等于1秒）就会加一的累加器。由于这个范例是 Stateful Component 因此仅使用 ES6 Class Component，而不使用 Functional Component。</p><p>HTML Markup：</p><pre><code>  &lt;meta charset=&quot;utf-8&quot;&gt;  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;&gt;  &lt;title&gt;A Component Using External Plugins&lt;/title&gt;&lt;script src=&quot;https://fb.me/react-15.1.0.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://fb.me/react-dom-15.1.0.js&quot;&gt;&lt;/script&gt;  &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;    &lt;script src=&quot;./app.js&quot;&gt;&lt;/script&gt;</code></pre><p>app.js：</p><pre><code>class Timer extends React.Component {    constructor(props) {        super(props);        // 与 ES5 React.createClass({}) 不同的是 component 内自定义的方法需要自行绑定 this context，或是使用 arrow function         this.tick = this.tick.bind(this);        // 初始 state，等于 ES5 中的 getInitialState        this.state = {            secondsElapsed: 0,        }    }    // 累加器方法，每一秒被呼叫后就会使用 setState() 更新内部 state，让 Component 重新 render    tick() {        this.setState({secondsElapsed: this.state.secondsElapsed + 1});    }    // componentDidMount 为 component 生命周期中阶段 component 已插入节点的阶段，通常一些非同步操作都会放置在这个阶段。这便是每1秒钟会去呼叫 tick 方法    componentDidMount() {        this.interval = setInterval(this.tick, 1000);    }    // componentWillUnmount 为 component 生命周期中 component 即将移出插入的节点的阶段。这边移除了 setInterval 效力     componentWillUnmount() {        clearInterval(this.interval);    }    // render 为 class Component 中唯一需要定义的方法，其回传 component 欲显示的内容    render() {        return (          &lt;div&gt;Seconds Elapsed: {this.state.secondsElapsed}&lt;/div&gt;        );            }}ReactDOM.render(&lt;Timer /&gt;, document.getElementById(&apos;app&apos;));</code></pre><h3 id="事件处理（Event-Handle）"><a href="#事件处理（Event-Handle）" class="headerlink" title="事件处理（Event Handle）"></a>事件处理（Event Handle）</h3><p>在前面的内容我们已经学会如何使用 props 和 state，接下来我们要更进一步学习在 React 内如何进行事件处理。下列将使用 React 官网的 An Application 当做例子，实作出一个简单的 TodoApp。</p><p>HTML Markup：</p><pre><code>  &lt;meta charset=&quot;utf-8&quot;&gt;  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;&gt;  &lt;title&gt;A Component Using External Plugins&lt;/title&gt;&lt;script src=&quot;https://fb.me/react-15.1.0.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://fb.me/react-dom-15.1.0.js&quot;&gt;&lt;/script&gt;  &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;    &lt;script src=&quot;./app.js&quot;&gt;&lt;/script&gt;</code></pre><p>app.js：</p><pre><code>// TodoApp 元件中包含了显示 Todo 的 TodoList 元件，Todo 的内容透过 props 传入 TodoList 中。由于 TodoList 仅单纯 Render UI 不涉及内部 state 操作是 stateless component，所以使用 Functional Component 写法。需要特别注意的是这边我们用 map function 来迭代 Todos，需要留意的是每个迭代的元素必须要有 unique key 不然会发生错误（可以用自定义 id，或是使用 map function 的第二个参数 index）const TodoList = (props) =&gt; (    &lt;ul&gt;        {            props.items.map((item) =&gt; (                &lt;li key={item.id}&gt;{item.text}&lt;/li&gt;            ))        }    &lt;/ul&gt;)// 整个 App 的主要元件，这边比较重要的是事件处理的部份，内部有class TodoApp extends React.Component {    constructor(props) {        super(props);        this.onChange = this.onChange.bind(this);        this.handleSubmit = this.handleSubmit.bind(this);        this.state = {            items: [],            text: &apos;&apos;,        }    }    onChange(e) {    this.setState({text: e.target.value});            }    handleSubmit(e) {    e.preventDefault();    const nextItems = this.state.items.concat([{text: this.state.text, id: Date.now()}]);    const nextText = &apos;&apos;;    this.setState({items: nextItems, text: nextText});    }    render() {    return (      &lt;div&gt;        &lt;h3&gt;TODO&lt;/h3&gt;        &lt;TodoList items={this.state.items} /&gt;        &lt;form onSubmit={this.handleSubmit}&gt;          &lt;input onChange={this.onChange} value={this.state.text} /&gt;          &lt;button&gt;{&apos;Add #&apos; + (this.state.items.length + 1)}&lt;/button&gt;        &lt;/form&gt;      &lt;/div&gt;    );    }}ReactDOM.render(&lt;TodoApp /&gt;, document.getElementById(&apos;app&apos;));</code></pre><p>以上介绍了 React 事件处理的部份，除了 <code>onChange</code> 和 <code>onSubmit</code> 外，React 也封装了常用的事件处理，如 <code>onClick</code> 等。若想更进一步了解有哪些可以使用的事件处理方法可以参考 <a href="https://facebook.github.io/react/docs/events.html" target="_blank" rel="noopener">官网的 Event System</a>。</p><h3 id="Refs-与表单处理"><a href="#Refs-与表单处理" class="headerlink" title="Refs 与表单处理"></a>Refs 与表单处理</h3><p>上面介绍了 props（传入后就不能修改）、state（随著使用者互动而改变）和事件处理机制后，我们将接续介绍如何在 React 中进行表单处理。同样我们使用 React 官网范例 A Component Using External Plugins 进行介绍。由于 React 可以容易整合外部的 libraries（例如：jQuery），本范例将使用 <code>remarkable</code> 结合 <code>ref</code> 属性取出 DOM Value 值（另外比较常用的作法是使用 <code>onChange</code> 事件处理方式处理表单内容），让使用者可以使用 Markdown 语法的所见即所得编辑器（editor）。</p><p>HTML Markup（记得除了引入 <code>react</code> 和 <code>react-dom</code> 外还要用 <code>CDN</code> 方式引入 <code>remarkable</code> 这个 <code>Markdown</code> 语法 parser 套件）：</p><pre><code>  &lt;meta charset=&quot;utf-8&quot;&gt;  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;&gt;  &lt;title&gt;A Component Using External Plugins&lt;/title&gt;&lt;script src=&quot;https://fb.me/react-15.1.0.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://fb.me/react-dom-15.1.0.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdn.jsdelivr.net/remarkable/1.6.2/remarkable.min.js&quot;&gt;&lt;/script&gt;  &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;    &lt;script src=&quot;./app.js&quot;&gt;&lt;/script&gt;</code></pre><p>app.js：</p><pre><code>class MarkdownEditor extends React.Component {    constructor(props) {        super(props);        this.handleChange = this.handleChange.bind(this);        this.rawMarkup = this.rawMarkup.bind(this);        this.state = {            value: &apos;Type some *markdown* here!&apos;,        }    }    handleChange() {    this.setState({value: this.refs.textarea.value});    }    // 将使用者输入的 Markdown 语法 parse 成 HTML 放入 DOM 中，React 通常使用 virtual DOM 作为和 DOM 沟通的中介，不建议直接由操作 DOM。故使用时的属性为 dangerouslySetInnerHTML    rawMarkup() {    const md = new Remarkable();    return { __html: md.render(this.state.value) };            }    render() {    return (      &lt;div className=&quot;MarkdownEditor&quot;&gt;        &lt;h3&gt;Input&lt;/h3&gt;        &lt;textarea          onChange={this.handleChange}          ref=&quot;textarea&quot;          defaultValue={this.state.value} /&gt;        &lt;h3&gt;Output&lt;/h3&gt;        &lt;div          className=&quot;content&quot;          dangerouslySetInnerHTML={this.rawMarkup()}        /&gt;      &lt;/div&gt;    );        }}ReactDOM.render(&lt;MarkdownEditor /&gt;, document.getElementById(&apos;app&apos;));</code></pre><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>以上透过几个 React 官网首页上的范例介绍了 Props 和 State 特性及在 React 如何进行事件和表单处理这些 React 中核心的问题，若还不熟悉的读者建议重新亲自动手照著范例中的程式码敲过一遍，也可以使用像 <a href="http://jsbin.com/" target="_blank" rel="noopener">jsbin</a> 这样所见即所得的工具来练习，更能熟悉相关语法和 API 喔！接下来我们将探讨 Component 的生命周期。</p><h3 id="延伸阅读"><a href="#延伸阅读" class="headerlink" title="延伸阅读"></a>延伸阅读</h3><ol><li><a href="https://facebook.github.io/react/index.html" target="_blank" rel="noopener">React 官方网站</a></li><li><a href="https://facebook.github.io/react/docs/top-level-api.html" target="_blank" rel="noopener">Top-Level API</a></li></ol><h1 id="React-Component-规格与生命周期（Life-Cycle）"><a href="#React-Component-规格与生命周期（Life-Cycle）" class="headerlink" title="React Component 规格与生命周期（Life Cycle）"></a>React Component 规格与生命周期（Life Cycle）</h1><h3 id="前言-1"><a href="#前言-1" class="headerlink" title="前言"></a>前言</h3><p>经过前面的努力相信目前读者对于用 React 开发一些简单的元件（Component）已经有一定程度的掌握了，现在我们将更细部探讨 React Component 的规格和其生命周期。</p><h3 id="React-Component-规格"><a href="#React-Component-规格" class="headerlink" title="React Component 规格"></a>React Component 规格</h3><p>若读者还有印象的话，我们前面介绍 React 特性时有描述 React 的主要撰写方式有两种：一种是使用 ES6 Class，另外一种是 Stateless Components，使用 Functional Component 的写法，单纯渲染 UI。这边再帮大家複习一下上一个章节的简单范例：</p><ol><li><p>使用 ES6 的 Class（可以进行比较複杂的操作和元件生命周期的控制，相对于 stateless components 耗费资源） <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">    `// 注意元件开头第一个字母都要大写  </span><br><span class="line">    class MyComponent extends React.Component &#123;  </span><br><span class="line">    // render 是 Class based 元件唯一必须的方法（method）  </span><br><span class="line">    render() &#123;  </span><br><span class="line">    return (  </span><br><span class="line">    </span><br><span class="line">    Hello, &#123;this.props.name&#125;</span><br><span class="line">    </span><br><span class="line">      </span><br><span class="line">    );  </span><br><span class="line">    &#125;  </span><br><span class="line">    &#125;`</span><br><span class="line"></span><br><span class="line">``</span><br><span class="line"></span><br><span class="line">// PropTypes 验证，若传入的 props type 不符合将会显示错误  </span><br><span class="line">MyComponent.propTypes = &#123;  </span><br><span class="line">name: React.PropTypes.string,  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Prop 预设值，若对应 props 没传入值将会使用 default 值，为每个实例化 Component 共用的值  </span><br><span class="line">MyComponent.defaultProps = &#123;  </span><br><span class="line">name: &apos;&apos;,  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 将 元件插入 id 为 app 的 DOM 元素中  </span><br><span class="line">ReactDOM.render(, document.getElmentById(&apos;app&apos;));</span><br><span class="line"></span><br><span class="line">    2. 使用 Functional Component 写法（单纯地 render UI 的 stateless components，没有内部状态、没有实作物件和 ref，没有生命周期函数。若非需要控制生命周期的话建议多使用 stateless components 获得比较好的效能）</span><br></pre></td></tr></table></figure></p><p> // 使用 arrow function 来设计 Functional Component 让 UI 设计更单纯（f(D) =&gt; UI），减少副作用（side effect）<br> const MyComponent = (props) =&gt; (</p><pre><code>&lt;div&gt;Hello, {props.name}&lt;/div&gt;</code></pre><p> );</p><p> // PropTypes 验证，若传入的 props type 不符合将会显示错误<br> MyComponent.propTypes = {</p><pre><code>name: React.PropTypes.string,</code></pre><p> }</p><p> // Prop 预设值，若对应 props 没传入值将会使用 default 值<br> MyComponent.defaultProps = {</p><pre><code>name: &apos;&apos;, </code></pre><p> }</p><p> // 将 <mycomponent> 元件插入 id 为 app 的 DOM 元素中<br> ReactDOM.render(<mycomponent name="Mark">, document.getElmentById(‘app’));</mycomponent></mycomponent></p></li></ol><p>值得留意的是在 ES6 Class 中 <code>render()</code> 是唯一必要的方法（但要注意的是请保持 <code>redner()</code> 的纯粹，不要在裡面进行 <code>state</code> 修改或是使用非同步方法和浏览器互动，若需非同步互动请于 <code>componentDidMount()</code> 操作），而 Functional Component 目前允许 <code>return null</code> 值。 喔对了，在 ES6 中也不支援 <code>mixins</code> 複用其他元件的方法了。</p><h3 id="React-Component-生命周期"><a href="#React-Component-生命周期" class="headerlink" title="React Component 生命周期"></a>React Component 生命周期</h3><p>React Component，就像人会有生老病死一样有生命周期。一般而言 Component 有以下三种生命周期的状态：</p><ol><li>Mounting：已插入真实的 DOM</li><li>Updating：正在被重新渲染</li><li>Unmounting：已移出真实的 DOM</li></ol><p>针对 Component 的生命周期状态 React 也有提供对应的处理方法：</p><ol><li>Mounting - componentWillMount()</li></ol><ul><li>componentDidMount()</li></ul><ol start="2"><li>Updating - componentWillReceiveProps(object nextProps)：已载入元件收到新的参数时呼叫</li></ol><ul><li>shouldComponentUpdate(object nextProps, object nextState)：元件判断是否重新渲染时呼叫，起始不会呼叫除非呼叫 forceUpdate()</li><li>componentWillUpdate(object nextProps, object nextState)</li><li>componentDidUpdate(object prevProps, object prevState)</li></ul><ol start="3"><li>Unmounting - componentWillUnmount()</li></ol><p>很多读者一开始学习 Component 生命周期时会觉得很抽象，所以接下来用一个简单范例让大家感受一下 Component 的生命周期。读者可以发现当一开始载入元件时第一个会触发 <code>console.log(&#39;constructor&#39;);</code>，依序执行 <code>componentWillMount</code>、<code>componentDidMount</code> ，而当点击文字触发 <code>handleClick()</code> 更新 <code>state</code> 时则会依序执行 <code>componentWillUpdate</code>、<code>componentDidUpdate</code>：</p><p>HTML Markup：</p><pre><code>&lt;meta charset=&quot;utf-8&quot;&gt;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;&gt;&lt;script src=&quot;https://fb.me/react-15.1.0.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://fb.me/react-dom-15.1.0.js&quot;&gt;&lt;/script&gt;&lt;title&gt;Component LifeCycle&lt;/title&gt;&lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</code></pre><p>Component 生命周期展示：</p><pre><code>class MyComponent extends React.Component {  constructor(props) {    super(props);    console.log(&apos;constructor&apos;);    this.handleClick = this.handleClick.bind(this);    this.state = {      name: &apos;Mark&apos;,    }  }  handleClick() {    this.setState({&apos;name&apos;: &apos;Zuck&apos;});  }  componentWillMount() {    console.log(&apos;componentWillMount&apos;);  }  componentDidMount() {    console.log(&apos;componentDidMount&apos;);  }  componentWillReceiveProps() {    console.log(&apos;componentWillReceiveProps&apos;);  }  componentWillUpdate() {    console.log(&apos;componentWillUpdate&apos;);  }  componentDidUpdate() {    console.log(&apos;componentDidUpdate&apos;);  }  componentWillUnmount() {    console.log(&apos;componentWillUnmount&apos;);  }  render() {    return (      &lt;div onClick={this.handleClick}&gt;Hi, {this.state.name}&lt;/div&gt;    );  }}ReactDOM.render(&lt;MyComponent /&gt;, document.getElementById(&apos;app&apos;));</code></pre><p><a href="http://jsbin.com/yokebo/embed?html,js,console,output" target="_blank" rel="noopener">点击看详细范例</a></p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/react-lifecycle.png" alt="React Component 规格与生命周期"></p><p>其中特殊处理的函数 <code>shouldComponentUpdate</code>，目前预设 <code>return true</code>。若你想要优化效能可以自己编写判断方式，若採用 <code>immutable</code> 可以使用 <code>nextProps === this.props</code> 比对是否有变动：</p><pre><code>shouldComponentUpdate(nextProps, nextState) {  return nextProps.id !== this.props.id;}</code></pre><h3 id="Ajax-非同步处理"><a href="#Ajax-非同步处理" class="headerlink" title="Ajax 非同步处理"></a>Ajax 非同步处理</h3><p>若有需要进行 Ajax 非同步处理，请在 <code>componentDidMount</code> 进行处理。以下透过 <code>jQuery</code> 执行 <code>Ajax</code> 取得 <code>Github API</code>　资料当做范例：</p><p>HTML Markup：</p><pre><code>&lt;meta charset=&quot;utf-8&quot;&gt;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;&gt;&lt;script src=&quot;https://fb.me/react-15.1.0.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://fb.me/react-dom-15.1.0.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://code.jquery.com/jquery-3.1.0.js&quot;&gt;&lt;/script&gt;&lt;title&gt;GitHub User&lt;/title&gt;&lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</code></pre><p>app.js</p><pre><code>class UserGithub extends React.Component {    constructor(props) {        super(props);        this.state = {          username: &apos;&apos;,          githubtUrl: &apos;&apos;,          avatarUrl: &apos;&apos;,        }    }    componentDidMount() {        $.get(this.props.source, (result) =&gt; {            console.log(result);            const data = result;            if (data) {              this.setState({                    username: data.name,                    githubtUrl: data.html_url,                    avatarUrl: data.avatar_url              });            }        });    }    render() {        return (          &lt;div&gt;            &lt;h3&gt;{this.state.username}&lt;/h3&gt;            &lt;img src={this.state.avatarUrl} /&gt;            &lt;a href={this.state.githubtUrl}&gt;Github Link&lt;/a&gt;.          &lt;/div&gt;        );    }}ReactDOM.render(  &lt;UserGithub source=&quot;https://api.github.com/users/torvalds&quot; /&gt;,  document.getElementById(&apos;app&apos;));</code></pre><p><a href="http://jsbin.com/kupusa/embed?html,js,output" target="_blank" rel="noopener">点击看详细范例</a></p><h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><p>以上介绍了 React Component 规格与生命周期（Life Cycle）的概念，其中生命周期的概念对于初学者来说可能会比较抽象，建议读者跟著范例动手实作。接下来我们将更进一步介绍 <code>React Router</code> 让读者感受一下单页式应用程式（single page application）的设计方式。</p><h3 id="延伸阅读-1"><a href="#延伸阅读-1" class="headerlink" title="延伸阅读"></a>延伸阅读</h3><ol><li><a href="https://facebook.github.io/react/docs/component-specs.html#lifecycle-methods" target="_blank" rel="noopener">Component Specs and Lifecycle</a></li></ol><p><code></code></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>R03-React/JSX/Component 简介</title>
      <link href="/reactjs-getting-started-3.html"/>
      <url>/reactjs-getting-started-3.html</url>
      
        <content type="html"><![CDATA[<h1 id="ReactJS-与-Component-设计入门介绍"><a href="#ReactJS-与-Component-设计入门介绍" class="headerlink" title="ReactJS 与 Component 设计入门介绍"></a>ReactJS 与 Component 设计入门介绍</h1><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在上一个章节中我们快速学习了 React 开发环境建置和 Webpack 入门。接下来我们将更进一步了解 React 和 Component 设计时需注意的几个重要特性。</p><h3 id="ReactJS-特性简介"><a href="#ReactJS-特性简介" class="headerlink" title="ReactJS 特性简介"></a>ReactJS 特性简介</h3><p>React 原本是 Facebook 自己内部使用的开发工具，但却是一个目标远大的一个专案：<code>Learn once, write anywhere</code>。自从 2013 年开源后周边的生态系更是蓬勃发展。ReactJS 的出现让前端开发有许多革新性的思维出现，其中有几个重要特性值得我们去探讨：</p><ol><li>基于元件（Component）化思考</li><li>用 JSX 进行宣告式（Declarative）UI 设计</li><li>使用 Virtual DOM</li><li>Component PropType 防呆机制</li><li>Component 就像个状态机（State Machine），而且也有生命週期（Life Cycle）</li><li>一律重绘（Always Redraw）和单向资料流（Unidirectional Data Flow）</li><li>在 JavaScript 裡写 CSS：Inline Style</li></ol><h3 id="基于元件（Component）化思考"><a href="#基于元件（Component）化思考" class="headerlink" title="基于元件（Component）化思考"></a>基于元件（Component）化思考</h3><p><img src="https://res.i95.me/wp-content/uploads/2016/09/component.png" alt="ReactJS 与 Component 设计入门介绍"></p><p>在 React 的世界中最基本的单元为元件（Component），每个元件也可以包含一个以上的子元件，并依照需求组装成一个组合式的（Composable）元件，因此具有封装（encapsulation）、关注点分离 (Separation of Concerns)、複用 (Reuse) 、组合 (Compose) 等特性。</p><p><code>&lt;TodoApp&gt;</code> 元件可以包含 <code>&lt;TodoHeader /&gt;</code>、<code>&lt;TodoList /&gt;</code> 子元件</p><pre><code>&lt;div&gt;    &lt;TodoHeader /&gt;    &lt;TodoList /&gt;&lt;/div&gt;</code></pre><p><code>&lt;TodoList /&gt;</code> 元件内部长相：</p><pre><code>&lt;div&gt;    &lt;ul&gt;        &lt;li&gt;写程式码&lt;/li&gt;        &lt;li&gt;哄妹子&lt;/li&gt;        &lt;li&gt;买书&lt;/li&gt;    &lt;/ul&gt;&lt;/div&gt;</code></pre><p>元件化一直是网页前端开发的圣杯，许多开发者最希望的就是可以最大化重複使用（reuse）过去所写的程式码，不要重複造轮子（DRY）。在 React 中元件是一切的基础，让开发应用程式就好像在堆积木一样。然而对于过去习惯模版式（template）开发的前端工程师来说，短时间要转换成元件化思考模式并不容易，尤其过去我们往往习惯于将 HTML、CSS 和 JavaScript 分离，现在却要把它们都封装在一起。</p><p>一个比较好的方式就是训练自己看到不同的网页或应用程式时，强迫自己将看到的页面切成一个个元件。相信过了一段时间后，天眼开了，就比较容易习惯元件化的思考方式。</p><p>以下是一般 React Component 撰写的主要两种方式：</p><ol><li><p>使用 ES6 的 Class（可以进行比较複杂的操作和元件生命週期的控制，相对于 stateless components 耗费资源） <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">    `// 注意元件开头第一个字母都要大写  </span><br><span class="line">    class MyComponent extends React.Component &#123;  </span><br><span class="line">    // render 是 Class based 元件唯一必须的方法（method）  </span><br><span class="line">    render() &#123;  </span><br><span class="line">    return (  </span><br><span class="line">    </span><br><span class="line">    Hello, World!</span><br><span class="line">    </span><br><span class="line">      </span><br><span class="line">    );  </span><br><span class="line">    &#125;  </span><br><span class="line">    &#125;`</span><br><span class="line"></span><br><span class="line">``</span><br><span class="line"></span><br><span class="line">// 将 元件插入 id 为 app 的 DOM 元素中  </span><br><span class="line">ReactDOM.render(, document.getElementById(&apos;app&apos;));</span><br><span class="line"></span><br><span class="line">    2. 使用 Functional Component 写法（单纯地 render UI 的 stateless components，没有内部状态、没有实作物件和 ref，没有生命週期函数。若非需要控制生命週期的话建议多使用 stateless components 获得比较好的效能）</span><br></pre></td></tr></table></figure></p><p> // 使用 arrow function 来设计 Functional Component 让 UI 设计更单纯（f(D) =&gt; UI），减少副作用（side effect）<br> const MyComponent = () =&gt; (</p><pre><code>&lt;div&gt;Hello, World!&lt;/div&gt;</code></pre><p> );</p><p> // 将 <mycomponent> 元件插入 id 为 app 的 DOM 元素中<br> ReactDOM.render(<mycomponent>, document.getElementById(‘app’));</mycomponent></mycomponent></p></li></ol><h3 id="用-JSX-进行宣告式（Declarative）UI-设计"><a href="#用-JSX-进行宣告式（Declarative）UI-设计" class="headerlink" title="用 JSX 进行宣告式（Declarative）UI 设计"></a>用 JSX 进行宣告式（Declarative）UI 设计</h3><p>React 在设计上的思路认为使用 Component 比起模版（Template）和显示逻辑（Display Logic）更能实现关注点分离的概念，而搭配 JSX 可以实现声明式 Declarative（注重 what to），而非命令式 Imperative（注重 how to）的程式撰写方式。</p><p>像下述的宣告式（Declarative）UI 设计就比单纯用（Template）式的方式更易懂：</p><pre><code>// 使用宣告式（Declarative）UI 设计很容易可以看出这个元件的功能&lt;MailForm /&gt;// &lt;MailForm /&gt; 内部长相&lt;form&gt;    &lt;input type=&quot;text&quot; name=&quot;email&quot;&gt;    &lt;button type=&quot;submit&quot;&gt;&lt;/button&gt;&lt;/form&gt;</code></pre><p>由于 JSX 在 React 元件撰写上扮演很重要的角色，因此在下一个章节我们也将更深入讲解 JSX 使用细节。</p><h3 id="使用-Virtual-DOM"><a href="#使用-Virtual-DOM" class="headerlink" title="使用 Virtual DOM"></a>使用 Virtual DOM</h3><p>在传统 Web 中一般是使用 jQuery 进行 DOM 的直接操作。然而更改 DOM 往往是 Web 效能的瓶颈，因此在 React 世界设计有 Virtual DOM 的机制，让 App 和 DOM 之间用 Virtual DOM 进行沟通。当更改 DOM 时，会透过 React 自身的 diff 演算法去计算出最小更新，进而去最小化更新真实的 DOM。</p><h3 id="Component-PropType-防呆机制"><a href="#Component-PropType-防呆机制" class="headerlink" title="Component PropType 防呆机制"></a>Component PropType 防呆机制</h3><p>在 React 设计时除了提供 props 预设值设定（Default Prop Values）外，也提供了 Prop 的验证（Validation）机制，让整个 Component 设计更加稳健：</p><pre><code>//  注意元件开头第一个字母都要大写class MyComponent extends React.Component {    // render 是 Class based 元件唯一必须的方法（method）    render() {        return (            &lt;div&gt;Hello, World!&lt;/div&gt;        );    }}// PropTypes 验证，若传入的 props type 不符合将会显示错误MyComponent.propTypes = {  todo: React.PropTypes.object,  name: React.PropTypes.string,}// Prop 预设值，若对应 props 没传入值将会使用 default 值MyComponent.defaultProps = { todo: {},  name: &apos;&apos;, }</code></pre><p>关于更多的 Validation 用法可以参考<a href="https://facebook.github.io/react/docs/reusable-components.html" target="_blank" rel="noopener">官方网站</a> 的说明。</p><h3 id="Component-就像个状态机（State-Machine），而且也有生命週期（Life-Cycle）"><a href="#Component-就像个状态机（State-Machine），而且也有生命週期（Life-Cycle）" class="headerlink" title="Component 就像个状态机（State Machine），而且也有生命週期（Life Cycle）"></a>Component 就像个状态机（State Machine），而且也有生命週期（Life Cycle）</h3><p>Component 就像个状态机（State Machine），根据不同的 state（透过 <code>setState()</code> 修改）和 props（由父元素传入），Component 会出现对应的显示结果。而人有生老病死，元件也有生命週期。透过操作生命週期处理函数，可以在对应的时间点进行 Component 需要的处理，关于更详细的元件生命週期介绍我们会再下一个章节进行更一步说明。</p><h3 id="一律重绘（Always-Redraw）和单向资料流（Unidirectional-Data-Flow）"><a href="#一律重绘（Always-Redraw）和单向资料流（Unidirectional-Data-Flow）" class="headerlink" title="一律重绘（Always Redraw）和单向资料流（Unidirectional Data Flow）"></a>一律重绘（Always Redraw）和单向资料流（Unidirectional Data Flow）</h3><p>在 React 世界中，props 和 state 是影响 React Component 长相的重要要素。其中 props 都是由父元素所传进来，不能更改，若要更改 props 则必须由父元素进行更改。而 state 则是根据使用者互动而产生的不同状态，主要是透过 setState() 方法进行修改。当 React 发现 props 或是 state 更新时，就会重绘整个 UI。当然你也可以使用 forceUpdate() 去强迫重绘 Component。而 React 透过整合 Flux 或 Flux-like（例如：Redux）可以更具体实现单向资料流（Unidirectional Data Flow），让资料流的管理更为清晰。</p><h3 id="在-JavaScript-裡写-CSS：Inline-Style"><a href="#在-JavaScript-裡写-CSS：Inline-Style" class="headerlink" title="在 JavaScript 裡写 CSS：Inline Style"></a>在 JavaScript 裡写 CSS：Inline Style</h3><p>在 React Component 中 CSS 使用 Inline Style 写法，全都封装在 JavaScript 当中：</p><pre><code>const divStyle = {  color: &apos;red&apos;,  backgroundImage: &apos;url(&apos; + imgUrl + &apos;)&apos;,};ReactDOM.render(&lt;div style={divStyle}&gt;Hello World!&lt;/div&gt;, document.getElementById(&apos;app&apos;));</code></pre><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>以上介绍了 ReactJS 的几个重要特性：</p><ol><li>基于元件（Component）化思考</li><li>用 JSX 进行宣告式（Declarative）UI 设计</li><li>使用 Virtual DOM</li><li>Component PropType 防呆机制</li><li>Component 就像个状态机（State Machine），而且也有生命週期（Life Cycle）</li><li>一律重绘（Always Redraw）和单向资料流（Unidirectional Data Flow）</li><li>在 JavaScript 裡写 CSS：Inline Style</li></ol><p>接下来我们将进一步探讨 React 裡 JSX 的使用方式。</p><h3 id="延伸阅读"><a href="#延伸阅读" class="headerlink" title="延伸阅读"></a>延伸阅读</h3><ol><li><a href="http://www.ruanyifeng.com/blog/2015/03/react.html" target="_blank" rel="noopener">React 入门实例教程</a></li><li><a href="http://blog.reverberate.org/2014/02/react-demystified.html" target="_blank" rel="noopener">React Demystified</a></li><li><a href="https://facebook.github.io/react/docs/top-level-api.html" target="_blank" rel="noopener">Top-Level API</a></li><li><a href="https://facebook.github.io/react/docs/reusable-components.html#es6-classes" target="_blank" rel="noopener">ES6 Classes Component</a></li></ol><hr><h1 id="JSX-简明入门教学指南"><a href="#JSX-简明入门教学指南" class="headerlink" title="JSX 简明入门教学指南"></a>JSX 简明入门教学指南</h1><p><img src="https://res.i95.me/wp-content/uploads/2016/09/reactjs.png" alt="JSX 简明入门教学指南"></p><h2 id="前言-1"><a href="#前言-1" class="headerlink" title="前言"></a>前言</h2><p>根据 <a href="https://facebook.github.io/react/" target="_blank" rel="noopener">React</a> 官方定义，React 是一个构建使用者介面的 JavaScritp Library。以 MVC 模式来说，ReactJS 主要是负责 View 的部份。过去一段时间，我们被灌输了许多前端分离的观念，在前端三兄弟中（或三姊妹、三剑客）：HTML 掌管内容结构、CSS 负责外观样式，JavaScript 主管逻辑互动，千万不要混在一块。然而，在 React 世界裡，所有事物都是 以 Component 为基础，将同一个 Compoent 相关的程式和资源都放在一起，而在撰写 React Component 时我们通常会使用 <a href="https://facebook.github.io/jsx/" target="_blank" rel="noopener">JSX</a> 的方式来提升程式撰写效率。事实上，JSX 并非一种全新的语言，而是一种语法糖（<a href="https://en.wikipedia.org/wiki/Syntactic_sugar" target="_blank" rel="noopener">Syntatic Sugar</a>），一种语法类似 <a href="https://zh.wikipedia.org/wiki/XML" target="_blank" rel="noopener">XML</a> 的 ECMAScript 语法扩充。在 JSX 中 HTML 和组建这些元素标籤的程式码有紧密的关系。因此你可能要熟悉一下以 Component 为单位的思考方式（本文主要使用 ES6 语法）。</p><p>此外，React 和 JSX 的思维在于善用 JavaScript 的强大能力，放弃蹩脚的模版语言，这和 <a href="https://angularjs.org/" target="_blank" rel="noopener">Angular</a> 强化 HTML 的理念也有所不同。当然 JSX 并非强制使用，你也可以选择不用，因为最终 JSX 的内容会转化成 JavaScript（浏览器只看的懂 JavaScript）。不过等你阅读完接下来的内容，你或许会开始发现 JSX 的好，认真考虑使用 JSX 的语法。</p><h3 id="一、使用-JSX-的好处"><a href="#一、使用-JSX-的好处" class="headerlink" title="一、使用 JSX 的好处"></a>一、使用 JSX 的好处</h3><blockquote><ol><li>提供更加语意化且易懂的标籤 由于 JSX 类似 XML 的语法，让一些非开发人员也更容易看懂，且能精确定义包含属性的树状结构。一般来说我们想做一个回馈表单，使用 HTML 写法通常会长这样：</li></ol></blockquote><pre><code>&lt;form class=&quot;messageBox&quot;&gt;  &lt;textarea&gt;&lt;/textarea&gt;  &lt;button type=&quot;submit&quot;&gt;&lt;/button&gt;&lt;/form&gt;</code></pre><p>使用 JSX，就像 XML 语法结构一样可以自行定义标籤且有开始和关闭，容易理解：</p><pre><code>&lt;MessageBox /&gt;</code></pre><p>React 思路认为使用 Component 比起模版（Template）和显示逻辑（Display Logic）更能实现关注点分离的概念，而搭配 JSX 可以实现声明式 <code>Declarative</code>（注重 what to），而非命令式 <code>Imperative</code>（注重 how to）的程式撰写方式：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/fb_like.jpg" alt="Facebook 上面按讚功能"></p><p>以 Facebook 上面按讚功能来说，若是命令式 <code>Imperative</code> 写法大约会是长这样：</p><pre><code>if(userLikes()) {  if(!hasBlueLike()) {    removeGrayLike();    addBlueLike();  }} else {  if(hasBlueLike()) {    removeBlueLike();    addGrayLike();  }}</code></pre><p>若是声明式 <code>Declarative</code> 则是会长这样：</p><pre><code>if(this.state.liked) {  return (&lt;BlueLike /&gt;);} else {  return (&lt;GrayLike /&gt;);}</code></pre><p>看完上述说明是不是感觉 <code>React</code> 结合 <code>JSX</code> 的写法更易读易懂？事实上，当 Component 组成越来越複杂时，若使用 JSX 将可以让整个结构更加直观，可读性较高。</p><blockquote><ol><li>更加简洁 虽然最终 JSX 会转换成 JavaScript，但使用 JSX 可以让程式看起来更加简洁，以下为使用 JSX 和不使用 JSX 的范例：</li></ol></blockquote><pre><code>&lt;a href=&quot;https://facebook.github.io/react/&quot;&gt;Hello!&lt;/a&gt;</code></pre><p>不使用 JSX（记得我们说过 JSX 是选用的）：</p><pre><code>// React.createElement(元件/HTML标籤, 元件属性，以物件表示, 子元件)React.createElement(&apos;a&apos;, {href: &apos;https://facebook.github.io/react/&apos;}, &apos;Hello!&apos;)</code></pre><blockquote><ol><li>结合原生 JavaScript 语法 JSX 并非一种全新的语言，而是一种语法糖（Syntatic Sugar），一种语法类似 XML 的 ECMAScript 语法扩充，所以并没有改变 JavaScript 语意。透过结合 JavaScript ，可以释放 JavaScript 语言本身能力。下面例子就是运用 <code>map</code> 方法，轻易把 <code>result</code> 值迭代出来，产生无序清单（ul）的内容，不用再使用蹩脚的模版语言（这边有个小地方要留意的是每个 <code>&lt;li&gt;</code> 元素记得加上独特的 key 这边用 map function 迭代出的 index，不然会出现问题）：</li></ol></blockquote><pre><code>// const 为常数const lists = [&apos;JavaScript&apos;, &apos;Java&apos;, &apos;Node&apos;, &apos;Python&apos;];class HelloMessage extends React.Compoent {  render() {    return (    &lt;ul&gt;      {lists.map((result, index) =&gt; {        return (&lt;li key={index}&gt;{result}&lt;/li&gt;);      })}    &lt;/ul&gt;);  }}</code></pre><h3 id="二、JSX-用法摘要"><a href="#二、JSX-用法摘要" class="headerlink" title="二、JSX 用法摘要"></a>二、JSX 用法摘要</h3><blockquote><ol><li>环境设定与使用方式 初步了解为何要使用 JSX 后，我们来聊聊 JSX 的用法。一般而言 JSX 通常有两种使用方式：</li></ol></blockquote><ol><li>使用 <a href="http://browserify.org/" target="_blank" rel="noopener">browserify</a> 或 <a href="https://webpack.github.io/" target="_blank" rel="noopener">webpack</a> 等 <a href="https://en.wikipedia.org/wiki/CommonJS" target="_blank" rel="noopener">CommonJS</a> bundler 并整合 <a href="https://babeljs.io/" target="_blank" rel="noopener">babel</a> 预处理</li><li>于浏览器端做解析</li></ol><p>在这边简单起见，我们先使用第二种方式，先让大家专注熟悉 JSX 语法使用，等到后面章节再教大家使用 bundler 的方式去做解析（可以试著把下面的原始码贴到 <a href="http://jsbin.com/" target="_blank" rel="noopener">JSbin</a> 的 HTML 看结果）：</p><pre><code>&lt;meta charset=&quot;UTF-8&quot; /&gt;&lt;title&gt;Hello React!&lt;/title&gt;&lt;!-- 请先于 index.html 中引入 react.js, react-dom.js 和 babel-core 的 browser.min.js --&gt;&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/react/15.0.1/react.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/react/15.0.1/react-dom.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js&quot;&gt;&lt;/script&gt;&lt;div id=&quot;example&quot;&gt;&lt;/div&gt;&lt;script type=&quot;text/babel&quot;&gt;  // 程式码写在这边！  ReactDOM.render(    &lt;h1&gt;Hello, world!&lt;/h1&gt;,    document.getElementById(&apos;example&apos;)  );&lt;/script&gt;</code></pre><p>一般载入 JSX 方式有：</p><ul><li><p>内嵌</p><script type="text/babel">  ReactDOM.render(    <h1>Hello, world!</h1>,    document.getElementById('example')  );</script></li></ul><ul><li>从外部引入</li></ul><p><code>&lt;script type=&quot;text/jsx&quot; src=&quot;main.jsx&quot;&gt;&lt;/script&gt;</code></p><blockquote><ol><li>标籤用法 JSX 标籤非常类似 XML ，可以直接书写。一般 Component 命名首字大写，HTML Tags 小写。以下是一个建立 Component 的 class：</li></ol></blockquote><pre><code>class HelloMessage extends React.Compoent {  render() {    return (      &lt;div&gt;        &lt;p&gt;Hello React!&lt;/p&gt;        &lt;MessageList /&gt;      &lt;/div&gt;    );  }}</code></pre><blockquote><ol><li>转换成 JavaScript</li></ol></blockquote><p>JSX 最终会转换成浏览器可以读取的 JavaScript，以下为其规则：</p><pre><code>React.createElement(  string/ReactClass, // 表示 HTML 元素或是 React Component  [object props], // 属性值，用物件表示  [children] // 接下来参数皆为元素子元素)</code></pre><p>解析前（特别注意在 JSX 中使用 JavaScript 表达式时使用 <code>{}</code> 括起，如下方范例的 <code>text</code>，裡面对应的是变数。若需希望放置一般文字，请加上 <code>&#39;&#39;</code>）：</p><pre><code>var text = &apos;Hello React&apos;;&lt;h1&gt;{text}&lt;/h1&gt;&lt;h1&gt;{&apos;text&apos;}&lt;/h1&gt;</code></pre><p>解析完后：</p><pre><code>var text = &apos;Hello React&apos;;React.createElement(&quot;h1&quot;, null, &quot;Hello React!&quot;);</code></pre><p>另外要特别要注意的是由于 JSX 最终会转成 JavaScript 且每一个 JSX 节点都对应到一个 JavaScript 函数，所以在 Component 的 <code>render</code> 方法中只能回传一个根节点（Root Nodes）。例如：若有多个 <code>&lt;div&gt;</code> 要 <code>render</code> 请在外面包一个 Component 或 <code>&lt;div&gt;</code>、<code>&lt;span&gt;</code> 元素。</p><blockquote><ol><li>注解 由于 JSX 最终会编译成 JavaScript，注解也一样使用 <code>//</code> 和 <code>/**/</code> 当做注解方式：</li></ol></blockquote><pre><code>// 单行注解/*  多行注解*/var content = (  &lt;List&gt;      {/* 若是在子元件注解要加 {}  */}      &lt;Item        /* 多行           注解           喔 */        name={window.isLoggedIn ? window.name : &apos;&apos;} // 单行注解      /&gt;  &lt;/List&gt;);</code></pre><blockquote><ol><li>属性 在 HTML 中，我们可以透过标籤上的属性来改变标籤外观样式，在 JSX 中也可以，但要注意 <code>class</code> 和 <code>for</code> 由于为 JavaScript 保留关键字用法，因此在 JSX 中使用 <code>className</code> 和 <code>htmlFor</code> 替代。</li></ol></blockquote><pre><code>class HelloMessage extends React.Compoent {  render() {    return (      &lt;div className=&quot;message&quot;&gt;        &lt;p&gt;Hello React!&lt;/p&gt;      &lt;/div&gt;    );  }}</code></pre><blockquote><p>Boolean 属性 在 JSX 中预设只有属性名称但没设值为 <code>true</code>，例如以下第一个 input 标籤 <code>disabled</code> 虽然没设值，但结果和下面的 input 为相同：</p></blockquote><pre><code>&lt;input type=&quot;button&quot; disabled /&gt;;&lt;input type=&quot;button&quot; disabled={true} /&gt;;</code></pre><p>反之，若是没有属性，则预设预设为 <code>false</code>：</p><pre><code>&lt;input type=&quot;button&quot; /&gt;;&lt;input type=&quot;button&quot; disabled={false} /&gt;;</code></pre><blockquote><ol><li>扩展属性 在 ES6 中使用 <code>...</code> 是迭代物件的意思，可以把所有物件对应的值迭代出来设定属性，但要注意后面设定的属性会盖掉前面相同属性：</li></ol></blockquote><pre><code>var props = {  style: &quot;width:20px&quot;,  className: &quot;main&quot;,  value: &quot;yo&quot;,  }&lt;HelloMessage  {...props} value=&quot;yo&quot; /&gt;// 等于以下React.createElement(&quot;h1&quot;, React._spread({}, props, {value: &quot;yo&quot;}), &quot;Hello React!&quot;);</code></pre><blockquote><ol><li>自定义属性 若是希望使用自定义属性，可以使用 <code>data-</code>：</li></ol></blockquote><pre><code>&lt;HelloMessage data-attr=&quot;xd&quot; /&gt;</code></pre><blockquote><ol><li>显示 HTML 通常为了避免资讯安全问题，我们会过滤掉 HTML，若需要显示的话可以使用：</li></ol></blockquote><pre><code>&lt;div&gt;{ {_html: &apos;&lt;h1&gt;Hello World!!&lt;/h1&gt;&apos;}}&lt;/div&gt;</code></pre><blockquote><ol><li>样式使用 在 JSX 中使用外观样式方法如下，第一个 <code>{}</code> 是 JSX 语法，第二个为 JavaScript 物件。与一般属性值用 <code>-</code> 分隔不同，为驼峰式命名写法：</li></ol></blockquote><pre><code>&lt;HelloMessage style={ { color: &apos;#FFFFFF&apos;, fontSize: &apos;30px&apos;}} /&gt;</code></pre><blockquote><ol><li>事件处理 事件处理为前端开发的重头戏，在 JSX 中透过 inline 事件的绑定来监听并处理事件（注意也是驼峰式写法），更多事件处理方法请<a href="https://facebook.github.io/react/docs/events.html#supported-events" target="_blank" rel="noopener">参考官网</a></li></ol></blockquote><pre><code>&lt;HelloMessage onClick={this.onBtn} /&gt;</code></pre><h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><p>以上就是 JSX 简明入门教学，希望透过以上介绍，让读者了解在 React 中为何要使用 JSX，以及 JSX 基本概念和用法。最后为大家複习一下：在 React 世界裡，所有事物都是以 Component 为基础，通常会将同一个 Compoent 相关的程式和资源都放在一起，而在撰写 React Component 时我们常会使用 <a href="https://facebook.github.io/jsx/" target="_blank" rel="noopener">JSX</a> 的方式来提升程式撰写效率。JSX 是一种语法类似 XML 的 ECMAScript 语法扩充，可以善用 JavaScript 的强大能力，放弃蹩脚的模版语言。当然 JSX 并非强制使用，你也可以选择不用，因为最终 JSX 的内容会转化成 JavaScript。当相信阅读完上述的内容后，你会开始认真考虑使用 JSX 的语法。</p><h3 id="延伸阅读-1"><a href="#延伸阅读-1" class="headerlink" title="延伸阅读"></a>延伸阅读</h3><ol><li><a href="http://www.puritys.me/docs-blog/article-320-Imperative-programming-or-declarative-programming.html" target="_blank" rel="noopener">Imperative programming or declarative programming</a></li><li><a href="https://facebook.github.io/react/docs/jsx-in-depth.html" target="_blank" rel="noopener">JSX in Depth</a></li><li><a href="https://www.gitbook.com/book/kdchang/react101/details" target="_blank" rel="noopener">从零开始学 React（ReactJS 101）</a></li></ol><p><code></code></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>微信应用号时代正式开启！</title>
      <link href="/wechat-applications-open-era.html"/>
      <url>/wechat-applications-open-era.html</url>
      
        <content type="html"><![CDATA[<h3 id="微信应用号最新消息"><a href="#微信应用号最新消息" class="headerlink" title="微信应用号最新消息"></a>微信应用号最新消息</h3><p><strong>现在，应用号暂定名为小程序，已经开始进行内测。</strong></p><p>整个App行业生态的格局或将迎来巨大改变，千亿级市场风口已经正式开启。</p><p>这时肯定有朋友要问了：说得一惊一乍的，微信应用号到底是什么？它的出现会带来什么影响呢？接下来本篇文章为大家进行全面解析。</p><h3 id="什么是微信应用号？"><a href="#什么是微信应用号？" class="headerlink" title="什么是微信应用号？"></a>什么是微信应用号？</h3><p><strong>微信应用号，就是微信现在开始进行内测的小程序。</strong>小程序是一种不需要下载安装即可使用的应用，它实现了应用“触手可及”的梦想，用户扫一扫或者搜一下即可打开应用。也体现了“用完即走”的理念，用户不用关心是否安装太多应用的问题。应用将无处不在，随时可用，但又无需安装卸载。</p><p>简单来说就是，微信将会成为一个超级App。而各种传统App则以应用号的形式内嵌在微信里面，这样以后大家再也不用安装满屏幕的App，却因为使用频率低而占手机内存了。需要使用打车、购物、买电影票等服务功能时，只需要打开微信找相应的应用号就可以了。听起来是不是特别方便？</p><h3 id="微信应用号开放了哪些接口？"><a href="#微信应用号开放了哪些接口？" class="headerlink" title="微信应用号开放了哪些接口？"></a>微信应用号开放了哪些接口？</h3><p>微信既然做小程序，肯定会将微信本身的一些接口权限开放出来。目前已知的有以下接口：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/201609221703507598.png" alt></p><p>从内测信息来看，小程序在通过向开发者开放多种服务及支撑能力以实现以上设想，主要面向开发者，这些服务和支撑能力包括：</p><p><strong>视图容器：</strong>视图(View)、滚动视图、Swiper（说明：本地UI样式，可使应用号快速加载，提升用户体验）</p><p><strong>基础内容：</strong>图标、文本、进度条（说明：丰富的UI接口，迅速开发应用号）</p><p><strong>表单组件：</strong>按钮、表单等等（说明：可用于收集用户信息）</p><p><strong>地图位置服务</strong>：<em>**</em>可开发基于位置的功能，如附近的美食</p><p><strong>操作反馈</strong></p><p><strong>导航</strong></p><p><strong>媒体组件：</strong>音频、图片、视频</p><p><strong>画布：</strong>可用于开发游戏</p><p><strong>文件操作能力</strong></p><p><strong>网络：</strong>上传下载能力、WebSocket</p><p><strong>数据：</strong>数据缓存能力</p><p><strong>位置：</strong>获取位置、查看位置</p><p><strong>设备：</strong>网络状态、系统信息、重力感应、罗盘</p><p><strong>界面：</strong>设置导航条、导航、动画、绘图等等</p><p><strong>开放接口：</strong>登录，包括签名加密，用户信息、微信支付、模板消息</p><p>据腾讯科技消息，此次微信小程序内测资格面向服务号开放，首批有200个内测名额。</p><p>微信应用号会带来什么影响</p><p><strong>1.手机App行业格局将迎来重大改变</strong></p><p>微信应用号能够取代用户大部分不经常用的APP，提供APP的各种功能。这样不仅大大节省了用户的手机空间，还能简化各种繁琐的App服务，实现WebAPP服务的规模化。</p><p><strong>2.或让微商行业重新洗牌</strong></p><p>有了微信应用号，只会天天晒订单的微商将会死于无形；而真正有实力活下来的，是花时间与精力在如何运营好一个微信应用号的微商。</p><p><strong>3.强大的社交属性，让品牌服务更加多元化</strong></p><p>微信本身就是一款具有强大社交属性的应用，微信应用号推出后，微信就有了另外一重功能服务的身份。各品牌企业也许要重新思考，到底是继续坚持运营传播常规化内容的订阅号和服务号，还是准备转型运营可以提供强大功能和服务的应用号？</p><h3 id="微信团队官方解答"><a href="#微信团队官方解答" class="headerlink" title="微信团队官方解答"></a>微信团队官方解答</h3><p>对于外界关注的问题，微信团队也进行了一些解答：</p><p>**Q：小程序是什么？它有着什么样的功能？ **</p><p>A：小程序是一种不需要下载安装即可使用的应用，它实现了应用“触手可及”的梦想，用户扫一扫或者搜一下即可打开应用。也体现了“用完即走”的理念，用户不用关心是否安装太多应用的问题。应用将无处不在，随时可用，但又无需安装卸载。 下一步将全面开放申请</p><p><strong>Q：我是一个开发者，目前没有收到小程序的测试邀请，有什么渠道可以申请注册小程序？</strong></p><p>A：目前，小程序仍然处于内测阶段。全面开放申请后，主体类型为个人、企业、政府、媒体或其他组织的开发者，均可申请注册小程序。</p><p><strong>Q：现在已经有部分帐号收到小程序的内测邀请了，接下来是否会继续开放内测邀请？</strong></p><p>A：关于小程序的上线节奏：本次内测采用邀请制，其内容客户端暂时对用户不可见。之后小程序会全面开放申请，所有小程序将在统一时间向用户开放。</p><p><strong>Q：小程序可以和现有的 App 打通吗？</strong></p><p>A：小程序可以借助微信联合登录，和开发者已有的 App 后台的用户数据进行打通，但不会支持小程序和 App 直接的跳转。 小程序提供全新平台</p><p><strong>Q：微信已经有了订阅号、服务号、企业号，小程序和这三者有什么不同？</strong></p><p>A：小程序、订阅号、服务号、企业号目前是并行的体系。</p><p>**Q：外界有说法称，小程序的推出意味着微信要做一个应用分发市场，是这样吗？ **</p><p>A：微信推出小程序，并非想要做应用分发市场，而是给一些优质服务提供一个开放的平台。</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>R02-React 开发环境设置与 Webpack 入门教学</title>
      <link href="/reactjs-getting-started-2.html"/>
      <url>/reactjs-getting-started-2.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://res.i95.me/wp-content/uploads/2016/09/react-webpack-browserify.png" alt="React 开发环境设置与 Webpack 入门教学"></p><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>俗话说工欲善其事，必先利其器。写程式也是一样，搭建好开发环境后可以让自己在后续开发上更加顺利。因此本章接下来将讨论 React 开发环境的两种主要方式：CDN-based、 <a href="https://webpack.github.io/" target="_blank" rel="noopener">webpack</a>（这边我们就先不讨论 <a href="https://www.typescriptlang.org/" target="_blank" rel="noopener">TypeScript</a> 的开发方式）。至于 <a href="https://webpack.github.io/" target="_blank" rel="noopener">browserify</a> 搭配 <a href="http://gulpjs.com/" target="_blank" rel="noopener">Gulp</a> 的方法则会放在补充资料中，让读者阅读完本章后可以开始 React 开发之旅！</p><h3 id="JavaScript-模组化"><a href="#JavaScript-模组化" class="headerlink" title="JavaScript 模组化"></a>JavaScript 模组化</h3><p>随著网站开发的複杂度提昇，许多现代化的网站已不是单纯的网站而已，更像是个富有互动性的网页应用程式（Web App）。为了应付现代化网页应用程式开发的需求，解决一些像是全域变数污染、低维护性等问题，JavaScript 在模组化上也有长足的发展。过去一段时间读者们或许听过像是 <code>Webpack</code>、<code>Browserify</code>、<code>module bundlers</code>、<code>AMD</code>、<code>CommonJS</code>、<code>UMD</code>、<code>ES6 Module</code> 等有关 JavaScript 模组化开发的专有名词或工具，在前面一个章节我们也简单介绍了关于 JavaScript 模组化的简单观念和规范介绍。若是读者对于 JavaScript 模组化开发尚不熟悉的话推荐可以参考 <a href="http://huangxuan.me/2015/07/09/js-module-7day/" target="_blank" rel="noopener">这篇文章</a> 和 <a href="https://medium.freecodecamp.com/javascript-modules-a-beginner-s-guide-783f7d7a5fcc#.oa2n5s5zt" target="_blank" rel="noopener">这篇文章</a> 当作入门。</p><p>总的来说，使用模组化开发 JavaScript 应用程式主要有以下三种好处：</p><ol><li>提昇维护性（Maintainability）</li><li>命名空间（Namespacing）</li><li>提供可重用性（Reusability）</li></ol><p>而在 React 应用程式开发上更推荐使用像是 <code>Webpack</code> 这样的 <code>module bundlers</code> 来组织我们的应用程式，但对于一般读者来说 <code>Webpack</code> 强大而完整的功能相对複杂。为了让读者先熟悉 <code>React</code> 核心观念（我们假设读者已经有使用 <code>JavaScript</code> 或 <code>jQuery</code> 的基本经验），我们将从使用 <code>CDN</code> 引入 <code>&lt;script&gt;</code> 的方式开始介绍：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/react.png" alt="React 开发环境设置与 Webpack 入门教学"> 使用 CDN-based 的开发方式缺点是较难维护我们的程式码（当引入函式库一多就会有很多 <code>&lt;script/&gt;</code>）且会容易遇到版本相容性问题，不太适合开发大型应用程式，但因为简单易懂，适合教学上使用。</p><p>以下是 React <a href="https://facebook.github.io/react/index.html" target="_blank" rel="noopener">官方首页的范例</a>，以下使用 <code>React v15.2.1</code>：</p><ol><li>理解 <code>React</code> 是 <code>Component</code> 导向的应用程式设计</li><li>引入 <code>react.js</code>、<code>react-dom.js</code>（react 0.14 后将 react-dom 从 react 核心分离，更符合 react 跨平台抽象化的定位）以及 <code>babel-core-browser</code> 版 script（可以想成 <code>babel</code> 是翻译机，翻译浏览器看不懂的 <code>JSX</code> 或 <code>ES6+</code> 语法成为浏览器看的懂得的 <code>JavaScript</code>。为了提昇效率，通常我们都会在伺服器端做转译，这点在 production 环境尤为重要）</li><li>在 <code></code> 撰写 React Component 要插入（mount）指定节点的地方：<code>&lt;div id=&quot;example&quot;&gt;&lt;/div&gt;</code></li><li>透过 <code>babel</code> 进行语言翻译 <code>React JSX</code> 语法，<code>babel</code> 会将其转为浏览器看的懂得 <code>JavaScript</code>。其代表意义是：<code>ReactDOM.render(欲 render 的 Component 或 HTML 元素, 欲插入的位置)</code>。所以我们可以在浏览器上打开我们的 <code>hello.html</code>，就可以看到 <code>Hello, world!</code> 。That’s it，我们第一个 <code>React</code> 应用程式就算完成了！</li></ol><pre><code>&lt;meta charset=&quot;UTF-8&quot; /&gt;&lt;title&gt;Hello React!&lt;/title&gt;&lt;!-- 以下引入 react.js, react-dom.js（react 0.14 后将 react-dom 从 react 核心分离，更符合 react 跨平台抽象化的定位）以及 babel-core browser 版 --&gt;&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/react/15.2.1/react.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/react/15.2.1/react-dom.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.min.js&quot;&gt;&lt;/script&gt;&lt;!-- 这边的 id=&quot;example&quot; 的 &lt;div&gt; 为 React Component 要插入的地方 --&gt;&lt;div id=&quot;example&quot;&gt;&lt;/div&gt;&lt;!-- 以下就是包在 babel（透过进行语言翻译）中的 React JSX 语法，babel 会将其转为浏览器看的懂得 JavaScript --&gt;&lt;script type=&quot;text/babel&quot;&gt;  ReactDOM.render(    &lt;h1&gt;Hello, world!&lt;/h1&gt;,    document.getElementById(&apos;example&apos;)  );&lt;/script&gt;</code></pre><p>在浏览器浏览最后成果：</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/hello-world.png" alt="React 开发环境设置与 Webpack 入门教学"></p><h3 id="Webpack"><a href="#Webpack" class="headerlink" title="Webpack"></a>Webpack</h3><p><img src="https://res.i95.me/wp-content/uploads/2016/09/webpack-module-bundler.png" alt="React 开发环境设置与 Webpack 入门教学"></p><p>上面我们先简单介绍了 CDN-based 的开发方式让大家先对于 React 有个基本印象，但由于 CDN-based 的开发方式有不少缺点。所以接下来的 Webpack 将会是我们接下来范例的主要使用的开发工具。</p><p><a href="https://webpack.github.io/" target="_blank" rel="noopener">Webpack</a> 是一个模组打包工具（module bundler），以下列出 Webpack 的几项主要功能：</p><ul><li>将 CSS、图片与其他资源打包</li><li>打包之前预处理（Less、CoffeeScript、JSX、ES6 等）档案</li><li>依 entry 文件不同，把 .js 分拆为多个 .js 档案</li><li>整合丰富的 Loader 可以使用（Webpack 本身仅能处理 JavaScript 模组，其馀档案如：CSS、Image 需要载入不同 Loader 进行处理）</li></ul><p>接下来我们一样透过 Hello World 实例来介绍如何用 Webpack 设置 React 开发环境：</p><ol><li>依据你的作业系统安装 <a href="https://nodejs.org/en/" target="_blank" rel="noopener">Node</a> 和 <a href="https://www.npmjs.com/" target="_blank" rel="noopener">NPM</a>（目前版本的 Node 都会内建 NPM）</li><li><p>透过 NPM 安装 Webpack（可以 global 或 local project 安装，这边我们使用 local）、webpack loader、webpack-dev-server Webpack 中的 loader 类似于 browserify 内的 transforms，但 Webpack 在使用上比较多元，除了 JavaScript loader 外也有 CSS Style 和图片的 loader。此外，<code>webpack-dev-server</code> 则可以启动开发用 server，方便我们测试</p><p> // 按指示初始化 NPM 设定档 package.json<br> $ npm init<br> // –save-dev 是可以让你将安装套件的名称和版本资讯存放到 package.json，方便日后使用<br> $ npm install –save-dev babel-core babel-eslint babel-loader babel-preset-es2015 babel-preset-react html-webpack-plugin webpack webpack-dev-server</p></li></ol><ol start="3"><li><p>在根目录设定 <code>webpack.config.js</code>事实上，<code>webpack.config.js</code> 有点类似于 <code>gulp</code> 中的 <code>gulpfile.js</code> 功用，主要是设定 <code>webpack</code> 的相关设定</p><p> // 这边使用 HtmlWebpackPlugin，将 bundle 好的 <script> 插入到 body。${<strong>dirname} 为 ES6 语法对应到 </strong>dirname<br> const HtmlWebpackPlugin = require(‘html-webpack-plugin’);</p><p> const HTMLWebpackPluginConfig = new HtmlWebpackPlugin({<br>   template: <code>${__dirname}/app/index.html</code>,<br>   filename: ‘index.html’,<br>   inject: ‘body’,<br> });</p><p> module.exports = {<br>   // 档案起始点从 entry 进入，因为是阵列所以也可以是多个档案<br>   entry: [</p><pre><code>&apos;./app/index.js&apos;,</code></pre><p>   ],<br>   // output 是放入产生出来的结果的相关参数<br>   output: {</p><pre><code>path: `${__dirname}/dist`,filename: &apos;index_bundle.js&apos;,</code></pre><p>   },<br>   module: {</p><pre><code>  // loaders 则是放欲使用的 loaders，在这边是使用 babel-loader 将所有 .js（这边用到正则式）相关档案（排除了 npm 安装的套件位置 node_modules）转译成浏览器可以阅读的 JavaScript。preset 则是使用的 babel 转译规则，这边使用 react、es2015loaders: [  {    test: /.js$/,    exclude: /node_modules/,    loader: &apos;babel-loader&apos;,    query: {      presets: [&apos;es2015&apos;, &apos;react&apos;],    },  },],</code></pre><p>   },<br>   // devServer 则是 webpack-dev-server 设定<br>   devServer: {</p><pre><code>inline: true,port: 8008,</code></pre><p>   },<br>   // plugins 放置所使用的外挂<br>   plugins: [HTMLWebpackPluginConfig],<br> };</p></li></ol><ol start="4"><li>在根目录设定 `.babelrc<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">    `&#123;  </span><br><span class="line">    &quot;presets&quot;: [  </span><br><span class="line">    &quot;es2015&quot;,  </span><br><span class="line">    &quot;react&quot;,  </span><br><span class="line">    ],  </span><br><span class="line">    &quot;plugins&quot;: []  </span><br><span class="line">    &#125;`</span><br><span class="line"></span><br><span class="line">`````5. 安装 react 和 react-dom ```</span><br><span class="line">     $ npm install --save react react-dom</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">6.  撰写 Component（记得把 `index.html` 以及 `index.js` 放到 `app` 资料夹底下喔！） `index.html````  </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"> ````&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">     &lt;title&gt;React Setup&lt;/title&gt;</span><br><span class="line">     &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css&quot;&gt;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">     &lt;!-- 欲插入 React Component 的位置 --&gt;</span><br><span class="line">     &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    `index.js`</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`import React from &apos;react&apos;;  </span><br><span class="line">import ReactDOM from &apos;react-dom&apos;;`</span><br><span class="line"></span><br><span class="line">```class App extends React.Component &#123;  </span><br><span class="line">constructor(props) &#123;  </span><br><span class="line">super(props);  </span><br><span class="line">this.state = &#123;  </span><br><span class="line">&#125;;  </span><br><span class="line">&#125;  </span><br><span class="line">render() &#123;  </span><br><span class="line">return (  </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Hello, World!</span><br><span class="line">=============</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">);  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(, document.getElementById(&apos;app&apos;));</span><br><span class="line"></span><br><span class="line">    7. 在终端机使用 `webpack` 进行成果展示，webpack 相关指令： - webpack：会在开发模式下开始一次性的建置</span><br><span class="line">    - webpack -p：会建置 production 的程式码</span><br><span class="line">    - webpack –watch：会监听程式码的修改，当储存时有异动时会更新档案</span><br><span class="line">    - webpack -d：加入 source maps 档案</span><br><span class="line">    - webpack –progress –colors：加上处理进度与颜色 如果不想每次都打一长串的指令码的话可以使用 `package.json` 中的 `scripts` 设定</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">`&quot;scripts&quot;: &#123;  </span><br><span class="line">&quot;dev&quot;: &quot;webpack-dev-server --devtool eval --progress --colors --content-base build&quot;  </span><br><span class="line">&#125;`</span><br><span class="line"></span><br><span class="line"> ``然后在终端机执行：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">$ npm run dev</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    当我们此时我们可以打开浏览器输入 `http://localhost:8008` ，就可以看到 `Hello, world!` 了！</span><br><span class="line">    </span><br><span class="line">    ### 总结</span><br><span class="line">    </span><br><span class="line">    以上就是 React 开发环境设置与 Webpack 入门教学，看到这边的读者不妨自己动手设定开发环境，体验一下 React 开发环境的感觉，毕竟若是只有阅读文字的话很容易就会忘记喔！若你不想在环境设定上花太多时间的话，不妨参考 Facebook 开发社群推出的 [create-react-app](https://github.com/facebookincubator/create-react-app)，可以快速上手，使用 Webpack、[Babel](https://babeljs.io/)、[ESLint](http://eslint.org/) 开发 React 应用程式。接下来的章节我们将持续延伸 React/JSX/Component 的介绍。</span><br><span class="line">    </span><br><span class="line">    ### 延伸阅读</span><br><span class="line">    </span><br><span class="line">    1. [JavaScript 模块化七日谈](http://huangxuan.me/2015/07/09/js-module-7day/)</span><br><span class="line">    2. [前端模块化开发那点历史](https://github.com/seajs/seajs/issues/588)</span><br><span class="line">    3. [Webpack 中文指南](http://zhaoda.net/webpack-handbook/index.html)</span><br><span class="line">    4. [WEBPACK DEV SERVER](http://webpack.github.io/docs/webpack-dev-server.html)`` ``` ```` `</span><br></pre></td></tr></table></figure></li></ol></script></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>R01-前端工程简介和 React 生态系简介</title>
      <link href="/reactjs-getting-started-1.html"/>
      <url>/reactjs-getting-started-1.html</url>
      
        <content type="html"><![CDATA[<h1 id="Web-前端工程入门简介"><a href="#Web-前端工程入门简介" class="headerlink" title="Web 前端工程入门简介"></a>Web 前端工程入门简介</h1><p><img src="https://res.i95.me/wp-content/uploads/2016/09/frameworks.png" alt="Web 前端工程入门简介"></p><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>随著现代化网页（Modern Web）开发专业和複杂性的提昇以及对于使用者体验的要求下，网页开发已从过去的 Web Develpoer 一夫当关，转向专业分工，更加细分成网页前端（Web Front End）、网页后端（Web Back End）等职位。此外，由于跨平台、跨浏览器的需求日益增加，技术变化更迭快速，市场上对于前端工程师（Web Front End Engineer）的需求也与日俱增，前端工程的（Front End Engineering）所要面对的挑战也越来越多。</p><p><img src="https://res.i95.me/wp-content/uploads/2016/09/html-css-js.png" alt="Web 前端工程入门简介"></p><h3 id="前端工程范畴"><a href="#前端工程范畴" class="headerlink" title="前端工程范畴"></a>前端工程范畴</h3><p>事实上，在目前的业界，前端工程的定位光谱非常广泛，有聚焦在网页设计（Web Design），也有专注在软体工程（Software Engineering）的部份，本书则是将前端工程定位在软体工程的范畴。而 HTML、CSS 和 JavaScript 是前端工程最重要的技术基础。过去一段时间，我们所认为的前端工程主要专注在浏览器平台，但现在的 Web 平台已经不再侷限于桌面浏览器，而是必须面对更多的跨平台、跨浏览器的应用开发场景，其中包含：</p><ol><li>网页浏览器（Web Browser），一般的网页应用程式开发</li><li>透过 CLI 指令去操作的 Headless 浏览器（Headless　Application）。例如：<a href="http://phantomjs.org/" target="_blank" rel="noopener">phantomJS</a>、<a href="http://casperjs.org/" target="_blank" rel="noopener">CasperJS</a> 等</li><li>运作在 WebView 浏览器核心（WebView Application）的应用。例如：<a href="https://cordova.apache.org/" target="_blank" rel="noopener">Apache Cordova</a>、<a href="http://electron.atom.io/" target="_blank" rel="noopener">Electron</a>、<a href="http://nwjs.io/" target="_blank" rel="noopener">NW.js</a> 等行动、桌面应用程式开发</li><li>原生应用程式（Native Application），透过 Web 技术撰写原生应用程式。例如：<a href="https://facebook.github.io/react-native/" target="_blank" rel="noopener">React Native</a>、<a href="https://www.nativescript.org/" target="_blank" rel="noopener">Native Script</a> 等</li></ol><p>过去几年，前端开发就像经历了文艺复兴（Rinascimento）的年代，开始了各种框架、套件百花齐放的时代。虽然现在有更多好用工具可以协助开发，但前端工程师似乎并没有变得比较轻鬆。以往若能妥善运用 jQuery 等函式库就可以应付大部分前端工程师的工作，但现在前端徵才广告上不仅要求精通 HTML、CSS 和 JavaScript，还要对于还要对于 <a href="http://backbonejs.org/" target="_blank" rel="noopener">Backbone</a>、<a href="http://emberjs.com/" target="_blank" rel="noopener">Ember</a>、<a href="https://angularjs.org/" target="_blank" rel="noopener">Angular</a>、<a href="https://facebook.github.io/react/" target="_blank" rel="noopener">React</a>、<a href="https://vuejs.org/" target="_blank" rel="noopener">Vue</a> 等 JavaScript 框架或函式库有一定程度的了解。</p><p>在众多 JavaScript 框架或函式库中，<a href="https://facebook.github.io/react/" target="_blank" rel="noopener">React</a> 是 Facebook 推出的开源 <a href="https://en.wikipedia.org/wiki/JavaScript" target="_blank" rel="noopener">JavaScript</a> Library，它的出现让许多革新性的 Web 观念开始流行起来，例如：Virtual DOM、Web Component、更直觉的宣告式 UI 设计、更优雅地实现 Server Rendering 等。接下来本书将透过介绍 React 生态系（ecosystem）带领读者入门 React 的世界，让读者可以从零开始真的动手用 React 开发跨平台应用程式。</p><h1 id="React-生态系（Ecosystem）入门简介"><a href="#React-生态系（Ecosystem）入门简介" class="headerlink" title="React 生态系（Ecosystem）入门简介"></a>React 生态系（Ecosystem）入门简介</h1><p><img src="https://res.i95.me/wp-content/uploads/2016/09/react-eco-wp.gif" alt="React 生态系（Ecosystem）入门简介"></p><p>根据 <a href="https://facebook.github.io/react/" target="_blank" rel="noopener">React 官方网站</a> 的说明：React 是一个专注于 UI（View）的 JavaScript 函式库（Library）。自从 Facebook 于 2013 年开源 React 这个函式库后，相关的生态系开始蓬勃发展。事实上，透过学习 React 生态系（ecosystem）的过程中，可以让我们顺便学习现代化 Web 开发的重要观念（例如：模组化、ES6+、Webpack、Babel、ESLint、函数式程式设计等），成为更好的开发者。</p><h3 id="ReactJS"><a href="#ReactJS" class="headerlink" title="ReactJS"></a>ReactJS</h3><p>ReactJS 是 Facebook 推出的 JavaScript 函式库，若以 MVC 框架来看，React 定位是在 View 的范畴。在 ReactJS 0.14 版之后，ReactJS 更把原先处理 DOM 的部分独立出去（react-dom），让 ReactJS 核心更单纯，也更符合 React 所倡导的 <code>Learn once, write everywhere</code> 的理念。事实上，ReactJS 本身的 API 相对单纯，但由于整个生态系非常庞大，因此学习 React 却是一条漫长的道路。此外，当你想把 React 应用在你的应用程式时，你通常必须学习整个 React Stack 才能充分发挥 React 的最大优势。</p><h3 id="JSX"><a href="#JSX" class="headerlink" title="JSX"></a>JSX</h3><p>事实上，JSX 并非一种全新的语言，而是一种语法糖（<a href="https://en.wikipedia.org/wiki/Syntactic_sugar" target="_blank" rel="noopener">Syntatic Sugar</a>），一种语法类似 <a href="https://zh.wikipedia.org/wiki/XML" target="_blank" rel="noopener">XML</a> 的 ECMAScript 语法扩充。在 JSX 中 HTML 和组建这些元素标籤的程式码有紧密的关系，这和过去我们强调 HTML、JavaScript 分离的观念有很大不同。当然，你可以选择不要在 React 使用 JSX，不过相信我，当你真正开始撰写 React 元件（Component）时，你会很庆幸有 JSX 真好。</p><h3 id="NPM"><a href="#NPM" class="headerlink" title="NPM"></a>NPM</h3><p>NPM（Node Package Manager）是 Node.js 下的主流套件管理工具。在 NPM 上有非常多的套件，可以让你不用再重造轮子，更可以让你可以轻鬆用指令管理不同的套件。由于 NPM 主要是基于 <a href="https://en.wikipedia.org/wiki/CommonJS" target="_blank" rel="noopener">CommonJS</a> 的规范，通常必须搭配 Browserify 这样的工具才能在前端使用 NPM 的模组。然而因 NPM 是基于 Nested Dependency Tree，不同的套件有可能会在引入依赖时会引入相同但不同版本的套件，造成档案大小过大的情形。这和另一个套件管理工具 <a href="https://bower.io/" target="_blank" rel="noopener">Bower</a> 专注在前端套件且使用 Flat Dependency Tree（让使用者决定相依的套件版本）是比较不同的地方。</p><h3 id="ES6"><a href="#ES6" class="headerlink" title="ES6+"></a>ES6+</h3><p><a href="https://babeljs.io/blog/2015/06/07/react-on-es6-plus" target="_blank" rel="noopener">ES6+</a> 系指 ES6（ES2015）和 ES7 的联集，在 ES6+ 新的标准当中引入许多新的特性和功能，弥补了过去 JavaScript 被诟病的一些特性。由于未来 React 将以支援 ES6+ 为主，因此直接学习 ES6+ 用法是相对好的选择，本书的所有范例也将会以 ES6+ 撰写。</p><h3 id="Babel"><a href="#Babel" class="headerlink" title="Babel"></a>Babel</h3><p>由于并非所有浏览器都支援 ES6+ 语法，所以透过 <a href="https://babeljs.io/" target="_blank" rel="noopener">Babel</a> 这个 JavaScript 编译器（可以想成是翻译机或是翻译蒟篛）可以让你的 ES6+ 、JSX 等程式码转换成浏览器可以看的懂得语法。通常会在资料夹的 root 位置加入 <code>.bablerc</code> 进行转译规则 <code>preset</code> 和引用外挂（plugin）的设定。</p><h3 id="JavaScript-模组化开发"><a href="#JavaScript-模组化开发" class="headerlink" title="JavaScript 模组化开发"></a>JavaScript 模组化开发</h3><p>随著 Web 应用程式的複杂性提高，JavaScript 模组化开发已经成为必然的趋势，以下简单介绍 JavaScript 模组化的相关规范。事实上，在一开始没有官方定义的标准时出现了各种社群自行定义的规范和实践。</p><ol><li>CDN-Based也就是最传统的 <code>&lt;script&gt;</code> 引入方式，然而使用这种方式虽然简单方便，但在开发实际中大型应用程式时会产生许多弊端： - 全域作用域容易造成变数污染和衝突</li></ol><ul><li>文件只能依照 <code>&lt;script&gt;</code> 顺序载入，不具弹性</li><li>在大型专案中各种资源和版本难以维护</li><li>必须由开发者自行判断模组和函式库之间的依赖关系</li></ul><ol start="2"><li>AMD<a href="https://en.wikipedia.org/wiki/Asynchronous_module_definition" target="_blank" rel="noopener">Asynchronous Module Definition</a> 简称 AMD，为非同步载入模组的规范，其在宣告时模组时即需定义依赖的模组。AMD 常用于浏览器端，其最著名的实践为 <a href="http://requirejs.org/" target="_blank" rel="noopener">RequireJS</a>基本格式： <code>`</code><br><code>define(id?, dependencies?, factory);</code></li></ol><p><code></code>3. CommonJS<a href="http://wiki.commonjs.org/wiki/CommonJS" target="_blank" rel="noopener">CommonJS</a> 规范是一种同步模组载入的规范。以 Node.js 其遵守 CommonJS 规范，使用 <code>require</code> 进行模组同步载入，并透过 <code>exports</code>、<code>module.exports</code> 来输出模组。主要实现为 <a href="https://nodejs.org/en/" target="_blank" rel="noopener">Node.js</a> 伺服器端的同步载入和浏览器端的 <a href="http://browserify.org/" target="_blank" rel="noopener">Browserify</a>。</p><pre><code>4. CMDCMD 全称为 [Common Module Definition](https://github.com/cmdjs/specification/blob/master/draft/module.md)，其规范和 AMD 类似，但相对简洁，却又保持和 CommonJS 的兼容性。其最大特色为：依赖就近，延迟执行。主要实现为：[Sea.js](http://seajs.org/docs/#intro)。5. UMD[Universal Module Definition](https://github.com/umdjs/umd) 是为了要兼容 CommonJS 和 AMD 所设计的规范，希望让模组能跨平台执行。6. ES6 ModuleECMAScript6 的标准中定义了 JavaScript 的模组化方式，让 JavaScript 在开发大型複杂应用程式时上更为方便且易于管理，亦可以取代过去 AMD、CommonJS 等规范，成为通用于浏览器端和伺服器端的模组化解决方案。但目前浏览器和 Node 在 ES6 模组支援度还不完整，大部分情况需要透过 [Babel](https://babeljs.io/) 转译器进行转译。### Webpack/Browserify + Gulp随著网页应用程式开发的複杂性提昇，现在的网页往往不单只是单纯的网页，而是一个网页应用程式（WebApp）。为了管理複杂的应用程式开发，此时模组化开发方法便显得日益重要，而理想上的模组化开发工具一直是前端工程的很大的议题。Webpack 和 Browserify + Gulp 则是进行 React 应用程式开发常用的开发工具，可以协助进行自动化程式码打包、转译等重複性工作，提昇开发效率。本书范例主要会搭配 Webpack 进行开发。1. Webpack[Webpack](https://webpack.github.io/) 是一个模组打包工具（module bundler），以下列出 Webpack 的几项主要功能： - 将 CSS、图片与其他资源打包- 打包之前预处理（Less、CoffeeScript、JSX、ES6 等）的档案- 依 entry 文件不同，把 .js 分拆为多个 .js 档案- 整合丰富的 Loader 可以使用（Webpack 本身仅能处理 JavaScript 模组，其馀档案如：CSS、Image 需要载入不同 Loader 进行处理）2. Browserify如同官网上说明的：`Browserify lets you require(&apos;modules&apos;) in the browser by bundling up all of your dependencies.`，Browserify 是一个可以让你在浏览器端也能使用像 Node 用的 [CommonJS](https://en.wikipedia.org/wiki/CommonJS) 规范一样，用输出（export）和引用（require）来管理模组。此外，也能让前端使用许多在 NPM 中的模组。3. Gulp`Gulp` 是一个前端任务工具自动化管理工具（Task Runner）。随著前端工程的发展，我们在开发前端应用程式时有许多工作是必须重複进行，例如：打包文件、uglify、将 LESS 转译成一般的 CSS 的档案，转译 ES6 语法等工作。若是使用一般手动的方式，往往会造成效率的低下，所以透过像是 [Grunt](http://gruntjs.com/)、Gulp 这类的 Task Runner 不但可以提昇效率，也可以更方便管理这些任务。由于 Gulp 是透过 pipeline 方式来处理档案，在使用上比起 Grunt 的方式直观许多，所以这边我们主要讨论的是 Gulp。### ESLint[ESLint](http://eslint.org/) 是一个提供 JavaScript 和 JSX 的程式码检查工具，可以确保团队的程式码品质。其支援可插拔的特性，可以根据需求在 `.eslintrc` 设定检查规则。目前主流的检查规则会使用 Airbnb 所释出的 [Airbnb React/JSX Style Guide](https://github.com/airbnb/javascript/tree/master/react)，在使用上需先安装 [eslint-config-airbnb](https://github.com/airbnb/javascript/tree/master/packages/eslint-config-airbnb) 等套件。### React Router[React Router](https://github.com/reactjs/react-router) 是 React 中主流使用的 Routing 函式库，透过 URL 的变化来管理对应的状态和元件。若开发不刷页的单页式（single page application）的 React 应用程式通常都会需要用到。### Flux/Redux[Flux](https://facebook.github.io/flux/) 是一个实现单项流的应用程式资料架构（architecture），同样是由 Facebook 推出，并和 React 专注于 View 的部份形成互补。而由 Dan Abramov 所开发的 [Redux](https://github.com/reactjs/redux) 被 React 开发社群认为是 Flux-like 更优雅的作法，也是目前主流搭配 React 的状态（State）管理工具。让你在开发複杂的应用程式时可以更方便管理你的状态（state）。### ImmutableJS[ImmutableJS](https://facebook.github.io/immutable-js/)，是一个能让开发者建立不可变资料结构的函式库。建立不可变（immutable）资料结构不仅可以让状态可预测性更高，也可以提昇程式的效能。### Isomorphic JavaScriptIsomorphic JavaScript 是指前后端（Client/Server）共用相同部分的程式码，让 JavaScript 应用可以同时执行在浏览器端和伺服器端，在 React 中可以透过伺服器端渲染（server side rendering）静态 HTML 的方式达到 Isomorphic JavaScript 效果，让 SEO 和执行效能更加提昇并让前后端共用程式码。而另一个常一起出现的 Universal JavaScript 一般定义更为广泛，系指可以运行在不同环境下的 JavaScript Code，并不局限于浏览器和伺服器端。但要留意的是在 Github 和许多技术文章的分享上会把两者定义为同一件事情。### React 测试Facebook 本身有提供 [Test Utilities](https://facebook.github.io/react/docs/test-utils.html)，但由于不够好用，所以目前主流开发社群比较倾向使用 Airbnb 团队开发的 [enzyme](https://github.com/airbnb/enzyme)，其可以与市面上常见的测试工具（[Mocha](https://mochajs.org/)、[Karma](https://karma-runner.github.io/)、Jest 等）搭配使用。其中 [Jest](https://facebook.github.io/jest/) 是 Facebook 所开发的单元测试工具，其主要基于 [Jasmine](http://jasmine.github.io/) 所建立的测试框架。Jest 除了支援 JSDOM 外，也可以自动模拟 (mock) 透过 `require()` 进来的模组，让开发者可以更专注在目前被测试的模组中。### React Native[React Native](https://facebook.github.io/react-native/)和过去的 [Apache Cordova](https://cordova.apache.org/) 等基于 WebView 的解决方案比较不同，它让开发者可以使用 React 和 JavaScript 开发原生应用程式（Native App），让 `Learn once, write anywhere` 理想变得可能。### GraphQL/Relay[GraphQL](http://graphql.org/docs/getting-started/) 是 Facebook 所开发的资料查询语言（Data Query Language），主要是想解决传统 RESTful API 所遇到的一些问题，并提供前端更有弹性的 API 设计方式。[Relay](https://facebook.github.io/relay/) 则是 Facebook 提出搭配 GraphQL 用于 React 的一个宣告式数据框架，可以降低 Ajax 的请求数量（类似的框架还有 Netflix 推出的 [Falcor](https://netflix.github.io/falcor/)）。但由于目前主流的后端 API 仍以传统 RESTful API 设计为主，所以在使用 GraphQL 上通常会需要比较大架构设计的变动。因此本书则是把 GraphQL/Relay 介绍放到附录的部份，让有兴趣的读者可以自行参考体验一下。### 总结以上就是读者在 React 生态系游走时会遇到的各种关卡，也许有些初学者会对于这样庞大的体系所吓到，放弃学习 React 这项革新性技术的机会。不过别担心，接下来笔者将带领读者按图索骥，依序介绍整个 React 生态系的各种技术，一步步带领大家用 React 实作出生活中会用到的应用程式。### 延伸阅读1. [Navigating the React.JS Ecosystem](https://www.toptal.com/react/navigating-the-react-ecosystem)2. [petehunt/react-howto](https://github.com/petehunt/react-howto#learning-relay-falcor-etc)3. [React Ecosystem – A summary](https://staminaloops.github.io/undefinedisnotafunction/react-ecosystem/)4. [React Official Site](https://facebook.github.io/react/)5. [A collection of awesome things regarding React ecosystem](https://github.com/enaqx/awesome-react)6. [Webpack 中文指南](http://zhaoda.net/webpack-handbook/index.html)7. [AMD 和 CMD 的区别有哪些？](https://www.zhihu.com/question/20351507)8. [jslint to eslint](https://www.qianduan.net/jslint-to-eslint/)9. [Facebook的Web开发三板斧：React.js、Relay和GraphQL](http://1ke.co/course/595)10. [airbnb/javascript](https://github.com/airbnb/javascript)``</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>秒懂ReactJS</title>
      <link href="/sec-understand-reactjs.html"/>
      <url>/sec-understand-reactjs.html</url>
      
        <content type="html"><![CDATA[<h3 id="两句话版本"><a href="#两句话版本" class="headerlink" title="两句话版本"></a>两句话版本</h3><ul><li>ReactJs把视图更新简化为一个render函数</li><li>render函数接收两个参数，分别是配置项和状态</li></ul><h3 id="长版本"><a href="#长版本" class="headerlink" title="长版本"></a>长版本</h3><p>ReactJs是一个专注于View的Web前端框架。Web前端的View就是浏览器中的Dom元素，改变View的唯一途径就是修改浏览器中的Dom元素，因此ReactJs的核心任务就是如何修改Dom元素，作为一个成功的框架，ReactJs使修改Dom元素变得高效而又简单。</p><p>ReactJs把修改Dom的操作简化成一个函数<code>renderInto(parentDom, props, states)=&gt;htmlString</code>，这个函数的意图就是根据props，states计算出视图对应的html字符串并添加为parentDom的子节点。props和states就是普通的javascript对象，这个函数的核心逻辑就是计算html元素的机构及元素属性然后拼接成字符串返回。作为框架，ReactJs用JSX形式的DSL解决了拼接html的任务并接管了更新到parentDom的职责。看一个例子，理解这个函数并理解ReactJs怎么使用这个函数你就可以一个人开始ReactJs之旅了。</p><pre><code>var props = {name: &apos;myname&apos;}; var states = {amount: 1000}; function render(props, states) {  var title = ’Hello, &apos; + props.name;  var description = &apos;You have &apos; + states.amount + &apos; score now.&apos;;  return (  &lt;div className=&quot;score-board&quot;&gt;  &lt;h1&gt;{title}&lt;/h1&gt;  &lt;p&gt;{description}&lt;/p&gt;  &lt;/div&gt;  ); }</code></pre><p>函数第一行根据props计算title，第二行根据states计算description，最后以JSX形式返回拼接好的html字符串。</p><p>如果你用过AngularJs，EmberJs等类似的前端框架，你可能会觉得没什么了不起，不就是把模板和逻辑放到一起吗？是的，没错，但这不仅仅是组织形式上的改变，而是编程隐喻的转变—从复杂的MVC或MVVM模式到简单的render函数。还有一点不同是JSX最终编译成调用react-dom的javascript语句，而不是直接生成字符串。</p><p>render函数还只是ReactJs这座冰山的一角，”React”会在render函数的输入变化时再次调用这个函数。再看一个例子。</p><pre><code>var props = {name: &apos;myname&apos;}; var states = {amount: 1000}; function handleClickAdd() {  states = {amount: states.amount + 1}; } function render(props, states) {  var title = ’Hello, &apos; + props.name;  var description = &apos;You have &apos; + states.amount + &apos; score now.&apos;;  return (  &lt;div className=&quot;score-board&quot;&gt;  &lt;h1&gt;{title}&lt;/h1&gt;  &lt;p&gt;{description}&lt;/p&gt;  &lt;button onClick={handleClickAdd}&gt;+1&lt;/button&gt;  &lt;/div&gt;  ); }</code></pre><p>这个例子增加了一个”+1”按钮，当用户点击按钮时会修改states，ReactJs在states变化时的”React”就是再次调用render函数，然后用新输出更新浏览器的dom。</p><p>可能你会问，props和states不就是Model吗？是的，可以理解成Model，但此Model非彼Model，props和states都是为View服务的而非和View平起平坐。</p><p>可能你还会问，为啥不把props和states合并成一个对象？要回答这个问题，就涉及到复杂视图的场景。想想看，当视图内的元素不断增加时，代码上如何处理，还要在一个render函数里折腾吗？肯定不会。我猜你已经想到了，要把大问题拆小。ReactJs给出的解决方法就是把大视图拆成若干个小视图，每个视图都有自己的render函数，在JSX中可以直接使用视图标签。看一个例子。</p><pre><code>var Score = React.createClass({  initialState: function() {  return {amount: 1000};  },  function handleClickAdd() {  this.setState({amount: this.states.amount + 1});  }  render: function() {  var title = ’Hello, &apos; + this.props.name;  var description = &apos;You have &apos; + this.states.amount + &apos; score now.&apos;;  return (  &lt;div className=&quot;score-board&quot;&gt;  &lt;h1&gt;{title}&lt;/h1&gt;  &lt;p&gt;{description}&lt;/p&gt;  &lt;button onClick={handleClickAdd}&gt;+1&lt;/button&gt;  &lt;/div&gt;  );  } }); var ScoreList = React.createClass({  render() {  return (  &lt;ul className=&quot;score-list&quot;&gt;  &lt;li&gt;&lt;Score name=&quot;Tom&quot; /&gt;&lt;/li&gt;  &lt;li&gt;&lt;Score name=&quot;Jerry&quot; /&gt;&lt;/li&gt;  &lt;/ul&gt;  );  } }); ReactDOM.render(  &lt;ScoreList /&gt;,  document.getElementById(&apos;content&apos;) );</code></pre><p>这个例子中有两类View，分别是Score和ScoreList。ScoreList的render函数中使用Score标签并给出配置项name的值。详细看一下Score，ReactJs提供createClass方法定义视图，在render函数中通过this.props访问外部传入的配置项，通过this.states访问视图内部的状态。从意图上看，props外部传入视图的配置项，拥有者是父视图，视图内部只能读取配置项，states的拥有者是视图自身。</p><p>区分props和states的结果就是，子视图没办法直接改变父视图，视图改变一定是自触发改变的视图开始向子视图传播。对上面的例子，当Tom的Score改变时，ScoreList其他部分一定不会改变，所以视图更新从Tom的Score视图开始就可以，这就保证了能更高效地计算视图变化，再加上VirtualDom的使用，使ReactJs的效率大大超过其他框架。</p><p>当子视图需要改变父视图时，也一定是从父视图开始向下更新。假如上面的例子中ScoreList还有平均分的视图，当Tom的分数改变时，需要更新ScoreList中的平均分。这就需要Score视图在处理”+1”输入时把变化通知到ScoreList，做法时给Score增加配置项，ScoreList中定义更新平均分的函数并把函数作为配置项传给Score。当ScoreList更新时，因为Jerry的props和states都没变化，所以Jerry的Score视图不需要更新。</p><p>这就是ReactJs的全部秘密了(不过Web前端本身是一个复杂系统，你还需要了解更多其他内容)。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React Router 使用教程</title>
      <link href="/react-router-notes.html"/>
      <url>/react-router-notes.html</url>
      
        <content type="html"><![CDATA[<p>真正学会 <a href="https://facebook.github.io/react/" target="_blank" rel="noopener">React</a> 是一个漫长的过程。</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2016/bg2016052501.jpg" alt></p><p>你会发现，它不是一个库，也不是一个框架，而是一个庞大的体系。想要发挥它的威力，整个技术栈都要配合它改造。你要学习一整套解决方案，从后端到前端，都是全新的做法。</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2016/bg2016052503.png" alt></p><p>举例来说，React 不使用 HTML，而使用 JSX 。它打算抛弃 DOM，要求开发者不要使用任何 DOM 方法。它甚至还抛弃了 SQL ，自己发明了一套查询语言 GraphQL 。当然，这些你都可以不用，React 照样运行，但是就发挥不出它的最大威力。</p><p>这样说吧，你只要用了 React，就会发现合理的选择就是，采用它的整个技术栈。</p><p>本文介绍 React 体系的一个重要部分：路由库<a href="https://github.com/reactjs/react-router" target="_blank" rel="noopener"><code>React-Router</code></a>。它是官方维护的，事实上也是唯一可选的路由库。它通过管理 URL，实现组件的切换和状态的变化，开发复杂的应用几乎肯定会用到。</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2016/bg2016052502.png" alt></p><p>本文针对初学者，尽量写得简洁易懂。预备知识是 React 的基本用法，可以参考我写的<a href="http://www.ruanyifeng.com/blog/2015/03/react.html" target="_blank" rel="noopener">《React 入门实例教程》</a>。</p><p>另外，我没有准备示例库，因为官方的<a href="https://github.com/reactjs/react-router-tutorial/tree/master/lessons" target="_blank" rel="noopener">示例库</a>非常棒，由浅入深，分成14步，每一步都有详细的代码解释。我强烈建议你先跟着做一遍，然后再看下面的API讲解。</p><h3 id="一、基本用法"><a href="#一、基本用法" class="headerlink" title="一、基本用法"></a>一、基本用法</h3><p>React Router 安装命令如下。</p><pre><code>$ npm install -S react-router</code></pre><p>使用时，路由器<code>Router</code>就是React的一个组件。</p><pre><code>import { Router } from &apos;react-router&apos;;render(&lt;Router/&gt;, document.getElementById(&apos;app&apos;));</code></pre><p><code>Router</code>组件本身只是一个容器，真正的路由要通过<code>Route</code>组件定义。</p><pre><code>import { Router, Route, hashHistory } from &apos;react-router&apos;;render((  &lt;Router history={hashHistory}&gt;    &lt;Route path=&quot;/&quot; component={App}/&gt;  &lt;/Router&gt;), document.getElementById(&apos;app&apos;));</code></pre><p>上面代码中，用户访问根路由<code>/</code>（比如<code>http://www.example.com/</code>），组件<code>APP</code>就会加载到<code>document.getElementById(&#39;app&#39;)</code>。</p><p>你可能还注意到，<code>Router</code>组件有一个参数<code>history</code>，它的值<code>hashHistory</code>表示，路由的切换由URL的hash变化决定，即URL的<code>#</code>部分发生变化。举例来说，用户访问<code>http://www.example.com/</code>，实际会看到的是<code>http://www.example.com/#/</code>。</p><p><code>Route</code>组件定义了URL路径与组件的对应关系。你可以同时使用多个<code>Route</code>组件。</p><pre><code>&lt;Router history={hashHistory}&gt;  &lt;Route path=&quot;/&quot; component={App}/&gt;  &lt;Route path=&quot;/repos&quot; component={Repos}/&gt;  &lt;Route path=&quot;/about&quot; component={About}/&gt;&lt;/Router&gt;</code></pre><p>上面代码中，用户访问<code>/repos</code>（比如<code>http://localhost:8080/#/repos</code>）时，加载<code>Repos</code>组件；访问<code>/about</code>（<code>http://localhost:8080/#/about</code>）时，加载<code>About</code>组件。</p><h3 id="二、嵌套路由"><a href="#二、嵌套路由" class="headerlink" title="二、嵌套路由"></a>二、嵌套路由</h3><p><code>Route</code>组件还可以嵌套。</p><pre><code>&lt;Router history={hashHistory}&gt;  &lt;Route path=&quot;/&quot; component={App}&gt;    &lt;Route path=&quot;/repos&quot; component={Repos}/&gt;    &lt;Route path=&quot;/about&quot; component={About}/&gt;  &lt;/Route&gt;&lt;/Router&gt;</code></pre><p>上面代码中，用户访问<code>/repos</code>时，会先加载<code>App</code>组件，然后在它的内部再加载<code>Repos</code>组件。</p><pre><code>&lt;App&gt;  &lt;Repos/&gt;&lt;/App&gt;</code></pre><p><code>App</code>组件要写成下面的样子。</p><pre><code>export default React.createClass({  render() {    return &lt;div&gt;      {this.props.children}    &lt;/div&gt;  }})</code></pre><p>上面代码中，<code>App</code>组件的<code>this.props.children</code>属性就是子组件。</p><p>子路由也可以不写在<code>Router</code>组件里面，单独传入<code>Router</code>组件的<code>routes</code>属性。</p><pre><code>let routes = &lt;Route path=&quot;/&quot; component={App}&gt;  &lt;Route path=&quot;/repos&quot; component={Repos}/&gt;  &lt;Route path=&quot;/about&quot; component={About}/&gt;&lt;/Route&gt;;&lt;Router routes={routes} history={browserHistory}/&gt;</code></pre><h3 id="三、-path-属性"><a href="#三、-path-属性" class="headerlink" title="三、 path 属性"></a>三、 path 属性</h3><p><code>Route</code>组件的<code>path</code>属性指定路由的匹配规则。这个属性是可以省略的，这样的话，不管路径是否匹配，总是会加载指定组件。</p><p>请看下面的例子。</p><pre><code>&lt;Route path=&quot;inbox&quot; component={Inbox}&gt;   &lt;Route path=&quot;messages/:id&quot; component={Message} /&gt;&lt;/Route&gt;</code></pre><p>上面代码中，当用户访问<code>/inbox/messages/:id</code>时，会加载下面的组件。</p><pre><code>&lt;Inbox&gt;  &lt;Message/&gt;&lt;/Inbox&gt;</code></pre><p>如果省略外层<code>Route</code>的<code>path</code>参数，写成下面的样子。</p><pre><code>&lt;Route component={Inbox}&gt;  &lt;Route path=&quot;inbox/messages/:id&quot; component={Message} /&gt;&lt;/Route&gt;</code></pre><p>现在用户访问<code>/inbox/messages/:id</code>时，组件加载还是原来的样子。</p><pre><code>&lt;Inbox&gt;  &lt;Message/&gt;&lt;/Inbox&gt;</code></pre><h3 id="四、通配符"><a href="#四、通配符" class="headerlink" title="四、通配符"></a>四、通配符</h3><p><code>path</code>属性可以使用通配符。</p><pre><code>&lt;Route path=&quot;/hello/:name&quot;&gt;// 匹配 /hello/michael// 匹配 /hello/ryan&lt;Route path=&quot;/hello(/:name)&quot;&gt;// 匹配 /hello// 匹配 /hello/michael// 匹配 /hello/ryan&lt;Route path=&quot;/files/*.*&quot;&gt;// 匹配 /files/hello.jpg// 匹配 /files/hello.html&lt;Route path=&quot;/files/*&quot;&gt;// 匹配 /files/ // 匹配 /files/a// 匹配 /files/a/b&lt;Route path=&quot;/**/*.jpg&quot;&gt;// 匹配 /files/hello.jpg// 匹配 /files/path/to/file.jpg</code></pre><p>通配符的规则如下。</p><p>（1）<code>:paramName</code></p><p><code>:paramName</code>匹配URL的一个部分，直到遇到下一个<code>/</code>、<code>?</code>、<code>#</code>为止。这个路径参数可以通过<code>this.props.params.paramName</code>取出。</p><p>（2）<code>()</code></p><p><code>()</code>表示URL的这个部分是可选的。</p><p>（3）<code>*</code></p><p><code>*</code>匹配任意字符，直到模式里面的下一个字符为止。匹配方式是非贪婪模式。</p><p>（4） <code>**</code></p><p><code>**</code> 匹配任意字符，直到下一个<code>/</code>、<code>?</code>、<code>#</code>为止。匹配方式是贪婪模式。</p><p><code>path</code>属性也可以使用相对路径（不以<code>/</code>开头），匹配时就会相对于父组件的路径，可以参考上一节的例子。嵌套路由如果想摆脱这个规则，可以使用绝对路由。</p><p>路由匹配规则是从上到下执行，一旦发现匹配，就不再其余的规则了。</p><pre><code>&lt;Route path=&quot;/comments&quot; ... /&gt;&lt;Route path=&quot;/comments&quot; ... /&gt;</code></pre><p>上面代码中，路径<code>/comments</code>同时匹配两个规则，第二个规则不会生效。</p><p>设置路径参数时，需要特别小心这一点。</p><pre><code>&lt;Router&gt;  &lt;Route path=&quot;/:userName/:id&quot; component={UserPage}/&gt;  &lt;Route path=&quot;/about/me&quot; component={About}/&gt;&lt;/Router&gt;</code></pre><p>上面代码中，用户访问<code>/about/me</code>时，不会触发第二个路由规则，因为它会匹配<code>/:userName/:id</code>这个规则。因此，带参数的路径一般要写在路由规则的底部。</p><p>此外，URL的查询字符串<code>/foo?bar=baz</code>，可以用<code>this.props.location.query.bar</code>获取。</p><h3 id="五、IndexRoute-组件"><a href="#五、IndexRoute-组件" class="headerlink" title="五、IndexRoute 组件"></a>五、IndexRoute 组件</h3><p>下面的例子，你会不会觉得有一点问题？</p><pre><code>&lt;Router&gt;  &lt;Route path=&quot;/&quot; component={App}&gt;    &lt;Route path=&quot;accounts&quot; component={Accounts}/&gt;    &lt;Route path=&quot;statements&quot; component={Statements}/&gt;  &lt;/Route&gt;&lt;/Router&gt;</code></pre><p>上面代码中，访问根路径<code>/</code>，不会加载任何子组件。也就是说，<code>App</code>组件的<code>this.props.children</code>，这时是<code>undefined</code>。</p><p>因此，通常会采用<code>{this.props.children || &lt;Home/&gt;}</code>这样的写法。这时，<code>Home</code>明明是<code>Accounts</code>和<code>Statements</code>的同级组件，却没有写在<code>Route</code>中。</p><p><code>IndexRoute</code>就是解决这个问题，显式指定<code>Home</code>是根路由的子组件，即指定默认情况下加载的子组件。你可以把<code>IndexRoute</code>想象成某个路径的<code>index.html</code>。</p><pre><code>&lt;Router&gt;  &lt;Route path=&quot;/&quot; component={App}&gt;    &lt;IndexRoute component={Home}/&gt;    &lt;Route path=&quot;accounts&quot; component={Accounts}/&gt;    &lt;Route path=&quot;statements&quot; component={Statements}/&gt;  &lt;/Route&gt;&lt;/Router&gt;</code></pre><p>现在，用户访问<code>/</code>的时候，加载的组件结构如下。</p><pre><code>&lt;App&gt;  &lt;Home/&gt;&lt;/App&gt;</code></pre><p>这种组件结构就很清晰了：<code>App</code>只包含下级组件的共有元素，本身的展示内容则由<code>Home</code>组件定义。这样有利于代码分离，也有利于使用React Router提供的各种API。</p><p>注意，<code>IndexRoute</code>组件没有路径参数<code>path</code>。</p><h3 id="六、Redirect-组件"><a href="#六、Redirect-组件" class="headerlink" title="六、Redirect 组件"></a>六、Redirect 组件</h3><p><code>&lt;Redirect&gt;</code>组件用于路由的跳转，即用户访问一个路由，会自动跳转到另一个路由。</p><pre><code>&lt;Route path=&quot;inbox&quot; component={Inbox}&gt;  {/* 从 /inbox/messages/:id 跳转到 /messages/:id */}  ＜Redirect from=&quot;messages/:id&quot; to=&quot;/messages/:id&quot; /&gt;&lt;/Route&gt;</code></pre><p>现在访问<code>/inbox/messages/5</code>，会自动跳转到<code>/messages/5</code>。</p><h3 id="七、IndexRedirect-组件"><a href="#七、IndexRedirect-组件" class="headerlink" title="七、IndexRedirect 组件"></a>七、IndexRedirect 组件</h3><p><code>IndexRedirect</code>组件用于访问根路由的时候，将用户重定向到某个子组件。</p><pre><code>&lt;Route path=&quot;/&quot; component={App}&gt;  ＜IndexRedirect to=&quot;/welcome&quot; /&gt;  &lt;Route path=&quot;welcome&quot; component={Welcome} /&gt;  &lt;Route path=&quot;about&quot; component={About} /&gt;&lt;/Route&gt;</code></pre><p>上面代码中，用户访问根路径时，将自动重定向到子组件<code>welcome</code>。</p><h3 id="八、Link"><a href="#八、Link" class="headerlink" title="八、Link"></a>八、Link</h3><p><code>Link</code>组件用于取代<code>&lt;a&gt;</code>元素，生成一个链接，允许用户点击后跳转到另一个路由。它基本上就是<code>&lt;a&gt;</code>元素的React 版本，可以接收<code>Router</code>的状态。</p><pre><code>render() {  return &lt;div&gt;    &lt;ul role=&quot;nav&quot;&gt;      &lt;li&gt;&lt;Link to=&quot;/about&quot;&gt;About&lt;/Link&gt;&lt;/li&gt;      &lt;li&gt;&lt;Link to=&quot;/repos&quot;&gt;Repos&lt;/Link&gt;&lt;/li&gt;    &lt;/ul&gt;  &lt;/div&gt;}</code></pre><p>如果希望当前的路由与其他路由有不同样式，这时可以使用<code>Link</code>组件的<code>activeStyle</code>属性。</p><pre><code>&lt;Link to=&quot;/about&quot; activeStyle={ {color: &apos;red&apos;}}&gt;About&lt;/Link&gt;&lt;Link to=&quot;/repos&quot; activeStyle={ {color: &apos;red&apos;}}&gt;Repos&lt;/Link&gt;</code></pre><p>上面代码中，当前页面的链接会红色显示。</p><p>另一种做法是，使用<code>activeClassName</code>指定当前路由的<code>Class</code>。</p><pre><code>&lt;Link to=&quot;/about&quot; activeClassName=&quot;active&quot;&gt;About&lt;/Link&gt;&lt;Link to=&quot;/repos&quot; activeClassName=&quot;active&quot;&gt;Repos&lt;/Link&gt;</code></pre><p>上面代码中，当前页面的链接的<code>class</code>会包含<code>active</code>。</p><p>在<code>Router</code>组件之外，导航到路由页面，可以使用浏览器的History API，像下面这样写。</p><pre><code>import { browserHistory } from &apos;react-router&apos;;browserHistory.push(&apos;/some/path&apos;);</code></pre><h3 id="九、IndexLink"><a href="#九、IndexLink" class="headerlink" title="九、IndexLink"></a>九、IndexLink</h3><p>如果链接到根路由<code>/</code>，不要使用<code>Link</code>组件，而要使用<code>IndexLink</code>组件。</p><p>这是因为对于根路由来说，<code>activeStyle</code>和<code>activeClassName</code>会失效，或者说总是生效，因为<code>/</code>会匹配任何子路由。而<code>IndexLink</code>组件会使用路径的精确匹配。</p><pre><code>&lt;IndexLink to=&quot;/&quot; activeClassName=&quot;active&quot;&gt;  Home&lt;/IndexLink&gt;</code></pre><p>上面代码中，根路由只会在精确匹配时，才具有<code>activeClassName</code>。</p><p>另一种方法是使用<code>Link</code>组件的<code>onlyActiveOnIndex</code>属性，也能达到同样效果。</p><pre><code>&lt;Link to=&quot;/&quot; activeClassName=&quot;active&quot; onlyActiveOnIndex={true}&gt;  Home&lt;/Link&gt;</code></pre><p>实际上，<code>IndexLink</code>就是对<code>Link</code>组件的<code>onlyActiveOnIndex</code>属性的包装。</p><h3 id="十、histroy-属性"><a href="#十、histroy-属性" class="headerlink" title="十、histroy 属性"></a>十、histroy 属性</h3><p><code>Router</code>组件的<code>history</code>属性，用来监听浏览器地址栏的变化，并将URL解析成一个地址对象，供 React Router 匹配。</p><p><code>history</code>属性，一共可以设置三种值。</p><ul><li>browserHistory</li><li>hashHistory</li><li>createMemoryHistory</li></ul><p>如果设为<code>hashHistory</code>，路由将通过URL的hash部分（<code>#</code>）切换，URL的形式类似<code>example.com/#/some/path</code>。</p><pre><code>import { hashHistory } from &apos;react-router&apos;render(  &lt;Router history={hashHistory} routes={routes} /&gt;,  document.getElementById(&apos;app&apos;))</code></pre><p>如果设为<code>browserHistory</code>，浏览器的路由就不再通过<code>Hash</code>完成了，而显示正常的路径<code>example.com/some/path</code>，背后调用的是浏览器的History API。</p><pre><code>import { browserHistory } from &apos;react-router&apos;render(  &lt;Router history={browserHistory} routes={routes} /&gt;,  document.getElementById(&apos;app&apos;))</code></pre><p>但是，这种情况需要对<a href="https://github.com/reactjs/react-router/blob/master/docs/guides/Histories.md#configuring-your-server" target="_blank" rel="noopener">服务器改造</a>。否则用户直接向服务器请求某个子路由，会显示网页找不到的404错误。</p><p>如果开发服务器使用的是<code>webpack-dev-server</code>，加上<code>--history-api-fallback</code>参数就可以了。</p><pre><code>$ webpack-dev-server --inline --content-base . --history-api-fallback</code></pre><p><code>createMemoryHistory</code>主要用于服务器渲染。它创建一个内存中的<code>history</code>对象，不与浏览器URL互动。</p><pre><code>const history = createMemoryHistory(location)</code></pre><h3 id="十一、表单处理"><a href="#十一、表单处理" class="headerlink" title="十一、表单处理"></a>十一、表单处理</h3><p><code>Link</code>组件用于正常的用户点击跳转，但是有时还需要表单跳转、点击按钮跳转等操作。这些情况怎么跟React Router对接呢？</p><p>下面是一个表单。</p><pre><code>&lt;form onSubmit={this.handleSubmit}&gt;  &lt;input type=&quot;text&quot; placeholder=&quot;userName&quot;/&gt;  &lt;input type=&quot;text&quot; placeholder=&quot;repo&quot;/&gt;  &lt;button type=&quot;submit&quot;&gt;Go&lt;/button&gt;&lt;/form&gt;</code></pre><p>第一种方法是使用<code>browserHistory.push</code></p><pre><code>import { browserHistory } from &apos;react-router&apos;// ...  handleSubmit(event) {    event.preventDefault()    const userName = event.target.elements[0].value    const repo = event.target.elements[1].value    const path = `/repos/${userName}/${repo}`    browserHistory.push(path)  },</code></pre><p>第二种方法是使用<code>context</code>对象。</p><pre><code>export default React.createClass({  // ask for `router` from context  contextTypes: {    router: React.PropTypes.object  },  handleSubmit(event) {    // ...    this.context.router.push(path)  },})</code></pre><h3 id="十二、路由的钩子"><a href="#十二、路由的钩子" class="headerlink" title="十二、路由的钩子"></a>十二、路由的钩子</h3><p>每个路由都有<code>Enter</code>和<code>Leave</code>钩子，用户进入或离开该路由时触发。</p><pre><code>&lt;Route path=&quot;about&quot; component={About} /&gt;＜Route path=&quot;inbox&quot; component={Inbox}&gt;  ＜Redirect from=&quot;messages/:id&quot; to=&quot;/messages/:id&quot; /&gt;&lt;/Route&gt;</code></pre><p>上面的代码中，如果用户离开<code>/messages/:id</code>，进入<code>/about</code>时，会依次触发以下的钩子。</p><ul><li><code>/messages/:id</code>的<code>onLeave</code></li><li><code>/inbox</code>的<code>onLeave</code></li><li><code>/about</code>的<code>onEnter</code></li></ul><p>下面是一个例子，使用<code>onEnter</code>钩子替代<code>&lt;Redirect&gt;</code>组件。</p><pre><code>&lt;Route path=&quot;inbox&quot; component={Inbox}&gt;  &lt;Route    path=&quot;messages/:id&quot;    onEnter={      ({params}, replace) =&gt; replace(`/messages/${params.id}`)    }   /&gt;&lt;/Route&gt;</code></pre><p><code>onEnter</code>钩子还可以用来做认证。</p><pre><code>const requireAuth = (nextState, replace) =&gt; {    if (!auth.isAdmin()) {        // Redirect to Home page if not an Admin        replace({ pathname: &apos;/&apos; })    }}export const AdminRoutes = () =&gt; {  return (     &lt;Route path=&quot;/admin&quot; component={Admin} onEnter={requireAuth} /&gt;  )}</code></pre><p>下面是一个高级应用，当用户离开一个路径的时候，跳出一个提示框，要求用户确认是否离开。</p><pre><code>const Home = withRouter(  React.createClass({   componentDidMount() {      this.props.router.setRouteLeaveHook(        this.props.route,         this.routerWillLeave      )    },    routerWillLeave(nextLocation) {      // 返回 false 会继续停留当前页面，      // 否则，返回一个字符串，会显示给用户，让其自己决定      if (!this.state.isSaved)        return &apos;确认要离开？&apos;;    },  }))</code></pre><p>上面代码中，<code>setRouteLeaveHook</code>方法为<code>Leave</code>钩子指定<code>routerWillLeave</code>函数。该方法如果返回<code>false</code>，将阻止路由的切换，否则就返回一个字符串，提示用户决定是否要切换。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如果你用GitHub，可以这样提高效率</title>
      <link href="/github-improve-efficiency.html"/>
      <url>/github-improve-efficiency.html</url>
      
        <content type="html"><![CDATA[<p>如今作为一个敏捷性的开发团队，我们要保持快速的迭代速度的同时保证高质量的代码，这是一个艰巨的过程。</p><h3 id="版本管理-—-Git-Hub"><a href="#版本管理-—-Git-Hub" class="headerlink" title="版本管理 — Git~Hub"></a>版本管理 — Git~Hub</h3><blockquote><p>「开始的开始，我们还是孩子」(出自《北京路的日子》)</p></blockquote><p>开始的开始，我们还是用着SVN，代码存储在公司的服务器中，只有一个分支，提交代码无需审核，无需单元测试。因为我们只有几个人……</p><p>作为一个有逼格的团队，后来我们用上了Git，并且把代码迁移到Coding中去，然后引入了名为「git flow」的工作流，关于这个工作流可以参考我们老大的文章：<a href="http://www.jianshu.com/p/104fa8b15d1e" target="_blank" rel="noopener">「企业级开发：Gitflow Workflow工作流」</a></p><p>Coding真的是一款很不错的产品，可称为业届良心。</p><p>为什么当初没有直接用GitHub，因为私有仓库贵啊……</p><p>但，作为一个有逼格的团队，我们是不会满足于此的。Coding自身的服务很不错了，但是相对于GitHub的一些专业的第三方服务，缺少了那么一些竞争力。我们当时想接入持续集成的服务，但是无奈找不到支持Coding的第三方服务，代码Review也没有一个更让我们舒心的体验，我承认我们要求比较高。再加上Coding的几次down机，其中一次是我们准备发布新版本的那一个下午…..</p><p>终于有一天，我们老大两眼发光的跟我们说：我们要买GitHub的服务了，申请到资金了。</p><p>于是乎，我们浩浩荡荡的迁移代码库。</p><p>迁移到Github之后，我们开始接入各方工具，提高我们的工作效率（钱可不能白花啊）。</p><h3 id="武装GitHub-—-ZenHub"><a href="#武装GitHub-—-ZenHub" class="headerlink" title="武装GitHub — ZenHub"></a>武装GitHub — ZenHub</h3><blockquote><p><a href="https://www.zenhub.io/" target="_blank" rel="noopener">ZenHub</a> Project management inside GitHub Transform your GitHub issues</p></blockquote><p>正如Zenhub所说，这是一款项目管理工具，嵌入式集成到GitHub中。作为插件，它的UI完全迎合了GitHub，以至于你难以分别出哪些功能是GitHub的，哪些功能是Zenhub的。</p><p>如果你用了ZenHub，它会提供给你：</p><ol><li><strong>一套任务面板</strong>，给不同的任务提供不同的泳道，直观的展示每个任务的进度。于是乎我抛弃了Teambition。 1. <strong>一套个人的Todo List</strong>，如果有一个issue或者一个PR需要你来处理，但你现在没有空，你可以把它添加到Todo List中，于是乎我又抛弃了Wunderlist。</li><li><strong>一套项目图标与统计</strong>，结合着Github自带的项目图表，这个提供更多维度的数据，但是个人感觉意义不太大。</li><li><strong>再加一些小彩蛋</strong>，由于它是作为插件形式嵌入到Github中的，所以会在很多地方提供一些这样那样的按钮，等着你去发现了。</li></ol><h3 id="持续集成-—-TravisCI"><a href="#持续集成-—-TravisCI" class="headerlink" title="持续集成 — TravisCI"></a>持续集成 — TravisCI</h3><blockquote><p><a href="https://travis-ci.org/" target="_blank" rel="noopener">TravisCI</a> Test and Deploy with Confidence Easily sync your GitHub projects with Travis CI and you’ll be testing your code in minutes!</p></blockquote><p>不知道你有没有好奇Github上的一些明星项目的这样的标签：</p><p><a href="https://travis-ci.org/expressjs/express" target="_blank" rel="noopener"><img src="https://travis-ci.org/expressjs/express.svg?branch=master" alt="Build Status"></a></p><p>这个是Express的构建状态的标签，格式是svg，它会根据Express的构建状态改变。如果Express的某一次提交是没有通过TravisCI构建的，他会变成 build failing。（有心人可以点击这个标签进去看看。）</p><p>我们加入TravisCI主要目的是用于自动化的单元测试，每一次Commit与PR，TravisCI都会从Github仓库中拉取代码，然后执行我们写好的单元测试，通过与否会通过状态展示出来。 合并的人如果看到build failing，就不会合并了，这在一定程度上保证与提高了代码的质量。</p><p>TravisCI除了可以用来自动化单元测试，还可以自动化部署，可以设定，通过测试之后，就自动部署上线。</p><p>TravisCI对于公开仓库是免费的，但对于私有仓库是要收费的，而且价格也不便宜。 如果你觉得贵，这里还有一个可以代替的：<strong><a href="https://circleci.com/" target="_blank" rel="noopener">CircleCI</a></strong> TravisCI可以做的，它都可以做得到，而且会提供一个免费的私有仓库。</p><h3 id="代码Review-—-Reviewable"><a href="#代码Review-—-Reviewable" class="headerlink" title="代码Review — Reviewable"></a>代码Review — Reviewable</h3><blockquote><p><a href="https://reviewable.io/" target="_blank" rel="noopener">Reviewable</a> GitHub code reviews done right</p></blockquote><p>如果你觉得Github自带的Review还不够满足的话，可以尝试一下这款产品。 当你提交一个PR之后，在你的PR中，会在你的评论框中嵌入这样的按钮</p><p><img src="https://dn-cnode.qbox.me/FrDLVgDD6alCXnHAfk4XNHJCCnS_" alt></p><p>点击进入Reviewable的页面对应的PR进行review。</p><p>并且一个PR没有完成Review之前，是会一直被警告，让你警惕进行合并。</p><h3 id="代码覆盖率-—-Coveralls"><a href="#代码覆盖率-—-Coveralls" class="headerlink" title="代码覆盖率 — Coveralls"></a>代码覆盖率 — Coveralls</h3><blockquote><p><a href="http://coveralls.io/" target="_blank" rel="noopener">Coveralls</a> We help you deliver code confidently by showing which parts of your code aren’t covered by your test suite. Free for open source repos. Pro accounts for private repos. Instant sign up through GitHub and Bitbucket.</p></blockquote><p>在明星项目Express的Github项目主页中，你可以看到这样的标签：</p><p><a href="https://coveralls.io/github/strongloop/express?branch=master" target="_blank" rel="noopener"><img src="https://coveralls.io/repos/strongloop/express/badge.svg?branch=master&amp;service=github" alt="Coverage Status"></a></p><p>结合着TravisCI的自动化单元测试，加上这个测试覆盖率，提高你对项目的信心。</p><h3 id="快速进行沟通-—-Slack"><a href="#快速进行沟通-—-Slack" class="headerlink" title="快速进行沟通 — Slack"></a>快速进行沟通 — Slack</h3><blockquote><p><a href="https://slack.com/" target="_blank" rel="noopener">Slack</a> A messaging app for teams who see through the Earth</p></blockquote><p>相信大部分团队都是使用微信进行沟通的， 再一次，最为一个有逼格的团队，我们使用了Slack进行团队上的沟通，在Slack上，你可以创建频道(Channel)，不同Channel不同的人进行着不同的话题沟通。我们有设计的Channel、产品的Channel、开发的Channel。我最欣赏的是，Slack可以接入很多第三方服务，Github是其中一个。</p><p>接入Github之后，项目的每一个Commit、PR之类的动态信息，会被推送到聊天室中。</p><p>助你时刻掌控项目动态。</p><p><img src="https://dn-cnode.qbox.me/FjrMtthZ9pX08AWOKbIPlogDKBcK" alt></p><p>Slack接入Githu只是其中的一个小功能而已，更强大的在于Slack本身，利器如何用，待君慢慢体会。</p><p><strong>但</strong>，Slack有一个硬伤：不会科学上网，用不了呀。</p><h3 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h3><p>再一次，作为一个有逼格的团队，我们依然不会满足现状。</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>理解React 组件</title>
      <link href="/react-assembly-note.html"/>
      <url>/react-assembly-note.html</url>
      
        <content type="html"><![CDATA[<h3 id="理解React组件"><a href="#理解React组件" class="headerlink" title="理解React组件"></a>理解React组件</h3><p>在具体说明如何创建React组件的语法之前，对什么是React组件，其存在的意思及其划分依据等做一个论述是很有必要的。</p><p>我们设想现在有一个webApp，这个app可以用来实现很多功能，依据功能，我们可以把其划分为多个功能碎片。要实现这么一个功能碎片，可能需要更多更小的逻辑单元，甚至还可以继续分。而我们编程其实就是在有一个总体轮廓的前提下，通过解决一个个小小的问题来解决一个小问题，解决一个个小问题来实现软件的开发。React组件就是这样，你可以就把它当做一个个可组合的功能单元。</p><p>以一个登陆框为例，登录框本身就是网站的一个组件，但是其内包含诸如文本输入框，登陆按钮等，当然如果你想要做的只是最基础的功能，输入框和按钮等可以只是一个个React 节点，但是如果你想为输入框加上输入检测，输入框可能就有必要写成一个单独的组件了，这样也有利于复用，之后需要做的可能只是简单的通过<code>props</code>传入不同的参数就可以实现不同的检测。假想我们现在的登录框组件，包含React <code>&lt;Button&gt;</code>元素形成登录按钮，也包含多个文本输入检测组件。那么父组件的作用一方面在于聚合小组件形成更复杂的功能单元，另一方面在于为子组件信息的沟通提供渠道（比如说在满足一定的输入条件后，登录按钮的状态从不可点击变为可点击）。</p><h3 id="创建React组件"><a href="#创建React组件" class="headerlink" title="创建React组件"></a>创建React组件</h3><p>React组件通过调用<code>React.createClass()</code>方法创建，该方法需要传入一个对象形式的参数。在该对象中可以为所创建组件配置各种参数，其可用参数如下表：</p><p>方法(配置参数)名称</p><p>描述</p><p>render()</p><p>必填，通常为一个返回React nodes或者其它组件的函数</p><p>getInitialState()</p><p>一个用于设置最初的state的函数，返回一个对象</p><p>getDefaultProps()</p><p>一个用于设置默认`props`的函数，返回值为一个对象</p><p>propTypes</p><p>一个用于验证特定`props`类型的对象</p><p>mixins</p><p>组件间共享方法的途径</p><p>statics</p><p>一个由多个静态方法组成的对象，静态方法中不能直接调用`props`和`state`（可通过参数）</p><p>displayName</p><p>是一个用于命名组件的字符串，用于展示调试信息，使用JSX时将自动设置？？</p><p>componentWillMount()</p><p>在组件首次渲染前触发，只会触发一次</p><p>componentDidMount()</p><p>在组件首次渲染后触发，只会触发一次</p><p>componentWillReceiveProps()</p><p>在组件将接受新`props`时触发</p><p>shouldComponentUpdate()</p><p>组件再次渲染前触发，可用于判断是否需要再次渲染</p><p>componentWillUpdate()</p><p>组件再次渲染前立即触发</p><p>componentDidUpdate()</p><p>组件渲染后立即触发</p><p>componentWillUnmount()</p><p>组件卸载前立即触发</p><p>在上述所以方法中，最重要且必不可少的是`render()`，它的作用是返回React节点和组件，其它所有的方法是可选的。</p><p>实际写一个例子总比空说要容易理解，以下是使用React的<code>React.createClass()</code>创建的Timer组件</p><pre><code>var Timer = React.createClass({     getInitialState: function() {         return {            secondsElapsed: Number(this.props.startTime) || 0        };    },    tick: function() { //自定义方法        this.setState({            secondsElapsed: this.state.secondsElapsed + 1        });    },    componentDidMount: function() {//生命周期函数        this.interval = setInterval(this.tick, 1000);    },    componentWillUnmount: function() {//生命周期函数        clearInterval(this.interval);    },    render: function() { //使用JSX返回节点        return (            &lt;div&gt;                Seconds Elapsed: {this.state.secondsElapsed}            &lt;/div&gt;        );    }});ReactDOM.render(&lt; Timer startTime = &quot;60&quot; / &gt;, app); //pass startTime prop, used for state</code></pre><p><a href="https://jsfiddle.net/12u58fjb/#tabs=js,html,result" target="_blank" rel="noopener">点击JSFiddle查看效果</a>；</p><p>现在如果对上述组件创建的代码有所疑惑也不要紧，本文接下来将一步步的介绍上述代码中设计都的各个概念，包括<code>this</code>,生命周期函数，React返回值的格式，如何在React中自定义函数，以及React组件中事件的定义等等。</p><p>在此需要注意的是组件名是以大写开头的。</p><p>当一个组件被创建（挂载）以后，我们就可以使用组件的API了，一个组件包含以下四个API <strong><code>this.setState()</code>，</strong></p><pre><code>this.setState({mykey: &apos;my new value&apos;});  this.setState(function(previousState, currentProps)         { return {myInteger: previousState.myInteger + 1};         });</code></pre><p>作用：</p><pre><code>用以重新渲染组件或者子组件</code></pre><p><strong><code>replaceState()</code></strong></p><pre><code>this.replceState({mykey: &apos;my new value&apos;});</code></pre><p>作用：</p><pre><code>效果和`setState()`类似，不过并不会和老的状态合并，而是直接删除老的状态，应用新的状态。</code></pre><p><strong><code>forceUpdate()</code></strong></p><pre><code>this.forceUpdate(function(){//callback});</code></pre><p>作用：</p><pre><code>调用此方法将跳过组件的`shouldComponentUpdate()`事件，直接调用`render()`</code></pre><p><strong><code>isMounted()</code></strong></p><pre><code>this.isMounted()</code></pre><p>作用</p><pre><code>判断组件是否被挂载在DOM中，组件被挂载返回`true`,否则返回`false`</code></pre><p>最常用的组件API是<code>setState()</code>，后文还会细讲。</p><p><strong>小结</strong></p><ul><li><code>componentWillUnmount</code>,<code>componentDidUpdate</code>, <code>componentWillUpdate</code>, <code>shouldComponentUpdate</code>, <code>componentWillReceiveProps</code>, <code>componentDidMount</code>, <code>componentWillMount</code>等方法被称作React 组件的生命周期函数，它们会在组件生命过程的不同阶段被触发。</li><li><code>React.createClass()</code>是一个方便的创建组件实例的方法；</li><li><code>render()</code>方法应该保持纯洁；</li></ul><blockquote><p><code>render()</code>方法中不能更改组件状态</p></blockquote><h3 id="React组件的返回值"><a href="#React组件的返回值" class="headerlink" title="React组件的返回值"></a>React组件的返回值</h3><p>上文已经提到每个React组件必须有的方法就是<code>render()</code>，这个方法的返回值只能是一个react 节点或一个react组件，这个节点或组件中可以包含任意多的子节点或者子元素。在下面的例子中我们可以看到在<code>&lt;reactNode&gt;</code>中包含了多个子节点。</p><pre><code>var MyComponent = React.createClass({  render: function() {    return &lt;reactNode&gt; &lt;span&gt;test&lt;/span&gt; &lt;span&gt;test&lt;/span&gt; &lt;/reactNode&gt;;  }});ReactDOM.render(&lt;MyComponent /&gt;, app);</code></pre><p>值得注意的地方在于，如果你想返回的react 节点超过一行，应该用括号把返回值包围起来，如下所示</p><pre><code>var MyComponent = React.createClass({  render: function() {    return (        &lt;reactNode&gt;             &lt;span&gt;test&lt;/span&gt;            &lt;span&gt;test&lt;/span&gt;         &lt;/reactNode&gt;    );  }});ReactDOM.render(&lt;MyComponent /&gt;, app);</code></pre><p>另一个值得注意的地方是返回值最外层不能出现多个节点（组件），否者会报错</p><pre><code>var MyComponent = React.createClass({  render: function() {    return (            &lt;span&gt;test&lt;/span&gt;            &lt;span&gt;test&lt;/span&gt;     );  }});ReactDOM.render(&lt;MyComponent /&gt;, app);</code></pre><p>上述代码就会报错，报错信息如下</p><pre><code>babel.js:62789 Uncaught SyntaxError: embedded: Adjacent JSX elements must be wrapped in an enclosing tag (10:3)   8 |     return (   9 |             &lt;span&gt;test&lt;/span&gt;&gt; 10 |             &lt;span&gt;test&lt;/span&gt;     |    ^  11 |     );  12 |   }  13 | });</code></pre><p>一般来说开发者会在最外层加上一个<code>&lt;div&gt;</code>元素包裹其它节点以避免此类错误。</p><p>同样，如果<code>return()</code>中的最外层出现了多个组件，也会出错。</p><h3 id="获取组件实例的两种方法"><a href="#获取组件实例的两种方法" class="headerlink" title="获取组件实例的两种方法"></a>获取组件实例的两种方法</h3><p>当一个组件被<code>render</code>后，一个组件便通过传入的参数实例化了，我们有两种办法获取这个实例及其内部属性（<code>this.props</code>和<code>this.setState()</code>）。</p><p>第一种方法就是使用<code>this</code>关键字，在组件内部的方法中使用<code>this</code>我们发现，这个<code>this</code>指向的就是该组件实例。</p><pre><code>var Foo = React.createClass({    componentWillMount:function(){ console.log(this) },    componentDidMount:function(){ console.log(this) },    render: function() {        return &lt;div&gt;{console.log(this)}&lt;/div&gt;;    }});ReactDOM.render(&lt;Foo /&gt;, document.getElementById(&apos;app&apos;));</code></pre><p>获取某组件实例的另外一种方法是调用<code>ReactDOM.render()</code>方法，这个方法的返回值是最外层的组件实例。 看如下代码可以更好的理解这句话</p><pre><code>var Bar = React.createClass({    render: function() {        return &lt;div&gt;&lt;/div&gt;;    }});var foo; //store a reference to the instance outside of functionvar Foo = React.createClass({    render: function() {        return &lt;Bar&gt;{foo = this}&lt;/Bar&gt;;    }});var FooInstance = ReactDOM.render(&lt;Foo /&gt;, document.getElementById(&apos;app&apos;));console.log(FooInstance === foo); //true，说明返回值和指向一致</code></pre><p><strong>小结</strong><code>this</code>的最常见用法就是在一个组件内调用该组件的各个属性和方法，如<code>this.props.[NAME OF PROP]</code>，<code>this.props.children</code>,<code>this.state</code>,<code>this.setState()</code>,<code>this.replaceState()</code>等。</p><h3 id="在组件上定义事件"><a href="#在组件上定义事件" class="headerlink" title="在组件上定义事件"></a>在组件上定义事件</h3><p>第四章和第五章已经多次介绍过React的事件系统，事件可以被直接添加都React节点上，下面的代码示例中，我们添加了两个React事件（<code>onClick</code>&amp;<code>onMouseOver</code>）到React<code>&lt;div&gt;</code>节点中</p><pre><code>var MyComponent = React.createClass({    mouseOverHandler:function mouseOverHandler(e) {            console.log(&apos;you moused over&apos;);            console.log(e); //e is sysnthetic event instance        },    clickHandler:function clickhandler(e) {            console.log(&apos;you clicked&apos;);            console.log(e); //e is sysnthetic event instance        },    render:function(){        return (&lt;div onClick={this.clickHandler} onMouseOver={this.mouseOverHandler}&gt;click or mouse over&lt;/div&gt;        )    }});ReactDOM.render(&lt;MyComponent /&gt;, document.getElementById(&apos;app&apos;));</code></pre><p><a href="https://jsfiddle.net/sjL64ogk/#tabs=js,html,result" target="_blank" rel="noopener">点击JSFiddle查看效果</a>；</p><p>事件可以被看做是特殊的<code>props</code>，只是React对这些特殊的<code>props</code>的处理方式和普通的<code>props</code>有所不同。 这种不同表现在会自动为事件的回调函数绑定上下文，在下面的示例中，回调函数中的<code>this</code>指向了组件实例本身。</p><pre><code>var MyComponent = React.createClass({    mouseOverHandler:function mouseOverHandler(e) {            console.log(this); //this is component instance            console.log(e); //e is sysnthetic event instance        },    render:function(){        return (            &lt;div onMouseOver={this.mouseOverHandler}&gt;mouse over me&lt;/div&gt;        )    }});ReactDOM.render(&lt;MyComponent /&gt;, document.getElementById(&apos;app&apos;));</code></pre><p>React所支持的所以事件可见<a href="https://www.reactenlightenment.com/basic-react-components/6.5.html" target="_blank" rel="noopener">此表</a></p><p><strong>小结</strong></p><ul><li>React规范化了事件在不同浏览器中的表现，你可以放心的跨浏览器使用；</li><li>React事件默认在事件冒泡阶段（bubbling）触发，如果想在事件捕获阶段触发需要在事件名后加上<code>Capture</code>（如<code>onClick</code>变为<code>onClickCapture</code>）;</li><li>如果你想获知浏览器事件的详情，你可以通过在回调函数中查看<code>SyntheticEvent</code>对象中的<code>nativeEvent</code>值；</li><li>React实际上并未直接为React nodes添加事件，它使用的是<a href="http://domenlightenment.com/#11.14" target="_blank" rel="noopener">event delegation</a>事件委托机制</li><li>想要阻止事件冒泡，需要手动调用<code>e.stopPropagation()</code> 或<code>e.preventDefault()</code>，不要直接使用<code>returning false</code>,</li><li>React其实并没有支持所有的JS事件，不过它还提供额外的生命周期函数以供使用<a href="https://facebook.github.io/react/tips/dom-event-listeners.html" target="_blank" rel="noopener">React lifecycle methods</a>.</li></ul><h3 id="组件组合"><a href="#组件组合" class="headerlink" title="组件组合"></a>组件组合</h3><p>React组件的<code>render()</code>方法中可以包含对其它组件的引用，这使得组件之间可以嵌套，一般我们把被嵌套的组件称为嵌套组件的子组件。</p><p>下例中组件BadgeList包含了BadgeBill和BadgeTom两个组件。</p><pre><code>var BadgeBill = React.createClass({    render: function() {return &lt;div&gt;Bill&lt;/div&gt;;}});var BadgeTom = React.createClass({    render: function() {return &lt;div&gt;Tom&lt;/div&gt;;}});var BadgeList = React.createClass({    render: function() {        return (&lt;div&gt;            &lt;BadgeBill/&gt;            &lt;BadgeTom /&gt;        &lt;/div&gt;);    }});ReactDOM.render(&lt;BadgeList /&gt;, document.getElementById(&apos;app&apos;));</code></pre><p>此处为展示嵌套关系，代码有所简化。</p><p><strong>小结</strong></p><ul><li>编写可维护性UI的关键之一在于可组合组件，React组件天然适用这一原理；</li><li>在<code>render</code>方法中，组件和<code>HTML</code>可以组合使用；</li></ul><h3 id="React组件的生命周期函数"><a href="#React组件的生命周期函数" class="headerlink" title="React组件的生命周期函数"></a>React组件的生命周期函数</h3><p>每个组件都具有一系列的发生在其生命中不同阶段的事件，这些事件被称为生命周期函数。</p><p>生命周期函数可以理解为React为组件的不同阶段提供了的钩子函数，用以更好的操作组件，下例是一个定时器组件，其在不同生命周期函数中执行了不同的事件</p><pre><code>var Timer = React.createClass({    getInitialState: function() {         console.log(&apos;getInitialState lifecycle method ran!&apos;);        return {secondsElapsed: Number(this.props.startTime) || 0};    },    tick: function() {        console.log(ReactDOM.findDOMNode(this));        if(this.state.secondsElapsed === 65){            ReactDOM.unmountComponentAtNode(ReactDOM.findDOMNode(this).parentNode);            return;        }        this.setState({secondsElapsed: this.state.secondsElapsed + 1});    },    componentDidMount: function() {        console.log(&apos;componentDidMount lifecycle method ran!&apos;);        this.interval = setInterval(this.tick, 1000);    },    componentWillUnmount: function() {        console.log(&apos;componentWillUnmount lifecycle method ran!&apos;);        clearInterval(this.interval);    },    render: function() {        return (&lt;div&gt;Seconds Elapsed: {this.state.secondsElapsed}&lt;/div&gt;);    }});ReactDOM.render(&lt; Timer startTime = &quot;60&quot; / &gt;, app);</code></pre><p>组件的生命周期可被分为挂载（Mounting），更新（Updating）和卸载（UnMounting）三个阶段。</p><p>下面将对不同阶段各函数的功能及用途进行描述，弄清这一点很重要 <strong>挂载阶段</strong></p><blockquote><p>这是React组件生命周期的第一个阶段，也可以称为组件出生阶段，这个阶段组件被初始化，获得初始的<code>props</code>并定义将会用到的<code>state</code>,此阶段结束时，组件及其子元素都会在UI中被渲染（DOM，UIview等），我们还可以对渲染后的组件进行进一步的加工。这个阶段的所有方法在组件生命中只会被触发一次。<a href="https://developmentarc.gitbooks.io/react-indepth/content/life_cycle/introduction.html" target="_blank" rel="noopener">React-in-depth</a></p></blockquote><p><strong>对挂载阶段的生命周期函数的描述</strong></p><p>方法</p><p>描述</p><p>`getInitialState()`</p><p>在组件挂载前被触发，富状态组件应该调用此方法以获得初始的状态值</p><p>`componentWiillMount()`</p><p>在组件挂载前被触发，富状态组件应该调用此方法以获得初始的状态值</p><p>`componentWillMount()`</p><p>组件被挂载后立即触发，在此可以对DOM进行操作了</p><p><strong>更新阶段</strong></p><blockquote><p>这个阶段的函数会在组件的整个生命周期中不断被触发，这是组件一生中最长的时期。这个阶段的函数可以获得新的<code>props</code>,可以更改<code>state</code>，可以对用户的交互进行反应。<a href="https://developmentarc.gitbooks.io/react-indepth/content/life_cycle/introduction.html" target="_blank" rel="noopener">React-in-depth</a></p></blockquote><p><strong>对更新阶段的生命周期函数的描述</strong></p><p>方法</p><p>描述</p><p>`componentWillReceiveProps(object nextProps)`</p><p>在组件接受新的`props`时被触发，可以用来比较新老`props`，并使用`this.setState()`来改变组件状态</p><p>`shouldComponentUpdate(object nextProps, object nextState)`</p><p>此组件可以对比新老`props`和`state`，用以确认该组件是否需要重新渲染，如果返回值为`false`，将跳过此次渲染，此方法常用于优化React性能</p><p>`componentWillUpdate(object nextProps, object nextState)`</p><p>在组件重新渲染前被触发，此时不能再调用`this.setState()`对`state`进行更改</p><p>`componentDidUpdate(object prevProps, object prevState)`</p><p>在重新渲染后立即被触发，此时可调用新的DOM了</p><p><strong>卸载阶段</strong></p><blockquote><p>这是组件生命的最后一个阶段，也可以被称为是组件的死亡阶段，此阶段对应组件从Native UI中卸载之时，具体说来可能是用户切换了页面，或者页面改变去除了某个组件，卸载阶段的函数只会被触发一次，然后该组件就会被加入浏览器的垃圾回收机制。<a href="https://developmentarc.gitbooks.io/react-indepth/content/life_cycle/introduction.html" target="_blank" rel="noopener">React-in-depth</a></p></blockquote><p><strong>对此阶段的生命周期函数的描述</strong></p><p>方法</p><p>描述</p><p>`componentWillUnmount()`</p><p>组件卸载前立即被触发，此阶段常用来执行一些清理工作（比如说清除`setInterval`）</p><p><strong>小结</strong></p><ul><li><code>componentDidMount</code> 和 <code>componentDidUpdate</code> 常用来加载第三方的库（此时真实DOM存在，可加载各种图表库）。</li><li>组件挂载阶段的各事件执行顺序如下 1. Initialize / Construction</li></ul><ol start="2"><li>获取初始的props，ES5中使用 <code>getDefaultProps()</code> (React.createClass),ES6中使用 <code>MyComponent.defaultProps</code>(ES6 class)</li><li>初始组件的<code>state</code>值，ES5中使用<code>getInitialState()</code> (React.createClass) ,ES6中使用 <code>this.state = ...</code>(ES6 constructor)</li><li><code>componentWillMount()</code></li><li><code>render()</code>第一次渲染</li><li>Children initialization &amp; life cycle kickoff，子组件重复上述(1~5步)过程；</li><li><code>componentDidMount()</code></li></ol><blockquote><p>通过上面的过程分析，我们可以知道，在父元素执行<code>componentDidMount()</code>时,子元素和子组件都已经存在于真实DOM中了，因此在此可以放心调用。</p></blockquote><ul><li>组件更新阶段各函数执行顺序如下 1. <code>componentWillReceiveProps()</code>:比较新老<code>props</code>,对<code>state</code>进行改变；</li></ul><ol start="2"><li><code>shouldComponentUpdate()</code>：判断组件是否需要重新渲染</li><li><code>render()</code>：重新渲染</li><li><code>Children Life cycle methods</code>：子元素重复上述过程</li><li><code>componentWillUpdate()</code>：此阶段可以调用新的DOM了</li></ol><ul><li>组件卸载阶段各函数执行顺序如下 1. <code>componentWillUnmount()</code></li></ul><ol start="2"><li>Children Life cycle methods:触发子元素的生命周期函数，也将被卸载</li><li>被浏览器从内存中清除；</li></ol><h3 id="获取子组件和子节点的方法"><a href="#获取子组件和子节点的方法" class="headerlink" title="获取子组件和子节点的方法"></a>获取子组件和子节点的方法</h3><p>如果一个组件包含子组件或React节点(如<code>&lt;Parent&gt;&lt;Child /&gt;&lt;/Parent&gt;</code> 或 <code>&lt;Parent&gt;&lt;span&gt;test&lt;span&gt;&lt;/Parent&gt;</code>)，这些子节点和子组件可以通过React的<code>this.props.children</code>的方法来获取。</p><p>下面的例子展示了如何使用<code>this.props.children</code></p><pre><code>var Parent2 = React.createClass({  componentDidMount: function() {    //将会获得&lt;span&gt;child2text&lt;/span&gt;,    console.log(this.props.children);    //将会获得 child2text, 或得了子元素&lt;span&gt;的子元素    console.log(this.props.children.props.children);  },  render: function() {return &lt;div /&gt;;}});var Parent = React.createClass({  componentDidMount: function() {    //获得了一个数组 &lt;div&gt;test&lt;/div&gt; &lt;div&gt;test&lt;/div&gt;    console.log(this.props.children);    //获得了这个数组中的对应子元素中的子元素 childtext,    console.log(this.props.children[1].props.children);  },  render: function() {return &lt;Parent2&gt;&lt;span&gt;child2text&lt;/span&gt;&lt;/Parent2&gt;;}});ReactDOM.render(  &lt;Parent&gt;&lt;div&gt;child&lt;/div&gt;&lt;div&gt;childtext&lt;/div&gt;&lt;/Parent&gt;,  document.getElementById(&apos;app&apos;));</code></pre><p>观察上述的代码可以看出以下几点</p><ul><li>Parent组件实例的<code>this.props.children</code>获取到由直系子元素组成的数组，可以对子元素套用此方法获得子元素（组件）的子元素（组件）（<code>this.props.children[1].props.children</code>）;</li><li>子元素指的是由该实例围起来的元素，而非该实例内部元素；</li></ul><p>为了更好的操作<code>this.props.children</code>包含的是一组元素，React还提供了以下方法</p><p>方法</p><p>描述</p><p>`React.Children.map(this.props.children, function(){})`</p><p>在每一个直接子级（包含在 children 参数中的）上调用 fn 函数，此函数中的 this 指向 上下文。如果 children 是一个内嵌的对象或者数组，它将被遍历,每个键值对都会添加到新的 Map。如果 children 参数是 null 或者 undefined，那么返回 null 或者 undefined 而不是一个空对象。</p><p>`React.Children.forEach(this.props.children, function(){})`</p><p>类似于`Children.map()`但是不会反回数组</p><p>`React.Children.count(this.props.children)`</p><p>返回组件子元素的总数量，其数目等于`Children.map()`和`Children.forEach()`的执行次数。</p><p>`React.Children.only(this.props.children)`</p><p>返回唯一的子元素否则报错</p><p>`React.Children.toArray(this.props.children)`</p><p>返回一个由各子元素组成的数组，如果你想在render事件中操作子元素的集合时，这个方法特别有用，尤其是在重新排序或分割子元素时</p><p><strong>小结</strong></p><ul><li>当只有一个子元素时，<code>this.props.children</code>之间返回该子元素，不会用一个数组包裹着该子元素；</li><li>需要注意的是<code>children</code>并非某组件内部的节点，而是由该组件包裹的组件或节点‘</li></ul><h3 id="两种ref"><a href="#两种ref" class="headerlink" title="两种ref"></a>两种<code>ref</code></h3><p><code>ref</code>属性使得我们获取了对某一个React节点或某一个子组件的引用，这个在你需要直接操作DOM时非常有用。</p><p>字符串<code>ref</code>的使用很简单，可分为两步：</p><ul><li>一是给你想引用的的子元素或组件添加<code>ref</code>属性，</li><li>然后在本组件中通过<code>this.refs.value（你所设置的属性名）</code>即可引用；</li></ul><p>不过还存在一种函数式的ref，看下面的例子</p><pre><code>var C2 = React.createClass({  render: function() {return &lt;span ref={function(span) {console.log(span)}} /&gt;}});var C1 = React.createClass({  render: function() {return(          &lt;div&gt;              &lt;C2 ref={function(c2) {console.log(c2)}}&gt;&lt;/C2&gt;              &lt;div ref={function(div) {console.log(div)}}&gt;&lt;/div&gt;        &lt;/div&gt;)}});ReactDOM.render(&lt;C1 ref={function(ci) {console.log(ci)}} /&gt;,document.getElementById(&apos;app&apos;));</code></pre><p>上述例子的console结果都是指向ref所在的组件或元素，通过console的结果我们也可以发现，打印结果说明其指向的是真实的HTML DOM而非Virtual DOM。</p><p>如果不想用字符串<code>ref</code>，通过下面的方法也可以引用到你想引用的节点</p><pre><code>var MyComponent = React.createClass({  handleClick: function() {    // focus()对真实DOM元素有效      this.textInput.focus();  },  render: function() {    // ref中传入了一个回调函数，把该节点本身赋值给this.input    return (      &lt;div&gt;        &lt;input type=&quot;text&quot; ref={(thisInput) =&gt; {this.textInput = thisInput}} /&gt;        &lt;input          type=&quot;button&quot;          value=&quot;Focus the text input&quot;          onClick={this.handleClick}        /&gt;      &lt;/div&gt;    );  }});ReactDOM.render(  &lt;MyComponent /&gt;,  document.getElementById(&apos;app&apos;));</code></pre><p><strong>小结</strong></p><ul><li>对无状态函数式组件不能使用<code>ref</code>，因为这种组件并不会返回一个实例；</li><li>ref有两种，字符串ref和函数式ref，不过字符串ref（通过refs调用这种）在未来可能被放弃，函数式ref是趋势；</li><li>组件有ref，可以通过ref调用该组件内部的方法；</li><li>使用行内函数表达式使用ref意味着每次更新React都会将其视为一个不同的函数对象，ref中的函数会以null为参数被立即执行（和在实例中调用不冲突）。比如说，当ref所指向的对象被卸载时，或者ref改变时，老的的ref函数都会以null为参数被调用。</li><li>对应ref的使用，React官方有两点建议： 1. ref允许你直接操作节点，这一点有些情况下是非常方便的，不过需要注意的是，如果可以通过更改<code>state</code>来达到你想要的效果，那就不要随便使用ref啦；</li></ul><ol start="2"><li>如果你刚刚接触React，在你想用ref的时候，还是尽量多思考一下看能不能用<code>state</code>来解决，仔细思考你会发现，<code>state</code>可以解决大部分操作问题的，比较直接操作DOM并未React的初衷。</li></ol><h3 id="重新渲染一个组件"><a href="#重新渲染一个组件" class="headerlink" title="重新渲染一个组件"></a>重新渲染一个组件</h3><p>我们已经接触了<code>ReactDOM.render()</code>方法，这个方法使得组件及其子组件被初始化渲染。在这次渲染之后，React为我们提供了两种方法来重新渲染某个组件</p><ol><li>在组件内调用<code>setState()</code>方法；</li><li>在组件中调用<code>fouceUpdate()</code>方法；</li></ol><p>每当一个组件被重新渲染时，其子组件也会被重新渲染（在Virtual DOM中发生，在真实DOM中表现出来）。不过需要注意的是Virtual DOM的改变并不是一定在真实DOM中就会有所表现。</p><p>在下面的例子中，<code>ReactDOM.render(&lt; App / &gt;, app)</code>初始化渲染了<code>&lt;App/&gt;</code>及其子组件<code>&lt;Timer/&gt;</code>，接下来的<code>&lt;App/&gt;</code>中的<code>setInterval()</code>事件调用<code>this.setState()</code>致使两个组件被重新渲染。在5秒后，<code>setInterval()</code>被清除，而在十秒后<code>this.forceUpdate()</code>被触发又使得页面被重新渲染。</p><pre><code>var Timer = React.createClass({    render: function() {      return (          &lt;div&gt;{this.props.now}&lt;/div&gt;        )    }});var App = React.createClass({  getInitialState: function() {    return {now: Date.now()};  },  componentDidMount: function() {    var foo = setInterval(function() {        this.setState({now: Date.now()});    }.bind(this), 1000);    setTimeout(function(){ clearInterval(foo); }, 5000);    //DON&apos;T DO THIS, JUST DEMONSTRATING .forceUpdate()     setTimeout(function(){ this.state.now = &apos;foo&apos;; this.forceUpdate() }.bind(this), 10000);  },  render: function() {      return (          &lt;Timer now={this.state.now}&gt;&lt;/Timer&gt;        )    }});ReactDOM.render(&lt; App / &gt;, app);</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java之值传递Or引用传递？</title>
      <link href="/java-reference-or-value.html"/>
      <url>/java-reference-or-value.html</url>
      
        <content type="html"><![CDATA[<p>我们来看一个新手甚至写了多年Java的朋友都可能不是十分确定的问题：</p><blockquote><p>在Java方法传参时，究竟是引用传递还是值传递？</p></blockquote><p>为了说明问题， 我给出一个非常简单的class定义：</p><pre><code>public class Foo {  String attribute;  Foo(String s) {    this.attribute = s;  }  void setAttribute(String s) {    this.attribute = s;  }  String getAttribute() {    return this.attribute;  }}</code></pre><p>下面在阐明观点时，可能会多次用到该类。</p><p>关于Java里值传递还是引用传递，至少从表现形式上来看，两种观点都有支撑的论据。下面我来一一分析：</p><h2 id="观点1：引用传递"><a href="#观点1：引用传递" class="headerlink" title="观点1：引用传递"></a>观点1：引用传递</h2><p>理由如下：先看一段代码</p><pre><code>public class Main {  public static void modifyReference(Foo c){    c.setAttribute(&quot;c&quot;); // line DDD  }  public static void main(String[] args) {    Foo fooRef = new Foo(&quot;a&quot;); // line AAA    modifyReference(fooRef); // line BBB    System.out.println(fooRef.getAttribute()); // 输出 c  }}</code></pre><p>上述示例，输出结果为<code>&quot;c&quot;</code>，而不是<code>&quot;c&quot;</code>。</p><p>我们在<code>line AAA</code>处新创建了一个Object Foo并将其引用<code>fooRef</code>在<code>line BBB</code>处传给了方法<code>modifyReference()</code>的参数<code>cRef</code>, 该方法内部处理后，<code>fooRef</code>指向的Object中的值从”a”变成了”c”, 而引用<code>fooRef</code>还是那个引用， 因此，我们是否可以认为，在<code>line BBB</code>处发生了引用传递？</p><p>先留着疑问，我们继续往下看。</p><h2 id="观点2：值传递"><a href="#观点2：值传递" class="headerlink" title="观点2：值传递"></a>观点2：值传递</h2><p>继续看一段代码</p><pre><code>public class Main {  public static void changeReference(Foo aRef){    Foo bRef = new Foo(&quot;b&quot;);    aRef = bRef;   // line EEE  }  public static void main(String[] args) {    Foo fooRef = new Foo(&quot;a&quot;); // line AAA    changeReference(fooRef); // line BBB    System.out.println(fooRef.getAttribute()); // 输出 a  }}</code></pre><p>上述示例，输出结果为<code>&quot;a&quot;</code>， 而不是<code>&quot;b&quot;</code>。</p><p>我们在<code>line AAA</code>处新创建了一个Object Foo并将其引用<code>fooRef</code>在<code>line EEE</code>处传给了方法<code>changeReference()</code>的参数<code>aRef</code>, 该方法内部引用<code>aRef</code>在<code>line DDD</code>处被重新赋值。如果是引用传递，那么引用<code>aRef</code>在<code>line EEE</code>处已经被指向了新的Object, 输出应该为<code>&quot;b&quot;</code>才对，事实上是怎样的呢？事实上输出了<code>&quot;b&quot;</code>,也就是说<code>changeReference()</code>方法改变了传入引用所指对象的值。</p><p>观点1和观点2的输出结果多少会让人有些困惑，别急，我们继续往下看。</p><h2 id="深入分析"><a href="#深入分析" class="headerlink" title="深入分析"></a>深入分析</h2><p>为了详细分析这个问题，把上述两段代码合起来：</p><pre><code>public class Main {  public static void modifyReference(Foo cRef){    cRef.setAttribute(&quot;c&quot;); // line DDD  }  public static void changeReference(Foo aRef){    Foo bRef = new Foo(&quot;b&quot;); // line FFF    aRef = bRef;   // line EEE  }  public static void main(String[] args) {    Foo fooRef = new Foo(&quot;a&quot;); // line AAA    changeReference(fooRef); // line BBB    System.out.println(fooRef.getAttribute()); // 输出 a    modifyReference(fooRef); // line CCC    System.out.println(fooRef.getAttribute()); // 输出 c  }}</code></pre><p>下面来深入内部来详细分析一下引用和Object内部的变化。来看下面图示：</p><blockquote><p>① Line AAA, 申明一个名叫<code>fooRef</code>，类型为<code>Foo</code>的引用，并见其分配给一个新的包含属性值为<code>&quot;f&quot;</code>的对象，该对象类型为<code>Foo</code>。</p></blockquote><pre><code>Foo fooRef = new Foo(&quot;a&quot;); // line AAA</code></pre><p><img src="https://segmentfault.com/img/bVDb94?w=182&amp;h=264" alt></p><blockquote><p>② Line DDD, 方法内部，申明了一个<code>Foo</code>类型的名为<code>aRef</code>的引用，且<code>aRef</code>被初始化为<code>null</code>。</p></blockquote><pre><code>void changeReference(Foo a);</code></pre><p><img src="https://segmentfault.com/img/bVDcbr?w=391&amp;h=278" alt></p><blockquote><p>③ Line CCC, <code>changeReference()</code>方法被调用后，引用<code>aRef</code>被分配给<code>fooRef</code>指向的对象。</p></blockquote><pre><code>changeReference(fooRef);</code></pre><p><img src="https://segmentfault.com/img/bVDcbB?w=369&amp;h=281" alt></p><blockquote><p>④ Line FFF, 申明一个名叫<code>bRef</code>，类型为<code>Foo</code>的引用，并见其分配给一个新的包含属性值为<code>&quot;b&quot;</code>的对象，该对象类型为<code>Foo</code>。</p></blockquote><pre><code>Foo bRef = new Foo(&quot;b&quot;);</code></pre><p><img src="https://segmentfault.com/img/bVDcbL?w=595&amp;h=291" alt></p><blockquote><p>⑤ Line EEE, 将引用<code>aRef</code>重新分配给了包含属性<code>&quot;b&quot;</code>的对象。此处注意，并非将<code>fooRef</code>重新分配，而是<code>aRef</code>。</p></blockquote><pre><code>aRef = bRef;</code></pre><p><img src="https://segmentfault.com/img/bVDcck?w=591&amp;h=290" alt></p><blockquote><p>⑥ Line CCC, 调用方法<code>modifyReference(Foo cRef)</code>后，新建了一个引用<code>cRef</code>并将之分配到包含该属性<code>&quot;f&quot;</code>的对象上，该对象同时被两个引用<code>fooRef</code>和<code>cRef</code>指向着。</p></blockquote><pre><code>modifyReference(fooRef);</code></pre><p><img src="https://segmentfault.com/img/bVDcc0?w=364&amp;h=269" alt></p><blockquote><p>⑦ Line DDD, <code>cRef.setAttribute(&quot;c&quot;);</code>将会改变<code>cRef</code>引用指向的包含属性<code>&quot;f&quot;</code>的对象，而该对象同时被引用<code>fooRef</code>指向着。</p></blockquote><pre><code>cRef.setAttribute(&quot;c&quot;);</code></pre><p><img src="https://segmentfault.com/img/bVDcdG?w=385&amp;h=274" alt></p><p>此时引用<code>fooRef</code>指向的对象内部属性值<code>&quot;f&quot;</code>也被重新设置为<code>&quot;c&quot;</code>。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Java内部方法传参不是引用传递，而是引用本身的”值”的传递，归根结底还是<strong>值传递</strong>。将一个对象的引用<code>fooRef</code>传给方法的形参<code>newRef</code>，将给该对象新增了一个引用，相当于多了一个<code>alias</code>。我们可以通过这个原引用<code>fooRef</code>，或这是方法参数里的新引用<code>newRef</code>去访问、操作原对象，也可以改变参数里的引用<code>newRef</code>本身的值，却无法改变原引用<code>fooRef</code>的值。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Centos环境安装Ghost Blog（下）</title>
      <link href="/centos-install-ghost-blog-2.html"/>
      <url>/centos-install-ghost-blog-2.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>上篇文章<a href="https://i95.me/centos-install-ghost-blog-1.html" target="_blank" rel="noopener">Centos环境安装Ghost Blog（上）</a>如何搭建Ghost博客。今天这篇文章如何提高Ghost站点安全。</p><h3 id="使用https协议"><a href="#使用https协议" class="headerlink" title="使用https协议"></a>使用https协议</h3><p>关于证书，我就不多说了，现在大部分主机提供商都有免费的SSL证书。<a href="https://blog.linuxeye.com/448.html" title="Oneinstack环境包可以自动部署SSl证书" target="_blank" rel="noopener">Oneinstack环境包可以自动部署SSl证书</a>，有兴趣的朋友可以点进去看看！</p><p>让站点支持SSL很简单，修改下你的域名config配置文件就行了：</p><pre><code>server {listen 80;listen 443 ssl http2;ssl on;ssl_certificate /usr/local/nginx/conf/ssl/boxrom.com.crt;ssl_certificate_key /usr/local/nginx/conf/ssl/boxrom.com.key;ssl_protocols TLSv1 TLSv1.1 TLSv1.2;ssl_ciphers EECDH+CHACHA20:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5;ssl_prefer_server_ciphers on;ssl_session_timeout 10m;ssl_session_cache builtin:1000 shared:SSL:10m;ssl_buffer_size 1400;add_header Strict-Transport-Security max-age=15768000;ssl_stapling on;ssl_stapling_verify on;server_name boxrom.com www.boxrom.com;access_log /data/wwwlogs/boxrom.com_nginx.log combined;add_header Strict-Transport-Security &quot;max-age=31536000; includeSubdomains; preload&quot;;if ($ssl_protocol = &quot;&quot;) { return 301 https://$host$request_uri; } #强制跳转到httpsif ($host != boxrom.com) {    rewrite ^/(.*)$ $scheme://boxrom.com/$1 permanent;    } #301跳转location / {    proxy_set_header   X-Real-IP $remote_addr;    proxy_set_header   Host      $http_host;    proxy_pass         http://127.0.0.1:2368;    }}</code></pre><p>记得把里面的注释删去，以上配置文件可以使用https协议访问站点。</p><h3 id="提高Ghost安全"><a href="#提高Ghost安全" class="headerlink" title="提高Ghost安全"></a>提高Ghost安全</h3><p><a href="https://github.com/TryGhost/Ghost/issues/887" target="_blank" rel="noopener">相关文档</a></p><blockquote><p>使用UNIX Domain Socket代替IP加端口</p></blockquote><p>首先编辑Ghost的config.js文件。将第37行附近的server</p><pre><code>server: {    host: &apos;127.0.0.1&apos;,    port: &apos;2368&apos; }</code></pre><p>替换成下面内容，注意根据自己的ghost安装目录更改路径。</p><pre><code>server: {           socket: {               path: &apos;/data/wwwroot/boxrom.com/socket.sock&apos;,               permissions: &apos;0666&apos;              }         },</code></pre><p>最终成下面这个样子</p><pre><code>config = {    // ### Production    // When running Ghost in the wild, use the production environment.    // Configure your URL and mail settings here    production: {        url: &apos;http://boxrom.com&apos;,        mail: {},        /*database: {            client: &apos;sqlite3&apos;,            connection: {                filename: path.join(__dirname, &apos;/content/data/ghost.db&apos;)            },            debug: false        },*/        // 配置MySQL 数据库        database: {            client: &apos;mysql&apos;,            connection: {                host     : &apos;127.0.0.1&apos;,                user     : &apos;root&apos;,                password : &apos;root.&apos;,                database : &apos;root&apos;,                charset  : &apos;utf8&apos;            },            debug: false        },        //server: {        //    host: &apos;0.0.0.0&apos;,        //    port: &apos;2368&apos;        //},        server: {           socket: {               path: &apos;/data/wwwroot/boxrom.com/socket.sock&apos;,               permissions: &apos;0666&apos;              }         },        //Storage.Now,we can support `qiniu`,`upyun`, `aliyun oss`, `aliyun ace-storage` and `local-file-store`        storage: {            provider: &apos;local-file-store&apos;        }        // or        // 参考文档： http://www.ghostchina.com/qiniu-cdn-for-ghost/        /*storage: {            provider: &apos;qiniu&apos;,            bucketname: &apos;your-bucket-name&apos;,            ACCESS_KEY: &apos;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&apos;,            SECRET_KEY: &apos;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&apos;,            root: &apos;/image/&apos;,            prefix: &apos;http://your-bucket-name.qiniudn.com&apos;        }*/        // or        // 参考文档： http://www.ghostchina.com/upyun-cdn-for-ghost/        /*storage: {            provider: &apos;upyun&apos;,            bucketname: &apos;your-bucket-name&apos;,            username: &apos;your user name&apos;,            password: &apos;your password&apos;,            root: &apos;/image/&apos;,            prefix: &apos;http://your-bucket-name.b0.upaiyun.com&apos;        }*/        // or        // 参考文档： http://www.ghostchina.com/aliyun-oss-for-ghost/        /*storage: {            provider: &apos;oss&apos;,            bucketname: &apos;your-bucket-name&apos;,            ACCESS_KEY: &apos;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&apos;,            SECRET_KEY: &apos;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&apos;,            root: &apos;/image/&apos;,            endpoint: &apos;http://oss-cn-hangzhou.aliyuncs.com&apos;,  //阿里云的上传端点是分地域的，需要单独设置            prefix: &apos;http://your-bucket-name.oss-cn-hangzhou.aliyuncs.com&apos;        }*/    },</code></pre><p>然后<code>pm2 restart ghost</code>重启Ghost,会发现ghost目录下多出一个socket.sock文件夹。设置它的权限为777。这时打开博客会出现502错误，很正常。因为Nginx还没做对应修改。</p><pre><code>chmod 777 socket.sock</code></pre><blockquote><p>配置Nginx</p></blockquote><p>下面开始配置你的域名nginx.config</p><h4 id="首先定义一个upstream来说明ghost运行位置。"><a href="#首先定义一个upstream来说明ghost运行位置。" class="headerlink" title="首先定义一个upstream来说明ghost运行位置。"></a>首先定义一个upstream来说明ghost运行位置。</h4><pre><code>upstream ghost_upstream {    server unix:/data/wwwroot/boxrom.com/socket.sock;    keepalive 64;}</code></pre><p>这段配置告诉nginx，Ghost运行的路径，同时设定连接保持64秒以避免每个请求都要重建连接。</p><h4 id="代理缓存"><a href="#代理缓存" class="headerlink" title="代理缓存"></a>代理缓存</h4><p>我们希望nginx能缓存下来自Ghost的响应，从而避免每个（来自客户端）请求都通过反向代理再次向 Ghost 应用发起请求。这时要做的第一件事是在配置文件中设置proxy_cache_path。下面这段配置设定了一个 100MB 的内存空间来缓存来自 Ghost 的响应，并且会在 24 小时后移除那些没有被再次请求的文件：</p><pre><code>proxy_cache_path /data/wwwroot/boxrom.com/cache levels=1:2 keys_zone=STATIC:100m inactive=24h max_size=512m;</code></pre><p><strong>1.处理博客页面的 location 字段</strong></p><pre><code>location / {        proxy_cache STATIC;        proxy_cache_valid 200 60m;        proxy_cache_valid 404 1m;        proxy_ignore_headers X-Accel-Expires Expires Cache-Control;        proxy_ignore_headers Set-Cookie;        proxy_hide_header Set-Cookie;        proxy_hide_header X-powered-by;            proxy_set_header X-Real-IP $remote_addr;        proxy_set_header Host $http_host;        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;        proxy_set_header X-Forwarded-Proto https;        proxy_pass http://ghost_upstream;        expires 10m;    }</code></pre><p><strong>2.处理静态文件</strong> 在这个部分，我们将要告诉 nginx 去哪儿找到 Ghost 应用的静态文件，诸如 css、js 和图片。这里需要使用四个 location 字段来分别指向 images 目录、assets 目录、public 目录 和 scripts 目录。我们将使用 expires max; 来缓存这些文件，以便它们能在客户端上永久保存下来。不要担心这样做会来带什么危害，因为当 node.js 初始化时，Ghost 会在每个静态文件（不包括 images 目录下的文件）后面加上一个版本号。注意assets文件夹在主题目录下，请根据主题名更改相应路径。</p><pre><code>location /content/images {        alias /data/wwwroot/boxrom.com/content/images;        access_log off;        expires max;    }location /casper-zh/assets {        alias /data/wwwroot/boxrom.com/content/themes/casper-zh/assets;        access_log off;        expires max;    }location /built/assets {        alias /data/wwwroot/boxrom.com/core/built/assets;        access_log off;        expires max;    }</code></pre><p><strong>3.处理后台管理的location字段</strong> Ghost的后台不应该被缓存，下面代码确保Ghost后台管理登录和登出页面不被缓存。</p><pre><code>location ~ ^/(?:ghost|signout) {        proxy_set_header   X-Real-IP $remote_addr;        proxy_set_header   Host      $http_host;        #proxy_set_header X-NginX-Proxy true;        proxy_pass http://ghost_upstream;        add_header Cache-Control &quot;no-cache, private, no-store, must-revalidate, max-stale=0, post-check=0, pre-check=0&quot;;        proxy_set_header X-Forwarded-Proto https;        proxy_redirect off;    }</code></pre><p>完成配置后在后台修改更新文章，页面并不会实时更新。如有必要，可以清楚缓存。</p><pre><code>rm -r /data/wwwroot/boxrom.com/cache/*</code></pre><h3 id="开启SSL-TLS后的设置"><a href="#开启SSL-TLS后的设置" class="headerlink" title="开启SSL/TLS后的设置"></a>开启SSL/TLS后的设置</h3><p>首先将Ghost目录里config.js的第14行url改为https链接。 然后再网站Nginx配置文件的<code>location /</code>和<code>location ~ ^/(?:ghost|signout)</code>块里加入<code>proxy_set_header X-Forwarded-Proto https</code> 。</p><p>完整的配置nginx配置文件如下：</p><pre><code>upstream ghost_upstream {    server unix:/data/wwwroot/boxrom.com/socket.sock;    keepalive 64;}proxy_cache_path /data/wwwroot/cache levels=1:2 keys_zone=STATIC:100m inactive=24h max_size=512m;  server {listen 80;listen 443 ssl http2;ssl on;ssl_certificate /usr/local/nginx/conf/ssl/boxrom.com.crt;ssl_certificate_key /usr/local/nginx/conf/ssl/boxrom.com.key;ssl_protocols TLSv1 TLSv1.1 TLSv1.2;ssl_ciphers EECDH+CHACHA20:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5;ssl_prefer_server_ciphers on;ssl_session_timeout 10m;ssl_session_cache builtin:1000 shared:SSL:10m;ssl_buffer_size 1400;add_header Strict-Transport-Security max-age=15768000;ssl_stapling on;ssl_stapling_verify on;server_name boxrom.com www.boxrom.com;access_log /data/wwwlogs/boxrom.com_nginx.log combined;add_header Strict-Transport-Security &quot;max-age=31536000; includeSubdomains; preload&quot;;if ($ssl_protocol = &quot;&quot;) { return 301 https://$host$request_uri; }if ($host != boxrom.com) {    rewrite ^/(.*)$ $scheme://boxrom.com/$1 permanent;    }location / {        proxy_cache STATIC;        proxy_cache_valid 200 60m;        proxy_cache_valid 404 1m;        proxy_ignore_headers X-Accel-Expires Expires Cache-Control;        proxy_ignore_headers Set-Cookie;        proxy_hide_header Set-Cookie;        proxy_hide_header X-powered-by;            proxy_set_header X-Real-IP $remote_addr;        proxy_set_header Host $http_host;        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;        proxy_set_header X-Forwarded-Proto https;        proxy_pass http://ghost_upstream;        expires 10m;    }location /content/images {        alias /data/wwwroot/boxrom.com/content/images;        access_log off;        expires max;    }location /casper-zh/assets {        alias /data/wwwroot/boxrom.com/content/themes/casper-zh/assets;        access_log off;        expires max;    }location /built/assets {        alias /data/wwwroot/boxrom.com/core/built/assets;        access_log off;        expires max;    }location ~ ^/(?:ghost|signout) {        proxy_set_header   X-Real-IP $remote_addr;        proxy_set_header   Host      $http_host;        #proxy_set_header X-NginX-Proxy true;        proxy_pass http://ghost_upstream;        add_header Cache-Control &quot;no-cache, private, no-store, must-revalidate, max-stale=0, post-check=0, pre-check=0&quot;;        proxy_set_header X-Forwarded-Proto https;        proxy_redirect off;    }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Centos环境安装Ghost Blog（上）</title>
      <link href="/centos-install-ghost-blog-1.html"/>
      <url>/centos-install-ghost-blog-1.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>今天有一个朋友问我如何在VPS安装Ghost博客，虽然以前装过，但基本没啥印象了。故自己手动安装尝试下。</p><blockquote><p>环境：</p></blockquote><p>阿里云ECS 1核 1RAM 1M宽带 Centos 7.2 x64</p><h4 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h4><p><code>yum update</code> 更新yum源 <code>yum groupinstall &quot;Development Tools&quot;</code> 安装开发工具包 <code>yum install wget</code> 安装wget下载工具</p><h3 id="M安装Nginx和MySQL"><a href="#M安装Nginx和MySQL" class="headerlink" title="M安装Nginx和MySQL"></a>M安装Nginx和MySQL</h3><p>我用的是<a href="https://oneinstack.com" target="_blank" rel="noopener">Oneinstack</a>，选择Nginx和MySQL安装即可。</p><h3 id="安装Node-js"><a href="#安装Node-js" class="headerlink" title="安装Node.js"></a>安装Node.js</h3><p>安装Node.js方案有很多</p><blockquote><p>可以用yum仓库直接也行，但版本太老了:</p></blockquote><p>yum install nodejs npm</p><blockquote><p>可以下载源码编译，但是需要花费大量的时间：</p></blockquote><p>从官方仓库获得最新的 Node.js 源代码包：</p><pre><code>wget http://nodejs.org/dist/node-latest.tar.gztar -xzf node-latest.tar.gzcd node-v*</code></pre><p>编译和安装Node.js：</p><pre><code>./configuremakesudo make install</code></pre><p>完成后我们可以通过 <code>node -v</code> 和 <code>npm -v</code> 命令来检查 Node.js 的版本。</p><blockquote><p>所以最佳安装方案就是：从网络仓库下载已经编译完成的安装包。</p></blockquote><p>首先添加仓库：</p><pre><code>curl -sL https://rpm.nodesource.com/setup | bash - #Centos、Redhat#curl -sL https://rpm.nodesource.com/setup | bash - #Debian、Ubuntu</code></pre><p>直接下载安装 Nodejs：</p><pre><code>yum install -y nodejs</code></pre><p>分别用 <code>node -v</code> 和 <code>npm -v</code> 检查 Node.js 的版本。</p><p>而且Ghost官方说明支持Node.js V4.2.0，所以尽量升级到这个版本。</p><hr><p>到现在为止，该安装的东西都安装了。</p><h3 id="安装Ghost"><a href="#安装Ghost" class="headerlink" title="安装Ghost"></a>安装Ghost</h3><p>添加虚拟主机后，定位到域名目录安装Ghost程序：</p><pre><code>wget http://dl.ghostchina.com/Ghost-0.7.4-zh-full.zipunzip Ghost-0.7.4-zh-full.zip</code></pre><p>这里要将config.example.js重命名为config.js再对其进行修改配置 <code>mv config.example.js config.js`</code>vi config.js` 我们找到生产环境的配置：production</p><blockquote><p>Ghost-0.7.4-zh-full这个版本默认集成 sqlite3 原生库，但博客篇幅比较大时，sqlite读写数据量太大时将会影响页面加载速度，我们可以根据个人需求改用mysql</p><p>如果选择使用sqlite则在config.js中只需要修改url地址</p></blockquote><pre><code>production: {        url: &apos;https://boxrom.com&apos;,//修改自己的域名        mail: {},        /*database: {            client: &apos;sqlite3&apos;,            connection: {                filename: path.join(__dirname, &apos;/content/data/ghost.db&apos;)            },            debug: false        },*/        // 配置MySQL 数据库        database: {            client: &apos;mysql&apos;,            connection: {                host     : &apos;localhost&apos;,//数据库主机位置                user     : &apos;admin&apos;, //数据库帐号                password : &apos;admin.&apos;,//数据库密码                database : &apos;admin&apos;, //数据库名                charset  : &apos;utf8&apos;  //数据库编码            },            debug: false        },        server: {            host: &apos;127.0.0.1&apos;,            port: &apos;2368&apos;        },        //Storage.Now,we can support `qiniu`,`upyun`, `aliyun oss`, `aliyun ace-storage` and `local-file-store`        storage: {            provider: &apos;local-file-store&apos;        }        // or        // 参考文档： http://www.ghostchina.com/qiniu-cdn-for-ghost/        /*storage: {            provider: &apos;qiniu&apos;,            bucketname: &apos;your-bucket-name&apos;,            ACCESS_KEY: &apos;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&apos;,            SECRET_KEY: &apos;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&apos;,            root: &apos;/image/&apos;,            prefix: &apos;http://your-bucket-name.qiniudn.com&apos;        }*/        // or        // 参考文档： http://www.ghostchina.com/upyun-cdn-for-ghost/        /*storage: {            provider: &apos;upyun&apos;,            bucketname: &apos;your-bucket-name&apos;,            username: &apos;your user name&apos;,            password: &apos;your password&apos;,            root: &apos;/image/&apos;,            prefix: &apos;http://your-bucket-name.b0.upaiyun.com&apos;        }*/        // or        // 参考文档： http://www.ghostchina.com/aliyun-oss-for-ghost/        /*storage: {            provider: &apos;oss&apos;,            bucketname: &apos;your-bucket-name&apos;,            ACCESS_KEY: &apos;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&apos;,            SECRET_KEY: &apos;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&apos;,            root: &apos;/image/&apos;,            endpoint: &apos;http://oss-cn-hangzhou.aliyuncs.com&apos;,  //阿里云的上传端点是分地域的，需要单独设置            prefix: &apos;http://your-bucket-name.oss-cn-hangzhou.aliyuncs.com&apos;        }*/    },</code></pre><p>然后在运行<code>npm start</code>，输出正常，表示成功了，下面配置下Nginx反代的相关设置</p><h3 id="Nginx反代配置"><a href="#Nginx反代配置" class="headerlink" title="Nginx反代配置"></a>Nginx反代配置</h3><p>修改你的域名配置文件</p><pre><code>server {    listen 80;    server_name My-Ghost-Blog.com;    location / {        proxy_set_header   X-Real-IP $remote_addr;        proxy_set_header   Host      $http_host;        proxy_pass         http://127.0.0.1:2368;    }}</code></pre><p>然后再运行<code>npm start</code>，访问你的网站，发现成功了！</p><h3 id="守护运行"><a href="#守护运行" class="headerlink" title="守护运行"></a>守护运行</h3><p>PM2(<a href="https://github.com/Unitech/pm2" target="_blank" rel="noopener">https://github.com/Unitech/pm2</a>)</p><p>只要我们一断开ssh，Ghost的进程就会被关闭，这里我们使用PM2来守护Ghost服务进程，并让其运行在生产模式production上</p><pre><code>//首先进到ghost的安装目录//安装pm2npm install pm2 -g//让ghost以production模式运作，指定程序的入口index.js，并且此进程命名为ghostNODE_ENV=production pm2 start index.js --name &quot;ghost&quot;//开机启动pm2 startup centospm2 save</code></pre><p>因为GFW的强大，在上一步直接使用npm安装依赖的时候可能出现无法安装的情况，这时候可以使用以下代码：</p><pre><code>//首先进到ghost的安装目录//安装淘宝npm镜像npm install -g cnpm --registry=https://registry.npm.taobao.org//安装pm2cnpm install pm2 -g//让ghost以production模式运作，指定程序的入口index.js，并且此进程命名为ghostNODE_ENV=production pm2 start index.js --name &quot;ghost&quot;//开机启动pm2 startup centospm2 save</code></pre><p>这样一来，我们的Ghost博客就可以保持运行啦，你可以使用以下指令来控制Ghost博客：</p><pre><code>pm2 start/stop/restart ghost</code></pre><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>以下是我config.js配置信息：</p><pre><code>// # Ghost Configuration// Setup your Ghost install for various [environments](http://support.ghost.org/config/#about-environments).// Ghost runs in `development` mode by default. Full documentation can be found at http://support.ghost.org/config/var path = require(&apos;path&apos;),    config;config = {    // ### Production    // When running Ghost in the wild, use the production environment.    // Configure your URL and mail settings here    production: {        url: &apos;http://boxrom.com&apos;,        mail: {},        /*database: {            client: &apos;sqlite3&apos;,            connection: {                filename: path.join(__dirname, &apos;/content/data/ghost.db&apos;)            },            debug: false        },*/        // 配置MySQL 数据库        database: {            client: &apos;mysql&apos;,            connection: {                host     : &apos;127.0.0.1&apos;,                user     : &apos;root&apos;,                password : &apos;root.&apos;,                database : &apos;root&apos;,                charset  : &apos;utf8&apos;            },            debug: false        },        server: {            host: &apos;0.0.0.0&apos;,            port: &apos;2368&apos;        },        //Storage.Now,we can support `qiniu`,`upyun`, `aliyun oss`, `aliyun ace-storage` and `local-file-store`        storage: {            provider: &apos;local-file-store&apos;        }        // or        // 参考文档： http://www.ghostchina.com/qiniu-cdn-for-ghost/        /*storage: {            provider: &apos;qiniu&apos;,            bucketname: &apos;your-bucket-name&apos;,            ACCESS_KEY: &apos;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&apos;,            SECRET_KEY: &apos;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&apos;,            root: &apos;/image/&apos;,            prefix: &apos;http://your-bucket-name.qiniudn.com&apos;        }*/        // or        // 参考文档： http://www.ghostchina.com/upyun-cdn-for-ghost/        /*storage: {            provider: &apos;upyun&apos;,            bucketname: &apos;your-bucket-name&apos;,            username: &apos;your user name&apos;,            password: &apos;your password&apos;,            root: &apos;/image/&apos;,            prefix: &apos;http://your-bucket-name.b0.upaiyun.com&apos;        }*/        // or        // 参考文档： http://www.ghostchina.com/aliyun-oss-for-ghost/        /*storage: {            provider: &apos;oss&apos;,            bucketname: &apos;your-bucket-name&apos;,            ACCESS_KEY: &apos;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&apos;,            SECRET_KEY: &apos;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&apos;,            root: &apos;/image/&apos;,            endpoint: &apos;http://oss-cn-hangzhou.aliyuncs.com&apos;,  //阿里云的上传端点是分地域的，需要单独设置            prefix: &apos;http://your-bucket-name.oss-cn-hangzhou.aliyuncs.com&apos;        }*/    },    // ### Development **(default)**    development: {        // The url to use when providing links to the site, E.g. in RSS and email.        // Change this to your Ghost blog&apos;s published URL.        url: &apos;http://localhost:2368&apos;,        // Example mail config        // Visit http://support.ghost.org/mail for instructions        //        //  mail: {        //      transport: &apos;SMTP&apos;,        //      options: {        //          service: &apos;Mailgun&apos;,        //          auth: {        //              user: &apos;&apos;, // mailgun username        //              pass: &apos;&apos;  // mailgun password        //          }        //      }        //  },        //        // #### Database        // Ghost supports sqlite3 (default), MySQL &amp; PostgreSQL        database: {            client: &apos;sqlite3&apos;,            connection: {                filename: path.join(__dirname, &apos;/content/data/ghost-dev.db&apos;)            },            debug: false        },        // #### Server        // Can be host &amp; port (default), or socket        server: {            // Host to be passed to node&apos;s `net.Server#listen()`            host: &apos;127.0.0.1&apos;,            // Port to be passed to node&apos;s `net.Server#listen()`, for iisnode set this to `process.env.PORT`            port: &apos;2368&apos;        },        // #### Paths        // Specify where your content directory lives        paths: {            contentPath: path.join(__dirname, &apos;/content/&apos;)        }    },    // **Developers only need to edit below here**    // ### Testing    // Used when developing Ghost to run tests and check the health of Ghost    // Uses a different port number    testing: {        url: &apos;http://127.0.0.1:2369&apos;,        database: {            client: &apos;sqlite3&apos;,            connection: {                filename: path.join(__dirname, &apos;/content/data/ghost-test.db&apos;)            }        },        server: {            host: &apos;127.0.0.1&apos;,            port: &apos;2369&apos;        },        logging: false    },    // ### Testing MySQL    // Used by Travis - Automated testing run through GitHub    &apos;testing-mysql&apos;: {        url: &apos;http://127.0.0.1:2369&apos;,        database: {            client: &apos;mysql&apos;,            connection: {                host     : &apos;127.0.0.1&apos;,                user     : &apos;root&apos;,                password : &apos;&apos;,                database : &apos;ghost_testing&apos;,                charset  : &apos;utf8&apos;            }        },        server: {            host: &apos;127.0.0.1&apos;,            port: &apos;2369&apos;        },        logging: false    },    // ### Testing pg    // Used by Travis - Automated testing run through GitHub    &apos;testing-pg&apos;: {        url: &apos;http://127.0.0.1:2369&apos;,        database: {            client: &apos;pg&apos;,            connection: {                host     : &apos;127.0.0.1&apos;,                user     : &apos;postgres&apos;,                password : &apos;&apos;,                database : &apos;ghost_testing&apos;,                charset  : &apos;utf8&apos;            }        },        server: {            host: &apos;127.0.0.1&apos;,            port: &apos;2369&apos;        },        logging: false    }};module.exports = config;</code></pre><p>这是我的Nginx.conf配置信息：</p><pre><code>server {listen 80;server_name boxrom.com www.boxrom.com;access_log /data/wwwlogs/boxrom.com_nginx.log combined;location / {    proxy_set_header   X-Real-IP $remote_addr;    proxy_set_header   Host      $http_host;    proxy_pass         http://127.0.0.1:2368;    }}</code></pre><p>下一篇尝试对站点SSL支持以及提高站点的安全性！</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Chrome 控制台实用指南</title>
      <link href="/chrome-console-practical-guide.html"/>
      <url>/chrome-console-practical-guide.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>Chrome浏览器我想是每一个前端er必用工具之一吧，一部分原因是它速度快，体积不大，支持的新特性也比其它浏览器多，还有一部分我想就是因为它的控制台功能强大了吧，说它是神器一点也不过分，很方便。但其实很多开发者并没有用出控制台的精髓，只是使用简单的<code>console.log();</code>其实控制台功能远远不止这么简单哦。</p><h3 id="console-clear"><a href="#console-clear" class="headerlink" title="console.clear"></a>console.clear</h3><p>console.clear();清空控制台，这个应该和console.log知名度一样高吧。</p><h3 id="console-log家族"><a href="#console-log家族" class="headerlink" title="console.log家族"></a>console.log家族</h3><p>先简单介绍一下chrome的控制台，打开chrome浏览器，按f12就可以轻松的打开控制台</p><p><img src="https://segmentfault.com/img/remote/1460000006866553" alt></p><p>如果你是一位开发者，我想console.log肯定是经常使用的了，我们主要看看console.log的几个兄弟：</p><pre><code>1.console.log (&apos;普通信息&apos;)2.console.info (&apos;提示性信息&apos;)3.console.error (&apos;错误信息&apos;)4.console.warn (&apos;警示信息&apos;)</code></pre><p><img src="https://segmentfault.com/img/remote/1460000006866554" alt></p><p><strong>大家都会用log，但很少有人能够很好地利用console.error，console.warn 等将输出到控制台的信息进行分类整理。他们功能区别不大，意义在于将输出到控制台的信息进行归类，或者说让它们更语义化。</strong></p><p>如果再配合console.group 与console.groupEnd，可以将这种分类管理的思想发挥到极致。这适合于在开发一个规模很大模块很多很复杂的Web APP时，将各自的log信息分组到以各自命名空间为名称的组里面。</p><pre><code>console.group(&quot;app.bundle&quot;);console.warn(&quot;来自bundle模块的警告信息1&quot;);console.warn(&quot;来自bundle模块的警告信息2&quot;);console.groupEnd();console.group(&quot;app.bundle&quot;);console.log(&quot;来自bundle模块的信息1&quot;);console.log(&quot;来自bundle模块的信息2&quot;);console.groupEnd();</code></pre><p><img src="https://segmentfault.com/img/remote/1460000006866555" alt></p><p><strong>这样的控制台信息看上去就一目了然了，就不用再为了找这是属于那一行代码输出的再翻一遍源码了。</strong></p><p>另外，console.log家族还给我们提供了一个的API：第一个参数可以带一些格式化指令，比如<code>%c,\n</code>;看下面这个炫酷的效果：</p><pre><code>console.log(&apos;%chello world&apos;, &apos;background-image:-webkit-gradient( linear, left top, right top, color-stop(0, #f22), color-stop(0.15, #f2f), color-stop(0.3, #22f), color-stop(0.45, #2ff), color-stop(0.6, #2f2),color-stop(0.75, #2f2), color-stop(0.9, #ff2), color-stop(1, #f22) );color:transparent;-webkit-background-clip: text;font-size:5em;&apos;);</code></pre><p><img src="https://segmentfault.com/img/remote/1460000006866556?w=1898&amp;h=263" alt></p><p><strong>当然，图片也是可以的，读者可以自行尝试，修改上述代码即可。</strong></p><p>另外，console.log() 接收不定参数，参数间用逗号分隔，最终会输出会将它们以空白字符连接。</p><p><img src="https://segmentfault.com/img/remote/1460000006866557?w=907&amp;h=97" alt></p><h3 id="console-table"><a href="#console-table" class="headerlink" title="console.table"></a>console.table</h3><p>看着这种“黑魔法”是不是有种坑分的感觉呢，其实还不止哦！console.table可以让我们输出表格,示例：</p><pre><code>var data = {code:200,content:[{&apos;品名&apos;: &apos;杜雷斯&apos;, &apos;数量&apos;: 4}, {&apos;品名&apos;: &apos;冈本&apos;, &apos;数量&apos;: 3}]};console.table(data.content);</code></pre><p><img src="https://segmentfault.com/img/remote/1460000006866558?w=1862&amp;h=223" alt></p><p><strong>有的时候后端传回来一大串数据，是不是觉得直接console.log或是通过抓包工具查看都会让人晕头转向呢，这个时候正事console.table发挥作用的时候了，以表格的形式呈现数据，自然一目了然。</strong></p><h3 id="console-assert"><a href="#console-assert" class="headerlink" title="console.assert"></a>console.assert</h3><pre><code>var isDebug=false;console.assert(isDebug,&apos;开发中的log信息。。。&apos;);</code></pre><p>当你想代码满足某些条件时才输出信息到控制台，那么你大可不必写if或者三元表达式来达到目的，cosole.assert便是这样场景下一种很好的工具，它会先对传入的表达式进行断言，只有表达式为假时才输出相应信息到控制台。</p><p><img src="https://segmentfault.com/img/remote/1460000006866559?w=715&amp;h=126" alt></p><h3 id="console-count"><a href="#console-count" class="headerlink" title="console.count"></a>console.count</h3><p>除了条件输出的场景，还有常见的场景是计数。</p><p>当你想统计某段代码执行了多少次时也大可不必自己去写相关逻辑，内置的console.count可以很地胜任这样的任务.</p><p><img src="https://segmentfault.com/img/remote/1460000006866560?w=868&amp;h=347" alt></p><h3 id="console-dir"><a href="#console-dir" class="headerlink" title="console.dir"></a>console.dir</h3><p>将DOM结点以JavaScript对象的形式输出到控制台，而console.log是直接将该DOM结点以DOM树的结构进行输出，与在元素审查时看到的结构是一致的。不同的展现形式，同样的优雅，各种体位任君选择反正就是方便与体贴。</p><pre><code>console.dir(document.body);console.log(document.body);</code></pre><p><img src="https://segmentfault.com/img/remote/1460000006866561?w=940&amp;h=172" alt></p><h3 id="console-time-amp-console-timeEnd"><a href="#console-time-amp-console-timeEnd" class="headerlink" title="console.time &amp; console.timeEnd"></a>console.time &amp; console.timeEnd</h3><p>输出一些调试信息是控制台最常用的功能，当然，它的功能远不止于此。当做一些性能测试时，同样可以在这里很方便地进行。比如需要考量一段代码执行的耗时情况时，可以用console.time与 console.timeEnd来做此事。</p><pre><code>console.time(&quot;Array耗时&quot;);var array= new Array(10000000);for (var i = array.length - 1; i &gt;= 0; i--) {    array[i] = new Object();};console.timeEnd(&quot;Array耗时&quot;);</code></pre><p><img src="https://segmentfault.com/img/remote/1460000006866562?w=762&amp;h=206" alt></p><p>当想要查看CPU使用相关的信息时，可以使用console.profile配合 console.profileEnd来完成这个需求。 这一功能可以通过UI界面来完成，Chrome 开发者工具里面有个tab便是Profile。使用方法和console.time基本一样，其实time开发者工具里也有个tab就是timeline。关于console.prefile博主就不做多余的介绍了。想要做更多了解的读者可以看<a href="https://developers.google.com/web/tools/chrome-devtools/debug/console/console-reference?utm_source=dcc&amp;utm_medium=redirect&amp;utm_campaign=2016q3#consolelogobject-object" target="_blank" rel="noopener">这里</a>。</p><h3 id><a href="#" class="headerlink" title="$"></a>$</h3><p>讲真，米国程序员们真的很喜欢money啊（谁又不是呢），看看PHP就知道了，满屏的<code>$</code>。而在Chrome的控制台里，<code>$</code>用处同样是蛮多且方便的。</p><pre><code>2+2//回车，再$_+1//回车得5</code></pre><p>上面的<code>$_</code>需要领悟其奥义才能使用得当，而<code>$0~$4</code>则代表了最近5个你选择过的DOM节点。</p><p>什么意思呢？在页面右击选择审查元素，然后在弹出来的DOM结点树上面随便点选，这些被点过的节点会被记录下来，而<code>$0</code>会返回最近一次点选的DOM结点，以此类推，<code>$1</code>返回的是上上次点选的DOM节点，最多保存了5个，如果不够5个，则返回undefined。</p><p><img src="https://segmentfault.com/img/remote/1460000006866563" alt></p><p>另外值得一赞的是，Chrome 控制台中原生支持类jQuery的选择器，也就是说你可以用$加上熟悉的css选择器来选择DOM节点，多么滴熟悉。</p><pre><code>$(&apos;body&apos;);$$(&apos;div&apos;);</code></pre><p><img src="https://segmentfault.com/img/remote/1460000006866564?w=673&amp;h=123" alt></p><p><code>$(selector)</code>返回的是满足选择条件的首个DOM元素。</p><p>剥去她伪善的外衣，其实<code>$(selector)</code>是原生<code>JavaScript document.querySelector()</code> 的封装。 同时另一个命令<code>$$(selector)</code>返回的是所有满足选择条件的元素的一个集合，是对<code>document.querySelectorAll()</code> 的封装。</p><h3 id="x-path"><a href="#x-path" class="headerlink" title="$x(path)"></a>$x(path)</h3><p>将所匹配的节点放在一个数组里返回</p><pre><code>$x(&quot;//p&quot;);$x(&quot;//p[a]&quot;);</code></pre><p><img src="https://segmentfault.com/img/remote/1460000006866565?w=1895&amp;h=204" alt></p><p><code>$x(&quot;//p&quot;)</code>匹配所有的p节点，<code>$x(&quot;//p[a]&quot;);</code>匹配所有子节点包含a的p节点</p><h3 id="copy"><a href="#copy" class="headerlink" title="copy"></a>copy</h3><pre><code>copy(document.body)</code></pre><p>然后你就可以Ctrl+v了。</p><p><strong>注意：他不依附于任何全局变量比如window，所以其实在JS代码里是访问不了这个copy方法的，所以从代码层面来调用复制功能也就无从谈起。但愿有天浏览器会提供相应的JS实现吧~这样我们就可以通过js代码进行复制操作而不用再依赖Flash插件了。</strong></p><h3 id="keys-amp-values"><a href="#keys-amp-values" class="headerlink" title="keys &amp; values"></a>keys &amp; values</h3><p>这是一对基友。前者返回传入对象所有属性名组成的数据，后者返回所有属性值组成的数组。具体请看下面的例子：</p><pre><code>var tfboy={name:&apos;wayou&apos;,gender:&apos;unknown&apos;,hobby:&apos;opposite to the gender&apos;};keys(tfboy);values(tfboy);</code></pre><p><img src="https://segmentfault.com/img/remote/1460000006866566?w=1101&amp;h=215" alt></p><h3 id="monitor-amp-unmonitor"><a href="#monitor-amp-unmonitor" class="headerlink" title="monitor &amp; unmonitor"></a>monitor &amp; unmonitor</h3><p>monitor(function)，它接收一个函数名作为参数，比如function a，每次a被执行了，都会在控制台输出一条信息，里面包含了函数的名称a及执行时所传入的参数。而unmonitor(function)便是用来停止这一监听。</p><pre><code>function sayHello(name){    alert(&apos;hello,&apos;+name);}monitor(sayHello);sayHello(&apos;damonare&apos;);sayHello(&apos;tjz&apos;);unmonitor(sayHello);</code></pre><p><img src="https://segmentfault.com/img/remote/1460000006866567?w=1028&amp;h=303" alt></p><h3 id="debug-amp-undebug"><a href="#debug-amp-undebug" class="headerlink" title="debug &amp; undebug"></a>debug &amp; undebug</h3><p>debug同样也是接收一个函数名作为参数。当该函数执行时自动断下来以供调试，类似于在该函数的入口处打了个断点，可以通过debugger来做到，同时也可以通过在Chrome开发者工具里找到相应源码然后手动打断点。而undebug 则是解除该断点。而其他还有好些命令则让人没有说的欲望，因为好些都可以通过Chrome开发者工具的UI界面来操作并且比用在控制台输入要方便。</p><p><img src="https://segmentfault.com/img/remote/1460000006866568?w=951&amp;h=422" alt></p><p><strong>本博文依据<a href="https://developers.google.com/web/tools/chrome-devtools/debug/console/console-reference?utm_source=dcc&amp;utm_medium=redirect&amp;utm_campaign=2016q3#consolelogobject-object" target="_blank" rel="noopener">Console API文档</a>和<a href="https://developers.google.com/web/tools/chrome-devtools/debug/command-line/command-line-reference?utm_source=dcc&amp;utm_medium=redirect&amp;utm_campaign=2016q3#debugfunction" target="_blank" rel="noopener">Commond API</a>书写。</strong></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>20分钟MySQL基础入门</title>
      <link href="/20-minutes-fundamentals-of-mysql.html"/>
      <url>/20-minutes-fundamentals-of-mysql.html</url>
      
        <content type="html"><![CDATA[<h1 id="开始使用"><a href="#开始使用" class="headerlink" title="开始使用"></a>开始使用</h1><p>MySQL 为关系型数据库(Relational Database Management System)，一个关系型数据库由一个或数个表格组成, 如图所示的一个表格：</p><p><img src="https://segmentfault.com/img/bVC86a?w=327&amp;h=138" alt></p><ul><li><code>表头(header)</code>: 每一列的名称;</li><li><code>列(col)</code>: 具有相同数据类型的数据的集合;</li><li><code>行(row)</code>: 每一行用来描述某个人/物的具体信息;</li><li><code>值(value)</code>: 行的具体信息, 每个值必须与该列的数据类型相同;</li></ul><h3 id="登录MySQL"><a href="#登录MySQL" class="headerlink" title="登录MySQL"></a>登录MySQL</h3><pre><code>mysql -h 127.0.0.1 -u 用户名 -pmysql -D 所选择的数据库名 -h 主机名 -u 用户名 -pmysql&gt; exit # 退出mysql&gt; quit # 退出</code></pre><h3 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h3><p>对于表的操作需要先进入库<code>use 库名;</code></p><pre><code>-- 创建一个名为 samp_db 的数据库，数据库字符编码指定为 gbkcreate database samp_db character set gbk;drop database samp_db; -- 删除 库名为samp_db的库show databases;        -- 显示数据库列表。use samp_db;    -- 选择创建的数据库samp_dbshow 表名;       -- 显示samp_db下面所有的表名字describe 表名;   -- 显示数据表的结构delete from 表名; -- 清空表中记录</code></pre><h3 id="创建数据库表"><a href="#创建数据库表" class="headerlink" title="创建数据库表"></a>创建数据库表</h3><blockquote><p>使用 create table 语句可完成对表的创建, create table 的常见形式:语法：create table 表名称(列声明);</p></blockquote><pre><code>CREATE TABLE `user_accounts` (  `id`             int(100) unsigned NOT NULL AUTO_INCREMENT primary key,  `password`       varchar(32)       NOT NULL DEFAULT &apos;&apos; COMMENT &apos;用户密码&apos;,  `reset_password` tinyint(32)       NOT NULL DEFAULT 0 COMMENT &apos;用户类型：0－不需要重置密码；1-需要重置密码&apos;,  `mobile`         varchar(20)       NOT NULL DEFAULT &apos;&apos; COMMENT &apos;手机&apos;,  `create_at`      timestamp(6)      NOT NULL DEFAULT CURRENT_TIMESTAMP(6),  `update_at`      timestamp(6)      NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6),  -- 创建唯一索引，不允许重复  UNIQUE INDEX idx_user_mobile(`mobile`))ENGINE=InnoDB DEFAULT CHARSET=utf8COMMENT=&apos;用户表信息&apos;;</code></pre><p>数据类型的属性解释</p><ul><li><code>NULL</code>：数据列可包含NULL值；</li><li><code>NOT NULL</code>：数据列不允许包含NULL值；</li><li><code>DEFAULT</code>：默认值；</li><li><code>PRIMARY</code>：KEY 主键；</li><li><code>AUTO_INCREMENT</code>：自动递增，适用于整数类型；</li><li><code>UNSIGNED</code>：是指数值类型只能为正数；</li><li><code>CHARACTER SET name</code>：指定一个字符集；</li><li><code>COMMENT</code>：对表或者字段说明；</li></ul><h1 id="增删改查"><a href="#增删改查" class="headerlink" title="增删改查"></a>增删改查</h1><h3 id="SELECT"><a href="#SELECT" class="headerlink" title="SELECT"></a>SELECT</h3><blockquote><p>SELECT 语句用于从表中选取数据。 语法：<code>SELECT 列名称 FROM 表名称</code> 语法：<code>SELECT * FROM 表名称</code></p></blockquote><pre><code>-- 表abc 两个 id  表abc中不包含 字段a=b 的 查询出来，只显示idSELECT s.id from station s WHERE id in (13,14) and user_id not in (4);-- 从表 Persons 选取 LastName 列的数据SELECT LastName FROM Persons-- 结果集中会自动去重复数据SELECT DISTINCT Company FROM Orders</code></pre><h3 id="UPDATE"><a href="#UPDATE" class="headerlink" title="UPDATE"></a>UPDATE</h3><blockquote><p>Update 语句用于修改表中的数据。 语法：<code>UPDATE 表名称 SET 列名称 = 新值 WHERE 列名称 = 某值</code></p></blockquote><pre><code>-- update语句设置字段值为另一个结果取出来的字段update user set name = (select name from user1 where user1 .id = 1 )where id = (select id from user2 where user2 .name=&apos;小苏&apos;)</code></pre><h3 id="INSERT"><a href="#INSERT" class="headerlink" title="INSERT"></a>INSERT</h3><blockquote><p>INSERT INTO 语句用于向表格中插入新的行。 语法：<code>INSERT INTO 表名称 VALUES (值1, 值2,....)</code> 语法：<code>INSERT INTO 表名称 (列1, 列2,...) VALUES (值1, 值2,....)</code></p></blockquote><pre><code>-- 向表 Persons 插入一条字段 LastName = Wilson 字段 Address = shanghaiINSERT INTO Persons (LastName, Address) VALUES (&apos;JSLite&apos;, &apos;shanghai&apos;);INSERT INTO meeting SET a=1,b=2;</code></pre><h3 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h3><blockquote><p>DELETE 语句用于删除表中的行。 语法：<code>DELETE FROM 表名称 WHERE 列名称 = 值</code></p></blockquote><pre><code>-- 在不删除table_name表的情况下删除所有的行，清空表。DELETE FROM table_name-- 或者DELETE * FROM table_name-- 删除 Person表字段 LastName = &apos;Wilson&apos; DELETE FROM Person WHERE LastName = &apos;Wilson&apos; -- 删除 表meeting id 为2和3的两条数据DELETE from meeting where id in (2,3);-- 表 Persons 字段 Id_P 等于 Orders 字段 Id_P 的值，-- 结果集显示 Persons表的 LastName、FirstName字段，Orders表的OrderNo字段SELECT p.LastName, p.FirstName, o.OrderNo FROM Persons p, Orders o WHERE p.Id_P = o.Id_P</code></pre><h1 id="WHERE"><a href="#WHERE" class="headerlink" title="WHERE"></a>WHERE</h1><blockquote><p>WHERE 子句用于规定选择的标准。 语法：<code>SELECT 列名称 FROM 表名称 WHERE 列 运算符 值</code></p></blockquote><pre><code>-- 从表 Persons 中选出 Year 字段大于 1965 的数据SELECT * FROM Persons WHERE Year&gt;1965</code></pre><h1 id="AND-和-OR"><a href="#AND-和-OR" class="headerlink" title="AND 和 OR"></a>AND 和 OR</h1><blockquote><p>AND – 如果第一个条件和第二个条件都成立； OR – 如果第一个条件和第二个条件中只要有一个成立；</p></blockquote><h3 id="AND"><a href="#AND" class="headerlink" title="AND"></a>AND</h3><pre><code>-- 删除 meeting 表字段 -- id=2 并且 user_id=5 的数据  和-- id=3 并且 user_id=6 的数据 DELETE from meeting where id in (2,3) and user_id in (5,6);-- 使用 AND 来显示所有姓为 &quot;Carter&quot; 并且名为 &quot;Thomas&quot; 的人：SELECT * FROM Persons WHERE FirstName=&apos;Thomas&apos; AND LastName=&apos;Carter&apos;;</code></pre><h3 id="OR"><a href="#OR" class="headerlink" title="OR"></a>OR</h3><pre><code>-- 使用 OR 来显示所有姓为 &quot;Carter&quot; 或者名为 &quot;Thomas&quot; 的人：SELECT * FROM Persons WHERE firstname=&apos;Thomas&apos; OR lastname=&apos;Carter&apos;</code></pre><h1 id="ORDER-BY"><a href="#ORDER-BY" class="headerlink" title="ORDER BY"></a>ORDER BY</h1><blockquote><p>语句默认按照升序对记录进行排序。 <code>ORDER BY</code> – 语句用于根据指定的列对结果集进行排序。 <code>DESC</code> – 按照降序对记录进行排序。 <code>ASC</code> – 按照顺序对记录进行排序。</p></blockquote><pre><code>-- Company在表Orders中为字母，则会以字母顺序显示公司名称SELECT Company, OrderNumber FROM Orders ORDER BY Company-- 后面跟上 DESC 则为降序显示SELECT Company, OrderNumber FROM Orders ORDER BY Company DESC-- Company以降序显示公司名称，并OrderNumber以顺序显示SELECT Company, OrderNumber FROM Orders ORDER BY Company DESC, OrderNumber ASC</code></pre><h1 id="IN"><a href="#IN" class="headerlink" title="IN"></a>IN</h1><blockquote><p>IN – 操作符允许我们在 WHERE 子句中规定多个值。 IN – 操作符用来指定范围，范围中的每一条，都进行匹配。IN取值规律，由逗号分割，全部放置括号中。 语法：<code>SELECT &quot;字段名&quot;FROM &quot;表格名&quot;WHERE &quot;字段名&quot; IN (&#39;值一&#39;, &#39;值二&#39;, ...);</code></p></blockquote><pre><code>-- 从表 Persons 选取 字段 LastName 等于 Adams、CarterSELECT * FROM Persons WHERE LastName IN (&apos;Adams&apos;,&apos;Carter&apos;)</code></pre><h1 id="NOT"><a href="#NOT" class="headerlink" title="NOT"></a>NOT</h1><blockquote><p>NOT – 操作符总是与其他操作符一起使用，用在要过滤的前面。</p></blockquote><pre><code>SELECT vend_id, prod_name FROM Products WHERE NOT vend_id = &apos;DLL01&apos; ORDER BY prod_name;</code></pre><h1 id="AS"><a href="#AS" class="headerlink" title="AS"></a>AS</h1><blockquote><p>as – 可理解为：用作、当成，作为；别名 一般是重命名列名或者表名。 语法：<code>select column_1 as 列1,column_2 as 列2 from table as 表</code></p></blockquote><pre><code>SELECT * FROM Employee AS emp-- 这句意思是查找所有Employee 表里面的数据，并把Employee表格命名为 emp。-- 当你命名一个表之后，你可以在下面用 emp 代替 Employee.-- 例如 SELECT * FROM emp.SELECT MAX(OrderPrice) AS LargestOrderPrice FROM Orders-- 列出表 Orders 字段 OrderPrice 列最大值，-- 结果集列不显示 OrderPrice 显示 LargestOrderPrice-- 显示表 users_profile 中的 name 列SELECT t.name from (SELECT * from users_profile a) AS t;-- 表 user_accounts 命名别名 ua，表 users_profile 命名别名 up-- 满足条件 表 user_accounts 字段 id 等于 表 users_profile 字段 user_id-- 结果集只显示mobile、name两列SELECT ua.mobile,up.name FROM user_accounts as ua INNER JOIN users_profile as up ON ua.id = up.user_id;</code></pre><h1 id="JOIN"><a href="#JOIN" class="headerlink" title="JOIN"></a>JOIN</h1><blockquote><p>用于根据两个或多个表中的列之间的关系，从这些表中查询数据。</p></blockquote><ul><li><code>JOIN</code>: 如果表中有至少一个匹配，则返回行</li><li><code>INNER JOIN</code>:在表中存在至少一个匹配时，INNER JOIN 关键字返回行。</li><li><code>LEFT JOIN</code>: 即使右表中没有匹配，也从左表返回所有的行</li><li><code>RIGHT JOIN</code>: 即使左表中没有匹配，也从右表返回所有的行</li><li><p><code>FULL JOIN</code>: 只要其中一个表中存在匹配，就返回行</p><p>SELECT Persons.LastName, Persons.FirstName, Orders.OrderNo<br>FROM Persons<br>INNER JOIN Orders<br>ON Persons.Id_P = Orders.Id_P<br>ORDER BY Persons.LastName;</p></li></ul><h1 id="SQL-函数"><a href="#SQL-函数" class="headerlink" title="SQL 函数"></a>SQL 函数</h1><h3 id="COUNT"><a href="#COUNT" class="headerlink" title="COUNT"></a>COUNT</h3><blockquote><p>COUNT 让我们能够数出在表格中有多少笔资料被选出来。 语法：<code>SELECT COUNT(&quot;字段名&quot;) FROM &quot;表格名&quot;;</code></p></blockquote><pre><code>-- 表 Store_Information 有几笔 store_name 栏不是空白的资料。-- &quot;IS NOT NULL&quot; 是 &quot;这个栏位不是空白&quot; 的意思。SELECT COUNT (Store_Name) FROM Store_Information WHERE Store_Name IS NOT NULL; -- 获取 Persons 表的总数SELECT COUNT(1) AS totals FROM Persons;-- 获取表 station 字段 user_id 相同的总数select user_id, count(*) as totals from station group by user_id;</code></pre><h3 id="MAX"><a href="#MAX" class="headerlink" title="MAX"></a>MAX</h3><blockquote><p>MAX 函数返回一列中的最大值。NULL 值不包括在计算中。 语法：<code>SELECT MAX(&quot;字段名&quot;) FROM &quot;表格名&quot;</code></p></blockquote><pre><code>-- 列出表 Orders 字段 OrderPrice 列最大值，-- 结果集列不显示 OrderPrice 显示 LargestOrderPriceSELECT MAX(OrderPrice) AS LargestOrderPrice FROM Orders</code></pre><h1 id="添加索引"><a href="#添加索引" class="headerlink" title="添加索引"></a>添加索引</h1><h3 id="普通索引-INDEX"><a href="#普通索引-INDEX" class="headerlink" title="普通索引(INDEX)"></a>普通索引(INDEX)</h3><blockquote><p>语法：ALTER TABLE <code>表名字</code> ADD INDEX 索引名字 ( <code>字段名字</code> )</p></blockquote><pre><code>-- –直接创建索引CREATE INDEX index_user ON user(title)-- –修改表结构的方式添加索引ALTER TABLE table_name ADD INDEX index_name ON (column(length))-- 给 user 表中的 name字段 添加普通索引(INDEX)ALTER TABLE `table` ADD INDEX index_name (name)-- –创建表的时候同时创建索引CREATE TABLE `table` (    `id` int(11) NOT NULL AUTO_INCREMENT ,    `title` char(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL ,    `content` text CHARACTER SET utf8 COLLATE utf8_general_ci NULL ,    `time` int(10) NULL DEFAULT NULL ,    PRIMARY KEY (`id`),    INDEX index_name (title(length)))-- –删除索引DROP INDEX index_name ON table</code></pre><h3 id="主键索引-PRIMARY-key"><a href="#主键索引-PRIMARY-key" class="headerlink" title="主键索引(PRIMARY key)"></a>主键索引(PRIMARY key)</h3><blockquote><p>语法：ALTER TABLE <code>表名字</code> ADD PRIMARY KEY ( <code>字段名字</code> )</p></blockquote><pre><code>-- 给 user 表中的 id字段 添加主键索引(PRIMARY key)ALTER TABLE `user` ADD PRIMARY key (id);</code></pre><h3 id="唯一索引-UNIQUE"><a href="#唯一索引-UNIQUE" class="headerlink" title="唯一索引(UNIQUE)"></a>唯一索引(UNIQUE)</h3><blockquote><p>语法：ALTER TABLE <code>表名字</code> ADD UNIQUE (<code>字段名字</code>)</p></blockquote><pre><code>-- 给 user 表中的 creattime 字段添加唯一索引(UNIQUE)ALTER TABLE `user` ADD UNIQUE (creattime);</code></pre><h3 id="全文索引-FULLTEXT"><a href="#全文索引-FULLTEXT" class="headerlink" title="全文索引(FULLTEXT)"></a>全文索引(FULLTEXT)</h3><blockquote><p>语法：ALTER TABLE <code>表名字</code> ADD FULLTEXT (<code>字段名字</code>)</p></blockquote><pre><code>-- 给 user 表中的 description 字段添加全文索引(FULLTEXT)ALTER TABLE `user` ADD FULLTEXT (description);</code></pre><h3 id="添加多列索引"><a href="#添加多列索引" class="headerlink" title="添加多列索引"></a>添加多列索引</h3><blockquote><p>语法：</p></blockquote><p>ALTER TABLE <code>table_name</code> ADD INDEX index_name ( <code>column1</code>, <code>column2</code>, <code>column3</code>)</p><pre><code>-- 给 user 表中的 name、city、age 字段添加名字为name_city_age的普通索引(INDEX)ALTER TABLE user ADD INDEX name_city_age (name(10),city,age);</code></pre><h3 id="建立索引的时机"><a href="#建立索引的时机" class="headerlink" title="建立索引的时机"></a>建立索引的时机</h3><p>在<code>WHERE</code>和<code>JOIN</code>中出现的列需要建立索引，但也不完全如此：</p><ul><li>MySQL只对<code>&lt;</code>，<code>&lt;=</code>，<code>=</code>，<code>&gt;</code>，<code>&gt;=</code>，<code>BETWEEN</code>，<code>IN</code>使用索引</li><li>某些时候的<code>LIKE</code>也会使用索引。</li><li><p>在<code>LIKE</code>以通配符%和_开头作查询时，MySQL不会使用索引。</p><p>– 此时就需要对city和age建立索引，<br>– 由于mytable表的userame也出现在了JOIN子句中，也有对它建立索引的必要。<br>SELECT t.Name<br>FROM mytable t LEFT JOIN mytable m ON t.Name=m.username<br>WHERE m.age=20 AND m.city=’上海’;</p><p>SELECT <em> FROM mytable WHERE username like’admin%’; – 而下句就不会使用：<br>SELECT </em> FROM mytable WHEREt Name like’%admin’; – 因此，在使用LIKE时应注意以上的区别。</p></li></ul><p>索引的注意事项</p><ul><li>索引不会包含有NULL值的列</li><li>使用短索引</li><li>不要在列上进行运算 索引会失效</li></ul><h1 id="创建后表的修改"><a href="#创建后表的修改" class="headerlink" title="创建后表的修改"></a>创建后表的修改</h1><h3 id="添加列"><a href="#添加列" class="headerlink" title="添加列"></a>添加列</h3><blockquote><p>语法：<code>alter table 表名 add 列名 列数据类型 [after 插入位置];</code></p></blockquote><p>示例:</p><pre><code>-- 在表students的最后追加列 address: alter table students add address char(60);-- 在名为 age 的列后插入列 birthday: alter table students add birthday date after age;</code></pre><h3 id="修改列"><a href="#修改列" class="headerlink" title="修改列"></a>修改列</h3><blockquote><p>语法：<code>alter table 表名 change 列名称 列新名称 新数据类型;</code></p></blockquote><pre><code>-- 将表 tel 列改名为 telphone: alter table students change tel telphone char(13) default &quot;-&quot;;-- 将 name 列的数据类型改为 char(16): alter table students change name name char(16) not null;</code></pre><h3 id="删除列"><a href="#删除列" class="headerlink" title="删除列"></a>删除列</h3><blockquote><p>语法：<code>alter table 表名 drop 列名称;</code></p></blockquote><pre><code>-- 删除表students中的 birthday 列: alter table students drop birthday;</code></pre><h3 id="重命名表"><a href="#重命名表" class="headerlink" title="重命名表"></a>重命名表</h3><blockquote><p>语法：<code>alter table 表名 rename 新表名;</code></p></blockquote><pre><code>-- 重命名 students 表为 workmates: alter table students rename workmates;</code></pre><h3 id="清空表数据"><a href="#清空表数据" class="headerlink" title="清空表数据"></a>清空表数据</h3><blockquote><p>语法：<code>delete from 表名;</code></p></blockquote><pre><code>-- 清空表为 workmates 里面的数据，不删除表。 delete from workmates;</code></pre><h3 id="删除整张表"><a href="#删除整张表" class="headerlink" title="删除整张表"></a>删除整张表</h3><blockquote><p>语法：<code>drop table 表名;</code></p></blockquote><pre><code>-- 删除 workmates 表: drop table workmates;</code></pre><h3 id="删除整个数据库"><a href="#删除整个数据库" class="headerlink" title="删除整个数据库"></a>删除整个数据库</h3><blockquote><p>语法：<code>drop database 数据库名;</code></p></blockquote><pre><code>-- 删除 samp_db 数据库: drop database samp_db;</code></pre><h1 id="其它相关"><a href="#其它相关" class="headerlink" title="其它相关"></a>其它相关</h1><ul><li><a href="https://github.com/jaywcjlove/handbook/blob/master/MySQL/%E8%AE%A9MySQL%E6%94%AF%E6%8C%81emoji%E5%9B%BE%E6%A0%87%E5%AD%98%E5%82%A8.md" target="_blank" rel="noopener">让MySQL支持emoji图标存储</a></li><li><a href="https://github.com/jaywcjlove/handbook/blob/master/MySQL/Mac%E4%B8%8B%E9%87%8D%E7%BD%AEMySQL%E7%9A%84root%E5%AF%86%E7%A0%81.md" target="_blank" rel="noopener">Mac下重置MySQL的root密码</a></li><li><a href="https://github.com/jaywcjlove/handbook/blob/master/MySQL/mysql%E5%AE%89%E8%A3%85.md" target="_blank" rel="noopener">MySQL安装</a></li><li><a href="https://github.com/jaywcjlove/handbook/blob/master/MySQL/MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.md" target="_blank" rel="noopener">MySQL数据类型</a></li></ul><blockquote><p><a href="https://github.com/jaywcjlove/handbook" target="_blank" rel="noopener">这里持续更新修正</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux目录结构</title>
      <link href="/linux-directory-structure.html"/>
      <url>/linux-directory-structure.html</url>
      
        <content type="html"><![CDATA[<h3 id><a href="#" class="headerlink" title="/"></a>/</h3><p>root，根目录。 文件系统的入口，最高一级目录。 只有root用户具有该目录下的写权限。请注意，/root是root用户的主目 录，这与/.不 一样。</p><h3 id="bin"><a href="#bin" class="headerlink" title="/bin"></a>/bin</h3><p>User Binaries，用户二进制文件。 包含基础系统所需的命令，是最小系统图所需的命令。 在单用户模式下，你需要使用的常见Linux命令都位于此目录下。系统的所 有用户使 用的命令都设在这里。</p><h3 id="sbin"><a href="#sbin" class="headerlink" title="/sbin"></a>/sbin</h3><p>System Binaries，系统二进制文件。 就像/bin，/sbin同样也包含二进制可执行文件。 但是，在这个目录下的linux命令通常系统管理命令，对系统进行维护。例 如：ipta bles、reboot、fdisk、ifconfig、swapon命令。</p><h3 id="etc"><a href="#etc" class="headerlink" title="/etc"></a>/etc</h3><p>Configuration Files，存放系统程序或者一般工具的配置文件。 包含所有程序所需的配置文件。 也包含了用于启动/停止单个程序的启动和关闭shell脚本。例如：/etc/reso lv.con f、/etc/logrotate.conf。</p><h3 id="dev"><a href="#dev" class="headerlink" title="/dev"></a>/dev</h3><p>Device Files，设备文件。 包含设备文件。这些包括终端设备、USB或连接到系统的任何设备。例如：/dev/tty 1、/dev/usbmon0。</p><h3 id="proc"><a href="#proc" class="headerlink" title="/proc"></a>/proc</h3><p>Process Information, 进程信息。 包含系统进程的相关信息。 这是一个虚拟的文件系统，包含有关正在运行的进程的信息。例如：/pro c/目录中包 含的与特定pid相关的信息。系统资源以文本信息形式存在。例 如：/proc/uptime。</p><h3 id="var"><a href="#var" class="headerlink" title="/var"></a>/var</h3><p>Variable Files，变量文件。 这包括 – 系统日志文件（/var/log）;包和数据库文件（/var/lib）;电子邮 件（/var/m ail）;打印队列（/var/spool）;锁文件（/var/lock）;多次重新 启动需要的临时文 件（/var/tmp）。</p><h3 id="tmp"><a href="#tmp" class="headerlink" title="/tmp"></a>/tmp</h3><p>Temporary Binaries，临时文件存放目录 包含系统和用户创建的临时文件。 当系统重新启动时，这个目录下的文件都将被删除。</p><h3 id="usr"><a href="#usr" class="headerlink" title="/usr"></a>/usr</h3><p>Unix System Resources 系统存放程序的目录，包含二进制文件、库文件、文档和二级程序的源代码。 /usr/bin中包含用户程序的二进制文件。 如果你在/bin中找不到用户二进制文件，到/usr/bin目录看看。 例如：at、awk、cc、less、scp。 /usr/sbin中包含系统管理员的二进制文件。 如果你在/sbin中找不到系统二进制文件，到/usr/sbin目录看看。 例如：atd、cron、sshd、useradd、userdel。 /usr/lib中包含了/usr/bin和/usr/sbin用到的库。 /usr/local中包含了从源安装的用户程序。 例如，当你从源安装Apache，它会在/usr/local/apache2中。</p><h3 id="home"><a href="#home" class="headerlink" title="/home"></a>/home</h3><p>Home Directories，普通用户默认存储目录。 所有用户用home目录来存储他们的个人档案。 例如：<code>/home/john、/home/nikita</code></p><h3 id="boot"><a href="#boot" class="headerlink" title="/boot"></a>/boot</h3><p>Boot Loader Files，引导加载程序文件， 包含引导加载程序相关的文件。 内核的initrd、vmlinux、grub文件位于/boot下。 例如：<code>initrd.img-2.6.32-24-generic、vmlinuz-2.6.32-24-generic</code></p><h3 id="lib"><a href="#lib" class="headerlink" title="/lib"></a>/lib</h3><p>System Libararies，系统库，包含支持位于/bin和/sbin下的二进制文件的库文件.库文件名为 ld_或lib_.so.* 例如：<code>ld-2.11.1.so，libncurses.so.5.7</code></p><h3 id="opt"><a href="#opt" class="headerlink" title="/opt"></a>/opt</h3><p>Optionnal add-on Apps，可选的附加应用程序opt代表可选的。 包含从个别厂商的附加应用程序。 附加应用程序应该安装在/opt/或者/opt/的子目录下。</p><h3 id="mnt"><a href="#mnt" class="headerlink" title="/mnt"></a>/mnt</h3><p>Mount Directory，挂载目录， 临时安装目录，系统管理员可以挂载文件系统。</p><h3 id="media"><a href="#media" class="headerlink" title="/media"></a>/media</h3><p>可移动媒体设备，用于挂载可移动设备的临时目录。 举例来说，挂载CD-ROM的/media/cdrom，挂载软盘驱动器的/media/floppy;</p><h3 id="srv"><a href="#srv" class="headerlink" title="/srv"></a>/srv</h3><p>Service Data，服务数据 srv代表服务。 包含服务器特定服务相关的数据。 例如，<code>/srv/cvs</code>包含cvs相关的数据。</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>从一行代码里面学点 JavaScript</title>
      <link href="/learning-much-javascript-one-line-code.html"/>
      <url>/learning-much-javascript-one-line-code.html</url>
      
        <content type="html"><![CDATA[<p><strong>摘要</strong>：从一行代码里面学点JavaScript，现如今，JavaScript无处不在，因此关于JavaScript的新知识也是层出不穷。JavaScript的特点在于，要学习它的语法入门简简单，但是要精通使用它的方式却是一件不容易的事。</p><p>现如今，JavaScript无处不在，因此关于JavaScript的新知识也是层出不穷。JavaScript的特点在于，要学习它的语法入门简简单，但是要精通使用它的方式却是一件不容易的事。</p><p>来看看下面的这段代码，它来自于谷歌“名猿”Addy Osmani在几天前贴出的一段代码，它的作用是用来调试你的CSS层。全部代码只有三行，但是你绝对可以把它放在一行里面完成：</p><pre><code>[].forEach.call($$(&quot;*&quot;),function(a){  a.style.outline=&quot;1px solid #&quot;+(~~(Math.random()*(1&lt;&lt;24))).toString(16)})</code></pre><p>现在，在你的Chrome浏览器的控制台中输入这段代码，你会发现不同HTML层都被使用不同的颜色添加了一个高亮的边框。是不是非常酷？但是，简单来说，这段代码只是首先获取了所有的页面元素，然后使用一个不同的颜色为它们添加了一个1ps的边框。想法很简单，但是真要实现起来却不是那么容易的一件事。在下面的内容中，我们将一起一步一步学习如何理解上面的这段代码。</p><h3 id="选择页面中所有的元素"><a href="#选择页面中所有的元素" class="headerlink" title="选择页面中所有的元素"></a>选择页面中所有的元素</h3><p>我们需要做的第一件事情是获取页面中所有的元素，在上面的代码中，Addy使用了一个Chrome浏览器中特有的函数 <code>$$</code>。你可以在你的Chrome浏览器控制台中输入 <code>$$(&#39;a&#39;)</code>，然后你就能得到一个当前页面中所有锚元素的列表。</p><p><code>$$</code>函数是许多现代浏览器命令行API中的一个部分，它等价于 <code>document.querySelectorAll</code>，你可以将一个CSS选择器作为这个函数的参数，然后你就能够获得当前页面中所有匹配这个CSS选择器的元素列表。如果你在浏览器控制台以外的地方，你可以使用 <code>document.querySelectorAll(&#39;*&#39;)</code> 来代替 <code>$$(&#39;*&#39;)</code>。更多关于 <code>$$</code> 函数的详细内容可以查看Chrome开发者工具的文档。</p><p>当然，除了使用<code>$$</code>函数之外，我们还有一种更简单的方法，document.all，虽然这并不是一种很规范的使用方法，但是它几乎在每一个浏览器中都能运行成功。</p><h3 id="迭代所有的元素"><a href="#迭代所有的元素" class="headerlink" title="迭代所有的元素"></a>迭代所有的元素</h3><p>经过第一步，我们已经获得了页面内所有的元素，现在我们想做的事情是遍历每一个元素，然后为它们添加一个彩色边边框。但是上面的代码究竟是怎么一回事呢？</p><pre><code>[].forEach.call( $$(&apos;*&apos;), function( element ) { /* 在这里修改颜色 */ });</code></pre><p>首先，我们通过选择器获得的列表是一个NodeLists对象，它和JavaScript中的数组有点像，你可以使用方括号来获取其中的节点，你也可以检查它其中包含多少个元素，但是它并没有实现数组包含的所有方法，因此我们并不能使用<code>$$(&#39;*&#39;).forEach()</code>来进行迭代。在JavaScript中，有好几个类似于数组但是并不是数组的对象，除了前面的NodeLists，还有函数的参数集合arguments，在这里我们可以使用call或apply函数将函数的方法运用到这些对象上。例如下面的例子：</p><pre><code>function say(name) { console.log( this + &apos; &apos; + name );}say.call( &apos;hola&apos;, &apos;Mike&apos; ); // 打印 &apos;hola Mike&apos;// 你也可以将这种方法有用在arguments对象上 function example( arg1, arg2, arg3 ) { return Array.prototype.slice.call(arguments, 1); // Returns [arg2, arg3] }</code></pre><p>在Addy的代码中，使用了[].forEach.call而不是Array.prototype.forEach.call，二者等价，但是前者可以节省几个字节。</p><h3 id="为元素添加颜色"><a href="#为元素添加颜色" class="headerlink" title="为元素添加颜色"></a>为元素添加颜色</h3><p>为了让元素都有一个漂亮的边框，我们在上面的代码中使用了CSS属性outline。outline属性位于CSS盒模型之外，因此它并不影响元素的属性或者元素在布局中的位置，这对于我们来说非常有用。这个属性和修改border属性非常类似，因此下面的代码应该不会很难理解：</p><pre><code>a.style.outline=&quot;1px solid #&quot; + color</code></pre><p>真正有趣的地方在于定义颜色部分：</p><pre><code>~~(Math.random()*(1&lt;&lt;24))).toString(16)</code></pre><p>天呐，上面的代码是什么意思？在JavaScript中，比特操作符并不是经常被使用，因此这里可能会让很多程序员感到很疑惑。</p><p>我们想达到的目的是活的一个十六进制格式的颜色例如白色对应的是FFFFFF，蓝色对应的是0000FF，或者随便一个颜色37f9ac。虽然我们人类喜欢十进制，但是我们的代码常常会需要十六进制的东西。</p><p>我们首先要学会如何使用toString函数将一个十进制的数组转换为一个十六进制整数。这个函数可以接受一个参数，如果参数缺省，默认为十进制，但是你完全可以使用别的数组：</p><pre><code>(30).toString(); // &quot;30&quot;(30).toString(10); // &quot;30&quot;(30).toString(16); // &quot;1e&quot; 十六进制(30).toString(2); // &quot;11110&quot; 二进制(30).toString(36); // &quot;u&quot; 36是允许的最大参数值</code></pre><p>除此之外，你可以使用parseInt函数将十六进制数字转换为十进制。</p><pre><code>parseInt(&quot;30&quot;); // &quot;30&quot;parseInt(&quot;30&quot;, 10); // &quot;30&quot;parseInt(&quot;1e&quot;, 16); // &quot;30&quot;parseInt(&quot;11110&quot;, 2); // &quot;30&quot;parseInt(&quot;u&quot;, 36); // &quot;30&quot;</code></pre><p>因此，我们现在只需要一个位于0和ffffff之间的十六进制数，由于:</p><pre><code>parseInt(&quot;ffffff&quot;, 16) == 16777215</code></pre><p>而这里的16777215实际上是2^24-1。</p><p>如果你对二进制数学熟悉的话，你可能会知道1&lt;&lt;24 == 16777216。</p><p>再进一步，你每在1后面添加一个0，你就相当于多做了一次2的乘方：</p><pre><code>1 // 1 == 2^0100 // 4 == 2^210000 // 16 == 2^41000000000000000000000000 // 16777216 == 2^24</code></pre><p>因此，在这里我们可以知道Math.random()*(1&lt;&lt;24)表示一个位于0和16777216之间的数。</p><p>但是这里并没有结束，因为Math.random返回的是一个浮点数，但是我们只想要整数部分。我们的代码中使用波浪号操作符来完成这件事。波浪操作符在JavaScript中被用来对一个变量进行取反。</p><p>但是我们在这里并不关心取反，我们指向获取整数部分。因此我们还可以知道两次取反可以去掉一个浮点数的小数部分，因此~~的作用相当于parseInt：</p><pre><code>var a = 12.34, // ~~a = 12    b = -1231.8754, // ~~b = -1231    c = 3213.000001 // ~~c = 3213;~~a == parseInt(a, 10); // true~~b == parseInt(b, 10); // true~~c == parseInt(c, 10); // true</code></pre><p>当然，我们还有一种更加简洁的方法，使用OR操作符：</p><pre><code>~~a == 0|a == parseInt(a, 10)~~b == 0|b == parseInt(b, 10)~~c == 0|c == parseInt(c, 10)</code></pre><p>最终，我们获得了一个位于0和16777216之间的随机整数，也就是我们想要的随机颜色。此时我们只需要使用toString(16)将它转化为十六进制数即可。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>现在，你已经完全理解了前面的这一行代码中的各个部分。作为一个程序员，我们应该在完成工作之后多问自己几遍为什么，还有没有更好更简洁的方法。当然，最应该做的事情当然是多阅读程序代码，也许你就能从某一行代码中学到很多新东西。</p><blockquote><p>作者：<a href="http://mp.weixin.qq.com/s?__biz=MzI0ODA2ODU2NQ==&amp;mid=2651128098&amp;idx=1&amp;sn=0bb490546b038a514377adcefd97e913&amp;scene=0#wechat_redirect" target="_blank" rel="noopener">野狗</a></p><p>原文链接：<a href="http://arqex.com/939/learning-much-javascript-one-line-code" target="_blank" rel="noopener">Learning much javascript from one line of code</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>9月中旬的日志</title>
      <link href="/in-mid-september-note.html"/>
      <url>/in-mid-september-note.html</url>
      
        <content type="html"><![CDATA[<h3 id="工作-amp-amp-生活"><a href="#工作-amp-amp-生活" class="headerlink" title="工作 &amp;&amp; 生活"></a>工作 &amp;&amp; 生活</h3><p>:joy: :joy: :joy: :joy:</p><p>从上个月中下旬开始，就辞职在家，本来预计继续在南京找工作的，家里人劝我搬到苏州昆山附近找工作，一直持续到月底才搬过来。</p><p>搬苏州前段时间，在南京投了几家简历，打了电话确定时间去面试的，但搬到苏州，计划全部打乱了。</p><p>走的时候，突然舍不得南京，它给我的故乡在家的感觉。别了，南京！</p><p>大概晚上7点走，看着车窗外的夜景，一路彷徨，不知所向。消极？怀疑？像心魔充斥着我。10点多终于到家了，也应该好好睡上一觉了！</p><p>最近在苏州看了不少招聘信息，说实话，投了这么多家，回馈的信息好少，难道还没到招聘的黄金时期？妈蛋…于是就在家做了一点私活，好歹赚点钱。续续断断搞了俩个星期，感觉整个苏州被抛弃了一样，决定投向上海…</p><h3 id="心态"><a href="#心态" class="headerlink" title="心态"></a>心态</h3><p>心态？我知道我心里有问题，至少没影响到我工作生活就行了，努力治疗吧！</p><h3 id="琐事"><a href="#琐事" class="headerlink" title="琐事"></a>琐事</h3><p>what？</p><p>你觉得程序狗琐事真的很多吗？天天坐在电脑前，哪来这么多事情…</p><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>噢，请各大基佬帮忙帮我找份全职工作，<code>Java Web工程师</code>或者<code>Web前端工程师</code>就行了。木木哒~</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Java实例：数组扩容</title>
      <link href="/java-example-array-expansion.html"/>
      <url>/java-example-array-expansion.html</url>
      
        <content type="html"><![CDATA[<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p>在数组初始化后对数组进行扩容</p><pre><code>public class Main {   public static void main(String[] args) {      String[] names = new String[] { &quot;A&quot;, &quot;B&quot;, &quot;C&quot; };      String[] extended = new String[5];      extended[3] = &quot;D&quot;;      extended[4] = &quot;E&quot;;      System.arraycopy(names, 0, extended, 0, names.length);      for (String str : extended){         System.out.println(str);        } }}</code></pre><p>以上代码运行输出结果为： A B C D E</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript 各种遍历方式详解</title>
      <link href="/javascript-traversal-comments.html"/>
      <url>/javascript-traversal-comments.html</url>
      
        <content type="html"><![CDATA[<p>为了方便例子讲解，现有数组和json对象如下</p><pre><code>var demoArr = [&apos;Javas cript&apos;, &apos;Gulp&apos;, &apos;CSS3&apos;, &apos;Grunt&apos;, &apos;jQuery&apos;, &apos;angular&apos;];var demoObj = {    aaa: &apos;Javas cript&apos;,    bbb: &apos;Gulp&apos;,    ccc: &apos;CSS3&apos;,    ddd: &apos;Grunt&apos;,    eee: &apos;jQuery&apos;,    fff: &apos;angular&apos;};</code></pre><h3 id="for"><a href="#for" class="headerlink" title="for"></a>for</h3><p>可以直接看示例，用得太多了，很简单</p><pre><code>var i = 0, len = demo1Arr.length;for(; i&lt;len; i++) {};</code></pre><p>跳出循环的方式有如下几种 <code>return</code> 函数执行被终止 <code>break</code> 循环被终止 <code>continue</code> 循环被跳过</p><h3 id="for-in"><a href="#for-in" class="headerlink" title="for in"></a>for in</h3><p><code>for(var item in arr|obj){}</code> 可以用于遍历数组和对象</p><p>遍历数组时，item表示索引值， arr表示当前索引值对应的元素 arr[item] 遍历对象时，item表示key值，arr表示key值对应的value值 obj[item]</p><pre><code>(function() {    for(var i in demoArr) {        if (i == 2) {            return; // 函数执行被终止            // break;  // 循环被终止            // continue;  // 循环被跳过        };        console.log(&apos;demoArr[&apos;+ i +&apos;]:&apos; + demoArr[i]);    }    console.log(&apos;-------------&apos;);})();</code></pre><p>关于<code>for in</code>，有以下几点需要注意：</p><p>在for循环与for in循环中，i值都会在循环结束之后保留下来。 因此使用函数自执行的方式避免。 使用return，break，continue跳出循环都与for循环一致， 不过关于return需要注意，在函数体中，return表示函数执行终止， 就算是循环外面的代码，也不再继续往下执行。 而break仅仅只是终止循环，后面的代码会继续执行。</p><pre><code>function res() {    var demoArr = [&apos;Javas cript&apos;, &apos;Gulp&apos;, &apos;CSS3&apos;, &apos;Grunt&apos;, &apos;jQuery&apos;, &apos;angular&apos;];    for(var item in demoArr) {        if (item == 2) {            return;        };        console.log(item, demoArr[item]);    }    console.log(&apos;desc&apos;, &apos;function res&apos;); //不会执行}</code></pre><h3 id="forEach"><a href="#forEach" class="headerlink" title="forEach"></a>forEach</h3><p><code>demoArr.forEach(function(arg) {})</code> 参数arg表示数组每一项的元素，实例如下</p><pre><code>demoArr.forEach(function(val, index) {    if (e == &apos;CSS3&apos;) {        return;  // 循环被跳过        // break;   // 报错        // continue;// 报错    };    console.log(val, index);})</code></pre><p>具体有以下需要注意的地方</p><p>回调函数中有2个参数，分别表示值和索引， 这一点与jQuery中的$.each相反。 forEach无法遍历对象； forEach无法在IE中使用，firefox和chrome实现了该方法； forEach无法使用break，continue跳出循环； 使用return时，效果和在for循环中使用continue一致。 最重要的一点，可以添加第二参数， 为一个数组，而且回调函数中的this会指向这个数组。 而如果没有第二参数，则this会指向window。</p><pre><code>var newArr = [];demoArr.forEach(function(val, index) {    this.push(val); // 这里的this指向newArr}, newArr)</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于HTML的一些知识点汇总-2</title>
      <link href="/some-knowledge-about-html-summary-2.html"/>
      <url>/some-knowledge-about-html-summary-2.html</url>
      
        <content type="html"><![CDATA[<h3 id="css引入方式有哪些"><a href="#css引入方式有哪些" class="headerlink" title="css引入方式有哪些"></a>css引入方式有哪些</h3><p>4种方法</p><p>1、使用元素连接到外部样式文件</p><p>2、在元素中使用“style”元素来指定</p><p>3、使用css“@import”标记来导入样式表单</p><p>4、在内部元素中使用‘style’属性来定义样式</p><h3 id="link和-import"><a href="#link和-import" class="headerlink" title="link和@import"></a>link和@import</h3><p>两者都是为了加载css文件。</p><p>区别在于：</p><p>1、属于html标签，而@import完全是css提供的一种方式。link标签除了可以加载css外还</p><p>可以定义RSS，定义rel连接属性，而@import只能加载css。</p><p>2、加载顺序差别。单一个页面被加载时引用css会同时被加载，而@import引用的css会等</p><p>到页面全部被下载完再加载</p><p>3、使用dom控制样式差别。当使用Javas cript控制dom去改变样式的时候。只能使用标签。</p><h3 id="CSS选择器有哪些？"><a href="#CSS选择器有哪些？" class="headerlink" title="CSS选择器有哪些？"></a>CSS选择器有哪些？</h3><p>1、通配选择器：*{margin：0px;}</p><p>2、类型选择器：a{}</p><p>3、属性选择器:input[name = “name”]{}</p><p>4、后代选择器:div a{}</p><p>5、子对象选择器:ul&gt;li{}</p><p>6、ID选择器</p><p>7、类选择器</p><p>8、选择器分组：body，ul，li，{}</p><p>9、伪类及伪对象选择器：div：first-leter{}，a.test:hover{text-decoration:undeline}</p><p>10、相邻选择器:li+li{font-size:10px;}</p><h3 id="哪些属性可以继承"><a href="#哪些属性可以继承" class="headerlink" title="哪些属性可以继承"></a>哪些属性可以继承</h3><p>css 文字相关的： font-family、font-size、font-style、font-weight、font、letter-spacing（字符间距）、line-height、text-align、text-indent、text-transform、word-spacing（字间隔）</p><p>列表相关：list-style-image、list-style-position、list-style-type、list-style</p><p>颜色相关：color</p><p>透明度：opacity</p><h3 id="优先级算法如何计算？"><a href="#优先级算法如何计算？" class="headerlink" title="优先级算法如何计算？"></a>优先级算法如何计算？</h3><p>！important &gt; id &gt;class &gt;Tag</p><p>important比内联优先级高；但是内联比id要高</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>提高网页Web转换率</title>
      <link href="/web-pages-to-improve-conversion-rates.html"/>
      <url>/web-pages-to-improve-conversion-rates.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>优异的使用者介面（user interface，UI）让使用者用得顺心，从而提高转换率（conversion rate），换言之，好的 UI 在使用与销售层面上形成双赢。</p><h3 id="单栏型式优于多栏"><a href="#单栏型式优于多栏" class="headerlink" title="单栏型式优于多栏"></a>单栏型式优于多栏</h3><p>单栏型式让你更能掌握自己的内容，从顶部到底部一气呵成，用故事引导读者，最终是要诱引他们「采取行动」（call to action，下称 CTA，意指下载或消费等目的）；而多栏反而可能导致读者分心。</p><p><img src="http://img01.store.sogou.com/net/a/04/link?appid=100520022&amp;w=600&amp;url=http://mmbiz.qpic.cn/mmbiz/BJnibHupq5dELvm6G9WFPkySYuONSAJRzb2AbuV4qAJNbSGyIRRJRCUSJMDxhTnbdz2joMUwcl0xyEvlfrA3pTw/0" alt></p><p>「略施小惠」给使用者，贩卖的意图不要设计得太明显。小小的优惠或礼物，对未来的销售会带来大大的帮助。</p><p><img src="http://img01.store.sogou.com/net/a/04/link?appid=100520022&amp;w=600&amp;url=http://mmbiz.qpic.cn/mmbiz/BJnibHupq5dELvm6G9WFPkySYuONSAJRzFaQJDOlPLwoJKibVTT6mVAID0lPSVaiczg5iaV4ORUxQlaPLBSnv3T2KQ/0" alt></p><h3 id="统一相似的功能，避免支离破碎的-UI"><a href="#统一相似的功能，避免支离破碎的-UI" class="headerlink" title="统一相似的功能，避免支离破碎的 UI"></a>统一相似的功能，避免支离破碎的 UI</h3><p>统一相似的功能，避免支离破碎的 UI 浏览网站时，我们很常看到琳琅满目的元素或特色，但它们的功能毫无二致，而相似的选项太多，只会提高让使用者无所适从。</p><p>倘若发现自己的网站内有以不同型式重複相同功能的状况，不妨考虑重新设计 UI，把类似功能整合起来。</p><p>譬如图中「Customer Service（客服）」、「Contact Us（联系我们）」其实是一样的意思，应当保留一个选项就好。</p><p><img src="http://img01.store.sogou.com/net/a/04/link?appid=100520022&amp;w=600&amp;url=http://mmbiz.qpic.cn/mmbiz/BJnibHupq5dELvm6G9WFPkySYuONSAJRzLwFHOjDFiaGib4HXhzKHeUzPDzGiczsOAPDT6DsuXjJos3Dx4pSXzP5dQ/0" alt></p><h3 id="使用者见证或提出销售实据"><a href="#使用者见证或提出销售实据" class="headerlink" title="使用者见证或提出销售实据"></a>使用者见证或提出销售实据</h3><p>使用者见证或提出销售实据</p><p>「社会认同」（social proof）是刺激转换率很好的策略，自己再怎麽天花乱坠终究只是自吹自擂，请使用者见证或数字实据才有效。</p><p><img src="http://img01.store.sogou.com/net/a/04/link?appid=100520022&amp;w=600&amp;url=http://mmbiz.qpic.cn/mmbiz/BJnibHupq5dELvm6G9WFPkySYuONSAJRzlHB0suMtpiba2xCP1rWAnaiaPdnIwwo14ewfqiavaFxyT6icrBOmgp9vWA/0" alt></p><h3 id="主要目的请反复强调，别只提一次"><a href="#主要目的请反复强调，别只提一次" class="headerlink" title="主要目的请反复强调，别只提一次"></a>主要目的请反复强调，别只提一次</h3><p>主要目的请反复强调，别只提一次</p><p>希望使用者点击的连结或按钮（比如购买或下载），别只出现一次，可以考虑放在单栏网页的顶端与底部，或在多个页面呈现。</p><p><img src="http://img01.store.sogou.com/net/a/04/link?appid=100520022&amp;w=600&amp;url=http://mmbiz.qpic.cn/mmbiz/BJnibHupq5dELvm6G9WFPkySYuONSAJRzbVmgpyp5g5oDmT4KgrHuKG6Nhv7eficlcyCZUw0TG0RFAudeBtHUm0g/0" alt></p><h3 id="清楚区别三种功能性（可点击、已点击、纯文字）元素"><a href="#清楚区别三种功能性（可点击、已点击、纯文字）元素" class="headerlink" title="清楚区别三种功能性（可点击、已点击、纯文字）元素"></a>清楚区别三种功能性（可点击、已点击、纯文字）元素</h3><p>清楚区别三种功能性（可点击、已点击、纯文字）元素、可点击的元素（连结、按钮）、已点击的元素、纯文字三者彼此应该以颜色、深度或对比等各种设计技巧清楚区隔，让使用者浏览网站畅行无阻。</p><p>例如下图，蓝色字体是连结，黑色字体是使用者点击的选项，或者是使用者正在浏览的页面。</p><p><img src="http://img01.store.sogou.com/net/a/04/link?appid=100520022&amp;w=600&amp;url=http://mmbiz.qpic.cn/mmbiz/BJnibHupq5dELvm6G9WFPkySYuONSAJRz4ewwnBWQHriawrXaLojlwLicAefnXSzuEZ0Piab77uzuDZAZPeY7S0bZw/0" alt></p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>实用HTML文件的增强标记</title>
      <link href="/enhanced-tag-of-html.html"/>
      <url>/enhanced-tag-of-html.html</url>
      
        <content type="html"><![CDATA[<p>实用HTML文件的增强标记</p><hr><h3 id="〈script〉标记"><a href="#〈script〉标记" class="headerlink" title="〈script〉标记"></a>〈script〉标记</h3><p>〈script〉是用来标志javas cript和vbscript编程的HTML标记，它的格式如下：</p><p>〈script属性=属性值〉javascript或者vbscript程序源代码〈/script〉</p><p>你可以在页面中插入任意多的〈script〉……〈/script〉标记块。〈script〉标记有多种属性(如event、for、language、src等)，其中最常用的是language属性，它用来指定脚本的语言类型，如“javascript”或“vbscript”。</p><h3 id="〈applet〉标记"><a href="#〈applet〉标记" class="headerlink" title="〈applet〉标记"></a>〈applet〉标记</h3><p>〈applet〉标记是用来在页面中插入java小程序的专用标记，它有多种属性。〈applet〉标记的一般属性格式如下：</p><p>〈applet属性=属性值〉〈/applet〉</p><p>它的各种属性分别用来定义java小程序的路径、文件名、java applet小程序在页面中的位置、大小及运行参数等。</p><h3 id="〈object〉标记"><a href="#〈object〉标记" class="headerlink" title="〈object〉标记"></a>〈object〉标记</h3><p>〈object〉标记不仅可以用来在页面中插入activex控件，还可以插入其他的ole对象，如图像、文档、动画、小程序等等，它的格式为：</p><p>〈object属性=属性值〉〈/object〉</p><p>它的各种属性分别用来设定插入对象的类型、路径、在页面中显示的大小、位置等。</p><h3 id="〈param〉标记"><a href="#〈param〉标记" class="headerlink" title="〈param〉标记"></a>〈param〉标记</h3><p>用〈object〉标记在页面中插入activex控件或其它对象之后，有时候需要向该对象或者控件传递参数，这就要使用〈param〉标记。该标记没有相应的结束标志〈/param〉，并且该标记仅在〈object〉标记中有效，它的一般格式为：</p><p>〈param name=＊value=＊valuetype=＊type=＊〉</p><p>各属性的含义是：name是参数的名字；value指定参数的值；valuetype指定怎样表示参数的值；type指定媒体类型。</p><h3 id="〈embed〉标记"><a href="#〈embed〉标记" class="headerlink" title="〈embed〉标记"></a>〈embed〉标记</h3><p>该标记可以用来在主页中嵌入多媒体文件，如电影(movIE)、声音、虚拟现实语言(vrml)等，但此时需要在浏览器中安装播放相应多媒体文件的插件。</p><p>〈embed〉标记在各个插件中表现不同，它的一般格式为：〈embed src=″url″〉。</p><h3 id="〈bgsound〉标记"><a href="#〈bgsound〉标记" class="headerlink" title="〈bgsound〉标记"></a>〈bgsound〉标记</h3><p>该标记用来在页面中插入背景音乐，它的格式为：</p><p>〈bgsound src=″url″loop=″＊″〉</p><p>其中src用来指定wav文件的地址，loop设定循环播放次数</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>总结伪类与伪元素</title>
      <link href="/summary-of-pseudo-classes-and-pseudo-elements.html"/>
      <url>/summary-of-pseudo-classes-and-pseudo-elements.html</url>
      
        <content type="html"><![CDATA[<p>熟悉前端的人都会听过css的伪类与伪元素，然而大多数的人都会将这两者混淆。本文从解析伪类与伪元素的含义出发，区分这两者的区别，并且列出大部分伪类与伪元素的具体用法，即使你有用过伪类与伪元素，但里面总有一两个你没见过的吧。</p><p><strong>1.伪类与伪元素</strong></p><p>先说一说为什么css要引入伪元素和伪类，以下是<a href="https://www.w3.org/TR/CSS2/selector.html#pseudo-elements" target="_blank" rel="noopener">css2.1 Selectors章节中对伪类与伪元素的描述</a>：</p><p><em>CSS introduces the concepts of pseudo-elements and pseudo-classes to permit formatting based on information that lies outside the document tree.</em></p><p>直译过来就是：css引入伪类和伪元素概念是为了格式化文档树以外的信息。也就是说，伪类和伪元素是用来修饰不在文档树中的部分，比如，一句话中的第一个字母，或者是列表中的第一个元素。下面分别对伪类和伪元素进行解释：</p><p>伪类用于当已有元素处于的某个状态时，为其添加对应的样式，这个状态是根据用户行为而动态变化的。比如说，当用户悬停在指定的元素时，我们可以通过:hover来描述这个元素的状态。虽然它和普通的css类相似，可以为已有的元素添加样式，但是它只有处于dom树无法描述的状态下才能为元素添加样式，所以将其称为伪类。</p><p>伪元素用于创建一些不在文档树中的元素，并为其添加样式。比如说，我们可以通过:before来在一个元素前增加一些文本，并为这些文本添加样式。虽然用户可以看到这些文本，但是这些文本实际上不在文档树中。</p><p><strong>2.伪类与伪元素的区别</strong></p><p>这里通过两个例子来说明两者的区别。</p><p>下面是一个简单的html列表片段：</p><pre><code>&lt;ul&gt;    &lt;li&gt;我是第一个&lt;/li&gt;    &lt;li&gt;我是第二个&lt;/li&gt;&lt;/ul&gt;</code></pre><p>如果想要给第一项添加样式，可以在为第一个</p><ul><li>添加一个类，并在该类中定义对应样式：</li></ul><p><strong>HTML:</strong></p><pre><code>&lt;ul&gt;    &lt;li class=&quot;first-item&quot;&gt;我是第一个&lt;/li&gt;    &lt;li&gt;我是第二个&lt;/li&gt;&lt;/ul&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>li.first-item  {    color:  orange</code></pre><p>如果不用添加类的方法，我们可以通过给设置第一个</p><ul><li>的:first-child伪类来为其添加样式。这个时候，被修饰的</li><li>元素依然处于文档树中。</li></ul><p><strong>HTML:</strong></p><pre><code>&lt;ul&gt;    &lt;li&gt;我是第一个&lt;/li&gt;    &lt;li&gt;我是第二个&lt;/li&gt;&lt;/ul&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>li:first-child  {    color:  orange}</code></pre><p>下面是另一个简单的html段落片段：</p><pre><code>&lt;p&gt;Hello World,  and  wish you have  a  good day!&lt;/p&gt;</code></pre><p>如果想要给该段落的第一个字母添加样式，可以在第一个字母中包裹一个元素，并设置该span元素的样式：</p><p><strong>HTML:</strong></p><pre><code>&lt;p&gt;&lt;span class=&quot;first&quot;&gt;H&lt;/span&gt;ello World,  and  wish you have  a  good day!&lt;/p&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>.first  {    font-size:  5em;}</code></pre><p>如果不创建一个元素，我们可以通过设置</p><p>的:first-letter伪元素来为其添加样式。这个时候，看起来好像是创建了一个虚拟的元素并添加了样式，但实际上文档树中并不存在这个元素。</p><p><strong>HTML:</strong></p><pre><code>&lt;p&gt;Hello World,  and  wish you have  a  good day!&lt;/p&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>p:first-letter  {    font-size:  5em;</code></pre><p>从上述例子中可以看出，伪类的操作对象是文档树中已有的元素，而伪元素则创建了一个文档数外的元素。因此，伪类与伪元素的区别在于：有没有创建一个文档树之外的元素。</p><p><strong>3.伪元素是使用单冒号还是双冒号？</strong></p><p>CSS3规范中的要求使用双冒号(::)表示伪元素，以此来区分伪元素和伪类，比如::before和::after等伪元素使用双冒号(::)，:hover和:active等伪类使用单冒号(:)。除了一些低于IE8版本的浏览器外，大部分浏览器都支持伪元素的双冒号(::)表示方法。</p><p>然而，除了少部分伪元素，如::backdrop必须使用双冒号，大部分伪元素都支持单冒号和双冒号的写法，比如::after，写成:after也可以正确运行。</p><p>对于<a href="https://www.w3.org/community/webed/wiki/Advanced_CSS_selectors#CSS3_pseudo-element_double_colon_syntax" target="_blank" rel="noopener">伪元素是使用单冒号还是双冒号的问题</a>，w3c标准中的描述如下：</p><p><em>Please note that the new CSS3 way of writing pseudo-elements is to use a double colon, eg a::after { … }, to set them apart from pseudo-classes. You may see this sometimes in CSS. CSS3 however also still allows for single colon pseudo-elements, for the sake of backwards compatibility, and we would advise that you stick with this syntax for the time being.</em></p><p>大概的意思就是：虽然CSS3标准要求伪元素使用双冒号的写法，但也依然支持单冒号的写法。为了向后兼容，我们建议你在目前还是使用单冒号的写法。</p><p>实际上，伪元素使用单冒号还是双冒号很难说得清谁对谁错，你可以按照个人的喜好来选择某一种写法。</p><p><strong>4.伪类与伪元素的具体用法</strong></p><p>这一章以含义解析和例子的方式列出大部分的伪类和伪元素的具体用法。下面是根据用途分类的伪类总结图和根据冒号分类的伪元素总结图：</p><p><a href="http://cdn.alloyteam.com/wp-content/uploads/2016/05/%E4%BC%AA%E7%B1%BB.png" target="_blank" rel="noopener"><img src="http://cdn.alloyteam.com/wp-content/uploads/2016/05/%E4%BC%AA%E7%B1%BB.png" alt="伪类"></a></p><p><a href="http://cdn.alloyteam.com/wp-content/uploads/2016/05/%E4%BC%AA%E5%85%83%E7%B4%A0.png" target="_blank" rel="noopener"><img src="http://cdn.alloyteam.com/wp-content/uploads/2016/05/%E4%BC%AA%E5%85%83%E7%B4%A0.png" alt="伪元素"></a></p><p>某些伪类或伪元素仍然处于试验阶段，在使用前建议先在<a href="http://caniuse.com/" target="_blank" rel="noopener">Can I Use</a>等网站查一查其浏览器兼容性。处于试验阶段的伪类或伪元素会在标题中标注。</p><p><strong>伪类</strong></p><p><strong>状态</strong></p><p>由于状态伪类的用法大家都十分熟悉，这里就不用例子说明了。</p><p><strong>1 :link</strong></p><p>选择未访问的链接</p><p><strong>2 :visited</strong></p><p>选择已访问的链接</p><p><strong>3 :hover</strong></p><p>选择鼠标指针浮动在其上的元素</p><p><strong>4 :active</strong></p><p>选择活动的链接</p><p><strong>5 :focus</strong></p><p>选择获取焦点的输入字段</p><p><strong>结构化</strong></p><p><strong>1 :not</strong></p><p>一个否定伪类，用于匹配不符合参数选择器的元素。</p><p>如下例，除了第一个</p><ul><li>元素外，其他</li><li>元素的文本都会变为橙色。</li></ul><p><strong>HTML:</strong></p><pre><code>&lt;ul&gt;    &lt;li class=&quot;first-item&quot;&gt;一些文本&lt;/li&gt;    &lt;li&gt;一些文本&lt;/li&gt;    &lt;li&gt;一些文本&lt;/li&gt;    &lt;li&gt;一些文本&lt;/li&gt;&lt;/ul&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>li:not(.first-item)  {    color:  orange;}</code></pre><p><strong>2 :first-child</strong></p><p>匹配元素的第一个子元素。</p><p>如下例，第一个</p><ul><li>元素的文本会变为橙色。</li></ul><p><strong>HTML:</strong></p><pre><code>&lt;ul&gt;    &lt;li&gt;这里的文本是橙色的&lt;/li&gt;    &lt;li&gt;一些文本&lt;/li&gt;    &lt;li&gt;一些文本&lt;/li&gt;&lt;/ul&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>li:first-child  {    color:  orange;}</code></pre><p><strong>3 : last-child</strong></p><p>匹配元素的最后一个子元素。</p><p>如下例，最后一个</p><ul><li>元素的文本会变为橙色。</li></ul><p><strong>HTML:</strong></p><pre><code>&lt;ul&gt;    &lt;li&gt;一些文本&lt;/li&gt;    &lt;li&gt;一些文本&lt;/li&gt;    &lt;li&gt;这里的文本是橙色的&lt;/li&gt;&lt;/ul&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>li:last-child  {    color:  orange;}</code></pre><p><strong>4 first-of-type</strong></p><p>匹配属于其父元素的首个特定类型的子元素的每个元素。</p><p>如下例，第一个</p><ul><li>元素和第一个元素的文本会变为橙色。</li></ul><p><strong>HTML:</strong></p><pre><code>&lt;ul&gt;    &lt;li&gt;这里的文本是橙色的&lt;/li&gt;    &lt;li&gt;一些文本 &lt;span&gt;这里的文本是橙色的&lt;/span&gt;&lt;/li&gt;    &lt;li&gt;一些文本&lt;/li&gt;&lt;/ul&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>ul  :first-of-type  {    color:  orange;}</code></pre><p><strong>5 :last-of-type</strong></p><p>匹配元素的最后一个子元素。</p><p>如下例，最后一个</p><ul><li>元素的文本会变为橙色。</li></ul><p><strong>HTML:</strong></p><pre><code>&lt;ul&gt;    &lt;li&gt;一些文本&lt;span&gt;一些文本&lt;/span&gt; &lt;span&gt;这里的文本是橙色的&lt;/span&gt;&lt;/li&gt;    &lt;li&gt;一些文本&lt;/li&gt;    &lt;li&gt;这里的文本是橙色的&lt;/li&gt;&lt;/ul&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>ul  :last-of-type  {    color:  orange;}</code></pre><p><strong>6 :nth-child</strong></p><p>:nth-child根据元素的位置匹配一个或者多个元素，它接受一个an+b形式的参数，an+b匹配到的元素示例如下：</p><ul><li>1n+0，或n，匹配每一个子元素。</li><li>2n+0，或2n，匹配位置为2、4、6、8…的子元素，该表达式与关键字even等价。</li><li>2n+1匹配位置为1、3、5、7…的子元素、该表达式与关键字odd等价。</li><li>3n+4匹配位置为4、7、10、13…的子元素。</li></ul><p>如下例，有以下HTML列表：</p><pre><code>&lt;ol&gt;    &lt;li&gt;Alpha&lt;/li&gt;    &lt;li&gt;Beta&lt;/li&gt;    &lt;li&gt;Gamma&lt;/li&gt;    &lt;li&gt;Delta&lt;/li&gt;    &lt;li&gt;Epsilon&lt;/li&gt;    &lt;li&gt;Zeta&lt;/li&gt;    &lt;li&gt;Eta&lt;/li&gt;    &lt;li&gt;Theta&lt;/li&gt;    &lt;li&gt;Iota&lt;/li&gt;    &lt;li&gt;Kappa&lt;/li&gt;&lt;/ol&gt;</code></pre><p><strong>CSS:</strong></p><p>选择第二个元素，”Beta”会变成橙色：</p><pre><code>ol  :nth-child(2)  {    color:  orange;}</code></pre><p>选择位置序号是2的倍数的元素，”Beta”, “Delta”, “Zeta”, “kappa”会变成橙色:</p><pre><code>ol  :nth-child(2n)  {    color:  orange;}</code></pre><p>选择位置序号为偶数的元素：</p><pre><code>ol  :nth-child(even)  {    color:  orange;}</code></pre><p>选择从第6个开始，位置序号是2的倍数的元素，”Zeta”, “Theta”, “Kappa”会变成橙色：</p><pre><code>ol  :nth-child(2n+6)  {    color:  orange;}</code></pre><p><strong>7 :nth-last-child</strong></p><p>:nth-last-child与:nth-child相似，不同之处在于它是从最后一个子元素开始计数的。</p><p><strong>8 :nth-of-type</strong></p><p>:nth-of-type与nth-child相似，不同之处在于它是只匹配特定类型的元素。</p><p>如下例，第二个</p><p>元素会变为橙色。</p><p><strong>HTML:</strong></p><pre><code>&lt;article&gt;    &lt;h1&gt;我是标题&lt;/h1&gt;    &lt;p&gt;一些文本&lt;/p&gt;    &lt;a  href=&quot;&quot;&gt;&lt;img src=&quot;images/rwd.png&quot;  alt=&quot;Mastering RWD&quot;&gt;&lt;/a&gt;    &lt;p&gt;这里的文本是橙色的&lt;/p&gt;&lt;/article&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>p:nth-of-type(2)  {    color:  orange;}</code></pre><p><strong>9 :nth-last-type</strong></p><p>:nth-last-of-type与nth-of-type相似，不同之处在于它是从最后一个子元素开始计数的。</p><p><strong>10 :only-child</strong></p><p>当元素是其父元素中唯一一个子元素时，:only-child匹配该元素。</p><p><strong>HTML:</strong></p><pre><code>&lt;ul&gt;    &lt;li&gt;这里的文本是橙色的&lt;/li&gt;&lt;/ul&gt;&lt;ul&gt;    &lt;li&gt;一些文本&lt;/li&gt;    &lt;li&gt;一些文本&lt;/li&gt;&lt;/ul&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>ul  :only-child  {    color:  orange;}</code></pre><p><strong>11 :only-of-type</strong></p><p>当元素是其父元素中唯一一个特定类型的子元素时，:only-child匹配该元素。</p><p>如下例，第一个ul元素只有一个li类型的元素，该li元素的文本会变为橙色。</p><p><strong>HTML:</strong></p><pre><code>&lt;ul&gt;    &lt;li&gt;这里的文本是橙色的&lt;/li&gt;    &lt;p&gt;这里不是橙色&lt;/p&gt;&lt;/ul&gt;&lt;ul&gt;    &lt;li&gt;一些文本&lt;/li&gt;    &lt;li&gt;一些文本&lt;/li&gt;&lt;/ul&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>li:only-of-type  {    color:  orange;}</code></pre><p><strong>12 :target</strong></p><p>当URL带有锚名称，指向文档内某个具体的元素时，:target匹配该元素。</p><p>如下例，url中的target命中id值为target的article元素，article元素的背景会变为黄色。</p><p><strong>URL:</strong></p><p><a href="http://example.com/#target" target="_blank" rel="noopener">http://example.com/#target</a></p><p><strong>HTML:</strong></p><pre><code>&lt;article id=&quot;target&quot;&gt;    &lt;h1&gt;:target  pseudo-class&lt;/h1&gt;    &lt;p&gt;Lorem ipsum dolor sit amet,  consectetur adipisicing elit!&lt;/p&gt;&lt;/article&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>:target  {    background:  yellow;}</code></pre><p><strong>表单相关</strong></p><p><strong>1 :checked</strong></p><p>:checked匹配被选中的input元素，这个input元素包括radio和checkbox。</p><p>如下例，当复选框被选中时，与其相邻的元素的背景会变成黄色。</p><p><strong>HTML:</strong></p><pre><code>&lt;input type=&quot;checkbox&quot;/&gt;&lt;label&gt;我同意&lt;/label&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>input:checked  +  label  {    background:  yellow;}</code></pre><p><strong>2 :default</strong></p><p>:default匹配默认选中的元素，例如：提交按钮总是表单的默认按钮。</p><p>如下例，只有提交按钮的背景变成了黄色。</p><p><strong>HTML:</strong></p><pre><code>&lt;form action=&quot;#&quot;&gt;    &lt;button&gt;重置&lt;/button&gt;    &lt;button type=&quot;submit&quot;&gt;提交&lt;/button&gt;&lt;/form&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>:default  {    background:  yellow;}</code></pre><p><strong>3 :disabled</strong></p><p>:disabled匹配禁用的表单元素。</p><p>如下例，被禁用input输入框的透明度会变成50%。</p><p><strong>HTML:</strong></p><pre><code>&lt;input type=&quot;text&quot;  disabled/&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>:disabled  {    opacity:  .5;}</code></pre><p><strong>4 :empty</strong></p><p>:empty匹配没有子元素的元素。如果元素中含有文本节点、HTML元素或者一个空格，则:empty不能匹配这个元素。</p><p>如下例，:empty能匹配的元素会变为黄色。</p><p>第一个元素中有文本节点，所以其背景不会变成黄色；</p><p>第二个元素中有一个空格，有空格则该元素不为空，所以其背景不会变成黄色；</p><p>第三个元素中没有任何内容，所以其背景会变成黄色；</p><p>第四个元素中只有一个注释，此时该元素是空的，所以其背景会变成黄色；</p><p><strong>HTML:</strong></p><pre><code>&lt;div&gt;这个容器里的背景是橙色的&lt;/div&gt;&lt;div&gt;  &lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;!--  This  comment is  not  considered content  --&gt;&lt;/div&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>div  {    background:  orange;    height:  30px;    width:  200px;}div:empty  {    background:  yellow;}</code></pre><p><strong>5 :enabled</strong></p><p>:enabled匹配没有设置disabled属性的表单元素。</p><p><strong>6 :in-range</strong></p><p>:in-range匹配在指定区域内元素。</p><p>如下例，当数字选择器的数字在5到10是，数字选择器的边框会设为绿色。</p><p><strong>HTML:</strong></p><pre><code>&lt;input type=&quot;number&quot;  min=&quot;5&quot;  max=&quot;10&quot;&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>input[type=number]  {    border:  5px  solid orange;}input[type=number]:in-range  {    border:  5px  solid green;}</code></pre><p><strong>7 :out-of-range</strong></p><p>:out-of-range与:in-range相反，它匹配不在指定区域内的元素。</p><p><strong>8 :indeterminate</strong></p><p>indeterminate的英文意思是“不确定的”。当某组中的单选框或复选框还没有选取状态时，:indeterminate匹配该组中所有的单选框或复选框。</p><p>如下例，当下面的一组单选框没有一个处于被选中时，与input相邻的label元素的背景会被设为橙色。</p><p><strong>HTML:</strong></p><pre><code>&lt;ul&gt;    &lt;li&gt;        &lt;input type=&quot;radio&quot;  name=&quot;list&quot;  id=&quot;option1&quot;&gt;        &lt;label for=&quot;option1&quot;&gt;Option  1&lt;/label&gt;    &lt;/li&gt;    &lt;li&gt;        &lt;input type=&quot;radio&quot;  name=&quot;list&quot;  id=&quot;option2&quot;&gt;        &lt;label for=&quot;option2&quot;&gt;Option  2&lt;/label&gt;    &lt;/li&gt;    &lt;li&gt;        &lt;input type=&quot;radio&quot;  name=&quot;list&quot;  id=&quot;option3&quot;&gt;        &lt;label for=&quot;option3&quot;&gt;Option  3&lt;/label&gt;    &lt;/li&gt;&lt;/ul&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>:indeterminate  +  label  {    background:  orange;}</code></pre><p><strong>9 :valid</strong></p><p>:valid匹配条件验证正确的表单元素。</p><p>如下例，当email输入框内的值符合email格式时，输入框的边框会被设为绿色。</p><p><strong>HTML:</strong></p><pre><code>&lt;input type=&quot;email&quot;/&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>input[type=email]:valid  {    border:  1px  solid green;}</code></pre><p><strong>10 :invalid</strong></p><p>:invalid与:valid相反，匹配条件验证错误的表单元素。</p><p><strong>11 :optional</strong></p><p>:optional匹配是具有optional属性的表单元素。当表单元素没有设置为required时，即为optional属性。</p><p>如下例，第一个input的背景不会被设为黄色，第二个input的背景会被设为黄色。</p><p><strong>HTML:</strong></p><pre><code>&lt;input type=&quot;text&quot;  required  /&gt;&lt;input type=&quot;text&quot;  /&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>:optional  {    background:  yellow;}</code></pre><p><strong>12 :required</strong></p><p>:required与:optional相反匹配设置了required属性的表单元素。</p><p><strong>13 :read-only</strong></p><p>:read-only匹配设置了只读属性的元素，表单元素可以通过设置“readonly”属性来定义元素只读。</p><p>如下例，input元素的背景会被设为黄色。</p><p><strong>HTML:</strong></p><pre><code>&lt;input type=&quot;text&quot;  value=&quot;I am read only&quot;  readonly&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>input:read-only  {    background-color:  yellow;}</code></pre><p><strong>14 :read-write</strong></p><p>:read-write匹配处于编辑状态的元素。input，textarea和设置了contenteditable的HTML元素获取焦点时即处于编辑状态。</p><p>如下例，input输入框和富文本框获取焦点时，背景变成黄色。</p><p><strong>HTML:</strong></p><pre><code>&lt;input type=&quot;text&quot;  value=&quot;获取焦点时背景变黄&quot;/&gt;&lt;div class=&quot;editable&quot;  contenteditable&gt;    &lt;h1&gt;点击这里可以编辑&lt;/h1&gt;    &lt;p&gt;获取焦点时背景变黄&lt;/p&gt;&lt;/div&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>:read-write:focus  {    background:  yellow;}</code></pre><p><strong>15 :scope(处于试验阶段)</strong></p><p>:scope匹配处于style作用域下的元素。当style没有设置scope属性时，style内的样式会对整个html起作用。</p><p>如下例，第二个section中的元素的文本会变为斜体。</p><p><strong>HTML:</strong></p><pre><code>&lt;article&gt;    &lt;section&gt;        &lt;h1&gt;很正常的一些文本&lt;/h1&gt;        &lt;p&gt;很正常的一些文本&lt;/p&gt;    &lt;/section&gt;    &lt;section&gt;        &lt;style scoped&gt;            :scope {                font-style:  italic;            }        &lt;/style&gt;        &lt;h1&gt;这里的文本是斜体的&lt;/h1&gt;        &lt;p&gt;这里的文本是斜体的&lt;/p&gt;    &lt;/section&gt;&lt;/article&gt;</code></pre><p>注：目前支持这个伪类的浏览器只有火狐。</p><p><strong>语言相关</strong></p><p><strong>1 :dir(处于实验阶段)</strong></p><p>:dir匹配指定阅读方向的元素，当HTML元素中设置了dir属性时该伪类才能生效。现时支持的阅读方向有两种：ltr（从左往右）和rtl（从右往左）。目前，只有火狐浏览器支持:dir伪类，并在火狐浏览器中使用时需要添加前缀( -moz-dir() )。</p><p>如下例，p元素中的阿拉伯语（阿拉伯语是从右往左阅读的）文本会变成橙色。</p><p><strong>HTML:</strong></p><pre><code>&lt;article dir=&quot;rtl&quot;&gt;&lt;p&gt;التدليك  واحد  من  أقدم  العلوم  الصحية  التي  عرفها  الانسان  والذي  يتم  استخدامه  لأغراض  الشفاء  منذ  ولاده  الطفل.&lt;/p&gt;&lt;/article&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>/* prefixed */article  :-moz-dir(rtl)  {    color:  orange;}/* unprefixed */article  :dir(rtl)  {    color:  orange;}</code></pre><p>如下例，p元素中的英语文本会变成蓝色</p><p><strong>HTML:</strong></p><pre><code>&lt;article dir=&quot;ltr&quot;&gt;    &lt;p&gt;اIf  you already know some HTML and  CSS and  understand the principles of responsive web design,  then  this  book is  for  you.&lt;/p&gt;&lt;/article&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>article  :-moz-dir(ltr)  {    color:  blue;}/* unprefixed */article  :dir(ltr)  {    color:  blue;}</code></pre><p><strong>2 :lang</strong></p><p>:lang匹配设置了特定语言的元素，设置特定语言可以通过为了HTML元素设置lang=””属性，设置meta元素的charset=””属性，或者是在http头部上设置语言属性。</p><p>实际上，lang=””属性不只可以在html标签上设置，也可以在其他的元素上设置。</p><p>如下例，分别给不同的语言设置不同的引用样式：</p><p><strong>HTML:</strong></p><pre><code>&lt;article lang=&quot;en&quot;&gt;    &lt;q&gt;Lorem ipsum dolor sit amet.&lt;/q&gt;&lt;/article&gt;&lt;article lang=&quot;fr&quot;&gt;    &lt;q&gt;Lorem ipsum dolor sit amet.&lt;/q&gt;&lt;/article&gt;&lt;article lang=&quot;de&quot;&gt;    &lt;q&gt;Lorem ipsum dolor sit amet.&lt;/q&gt;&lt;/article&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>:lang(en)  q  {  quotes:  &apos;“&apos;  &apos;”&apos;;  }:lang(fr)  q  {  quotes:  &apos;«&apos;  &apos;»&apos;;  }:lang(de)  q  {  quotes:  &apos;»&apos;  &apos;«&apos;;  }</code></pre><p><strong>其他</strong></p><p><strong>1 :root</strong></p><p>:root匹配文档的根元素。一般的html文件的根元素是html元素，而SVG或XML文件的根元素则可能是其他元素。</p><p>如下例，将html元素的背景设置为橙色</p><pre><code>:root  {    background:  orange;}</code></pre><p><strong>2.:fullscreen</strong></p><p>:fullscreen匹配处于全屏模式下的元素。全屏模式不是通过按F11来打开的全屏模式，而是通过Javascript的Fullscreen API来打开的，不同的浏览器有不同的Fullscreen API。目前，:fullscreen需要添加前缀才能使用。</p><p>如下例，当处于全屏模式时，h1元素的背景会变成橙色</p><p><strong>HTML:</strong></p><pre><code>&lt;h1 id=&quot;element&quot;&gt;在全屏模式下，这里的文本的背景会变成橙色.&lt;/h1&gt;&lt;button&gt;进入全屏模式!&lt;/button&gt;</code></pre><p><strong>JAVASCRIPT:</strong></p><pre><code>var  docelem  =  document.getElementById(&apos;element&apos;);var  button  =  document.querySelector(&apos;button&apos;);button.onclick  =  function()  {    if  (docelem.requestFullscreen)  {        docelem.requestFullscreen();    }else  if  (docelem.webkitRequestFullscreen)  {        docelem.webkitRequestFullscreen();    }  else  if(docelem.mozRequestFullScreen)  {        docelem.mozRequestFullScreen();    }  else  if(docelem.msRequestFullscreen)  {        docelem.msRequestFullscreen();    }}</code></pre><p><strong>CSS:</strong></p><pre><code>h1:fullscreen  {    background:  orange;}h1:-webkit-full-screen  {    background:  orange;}h1:-moz-full-screen  {    background:  orange;}h1:-ms-fullscreen  {    background:  orange;}</code></pre><p><strong>伪元素</strong></p><p><strong>1 ::before/:before</strong></p><p>:before在被选元素前插入内容。需要使用content属性来指定要插入的内容。被插入的内容实际上不在文档树中。</p><p><strong>HTML:</strong></p><pre><code>&lt;h1&gt;World&lt;/h1&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>h1:before  {    content:  &quot;Hello &quot;;}</code></pre><p><strong>2 ::after/:after</strong></p><p>:after在被元素后插入内容，其用法和特性与:before相似。</p><p><strong>3 ::first-letter/:first-letter</strong></p><p>:first-letter匹配元素中文本的首字母。被修饰的首字母不在文档树中。</p><p><strong>CSS:</strong></p><pre><code>h1:first-letter  {    font-size:  5em;}</code></pre><p><strong>4 ::first-line/:first-line</strong></p><p>:first-line匹配元素中第一行的文本。这个伪元素只能用在块元素中，不能用在内联元素中。</p><p><strong>CSS:</strong></p><pre><code>p:first-line  {    background:  orange;}</code></pre><p><strong>5 ::selection</strong></p><p>::selection匹配用户被用户选中或者处于高亮状态的部分。在火狐浏览器使用时需要添加-moz前缀。该伪元素只支持双冒号的形式。</p><p><strong>CSS:</strong></p><pre><code>::-moz-selection  {    color:  orange;    background:  #333;}::selection  {    color:  orange;    background:  #333;}</code></pre><p><strong>6 ::placeholder</strong></p><p>::placeholder匹配占位符的文本，只有元素设置了placeholder属性时，该伪元素才能生效。</p><p>该伪元素不是CSS的标准，它的实现可能在将来会有所改变，所以要决定使用时必须谨慎。</p><p>在一些浏览器中（IE10和Firefox18及其以下版本）会使用单冒号的形式。</p><p><strong>HTML:</strong></p><pre><code>&lt;input type=&quot;email&quot;  placeholder=&quot;name@domain.com&quot;&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>input::-moz-placeholder  {    color:#666;}input::-webkit-input-placeholder  {    color:#666;}/* IE 10 only */input:-ms-input-placeholder  {    color:#666;}/* Firefox 18 and below */input:-moz-input-placeholder  {    color:#666;}</code></pre><p><strong>7 ::backdrop(处于试验阶段)</strong></p><p>::backdrop用于改变全屏模式下的背景颜色，全屏模式的默认颜色为黑色。该伪元素只支持双冒号的形式</p><p><strong>HTML:</strong></p><pre><code>&lt;h1 id=&quot;element&quot;&gt;This  heading will have  a  solid background color in  full-screen mode.&lt;/h1&gt;&lt;button onclick=&quot;var el = document.getElementById(&apos;element&apos;); el.webkitRequestFullscreen();&quot;&gt;Trigger full screen!&lt;/button&gt;</code></pre><p><strong>CSS:</strong></p><pre><code>h1:fullscreen::backdrop  {    background:  orange;}</code></pre><p><strong>参考文章</strong></p><ol><li><a href="https://www.smashingmagazine.com/2016/05/an-ultimate-guide-to-css-pseudo-classes-and-pseudo-elements/#disabled" target="_blank" rel="noopener">An Ultimate Guide To CSS Pseudo-Classes And Pseudo-Elements</a></li><li><a href="http://swordair.com/origin-and-difference-between-css-pseudo-classes-and-pseudo-elements/" target="_blank" rel="noopener">CSS伪类与CSS伪元素的区别及由来</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>使用HTML的canvas来完成波浪特效</title>
      <link href="/using-html-canvas-waves.html"/>
      <url>/using-html-canvas-waves.html</url>
      
        <content type="html"><![CDATA[<h3 id="HTML-5"><a href="#HTML-5" class="headerlink" title="HTML 5"></a>HTML 5</h3><p>标签</p><p>标签定义图形，比如图表和其他图像。</p><p>标签只是图形容器，您必须使用脚本来绘制图形。</p><p>HTML5</p><p>标签用于绘制图像（通过脚本，通常是 JavaScript）。 不过，</p><p>元素本身并没有绘制能力（它仅仅是图形的容器） – 您必须使用脚本来完成实际的绘图任务。 getContext() 方法可返回一个对象，该对象提供了用于在画布上绘图的方法和属性。</p><p>主要是JavaScript：</p><pre><code>var canvas = document.getElementById(&apos;canvas&apos;);var ctx = canvas.getContext(&apos;2d&apos;);canvas.width = canvas.parentNode.offsetWidth;canvas.height = canvas.parentNode.offsetHeight;//如果浏览器支持requestAnimFrame则使用requestAnimFrame否则使用setTimeout  window.requestAnimFrame = (function() {  return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame ||  function(callback) {    window.setTimeout(callback, 1000 / 60);  };})();//初始角度为0  var step = 0;//定义三条不同波浪的颜色  var lines = [&quot;rgba(235,0,90, 0.3)&quot;, &quot;rgba(235,0,90, 0.6)&quot;, &quot;rgba(235,0,90, 0.9)&quot;];function loop() {  ctx.clearRect(0, 0, canvas.width, canvas.height);  step++;  //画3个不同颜色的矩形    for (var j = lines.length - 1; j &gt;= 0; j--) {    ctx.fillStyle = lines[j];    //每个矩形的角度都不同     var angle = (step + j * 15) * Math.PI / 180;    var deltaHeight = Math.sin(angle) * 50;    var deltaHeightRight = Math.cos(angle) * 50;    ctx.beginPath();    ctx.moveTo(0, canvas.height / 2 + deltaHeight);    ctx.bezierCurveTo(canvas.width / 2, canvas.height / 2 + deltaHeight - 50, canvas.width / 2, canvas.height / 2 + deltaHeightRight - 50, canvas.width, canvas.height / 2 + deltaHeightRight);    ctx.lineTo(canvas.width, canvas.height);    ctx.lineTo(0, canvas.height);    ctx.lineTo(0, canvas.height / 2 + deltaHeight);    ctx.closePath();    ctx.fill();  }  requestAnimFrame(loop);}loop();</code></pre><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用JavaScript让表格隔行变色</title>
      <link href="/let-interlaced-color-table-using-javascript.html"/>
      <url>/let-interlaced-color-table-using-javascript.html</url>
      
        <content type="html"><![CDATA[<h3 id="使用JavaScript让表格隔行变色"><a href="#使用JavaScript让表格隔行变色" class="headerlink" title="使用JavaScript让表格隔行变色"></a>使用JavaScript让表格隔行变色</h3><pre><code>    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;Document&lt;/title&gt;    &lt;style type=&quot;text/css&quot;&gt;    &lt;/style&gt;&lt;table id=&quot;tab1&quot; border=&quot;1&quot; width=&quot;400&quot;&gt;    &lt;thead&gt;        &lt;td&gt;ID&lt;/td&gt;        &lt;td&gt;姓名&lt;/td&gt;        &lt;td&gt;性别&lt;/td&gt;    &lt;/thead&gt;    &lt;tbody&gt;        &lt;tr&gt;            &lt;td&gt;1&lt;/td&gt;            &lt;td&gt;王宝强&lt;/td&gt;            &lt;td&gt;男&lt;/td&gt;        &lt;/tr&gt;        &lt;tr&gt;            &lt;td&gt;2&lt;/td&gt;            &lt;td&gt;李喆&lt;/td&gt;            &lt;td&gt;男&lt;/td&gt;        &lt;/tr&gt;        &lt;tr&gt;            &lt;td&gt;3&lt;/td&gt;            &lt;td&gt;马蓉&lt;/td&gt;            &lt;td&gt;女&lt;/td&gt;        &lt;/tr&gt;        &lt;tr&gt;            &lt;td&gt;4&lt;/td&gt;            &lt;td&gt;YYF&lt;/td&gt;            &lt;td&gt;男&lt;/td&gt;        &lt;/tr&gt;        &lt;tr&gt;            &lt;td&gt;5&lt;/td&gt;            &lt;td&gt;Longdd&lt;/td&gt;            &lt;td&gt;男&lt;/td&gt;        &lt;/tr&gt;        &lt;tr&gt;            &lt;td&gt;6&lt;/td&gt;            &lt;td&gt;820&lt;/td&gt;            &lt;td&gt;男&lt;/td&gt;        &lt;/tr&gt;    &lt;/tbody&gt;&lt;/table&gt;&lt;script&gt;function changeColr(){    var oTable = document.getElementById(&apos;tab1&apos;);    var i=0;    var oldBgColor = &apos;&apos;;    for(i=0; i&lt;oTable.tBodies[0].rows.length; i++)    {        oTable.tBodies[0].rows[i].style.background=i%2?&apos;#CCC&apos;:&apos;&apos;;        oTable.tBodies[0].rows[i].onmouseover = function()        {            oldBgColor = this.style.backgroundColor;            this.style.backgroundColor = &apos;yellow&apos;;        };        oTable.tBodies[0].rows[i].onmouseout = function()        {            this.style.backgroundColor = oldBgColor;        };    }}changeColr();&lt;/script&gt;</code></pre><h3 id="实例展示"><a href="#实例展示" class="headerlink" title="实例展示"></a>实例展示</h3>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>用CSS3打造HTML5的Logo</title>
      <link href="/html5-with-css3-to-create-the-logo.html"/>
      <url>/html5-with-css3-to-create-the-logo.html</url>
      
        <content type="html"><![CDATA[<h3 id="利用CSS3的新样式属性制作一个HTML5的Logo"><a href="#利用CSS3的新样式属性制作一个HTML5的Logo" class="headerlink" title="利用CSS3的新样式属性制作一个HTML5的Logo"></a>利用CSS3的新样式属性制作一个HTML5的Logo</h3><pre><code>&lt;meta charset=&quot;utf-8&quot; /&gt;&lt;title&gt;HTML5 logo&lt;/title&gt;&lt;style&gt;div{position:absolute}.dark_orange{background:#e15016}.light_orange{background:#ee6812}.light_gray{background:#ebebeb}.white{background:#fff}.beam{width:1600px;height:20px;-webkit-transform-origin:800 10;top:290px;left:-400px}&lt;/style&gt;&lt;body style=&quot;margin:0;padding:0&quot;&gt;&lt;div class=&quot;bg&quot; style=&quot;width:800px;height:600px;background:#f2f2f2;overflow:hidden&quot;&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(5deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(15deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(25deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(35deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(45deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(55deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(65deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(75deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(85deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(95deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(105deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(115deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(125deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(135deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(145deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(155deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(165deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white beam&quot; style=&quot;-webkit-transform:rotate(175deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;logo&quot; style=&quot;top:120px;left:229px;&quot;&gt;&lt;!-- left side --&gt;&lt;div class=&quot;dark_orange&quot; style=&quot;left:32px;width:140px;height:346px;&quot;&gt;&lt;/div&gt;&lt;div class=&quot;dark_orange&quot; style=&quot;-webkit-transform:skewx(5deg);left:16px;width:100px;height:346px;&quot;&gt;&lt;/div&gt;&lt;div class=&quot;dark_orange&quot; style=&quot;-webkit-transform:skewy(15deg);top:265px;left:32px;width:140px;height:100px;&quot;&gt;&lt;/div&gt;&lt;!-- right side --&gt;&lt;div class=&quot;dark_orange&quot; style=&quot;left:172px;width:140px;height:346px;&quot;&gt;&lt;/div&gt;&lt;div class=&quot;dark_orange&quot; style=&quot;-webkit-transform:skewx(-5deg);left:227px;width:100px;height:346px;&quot;&gt;&lt;/div&gt;&lt;div class=&quot;dark_orange&quot; style=&quot;-webkit-transform:skewy(-15deg);top:265px;left:172px;width:140px;height:100px;&quot;&gt;&lt;/div&gt;&lt;!-- inner --&gt;&lt;div style=&quot;-webkit-transform:scale(0.82);left:31px;top:25px&quot;&gt;  &lt;div class=&quot;light_orange&quot; style=&quot;left:172px;width:140px;height:346px;&quot;&gt;&lt;/div&gt;  &lt;div class=&quot;light_orange&quot; style=&quot;-webkit-transform:skewx(-5deg);left:227px;width:100px;height:363px;&quot;&gt;&lt;/div&gt;  &lt;div class=&quot;light_orange&quot; style=&quot;-webkit-transform:skewy(-15deg);top:282px;left:172px;width:138px;height:100px;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;!-- 5 --&gt;&lt;div class=&quot;light_gray&quot; style=&quot;height:43px;width:102px;left:70px;top:70px&quot;&gt;&lt;/div&gt;&lt;div class=&quot;light_gray&quot; style=&quot;width:46px;height:216px;-webkit-transform:skewx(5deg);top:70px;left:75px;&quot;&gt;&lt;/div&gt;&lt;div class=&quot;light_gray&quot; style=&quot;height:43px;width:95px;left:77px;top:156px&quot;&gt;&lt;/div&gt;&lt;div class=&quot;light_gray&quot; style=&quot;height:47px;width:87px;left:85px;top:251px;-webkit-transform:skewy(15deg)&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white&quot; style=&quot;height:43px;width:102px;left:172px;top:70px&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white&quot; style=&quot;width:46px;height:216px;-webkit-transform:skewx(-5deg);top:70px;left:223px;&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white&quot; style=&quot;height:43px;width:95px;left:172px;top:156px&quot;&gt;&lt;/div&gt;&lt;div class=&quot;white&quot; style=&quot;height:47px;width:87px;left:172px;top:251px;-webkit-transform:skewy(-15deg)&quot;&gt;&lt;/div&gt;&lt;!-- patch --&gt;&lt;div class=&quot;dark_orange&quot; style=&quot;height:20px;top:199px;width:80px;left:60px;&quot;&gt;&lt;/div&gt;&lt;div class=&quot;light_orange&quot; style=&quot;height:43px;top:113px;width:100px;left:180px;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;!-- end of logo --&gt;&lt;/div&gt;&lt;!-- end of bg --&gt;</code></pre><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React 编程风格指南</title>
      <link href="/react-programming-style-guide.html"/>
      <url>/react-programming-style-guide.html</url>
      
        <content type="html"><![CDATA[<h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><h5 id="方法顺序遵循生命周期放在前面，-render-方法放在最后"><a href="#方法顺序遵循生命周期放在前面，-render-方法放在最后" class="headerlink" title="方法顺序遵循生命周期放在前面， render() 方法放在最后"></a>方法顺序遵循生命周期放在前面， <code>render()</code> 方法放在最后</h5><p>在 <code>react</code> 组件内部，方法的顺序如下：</p><ol><li>生命周期方法（按照时间先后顺序依次为： <code>getDefaultProps</code>, <code>getInitialState</code>, <code>componentWillMount</code>, <code>componentDidMount</code>, <code>componentWillReceiveProps</code>, <code>shouldComponentUpdate</code>, <code>componentWillUpdate</code>, <code>componentDidUpdate</code>, <code>componentWillUnmount</code> ）</li><li>其他的方法</li><li><code>render</code> 方法</li></ol><h5 id="事件处理函数的命名"><a href="#事件处理函数的命名" class="headerlink" title="事件处理函数的命名"></a>事件处理函数的命名</h5><p>采用 “handle” + “EventName” 的方式来命名 Example：</p><pre><code>&lt;Component onClick={this.handleClick} onLaunchMissiles={this.handleLaunchMissiles} /&gt;</code></pre><h5 id="事件函数作为属性时的命名"><a href="#事件函数作为属性时的命名" class="headerlink" title="事件函数作为属性时的命名"></a>事件函数作为属性时的命名</h5><p>为了跟 <code>react</code> 的事件命名保持一致： <code>onClick</code>, <code>onDrag</code>, <code>onChange</code>, 等等，采用如下格式：</p><pre><code>&lt;Component onLaunchMissiles={this.handleLaunchMissiles} /&gt;</code></pre><h5 id="元素跟-return-放在同一行"><a href="#元素跟-return-放在同一行" class="headerlink" title="元素跟 return 放在同一行"></a>元素跟 <code>return</code> 放在同一行</h5><p>为了节约空间，采用下面的写法：</p><pre><code>return &lt;div&gt;    ...&lt;/div&gt;;</code></pre><p>而不是：</p><pre><code>return (      // &quot;div&quot; 与 &quot;return&quot; 不在同一行    &lt;div&gt;        ...    &lt;/div&gt;);</code></pre><h5 id="对HTML的属性进行对齐和排序"><a href="#对HTML的属性进行对齐和排序" class="headerlink" title="对HTML的属性进行对齐和排序"></a>对HTML的属性进行对齐和排序</h5><p>如果属性不是太多，那就放在同一行，否则就把每一个属性都单独写一行：</p><pre><code>&lt;div className=&quot;highlight&quot; key=&quot;highlight-div&quot;&gt;&lt;div    className=&quot;highlight&quot;    key=&quot;highlight-div&quot;&gt;&lt;Image    className=&quot;highlight&quot;    key=&quot;highlight-div&quot;/&gt;</code></pre><p>而不是：</p><pre><code>&lt;div className=&quot;highlight&quot;      // 属性没有在单独行     key=&quot;highlight-div&quot;&gt;&lt;div                            // 闭合便签不在单独的行    className=&quot;highlight&quot;    key=&quot;highlight-div&quot;&gt;&lt;div                            // 属性没有排序（一般重要的属性写在前面）    key=&quot;highlight-div&quot;    className=&quot;highlight&quot;&gt;```##### 一个文件只导出一个 react 类每一个 `.jsx` 应该只能导出单独的 `react 类`。这样有利于测试，因为这些测试框架要求一个文件导出的就是一个函数。 *注意：你依然可以在一个文件中定义多个类，只要保证导出的只有一个即可。*### 语言特色##### 确保“呈现型”的组件功能单一把 `react 组件` 分为“逻辑型组件”和“呈现型组件” 是很有必要的。前者包含的是业务逻辑，里面不应该包含HTML；后者一般是可复用的，可以包含HTML。前者可以拥有自己的内部的 `state`，而后者不应该拥有。##### 多用 props如果能用 `props` 就不要用 `state`，这一定程度上可以减少应用程序的复杂度。 一般的模式是：创建一个“无状态”的组件（呈现型组件），只负责呈现数据，把包含 `state` 的“逻辑型组件”做为这些组件的父级组件。 然后把它内部的 `state` 作为 `props`传递给下面的呈现型组件。这些逻辑型组件包含了所有的交互逻辑。##### 使用 propTypes`react 组件` 都应该完成 `propTypes` 验证。每一个 `this.props` 的属性都应该有一个与之对应的 `propTypes`。 避免使用这些没有描述意义的 prop-types:- React.PropTypes.any- React.PropTypes.array- React.PropTypes.object最好使用：- React.PropTypes.arrayOf- React.PropTypes.objectOf- React.PropTypes.instanceOf- React.PropTypes.shape##### 永远不要在DOM中保存 state不要通过 `data-` 属性或class类。所有的信息应该都存储在javascript中，或者在React组件中，或者在React store 中，如果使用了类似 `Redux` 这样的框架的话。### React 库和组件##### 不要使用 backbone 模型直接使用 flux action，或者 `$.ajax` 来代替。##### 尽量少用 jQuery 就少用永远也不要用jquery去操作DOM。 尝试避免jquery插件的使用。有必要的话，把jquery插件包装在React组件中。 你可以使用 `$.ajax`（但是不要用其他方法，像 `$.post`） 来进行网络通信。##### 复用组件你可以从[react-components.com](http://react-components.com/)获取第三方React组件。</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sock5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android大幅度提高Wifi速度以及降低耗电量</title>
      <link href="/wifi-ini-low-signal-speed.html"/>
      <url>/wifi-ini-low-signal-speed.html</url>
      
        <content type="html"><![CDATA[<h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>修改<code>system/etc/wifi changmod it to 644</code>相关配置属性提高Wifi性能</p><h3 id="源码-以下配置文件来自CPU高通骁龙820-OnePlus-3"><a href="#源码-以下配置文件来自CPU高通骁龙820-OnePlus-3" class="headerlink" title="源码 以下配置文件来自CPU高通骁龙820(OnePlus 3)"></a>源码 以下配置文件来自CPU高通骁龙820(OnePlus 3)</h3><pre><code># This file allows user to override the factory# defaults for the WLAN Driver#ruanbanmao add for opitmize the time of open wifi by qualcomm patch, 2015-05-06, begin# ifdef VENDOR_EDITgInitialScanNoDFSChnl=1gInitialDwellTime=20# endif#ruanbanmao add for opitmize the time of open wifi, 2015-05-06, end# Liyu.tan, 2015.11.4, limit softap max peers to 18# ifdef VENDOR_EDITgSoftApMaxPeers=18# endif /* VENDOR_EDIT */# Enable IMPS or notgEnableImps=1# Enable/Disable Idle ScangEnableIdleScan=1# Increase sleep duration (seconds) during IMPS# 0 implies no periodic wake up from IMPS. Periodic wakeup is# unnecessary if Idle Scan is disabled.gImpsModSleepTime=0# Enable BMPS or notgEnableBmps=1# Enable suspend or not# 1: Enable standby, 2: Enable Deep sleep, 3: Enable Mcast/Bcast FiltergEnableSuspend=3# Phy Mode (auto, b, g, n, etc)# Valid values are 0-9, with 0 = Auto, 4 = 11n, 9 = 11ac# 1 = 11abg, 2 = 11b, 3 = 11g, 5 = 11g only, 6 = 11n only# 7 = 11b only 8 = 11ac only.gDot11Mode=0# CSR Roaming Enable(1) Disable(0)gRoamingTime=0# Assigned MAC Addresses - This will be used until NV items are in place# Each byte of MAC address is represented in Hex format as XXIntf0MacAddress=000AF58989FFIntf1MacAddress=000AF58989FEIntf2MacAddress=000AF58989FDIntf3MacAddress=000AF58989FC# UAPSD service interval for VO,VI, BE, BK trafficInfraUapsdVoSrvIntv=0InfraUapsdViSrvIntv=0InfraUapsdBeSrvIntv=0InfraUapsdBkSrvIntv=0# Flag to allow STA send AddTspec even when ACM is OffgAddTSWhenACMIsOff=1# Make 1x1 the default antenna configurationgNumRxAnt=1# Beacon filtering frequency (unit in beacon intervals)gNthBeaconFilter=50# Enable WAPI or notWAPIIsEnabled=1# Flags to filter Mcast abd Bcast RX packets.# Value 0: No filtering, 1: Filter all Multicast.# 2: Filter all Broadcast. 3: Filter all Mcast abd BcastMcastBcastFilter=3#Flag to enable HostARPOffload feature or nothostArpOffload=1#Flag to enable TCPChkSumOffld feature or notgEnableTCPChkSumOffld=0#Flag to enable HostNSOffload feature or nothostNSOffload=1#Flag to enable IPChkSumOffld feature or notgEnableIPChecksumOffload=0#SoftAP Related Parameters# AP MAc addrgAPMacAddr=000AF589dcab# 802.11n Protection flaggEnableApProt=1#Enable OBSS protectiongEnableApOBSSProt=1#Enable/Disable UAPSD for SoftAPgEnableApUapsd=1# Fixed RategFixedRate=0# Maximum Tx powergTxPowerCap=30# Fragmentation Threshold# gFragmentationThreshold=2346# Liyu.tan, 2015.11.16, reduce wifi disconnect# ifdef VENDOR_EDITgTcpDelAckThresholdHigh=10000gRoamBmissFirstBcnt=30gRoamBmissFinalBcnt=30RTSThreshold=2437#else# RTS threshold#RTSThreshold=1048576# endif /* VENDOR_EDIT */# Intra-BSS forwardgDisableIntraBssFwd=0# WMM Enable/DisableWmmIsEnabled=0# 802.11d supportg11dSupportEnabled=1# 802.11h supportg11hSupportEnabled=1# DFS Master CapabilitygEnableDFSMasterCap=1# ESE Support and fast transitionEseEnabled=1ImplicitQosIsEnabled=0gNeighborScanTimerPeriod=200gNeighborLookupThreshold=76gNeighborReassocThreshold=81gNeighborScanChannelMinTime=20gNeighborScanChannelMaxTime=30gMaxNeighborReqTries=3# Legacy (non-ESE, non-802.11r) Fast Roaming Support# To enable, set FastRoamEnabled=1# To disable, set FastRoamEnabled=0FastRoamEnabled=1#Check if the AP to which we are roaming is better than current AP in terms of RSSI.#Checking is disabled if set to Zero.Otherwise it will use this value as to how better#the RSSI of the new/roamable AP should be for roaming#ifdef VENDOR_EDITRoamRssiDiff=5#else#RoamRssiDiff=3#endif# If the RSSI of any available candidate is better than currently associated# AP by at least gImmediateRoamRssiDiff, then being to roam immediately (without# registering for reassoc threshold).# NOTE: Value of 0 means that we would register for reassoc threshold.gImmediateRoamRssiDiff=10# To enable, set gRoamIntraBand=1 (Roaming within band)# To disable, set gRoamIntraBand=0 (Roaming across band)gRoamIntraBand=0# SAP Country code# Default Country Code is 2 bytes, 3rd byte is optional indoor or out door.# Example#   US Indoor, USI#   Korea Outdoor, KRO#   Japan without optional byte, JP#   France without optional byte, FR#gAPCntryCode=USI#Short Guard Interval Enable/disablegShortGI20Mhz=1gShortGI40Mhz=1#Auto Shutdown  Value in seconds. A value of 0 means Auto shutoff is disabledgAPAutoShutOff=0#Auto Shutdown wlan : Value in Seconds. 0 means disabled. Max 1 day = 86400 secgWlanAutoShutdown = 0# SAP auto channel selection configuration# 0 = disable auto channel selection# 1 = enable auto channel selection, channel provided by supplicant will be ignoredgApAutoChannelSelection=0# Listen Energy Detect Mode Configuration# Valid values 0-128# 128 means disable Energy Detect feature# 0-9 are threshold code and 7 is recommended value from system if feature is to be enabled.# 10-128 are reserved.# The EDET threshold mapping is as follows in 3dB step:# 0 = -60 dBm# 1 = -63 dBm# 2 = -66 dBm# ...# 7 = -81 dBm# 8 = -84 dBm# 9 = -87 dBm# Note: Any of these settings are valid. Setting 0 would yield the highest power saving (in a noisy environment) at the cost of more range. The range impact is approximately #calculated as:##  Range Loss  (dB)  =  EDET threshold level (dBm) + 97 dBm.#gEnablePhyAgcListenMode=128#Preferred band (both or 2.4 only or 5 only)BandCapability=0#Beacon Early Termination (1 = enable the BET feature, 0 = disable)enableBeaconEarlyTermination=0beaconEarlyTerminationWakeInterval=3#SOFTAP Channel Range selectiongAPChannelSelectStartChannel=1gAPChannelSelectEndChannel=11#SOFTAP Channel Range selection Operating band# 0:2.4GHZ 1: LOW-5GHZ 2:MID-5GHZ 3:HIGH-5GHZ 4: 4.9HZ BANDgAPChannelSelectOperatingBand=0#Channel BondinggChannelBondingMode5GHz=1gChannelBondingMode24GHz=1#Enable Keep alive with non-zero period valuegStaKeepAlivePeriod = 30#Say gGoKeepAlivePeriod(5 seconds) and gGoLinkMonitorPeriod(10 seconds).#For every 10 seconds DUT send Qos Null frame(i.e., Keep Alive frame if link is idle for last 10 seconds.)#For both active and power save clients.#Power save clients: DUT set TIM bit from 10th second onwards and till client honors TIM bit.#If doesn&apos;t honor for 5 seconds then DUT remove client.#Active clients: DUT send Qos Null frame for 10th seconds onwards if it is not success still we try on#11th second if not tries on 12th and so on till 15th second. Hence before disconnection DUT will send 5 NULL frames.#Hence in any case DUT will detect client got removed in (10+5) seconds. i.e., (gGoKeepAlivePeriod + gGoLinkMonitorPeriod)..#gGoLinkMonitorPeriod/ gApLinkMonitorPeriod is period where link is idle and it is period#where we send NULL frame.#gApLinkMonitorPeriod = 10#gGoLinkMonitorPeriod = 10#gGoKeepAlivePeriod/gApKeepAlivePeriod is time to spend to check whether frame are succeed to send or not.#Hence total effective detection time is gGoLinkMonitorPeriod+ gGoKeepAlivePeriod/gApLinkMonitorPeriod+ gApKeepAlivePeriod.gGoKeepAlivePeriod = 20gApKeepAlivePeriod = 20#If set will start with active scan after driver load, otherwise will start with#passive scan to find out the domaingEnableBypass11d=1#If set to 0, will not scan DFS channelsgEnableDFSChnlScan=1gVhtChannelWidth=2gEnableLogp=1# Enable Automatic Tx Power controlgEnableAutomaticTxPowerControl=1# 0 for OLPC 1 for CLPC and SCPCgEnableCloseLoop=1#Data Inactivity Timeout when in powersave (in ms)gDataInactivityTimeout=200# VHT Tx/Rx MCS values# Valid values are 0,1,2. If commented out, the default value is 0.# 0=MCS0-7, 1=MCS0-8, 2=MCS0-9gVhtRxMCS=2gVhtTxMCS=2# VHT Tx/Rx MCS values for 2x2# Valid values are 0,1,2. If commented out, the default value is 0.# 0=MCS0-7, 1=MCS0-8, 2=MCS0-9gEnable2x2=1gVhtRxMCS2x2=2gVhtTxMCS2x2=2# Enable Tx beamforminggTxBFEnable=1# Enable Tx beamforming in VHT20MHz# Valid values are 0,1. If commented out, the default value is 0.# 0=disable, 1=enablegEnableTxBFin20MHz=1# Set txchainmask and rxchainmask# These parameters are used only if gEnable2x2 is 0# Valid values are 1,2# Set gSetTxChainmask1x1=1 or gSetRxChainmask1x1=1 to select chain0.# Set gSetTxChainmask1x1=2 or gSetRxChainmask1x1=2 to select chain1.gSetTxChainmask1x1=1gSetRxChainmask1x1=1# Enable CRDA regulatory support by settings default country code#gCrdaDefaultCountryCode=TW# Scan Timing Parameters# gPassiveMaxChannelTime=110# gPassiveMinChannelTime=60gActiveMaxChannelTime=40gActiveMinChannelTime=20#If set to 0, MCC is not allowed.gEnableMCCMode=1# MCC to SCC Switch mode: 0-Disable 1-Enable 2-Force SCC if same bandgWlanMccToSccSwitchMode = 0# 1=enable STBC; 0=disable STBCgEnableRXSTBC=1# 1=enable tx STBC; 0=disablegEnableTXSTBC=1# 1=enable rx LDPC; 0=disablegEnableRXLDPC=1# Enable Active mode offloadgEnableActiveModeOffload=1#Enable Scan Results Aging based on timer#Timer value is in seconds#If Set to 0 it will not enable the featuregScanAgingTime=0#Enable Scan Results Aging based on number of scans# ifdef VENDOR_EDIT# default value is 3#gScanResultAgeCount=1# endif#Enable Power saving mechanism Based on Android Framework#If set to 0 Driver internally control the Power saving mechanism#If set to 1 Android Framwrok control the Power saving mechanismisAndroidPsEn=0#Enable thermal mitigationgThermalMitigationEnable=0gEnableFastRoamInConcurrency=1#List of Country codes for which 11ac needs to be disabled#Each country code must be delimited by comma(,)gListOfNon11acCountryCode=RU,UA,ZA#Maxium Channel time in msecgMaxMediumTime = 6000# 802.11K supportgRrmEnable=1gRrmOperChanMax=8gRrmNonOperChanMax=8gRrmRandIntvl=100#Scan offloadgEnableDirectedScanOffload=1#FlexConnect Power Factor#Default is set to 0 (disable)gFlexConnectPowerFactor=0#Disable split scan, the FW will take care of itgNumChanCombinedConc=60#Enable Power Save offload#ifdef VENDOR_EDIT#Disable qpower feature which may cause tcp reset during downloadinggEnablePowerSaveOffload=1#else#gEnablePowerSaveOffload=2# endif#Enable firmware uart printgEnablefwprint=0#Enable firmware loggEnablefwlog=1#IPA configgIPAEnable=0x00gIPADescSize=800gIPAPreFilterEnable=1gIPARMEnable=1gIPAIPv6Enable=1#P2P Listen offloadgEnableP2pListenOffload=1# Maximum Receive AMPDU size (VHT only. Valid values: 0-&gt;8k 1-&gt;16k 2-&gt;32k 3-&gt;64k 4-&gt;128k)gVhtAmpduLenExponent=7# Maximum MPDU length (VHT only. Valid values: 0-&gt;3895 octets, 1-&gt;7991 octets, 2-&gt;11454 octets)gVhtMpduLen=2# Maximum number of wow filters required#gMaxWoWFilters=22# WOW Enable/Disable.# 0 - Disable both magic pattern match and pattern byte match.# 1 - Enable magic pattern match on all interfaces.# 2 - Enable pattern byte match on all interfaces.# 3 - Enable both magic patter and pattern byte match on all interfaces.# Default value of gEnableWoW is 3.# gEnableWoW=0# Enable or Disable MCC Adaptive Scheduler at the FW# 1=Enable (default), 0=DisablegEnableMCCAdaptiveScheduler=1#Enable or Disable p2p device address administeredisP2pDeviceAddrAdministrated=0#Enable Rx threadgEnableRxThread=1# Set Thermal Power limitTxPower2g=10TxPower5g=10# Remove Overlap channel restrictiongEnableOverLapCh=0#Enable VHT on 2.4GhzgEnableVhtFor24GHzBand=1#Enable or Disable 5G early beacon terminationgEnable5gEBT=1#Maximum number of offload peers supported# gMaxOffloadPeers=2# controlling the following offload patterns# through ini parameter. Default value is 1# to disable set it to zero. ssdp = 0# Setup multicast pattern for mDNS 224.0.0.251,# SSDP 239.255.255.250 and LLMNR 224.0.0.252ssdp = 0# ifndef VENDOR_EDIT# //hieu@oneplus.net, Rename ini gEnableHystereticMode to gEnableMemDeepSleep#Enable Hysteretic mode# //gEnableHystereticMode=1#else#Enable Memory Deep SleepgEnableMemDeepSleep=1#endif VENDOR_EDIT#Disable packet log featuregEnablePacketLog=0# Bus bandwidth threshold values in terms of number of packetsgBusBandwidthHighThreshold=40000gBusBandwidthMediumThreshold=10000gBusBandwidthLowThreshold=3000# Bus bandwidth compute timeout value in msgBusBandwidthComputeInterval=2000# Regulatory Setting; 0=STRICT; 1=CUSTOMgRegulatoryChangeCountry=1# Maximum number of concurrent connectionsgMaxConcurrentActiveSessions=2# Radar PRI multipliergDFSradarMappingPriMultiplier=4gPNOScanSupport=1# Enable/Disable RX full reorder offloadgReorderOffloadSupported=1# userspace country code setting shld take prioritygCountryCodePriority=1#Enable/Disable LPASS support# 0 to disable, 1 to enablegEnableLpassSupport=0# Enable(1)/Disable(0) SIFS burstgEnableSifsBurst=1# Enable or Disable Multi-user MIMO# 1=Enable (default), 0=DisablegEnableMuBformee=1# Enable/Disable channel avoidance for SAP in SCC scenario# 0 - disable# 1 - enablegSapSccChanAvoidance=0# RA filtering rate limit param, the current value would not# help if the lifetime in RA is less than 3*60=3min. Then# we need to change it, though it is uncommon.# gRAFilterEnable=0gRArateLimitInterval=60# Inactivity time (in ms) to end TX Service Period while in IBSS power save modegIbssTxSpEndInactivityTime=10# Enable support for TDLS#  0 - disable#  1 - enablegEnableTDLSSupport=1# Enable support for Implicit Trigger of TDLS. That is, wlan driver shall# initiate TDLS Discovery towards a peer whenever setup criteria (throughput# and RSSI) is met and then will initiate teardown when teardown criteria# (idle packet count and RSSI) is met.#  0 - disable#  1 - enablegEnableTDLSImplicitTrigger=1# Enable TDLS External Control. That is, user space application has to# first configure a peer MAC in wlan driver towards which TDLS is desired.# Device will establish TDLS only towards those configured peers whenever# TDLS criteria (throughput and RSSI threshold) is met and teardown TDLS# when teardown criteria (idle packet count and RSSI) is met. However,# device will accept TDLS connection if it is initiated from any other peer,# even if that peer is not configured.#  0 - disable#  1 - enable# For TDLS External Control, Implicit Trigger must also be enabled.gTDLSExternalControl=1# Enable support for TDLS off-channel operation#  0 - disable#  1 - enable# TDLS off-channel operation will be invoked when there is only one# TDLS connection.gEnableTDLSOffChannel=1# Enable/Disable Roaming Offload Support (a.k.a Key Management Offload)# 0 to disable, 1 to enablegRoamOffloadEnabled=0gEnableSelfRecovery=1# ifdef VENDOR_EDIT# //hieu@oneplus.net, ini support for FW hash check for secure firmware Feature# Enable to check FW hash if secure FW feature is enabled. It&apos;s for defconfig# builds only since it will be ignored in performance/release builds.gEnableFWHashCheck=1# endif VENDOR_EDITEND# Note: Configuration parser would not read anything past the END marker</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Pjax全站支持语法高亮笔记</title>
      <link href="/pajx-website-syntax-highlighting.html"/>
      <url>/pajx-website-syntax-highlighting.html</url>
      
        <content type="html"><![CDATA[<h3 id="实现语法高亮"><a href="#实现语法高亮" class="headerlink" title="实现语法高亮"></a>实现语法高亮</h3><p>个人极力推荐<a href="http://prismjs.com/" target="_blank" rel="noopener">Prism.JS</a>，轻量级且支持语法很多，也很方便。</p><p>首先在官方download选择自己所需要的语法文件，下载prism.js和prism.css</p><p>打开主题的function.php插入下面的代码：</p><pre><code>function add_prism() {        wp_register_style(            &apos;prismCSS&apos;,             get_stylesheet_directory_uri() . &apos;/prism.css&apos; //自定义路径         );          wp_register_script(            &apos;prismJS&apos;,            get_stylesheet_directory_uri() . &apos;/prism.js&apos;   //自定义路径         );        wp_enqueue_style(&apos;prismCSS&apos;);        wp_enqueue_script(&apos;prismJS&apos;);    }add_action(&apos;wp_enqueue_scripts&apos;, &apos;add_prism&apos;);</code></pre><p>就这样OK。在文章高亮代码编辑如下：</p><pre><code>&lt;pre class=&quot;language-php&quot;&gt;  code_here &lt;/pre&gt;</code></pre><h3 id="对无刷新-pjax的支持"><a href="#对无刷新-pjax的支持" class="headerlink" title="对无刷新 pjax的支持"></a>对无刷新 pjax的支持</h3><p><a href="http://schier.co/blog/2013/01/07/how-to-re-run-prismjs-on-ajax-content.html" target="_blank" rel="noopener">解决方案</a></p><p>只需要在Ajax请求完成时执行highlightAll()函数，可在下面两种方法中选任意一种；</p><blockquote><p>方法一：</p></blockquote><pre><code>// Rerun Prism syntax highlighting on the current pagePrism.highlightAll();</code></pre><p>由于第一种方法Prism.js需要重新查找新增的DOM节点内容，资源占用相对要高，所以你也可以用第二种方法：</p><blockquote><p>方法二：</p></blockquote><pre><code>// Say you have a code block like this/**&lt;pre&gt;&lt;code class=&quot;language-javascript line-numbers&quot; id=&quot;some-code&quot;&gt;      // This is some random code      var foo = &quot;bar&quot;   &lt;/pre&gt;**/// Be sure to select the inner and not the// Using plain Javascriptvar block = document.getElementById(&apos;some-code&apos;)Prism.highlightElement(block);// Using JQueryPrism.highlightElement($(&apos;#some-code&apos;)[0]);</code></pre><p>像Pjax WordPress主题可以在footer添加:</p><pre><code>&lt;script data-no-instant&gt;    InstantClick.on(&apos;change&apos;, function(isInitialLoad) {      if (isInitialLoad === false) {          // support Prism        if (typeof Prism !== &apos;undefined&apos;) Prism.highlightAll();      }    });    InstantClick.init(&apos;mousedown&apos;);&lt;/script&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WordPress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>10道Java线程面试题</title>
      <link href="/ten-interview-questions-java-threads.html"/>
      <url>/ten-interview-questions-java-threads.html</url>
      
        <content type="html"><![CDATA[<h3 id="▎1-什么是线程？"><a href="#▎1-什么是线程？" class="headerlink" title="▎1.什么是线程？"></a>▎1.什么是线程？</h3><p>线程是操作系统能够进行运算调度的最小单位，它被包含在进程之中，是进程中的实际运作单位。程序员可以通过它进行多处理器编程，你可以使用多线程对运算密集型任务提速。 比如，如果一个线程完成一个任务要100毫秒，那么用十个线程完成改任务只需10毫秒。Java在语言层面对多线程提供了卓越的支持，它也是一个很好的卖点。</p><h3 id="▎2-线程和进程有什么区别？"><a href="#▎2-线程和进程有什么区别？" class="headerlink" title="▎2.线程和进程有什么区别？"></a>▎2.线程和进程有什么区别？</h3><p>线程是进程的子集，一个进程可以有很多线程，每条线程并行执行不同的任务。 不同的进程使用不同的内存空间，而所有的线程共享一片相同的内存空间。 别把它和栈内存搞混，每个线程都拥有单独的栈内存用来存储本地数据。</p><h3 id="▎3-如何在Java中实现线程？"><a href="#▎3-如何在Java中实现线程？" class="headerlink" title="▎3.如何在Java中实现线程？"></a>▎3.如何在Java中实现线程？</h3><p>在语言层面有两种方式。 java.lang.Thread 类的实例就是一个线程，但是它需要调用java.lang.Runnable接口来执行，由于线程类本身就是调用的Runnable接口所以你可以继承java.lang.Thread 类或者直接调用Runnable接口来重写run()方法实现线程。</p><h3 id="▎4-用Runnable还是Thread？"><a href="#▎4-用Runnable还是Thread？" class="headerlink" title="▎4.用Runnable还是Thread？"></a>▎4.用Runnable还是Thread？</h3><p>这个问题是上题的后续，大家都知道我们可以通过继承Thread类或者调用Runnable接口来实现线程，问题是，那个方法更好呢？什么情况下使用它？ 这个问题很容易回答，如果你知道Java不支持类的多重继承，但允许你调用多个接口。 所以如果你要继承其他类，当然是调用Runnable接口好了。</p><h3 id="▎5-什么是线程安全？Vector是一个线程安全类吗？"><a href="#▎5-什么是线程安全？Vector是一个线程安全类吗？" class="headerlink" title="▎5.什么是线程安全？Vector是一个线程安全类吗？"></a>▎5.什么是线程安全？Vector是一个线程安全类吗？</h3><p>如果你的代码所在的进程中有多个线程在同时运行，而这些线程可能会同时运行这段代码。 如果每次运行结果和单线程运行的结果是一样的，而且其他的变量的值也和预期的是一样的，就是线程安全的。 一个线程安全的计数器类的同一个实例对象在被多个线程使用的情况下也不会出现计算失误。很显然你可以将集合类分成两组，线程安全和非线程安全的。 Vector 是用同步方法来实现线程安全的, 而和它相似的ArrayList不是线程安全的。</p><h3 id="▎6-Thread-类中的start-和-run-方法有什么区别？"><a href="#▎6-Thread-类中的start-和-run-方法有什么区别？" class="headerlink" title="▎6.Thread 类中的start() 和 run() 方法有什么区别？"></a>▎6.Thread 类中的start() 和 run() 方法有什么区别？</h3><p>这个问题经常被问到，但还是能从此区分出面试者对Java线程模型的理解程度。 start()方法被用来启动新创建的线程，而且start()内部调用了run()方法，这和直接调用run()方法的效果不一样。 当你调用run()方法的时候，只会是在原来的线程中调用，没有新的线程启动，start()方法才会启动新线程。</p><h3 id="▎7-Java中Runnable和Callable有什么不同？"><a href="#▎7-Java中Runnable和Callable有什么不同？" class="headerlink" title="▎7. Java中Runnable和Callable有什么不同？"></a>▎7. Java中Runnable和Callable有什么不同？</h3><p>Runnable和Callable都代表那些要在不同的线程中执行的任务。Runnable从JDK1.0开始就有了，Callable是在JDK1.5增加的。 它们的主要区别是Callable的 call() 方法可以返回值和抛出异常，而Runnable的run()方法没有这些功能。 Callable可以返回装载有计算结果的Future对象。</p><h3 id="▎8-Java中CyclicBarrier-和-CountDownLatch有什么不同？"><a href="#▎8-Java中CyclicBarrier-和-CountDownLatch有什么不同？" class="headerlink" title="▎8. Java中CyclicBarrier 和 CountDownLatch有什么不同？"></a>▎8. Java中CyclicBarrier 和 CountDownLatch有什么不同？</h3><p>CyclicBarrier 和 CountDownLatch 都可以用来让一组线程等待其它线程。与 CyclicBarrier 不同的是，CountdownLatch 不能重新使用。</p><h3 id="▎9-Java内存模型是什么？"><a href="#▎9-Java内存模型是什么？" class="headerlink" title="▎9. Java内存模型是什么？"></a>▎9. Java内存模型是什么？</h3><p>Java内存模型规定和指引Java程序在不同的内存架构、CPU和操作系统间有确定性地行为。它在多线程的情况下尤其重要。 Java内存模型对一个线程所做的变动能被其它线程可见提供了保证，它们之间是先行发生关系。 这个关系定义了一些规则让程序员在并发编程时思路更清晰。</p><h3 id="▎10-Java中的volatile-变量是什么？"><a href="#▎10-Java中的volatile-变量是什么？" class="headerlink" title="▎10. Java中的volatile 变量是什么？"></a>▎10. Java中的volatile 变量是什么？</h3><p>volatile是一个特殊的修饰符，只有成员变量才能使用它。 在Java并发程序缺少同步类的情况下，多线程对成员变量的操作对其它线程是透明的。 volatile变量可以保证下一个读取操作会在前一个写操作之后发生，就是上一题的volatile变量规则。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> 面试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSS两端对齐的方式</title>
      <link href="/css-justified-way.html"/>
      <url>/css-justified-way.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>使用<code>justify-content: space-between box-pack</code>是css3的新属性，依赖于<code>display:box</code>(旧版弹性布局)。</p><p>受box-orient影响，box-pack决定了子标签水平对齐的方式，可选值有<code>start | end | center | justify</code>。</p><p>使用<code>box-pack:justify</code>来实现两端对齐非常简单，代码量也少。</p><p>为了向前看齐，把display:flex(新版弹性布局)也一起写进去~</p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>如果是做基于webkit内核的webapp开发和winphone IE10及以上，那么一切都好办。</p><pre><code>&lt;style type=&quot;text/css&quot;&gt;*{margin:0;padding:0;}/*说明： display:box定义布局为盒模型后，可使用盒模型下的box-pack:justify属性：*/.demo{    display:-webkit-box;    display:-webkit-flex;    display:-ms-flexbox;    display:flex;    -webkit-box-pack:justify;    -webkit-justify-content:space-between;    -ms-flex-pack:justify;    justify-content:space-between;}.demo a{     width:20%;     display:block;     height:44px;     line-height:44px;     text-align:center;     border:1px solid #428cc8;     color:#666;     font-size:16px;     margin-bottom:5px;     border-radius:3px;     background-color:#fefefe;     background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#fefefe),color-stop(1,#eee));     color:#666;     text-decoration:none;}&lt;/style&gt;&lt;div class=&quot;demo&quot;&gt;    &lt;a class=&quot;link&quot; href=&quot;#none&quot;&gt;10元&lt;/a&gt;    &lt;a class=&quot;link&quot; href=&quot;#none&quot;&gt;20元&lt;/a&gt;    &lt;a class=&quot;link&quot; href=&quot;#none&quot;&gt;30元&lt;/a&gt;    &lt;a class=&quot;link&quot; href=&quot;#none&quot;&gt;50元&lt;/a&gt;&lt;/div&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>关于HTML的一些知识点汇总-1</title>
      <link href="/some-knowledge-about-html-summary-1.html"/>
      <url>/some-knowledge-about-html-summary-1.html</url>
      
        <content type="html"><![CDATA[<h3 id="html页面结构"><a href="#html页面结构" class="headerlink" title="html页面结构"></a>html页面结构</h3><ol><li>结构层：负责语义表达，解决页面内容是什么问题</li><li>表示层：由css负责创建，解决页面如何显示内容</li><li>行为层：由脚本负责（js），解决页面上内容应该如何对事件做出反应</li></ol><h3 id="主流浏览器内核"><a href="#主流浏览器内核" class="headerlink" title="主流浏览器内核"></a>主流浏览器内核</h3><ol><li>IE： Trident内核</li><li>Mozilla FireFox: Gecko内核</li><li>Chrome,Safari:Webkit内核</li><li>Opera:Presto内核</li></ol><h3 id="浏览器兼容性有哪些"><a href="#浏览器兼容性有哪些" class="headerlink" title="浏览器兼容性有哪些"></a>浏览器兼容性有哪些</h3><ol><li>浏览器默认的margin和padding不同，加全局<code>*{margin：0；padding：0}</code>来统一</li><li>IE6双边剧BUG：块属性标签float后，有有横的margin情况下，在ie6显示margin比设置的大；可以加上<code>display：inline；</code></li><li>在IE6，ie7元素高度超出自己设置高度，是IE8以前的浏览器会给元素设置默认的行高导致的。解决可以加上 <code>overflow：hidden</code> 或者是<code>line-height：；font-size：；</code></li><li><code>min-height：</code>在IE6下不起作用。解决方案是<code>height：auto；！important;height:xxpx;</code>其中xx就是min-height设置的值</li><li>透明性IE用<code>filter：Alpha（opacity=60）</code>，而其他主流浏览器用<code>opacity：0.6</code>；</li><li>a(有href属性)标签嵌套下的img标签，在IE会带有边框；解决<code>a img{border：none；}</code>样式。</li><li>input边框问题。去掉input边框一般用<code>border：none</code>就可以</li><li>父子标签间用margin的问题，表现在有时除IE外的浏览器子标签margin转移到了父标签上，IE下没转移。建议父子标签间的间隔用padding，兄弟标签间用margin。</li></ol><h3 id="盒子模型"><a href="#盒子模型" class="headerlink" title="盒子模型"></a>盒子模型</h3><p>css网页设计中的每个元素都是长方形的盒子。</p><p>width（offsetWidth）：width+padding+border</p><p>height（offsetHeight）：height+padding+border</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>WordPress深度集成Markdown</title>
      <link href="/wordpress-using-markdown.html"/>
      <url>/wordpress-using-markdown.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>WordPress集成后的功能如下：</p><ol><li>实时预览 即见即所得，甚至你可以作为一个专门的 markdown 编辑器来使用</li><li>代码高亮 程序员最爱，需要在前台做代码高亮</li><li>代码分离 markdown 的代码和 html 代码分离，互不影响，并且会将 markdown 代码保存下来，以便下次继续编辑。</li></ol><p>效果：</p><p><img src="http://source.scaperow.com/wp-content/uploads/2015/12/markdown.gif" alt></p><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>在 post 页面添加一个 textarea，监听 input 事件，事件中将文本框的内容取出，用 marked.js 进行转码，将转码后的 html 放在系统中的 tinyMCE 中。 在保存时将 textarea 中的文本存入 media data 中，下次可以继续编辑。</p><h3 id="集成"><a href="#集成" class="headerlink" title="集成"></a>集成</h3><ol><li>下载 <a href="http://source.scaperow.com/wp-content/themes/twentysixteen/js/marked.js" target="_blank" rel="noopener">marked.js</a> 和 <a href="http://source.scaperow.com/wp-content/themes/twentysixteen/js/makemarkdown.js" target="_blank" rel="noopener">makemarkdown.js</a></li><li>将 marked.js，makemarked.js 拷贝到 ~\wp-content{你的主题目录}\js\ 目录下 marked.js 是一套 js 库，用于将 markdown 代码转换成 html。makemarked.js 用于监听文本框事件，来实时调用 marked.js 来转换 markdown 代码。</li><li><p>在 function.js 中加入以下代码</p><p>// 增加 markdown 功能到后台编辑器<br>add_action( ‘admin_menu’, ‘create_markdown’ );<br>add_action( ‘save_post’, ‘save_markdown’, 10, 2 );</p><p>function create_markdown() {</p><pre><code>add_meta_box( &apos;markdown_box&apos;, &apos;Markdown&apos;, &apos;markdown_html&apos;, &apos;post&apos;, &apos;normal&apos;, &apos;high&apos; );</code></pre><p>}</p><p>function markdown_html( $object, $box ) { ?&gt;</p><pre><code>&lt;textarea name=&quot;markdown&quot; id=&quot;markdown&quot; cols=&quot;60&quot; oninput =&quot;markdownEditorChanged()&quot; rows=&quot;50&quot; style=&quot;width: 100%; height:100%&quot;&gt;&lt;?php echo htmlspecialchars (get_post_meta( $object-&gt;ID, &apos;markdown&apos;, true )); ?&gt;&lt;/textarea&gt;</code></pre><p>&lt;?php }</p><p>function save_markdown( $post_id, $post ) {</p><pre><code>if ( !current_user_can( &apos;edit_post&apos;, $post_id ) )    return $post_id;$meta_value = get_post_meta( $post_id, &apos;markdown&apos;, true );$new_meta_value = $_POST[&apos;markdown&apos;];if ( $new_meta_value &amp;&amp; &apos;&apos; == $meta_value )    add_post_meta( $post_id, &apos;markdown&apos;, $new_meta_value, true );elseif ( $new_meta_value != $meta_value )    update_post_meta( $post_id, &apos;markdown&apos;, $new_meta_value );elseif ( &apos;&apos; == $new_meta_value &amp;&amp; $meta_value )    delete_post_meta( $post_id, &apos;markdown&apos;, $meta_value );</code></pre><p>}</p></li></ol><pre><code>function markdown_script() {    wp_enqueue_script(&apos;markdown&apos;, get_template_directory_uri() . &apos;/js/marked.js&apos; );    wp_enqueue_script(&apos;makemarkdown&apos;, get_template_directory_uri() . &apos;/js/makemarkdown.js&apos;);}add_action( &apos;admin_enqueue_scripts&apos;, &apos;markdown_script&apos;);</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WordPress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux配合Sock5最佳终端代理方案</title>
      <link href="/convert-sock5-into-an-http-proxy.html"/>
      <url>/convert-sock5-into-an-http-proxy.html</url>
      
        <content type="html"><![CDATA[<p>方案一 本文参考：<a href="https://github.com/shadowsocks/shadowsocks/wiki/Convert-Shadowsocks-into-an-HTTP-proxy" target="_blank" rel="noopener">点击参考</a> 使用Polipo把socks5转换http代理：</p><pre><code>sudo apt-get install polipo</code></pre><p>安装完毕修改配置文件：</p><pre><code>sudo gedit /etc/polipo/config</code></pre><p>修改如下</p><pre><code># This file only needs to list configuration variables that deviate# from the default values.  See /usr/share/doc/polipo/examples/config.sample# and &quot;polipo -v&quot; for variables you can tweak and further information.logSyslog = falselogFile = &quot;/var/log/polipo/polipo.log&quot;socksParentProxy = &quot;127.0.0.1:1080&quot;socksProxyType = socks5chunkHighMark = 50331648objectHighMark = 16384serverMaxSlots = 64serverSlots = 16serverSlots1 = 32proxyAddress = &quot;0.0.0.0&quot;proxyPort = 8123</code></pre><p>重启服务</p><pre><code>/etc/init.d/polipo restart</code></pre><p>验证(拉取到有内容表示OK了)：</p><pre><code>export http_proxy=&quot;http://127.0.0.1:8123/&quot;curl www.google.com</code></pre><p>另外，在浏览器中输入<a href="http://127.0.0.1:8123/%E4%BE%BF%E5%8F%AF%E4%BB%A5%E8%BF%9B%E5%85%A5%E5%88%B0" target="_blank" rel="noopener">http://127.0.0.1:8123/便可以进入到</a> Polipo 的使用说明和配置界面</p><p>在代理git输入：</p><pre><code>git config --global http.proxy 127.0.0.1:8123git config --global https.proxy 127.0.0.1:8123</code></pre><p>在repo情况下则：</p><pre><code>export http_proxy=&quot;your.proxy.ip:port&quot;  export https__proxy=&quot;your.proxy.ip:port&quot;</code></pre><hr><p>方案二 使用Proxychains代理：</p><pre><code>sudo apt-get install proxychainssudo gedit /etc/proxychains.conf</code></pre><p>将socks4 127.0.0.1 9095改为</p><pre><code>socks5  127.0.0.1 1080  //1080改为你自己的端口</code></pre><p>如何使用：</p><pre><code>proxychains repo sync -j4    #在需要进行代理的程序前加proxychains</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Android逆向：一个刷机无效锁屏app逆向分析</title>
      <link href="/android-reverse-analysis-1.html"/>
      <url>/android-reverse-analysis-1.html</url>
      
        <content type="html"><![CDATA[<p>今天有个朋友给我一个有毒App，“不小心”装上去，出现如下情况：</p><p><img src="https://o49m2kysy.qnssl.com/Notes/IMG_0001.JPG" alt="锁屏"></p><p>真恶心….居然来个这玩意儿，手机数据暂时不想被删除。尝试反编译App，寻找思路。</p><p>反编译得到<code>AndroidManifest.xml</code>文件，得知服务为启动：<code>&lt;service android:name=&quot;.Floatw&quot;/&gt;</code></p><p>嗯，那就找Floatw.class源码文件，编译dex文件为jar，打开jar源码，寻找Floatw.class文件，如下：</p><pre><code>package com.dedett.qqzan;import android.app.Application;import android.app.Service;import android.content.Context;import android.content.Intent;import android.content.res.Resources;import android.os.Handler;import android.os.IBinder;import android.os.Message;import android.text.Editable;import android.view.LayoutInflater;import android.view.View;import android.view.View.MeasureSpec;import android.view.View.OnClickListener;import android.view.ViewGroup;import android.view.WindowManager;import android.view.WindowManager.LayoutParams;import android.widget.Button;import android.widget.EditText;import android.widget.LinearLayout;import android.widget.TextView;public class Floatw  extends Service{  long jv;  private LinearLayout mFloatLayout;  private Handler mHandler;  private Runnable mRunnable = new Runnable()  {    @Override    public void run()    {      Object localObject = (TextView)Floatw.access$L1000002(Floatw.this).findViewById(2131099649);      String str = Floatw.this.getResources().getString(2130968586);      ((TextView)localObject).setText(str + String.valueOf(Floatw.this.number));      localObject = (EditText)Floatw.access$L1000002(Floatw.this).findViewById(2131099650);      ((Button)Floatw.access$L1000002(Floatw.this).findViewById(2131099651)).setOnClickListener(new View.OnClickListener()      {        private final EditText val$etext;        @Override        public void onClick(View paramAnonymous2View)        {          int i = Floatw.this.my_password;          if (this.val$etext.getText().toString().equals(String.valueOf(i)))          {            paramAnonymous2View = Floatw.this;            Floatw localFloatw = Floatw.this;            try            {              Class localClass = Class.forName(&quot;com.dedett.qqzan.Floatw&quot;);              paramAnonymous2View.stopService(new Intent(localFloatw, localClass));              return;            }            catch (ClassNotFoundException paramAnonymous2View)            {              throw new NoClassDefFoundError(paramAnonymous2View.getMessage());            }          }          paramAnonymous2View = (TextView)Floatw.access$L1000002(Floatw.this).findViewById(2131099652);          paramAnonymous2View.setText(Floatw.this.getResources().getString(2130968588));          new Handler().postDelayed(new Runnable()          {            private final TextView val$false_text;            @Override            public void run()            {              this.val$false_text.setText((CharSequence)null);            }          }, &apos;?&apos;);        }      });    }  };  private WindowManager mWindowManager;  int my_password = (this.number - 3055) * 3 - 8985;  int number = (int)((Math.random() + 1) * 100000);  private WindowManager.LayoutParams wmParams;  private void createFloatView()  {    this.wmParams = new WindowManager.LayoutParams();    Application localApplication = getApplication();    getApplication();    this.mWindowManager = ((WindowManager)localApplication.getSystemService(Context.WINDOW_SERVICE));    this.wmParams.type = 2010;    this.wmParams.format = 1;    this.wmParams.flags = 1280;    this.wmParams.width = -1;    this.wmParams.height = -1;    this.mFloatLayout = ((LinearLayout)LayoutInflater.from(getApplication()).inflate(2130903041, (ViewGroup)null));    this.mWindowManager.addView(this.mFloatLayout, this.wmParams);    this.mFloatLayout.measure(View.MeasureSpec.makeMeasureSpec(0, 0), View.MeasureSpec.makeMeasureSpec(0, 0));  }  @Override  public IBinder onBind(Intent paramIntent)  {    return (IBinder)null;  }  @Override  public void onCreate()  {    super.onCreate();    createFloatView();    this.mHandler = new Handler()    {      @Override      public void handleMessage(Message paramAnonymousMessage)      {        super.handleMessage(paramAnonymousMessage);        if (paramAnonymousMessage.what == 1) {}      }    };  }  @Override  public void onDestroy()  {    this.mHandler.removeCallbacks(this.mRunnable);    if (this.mFloatLayout != null) {      this.mWindowManager.removeView(this.mFloatLayout);    }    super.onDestroy();  }  @Override  public void onStart(Intent paramIntent, int paramInt)  {    this.mHandler.postDelayed(this.mRunnable, 0);  }}</code></pre><p>从中可以看出这一段：</p><pre><code>int my_password = (this.number - 3055) * 3 - 8985;int number = (int)((Math.random() + 1) * 100000);</code></pre><p>定义一个随机数，这个随机数+1，然后在乘以100000，得到的就是那个序列号….</p><p>那解锁密码就是，(序列号-3055)*3-8985</p><p>嗯，这样….那我的密码是：508128</p><p>至于刷机，双清无效,,估计是忽悠人的，在源码没看到相关的源码。</p><p>有Roor情况下，可以用电脑adb进入data/app/删除<code>com.dedett.qqzan</code>软件即可。</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Linux下配置Gradle编译环境</title>
      <link href="/gradle-build-environment-under-linux-configuration.html"/>
      <url>/gradle-build-environment-under-linux-configuration.html</url>
      
        <content type="html"><![CDATA[<h3 id="Gradle介绍"><a href="#Gradle介绍" class="headerlink" title="Gradle介绍"></a>Gradle介绍</h3><ul><li>Gradle是一个基于JVM的构建工具，它提供了：</li><li>像Ant一样，通用灵活的构建工具</li><li>可以切换的，基于约定的构建框架</li><li>强大的多工程构建支持</li><li>基于Apache Ivy的强大的依赖管理</li><li>支持maven, Ivy仓库</li><li>支持传递性依赖管理，而不需要远程仓库或者是pom.xml和ivy.xml配置文件。</li><li>对Ant的任务做了很好的集成</li><li>基于Groovy，build脚本使用Groovy编写</li><li>有广泛的领域模型支持构建</li></ul><h3 id="配置环境"><a href="#配置环境" class="headerlink" title="配置环境"></a>配置环境</h3><ol><li>下载<a href="https://gradle.org/gradle-download/" target="_blank" rel="noopener">Gradle</a>，解压安放目录</li><li><p>设置环境变量(/home/user/.bashrc)： <code>`</code><br>export GRADLE_HOME=/home/wangjin/Gradle<br>export PATH=${GRADLE_HOME}/bin</p><ol start="3"><li>终端输入<code>gradle -v</code>是否生效</li></ol></li></ol>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Webpack 从入门到上线</title>
      <link href="/webpack-notes.html"/>
      <url>/webpack-notes.html</url>
      
        <content type="html"><![CDATA[<h2 id="webpack-是什么"><a href="#webpack-是什么" class="headerlink" title="webpack 是什么"></a>webpack 是什么</h2><p><img src="https://segmentfault.com/img/bVzLhA" alt></p><p>一项技术、一个工具的出现，肯定是为了解决问题的。那么，webpack 是为了解决什么问题？答案是：<strong>文件依赖管理</strong>。浏览器端的 Js, 出于安全的考虑，对本地文件没有操作权限，不能引用其它 js, css 等文件。而 webpack 就是用来解决这个问题的，让你的项目可以很好地分文件、分模块，而且它对外部文件的引入同时支持 cmd, amd 和 commondJs 这三种形式，够有诚意。<br>或许你要说了，解决文件依赖，早在 require.js 和 sea.js 的时候，都已经解决了呀！那么，webpack 在这方面，有哪些新的突破：</p><ol><li>支持引用各种拓展名的文件</li><li>能够在不依赖 gulp 或 grunt 的情况下直接产出打包文件</li><li>支持实时编译，浏览器同步刷新</li></ol><p>这个时候，是不是很想唱一下王力宏的《唯一》：确定你就是我的唯一！<br>OK，进入正题。</p><h2 id="安装与运行"><a href="#安装与运行" class="headerlink" title="安装与运行"></a>安装与运行</h2><p>目前，我们的项目目录结构是这样的：</p><pre><code>webpack_demo|&lt;span class=&quot;hljs-comment&quot;&gt;--src&lt;/span&gt;|  |&lt;span class=&quot;hljs-comment&quot;&gt;--pages&lt;/span&gt;|  |  |&lt;span class=&quot;hljs-comment&quot;&gt;--index&lt;/span&gt;|  |  |  |&lt;span class=&quot;hljs-comment&quot;&gt;--index.js&lt;/span&gt;|&lt;span class=&quot;hljs-comment&quot;&gt;--views_dev&lt;/span&gt;|  |&lt;span class=&quot;hljs-comment&quot;&gt;--index.html&lt;/span&gt;|&lt;span class=&quot;hljs-comment&quot;&gt;--webpack.config.js&lt;/span&gt;|&lt;span class=&quot;hljs-comment&quot;&gt;--package.json&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line">    ### 安装</span><br><span class="line">    </span><br><span class="line">    在项目的根目录执行：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">$ npm init // 生成项目依赖文件配置 package.json  </span><br><span class="line">$ npm install webpack -g // 全局安装webpack  </span><br><span class="line">$ touch webpack.config.js // 在项目根目录下，新建 webpack.config.js 文件</span><br></pre></td></tr></table></figure></code></pre><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>然后，在以下3个文件，输入内容：</p><ol><li>页面 HTML 文件 <code>// views_dev/index.html &lt;span class=&quot;hljs-doctype&quot;&gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&lt;&lt;span class=&quot;hljs-title&quot;&gt;html&lt;/span&gt;&gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&lt;&lt;span class=&quot;hljs-title&quot;&gt;head&lt;/span&gt;&gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&lt;&lt;span class=&quot;hljs-title&quot;&gt;meta&lt;/span&gt;&lt;span class=&quot;hljs-attribute&quot;&gt;charset&lt;/span&gt;=&lt;span class=&quot;hljs-value&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;&gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&lt;&lt;span class=&quot;hljs-title&quot;&gt;title&lt;/span&gt;&gt;&lt;/span&gt;首页&lt;span class=&quot;hljs-tag&quot;&gt;&lt;/&lt;span class=&quot;hljs-title&quot;&gt;title&lt;/span&gt;&gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&lt;/&lt;span class=&quot;hljs-title&quot;&gt;head&lt;/span&gt;&gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&lt;&lt;span class=&quot;hljs-title&quot;&gt;body&lt;/span&gt;&gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&lt;&lt;span class=&quot;hljs-title&quot;&gt;div&lt;/span&gt;&gt;&lt;/span&gt;哈喽，world&lt;span class=&quot;hljs-tag&quot;&gt;&lt;/&lt;span class=&quot;hljs-title&quot;&gt;div&lt;/span&gt;&gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&lt;&lt;span class=&quot;hljs-title&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;hljs-attribute&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;hljs-value&quot;&gt;&quot;../asset/dev/main.js&quot;&lt;/span&gt;&gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&lt;/&lt;span class=&quot;hljs-title&quot;&gt;script&lt;/span&gt;&gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&lt;/&lt;span class=&quot;hljs-title&quot;&gt;body&lt;/span&gt;&gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&lt;/&lt;span class=&quot;hljs-title&quot;&gt;html&lt;/span&gt;&gt;&lt;/span&gt;</code></li><li>页面引用的 js 文件 <code>// src/pages/&lt;span class=&quot;hljs-keyword&quot;&gt;index&lt;/span&gt;/&lt;span class=&quot;hljs-keyword&quot;&gt;index&lt;/span&gt;.js console.&lt;span class=&quot;hljs-keyword&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&#39;I am in index/index.js, haha4&#39;&lt;/span&gt;);</code></li><li>webpack 打包配置 <code>&lt;span class=&quot;hljs-comment&quot;&gt;// webpack.config.js&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;module&lt;/span&gt;.exports = { &lt;span class=&quot;hljs-comment&quot;&gt;// 入口：要进行处理的实例（js）&lt;/span&gt; entry: &lt;span class=&quot;hljs-string&quot;&gt;&#39;./src/pages/index/index.js&#39;&lt;/span&gt;, &lt;span class=&quot;hljs-comment&quot;&gt;// 出口：输出配置&lt;/span&gt; output: { &lt;span class=&quot;hljs-comment&quot;&gt;// 输出到哪个目录&lt;/span&gt; path: &lt;span class=&quot;hljs-string&quot;&gt;&#39;./asset/dev/&#39;&lt;/span&gt;, &lt;span class=&quot;hljs-comment&quot;&gt;// 静态资源的引用路径&lt;/span&gt; publicpath: &lt;span class=&quot;hljs-string&quot;&gt;&#39;/asset/dev/&#39;&lt;/span&gt;, &lt;span class=&quot;hljs-comment&quot;&gt;// 实例最终输出的名字&lt;/span&gt; filename: &lt;span class=&quot;hljs-string&quot;&gt;&#39;[name].js&#39;&lt;/span&gt; } };</code></li></ol><h3 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h3><p><strong>运行 webpack 命令</strong>，进行打包。</p><p><code>&lt;span class=&quot;hljs-variable&quot;&gt;$ &lt;/span&gt;webpack</code></p><p>然后，搞定了，此时在浏览器中打开 <code>views_dev/index.html</code>，你会发现，打包成功了！</p><p><img src="https://segmentfault.com/img/bVB25D" alt></p><p>好的，你入门了，哈哈！接下去，我会详细介绍单个页面打包、多个页面打包，以及最后的发布上线。Now, go ~</p><h2 id="单个页面打包"><a href="#单个页面打包" class="headerlink" title="单个页面打包"></a>单个页面打包</h2><p>这里，你将学到：</p><ol><li>引入其它 js 文件。是的，你将学会 <strong>模块化</strong>。</li><li>引入其它类型的文件，以 css 为例。</li><li>实时编译 + 浏览器同步刷新。爽！</li></ol><p>现在，我们的项目目录，是这样：</p><pre><code>webpack_demo|&lt;span class=&quot;hljs-comment&quot;&gt;--src&lt;/span&gt;|  |&lt;span class=&quot;hljs-comment&quot;&gt;--pages&lt;/span&gt;|  |  |&lt;span class=&quot;hljs-comment&quot;&gt;--index&lt;/span&gt;|  |  |  |&lt;span class=&quot;hljs-comment&quot;&gt;--index.js&lt;/span&gt;|  |  |  |&lt;span class=&quot;hljs-comment&quot;&gt;--test.js&lt;/span&gt;|  |  |  |&lt;span class=&quot;hljs-comment&quot;&gt;--index.css&lt;/span&gt;|  |&lt;span class=&quot;hljs-comment&quot;&gt;--plugins&lt;/span&gt;|  |  |&lt;span class=&quot;hljs-comment&quot;&gt;--dialog&lt;/span&gt;|  |  |  |&lt;span class=&quot;hljs-comment&quot;&gt;--dialog.css&lt;/span&gt;|  |  |  |&lt;span class=&quot;hljs-comment&quot;&gt;--dialog.js&lt;/span&gt;|&lt;span class=&quot;hljs-comment&quot;&gt;--views_dev&lt;/span&gt;|  |&lt;span class=&quot;hljs-comment&quot;&gt;--index.html&lt;/span&gt;|&lt;span class=&quot;hljs-comment&quot;&gt;--webpack.config.js&lt;/span&gt;|&lt;span class=&quot;hljs-comment&quot;&gt;--package.json&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line">    ### 引入其它 js 文件</span><br><span class="line">    </span><br><span class="line">    1. 通过相对路径  </span><br><span class="line">     现在，我们要在 `src/pages/index.js` 里面引入 `src/pages/test.js` 文件。这样做就可以了：`&lt;span class=&quot;hljs-reserved&quot;&gt;var&lt;/span&gt; Test = &lt;span class=&quot;hljs-built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;./test.js&apos;&lt;/span&gt;);`</span><br><span class="line">    </span><br><span class="line">    你也许会问，此时，`var Test` 这个变量，得到的是什么？换个说法，怎么控制 `test.js` 被导出到外部的内容。答案是：通过`module.exports`. 例如：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">// index/test.jsvar str = &quot;I am in test.js&quot;;  </span><br><span class="line">module.exports = str;</span><br></pre></td></tr></table></figure></code></pre><p>那么，<code>require(&#39;./test.js&#39;)</code> 的值就是 “I am in test.js” 这个字符串。<code>module.exports</code> 可以导出任何值。比如，我们要导出 Object.</p><pre><code>&lt;span class=&quot;hljs-built_in&quot;&gt;module&lt;/span&gt;.exports = {  aa: &lt;span class=&quot;hljs-string&quot;&gt;&apos;axxx&apos;&lt;/span&gt;,  b: &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;{}};<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2. 通过别名或模块  </span><br><span class="line"> 如果只能使用相对路径，那 `webpack` 就太不靠谱了。因为将有可能出现这样 `../../../../libs/libs-tost/toast.js`, 啊，想死！那么，怎么通过别名引入文件呢？假如，我们想引入 `src/plugins/dialog/dialog.js` 这个弹窗。- 在 `webpack.config.js` 中，配置别名</span><br></pre></td></tr></table></figure>&lt;span class=&quot;hljs-comment&quot;&gt;// webpack.config.js&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;module&lt;/span&gt;.exports = {    resolve: {        &lt;span class=&quot;hljs-comment&quot;&gt;// 定义别名&lt;/span&gt;        alias: {            plugins: &lt;span class=&quot;hljs-string&quot;&gt;&apos;D:/your/path/webpack_demo/src/plugins&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-comment&quot;&gt;// 别名可以是目录&lt;/span&gt;            myDialog: &lt;span class=&quot;hljs-string&quot;&gt;&apos;D:/your/path/webpack_demo/src/plugins/dialog/dialog.js&apos;&lt;/span&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// 也可以是文件&lt;/span&gt;        }    }}<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">    - 可以使用了 `&lt;span class=&quot;hljs-comment&quot;&gt;// src/index/index.js&lt;/span&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; Dialog = &lt;span class=&quot;hljs-built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;plugins/dialog/dialog.js&apos;&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;// 方式一&lt;/span&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; Diaglog = &lt;span class=&quot;hljs-built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;myDialog&apos;&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;// 方式二&lt;/span&gt;`</span><br><span class="line">    </span><br><span class="line">    说明：`require(TagPath)` 的 `TagPath` 如果以单词开头，将被认为是模块匹配，它会去找 `node_modules` 和`resolve.alias` 下的模块（或别名）。以方式一为例，它的`TagPath` 是以 `plugins` 开头（注意下：`/plugins` 和`./plugins` 都不叫以单词开头），所以可以顺利匹配到 `resolve.alias.plugins`. 在实际应用中，你经常会看到`require(&apos;jquery&apos;)`, `require(&apos;vue&apos;)`, `require(&apos;react&apos;)`, 这些就是匹配到 `node_modules` 下已安装的模块。</span><br><span class="line">    </span><br><span class="line">    ### 引入其它类型的文件</span><br><span class="line">    </span><br><span class="line">    `webpack` 的强大之处是，它允许你引入任何文件，比如：css, jpg, png. 那么，问题来了，对于不同的文件，它要怎么知道该如何分开处理呢？</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">// webpack.config.jsmodule.exports = &#123;  </span><br><span class="line">module: &#123;  </span><br><span class="line">loaders: \[&#123;  </span><br><span class="line">test: /.css$/,  </span><br><span class="line">loader: &apos;style!css&apos;  </span><br><span class="line">&#125;, &#123;  </span><br><span class="line">test: /.js$/,  </span><br><span class="line">loader: &apos;babel&apos;  </span><br><span class="line">&#125;\]  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></code></pre><p>上面的配置是说，对于拓展名是 <code>.css</code> 的文件，使用加载器 <code>style!css</code>（这边中间有一个感叹号，意思是：先是用 css 加载器处理，然后使用 style 加载器处理）。完整的写法是：<code>style-loader!css-loader</code>, 其中，<code>-loader</code>可以省略。而这里的，<code>style-loader</code> 和<code>css-loader</code> 就需要你 npm 安装下了。</p><pre><code>$ &lt;span class=&quot;hljs-built_in&quot;&gt;npm&lt;/span&gt; i style-loader -D$ &lt;span class=&quot;hljs-built_in&quot;&gt;npm&lt;/span&gt; i css-loader -D<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line">    对于其它拓展名的处理，也是用同样的方式来处理。</span><br><span class="line">    </span><br><span class="line">    ### 释放双手：自动编译 + 浏览器同步刷新</span><br><span class="line">    </span><br><span class="line">    你肯定希望，这样的功能。那么，开始吧，喝杯咖啡！</span><br><span class="line">    </span><br><span class="line">    1. 自动编译  </span><br><span class="line">     如果你只是想支持自动编译，那么很简单。只要运行 `$ webpack -w` 就可以开启它的自动编译功能。</span><br><span class="line">    2. 用 webpack-dev-server 实现：自动编译 + 浏览器同步刷新 - 首先，你需要安装 `webpack-dev-server` 这个包。 `$ &lt;span class=&quot;hljs-built_in&quot;&gt;npm&lt;/span&gt; i webpack-dev-server -D`</span><br><span class="line">    - 然后，我简单介绍下它：[webpack-dev-server 文档](https://webpack.github.io/docs/webpack-dev-server.html)- 运行时，它会启动一个本地 Node 服务器，默认端口8080. 即：localhost:8080. 并且自动识别当前目录下的`webpack.config.js` 文件，来作为 `webpack` 配置文件。</span><br><span class="line">    - 产出的编译后文件，不在 output.path 里，而在它自己定义的内存。</span><br><span class="line">    - 行内参数说明： - inline: 使用命令行模式。</span><br><span class="line">    - content-base: 指定网站的根地址，如果你想指定为项目根目录，那么 `--content-base ./`</span><br><span class="line">    - hot: 开启热替换。一般用在 React 和 Vue 当中，我们这里不用。</span><br><span class="line">    </span><br><span class="line">    好了，那么，启动它吧：</span><br><span class="line">    </span><br><span class="line">    `$ webpack-dev-server --inline --content-&lt;span class=&quot;hljs-keyword&quot;&gt;base&lt;/span&gt; ./`</span><br><span class="line">    </span><br><span class="line">    然后，你在浏览器中，访问 `http://localhost:8080/views_dev/index.html` 就会发现，你修改代码的时候，实时编译，并且浏览器同步刷新了。（不过，要补充一下，触发 webpack 重新编译时，才能同步刷新浏览器。意味着，你修改`views_dev/*.html` 的 HTML 文件时，浏览器，不会被刷新，因为它不会触发 webpack 重新编译。）</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    ## 多页面打包</span><br><span class="line">    </span><br><span class="line">    现在，我们加一点点配置，让它支持多个页面打包。之前，它是这样的：</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">module.exports = &#123;  </span><br><span class="line">// 入口：要进行处理的实例（js）  </span><br><span class="line">entry: &apos;./src/pages/index/index.js&apos;,  </span><br><span class="line">// 出口：输出配置  </span><br><span class="line">output: &#123;  </span><br><span class="line">// 输出到哪个目录  </span><br><span class="line">path: &apos;./asset/dev/&apos;,  </span><br><span class="line">// 静态资源的引用路径  </span><br><span class="line">publicpath: &apos;/asset/dev/&apos;,  </span><br><span class="line">// 实例最终输出的名字  </span><br><span class="line">filename: &apos;\[name\].js&apos;  </span><br><span class="line">&#125;,  </span><br><span class="line">// 其它配置...  </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></code></pre><p>现在，我们需要改下 <code>entry</code> 的配置，如下：</p><pre><code>&lt;span class=&quot;hljs-tag&quot;&gt;entry&lt;/span&gt;: &lt;span class=&quot;hljs-rules&quot;&gt;{    &lt;span class=&quot;hljs-rule&quot;&gt;&lt;span class=&quot;hljs-attribute&quot;&gt;index&lt;/span&gt;:&lt;span class=&quot;hljs-value&quot;&gt;&lt;span class=&quot;hljs-string&quot;&gt;&apos;./src/pages/index/index.js&apos;&lt;/span&gt;,    list: &lt;span class=&quot;hljs-string&quot;&gt;&apos;./src/pages/list/index.js&apos;&lt;/span&gt;,    common: [        &lt;span class=&quot;hljs-string&quot;&gt;&apos;./src/base/base.js&apos;&lt;/span&gt;,        &lt;span class=&quot;hljs-string&quot;&gt;&apos;./src/base/base.css&apos;&lt;/span&gt;    ]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;}<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">上面的配置意思是，会独立打包3个实体。分别是 index, list, common. 知识点如下：</span><br><span class="line"></span><br><span class="line">1. 它支持多个文件打包在一起，如这里的 `common` 的配置。我们一般，用来放公共基础包。</span><br><span class="line">2. 我们看到 `output.filename = [name].js`，这里的 `[name]` 取自于 entry 的 key 值。意味着，他们最终打包的输出是：</span><br></pre></td></tr></table></figure>webpack_demo|&lt;span class=&quot;hljs-comment&quot;&gt;--asset&lt;/span&gt;|  |&lt;span class=&quot;hljs-comment&quot;&gt;--dev&lt;/span&gt;|  |  |&lt;span class=&quot;hljs-comment&quot;&gt;--index.js&lt;/span&gt;|  |  |&lt;span class=&quot;hljs-comment&quot;&gt;--list.js&lt;/span&gt;|  |  |&lt;span class=&quot;hljs-comment&quot;&gt;--common.js&lt;/span&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">## 上线</span><br><span class="line"></span><br><span class="line">发布上线，需要做什么呢？也许是这样：</span><br><span class="line"></span><br><span class="line">1. 把静态资源生成到一个独立的目录下</span><br><span class="line">2. 压缩</span><br><span class="line">3. 加上 md5</span><br><span class="line">4. html 和 css 中，引用的静态资源需要替换。</span><br><span class="line"></span><br><span class="line">哈哈，或许你还能想到很多。我就上面4步来说下实现方式。开始之前，我们一般会这么做：新建一个 webpack 的配置文件，用来做上线发布的配置。比如，我们同样放在根目录下，命名 `webpack.config.build.js`. 此时，你可以这样做：</span><br><span class="line"></span><br><span class="line">`$ webpack -p &lt;span class=&quot;hljs-comment&quot;&gt;--config webpack.config.build.js&lt;/span&gt;`</span><br><span class="line"></span><br><span class="line">这里的 `-p` 是 production 模式的意思，它会对 css, js 文件进行压缩。后面 `--config` 就是指定此次运行的配置文件。</span><br><span class="line"></span><br><span class="line">然后，我们来解决上面的4个要求：</span><br><span class="line"></span><br><span class="line">1. 把静态资源生成到一个独立的目录下 + md5 + css引用的资源替换</span><br></pre></td></tr></table></figure>&lt;span class=&quot;hljs-comment&quot;&gt;// webpack.config.build.js&lt;/span&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;module&lt;/span&gt;.exports = {    output: {        path: &lt;span class=&quot;hljs-string&quot;&gt;&apos;./asset/build/&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-comment&quot;&gt;// 文件编译输出路径改成 build&lt;/span&gt;        publicpath: &lt;span class=&quot;hljs-string&quot;&gt;&apos;http://yourweb.com/asset/build/&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-comment&quot;&gt;// 这里替换成线上实际地址，可以修改 css 中对图片资源的引用路径。&lt;/span&gt;        filename: &lt;span class=&quot;hljs-string&quot;&gt;&apos;[name]_[hash:5].js&apos;&lt;/span&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// 生成的文件名字，加上了5位的 hash值。当然了，位数和加hash的位置，你可以自己定义，比如 &apos;[name].js?[hash]&apos;.&lt;/span&gt;    },    &lt;span class=&quot;hljs-comment&quot;&gt;// 其它配置...&lt;/span&gt;};```2. 压缩。用 `webpack -p` 解决了。3. 替换 HTML 中静态资源的路径。可以用 webpack 的插件，`html-webpack-plugin` 来做。或者，你对 gulp 还是比较熟悉的话，用 `gulp-prefix` 来实现。这里就不详细写配置了。然后，恭喜你看完了！本文转载：Segmentfault社区</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于最近一些的事</title>
      <link href="/recently-some-things.html"/>
      <url>/recently-some-things.html</url>
      
        <content type="html"><![CDATA[<h3 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h3><p>最近一个月的工作，真的要把我弄炸了，总是不能学会前端的ReactJS框架，只是目前三观已被毁掉…然后就感觉要放弃了，完全混乱的感觉。说实话，走出公司那一刻，心情也不是很难受，最多就是失落感。 回去的路上想了很多：为什么学的慢或者说为什么学不下去？为什么做着做着要放弃？什么时候有这么严重的<strong>拖延症</strong>？我<strong>真正想做的定位是什么</strong>？这一切可能需要这几天好好反省的。</p><p>我自不认为我学习能力很差，但也不至于学得这么差或者很慢吧？甚至要放弃。忽然发现心态，对，心态问题，那么最近这段时间是什么心态？自暴自弃？无所谓？好像是这么回事吧…那为什么会有这种心态，我也反省过了，说到底，自己还是没有根本的<strong>动力</strong>或者说<strong>目标</strong>。是的，一人在长途漫漫的路上，没有一定的动力或者目标，总会迷失自己的。既然找到根本原因，那就改正心态咯。</p><p>那么我的目标是什么？那肯定要成为技术大神、买车买房、生儿育女…等等，感觉说这些好像对我来说很渺远，几乎接触不到。对于这些渺远的东西似乎对我来说没什么用，那就来个实际点的。嗯…我明白了…计划我就不在这儿说了。</p><p>还有，已经卸载该死的LOL…</p><h3 id="简历"><a href="#简历" class="headerlink" title="简历"></a>简历</h3><p>这时候再找工作真的不是时候啊，毕竟9、10月才是招聘黄金时期。在智联招聘、大街招聘都不知道投了多少家简历。能来电也就几个。不过很意外的收到老家的一家公司邀请面试邮件…正在纠结要不要回去…</p><p>关于这次应聘岗位还是做Java Web后台，毕竟还是后台适合我。前端虽然不难，但做得真的很烦…不过在职时间，真的需要把一些基础好好学。再扩展其他方面的，下一步肯定好好研究Android，买了一本Android开发书籍，到现在没看…</p><h3 id="其它杂事"><a href="#其它杂事" class="headerlink" title="其它杂事"></a>其它杂事</h3><p>最近入了个一加3，真没惊喜，也不好玩。打算挂咸鱼出了…这几天不知道咋回事，手中的iPhone设备貌似各种问题，气的我直接iOS10入狱了，完全没有越狱后折腾的各种欲望，Mac设备也升级到MacOS版本，不就多一个Siri可以调戏…</p><p>前几天忽然发现我的Apple ID无法登陆iMessage和FaceTime，百度搜了下，感觉账号被拉黑？打电话给Apple客服，天哪，居然花了我俩天到时间搞定。不过这也值了，至少Mac可以发送短信了。</p><p>快到月底了，纠结要不要搬家，搬来搬去也是蛮烦的。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>OnePlus A3000 Oxygen优化版</title>
      <link href="/oneplus3-oxygen.html"/>
      <url>/oneplus3-oxygen.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>也没啥好说的，国内H2OS，国外O2OS，个人比较倾向于国外，喜欢原生风格。</p><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>其实也没啥好说的，主要是针对国内性的优化，保留仅有Google Service框架，且升级最新版。</p><h3 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h3><p>[download] <a href="http://pan.baidu.com/s/1dEXQT5B" target="_blank" rel="noopener">http://pan.baidu.com/s/1dEXQT5B</a> [/download]</p><p>里面就附带最新版的Root卡刷包。</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS X </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>对Android的一些折腾笔记</title>
      <link href="/android-notes-1.html"/>
      <url>/android-notes-1.html</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>今天莫名其妙想看看一加3的分区，尝试使用的之前的命令去测试，发现貌似都失效了。</p><h3 id="以下都是以前的笔记"><a href="#以下都是以前的笔记" class="headerlink" title="以下都是以前的笔记"></a>以下都是以前的笔记</h3><p>查看android分区列表</p><pre><code>cat /proc/partitionsls -al /dev/block/platform/msm_sdcc.1/by-name</code></pre><p>查看分区详细信息</p><pre><code>adb make_ext4fs /dev/block/mmcblk0p14</code></pre><p>导出镜像文件</p><pre><code>dd if=/dev/block/mmcblk0p14 of=/sdcard/system.img</code></pre><p>dat文件转换img镜像</p><pre><code>./sdat2img.py system.transfer.list system.new.dat system.img</code></pre><p>挂载img镜像到输出文件夹</p><pre><code>sudo mount -t ext4 -o loop system.img system/</code></pre><p>打包镜像文件 一加(1.4G)</p><pre><code>./makeext4fs -s -l 1388314624 -a system newsystem.img system/</code></pre><p>打包后img镜像非4ext格式需要转换：</p><pre><code>simg2img newsystem.img systemout.img</code></pre><p>img转换dat</p><pre><code>./rimg2sdat system_out.img</code></pre><p><a href="https://o0zre2tqt.qnssl.com/android/tools/Tools.tar.gz" target="_blank" rel="noopener">下载附件</a></p><hr><p>想查看分区命令：</p><pre><code>1|root@OnePlus3:/ # ls -al /dev/block/platform/soc/624000.ufshc/by-namels -al /dev/block/platform/soc/624000.ufshc/by-namelrwxrwxrwx root     root              1970-01-17 18:41 LOGO -&gt; /dev/block/sde17lrwxrwxrwx root     root              1970-01-17 18:41 aboot -&gt; /dev/block/sde15lrwxrwxrwx root     root              1970-01-17 18:41 abootbak -&gt; /dev/block/sde16lrwxrwxrwx root     root              1970-01-17 18:41 apdp -&gt; /dev/block/sde30lrwxrwxrwx root     root              1970-01-17 18:41 bluetooth -&gt; /dev/block/sde23lrwxrwxrwx root     root              1970-01-17 18:41 boot -&gt; /dev/block/sde18lrwxrwxrwx root     root              1970-01-17 18:41 boot_aging -&gt; /dev/block/sde19lrwxrwxrwx root     root              1970-01-17 18:41 cache -&gt; /dev/block/sda3lrwxrwxrwx root     root              1970-01-17 18:41 cdt -&gt; /dev/block/sdd2lrwxrwxrwx root     root              1970-01-17 18:41 cmnlib -&gt; /dev/block/sde26lrwxrwxrwx root     root              1970-01-17 18:41 cmnlib64 -&gt; /dev/block/sde28lrwxrwxrwx root     root              1970-01-17 18:41 cmnlib64bak -&gt; /dev/block/sde29lrwxrwxrwx root     root              1970-01-17 18:41 cmnlibbak -&gt; /dev/block/sde27lrwxrwxrwx root     root              1970-01-17 18:41 config -&gt; /dev/block/sda14lrwxrwxrwx root     root              1970-01-17 18:41 ddr -&gt; /dev/block/sdd3lrwxrwxrwx root     root              1970-01-17 18:41 devcfg -&gt; /dev/block/sda6lrwxrwxrwx root     root              1970-01-17 18:41 devcfgbak -&gt; /dev/block/sda7lrwxrwxrwx root     root              1970-01-17 18:41 devinfo -&gt; /dev/block/sde22lrwxrwxrwx root     root              1970-01-17 18:41 dip -&gt; /dev/block/sde13lrwxrwxrwx root     root              1970-01-17 18:41 dpo -&gt; /dev/block/sde32lrwxrwxrwx root     root              1970-01-17 18:41 dsp -&gt; /dev/block/sde12lrwxrwxrwx root     root              1970-01-17 18:41 frp -&gt; /dev/block/sda8lrwxrwxrwx root     root              1970-01-17 18:41 fsc -&gt; /dev/block/sdf3lrwxrwxrwx root     root              1970-01-17 18:41 fsg -&gt; /dev/block/sde7lrwxrwxrwx root     root              1970-01-17 18:41 hyp -&gt; /dev/block/sde5lrwxrwxrwx root     root              1970-01-17 18:41 hypbak -&gt; /dev/block/sde6lrwxrwxrwx root     root              1970-01-17 18:41 keymaster -&gt; /dev/block/sde24lrwxrwxrwx root     root              1970-01-17 18:41 keymasterbak -&gt; /dev/block/sde25lrwxrwxrwx root     root              1970-01-17 18:41 keystore -&gt; /dev/block/sda5lrwxrwxrwx root     root              1970-01-17 18:41 md5 -&gt; /dev/block/sdf4lrwxrwxrwx root     root              1970-01-17 18:41 mdtp -&gt; /dev/block/sde14lrwxrwxrwx root     root              1970-01-17 18:41 misc -&gt; /dev/block/sda4lrwxrwxrwx root     root              1970-01-17 18:41 modem -&gt; /dev/block/sde11lrwxrwxrwx root     root              1970-01-17 18:41 modemst1 -&gt; /dev/block/sdf1lrwxrwxrwx root     root              1970-01-17 18:41 modemst2 -&gt; /dev/block/sdf2lrwxrwxrwx root     root              1970-01-17 18:41 msadp -&gt; /dev/block/sde31lrwxrwxrwx root     root              1970-01-17 18:41 oem_dycnvbk -&gt; /dev/block/sda9lrwxrwxrwx root     root              1970-01-17 18:41 oem_stanvbk -&gt; /dev/block/sda10lrwxrwxrwx root     root              1970-01-17 18:41 param -&gt; /dev/block/sda11lrwxrwxrwx root     root              1970-01-17 18:41 persist -&gt; /dev/block/sda2lrwxrwxrwx root     root              1970-01-17 18:41 pmic -&gt; /dev/block/sde9lrwxrwxrwx root     root              1970-01-17 18:41 pmicbak -&gt; /dev/block/sde10lrwxrwxrwx root     root              1970-01-17 18:41 recovery -&gt; /dev/block/sde21lrwxrwxrwx root     root              1970-01-17 18:41 reserve -&gt; /dev/block/sdd1lrwxrwxrwx root     root              1970-01-17 18:41 reserve1 -&gt; /dev/block/sda12lrwxrwxrwx root     root              1970-01-17 18:41 reserve2 -&gt; /dev/block/sda13lrwxrwxrwx root     root              1970-01-17 18:41 rpm -&gt; /dev/block/sde1lrwxrwxrwx root     root              1970-01-17 18:41 rpmbak -&gt; /dev/block/sde2lrwxrwxrwx root     root              1970-01-17 18:41 sec -&gt; /dev/block/sde8lrwxrwxrwx root     root              1970-01-17 18:41 splash -&gt; /dev/block/sde33lrwxrwxrwx root     root              1970-01-17 18:41 ssd -&gt; /dev/block/sda1lrwxrwxrwx root     root              1970-01-17 18:41 sti -&gt; /dev/block/sde34lrwxrwxrwx root     root              1970-01-17 18:41 system -&gt; /dev/block/sde20lrwxrwxrwx root     root              1970-01-17 18:41 tz -&gt; /dev/block/sde3lrwxrwxrwx root     root              1970-01-17 18:41 tzbak -&gt; /dev/block/sde4lrwxrwxrwx root     root              1970-01-17 18:41 userdata -&gt; /dev/block/sda15lrwxrwxrwx root     root              1970-01-17 18:41 xbl -&gt; /dev/block/sdb1lrwxrwxrwx root     root              1970-01-17 18:41 xblbak -&gt; /dev/block/sdc1</code></pre><p>其他不变，无非就是分区号变了而已。</p><h1 id="其他："><a href="#其他：" class="headerlink" title="其他："></a>其他：</h1><p>关于工具说明可以到这儿看看<a href="http://forum.xda-developers.com/android/software-hacking/how-to-conver-lollipop-dat-files-to-t2978952" target="_blank" rel="noopener">点击跳转</a></p><p>支持Android 6.0的BusyBox可以到这下<a href="http://www.coolapk.com/apk/com.jrummy.busybox.installer.pro" target="_blank" rel="noopener">点击跳转</a></p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Linux使用Socks5转Http协议代理</title>
      <link href="/convert-ss-into-an-http-proxy.html"/>
      <url>/convert-ss-into-an-http-proxy.html</url>
      
        <content type="html"><![CDATA[<p>人在天朝，下载资源不痛快啊。</p><p>虽然有ss，但终端不走sock5，Google半天找到这样的方案：<a href="Convert-Shadowsocks-into-an-HTTP-proxy">点击跳转</a></p><p>我是在Ubuntu环境下测试的</p><p>使用Polipo把socks5转换http代理：</p><pre><code>sudo apt install polipo</code></pre><p>安装完毕修改配置文件：</p><pre><code>sudo gedit /etc/polipo/config</code></pre><p>修改如下</p><pre><code># This file only needs to list configuration variables that deviate# from the default values.  See /usr/share/doc/polipo/examples/config.sample# and &quot;polipo -v&quot; for variables you can tweak and further information.logSyslog = falselogFile = &quot;/var/log/polipo/polipo.log&quot;socksParentProxy = &quot;127.0.0.1:1080&quot;socksProxyType = socks5chunkHighMark = 50331648objectHighMark = 16384serverMaxSlots = 64serverSlots = 16serverSlots1 = 32proxyAddress = &quot;0.0.0.0&quot;proxyPort = 8123</code></pre><p>重启服务</p><pre><code>/etc/init.d/polipo restart</code></pre><p>验证(拉取到有内容表示OK了)：</p><pre><code>export http_proxy=&quot;http://127.0.0.1:8123/&quot;curl www.google.com</code></pre><p>另外，在浏览器中输入<a href="http://127.0.0.1:8123/%E4%BE%BF%E5%8F%AF%E4%BB%A5%E8%BF%9B%E5%85%A5%E5%88%B0" target="_blank" rel="noopener">http://127.0.0.1:8123/便可以进入到</a> Polipo 的使用说明和配置界面</p><pre><code>http_proxy=http://localhost:8123 apt-get updatehttp_proxy=http://localhost:8123 curl www.google.comhttp_proxy=http://localhost:8123 wget www.google.comgit config --global http.proxy 127.0.0.1:8123git clone https://github.com/xxx/xxx.gitgit xxxgit xxxgit config --global --unset-all http.proxy</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sublime Text 3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Shell卸载Node.JS</title>
      <link href="/uninstall-nodejs.html"/>
      <url>/uninstall-nodejs.html</url>
      
        <content type="html"><![CDATA[<p>主要是针对Mac系统卸载Node.JS，Linux可以一键卸载。当然也可以参考下面的。</p><pre><code>#!/bin/bashlsbom -f -l -s -pf /var/db/receipts/org.nodejs.pkg.bom \| while read i; do  sudo rm /usr/local/${i}donesudo rm -rf /usr/local/lib/node \     /usr/local/lib/node_modules \     /var/db/receipts/org.nodejs.*</code></pre><p>可以保存shell脚本来运行，需要Root权限。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OnePlus </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实现CSS异步加载，不影响页面渲染</title>
      <link href="/css-asyn-load.html"/>
      <url>/css-asyn-load.html</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>触发异步样式下载的诀窍是使用一个  元素，并 为media 属性设置一个不可用的值 (我用的是 media=”none”, 不过其它的任何值也是可以的)。当一个媒体查询的结果值计算出来是 false 的时候，浏览器仍然会下载样式表，但是不会在渲染页面之前等待样式表的资源可用。</p><pre><code>&lt;link rel=&quot;stylesheet&quot; href=&quot;css.css&quot; media=&quot;none&quot;&gt;</code></pre><p>样式表一下载好，media 属性就必须被设置一个可用的值，以便样式规则能被应用到 html 文档中onload 事件就可以用来将 media 属性切换到all：</p><pre><code>&lt;link rel=&quot;stylesheet&quot; href=&quot;css.css&quot; media=&quot;none&quot; onload=&quot;if(media!=&apos;all&apos;)media=&apos;all&apos;&quot;&gt;</code></pre><p>这种加载 CSS 的方法将比标准的方法在向访问者传送有用信息的速度上快很多。至关重要的 CSS 加载时仍然可以用一般的阻塞方式处理 (或者你也可以为了最终的性能对它进行内联处理) ，而不重要的样式则可以慢慢下载，并在解析/渲染过程的后面一点的阶段进行应用。</p><h2 id="实战：使用非阻塞-CSS-加载字体"><a href="#实战：使用非阻塞-CSS-加载字体" class="headerlink" title="实战：使用非阻塞 CSS 加载字体"></a>实战：使用非阻塞 CSS 加载字体</h2><p>字体第一次绘制的性能是一个问题，它们是阻塞式的资源，也会让应用它们的文本在该字体下载时不可见 。使用上述示例中的非阻塞链接，就可能在幕后下载包含字体数据的样式表，不阻塞压面的渲染：</p><pre><code>&lt;link rel=&quot;stylesheet&quot; href=&quot;main.css&quot;&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;font.css&quot; media=&quot;none&quot; onload=&quot;if(media!=&apos;all&apos;)media=&apos;all&apos;&quot;&gt;</code></pre><p>font.css 包含一个 base64 编码的 WOFF 版本的 Merriweather 字体。</p><pre><code>@font-face {  font-family: Merriweather;  font-style: normal;  font-weight: 400;  src: local(&apos;Merriweather&apos;), url(&apos;data:application/x-font-woff;charset=utf-8;base64,...&apos;)}</code></pre><p>main.css 包含了需要应用到站点的所有样式规则。下面是字体的声明：</p><pre><code>body {  font-family: Merriweather, &quot;Lucida Grande&quot;, ...;}</code></pre><p>当字体正在下载时，第一个匹配到的备用回退字体 (这里就是 Lucida Grande) 被用来渲染页面的内容。 一旦字体样式表被应用了，Merriweather 就会被使用. 我尝试去确保回退的字体将相似的布局特征共享给优先选择的字体，那样不可避免的回流就尽可能微妙了。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>动手生产一个超级精简版的手机 QQ（Android 限定）</title>
      <link href="/fuck-android-qq.html"/>
      <url>/fuck-android-qq.html</url>
      
        <content type="html"><![CDATA[<p>手机 QQ 越来越慢怎么办？<br>轻聊版、国际版功能不全怎么办？</p><p>通过这个脚本，可以轻松精简 Android QQ，仅保留基础的聊天相关功能。</p><p>使用方法：</p><ul><li>传输到手机中</li><li>用 root 权限执行</li><li>详细步骤请见注释</li><li>脚本需要 Root 权限</li><li>不用 Root 权限也能进行部分精简（无法操作 data 分区），如有需要自行修改脚本执行即可</li></ul><p>脚本下载：</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>[Unified]SudaMod For OnePlus 3 A3000</title>
      <link href="/sudamod-for-oneplus3.html"/>
      <url>/sudamod-for-oneplus3.html</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><blockquote><p>SudaMod是基于Cyanogenmod二次开发的系统。</p></blockquote><p>SudaMod致力于打造一个纯净的本土化系统，<br>通过合并优秀第三方代码，<br>加上自己的特色功能，<br>保留原生系统功能并加以提升，<br>给小伙伴们带来不一样的系统体验。</p><p>当然我会尽量长期保持一天一更…</p><h3 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h3><p><a href="https://img.alicdn.com/imgextra/i2/2038135983/TB2xutOXu6yQeBjy0FfXXcWvXXa_!!2038135983.jpg" target="_blank" rel="noopener"><img src="https://img.alicdn.com/imgextra/i2/2038135983/TB2xutOXu6yQeBjy0FfXXcWvXXa_!!2038135983.jpg" alt="SudaMod截图"></a></p><h3 id="下载地址："><a href="#下载地址：" class="headerlink" title="下载地址："></a>下载地址：</h3><p><a href="http://pan.baidu.com/s/1o7JvdUi" target="_blank" rel="noopener">点击下载</a></p><h3 id="刷入教程"><a href="#刷入教程" class="headerlink" title="刷入教程"></a>刷入教程</h3><p><strong>Twrp Recovery多国语言镜像下载</strong></p><p><a href="https://dl.twrp.me/oneplus3/" title="点击跳转" target="_blank" rel="noopener">点击跳转</a></p><p><strong>Windows ADB全局环境安装包</strong></p><p><a href="http://pan.baidu.com/s/1skNYFY9" title="百度网盘" target="_blank" rel="noopener">百度网盘</a></p><p><a href="https://www.dropbox.com/s/mcxw0yy3jvydupd/adb-setup-1.4.3.exe?dl=0" title="DropBox" target="_blank" rel="noopener">DropBox</a></p><p><code>请用管理员模式安装</code></p><p><strong>刷入方法</strong></p><pre><code>fastboot flash recovery twrp-x.x.x-x-oneplus3.img #根据版本号输入</code></pre><p><strong>ROM刷入</strong></p><ul><li>请备份好手机相关数据</li><li>仔细对比ROM的md5是否正确以及完整性，放入手机内存中</li><li>进入Recovery模式，请进行<code>双清(恢复出厂设置)</code></li><li>刷入ROM以及其他补丁，重启后请耐心等待进入系统</li></ul><p>更新日志：<a href="https://www.cmxlog.com/13/oneplus3" target="_blank" rel="noopener">点击跳转</a></p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS X </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OnePlus 3编译SudaMod笔记</title>
      <link href="/building-sudamod-for-oneplus-3.html"/>
      <url>/building-sudamod-for-oneplus-3.html</url>
      
        <content type="html"><![CDATA[<p>首先需要安装的环境</p><pre><code>sudo apt install git-core gnupg flex bison gperf libsdl1.2-dev libesd0-dev libwxgtk3.0-dev squashfs-tools build-essential zip curl libncurses5-dev zlib1g-dev openjdk-7-jre openjdk-7-jdk pngcrush schedtool libxml2 libxml2-utils xsltproc lzop libc6-dev schedtool g++-multilib lib32z1-dev lib32ncurses5-dev gcc-multilib maven liblz4-tool lib32readline6 lib32readline6-dev u-boot-tools phablet-tools tmux screen w3m ncftp maven pngquant</code></pre><p>关于Ubuntu 16.04 LTS无法安装jdk7如下解决：</p><pre><code>sudo add-apt-repository ppa:openjdk-r/ppa  sudo apt update   sudo apt install openjdk-7-jdk</code></pre><p>或者在设置源添加：</p><pre><code>http://ppa.launchpad.net/openjdk-r/ppa/ubuntu</code></pre><p>剩下请看<a href="https://github.com/SudaMod/android" target="_blank" rel="noopener">SudaMod</a>源码同步</p><p>同步设备代码和内核配置文件：</p><pre><code>mkdir ~/Android/SudaMod/.repo/local_manifestswget -P ~/Android/SudaMod/.repo/local_manifests https://raw.githubusercontent.com/nucked/oneplus3-local_manifests/master/local_manifests.xmlrepo sync --force-sync -j8</code></pre><p>自动同步脚本：</p><pre><code>#!/bin/bashecho &quot;================start repo sync====================&quot;proxychains repo sync --force-sync -j8while [ $? = 1 ]; doecho &quot;====================sync failed, re-sync again=======&quot;sleep 3proxychains repo sync --force-sync -j8done</code></pre><p>注意：proxychains是代理</p><p>同步完毕后修改文件夹下/home/wangjin/Android/SudaMod/device/oneplus/bacon<br>把cm.dependencies改成sm.dependencies、<br>cm.mk改成sm.mk<br>sm.mk中所cm路径改成sm路径即可<br>最后编译ROM即可！</p><hr><p>local_manifests.xml如下：</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;manifest&gt;  &lt;project name=&quot;CyanogenMod/android_device_oneplus_oneplus3&quot; path=&quot;device/oneplus/oneplus3&quot; remote=&quot;github&quot; /&gt;  &lt;project name=&quot;CyanogenMod/android_device_oppo_common&quot; path=&quot;device/oppo/common&quot; remote=&quot;github&quot; /&gt;  &lt;project name=&quot;CyanogenMod/android_kernel_oneplus_msm8996&quot; path=&quot;kernel/oneplus/msm8996&quot; remote=&quot;github&quot; /&gt;  &lt;project name=&quot;CyanogenMod/android_vendor_nxp-nfc_opensource_frameworks&quot; path=&quot;vendor/nxp-nfc/opensource/frameworks&quot; remote=&quot;github&quot; /&gt;  &lt;project name=&quot;CyanogenMod/android_vendor_nxp-nfc_opensource_libnfc-nci&quot; path=&quot;vendor/nxp-nfc/opensource/libnfc-nci&quot; remote=&quot;github&quot; /&gt;  &lt;project name=&quot;CyanogenMod/android_vendor_nxp-nfc_opensource_Nfc&quot; path=&quot;vendor/nxp-nfc/opensource/Nfc&quot; remote=&quot;github&quot; /&gt;  &lt;project name=&quot;CyanogenMod/android_device_qcom_common&quot; path=&quot;device/qcom/common&quot; remote=&quot;github&quot; /&gt;  &lt;project name=&quot;TheMuppets/proprietary_vendor_oneplus&quot; path=&quot;vendor/oneplus&quot; remote=&quot;github&quot; revision=&quot;cm-13.0&quot; /&gt;&lt;/manifest&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS X </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux一些错误解决笔记</title>
      <link href="/linux-solve-notes.html"/>
      <url>/linux-solve-notes.html</url>
      
        <content type="html"><![CDATA[<h4 id="报错：ERROR-ld-so-object-‘libproxychains-so-3’-from-LD-PRELOAD-cannot-be-preloaded-cannot-open-shared-object-file-ignored"><a href="#报错：ERROR-ld-so-object-‘libproxychains-so-3’-from-LD-PRELOAD-cannot-be-preloaded-cannot-open-shared-object-file-ignored" class="headerlink" title="报错：ERROR: ld.so: object ‘libproxychains.so.3’ from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored."></a>报错：ERROR: ld.so: object ‘libproxychains.so.3’ from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.</h4><p>今天安装ProxyChains代理发现报个错误，应该是没找个库文件，搜索：</p><pre><code>sudo find /usr/ -name libproxychains.so.3 -print/usr/lib/x86_64-linux-gnu/libproxychains.so.3</code></pre><p>修改/usr/bin/proxychains：</p><pre><code>export LD_PRELOAD=libproxychains.so.3 改为export LD_PRELOAD=/usr/lib/libproxychains.so.3 </code></pre><p>就行了</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
            <tag> WebPack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntu一些杂记</title>
      <link href="/ubuntu-notes.html"/>
      <url>/ubuntu-notes.html</url>
      
        <content type="html"><![CDATA[<h2 id="卸载Ubuntu没用的软件"><a href="#卸载Ubuntu没用的软件" class="headerlink" title="卸载Ubuntu没用的软件"></a>卸载Ubuntu没用的软件</h2><pre><code>sudo apt purge libreoffice-common empathy brasero simple-scan gnome-mahjongg aisleriot gnome-mines cheese gnome-sudoku gnome-orca webbrowser-app deja-dup unity-webapps-common</code></pre><h2 id="下载最新版Chrome浏览器-Stable版"><a href="#下载最新版Chrome浏览器-Stable版" class="headerlink" title="下载最新版Chrome浏览器 Stable版"></a>下载最新版Chrome浏览器 Stable版</h2><pre><code>proxychains wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WebPack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一加3开箱体验笔记</title>
      <link href="/oneplus-3-unpacking-note.html"/>
      <url>/oneplus-3-unpacking-note.html</url>
      
        <content type="html"><![CDATA[<h2 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h2><p>一加3，让我纠结大半个月，昨天狠心下单买个…</p><p>我记得我上部自己还停留在高通骁龙800上，现在都高通骁龙820了，硬件淘汰实在是太快了，且高通骁龙820是64位处理器，配合Android Lollipop系统，我想这应该是一个很棒哒体验吧？</p><p>今早朦朦胧胧看到淘宝来消息说派件了，顺丰的速度果然不是盖的…简直是神效率，于是乎，起来刷脸坐等快递来。接近9点的时候，我还在折腾WordPress插件(表示WP编辑器简直是狗屎似的，太难用了！)，打算自己开发Editor.MD插件。不然我先转T要陪冲或者PageKit去了。然后来电话了，领件去。</p><h2 id="开箱："><a href="#开箱：" class="headerlink" title="开箱："></a>开箱：</h2><p>拿到快递件，也没啥感觉，难道我老了？:joy:想想以前拿到手机简直兴奋大半天。虽然现在用iPhone 6S Plus很安逸，也经常折腾一些东西，那也不至于把我折腾的性格磨灭了吧？</p><p>好了，废话少说，拿到开件：<br><img src="https://img.alicdn.com/imgextra/i4/2038135983/TB2yszlXazyQeBjy0FgXXbnsVXa_!!2038135983.jpg" alt><br><img src="https://img.alicdn.com/imgextra/i1/2038135983/TB2WIblXjnyQeBjSszbXXbCxVXa_!!2038135983.jpg" alt></p><p>包装不错，很结实。好不容易打开，终于看到小小的盒子…</p><p><img src="https://img.alicdn.com/imgextra/i1/2038135983/TB2QxLlXanyQeBjSsplXXaLWVXa_!!2038135983.jpg" alt></p><p>还是一如既往的简洁，白和红混搭的风格。</p><p><img src="https://img.alicdn.com/imgextra/i3/2038135983/TB2ghDlXlTxQeBjSspkXXXtMpXa_!!2038135983.jpg" alt></p><p><img src="https://img.alicdn.com/imgextra/i3/2038135983/TB2MFDlXhbxQeBjy1XdXXXVBFXa_!!2038135983.jpg" alt></p><p>我买的是薄荷金，虽然我的iPhone 6S Plus也是金色，俩者相对比较，会发现一加3金色更淡些。</p><p>盒子外层有薄膜，撕开开盒。</p><p><img src="https://img.alicdn.com/imgextra/i3/2038135983/TB2Kf_kXjzyQeBjy0FeXXbwyFXa_!!2038135983.jpg" alt><br><img src="https://img.alicdn.com/imgextra/i3/2038135983/TB2zcHlXazyQeBjy0FgXXbnsVXa_!!2038135983.jpg" alt></p><p>打开后，并没有什么一眼让我感觉有亮点存在的地方，正面对我来说就是大众脸，要是给我三星Galaxy S7、乐视2、ZUK 2、小米5放在一起，特码我也分不清哪个是哪个…个人倒不怎么在意颜值。</p><p><img src="https://img.alicdn.com/imgextra/i3/2038135983/TB2cyflXlYxQeBjSspdXXb6QXXa_!!2038135983.jpg" alt><br><img src="https://img.alicdn.com/imgextra/i1/2038135983/TB2xAflXeLyQeBjy1XaXXcexFXa_!!2038135983.jpg" alt><br><img src="https://img.alicdn.com/imgextra/i4/2038135983/TB21t2mXanyQeBjSspeXXa8WpXa_!!2038135983.jpg" alt><br><img src="https://img.alicdn.com/imgextra/i3/2038135983/TB2iNPlXlTxQeBjSspkXXXtMpXa_!!2038135983.jpg" alt></p><p>背面摄像头上正中，且凸出来的，可能为了更薄，或者为了拍照效果弄成这样吧。但是！我并不明白，为啥好多手机设计就喜欢放白！带！但苹果有白带就是为了增强信号。难道一加3这也是为了增强信号的呢？</p><p>而且我发现一加侧边好多地方和iPhone产品好像似，无非就是换个位置换个样式而已，对我来说，这也减少对机子使用学习的成本了，可能就是为了迎合用户的使用习惯吧。</p><p><img src="https://img.alicdn.com/imgextra/i1/2038135983/TB2qljmXhvxQeBjy0FdXXaybXXa_!!2038135983.jpg" alt><br><img src="https://img.alicdn.com/imgextra/i1/2038135983/TB2jhLlXlTxQeBjSspkXXXtMpXa_!!2038135983.jpg" alt></p><p>盒子标配一个TypeC接口数据线，一个5A–4A的充电器头，一份多国语言的说明书，一份保修书，一份一加Logo贴纸和一个卡针。相对上代产品来比，感觉少了usim卡套…虽然不怎么用到。</p><p>好了开箱就到这。</p><h2 id="使用："><a href="#使用：" class="headerlink" title="使用："></a>使用：</h2><h4 id="指纹识别："><a href="#指纹识别：" class="headerlink" title="指纹识别："></a>指纹识别：</h4><p>关于指纹识别，觉得也没什么缺点，在Android上体验指纹识别，这门技术算是成熟了。</p><p>一加3的指纹识别可以在黑屏(锁屏)情况下直接解锁，要是指纹不对会有震动反馈来来提示用户指纹错误，第三次指纹错误则亮屏显示基本解锁方式(图案解锁，数字解锁等)。但个人觉得这样情况下，耗电量不知道咋样，毕竟黑屏情况下传感器就要时时刻刻准备着。关于耗电量以后再评测吧。</p><p>有人说Android机子指纹识别速度很快，能超越iPhone指纹识别。我不懂他们所说的的”快”是什么哪方面的。仔细对比了下，发现一加3在成功识别解锁之后，<code>直接进入桌面</code>，而苹果在解锁要进入桌面时，<code>这中间却有长达接近500毫秒的过渡动画</code>(别问我咋算出来的)。对于大部分Android机子指纹识别速度快无法采用障眼法而已。</p><h4 id="相机："><a href="#相机：" class="headerlink" title="相机："></a>相机：</h4><p>我并不是专业的摄像人员，以普通的消费者观点就稍微讲讲吧。</p><p>iPhone外景拍照：<br><img src="https://img.alicdn.com/imgextra/i3/2038135983/TB2CHTsXhjxQeBjSspcXXcQlXXa_!!2038135983.jpg" alt></p><p>OnePlus外景外景拍照：<br><img src="https://img.alicdn.com/imgextra/i4/2038135983/TB2tZvqXjzyQeBjy0FeXXbwyFXa_!!2038135983.jpg" alt></p><hr><p>iPhone物品焦距拍照：<br><img src="https://img.alicdn.com/imgextra/i3/2038135983/TB2UqrrXanyQeBjSsplXXaLWVXa_!!2038135983.jpg" alt></p><p>OnePlus物品焦距拍照：<br><img src="https://img.alicdn.com/imgextra/i4/2038135983/TB2HTLrXaryQeBjSszdXXaL.XXa_!!2038135983.jpg" alt></p><hr><p>iPhone逆光拍照：<br><img src="https://img.alicdn.com/imgextra/i3/2038135983/TB27g_rXhjxQeBjy1zbXXbqApXa_!!2038135983.jpg" alt></p><p>OnePlus逆光拍照：<br><img src="https://img.alicdn.com/imgextra/i2/2038135983/TB2DuDsXlPxQeBjy1XcXXXHzVXa_!!2038135983.jpg" alt></p><hr><p>从上面几组照片可以看出，一加3拍照效果完全适应各种环境拍照。</p><p>第一组来看，iPhone拍照出来的照片效果很接近人眼看去的效果。但一加拍照出来的的绿色却更加鲜艳，更吸引眼球罢了。且iPhone细节拍照很清楚，一加3很勉强的样子。</p><p>第三组，照片来看，感觉OnePlus拍出来的效果却比IPhone拍照出来简直要好多了。很清晰。</p><h4 id="系统体验："><a href="#系统体验：" class="headerlink" title="系统体验："></a>系统体验：</h4><p>OnePlus手机系统国内则是H2OS(氢OS)，而国外版的系统则是O2OS(氧OS)，俩者对比氧OS比氢OS多出Google全家桶罢了。氢OS很简洁，相当于Nexus系统来比，氢OS充满了颜色艳丽的活力以及国内实用的本地化功能。这一点很赞！毕竟接近原生的系统，很大的程度上会比国内的MIUI、FlymeOS等国产深度定制系统要好得多，且流畅好得多。关于系统也没啥好说的，每个用户体验不一样，就像国内，大部分普通的消费者喜欢MIUI、FlymeOS等华丽系统。毕竟颜值第一嘛，然而一些极客喜欢原生系统，神马国外有名的CyanogenMod(cm)系统、Omni，或者甚至干脆自己动手编译一个AOSP来满足下自己。。蛤蛤，对于极客来讲，手机就是个玩具而已。</p><h2 id="其他："><a href="#其他：" class="headerlink" title="其他："></a>其他：</h2><p>就这样没了，还能咋说。一加3还可以吧，谈不上有亮点存在的地方。</p><p>当然，拿到机子我要好好折腾咯！</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS X </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>对数据库进行缓存优化</title>
      <link href="/database-cache-optimization.html"/>
      <url>/database-cache-optimization.html</url>
      
        <content type="html"><![CDATA[<p>Memcached 是一种高性能的分布式内存对象缓存系统。在动态应用，Memcached 既能提高访问的速度，同时还减低了数据库的负载。</p><h3 id="安装Memcached"><a href="#安装Memcached" class="headerlink" title="安装Memcached"></a>安装Memcached</h3><ul><li>首先让主机安装Memcached，这个我不多说了。</li><li><p>编辑 wp-config.php 文件，添加如下代码：</p><p>define(‘ENABLE_CACHE’, true);</p></li></ul><ul><li>在空间上新建 /wp-content/cache 目录，权限改为 777</li><li><a href="https://wordpress.org/plugins/memcached-is-your-friend/" target="_blank" rel="noopener">https://wordpress.org/plugins/memcached-is-your-friend/</a> 从这下载插件解压提取<code>memcached-class-object-cache.php</code>重命名为<code>object-cache.php</code>上传至 /wp-content 目录</li><li><p>测试：</p><p>&lt;?php echo get_num_queries(); ?&gt;</p></li></ul><h3 id="安装Batcache"><a href="#安装Batcache" class="headerlink" title="安装Batcache"></a>安装Batcache</h3><p>仅仅这样是不够的。下面介绍Batcache</p><p>WordPress 启用 Memcached 这样的内存缓存之后，每次访问 WordPress 页面，都要从内存中获取多个缓存对象。</p><p>而 Batcache 主要就是解决这个问题，它是基于 Memcached 的 WordPress 缓存插件，它的工作原理是：把当前整个页面作为一个对象缓存到内存中，这样再次访问 WordPress 页面的时候，直接获从内存中获取这个对象即可，速度极快。</p><ul><li>安装好 Memcached，详细步骤请参考上面的。所以你的服务器要求要和安装 Memcached 的要求一致。</li><li>上传 advanced-cache.php 到 /wp-content/ 目录。</li><li><p>在 wp-config.php 添加以下代码激活 Batcache:</p><p>define(‘WP_CACHE’, true);</p></li></ul><ul><li>然后尝试多次载入页面查看源代码，应该在 之前可以看到一些 Batcache 状态代码。（未登录状态）</li><li>可以修改 advanced-cache.php 开始的一些代码来调整选项。</li><li>可选的上传 batcache.php 到你的 /wp-content/plugins/ 目录。</li></ul><p><strong>下载 Batcache</strong>：<a href="http://wordpress.org/extend/plugins/batcache/" target="_blank" rel="noopener">http://wordpress.org/extend/plugins/batcache/</a></p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 优化 </tag>
            
            <tag> 数据库 </tag>
            
            <tag> 缓存 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>利用Nginx fastcgi_cache缓存对WordPress博客进行加速</title>
      <link href="/nginx-fastcgi-cache-acceleration-of-wordpress.html"/>
      <url>/nginx-fastcgi-cache-acceleration-of-wordpress.html</url>
      
        <content type="html"><![CDATA[<p>Nginx内置FastCgi缓存，但是不支持自动清除缓存。当你在Wordpress里面新建/修改一篇文章，或者访客提交评论的时候，自动清空相关的缓存是必要的！Nginx需要安装ngx_cache_purg+量身定做的WordPress缓存清理插件：Nginx Helper。</p><h3 id="安装Nginx-ngx-cache-purge模块"><a href="#安装Nginx-ngx-cache-purge模块" class="headerlink" title="安装Nginx ngx_cache_purge模块"></a>安装Nginx ngx_cache_purge模块</h3><ul><li><p>查看ngx_cache_purge是否安装</p><p>nginx -V 2&gt;&amp;1 | grep -o ngx_cache_purge #没有任何反馈就是没有安装</p></li></ul><ul><li><p>安装ngx_cache_purge模块</p><p><code class="bash">cd /root/oneinstack/src<br>wget <a href="http://labs.frickle.com/files/ngx_cache_purge-2.3.tar.gz" target="_blank" rel="noopener">http://labs.frickle.com/files/ngx_cache_purge-2.3.tar.gz</a><br>tar xzf ngx_cache_purge-2.3.tar.gz<br>tar xzf nginx-1.10.1.tar.gz<br>cd nginx-1.10.1<br>nginx -V #查看nginx编译参数，最后加上–add-module=../ngx_cache_purge-2.3<br>make clean<br>./configure –prefix=/usr/local/nginx –user=www –group=www –with-http_stub_status_module –with-http_v2_module –with-http_ssl_module –with-ipv6 –with-http_gzip_static_module –with-http_realip_module –with-http_flv_module –with-openssl=../openssl-1.0.2h –with-pcre=../pcre-8.39 –with-pcre-jit –with-ld-opt=’-ljemalloc’ –add-module=../ngx_cache_purge-2.3<br>make  #编译<br>mv /usr/local/nginx/sbin/nginx{,_<code>date +%F</code>}  #备份nginx<br>cp objs/nginx /usr/local/nginx/sbin<br>nginx -V 2&gt;&amp;1 | grep -o ngx_cache_purge</code></p><h1 id="显示ngx-cache-purge表示已经安装成功"><a href="#显示ngx-cache-purge表示已经安装成功" class="headerlink" title="显示ngx_cache_purge表示已经安装成功"></a>显示ngx_cache_purge表示已经安装成功</h1></li></ul><h3 id="Nginx配置"><a href="#Nginx配置" class="headerlink" title="Nginx配置"></a>Nginx配置</h3><p>建议将fastcgi_cache_path设置tmpfs内存中，操作系统不同tmpfs路径也不同，如下：</p><p><strong>CentOS：/dev/shm</strong></p><p><strong>Ubuntu和Debian：/run/shm</strong></p><p>修改nginx虚拟主机配置文件/usr/local/nginx/conf/vhost/i95.me.conf：</p><pre><code>&lt;code class=&quot;bash&quot;&gt;fastcgi_cache_path /dev/shm/nginx-cache levels=1:2 keys_zone=WORDPRESS:100m inactive=60m;fastcgi_cache_key &quot;$scheme$request_method$host$request_uri&quot;;fastcgi_cache_use_stale error timeout invalid_header http_500;fastcgi_ignore_headers Cache-Control Expires Set-Cookie;server {listen 443 ssl http2;ssl_certificate /usr/local/nginx/conf/ssl/i95.me.crt;ssl_certificate_key /usr/local/nginx/conf/ssl/i95.me.key;ssl_session_timeout 10m;ssl_protocols TLSv1 TLSv1.1 TLSv1.2;ssl_prefer_server_ciphers on;ssl_ciphers ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-RC4-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA:RC4-SHA:!aNULL:!eNULL:!EXPORT:!DES:!3DES:!MD5:!DSS:!PKS;ssl_session_cache builtin:1000 shared:SSL:10m;resolver 8.8.8.8 8.8.4.4 valid=300s;resolver_timeout 5s;server_name i95.me www.i95.me;access_log /data/wwwlogs/i95.me_nginx.log combined;index index.html index.htm index.php;include /usr/local/nginx/conf/rewrite/wordpress.conf;root /data/wwwroot/i95.me;if ($host != i95.me) {    rewrite ^/(.*)$ $scheme://i95.me/$1 permanent;    }set $skip_cache 0;if ($request_method = POST) {    set $skip_cache 1;    }if ($query_string != &quot;&quot;) {    set $skip_cache 1;    }if ($request_uri ~* &quot;/wp-admin/|/xmlrpc.php|wp-.*.php|/feed/|index.php|sitemap(_index)?.xml&quot;) {    set $skip_cache 1;    }if ($http_cookie ~* &quot;comment_author|wordpress_[a-f0-9]+|wp-postpass|wordpress_no_cache|wordpress_logged_in&quot;) {    set $skip_cache 1;    }location ~ [^/].php(/|$) {    #fastcgi_pass remote_php_ip:9000;    fastcgi_pass unix:/dev/shm/php-cgi.sock;    fastcgi_index index.php;    include fastcgi.conf;    fastcgi_cache_bypass $skip_cache;    fastcgi_no_cache $skip_cache;    fastcgi_cache WORDPRESS;    fastcgi_cache_valid  60m;    }location ~ /purge(/.*) {    allow 127.0.0.1;    deny all;    fastcgi_cache_purge WORDPRESS &quot;$scheme$request_method$host$1&quot;;    }location ~ .*.(gif|jpg|jpeg|png|bmp|swf|svg|flv|ico)$ {    expires 30d;    access_log off;    }location ~ .*.(js|css)?$ {    expires 7d;    access_log off;    }}</code></pre><p><strong>使nginx配置生效</strong></p><pre><code>service nginx reload</code></pre><p>重启系统后shm内存中nginx-cache文件夹会丢失，为了使重启生效（自动创建文件夹），修改/etc/init.d/nginx的make_dirs下一行（大概52行）添加：</p><pre><code>[ ! -d &apos;/dev/shm/nginx-cache&apos; ] &amp;&amp; { mkdir /dev/shm/nginx-cache; chown -R ${user}.$user /dev/shm/nginx-cache; }</code></pre><h3 id="WordPress安装Nginx-Helper插件"><a href="#WordPress安装Nginx-Helper插件" class="headerlink" title="WordPress安装Nginx Helper插件"></a>WordPress安装Nginx Helper插件</h3><p>WordPress后台【插件】—【安装插件】搜索【<strong>Nginx Helper</strong>】安装即可。如下设置：</p><p><a href="https://blog.linuxeye.com/wp-content/uploads/2016/01/Nginx-Helper-Settings.png" target="_blank" rel="noopener"><img src="https://blog.linuxeye.com/wp-content/uploads/2016/01/Nginx-Helper-Settings.png" alt></a></p><p>修改wordpress网站根目录wp-config.php添加如下行：</p><pre><code>define(&apos;RT_WP_NGINX_HELPER_CACHE_PATH&apos;,&apos;/dev/shm/nginx-cache&apos;);</code></pre><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>测试时候勾选Enable Logging（记录日志）、Enable Nginx Timestamp in HTML（插入缓存信息）。</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 优化 </tag>
            
            <tag> 缓存 </tag>
            
            <tag> 加速 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac OS X 11解锁Root目录读写</title>
      <link href="/mac-os-x-11-unlock-root-directory-to-read-and-write.html"/>
      <url>/mac-os-x-11-unlock-root-directory-to-read-and-write.html</url>
      
        <content type="html"><![CDATA[<p>买个MacBook体验下，还阔以</p><p>尝试精简自带的软件，发现在Root用户下依然无法删除系统某些文件。</p><p>谷歌之后才知道，是El Capitan 加入了<code>Rootles机制</code>，Rootless机制将成为对抗恶意程序的最后防线，不再能够随心所欲的读写很多路径下了。设置 root 权限也不行。</p><p>关闭Rootles</p><p>重启按住 Command+R，进入恢复模式，打开Terminal输入：</p><p><code>csrutil disable</code></p><p>重启即可。如果要恢复默认，那么输入：</p><p><code>csrutil enable</code></p><p>csrutil命令参数格式：</p><pre><code>csrutil enable [--without kext | fs | debug | dtrace | nvram][--no-internal]禁用：csrutil disable（等同于csrutil enable --without kext --without fs --without debug --without dtrace --without nvram）其中各个开关，意义如下：B0: [kext] 允许加载不受信任的kext（与已被废除的kext-dev-mode=1等效）B1: [fs] 解锁文件系统限制B2: [debug] 允许task_for_pid()调用B3: [n/a] 允许内核调试 （官方的csrutil工具无法设置此位）B4: [internal] Apple内部保留位（csrutil默认会设置此位，实际不会起作用。设置与否均可）B5: [dtrace] 解锁dtrace限制B6: [nvram] 解锁NVRAM限制B7: [n/a] 允许设备配置（新增，具体作用暂时未确定）﻿​```</code></pre>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ReactJS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>为知笔记发布到博客去掉小尾巴</title>
      <link href="/wiznote-remove-tail.html"/>
      <url>/wiznote-remove-tail.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>前言</p></blockquote><p>用过诸多笔记客户端，适合我胃口恐怕只有为知笔记了，毕竟功能强大得不像话，支持从各种其他笔记导入数据(之前是有道云笔记和印象笔记)，插件定制，皮肤定制等等诸多功能。当然还有我最喜欢的博客发布功能。WordPress编辑器虽然很渣渣，但我可以用为知笔记Markdown写再发布。</p><p>之前尝试了发布到博客，虽然没有没啥问题，但特么每次发布到博客，文章下面都有一句“来自为知笔记”，表示强迫症啊，看着难受，虽说可以买Vip取消那个小尾巴，但一年120RMB，为了去掉小尾巴太浪费了。那怎么去掉呢…</p><blockquote><p>摸索过程</p></blockquote><p>之前在<code>设置-工具-插件管理器</code>不小心看到有个<code>博客工具(Blog Tools)</code>，嘿嘿…那就定位到安装笔记的目录下的WizNotePluginsTools.Blog，看到这个文件夹目录下有几个文件。看字面的意思貌似就是<code>PublishBlog.htm</code>先双击在浏览器打开确实发布博客的那个窗口。</p><p>那么思路就是，默认取消那个钩就行了，用文本编辑器打开，然后浏览器F12审查元素定位到：</p><ol><li><code>&lt;span class=&quot;tag&quot;&gt;&lt;input&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;checkPromoteWiz&quot;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;checkbox&quot;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;checked&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;checked&quot;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;/&gt;&lt;/span&gt;</code></li><li><code>&lt;span class=&quot;tag&quot;&gt;&lt;label&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;labelPromoteWiz&quot;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;checkPromoteWiz&quot;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&gt;&lt;/span&gt;</code></li><li><code>&lt;span class=&quot;pln&quot;&gt;Help promote Wiz (VIP members only)&lt;/span&gt;</code></li><li><code>&lt;span class=&quot;tag&quot;&gt;&lt;/label&gt;&lt;/span&gt;</code></li></ol><p>那么去掉<code>checked=&quot;checked&quot;</code>这句看看，在发布的窗口还是没有取消那个钩，可能是下面有有JavaScript语句判断吧？</p><p>搜索<code>checkPromoteWiz</code>关键字，搜到：</p><ol><li><code>&lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;vip&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;{&lt;/span&gt;</code></li><li><code>&lt;span class=&quot;pln&quot;&gt; checkPromoteWiz&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;disabled &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;</code></li><li><code>&lt;span class=&quot;pln&quot;&gt; checkPromoteWiz&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;checked&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; database&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;GetMeta&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;PrompteWiz&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;</code></li><li><code>&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;</code></li><li><code>&lt;span class=&quot;kwd&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;{&lt;/span&gt;</code></li><li><code>&lt;span class=&quot;pln&quot;&gt; checkPromoteWiz&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;disabled &lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;</code></li><li><code>&lt;span class=&quot;pln&quot;&gt; checkPromoteWiz&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;checked&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;</code></li><li><code>&lt;span class=&quot;pln&quot;&gt;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;}&lt;/span&gt;</code></li></ol><p>诶，剩下不就很明显了，不就一个判断语句，我现在不是vip把else下面的俩个<code>true</code>改成<code>false</code>即可。</p><p>测试ok！</p><p>或者根据plugin.ini搜索：<code>PromoteText</code>，注释它的text以及URL即可</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 为知笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTPS部署CHACHA20_POLY1305加密</title>
      <link href="/https-encryption-chacha20-poly1305.html"/>
      <url>/https-encryption-chacha20-poly1305.html</url>
      
        <content type="html"><![CDATA[<p>HTTPS部署CHACHA20_POLY1305加密</p><ul><li>下载Nginx安装包(本博客使用的是oneinstack环境包)</li><li>获取Nginx原有编辑配置</li><li>编译及安装LibreSSL</li><li>配置LibreSSL</li></ul><p>cd oneinstack/src wget <a href="http://ftp.openbsd.org/pub/OpenBSD/LibreSSL/libressl-2.3.2.tar.gz" target="_blank" rel="noopener">http://ftp.openbsd.org/pub/OpenBSD/LibreSSL/libressl-2.3.2.tar.gz</a> tar xzf libressl-2.3.2.tar.gz # /usr/local/nginx/sbin/nginx -V #查看nginx已经编译参数 cd nginx-1.9.12 make clean ./configure –prefix=/usr/local/nginx –user=www –group=www –with-http_stub_status_module –with-http_v2_module –with-http_ssl_module –with-ipv6 –with-http_gzip_static_module –with-http_realip_module –with-http_flv_module –with-ld-opt=-ljemalloc –with-openssl=../libressl-2.3.2 –with-ld-opt=”-lrt” make mv /usr/local/nginx/sbin/nginx{,_<code>date +%F</code>} cp objs/nginx /usr/local/nginx/sbin</p><p>配置LibreSSL<br>在.conf文件中添加如下(针对AMD优化)：</p><p>ssl_session_timeout 5m; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers “ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:AES128-GCM-SHA256:AES256-GCM-SHA384:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA”; ssl_prefer_server_ciphers on; ssl_session_cache shared:SSL:5m; ssl_buffer_size 4k;</p><p>针对通用型：</p><p>ssl_session_timeout 5m; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:AES128-GCM-SHA256:AES256-GCM-SHA384; ssl_prefer_server_ciphers on; ssl_session_cache shared:SSL:5m; ssl_buffer_size 4k;</p><p>重启Nginx（<code>service nginx restart</code>）网站就成功部署了CP算法了。</p>]]></content>
      
      
      <categories>
          
          <category> 编程技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.JS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Sublime Text 3注册码和汉化安装</title>
      <link href="/sublime-text-3-license-and-install.html"/>
      <url>/sublime-text-3-license-and-install.html</url>
      
        <content type="html"><![CDATA[<p>—– BEGIN LICENSE —– Michael Barnes Single User License EA7E-821385 8A353C41 872A0D5C DF9B2950 AFF6F667 C458EA6D 8EA3C286 98D1D650 131A97AB AA919AEC EF20E143 B361B1E7 4C8B7F04 B085E65E 2F5F5360 8489D422 FB8FC1AA 93F6323C FD7F7544 3F39C318 D95E6480 FCCC7561 8A4A1741 68FA4223 ADCEDE07 200C25BE DBBC4855 C4CFB774 C5EC138C 0FEC1CEF D9DCECEC D3A5DAD1 01316C36 —— END LICENSE ——</p><p>—– BEGIN LICENSE —– Free Communities Consultoria em Informática Ltda Single User License EA7E-801302 C154C122 4EFA4415 F1AAEBCC 315F3A7D 2580735A 7955AA57 850ABD88 72A1DDD8 8D2CE060 CF980C29 890D74F2 53131895 281E324E 98EA1FEF 7FF69A12 17CA7784 490862AF 833E133D FD22141D D8C89B94 4C10A4D2 24693D70 AE37C18F 72EF0BE5 1ED60704 651BC71F 16CA1B77 496A0B19 463EDFF9 6BEB1861 CA5BAD96 89D0118E —— END LICENSE ——</p><p>—– BEGIN LICENSE —– Nicolas Hennion Single User License EA7E-866075 8A01AA83 1D668D24 4484AEBC 3B04512C 827B0DE5 69E9B07A A39ACCC0 F95F5410 729D5639 4C37CECB B2522FB3 8D37FDC1 72899363 BBA441AC A5F47F08 6CD3B3FE CEFB3783 B2E1BA96 71AAF7B4 AFB61B1D 0CC513E7 52FF2333 9F726D2C CDE53B4A 810C0D4F E1F419A3 CDA0832B 8440565A 35BF00F6 4CA9F869 ED10E245 469C233E —— END LICENSE ——</p><p>—– BEGIN LICENSE —– Anthony Sansone Single User License EA7E-878563 28B9A648 42B99D8A F2E3E9E0 16DE076E E218B3DC F3606379 C33C1526 E8B58964 B2CB3F63 BDF901BE D31424D2 082891B5 F7058694 55FA46D8 EFC11878 0868F093 B17CAFE7 63A78881 86B78E38 0F146238 BAE22DBB D4EC71A1 0EC2E701 C7F9C648 5CF29CA3 1CB14285 19A46991 E9A98676 14FD4777 2D8A0AB6 A444EE0D CA009B54 —— END LICENSE ——</p><p>—– BEGIN LICENSE —– Alexey Plutalov Single User License EA7E-860776 3DC19CC1 134CDF23 504DC871 2DE5CE55 585DC8A6 253BB0D9 637C87A2 D8D0BA85 AAE574AD BA7D6DA9 2B9773F2 324C5DEF 17830A4E FBCF9D1D 182406E9 F883EA87 E585BBA1 2538C270 E2E857C2 194283CA 7234FF9E D0392F93 1D16E021 F1914917 63909E12 203C0169 3F08FFC8 86D06EA8 73DDAEF0 AC559F30 A6A67947 B60104C6 —— END LICENSE ——</p><p>—– BEGIN LICENSE —– Peter Halliday Single User License EA7E-855988 3997BFF0 2856413A 7A555954 67069B78 06D8CE12 63EAF079 AD039757 79E16D13 C555AD90 465CBE53 10F6DFC4 D3A3C611 411106F8 0CFEB15F 0A7BB891 111F5ED2 C6AA8429 77913528 FA6291A9 B88D4550 F1D6AB13 BF9153BC 91B4DFFE D296CFE0 C1D8EB22 13D5F14E 75A699EC 49EDDC23 D89D0F9B D240B10A A3712467 09DE7870 —— END LICENSE ——</p><p>—– BEGIN LICENSE —– Fred Zirdung Single User License EA7E-844672 6089C0EC 22936E1A 1EADEBE2 B8654BBA 5C98FFA6 C0FD1599 0364779B 071C74FB EEFE9EAB 92B3D867 CD1B32FE D190269F 6FC08F8F 8D24191D 32828465 942CE58E AECE5307 08B62229 D788560A 6E0AAC4B 48A2D9EE 24FD8CAA 07BEBDF2 28EA86D4 CCB96084 6C34CAD2 E8A04F39 3B5A3CBC 3B668BB7 C94D0B4B 847D6D7F 4BC07375 —— END LICENSE ——</p><p>—– BEGIN LICENSE —– Wixel Single User License EA7E-848235 103D2969 8700C7ED 8173CF61 537000C0 EB3C7ECB 5E750F17 6B42B67C A190090B 7669164F C6F371A8 5A1D88D5 BDD0DA70 C065892B 7CC1BB2B 1C8B8C7C F08E7789 7C2A5241 35F86328 4C8F70D9 C023D7C2 11245C36 59A730DB 72BDB9A7 D5B20304 90E90E72 9F08CA25 73F49C20 179D938E 5BC8BEDA 13457A69 39E6265F 233767F9 —— END LICENSE ——</p><p>—– BEGIN LICENSE —– Daniel Russel Single User License EA7E-917420 9327EC62 44020C2A 45172A68 12FE13F1 1D22245B 680892EE F551F8EB C183D032 8B4EDB4B 479CB7E4 07E42EDD A780021D 56BADF42 AC05238B 023B47B1 EBA1B7DE 6DF9A383 159F32AE 04EBE100 1278B1D2 52E81B60 C68AA2E8 F84A20BE FE7990EB 5D44E4B6 16369263 1DDAACBC 280FF19E 86CF4319 0B8615A8 4FF0512E B123B8EC —— END LICENSE ——</p><p>—– BEGIN LICENSE —– Peter Eriksson Single User License EA7E-890068 8E107C71 3100D6FC 2AC805BF 9E627C77 72E710D7 43392469 D06A2F5B F9304FBD F5AB4DB2 7A95F172 FE68E300 42745819 E94AB2DF C1893094 ECABADC8 71FEE764 20224821 3EABF931 745AF882 87AD0A4B 33C6E377 0210D712 CD2B1178 82601542 C7FD8098 F45D2824 BC7DFB38 F1EBD38A D7A3AFE0 96F938EA 2D90BD72 9E34CDF0 —— END LICENSE ——</p><p>—– BEGIN LICENSE —– Ryan Clark Single User License EA7E-812479 2158A7DE B690A7A3 8EC04710 006A5EEB 34E77CA3 9C82C81F 0DB6371B 79704E6F 93F36655 B031503A 03257CCC 01B20F60 D304FA8D B1B4F0AF 8A76C7BA 0FA94D55 56D46BCE 5237A341 CD837F30 4D60772D 349B1179 A996F826 90CDB73C 24D41245 FD032C30 AD5E7241 4EAA66ED 167D91FB 55896B16 EA125C81 F550AF6B A6820916 —— END LICENSE ——</p><p>中文汉化包：<br><a href="http://pan.baidu.com/s/1kU8AoHD" target="_blank" rel="noopener">http://pan.baidu.com/s/1kU8AoHD</a></p><p>下载压缩包覆盖安装目录(在<code>Local</code>同级目录)，重启软件即可！</p>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ubuntu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS9.3.3一键精简系统脚本</title>
      <link href="/ios933-compact-script.html"/>
      <url>/ios933-compact-script.html</url>
      
        <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>这是一份适合iOS9.2-9.3.3越狱后一键精简系统的脚本，可达到对ROM，RAM进行一些列的优化。用户在脚本选择可以进行交互，某些应用程序是否保留有用户说了算。且精简的应用程序会自动备份在用户内存中，用户可以自己手动恢复应用程序。</p><p>此脚本不适合小白，遇到一些问题请手动解决，若发现比较严重的问题请联系我！</p><p>拜托各位推广了，感谢！</p><h3 id="展示样本"><a href="#展示样本" class="headerlink" title="展示样本"></a>展示样本</h3><p>脚本运行后的样本：<br><img src="https://o49m2kysy.qnssl.com/image/compact_script/demo/CompactScript_01.jpg" alt="Demo"></p><h3 id="运行准备"><a href="#运行准备" class="headerlink" title="运行准备"></a>运行准备</h3><p>在运行脚本之前请关闭<code>设置-通用-访问限制</code>选项统统关闭！<br>在运行脚本之前请关闭<code>设置-隐私-定位服务</code>！！<br>否则会出现白图标！</p><p>然后使用ftp上传脚本，把<code>black文件夹放在~目录，也就是/private/var/root</code>目录`，打开SSH终端输入命令：</p><pre><code>cd ~ &amp;&amp; cd black &amp;&amp; chmod 644 black.sh &amp;&amp; sh black.sh</code></pre><p>若是手机运行脚本，需要<code>root</code>登录：</p><pre><code>logincd ~ &amp;&amp; cd black &amp;&amp; chmod 644 black.sh &amp;&amp; sh black.sh</code></pre><p>剩下按照脚本的提示来运行！</p><h3 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h3><p>电脑运行：<br><img src="https://o49m2kysy.qnssl.com/image/compact_script/demo/PC_Screenshot_Demo.png" alt="电脑运行"></p><p>手机运行：<br><img src="https://o49m2kysy.qnssl.com/image/compact_script/demo/iPhone_Screenshot_Demo.png" alt="手机运行"></p><p>奉劝各位封釉一句…能不精简的最好别精简…<br>诶，真的后悔发布这个工具，毕竟我懒…反馈的结果我又不得不处理…</p><blockquote><p>关于恢复App一些思路引导</p></blockquote><p>最近时间有点紧张，脚本好多地方要完善。实在是挤出时间在修复脚本一些存在的bug。<br>关于恢复的脚本，不出意外这个星期搞定。有些同学等不住可以自己动手恢复，给大家一点思路。</p><p>从备份的App直接拉到根目录，这点没错，重启后桌面确实出现App图标了，但打开出现闪退，那是因为没设置权限。</p><p>而我的脚本打权限是：</p><pre><code>chown -R mobile.mobile /private/var/mobile/Media/Backup/chmod 755 /private/var/mobile/Media/Backup/find /private/var/mobile/Media/Backup/ -type d -exec chmod 755 {} ;find /private/var/mobile/Media/Backup/ -type f -exec chmod 644 {} ;</code></pre><p>考虑到读写权限问题，我默认设置用户群组为mobile，但在system可是root组。<br>请看实例：</p><pre><code>wangjinde-iPhone:/Applications root# cd / &amp;&amp; cd Applicationswangjinde-iPhone:/Applications root# ls -l Music.apptotal 220-rw-rw-r-- 1 root admin   2061 Mar 26 16:36 App Icon29x29@2x.png-rw-rw-r-- 1 root admin   6075 Jul  1 17:49 App Icon29x29@3x.png-rw-rw-r-- 1 root admin   3452 Mar 26 16:36 App Icon40x40@2x.png-rw-rw-r-- 1 root admin   7043 Mar 26 16:36 App Icon40x40@3x.png-rw-rw-r-- 1 root admin   7043 Mar 26 16:36 App Icon60x60@2x.png-rw-rw-r-- 1 root admin  14002 Mar 26 16:36 App Icon60x60@3x.png-rw-r--r-- 1 root admin 115772 Jul  1 17:54 Assets.car-rw-rw-r-- 1 root admin   2333 Jul  1 17:49 Info.plistdrwxrwxr-x 2 root admin    170 Mar 26 16:36 LaunchScreen.storyboardc-rwxrwxr-x 1 root admin 176176 Jul  1 17:49 Music-rw-rw-r-- 1 root admin      8 Jul  1 17:49 PkgInfodrwxrwxr-x 4 root admin    136 Mar 26 16:36 PlugInsdrwxrwxr-x 2 root admin    102 Mar 26 16:36 _CodeSignaturedrwxrwxr-x 2 root admin    102 Mar 23 05:59 ar.lprojdrwxrwxr-x 2 root admin    102 Mar 24 05:47 ca.lprojdrwxrwxr-x 2 root admin    102 Mar 24 05:47 cs.lprojdrwxrwxr-x 2 root admin    102 Mar 23 05:59 da.lprojdrwxrwxr-x 2 root admin    102 Mar 23 05:59 de.lprojdrwxrwxr-x 2 root admin    102 Mar 24 05:45 el.lprojdrwxrwxr-x 2 root admin    102 Mar 26 16:37 en.lprojdrwxrwxr-x 2 root admin    102 Mar 23 05:59 en_AU.lprojdrwxrwxr-x 2 root admin    102 Mar 25 03:15 en_GB.lprojdrwxrwxr-x 2 root admin    102 Mar 24 05:45 es.lprojdrwxrwxr-x 2 root admin    102 Mar 24 05:45 es_419.lprojdrwxrwxr-x 2 root admin    102 Mar 24 05:45 fi.lprojdrwxrwxr-x 2 root admin    102 Mar 23 05:59 fr.lprojdrwxrwxr-x 2 root admin    102 Mar 24 05:47 fr_CA.lprojdrwxrwxr-x 2 root admin    102 Mar 24 05:45 he.lprojdrwxrwxr-x 2 root admin    102 Mar 23 05:59 hi.lprojdrwxrwxr-x 2 root admin    102 Mar 24 05:45 hr.lprojdrwxrwxr-x 2 root admin    102 Mar 24 05:45 hu.lprojdrwxrwxr-x 2 root admin    102 Mar 24 06:00 id.lprojdrwxrwxr-x 2 root admin    102 Mar 26 21:18 it.lprojdrwxrwxr-x 2 root admin    102 Mar 24 11:06 ja.lprojdrwxrwxr-x 2 root admin    102 Mar 23 09:14 ko.lprojdrwxrwxr-x 2 root admin    102 Mar 23 05:59 ms.lprojdrwxrwxr-x 2 root admin    102 Mar 23 09:09 nl.lprojdrwxrwxr-x 2 root admin    102 Mar 23 09:09 no.lprojdrwxrwxr-x 2 root admin    102 Mar 23 05:59 pl.lprojdrwxrwxr-x 2 root admin    102 Mar 23 05:59 pt.lprojdrwxrwxr-x 2 root admin    102 Mar 23 05:59 pt_PT.lprojdrwxrwxr-x 2 root admin    102 Mar 24 05:45 ro.lprojdrwxrwxr-x 2 root admin    102 Mar 23 05:59 ru.lprojdrwxrwxr-x 2 root admin    102 Mar 24 05:45 sk.lprojdrwxrwxr-x 2 root admin    102 Mar 24 05:45 sv.lprojdrwxrwxr-x 2 root admin    102 Mar 23 05:58 th.lprojdrwxrwxr-x 2 root admin    102 Mar 25 03:15 tr.lprojdrwxrwxr-x 2 root admin    102 Mar 24 05:45 uk.lprojdrwxrwxr-x 2 root admin    102 Mar 24 05:45 vi.lprojdrwxrwxr-x 2 root admin    102 Mar 23 09:10 zh_CN.lprojdrwxrwxr-x 2 root admin    102 Mar 24 09:31 zh_HK.lprojdrwxrwxr-x 2 root admin    102 Mar 24 05:45 zh_TW.lproj</code></pre><p>从终端得知结果<br>so，需要再加上几条条命令:</p><pre><code>chown -R root.admin /YourApplicationsfind /YourApplications -type d -exec chmod 755 {} ;find /YourApplications -type f -exec chmod 644 {} ;</code></pre><p>/YourApplications就是你所需要恢复的文件目录<br>建议大家在恢复的时候看看其他文件权限用户组是什么，那就改什么。</p><h3 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址:"></a>下载地址:</h3><p><a href="https://i95.me/wp-upload/black.zip" target="_blank" rel="noopener">https://i95.me/wp-upload/black.zip</a></p><p>[reply notice=”评论后可看见此处内容”]<br>蛤蛤，其实并没有什么东西<br>[/reply]</p><h3 id="精简前做好的准备视频介绍："><a href="#精简前做好的准备视频介绍：" class="headerlink" title="精简前做好的准备视频介绍："></a>精简前做好的准备视频介绍：</h3><p><a href="http://v.youku.com/v_show/id_XMTY3MzM1OTYyOA==.html" target="_blank" rel="noopener">点击查看</a></p><h3 id="更新日志"><a href="#更新日志" class="headerlink" title="更新日志:"></a>更新日志:</h3><p><strong>在测试精简文件占用一共<code>460M</code></strong></p><blockquote><p>2016.08.11:</p></blockquote><ul><li>修复上个脚本存在的一些问题</li><li>调整事项提醒可选精简</li><li>添加可选精简日历</li><li>保留书签功能</li><li>删除访问限制中GameCenter残留的代码</li><li>删除股票和天气(根据用户判断)残余文件</li><li>删除事项提醒残余文件</li><li>添加精简CarPlay代码</li><li>删除GameCenter残余文件</li></ul><blockquote><p>2016.08.07:</p></blockquote><ul><li>添加精简备忘录应用程序</li><li>添加精简谷歌认证应用程序</li><li>添加精简雅虎认证应用程序</li><li>深度精简天气残留文件</li></ul><blockquote><p>2016.08.06 13:40:</p></blockquote><ul><li>保留通讯录，老版本通话点击通讯录会出现卡死的现象 <strong><code>严重</code></strong></li><li>调整录音为可选精简</li></ul><blockquote><p>2016.08.06中午:</p></blockquote><ul><li>修复脚本自动中断的问题</li><li>修复AppStore无法登陆以及下载App的问题 <strong><code>严重</code></strong></li><li>修复系统提示丢失文件的问题 <strong><code>严重</code></strong></li><li>修复闹钟无法选择铃声的问题 <strong><code>严重</code></strong></li><li>修复后台一直高速负荷运行遗留程序，导致手机一直发热(耗电)的问题</li></ul><p><strong>这一版本建议大家最好重新刷机再精简，毕竟修复了很多以前精简一直存在的问题</strong></p><blockquote><p>2016.08.06早上:</p></blockquote><ul><li>精简邮件遗留的文件</li><li>精简iTunes Store应用程序</li><li>精简通讯录应用程序(电话不影响)</li><li>添加精简地图进程服务</li><li>添加精简Game Center进程服务</li><li>添加精简iAD进程服务</li><li>添加精简健康进程服务</li><li>添加精简wallet进程服务</li><li>添加精简系统收集崩溃日志进程服务</li><li>添加精简Book自启动进程服务</li><li>添加精简收集系统或系统程序崩溃的信息进程服务</li><li>添加精简系统日志进程服务</li><li>添加精简Apple产品智能设备控制进程服务</li><li>添加精简iTunes Store实例进程服务</li><li>添加精简系统升级进程服务</li><li>添加精简动态壁纸代码</li></ul><blockquote><p>2016.08.05晚上:</p></blockquote><ul><li>删除Facebook遗留的文件</li><li>删除无用的Yahoo验证文件</li><li>删除无用的Google验证文件</li><li>可选删除邮件</li><li>可选删除天气</li><li>可选删除计算器</li><li>深度精简遗留文件(大约60多个文件)</li><li>修复其他设备壁纸无法删除的逻辑语句错误</li></ul><blockquote><p>2016.08.05:</p></blockquote><ul><li>主要针对Game Center和健康精简不彻底的问题</li><li>根据上面修复设置白图标的问题</li><li>修复壁纸精简失败的问题</li><li>修复脚本一些存在的代码错误</li></ul><blockquote><p>2016.08.03:</p></blockquote><ul><li>主要是添加用户可选精简<code>健康</code>和<code>GameCenter</code>选项</li><li>修复之前版本精简壁纸出现判断逻辑错误</li><li>添加遗漏精简文件代码</li></ul><h3 id="其它说明"><a href="#其它说明" class="headerlink" title="其它说明:"></a>其它说明:</h3><ul><li>恢复一键脚本还在制作，想恢复可以看看上面的教</li></ul><h1 id="Black-Blackup文档说明"><a href="#Black-Blackup文档说明" class="headerlink" title="Black Blackup文档说明"></a>Black Blackup文档说明</h1><blockquote><p>备份目录解释说明：</p></blockquote><h4 id="SettingList目录："><a href="#SettingList目录：" class="headerlink" title="SettingList目录："></a>SettingList目录：</h4><ul><li>Restrictions.plist:设置-通用-访问限制</li><li>Privacy.plist:设置-隐私</li><li>Settings.plist:设置</li><li>Sounds.plist:设置-声音</li><li>CalendarProvider.bundle/Info.plist:设置-通知(提醒事项)</li><li>clients.plist:设置-隐私-定位服务</li></ul><h4 id="Applications目录："><a href="#Applications目录：" class="headerlink" title="Applications目录："></a>Applications目录：</h4><ul><li>Music:音乐</li><li>Videos:视频</li><li>Bridge:手表</li><li>Wallet:Wallet(钱包)</li><li>Maps:地图</li><li>Compass:指南针</li><li>Calculator：计算器</li><li>MobileMail：邮件</li><li>Weather：Weather</li><li>GameCenter:GameCenter(游戏中心，喜欢玩单机游戏不建议删除，否则游戏打开闪退)</li><li>iBook:iBook(图书和有声读物)</li><li>Podcasts:播客</li><li>Stocks:股票</li><li>Flickr:Flickr（图片分享）</li><li>Vimeo:Vimeo(视频播客)</li><li>TencentWeibo:腾讯微博</li><li>Twitter:Twitter(推特)</li><li>Facebook:Facebook(脸书)</li><li>SinaWeibo:新浪微博</li><li>HomeKit:HomeKit(家庭智能)</li><li>News:News(隐藏应用：新闻)</li><li>FindMyFriends:查找我的朋友</li><li>Tips:提示</li><li>Reminders:提醒事项</li><li>VoiceMemos:语音备忘录</li><li>iTunes Store:多媒体商店</li><li>Contacts:通讯录</li><li>iAd:广告</li><li>Notes:备忘录</li><li>OtherApp:其他应用程序</li></ul><h4 id="LaunchDaemons目录"><a href="#LaunchDaemons目录" class="headerlink" title="LaunchDaemons目录:"></a>LaunchDaemons目录:</h4><ul><li>SoftwareBehaviorServices:系统升级服务</li><li>OTACrashCopier:OTA进程服务</li><li>Fseventsd:苹果监听进程服务</li><li>PowerLogs:第三方充电器日志进程服务</li><li>ReportCrash:收集系统或系统程序崩溃的信息进程服务</li><li>SystemLogs:系统日志进程服务</li><li>TouchSetup:Apple产品智能设备控制进程服务</li></ul><h4 id="Wallpaper目录"><a href="#Wallpaper目录" class="headerlink" title="Wallpaper目录:"></a>Wallpaper目录:</h4><ul><li>Wallpaper:静态壁纸、动态壁纸、Live</li></ul>]]></content>
      
      
      <categories>
          
          <category> 奇淫技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> 精简 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20岁的年纪</title>
      <link href="/twenty-years-old.html"/>
      <url>/twenty-years-old.html</url>
      
        <content type="html"><![CDATA[<p>岁月如梭，年华荏苒，匆匆已过二十载。是否生命已燃烧了一半？有时，人生漫长的像在银河中散步，渺渺茫茫没有尽头，曾几何时，是那样的盼望长大，长大后就能留起漂亮的发。只是人生又是何其的短暂，寥寥数十年的光阴似箭，惊鸿一瞥，年华溜走，有谁还会记得当初年轻的样子。</p><p>那天真无邪，那笑面如花，那繁花似锦，那是我的童年。似乎所有的日子都是晴空万里的天气，我笑着闹着追逐着，不在乎微微的细雨。调皮时不怕责备，乖巧时学着大人的样子，我想我是一个如此幸福的孩子。就算受伤也没那么疼痛，就算没有漂亮的玩具也不会觉得委屈。</p><p>那生机勃勃，那信心满满，那循规蹈矩，那是我的小学时光。一样的阳光灿烂，一样的幸福美满，只是像极了夏的天气，总是偶尔的阴阴郁郁，雨丝冰凉，耐人寻味。nn那一年，秋天似乎早早来到，天蓝稻黄，白云朵朵，相映的家乡浓墨重彩，诗情画意。十六七岁的年纪，青春迸发的时节，我背起行囊，装满对家的挂念，出发去寻找新的梦想。新的天地，茵茵的校园，那纯纯友谊，那理想抱负，那盼望着假期的年纪。那样的时光，就像收获的季节，即使劳累辛苦，却能看到金灿灿的希望，时时的让人欣喜。</p><p>或许晚秋总是悲凉，它承载过多少人的伤，我在那时放弃梦想，再看不到它的光亮。秋尽了，冬总会来。谁又能抵挡它不被它冻伤，二十岁的年纪，骄阳似火的外衣，只是心都死去，寒风刺骨中送走挚爱亲人最后一程，瞬间老去，我已不再年轻。</p><p>年华似水，带走了多少欢笑和眼泪，雕刻了多少时光和记忆。恍然回首，遥远的已如隔世。写给我的二十岁，虽然它已悄悄逝去，记住这哭过痛过四处碰壁过，浴火重生成长的年纪。走过了冬季，春天才能温暖曾被冻僵的躯体。</p><p>2014年.02.26冬晚随笔</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
